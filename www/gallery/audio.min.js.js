(function e$$0(l,r,b){function k(a,h){if(!r[a]){if(!l[a]){var c="function"==typeof require&&require;if(!h&&c)return c(a,!0);if(p)return p(a,!0);c=Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c;}c=r[a]={exports:{}};l[a][0].call(c.exports,function(b){var c=l[a][1][b];return k(c?c:b)},c,c.exports,e$$0,l,r,b)}return r[a].exports}for(var p="function"==typeof require&&require,c=0;c<b.length;c++)k(b[c]);return k})({1:[function(d,l,r){var b=d("../regl")({devicePixelRatio:1}),k=d("gl-mat4/perspective"),
p=d("gl-mat4/lookAt");d("resl")({manifest:{song:{type:"audio",src:"assets/8bitpeoples-bamboo-cactus.mp3",stream:!0}},onDone:function(c){c=c.song;var a=new AudioContext,h=a.createMediaElementSource(c),m=a.createAnalyser();h.connect(m);h.connect(a.destination);c.play();var d=b.texture({data:(new Uint8Array(65536)).fill(128),radius:256,channels:1,min:"linear",mag:"linear",wrap:"repeat"}),l=b.texture({width:64,height:1,channels:4,min:"linear",mag:"linear",wrap:"repeat"}),w=b({vert:"\n      precision highp float;\n\n      #define N float(256)\n      #define WEIGHT1 vec4(-1.0, 8.0, -8.0, 1.0)\n      #define WEIGHT2 vec4(-1.0, 16.0, 16.0, -1.0)\n\n      attribute vec2 vertId;\n\n      uniform float t;\n      uniform mat4 projection, view;\n      uniform vec3 lightPosition;\n      uniform float offsetRow;\n      uniform sampler2D terrain, color;\n\n      varying vec3 grad, fragColor, eyeDir, lightDir;\n      varying float curvature;\n\n      float f(vec2 x) {\n        return 0.025 * pow(texture2D(terrain, x).r, 2.0) *\n          (1.0 + 2.5 * pow(texture2D(color, vec2(x.y, 0.0)).a, 3.0));\n      }\n\n      vec4 stencil(vec2 x, vec2 d) {\n        return vec4(\n          f(x - 2.0 * d),\n          f(x - d),\n          f(x + d),\n          f(x + 2.0 * d));\n      }\n\n      void main () {\n        vec2 uv = (vertId + vec2(0.0, offsetRow)) / N;\n\n        float h0 = f(uv);\n        vec4 hx = stencil(uv, vec2(1.0 / N, 0.0));\n        vec4 hy = stencil(uv, vec2(0.0, 1.0 / N));\n\n        grad = normalize(vec3(\n          dot(WEIGHT1, hx),\n          dot(WEIGHT1, hy),\n          0.025));\n\n        curvature =\n          max(max((dot(WEIGHT2, hx) - 30.0 * h0),\n              (dot(WEIGHT2, hy) - 30.0 * h0)), 0.0);\n\n        vec3 pos = vec3(vertId / N, h0 + 0.4);\n        lightDir = lightPosition - pos;\n\n        vec4 viewPos = view * vec4(pos, 1);\n        gl_Position = projection * viewPos;\n        eyeDir = viewPos.xyz / viewPos.w;\n\n        vec3 audioColor = texture2D(color, vec2(uv.y, 0)).rgb;\n        float minC = 0.9 * min(min(audioColor.r, audioColor.g), audioColor.b);\n        float maxC = max(max(audioColor.r, audioColor.g), audioColor.b);\n        fragColor = (audioColor - minC) / (maxC - minC);\n      }",
frag:"\n      precision highp float;\n\n      varying vec3 grad, fragColor, eyeDir, lightDir;\n      varying float curvature;\n\n      void main () {\n        vec3 N = normalize(grad);\n        vec3 V = normalize(eyeDir);\n        vec3 L = normalize(lightDir);\n\n        vec3 H = normalize(V + L);\n\n        float ao = 1.0 - curvature;\n        float diffuse = max(dot(L, N), 0.0);\n        float fresnel = 0.1 + 0.5 * pow(1.0 - max(dot(H, V), 0.0), 5.0);\n        float light = 0.25 * ao + 0.8 * diffuse + fresnel;\n        gl_FragColor = vec4(light * fragColor, 1);\n      }",
attributes:{vertId:Array(262144).fill().map(function(a,b){var c=.5*Math.floor(b/512),h=b%512*.5;return[c,h,c+.5,h,c,h+.5,c,h+.5,c+.5,h+.5,c+.5,h]})},uniforms:{offsetRow:function(a){return a.tick%256},terrain:d,projection:function(a){return k([],Math.PI/8,a.viewportWidth/a.viewportHeight,.01,1E3)},view:function(a){a=a.tick;return p([],[.5+.2*Math.cos(.001*a),1,.7+.2*Math.cos(.003*a+2.4)],[.5,0,0],[0,0,1])},lightPosition:function(a){a=a.tick;return[.5+Math.sin(.01*a),1+Math.cos(.01*a),1+.6*Math.cos(.04*
a)]},color:l,t:function(a){return.01*a.tick}},elements:null,instances:-1,count:1572864}),u={width:256,height:1,data:new Uint8Array(256)},n=new Uint8Array(256);b.frame(function(a){a=a.frameCount;b.updateTimer();a%=256;b.clear({color:[0,0,0,1],depth:1});m.getByteTimeDomainData(u.data);d.subimage(u,0,a);m.getByteFrequencyData(n);l.subimage(n);w()})}})},{"../regl":37,"gl-mat4/lookAt":34,"gl-mat4/perspective":35,resl:36}],2:[function(d,l,r){function b(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=
null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}l.exports=function(k,p,c,a,h){k=c.maxAttributes;p=Array(k);for(c=0;c<k;++c)p[c]=new b;return{Record:b,scope:{},state:p}}},{}],3:[function(d,l,r){function b(a){return v[Object.prototype.toString.call(a)]|0}function k(a,b){for(var c=0;c<b.length;++c)a[c]=b[c]}function p(a,b,c,h,k,p,f){for(var m=0,d=0;d<c;++d)for(var g=0;g<h;++g)a[m++]=b[k*d+p*g+f]}function c(a,b,c){for(var h=0,k=0;k<b.length;++k)for(var p=b[k],
f=0;f<c;++f)a[h++]=p[f]}var a=d("./util/is-typed-array"),h=d("./util/is-ndarray"),m=d("./util/values"),A=d("./util/pool"),v=d("./constants/arraytypes.json"),w=d("./constants/dtypes.json"),u=d("./constants/usage.json");l.exports=function(n,d){function x(a){this.id=f++;this.buffer=n.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function t(a,b,c){a.byteLength=b.byteLength;n.bufferData(a.type,b,c)}function l(g,f,d,n,m){g.usage=d;if(Array.isArray(f))g.dtype=
n||5126,0<f.length&&(Array.isArray(f[0])?(g.dimension=f[0].length,n=A.allocType(g.dtype,f.length*g.dimension),c(n,f,g.dimension),t(g,n,d),A.freeType(n)):"number"===typeof f[0]?(g.dimension=m,n=A.allocType(g.dtype,f.length),k(n,f),t(g,n,d),A.freeType(n)):a(f[0])&&(g.dimension=f[0].length,g.dtype=n||b(f[0])||5126,n=A.allocType(g.dtype,f.length*g.dimension),c(n,f,g.dimension),t(g,n,d),A.freeType(n)));else if(a(f))g.dtype=n||b(f),g.dimension=m,t(g,f,d);else if(h(f)){var u=f.shape,y=f.stride;m=f.offset;
var C=0,O=0,x=0,F=0;1===u.length?(C=u[0],O=1,x=y[0],F=0):2===u.length&&(C=u[0],O=u[1],x=y[0],F=y[1]);g.dtype=n||b(f.data)||5126;g.dimension=O;n=A.allocType(g.dtype,C*O);p(n,f.data,C,O,x,F,m);t(g,n,d);A.freeType(n)}}function H(a){d.bufferCount--;n.deleteBuffer(a.buffer);a.buffer=null;delete v[a.id]}var f=0,v={};x.prototype.bind=function(){n.bindBuffer(this.type,this.buffer)};x.prototype.destroy=function(){H(this)};var E=[];return{create:function(g,f,m){function t(b){var c=35044,g=null,f=0,k=0,p=1;
Array.isArray(b)||a(b)||h(b)?g=b:"number"===typeof b?f=b|0:b&&("data"in b&&(g=b.data),"usage"in b&&(c=u[b.usage]),"type"in b&&(k=w[b.type]),"dimension"in b&&(p=b.dimension|0),"length"in b&&(f=b.length|0));E.bind();g?l(E,g,c,k,p):(n.bufferData(E.type,f,c),E.dtype=k||5121,E.usage=c,E.dimension=p,E.byteLength=f);return t}d.bufferCount++;var E=new x(f);v[E.id]=E;m||t(g);t._reglType="buffer";t._buffer=E;t.subdata=function(g,f){var d=(f||0)|0;E.bind();if(Array.isArray(g)){if(0<g.length)if("number"===typeof g[0]){var m=
A.allocType(E.dtype,g.length);k(m,g);n.bufferSubData(E.type,d,m);A.freeType(m)}else if(Array.isArray(g[0])||a(g[0])){var m=g[0].length,u=A.allocType(E.dtype,g.length*m);c(u,g,m);n.bufferSubData(E.type,d,u);A.freeType(u)}}else if(a(g))n.bufferSubData(E.type,d,g);else if(h(g)){var F=g.shape,x=g.stride,H=u=m=0,l=0;1===F.length?(m=F[0],u=1,H=x[0],l=0):2===F.length&&(m=F[0],u=F[1],H=x[0],l=x[1]);F=Array.isArray(g.data)?E.dtype:b(g.data);F=A.allocType(F,m*u);p(F,g.data,m,u,H,l,g.offset);n.bufferSubData(E.type,
d,F);A.freeType(F)}return t};t.destroy=function(){H(E)};return t},createStream:function(a,b){var c=E.pop();c||(c=new x(a),c.buffer=n.createBuffer());c.bind();l(c,b,35040,0,1);return c},destroyStream:function(a){E.push(a)},clear:function(){m(v).forEach(H)},getBuffer:function(a){return a&&a._buffer instanceof x?a._buffer:null},_initBuffer:l}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],
4:[function(d,l,r){l.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(d,l,r){l.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(d,l,r){l.exports={points:0,point:0,lines:1,
line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(d,l,r){l.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(d,l,r){function b(a){return Array.isArray(a)||v(a)||w(a)}function k(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function p(a,b,c,f){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=f}function c(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function a(a){return new p(!1,
!1,!1,a)}function h(a,b){var c=a.type;return 0===c?(c=a.data.length,new p(!0,1<=c,2<=c,b)):new p(3===c,2===c,1===c,b)}var m=d("./util/codegen"),A=d("./util/loop"),v=d("./util/is-typed-array"),w=d("./util/is-ndarray"),u=d("./util/is-array-like"),n=d("./constants/primitives.json"),J=d("./constants/dtypes.json"),x=["x","y","z","w"],t={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,
"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},K={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},H={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},f={cw:2304,ccw:2305},W=new p(!1,!1,!1,function(){});l.exports=function(d,
g,l,w,v,I,r,y,C,O,X,F,da,la){function P(a){return a.replace(".","_")}function M(a,e,b){var c=P(a);za.push(a);xa[c]=z[c]=!!b;oa[c]=e}function G(a,e,b){var c=P(a);za.push(a);Array.isArray(b)?(z[c]=b.slice(),xa[c]=b.slice()):z[c]=xa[c]=b;pa[c]=e}function T(){var a=m(),e=a.link,b=a.global;a.id=Ka++;a.batchId="0";var c=e(Ha),f=a.shared={props:"a0"};Object.keys(Ha).forEach(function(a){f[a]=b.def(c,".",a)});var L=a.next={},h=a.current={};Object.keys(pa).forEach(function(a){Array.isArray(z[a])&&(L[a]=b.def(f.next,
".",a),h[a]=b.def(f.current,".",a))});var D=a.constants={};Object.keys(Aa).forEach(function(a){D[a]=b.def(JSON.stringify(Aa[a]))});a.invoke=function(D,b){switch(b.type){case 0:var c=["this",f.context,f.props,a.batchId];return D.def(e(b.data),".call(",c.slice(0,Math.max(b.data.length+1,4)),")");case 1:return D.def(f.props,b.data);case 2:return D.def(f.context,b.data);case 3:return D.def("this",b.data)}};a.attribCache={};var Fa={};a.scopeAttrib=function(a){a=g.id(a);if(a in Fa)return Fa[a];var D=O.scope[a];
D||(D=O.scope[a]=new ma);return Fa[a]=e(D)};return a}function ha(e){var b=e["static"];e=e.dynamic;if("framebuffer"in b){var c=b.framebuffer;return c?(c=y.getFramebuffer(c),a(function(a,e){var b=a.link(c),D=a.shared;e.set(D.framebuffer,".next",b);D=D.context;e.set(D,".framebufferWidth",b+".width");e.set(D,".framebufferHeight",b+".height");return b})):a(function(a,e){var b=a.shared;e.set(b.framebuffer,".next","null");b=b.context;e.set(b,".framebufferWidth",b+".drawingBufferWidth");e.set(b,".framebufferHeight",
b+".drawingBufferHeight");return"null"})}if("framebuffer"in e){var f=e.framebuffer;return h(f,function(a,e){var b=a.invoke(e,f),D=a.shared,c=D.framebuffer,b=e.def(c,".getFramebuffer(",b,")");e.set(c,".next",b);D=D.context;e.set(D,".framebufferWidth",b+"?"+b+".width:"+D+".drawingBufferWidth");e.set(D,".framebufferHeight",b+"?"+b+".height:"+D+".drawingBufferHeight");return b})}return null}function qa(a,e){function b(a){if(a in c){var q=c[a];a=!0;var g=q.x|0,Ia=q.y|0,k,L;"width"in q?k=q.width|0:a=!1;
"height"in q?L=q.height|0:a=!1;return new p(!a&&e&&e.thisDep,!a&&e&&e.contextDep,!a&&e&&e.propDep,function(a,e){var D=a.shared.context,b=k;"width"in q||(b=e.def(D,".","framebufferWidth","-",g));var c=L;"height"in q||(c=e.def(D,".","framebufferHeight","-",Ia));return[g,Ia,b,c]})}if(a in f){var S=f[a];a=h(S,function(a,e){var D=a.invoke(e,S),b=a.shared.context,c=e.def(D,".x|0"),q=e.def(D,".y|0"),Z=e.def('"width" in ',D,"?",D,".width|0:","(",b,".","framebufferWidth","-",c,")"),D=e.def('"height" in ',
D,"?",D,".height|0:","(",b,".","framebufferHeight","-",q,")");return[c,q,Z,D]});e&&(a.thisDep=a.thisDep||e.thisDep,a.contextDep=a.contextDep||e.contextDep,a.propDep=a.propDep||e.propDep);return a}return e?new p(e.thisDep,e.contextDep,e.propDep,function(a,e){var D=a.shared.context;return[0,0,e.def(D,".","framebufferWidth"),e.def(D,".","framebufferHeight")]}):null}var c=a["static"],f=a.dynamic,g=b("viewport");if(g)var k=g,g=new p(g.thisDep,g.contextDep,g.propDep,function(a,e){var b=k.append(a,e),c=
a.shared.context;e.set(c,".viewportWidth",b[2]);e.set(c,".viewportHeight",b[3]);return b});return{viewport:g,scissor_box:b("scissor.box")}}function sa(e){function b(e){if(e in f){var c=g.id(f[e]);e=a(function(){return c});e.id=c;return e}if(e in k){var q=k[e];return h(q,function(a,e){var b=a.invoke(e,q);return e.def(a.shared.strings,".id(",b,")")})}return null}var f=e["static"],k=e.dynamic,ea=b("frag"),L=b("vert"),z=null;c(ea)&&c(L)?(z=X.program(L.id,ea.id),e=a(function(a,e){return a.link(z)})):e=
new p(ea&&ea.thisDep||L&&L.thisDep,ea&&ea.contextDep||L&&L.contextDep,ea&&ea.propDep||L&&L.propDep,function(a,e){var b=a.shared.shader,c;c=ea?ea.append(a,e):e.def(b,".","frag");var q;q=L?L.append(a,e):e.def(b,".","vert");return e.def(b+".program("+q+","+c+")")});return{frag:ea,vert:L,progVar:e,program:z}}function ia(e){function Z(e,b){if(e in f){var c=f[e]|0;return a(function(a,e){b&&(a.OFFSET=c);return c})}if(e in g){var q=g[e];return h(q,function(a,e){var c=a.invoke(e,q);b&&(a.OFFSET=c);return c})}return b&&
k?a(function(a,e){a.OFFSET="0";return 0}):null}var f=e["static"],g=e.dynamic,k=function(){if("elements"in f){var e=f.elements;b(e)?e=I.getElements(I.create(e)):e&&(e=I.getElements(e));var D=a(function(a,b){if(e){var D=a.link(e);return a.ELEMENTS=D}return a.ELEMENTS=null});D.value=e;return D}if("elements"in g){var c=g.elements;return h(c,function(a,e){var b=a.shared,D=b.isBufferArgs,b=b.elements,q=a.invoke(e,c),f=e.def("null"),D=e.def(D,"(",q,")"),q=a.cond(D).then(f,"=",b,".createStream(",q,");")["else"](f,
"=",b,".getElements(",q,");");e.entry(q);e.exit(a.cond(D).then(b,".destroyStream(",f,");"));return a.ELEMENTS=f})}return null}(),L=Z("offset",!0);return{elements:k,primitive:function(){if("primitive"in f){var e=f.primitive;return a(function(a,b){return n[e]})}if("primitive"in g){var b=g.primitive;return h(b,function(a,e){var c=a.constants.primTypes,q=a.invoke(e,b);return e.def(c,"[",q,"]")})}return k?c(k)?k.value?a(function(a,e){return e.def(a.ELEMENTS,".primType")}):a(function(){return 4}):new p(k.thisDep,
k.contextDep,k.propDep,function(a,e){var b=a.ELEMENTS;return e.def(b,"?",b,".primType:",4)}):null}(),count:function(){if("count"in f){var e=f.count|0;return a(function(){return e})}if("count"in g){var b=g.count;return h(b,function(a,e){return a.invoke(e,b)})}return k?c(k)?k?L?new p(L.thisDep,L.contextDep,L.propDep,function(a,e){return e.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):a(function(a,e){return e.def(a.ELEMENTS,".vertCount")}):a(function(){return-1}):new p(k.thisDep||L.thisDep,k.contextDep||
L.contextDep,k.propDep||L.propDep,function(a,e){var b=a.ELEMENTS;return a.OFFSET?e.def(b,"?",b,".vertCount-",a.OFFSET,":-1"):e.def(b,"?",b,".vertCount:-1")}):null}(),instances:Z("instances",!1),offset:L}}function ra(e){var b=e["static"],c=e.dynamic,g={};za.forEach(function(e){function q(D,f){if(e in b){var L=D(b[e]);g[k]=a(function(){return L})}else if(e in c){var z=c[e];g[k]=h(z,function(a,e){return f(a,e,a.invoke(e,z))})}}var k=P(e);switch(e){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return q(function(a){return a},
function(a,e,b){return b});case "depth.func":return q(function(a){return K[a]},function(a,e,b){return e.def(a.constants.compareFuncs,"[",b,"]")});case "depth.range":return q(function(a){return a},function(a,e,b){a=e.def("+",b,"[0]");e=e.def("+",b,"[1]");return[a,e]});case "blend.func":return q(function(a){return[t["srcRGB"in a?a.srcRGB:a.src],t["dstRGB"in a?a.dstRGB:a.dst],t["srcAlpha"in a?a.srcAlpha:a.src],t["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,e,b){function c(a,D){var f=e.def('"',a,D,'" in ',
b,"?",b,".",a,D,":",b,".",a);return e.def(q,"[",f,"]")}var q=a.constants.blendFuncs;a=c("src","RGB");var f=c("src","Alpha"),g=c("dst","RGB"),k=c("dst","Alpha");return[a,g,f,k]});case "blend.equation":return q(function(a){if("string"===typeof a)return[Y[a],Y[a]];if("object"===typeof a)return[Y[a.rgb],Y[a.alpha]]},function(a,e,b){var c=a.constants.blendEquations,q=e.def(),f=e.def();a=a.cond("typeof ",b,'==="string"');a.then(q,"=",f,"=",c,"[",b,"];");a["else"](q,"=",c,"[",b,".rgb];",f,"=",c,"[",b,".alpha];");
e(a);return[q,f]});case "blend.color":return q(function(a){return A(4,function(e){return+a[e]})},function(a,e,b){return A(4,function(a){return e.def("+",b,"[",a,"]")})});case "stencil.mask":return q(function(a){return a|0},function(a,e,b){return e.def(b,"|0")});case "stencil.func":return q(function(a){return[K[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,e,b){a=e.def('"cmp" in ',b,"?",a.constants.compareFuncs,"[",b,".cmp]",":",7680);var c=e.def(b,".ref|0");e=e.def('"mask" in ',b,"?",
b,".mask|0:-1");return[a,c,e]});case "stencil.opFront":case "stencil.opBack":return q(function(a){return["stencil.opBack"===e?1029:1028,H[a.fail||"keep"],H[a.zfail||"keep"],H[a.pass||"keep"]]},function(a,b,c){function q(a){return b.def('"',a,'" in ',c,"?",f,"[",c,".",a,"]:",7680)}var f=a.constants.stencilOps;return["stencil.opBack"===e?1029:1028,q("fail"),q("zfail"),q("pass")]});case "polygonOffset.offset":return q(function(a){return[a.factor|0,a.units|0]},function(a,e,b){a=e.def(b,".factor|0");e=
e.def(b,".units|0");return[a,e]});case "cull.face":return q(function(a){var e=0;"front"===a?e=1028:"back"===a&&(e=1029);return e},function(a,e,b){return e.def(b,'==="front"?',1028,":",1029)});case "lineWidth":return q(function(a){return a},function(a,e,b){return b});case "frontFace":return q(function(a){return f[a]},function(a,e,b){return e.def(b+'==="cw"?2304:2305')});case "colorMask":return q(function(a){return a.map(function(a){return!!a})},function(a,e,b){return A(4,function(a){return"!!"+b+"["+
a+"]"})});case "sample.coverage":return q(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,e,b){a=e.def('"value" in ',b,"?+",b,".value:1");e=e.def("!!",b,".invert");return[a,e]})}});return g}function na(e){var b=e["static"],c=e.dynamic,f={};Object.keys(b).forEach(function(e){var c=b[e],q;"number"===typeof c||"boolean"===typeof c?q=a(function(){return c}):"function"!==typeof c||"texture2d"!==c._reglType&&"textureCube"!==c._reglType?u(c)&&(q=a(function(a){return a.global.def("[",A(c.length,
function(a){return c[a]}),"]")})):q=a(function(a){return a.link(c)});q.value=c;f[e]=q});Object.keys(c).forEach(function(a){var e=c[a];f[a]=h(e,function(a,b){return a.invoke(b,e)})});return f}function U(e){var c=e["static"],f=e.dynamic,k={};Object.keys(c).forEach(function(e){var q=c[e],f=g.id(e),h=new ma;if(b(q))h.state=1,h.buffer=v.getBuffer(v.create(q,34962,!1)),h.type=h.buffer.dtype;else{var z=v.getBuffer(q);if(z)h.state=1,h.buffer=z,h.type=z.dtype;else if(q.constant){var S=q.constant;h.state=2;
"number"===typeof S?h.x=S:x.forEach(function(a,e){e<S.length&&(h[a]=S[e])})}else{var z=v.getBuffer(q.buffer),n=q.offset|0,d=q.stride|0,m=q.size|0,B=!!q.normalized,y=0;"type"in q&&(y=J[q.type]);q=q.divisor|0;h.buffer=z;h.state=1;h.size=m;h.normalized=B;h.type=y||z.dtype;h.offset=n;h.stride=d;h.divisor=q}}k[e]=a(function(a,e){var b=a.attribCache;if(f in b)return b[f];var c={isStream:!1};Object.keys(h).forEach(function(a){c[a]=h[a]});h.buffer&&(c.buffer=a.link(h.buffer));return b[f]=c})});Object.keys(f).forEach(function(a){var e=
f[a];k[a]=h(e,function(a,b){function c(a){b(h[a],"=",q,".",a,"|0;")}var q=a.invoke(b,e),f=a.shared,g=f.isBufferArgs,k=f.buffer,h={isStream:b.def(!1)},Z=new ma;Z.state=1;Object.keys(Z).forEach(function(a){h[a]=b.def(""+Z[a])});var z=h.buffer,S=h.type;b("if(",g,"(",q,")){",h.isStream,"=true;",z,"=",k,".createStream(",34962,",",q,");",S,"=",z,".dtype;","}else{",z,"=",k,".getBuffer(",q,");","if(",z,"){",S,"=",z,".dtype;","}else if(",q,".constant){",h.state,"=",2,";",x.map(function(a,e){return h[a]+"="+
q+".length>="+e+"?"+q+"["+e+"]:0;"}).join(""),"}else{",z,"=",k,".getBuffer(",q,".buffer);",S,'="type" in ',q,"?",f.glTypes,"[",q,".type]:",z,".dtype;",h.normalized,"=!!",q,".normalized;");c("size");c("offset");c("stride");c("divisor");b("}}");return h})});return k}function fa(e){var b=e["static"],c=e.dynamic,f={};Object.keys(b).forEach(function(e){var c=b[e];f[e]=a(function(a,e){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var e=c[a];f[a]=h(e,
function(a,b){return a.invoke(b,e)})});return f}function V(a,e,b){var c=a.shared.context,f=a.scope();Object.keys(b).forEach(function(g){e.save(c,"."+g);f(c,".",g,"=",b[g].append(a,e),";")});e(f)}function Q(a,e,b){var c=a.shared,f=c.gl,g=c.framebuffer,h;B&&(h=e.def(c.extensions,".webgl_draw_buffers"));var k=a.constants,c=k.drawBuffer,k=k.backBuffer;a=b?b.append(a,e):e.def(g,".next");e("if(",g,".dirty||",a,"!==",g,".cur){","if(",a,"){",f,".bindFramebuffer(",36160,",",a,".framebuffer);");B&&e(h,".drawBuffersWEBGL(",
c,"[",a,".colorAttachments.length]);");e("}else{",f,".bindFramebuffer(",36160,",null);");B&&e(h,".drawBuffersWEBGL(",k,");");e("}",g,".cur=",a,";",g,".dirty=false;","}")}function R(a,e,b){var c=a.shared,f=c.gl,g=a.current,h=a.next,k=c.current,n=c.next,d=a.cond(k,".dirty");za.forEach(function(e){e=P(e);if(!(e in b.state)){var c,Z;if(e in h){c=h[e];Z=g[e];var m=A(z[e].length,function(a){return d.def(c,"[",a,"]")});d(a.cond(m.map(function(a,e){return a+"!=="+Z+"["+e+"]"}).join("||")).then(f,".",pa[e],
"(",m,");",m.map(function(a,e){return Z+"["+e+"]="+a}).join(";"),";"))}else c=d.def(n,".",e),m=a.cond(c,"!==",k,".",e),d(m),e in oa?m(a.cond(c).then(f,".enable(",oa[e],");")["else"](f,".disable(",oa[e],");"),k,".",e,"=",c,";"):m(f,".",pa[e],"(",c,");",k,".",e,"=",c,";")}});0===Object.keys(b.state).length&&d(k,".dirty=false;");e(d)}function aa(a,e,b,f){var g=a.shared,h=a.current,z=g.current,d=g.gl;k(Object.keys(b)).forEach(function(g){var k=b[g];if(!f||f(k)){var m=k.append(a,e);if(oa[g]){var n=oa[g];
c(k)?m?e(d,".enable(",n,");"):e(d,".disable(",n,");"):e(a.cond(m).then(d,".enable(",n,");")["else"](d,".disable(",n,");"));e(z,".",g,"=",m,";")}else if(u(m)){var B=h[g];e(d,".",pa[g],"(",m,");",m.map(function(a,e){return B+"["+e+"]="+a}).join(";"),";")}else e(d,".",pa[g],"(",m,");",z,".",g,"=",m,";")}})}function ta(a,b){e&&!a.instancing&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function Ba(a,e,b){b=a.stats;a=a.shared;la&&e(a.timer,".beginQuery(",b,");")}function ja(a,e,
b){a=a.shared;la&&e(a.timer,".endQuery();")}function ba(a,b,c,f,g){function k(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function h(c,f,g){function k(){b("if(!",B,".pointer){",d,".enableVertexAttribArray(",n,");",B,".pointer=true;}");var c=g.type,h;h=g.size?b.def(g.size,"||",f):f;b("if(",B,".type!==",c,"||",B,".size!==",h,"||",S.map(function(a){return B+"."+a+"!=="+g[a]}).join("||"),"){",
d,".bindBuffer(",34962,",",y,".buffer);",d,".vertexAttribPointer(",[n,h,c,g.normalized,g.stride,g.offset],");",B,".type=",c,";",B,".size=",h,";",S.map(function(a){return B+"."+a+"="+g[a]+";"}).join(""),"}");e&&(c=g.divisor,b("if(",B,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[n,c],");",B,".divisor=",c,";}"))}function m(){b("if(",B,".pointer){",d,".disableVertexAttribArray(",n,");",B,".pointer=false;","}if(",x.map(function(a,e){return B+"."+a+"!=="+p[e]}).join("||"),"){",d,".vertexAttrib4f(",
n,",",p,");",x.map(function(a,e){return B+"."+a+"="+p[e]+";"}).join(""),"}")}var d=z.gl,n=b.def(c,".location"),B=b.def(z.attributes,"[",n,"]");c=g.state;var y=g.buffer,p=[g.x,g.y,g.z,g.w],S=["buffer","normalized","offset","stride"];1===c?k():2===c?m():(b("if(",c,"===",1,"){"),k(),b("}else{"),m(),b("}"))}var z=a.shared;f.forEach(function(e){var f=e.name,z=c.attributes[f],d;if(z){if(!g(z))return;d=z.append(a,b)}else{if(!g(W))return;var m=a.scopeAttrib(f);d={};Object.keys(new ma).forEach(function(a){d[a]=
b.def(m,".",a)})}h(a.link(e),k(e.info.type),d)})}function ca(a,e,b,f,k){for(var h=a.shared,z=h.gl,d,m=0;m<f.length;++m){var n=f[m],B=n.name,y=n.info.type,p=b.uniforms[B],n=a.link(n)+".location",t;if(p){if(!k(p))continue;if(c(p)){B=p.value;if(35678===y||35680===y)y=a.link(B._texture),e(z,".uniform1i(",n,",",y+".bind());"),e.exit(y,".unbind();");else if(35674===y||35675===y||35676===y)B=a.global.def("new Float32Array(["+Array.prototype.slice.call(B)+"])"),p=2,35675===y?p=3:35676===y&&(p=4),e(z,".uniformMatrix",
p,"fv(",n,",false,",B,");");else{switch(y){case 5126:d="1f";break;case 35664:d="2f";break;case 35665:d="3f";break;case 35666:d="4f";break;case 35670:d="1i";break;case 5124:d="1i";break;case 35671:d="2i";break;case 35667:d="2i";break;case 35672:d="3i";break;case 35668:d="3i";break;case 35673:d="4i";break;case 35669:d="4i"}e(z,".uniform",d,"(",n,",",u(B)?Array.prototype.slice.call(B):B,");")}continue}else t=p.append(a,e)}else{if(!k(W))continue;t=e.def(h.uniforms,"[",g.id(B),"]")}B=1;switch(y){case 35678:case 35680:y=
e.def(t,"._texture");e(z,".uniform1i(",n,",",y,".bind());");e.exit(y,".unbind();");continue;case 5124:case 35670:d="1i";break;case 35667:case 35671:d="2i";B=2;break;case 35668:case 35672:d="3i";B=3;break;case 35669:case 35673:d="4i";B=4;break;case 5126:d="1f";break;case 35664:d="2f";B=2;break;case 35665:d="3f";B=3;break;case 35666:d="4f";B=4;break;case 35674:d="Matrix2fv";break;case 35675:d="Matrix3fv";break;case 35676:d="Matrix4fv"}e(z,".uniform",d,"(",n,",");if("M"===d.charAt(0)){var n=Math.pow(y-
35674+2,2),x=a.global.def("new Float32Array(",n,")");e("false,(Array.isArray(",t,")||",t," instanceof Float32Array)?",t,":(",A(n,function(a){return x+"["+a+"]="+t+"["+a+"]"}),",",x,")")}else 1<B?e(A(B,function(a){return t+"["+a+"]"})):e(t);e(");")}}function ya(a,b,f,g){function k(e){var c=m[e];return c?c.contextDep&&g.contextDynamic||c.propDep?c.append(a,f):c.append(a,b):b.def(n,".",e)}function h(){function a(){f(A,".drawElementsInstancedANGLE(",[p,u,l,t+"<<(("+l+"-5121)>>1)",x],");")}function e(){f(A,
".drawArraysInstancedANGLE(",[p,t,u,x],");")}y?F?a():(f("if(",y,"){"),a(),f("}else{"),e(),f("}")):e()}function d(){function a(){f(B+".drawElements("+[p,u,l,t+"<<(("+l+"-5121)>>1)"]+");")}function e(){f(B+".drawArrays("+[p,t,u]+");")}y?F?a():(f("if(",y,"){"),a(),f("}else{"),e(),f("}")):e()}var z=a.shared,B=z.gl,n=z.draw,m=g.draw,y=function(){var e=m.elements,c=b;if(e){if(e.contextDep&&g.contextDynamic||e.propDep)c=f;e=e.append(a,c)}else e=c.def(n,".","elements");e&&c("if("+e+")"+B+".bindBuffer(34963,"+
e+".buffer.buffer);");return e}(),p=k("primitive"),t=k("offset"),u=function(){var e=m.count,c=b;if(e){if(e.contextDep&&g.contextDynamic||e.propDep)c=f;e=e.append(a,c)}else e=c.def(n,".","count");return e}();if("number"===typeof u){if(0===u)return}else f("if(",u,"){"),f.exit("}");var x,A;e&&(x=k("instances"),A=a.instancing);var l=y+".type",F=m.elements&&c(m.elements);e&&("number"!==typeof x||0<=x)?"string"===typeof x?(f("if(",x,">0){"),h(),f("}else if(",x,"<0){"),d(),f("}")):h():d()}function va(a,
b,c,f,g){b=T();g=b.proc("body",g);e&&(b.instancing=g.def(b.shared.extensions,".angle_instanced_arrays"));a(b,g,c,f);return b.compile().body}function Ca(a,e,b,c){ta(a,e);ba(a,e,b,c.attributes,function(){return!0});ca(a,e,b,c.uniforms,function(){return!0});ya(a,e,e,b)}function Da(a,e){var b=a.proc("draw",1);ta(a,b);V(a,b,e.context);Q(a,b,e.framebuffer);R(a,b,e);aa(a,b,e.state);Ba(a,b,e);var c=e.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",c,".program);");if(e.shader.program)Ca(a,b,e,e.shader.program);
else{var f=a.global.def("{}"),g=b.def(c,".id"),k=b.def(f,"[",g,"]");b(a.cond(k).then(k,".call(this,a0);")["else"](k,"=",f,"[",g,"]=",a.link(function(b){return va(Ca,a,e,b,1)}),"(",c,");",k,".call(this,a0);"))}0<Object.keys(e.state).length&&b(a.shared.current,".dirty=true;");ja(a,b,e)}function Ea(a,e,b,c){function f(){return!0}a.batchId="a1";ta(a,e);ba(a,e,b,c.attributes,f);ca(a,e,b,c.uniforms,f);ya(a,e,e,b)}function ua(a,e,b,c){function f(a){return a.contextDep&&k||a.propDep}function g(a){return!f(a)}
ta(a,e);var k=b.contextDep,h=e.def(),d=e.def();a.shared.props=d;a.batchId=h;var z=a.scope(),B=a.scope();e(z.entry,"for(",h,"=0;",h,"<","a1",";++",h,"){",d,"=","a0","[",h,"];",B,"}",z.exit);b.needsContext&&V(a,B,b.context);b.needsFramebuffer&&Q(a,B,b.framebuffer);aa(a,B,b.state,f);c?(ba(a,z,b,c.attributes,g),ba(a,B,b,c.attributes,f),ca(a,z,b,c.uniforms,g),ca(a,B,b,c.uniforms,f),ya(a,z,B,b)):(e=a.global.def("{}"),c=b.shader.progVar.append(a,B),d=B.def(c,".id"),z=B.def(e,"[",d,"]"),B(a.shared.gl,".useProgram(",
c,".program);","if(!",z,"){",z,"=",e,"[",d,"]=",a.link(function(e){return va(Ea,a,b,e,2)}),"(",c,");}",z,".call(this,a0[",h,"],",h,");"))}function Ga(a,e){var b=a.proc("batch",2);a.batchId="0";ta(a,b);var c=!1,f=!0;Object.keys(e.context).forEach(function(a){c=c||e.context[a].propDep});c||(V(a,b,e.context),f=!1);var g=e.framebuffer,k=!1;g?(g.propDep?c=k=!0:g.contextDep&&c&&(k=!0),k||Q(a,b,g)):Q(a,b,null);e.state.viewport&&e.state.viewport.propDep&&(c=!0);R(a,b,e);aa(a,b,e.state,function(a){return!(a.contextDep&&
c||a.propDep)});Ba(a,b,e);e.contextDep=c;e.needsContext=f;e.needsFramebuffer=k;f=e.shader.progVar;if(f.contextDep&&c||f.propDep)ua(a,b,e,null);else if(f=f.append(a,b),b(a.shared.gl,".useProgram(",f,".program);"),e.shader.program)ua(a,b,e,e.shader.program);else{var g=a.global.def("{}"),k=b.def(f,".id"),h=b.def(g,"[",k,"]");b(a.cond(h).then(h,".call(this,a0,a1);")["else"](h,"=",g,"[",k,"]=",a.link(function(b){return va(ua,a,e,b,2)}),"(",f,");",h,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&
b(a.shared.current,".dirty=true;");ja(a,b,e)}function wa(a,e){function b(g){var h=e.shader[g];h&&c.set(f.shader,"."+g,h.append(a,c))}var c=a.proc("scope",3);a.batchId="a2";var f=a.shared,h=f.current,d=f.timer,z;la&&(z=c.def(d,".getNumPendingQueries()"));V(a,c,e.context);e.framebuffer&&e.framebuffer.append(a,c);k(Object.keys(e.state)).forEach(function(b){var g=e.state[b].append(a,c);u(g)?g.forEach(function(e,f){c.set(a.next[b],"["+f+"]",e)}):c.set(f.next,"."+b,g)});["elements","offset","count","instances",
"primitive"].forEach(function(b){var g=e.draw[b];g&&c.set(f.draw,"."+b,""+g.append(a,c))});Object.keys(e.uniforms).forEach(function(b){c.set(f.uniforms,"["+g.id(b)+"]",e.uniforms[b].append(a,c))});Object.keys(e.attributes).forEach(function(b){var f=e.attributes[b].append(a,c),g=a.scopeAttrib(b);Object.keys(new ma).forEach(function(a){c.set(g,"."+a,f[a])})});b("vert");b("frag");0<Object.keys(e.state).length&&(c(h,".dirty=true;"),c.exit(h,".dirty=true;"));c("a1(",a.shared.context,",a0,0);");if(la){var B=
a.stats,h=c.def(d,".getNumPendingQueries()-1");c(d,".pushScopeStats(",z,",",h,",",B,");")}}var ma=O.Record,Y={add:32774,subtract:32778,"reverse subtract":32779};l.ext_blend_minmax&&(Y.min=32775,Y.max=32776);var e=l.angle_instanced_arrays,B=l.webgl_draw_buffers,z={dirty:!0},xa={},za=[],oa={},pa={};M("dither",3024);M("blend.enable",3042);G("blend.color","blendColor",[0,0,0,0]);G("blend.equation","blendEquationSeparate",[32774,32774]);G("blend.func","blendFuncSeparate",[1,0,1,0]);M("depth.enable",2929,
!0);G("depth.func","depthFunc",513);G("depth.range","depthRange",[0,1]);G("depth.mask","depthMask",!0);G("colorMask","colorMask",[!0,!0,!0,!0]);M("cull.enable",2884);G("cull.face","cullFace",1029);G("frontFace","frontFace",2305);G("lineWidth","lineWidth",1);M("polygonOffset.enable",32823);G("polygonOffset.offset","polygonOffset",[0,0]);M("sample.alpha",32926);M("sample.enable",32928);G("sample.coverage","sampleCoverage",[1,!1]);M("stencil.enable",2960);G("stencil.mask","stencilMask",-1);G("stencil.func",
"stencilFunc",[519,0,-1]);G("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);G("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);M("scissor.enable",3089);G("scissor.box","scissor",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);G("viewport","viewport",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);var Ha={gl:d,context:da,strings:g,next:xa,current:z,draw:F,elements:I,buffer:v,shader:X,attributes:O.state,uniforms:C,framebuffer:y,extensions:l,timer:la,isBufferArgs:b},Aa={primTypes:n,
compareFuncs:K,blendFuncs:t,blendEquations:Y,stencilOps:H,glTypes:J,orientationType:f};B&&(Aa.backBuffer=[1029],Aa.drawBuffer=A(w.maxDrawbuffers,function(a){return 0===a?[0]:A(a,function(a){return 36064+a})}));var Ka=0;return{next:xa,current:z,procs:function(){var a=T(),e=a.proc("poll"),b=a.proc("refresh"),c=a.block();e(c);b(c);var f=a.shared,g=f.gl,h=f.next,k=f.current;c(k,".dirty=false;");Q(a,e);b(f.framebuffer,".dirty=true;");Q(a,b);Object.keys(oa).forEach(function(f){var d=oa[f],z=c.def(h,".",
f),B=a.block();B("if(",z,"){",g,".enable(",d,")}else{",g,".disable(",d,")}",k,".",f,"=",z,";");b(B);e("if(",z,"!==",k,".",f,"){",B,"}")});Object.keys(pa).forEach(function(f){var d=pa[f],B=z[f],n,m,y=a.block();y(g,".",d,"(");u(B)?(d=B.length,n=a.global.def(h,".",f),m=a.global.def(k,".",f),y(A(d,function(a){return n+"["+a+"]"}),");",A(d,function(a){return m+"["+a+"]="+n+"["+a+"];"}).join("")),e("if(",A(d,function(a){return n+"["+a+"]!=="+m+"["+a+"]"}).join("||"),"){",y,"}")):(n=c.def(h,".",f),m=c.def(k,
".",f),y(n,");",k,".",f,"=",n,";"),e("if(",n,"!==",m,"){",y,"}"));b(y)});return a.compile()}(),compile:function(a,e,b,c,f){var g=T();g.stats=g.link(f);f=ha(a);var h=qa(a,f),k=ia(a),d=ra(a);a=sa(a);var z=h.viewport;z&&(d.viewport=z);z=P("scissor.box");(h=h[z])&&(d[z]=h);h=0<Object.keys(d).length;f={framebuffer:f,draw:k,shader:a,state:d,dirty:h};f.uniforms=na(b);f.attributes=U(e);f.context=fa(c);Da(g,f);wa(g,f);Ga(g,f);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,
"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(d,l,r){function b(a,b){this.id=c++;this.type=a;this.data=b}function k(a){if(0===a.length)return[];var b=a.charAt(0),c=a.charAt(a.length-1);if(1<a.length&&b===c&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return k(a.substr(0,b.index)).concat(k(b[1])).concat(k(a.substr(b.index+
b[0].length)));b=a.split(".");if(1===b.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(c=0;c<b.length;++c)a=a.concat(k(b[c]));return a}function p(a){return"["+k(a).join("][")+"]"}var c=0;l.exports={define:function(a,c){switch(typeof c){case "boolean":case "number":case "string":return new b(a,p(c+""));case "undefined":return new b(a|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof b},unbox:function(a,c){if(a instanceof b){if(a.type&
128)return new b(a.type&-129,p(c))}else if("function"===typeof a)return new b(0,a);return a},accessor:p}},{}],10:[function(d,l,r){var b=d("./util/is-typed-array"),k=d("./util/is-ndarray"),p=d("./util/values"),c=d("./constants/primitives.json"),a=d("./constants/usage.json");l.exports=function(h,d,A,l){function w(a){this.id=x++;J[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function u(a,c,h,n,g,p,u){(p=u)||b(c)&&(!k(c)||b(c.data))||(p=d.oes_element_index_uint?5125:5123);a.buffer.bind();
A._initBuffer(a.buffer,c,h,p,3);c=u;if(!u){switch(a.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=5125}a.buffer.dtype=c}a.type=c;0>g&&(g=a.buffer.byteLength,5123===c?g>>=1:5125===c&&(g>>=2));a.vertCount=g;g=n;0>n&&(g=4,n=a.buffer.dimension,1===n&&(g=0),2===n&&(g=1),3===n&&(g=4));a.primType=g}function n(a){l.elementsCount--;delete J[a.id];a.buffer.destroy();a.buffer=null}var J={},x=0,t={uint8:5121,uint16:5123};d.oes_element_index_uint&&(t.uint32=
5125);w.prototype.bind=function(){this.buffer.bind()};var K=[];return{create:function(d){function f(g){if(g)if("number"===typeof g)m(g),p.primType=4,p.vertCount=g|0,p.type=5121;else{var d=null,n=35044,x=-1,l=-1,A=0,y=0;Array.isArray(g)||b(g)||k(g)?d=g:("data"in g&&(d=g.data),"usage"in g&&(n=a[g.usage]),"primitive"in g&&(x=c[g.primitive]),"count"in g&&(l=g.count|0),"length"in g&&(A=g.length|0),"type"in g&&(y=t[g.type]));d?u(p,d,n,x,l,A,y):(g=p.buffer,g.bind(),h.bufferData(34963,A,n),g.dtype=y||5121,
g.usage=n,g.dimension=3,g.byteLength=A,p.primType=0>x?4:x,p.vertCount=0>l?0:l,p.type=g.dtype)}else m(),p.primType=4,p.vertCount=0,p.type=5121;return f}var m=A.create(null,34963,!0),p=new w(m._buffer);l.elementsCount++;f(d);f._reglType="elements";f._elements=p;f.subdata=function(a,b){m.subdata(a,b);return f};f.destroy=function(){n(p)};return f},createStream:function(a){var b=K.pop();b||(b=new w(A.create(null,34963,!0)._buffer));u(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){K.push(a)},
getElements:function(a){return"function"===typeof a&&a._elements instanceof w?a._elements:null},clear:function(){p(J).forEach(n)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(d,l,r){l.exports=function(b){function k(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb ext_disjoint_timer_query angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(c){try{d[c]=
b.getExtension(c)}catch(a){}})}var d={};k();return{extensions:d,refresh:k}}},{}],12:[function(d,l,r){var b=d("./util/values"),k=d("./util/extend");l.exports=function(d,c,a,h,m,l){function v(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var f=a=0;b?(a=b.width,f=b.height):c&&(a=c.width,f=c.height);this.width=a;this.height=f}function w(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function u(a,b,c){a&&(a.texture?a.texture._texture.refCount+=
1:a.renderbuffer._renderbuffer.refCount+=1)}function n(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function J(a){var b=3553,c=null,f=null,g=a;"object"===typeof a&&(g=a.data);a=g._reglType;"texture2d"===a?c=g:"textureCube"===a?c=g:"renderbuffer"===a&&(f=g,b=36161);return new v(b,c,f)}function x(a,b,c,f,g){if(c)return a=h.create2D({width:a,
height:b,format:f,type:g}),a._texture.refCount=0,new v(3553,a,null);a=m.create({width:a,height:b,format:f});a._renderbuffer.refCount=0;return new v(36161,null,a)}function t(a){return a&&(a.texture||a.renderbuffer)}function K(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function H(){this.id=I++;ga[this.id]=this;this.framebuffer=d.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=
null}function f(a){a.colorAttachments.forEach(w);w(a.depthAttachment);w(a.stencilAttachment);w(a.depthStencilAttachment)}function r(a){d.deleteFramebuffer(a.framebuffer);a.framebuffer=null;l.framebufferCount--;delete ga[a.id]}function E(b){var c;d.bindFramebuffer(36160,b.framebuffer);var f=b.colorAttachments;for(c=0;c<f.length;++c)n(36064+c,f[c]);for(c=f.length;c<a.maxColorAttachments;++c)n(36064+c,null);n(36096,b.depthAttachment);n(36128,b.stencilAttachment);n(33306,b.depthStencilAttachment);d.checkFramebufferStatus(36160);
d.bindFramebuffer(36160,g.next);g.current=g.next}var g={current:null,next:null,dirty:!1},Ja=["rgba"],N=["rgba4","rgb565","rgb5 a1"];c.ext_srgb&&N.push("srgba");c.ext_color_buffer_half_float&&N.push("rgba16f","rgb16f");c.webgl_color_buffer_float&&N.push("rgba32f");var ka=["uint8"];c.oes_texture_half_float&&ka.push("half float");c.oes_texture_float&&ka.push("float");var I=0,ga={};return k(g,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof
H)?a:null},create:function(a,b){function g(a,b){var h,d=0,n=0,m=!0,p=!0;h=null;var l=!0,A="rgba",y="uint8",v=1,w=null,H=null,K=null,r=!1;if("number"===typeof a)d=a|0,n=b|0||d;else if(a){"shape"in a?(n=a.shape,d=n[0],n=n[1]):("radius"in a&&(d=n=a.radius),"width"in a&&(d=a.width),"height"in a&&(n=a.height));if("color"in a||"colors"in a)h=a.color||a.colors,Array.isArray(h);h||("colorCount"in a&&(v=a.colorCount|0),"colorTexture"in a&&(l=!!a.colorTexture,A="rgba4"),"colorType"in a&&(y=a.colorType,l||("half float"===
y?c.ext_color_buffer_half_float&&(A="rgba16f"):"float"===y&&c.webgl_color_buffer_float&&(A="rgba32f"))),"colorFormat"in a&&(A=a.colorFormat,0<=Ja.indexOf(A)?l=!0:0<=N.indexOf(A)&&(l=!1)));if("depthTexture"in a||"depthStencilTexture"in a)r=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?m=a.depth:(w=a.depth,p=!1));"stencil"in a&&("boolean"===typeof a.stencil?p=a.stencil:(H=a.stencil,m=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?m=p=a.depthStencil:
(K=a.depthStencil,p=m=!1))}else d=n=1;var C=null,I=null,W=null,aa=null;if(Array.isArray(h))C=h.map(J);else if(h)C=[J(h)];else for(C=Array(v),h=0;h<v;++h)C[h]=x(d,n,l,A,y);d=d||C[0].width;n=n||C[0].height;w?I=J(w):m&&!p&&(I=x(d,n,r,"depth","uint32"));H?W=J(H):p&&!m&&(W=x(d,n,!1,"stencil","uint8"));K?aa=J(K):!w&&!H&&p&&m&&(aa=x(d,n,r,"depth stencil","depth stencil"));for(h=0;h<C.length;++h)u(C[h],d,n);u(I,d,n);u(W,d,n);u(aa,d,n);f(k);k.width=d;k.height=n;k.colorAttachments=C;k.depthAttachment=I;k.stencilAttachment=
W;k.depthStencilAttachment=aa;g.color=C.map(t);g.depth=t(I);g.stencil=t(W);g.depthStencil=t(aa);g.width=k.width;g.height=k.height;E(k);return g}var k=new H;l.framebufferCount++;g(a,b);g.resize=function(a,b){var c=a|0,f=b|0||c;if(c===k.width&&f===k.height)return g;for(var h=k.colorAttachments,d=0;d<h.length;++d)K(h[d],c,f);K(k.depthAttachment,c,f);K(k.stencilAttachment,c,f);K(k.depthStencilAttachment,c,f);k.width=g.width=c;k.height=g.height=f;E(k);return g};g._reglType="framebuffer";g._framebuffer=
k;g.destroy=function(){r(k);f(k)};return g},clear:function(){b(ga).forEach(r)}})}},{"./util/extend":23,"./util/values":31}],13:[function(d,l,r){l.exports=function(b,k){var d=1;k.ext_texture_filter_anisotropic&&(d=b.getParameter(34047));var c=1,a=1;k.webgl_draw_buffers&&(c=b.getParameter(34852),a=b.getParameter(36063));return{colorBits:[b.getParameter(3410),b.getParameter(3411),b.getParameter(3412),b.getParameter(3413)],depthBits:b.getParameter(3414),stencilBits:b.getParameter(3415),subpixelBits:b.getParameter(3408),
extensions:Object.keys(k).filter(function(a){return!!k[a]}),maxAnisotropic:d,maxDrawbuffers:c,maxColorAttachments:a,pointSizeDims:b.getParameter(33901),lineWidthDims:b.getParameter(33902),maxViewportDims:b.getParameter(3386),maxCombinedTextureUnits:b.getParameter(35661),maxCubeMapSize:b.getParameter(34076),maxRenderbufferSize:b.getParameter(34024),maxTextureUnits:b.getParameter(34930),maxTextureSize:b.getParameter(3379),maxAttributes:b.getParameter(34921),maxVertexUniforms:b.getParameter(36347),maxVertexTextureUnits:b.getParameter(35660),
maxVaryingVectors:b.getParameter(36348),maxFragmentUniforms:b.getParameter(36349),glsl:b.getParameter(35724),renderer:b.getParameter(7937),vendor:b.getParameter(7936),version:b.getParameter(7938)}}},{}],14:[function(d,l,r){var b=d("./util/is-typed-array");l.exports=function(k,d,c){return function(a){var h=0,m=0,l=c.framebufferWidth,v=c.framebufferHeight,w=null;b(a)?w=a:2===arguments.length?(l=arguments[0]|0,v=arguments[1]|0):a&&(h=a.x|0,m=a.y|0,l=a.width||c.framebufferWidth,v=a.height||c.framebufferHeight,
w=a.data||null);d();w=w||new Uint8Array(l*v*4);k.pixelStorei(3333,4);k.readPixels(h,m,l,v,6408,5121,w);return w}}},{"./util/is-typed-array":26}],15:[function(d,l,r){var b=d("./util/values");l.exports=function(k,d,c,a){function h(a){this.id=v++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0}function m(b){var c=b.renderbuffer;k.bindRenderbuffer(36161,null);k.deleteRenderbuffer(c);b.renderbuffer=null;b.refCount=0;delete w[b.id];a.renderbufferCount--}var l={rgba4:32854,
rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};d.ext_srgb&&(l.srgba=35907);d.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);d.webgl_color_buffer_float&&(l.rgba32f=34836);var v=0,w={};h.prototype.decRef=function(){0>=--this.refCount&&m(this)};return{create:function(b,c){function d(a,b){var c=0,f=0,h=32854;"object"===typeof a&&a?("shape"in a?(f=a.shape,c=f[0]|0,f=f[1]|0):("radius"in a&&(c=f=a.radius|0),"width"in a&&(c=a.width|0),"height"in a&&(f=a.height|
0)),"format"in a&&(h=l[a.format])):"number"===typeof a?(c=a|0,f="number"===typeof b?b|0:c):a||(c=f=1);if(c!==m.width||f!==m.height||h!==m.format)return d.width=m.width=c,d.height=m.height=f,m.format=h,k.bindRenderbuffer(36161,m.renderbuffer),k.renderbufferStorage(36161,h,c,f),d}var m=new h(k.createRenderbuffer());w[m.id]=m;a.renderbufferCount++;d(b,c);d.resize=function(a,b){var c=a|0,f=b|0||c;if(c===m.width&&f===m.height)return d;d.width=m.width=c;d.height=m.height=f;k.bindRenderbuffer(36161,m.renderbuffer);
k.renderbufferStorage(36161,m.format,c,f);return d};d._reglType="renderbuffer";d._renderbuffer=m;d.destroy=function(){m.decRef()};return d},clear:function(){b(w).forEach(m)}}}},{"./util/values":31}],16:[function(d,l,r){var b=d("./util/values");l.exports=function(d,p,c){function a(a,b,c,d){this.name=a;this.id=b;this.location=c;this.info=d}function h(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function m(a,b,c){c=35632===a?v:w;var h=c[b];if(!h){var f=
p.str(b),h=d.createShader(a);d.shaderSource(h,f);d.compileShader(h);c[b]=h}return h}function l(a,b){this.id=J++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}var v={},w={},u={},n=[],J=0;return{clear:function(){var a=d.deleteShader.bind(d);b(v).forEach(a);v={};b(w).forEach(a);w={};n.forEach(function(a){d.deleteProgram(a.program)});n.length=0;u={};c.shaderCount=0},program:function(b,t,w){c.shaderCount++;(w=u[t])||(w=u[t]={});var v=w[b];if(!v){var f=v=new l(t,b),J,
E;J=m(35632,f.fragId);E=m(35633,f.vertId);t=f.program=d.createProgram();d.attachShader(t,J);d.attachShader(t,E);d.linkProgram(t);var g=d.getProgramParameter(t,35718),r=f.uniforms;for(J=0;J<g;++J)if(E=d.getActiveUniform(t,J))if(1<E.size)for(var N=0;N<E.size;++N){var ka=E.name.replace("[0]","["+N+"]");h(r,new a(ka,p.id(ka),d.getUniformLocation(t,ka),E))}else h(r,new a(E.name,p.id(E.name),d.getUniformLocation(t,E.name),E));g=d.getProgramParameter(t,35721);f=f.attributes;for(J=0;J<g;++J)(E=d.getActiveAttrib(t,
J))&&h(f,new a(E.name,p.id(E.name),d.getAttribLocation(t,E.name),E));w[b]=v;n.push(v)}return v},shader:m,frag:null,vert:null}}},{"./util/values":31}],17:[function(d,l,r){l.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(d,l,r){l.exports=function(){var b={"":0},d=[""];return{id:function(p){var c=b[p];if(c)return c;c=b[p]=d.length;d.push(p);return c},str:function(b){return d[b]}}}},{}],19:[function(d,
l,r){function b(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function k(a){return Array.isArray(a)&&0!==a.length&&n(a[0])?!0:!1}function p(a){return Object.prototype.toString.call(a)}function c(a){if(!a)return!1;var c=p(a);return 0<=H.indexOf(c)?!0:b(a)||k(a)||v(a)}function a(a,b){36193===a.type?(a.data=u(b),w.freeType(b)):a.data=b}var h=d("./util/extend"),m=d("./util/values"),A=d("./util/is-typed-array"),v=d("./util/is-ndarray"),w=d("./util/pool"),u=d("./util/to-half-float"),
n=d("./util/is-array-like");r=d("./constants/arraytypes.json");var J=d("./constants/arraytypes.json"),x=[9984,9986,9985,9987],t=[0,6409,6410,6407,6408],K={};K[6409]=K[6406]=K[6402]=1;K[34041]=K[6410]=2;K[6407]=3;K[6408]=4;var H=Object.keys(r).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);l.exports=function(f,d,l,g,r,N){function H(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=
this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function I(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function ga(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=
b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=Ba[b.colorSpace]);"type"in b&&(a.type=ja[b.type]);var c=a.width,f=a.height,g=a.channels,d=!1;"shape"in b?(c=b.shape[0],f=b.shape[1],3===b.shape.length&&(g=b.shape[2],d=!0)):("radius"in b&&(c=f=b.radius),"width"in b&&(c=b.width),"height"in b&&(f=b.height),"channels"in b&&(g=b.channels,d=!0));a.width=c|0;a.height=f|0;a.channels=g|0;c=!1;"format"in b&&(c=b.format,f=a.internalformat=ba[c],a.format=Ca[f],c in ja&&
!("type"in b)&&(a.type=ja[c]),c in ca&&(a.compressed=!0),c=!0);!d&&c?a.channels=K[a.format]:d&&!c&&a.channels!==t[a.format]&&(a.format=a.internalformat=t[a.channels])}}function y(a){f.pixelStorei(37440,a.flipY);f.pixelStorei(37441,a.premultiplyAlpha);f.pixelStorei(37443,a.colorSpace);f.pixelStorei(3317,a.unpackAlignment)}function C(){H.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function O(e,f){var g=null;c(f)?g=f:f&&(ga(e,f),"x"in f&&
(e.xOffset=f.x|0),"y"in f&&(e.yOffset=f.y|0),c(f.data)&&(g=f.data));if(f.copy){var d=r.viewportWidth,h=r.viewportHeight;e.width=e.width||d-e.xOffset;e.height=e.height||h-e.yOffset;e.needsCopy=!0}else if(!g)e.width=e.width||1,e.height=e.height||1;else if(A(g))e.data=g,"type"in f||5121!==e.type||(e.type=J[Object.prototype.toString.call(g)]|0);else if(b(g)){d=g;h=e.width*e.height*e.channels;switch(e.type){case 5121:case 5123:case 5125:case 5126:h=w.allocType(e.type,h);h.set(d);e.data=h;break;case 36193:e.data=
u(d)}e.alignment=1;e.needsFree=!0}else if(v(g)){d=g.data;Array.isArray(d)||5121!==e.type||(e.type=J[Object.prototype.toString.call(d)]|0);var h=g.shape,m=g.stride,l,y,x,C;3===h.length?(x=h[2],C=m[2]):C=x=1;l=h[0];y=h[1];h=m[0];m=m[1];e.alignment=1;e.width=l;e.height=y;e.channels=x;e.format=e.internalformat=t[x];e.needsFree=!0;l=C;g=g.offset;x=e.width;C=e.height;y=e.channels;for(var q=w.allocType(36193===e.type?5126:e.type,x*C*y),E=0,N=0;N<C;++N)for(var I=0;I<x;++I)for(var F=0;F<y;++F)q[E++]=d[h*I+
m*N+l*F+g];a(e,q)}else if("[object HTMLCanvasElement]"===p(g)||"[object CanvasRenderingContext2D]"===p(g))"[object HTMLCanvasElement]"===p(g)?e.element=g:e.element=g.canvas,e.width=e.element.width,e.height=e.element.height;else if("[object HTMLImageElement]"===p(g))e.element=g,e.width=g.naturalWidth,e.height=g.naturalHeight;else if("[object HTMLVideoElement]"===p(g))e.element=g,e.width=g.videoWidth,e.height=g.videoHeight,e.needsPoll=!0;else if(k(g)){d=g[0].length;h=g.length;m=1;if(n(g[0][0])){l=m=
g[0][0].length;x=w.allocType(36193===e.type?5126:e.type,d*h*l);for(y=C=0;y<h;++y)for(q=g[y],E=0;E<d;++E)for(N=q[E],I=0;I<l;++I)x[C++]=N[I];a(e,x)}else{l=w.allocType(36193===e.type?5126:e.type,d*h);for(C=x=0;C<h;++C)for(y=g[C],q=0;q<d;++q)l[x++]=y[q];a(e,l)}e.alignment=1;e.width=d;e.height=h;e.channels=m;e.format=e.internalformat=t[m];e.needsFree=!0}}function X(a,b,c,d,h){var k=a.element,n=a.data,m=a.internalformat,p=a.format,l=a.type,q=a.width,u=a.height;y(a);k?f.texSubImage2D(b,h,c,d,p,l,k):a.compressed?
f.compressedTexSubImage2D(b,h,c,d,m,q,u,n):a.needsCopy?(g(),f.copyTexSubImage2D(b,h,c,d,a.xOffset,a.yOffset,q,u)):f.texSubImage2D(b,h,c,d,q,u,p,l,n)}function F(){return Da.pop()||new C}function da(a){a.needsFree&&w.freeType(a.data);C.call(a);Da.push(a)}function la(){H.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function P(a,b,c){var g=a.images[0]=F();a.mipmask=1;g.width=a.width=b;g.height=a.height=c}function M(a,b){var g=null;if(c(b))g=a.images[0]=F(),I(g,
a),O(g,b),a.mipmask=1;else if(ga(a,b),Array.isArray(b.mipmap))for(var f=b.mipmap,d=0;d<f.length;++d)g=a.images[d]=F(),I(g,a),g.width>>=d,g.height>>=d,O(g,f[d]),a.mipmask|=1<<d;else g=a.images[0]=F(),I(g,a),O(g,b),a.mipmask=1;I(a,a.images[0])}function G(a,b){for(var c=a.images,d=0;d<c.length&&c[d];++d){var h=c[d],k=b,n=d,m=h.element,p=h.data,l=h.internalformat,u=h.format,A=h.type,x=h.width,t=h.height;y(h);m?f.texImage2D(k,n,u,u,A,m):h.compressed?f.compressedTexImage2D(k,n,l,x,t,0,p):h.needsCopy?(g(),
f.copyTexImage2D(k,n,u,h.xOffset,h.yOffset,x,t,0)):f.texImage2D(k,n,u,x,t,0,u,A,p)}}function T(){var a=Ea.pop()||new la;H.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ha(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&da(b[c]),b[c]=null;Ea.push(a)}function qa(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function sa(a,b){"min"in b&&(a.minFilter=ta[b.min],0<=x.indexOf(a.minFilter)&&(a.genMipmaps=
!0));"mag"in b&&(a.magFilter=aa[b.mag]);var c=a.wrapS,g=a.wrapT;if("wrap"in b){var d=b.wrap;"string"===typeof d?c=g=R[d]:Array.isArray(d)&&(c=R[d[0]],g=R[d[1]])}else"wrapS"in b&&(c=R[b.wrapS]),"wrapT"in b&&(g=R[b.wrapT]);a.wrapS=c;a.wrapT=g;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=Q[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=
9984)}}function ia(a,b){f.texParameteri(b,10241,a.minFilter);f.texParameteri(b,10240,a.magFilter);f.texParameteri(b,10242,a.wrapS);f.texParameteri(b,10243,a.wrapT);d.ext_texture_filter_anisotropic&&f.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(f.hint(33170,a.mipmapHint),f.generateMipmap(b))}function ra(){var a=ua.pop()||new qa;qa.call(a);return a}function na(a){H.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ga++;this.refCount=1;this.target=a;this.texture=f.createTexture();this.unit=
-1;this.bindCount=0}function U(a){f.activeTexture(33984);f.bindTexture(a.target,a.texture)}function fa(){var a=Y[0];a?f.bindTexture(a.target,a.texture):f.bindTexture(3553,null)}function V(a){var b=a.texture,c=a.unit,g=a.target;0<=c&&(f.activeTexture(33984+c),f.bindTexture(g,null),Y[c]=null);f.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete wa[a.id];N.textureCount--}var Q={"don't care":4352,"dont care":4352,nice:4354,fast:4353},R={repeat:10497,clamp:33071,mirror:33648},
aa={nearest:9728,linear:9729},ta=h({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},aa),Ba={none:0,browser:37444},ja={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ba={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ca={};d.ext_srgb&&(ba.srgb=35904,ba.srgba=35906);d.oes_texture_float&&(ja["float"]=5126);d.oes_texture_half_float&&(ja.float16=ja["half float"]=
36193);d.webgl_depth_texture&&(h(ba,{depth:6402,"depth stencil":34041}),h(ja,{uint16:5123,uint32:5125,"depth stencil":34042}));d.webgl_compressed_texture_s3tc&&h(ca,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});d.webgl_compressed_texture_atc&&h(ca,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});d.webgl_compressed_texture_pvrtc&&h(ca,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
d.webgl_compressed_texture_etc1&&(ca["rgb etc1"]=36196);var ya=Array.prototype.slice.call(f.getParameter(34467));Object.keys(ca).forEach(function(a){var b=ca[a];0<=ya.indexOf(b)&&(ba[a]=b)});var va=Object.keys(ba);l.textureFormats=va;var Ca=va.reduce(function(a,b){var c=ba[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Da=[],Ea=[],ua=[],Ga=0,wa={},ma=l.maxTextureUnits,Y=Array(ma).map(function(){return null});
h(na.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<ma;++b){var c=Y[b];if(c){if(0<c.bindCount)continue;c.unit=-1}Y[b]=this;a=b;break}this.unit=a;f.activeTexture(33984+a);f.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&V(this)}});return{create2D:function(a,b){function c(a,b){var e=ra(),d=T();"number"===typeof a?"number"===typeof b?P(d,a|0,b|0):P(d,a|0,a|0):a?(sa(e,a),M(d,a)):P(d,1,1);e.genMipmaps&&
(d.mipmask=(d.width<<1)-1);g.mipmask=d.mipmask;I(g,d);g.internalformat=d.internalformat;c.width=d.width;c.height=d.height;U(g);G(d,3553);ia(e,3553);fa();ua.push(e);ha(d);return c}var g=new na(3553);wa[g.id]=g;N.textureCount++;c(a,b);c.subimage=function(a,b,e,d){b|=0;e|=0;d|=0;var f=F();I(f,g);f.width>>=d;f.height>>=d;f.width-=b;f.height-=e;O(f,a);U(g);X(f,3553,b,e,d);fa();da(f);return c};c.resize=function(a,b){var e=a|0,d=b|0||e;if(e===g.width&&d===g.height)return c;c.width=g.width=e;c.height=g.height=
d;U(g);f.texImage2D(3553,0,g.format,e,d,0,g.format,g.type,null);fa();return c};c._reglType="texture2d";c._texture=g;c.destroy=function(){g.decRef()};return c},createCube:function(a,b,c,g,d,h){function k(a,b,c,e,g,d){var f,h=ra();for(f=0;6>f;++f)m[f]=T();if("number"===typeof a||!a)for(a=a|0||1,f=0;6>f;++f)P(m[f],a,a);else if("object"===typeof a)if(b)M(m[0],a),M(m[1],b),M(m[2],c),M(m[3],e),M(m[4],g),M(m[5],d);else if(sa(h,a),ga(n,a),"faces"in a)for(a=a.faces,f=0;6>f;++f)I(m[f],n),M(m[f],a[f]);else for(f=
0;6>f;++f)M(m[f],a);I(n,m[0]);n.mipmask=h.genMipmaps?(m[0].width<<1)-1:m[0].mipmask;n.internalformat=m[0].internalformat;k.width=m[0].width;k.height=m[0].height;U(n);for(f=0;6>f;++f)G(m[f],34069+f);ia(h,34067);fa();ua.push(h);for(f=0;6>f;++f)ha(m[f]);return k}var n=new na(34067);wa[n.id]=n;N.cubeCount++;var m=Array(6);k(a,b,c,g,d,h);k.subimage=function(a,b,c,e,g){c|=0;e|=0;g|=0;var f=F();I(f,n);f.width>>=g;f.height>>=g;f.width-=c;f.height-=e;O(f,b);U(n);X(f,34069+a,c,e,g);fa();da(f);return k};k.resize=
function(a,b){var c=a|0,e=b|0||c;if(c===n.width&&e===n.height)return k;k.width=n.width=c;k.height=n.height=e;U(n);for(var g=0;6>g;++g)f.texImage2D(34069+g,0,n.format,c,e,0,n.format,n.type,null);fa();return k};k._reglType="textureCube";k._texture=n;k.destroy=function(){n.decRef()};return k},clear:function(){for(var a=0;a<ma;++a)f.activeTexture(33984+a),f.bindTexture(3553,null),Y[a]=null;m(wa).forEach(V);N.cubeCount=0;N.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,
"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(d,l,r){l.exports=function(b,d){function p(){this.endQueryIndex=this.startQueryIndex=-1;this.stats=null}var c=d.ext_disjoint_timer_query;if(!c)return null;var a=[],h=[],m,l,v=[],w=[];return{beginQuery:function(a){m=a;l=v.pop()||c.createQueryEXT();c.beginQueryEXT(c.TIME_ELAPSED_EXT,l)},endQuery:function(){c.endQueryEXT(c.TIME_ELAPSED_EXT);
var b=w.pop()||new p;b.startQueryIndex=a.length;b.endQueryIndex=b.startQueryIndex;b.stats=m;h.push(b);a.push(l)},update:function(){if(0!==a.length){var b=[],d,k;for(d=0;d<a.length;d++)b[d]=1E-6*c.getQueryObjectEXT(a[d],c.QUERY_RESULT_EXT),v.push(a[d]);a=[];for(d=0;d<h.length;d++){var m=h[d];for(k=m.startQueryIndex;k<=m.endQueryIndex;k++)m.stats.gpuTime+=b[k];w.push(m)}h=[]}},getNumPendingQueries:function(){return a.length},pushScopeStats:function(a,b,c){var d=w.pop()||new p;d.startQueryIndex=a;d.endQueryIndex=
b;d.stats=c;h.push(d)},clear:function(){for(var a=0;a<v.length;a++)c.deleteQueryEXT(v[a])}}}},{}],21:[function(d,l,r){l.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(d,l,r){function b(b){return Array.prototype.slice.call(b)}function k(c){return b(c).join("")}var p=d("./extend");l.exports=function(){function c(){var a=[],c=[];return p(function(){a.push.apply(a,b(arguments))},{def:function(){var k="v"+d++;
c.push(k);0<arguments.length&&(a.push(k,"="),a.push.apply(a,b(arguments)),a.push(";"));return k},toString:function(){return k([0<c.length?"var "+c+";":"",k(a)])}})}function a(){function a(c,h){d(c,h,"=",b.def(c,h),";")}var b=c(),d=c(),h=b.toString,k=d.toString;return p(b,{entry:b,exit:d,save:a,set:function(c,d,f){a(c,d);b(c,d,"=",f,";")},toString:function(){return h()+k()}})}var d=0,m=[],l=[],v=c(),w={};return{global:v,link:function(a){for(var b=0;b<l.length;++b)if(l[b]===a)return m[b];b="g"+d++;
m.push(b);l.push(a);return b},block:c,proc:function(b,c){function d(){var a="a"+h.length;h.push(a);return a}var h=[];c=c||0;for(var m=0;m<c;++m)d();var m=a(),l=m.toString;return w[b]=p(m,{arg:d,toString:function(){return k(["function(",h.join(),"){",l(),"}"])}})},scope:a,cond:function(){var c=k(arguments),d=a(),h=a(),m=d.toString,l=h.toString;return p(d,{then:function(){d.apply(d,b(arguments));return this},"else":function(){h.apply(h,b(arguments));return this},toString:function(){var a=l();a&&(a=
"else{"+a+"}");return k(["if(",c,"){",m(),"}",a])}})},compile:function(){var a=['"use strict";',v,"return {"];Object.keys(w).forEach(function(b){a.push('"',b,'":',w[b].toString(),",")});a.push("}");var b=k(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,m.concat(b)).apply(null,l)}}}},{"./extend":23}],23:[function(d,l,r){l.exports=function(b,d){for(var l=Object.keys(d),c=0;c<l.length;++c)b[l[c]]=d[l[c]];return b}},{}],24:[function(d,l,r){var b=d("./is-typed-array");
l.exports=function(d){return Array.isArray(d)||b(d)}},{"./is-typed-array":26}],25:[function(d,l,r){var b=d("./is-typed-array");l.exports=function(d){return!!d&&"object"===typeof d&&Array.isArray(d.shape)&&Array.isArray(d.stride)&&"number"===typeof d.offset&&d.shape.length===d.stride.length&&(Array.isArray(d.data)||b(d.data))}},{"./is-typed-array":26}],26:[function(d,l,r){var b=d("../constants/arraytypes.json");l.exports=function(d){return Object.prototype.toString.call(d)in b}},{"../constants/arraytypes.json":4}],
27:[function(d,l,r){l.exports=function(b,d){for(var l=Array(b),c=0;c<b;++c)l[c]=d(c);return l}},{}],28:[function(d,l,r){function b(a){var b,c;b=(65535<a)<<4;a>>>=b;c=(255<a)<<3;a>>>=c;b|=c;c=(15<a)<<2;a>>>=c;b|=c;c=(3<a)<<1;return b|c|a>>>c>>1}function k(a){a:{for(var d=16;268435456>=d;d*=16)if(a<=d){a=d;break a}a=0}d=c[b(a)>>2];return 0<d.length?d.pop():new ArrayBuffer(a)}function p(a){c[b(a.byteLength)>>2].push(a)}var c=d("./loop")(8,function(){return[]});l.exports={alloc:k,free:p,allocType:function(a,
b){var c=null;switch(a){case 5120:c=new Int8Array(k(b),0,b);break;case 5121:c=new Uint8Array(k(b),0,b);break;case 5122:c=new Int16Array(k(2*b),0,b);break;case 5123:c=new Uint16Array(k(2*b),0,b);break;case 5124:c=new Int32Array(k(4*b),0,b);break;case 5125:c=new Uint32Array(k(4*b),0,b);break;case 5126:c=new Float32Array(k(4*b),0,b);break;default:return null}return c.length!==b?c.subarray(0,b):c},freeType:function(a){p(a.buffer)}}},{"./loop":27}],29:[function(d,l,r){l.exports="function"===typeof requestAnimationFrame&&
"function"===typeof cancelAnimationFrame?{next:function(b){return requestAnimationFrame(b)},cancel:function(b){return cancelAnimationFrame(b)}}:{next:function(b){setTimeout(b,30)},cancel:clearTimeout}},{}],30:[function(d,l,r){var b=d("./pool"),k=new Float32Array(1),p=new Uint32Array(k.buffer);l.exports=function(c){for(var a=b.allocType(5123,c.length),d=0;d<c.length;++d)if(isNaN(c[d]))a[d]=65535;else if(Infinity===c[d])a[d]=31744;else if(-Infinity===c[d])a[d]=64512;else{k[0]=c[d];var m=p[0],l=m>>>
31<<15,v=(m<<1>>>24)-127,m=m>>13&1023;a[d]=-24>v?l:-14>v?l+(m+1024>>-14-v):15<v?l+31744:l+(v+15<<10)+m}return a}},{"./pool":28}],31:[function(d,l,r){l.exports=function(b){return Object.keys(b).map(function(d){return b[d]})}},{}],32:[function(d,l,r){function b(b,a){function d(){var a=window.innerWidth,h=window.innerHeight;b!==document.body&&(h=b.getBoundingClientRect(),a=h.right-h.left,h=h.top-h.bottom);m.width=v*a;m.height=v*h;p(m.style,{width:a+"px",height:h+"px"})}var m=document.createElement("canvas"),
l=k(m,a);p(m.style,{border:0,margin:0,padding:0,top:0,left:0});b.appendChild(m);b===document.body&&(m.style.position="absolute",p(b.style,{margin:0,padding:0}));var v=+l.options.pixelRatio;window.addEventListener("resize",d,!1);var w=l.options.onDestroy;l.options=p(p({},l.options),{onDestroy:function(){window.removeEventListener("resize",d);b.removeChild(m);w&&w()}});d();return l}function k(b,a){function d(a){try{return b.getContext(a,k)}catch(h){return null}}var k=a.glOptions||{};return{gl:d("webgl")||
d("experimental-webgl")||d("webgl-experimental"),options:p({pixelRatio:window.devicePixelRatio},a)}}var p=d("./util/extend");l.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],options:c[1]||{}};var a=document.body,d=c[1]||{};if("string"===typeof c[0])a=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)a=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],options:p({pixelRatio:1},
d)};d=c[0]}return a.nodeName&&"CANVAS"===a.nodeName.toUpperCase()?k(a,d):b(a,d)}},{"./util/extend":23}],33:[function(d,l,r){l.exports=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}},{}],34:[function(d,l,r){var b=d("./identity");l.exports=function(d,l,c,a){var h,m,A,v,w,u,n,r,x=l[0],t=l[1];l=l[2];A=a[0];v=a[1];m=a[2];n=c[0];a=c[1];h=c[2];if(1E-6>Math.abs(x-n)&&1E-6>Math.abs(t-a)&&1E-6>Math.abs(l-h))return b(d);
c=x-n;a=t-a;n=l-h;r=1/Math.sqrt(c*c+a*a+n*n);c*=r;a*=r;n*=r;h=v*n-m*a;m=m*c-A*n;A=A*a-v*c;(r=Math.sqrt(h*h+m*m+A*A))?(r=1/r,h*=r,m*=r,A*=r):A=m=h=0;v=a*A-n*m;w=n*h-c*A;u=c*m-a*h;(r=Math.sqrt(v*v+w*w+u*u))?(r=1/r,v*=r,w*=r,u*=r):u=w=v=0;d[0]=h;d[1]=v;d[2]=c;d[3]=0;d[4]=m;d[5]=w;d[6]=a;d[7]=0;d[8]=A;d[9]=u;d[10]=n;d[11]=0;d[12]=-(h*x+m*t+A*l);d[13]=-(v*x+w*t+u*l);d[14]=-(c*x+a*t+n*l);d[15]=1;return d}},{"./identity":33}],35:[function(d,l,r){l.exports=function(b,d,l,c,a){d=1/Math.tan(d/2);var h=1/(c-
a);b[0]=d/l;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=d;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=(a+c)*h;b[11]=-1;b[12]=0;b[13]=0;b[14]=2*a*c*h;b[15]=0;return b}},{}],36:[function(d,l,r){function b(a){throw Error("resl: "+a);}function k(a,c,d){Object.keys(a).forEach(function(a){0>c.indexOf(a)&&b('invalid parameter "'+a+'" in '+d)})}function p(a,b){this.state=0;this.ready=!1;this.progress=0;this.name=a;this.cancel=b}var c=["manifest","onDone","onProgress","onError"],a=["type","src","stream","credentials","parser"],
h=["onData","onDone"];l.exports=function(d){function l(a,c){if(a in d){var f=d[a];"function"!==typeof f&&b('invalid callback "'+a+'"');return f}return null}function v(a){function b(){if(!(2>k.readyState||1===l.state||-1===l.state)){if(200!==k.status)return u('error loading resource "'+a.name+'"');if(2<k.readyState&&0===l.state){var d;d="binary"===a.type?k.response:k.responseText;if(h.data)try{m=h.data(d)}catch(f){return u(f)}else m=d}if(3<k.readyState&&0===l.state){if(h.done)try{m=h.done()}catch(f){return u(f)}l.state=
1}H[c]=m;l.progress=.75*l.progress+.25;l.ready=a.stream&&!!m||1===l.state;n()}}var c=a.name,d=a.stream,f="binary"===a.type,h=a.parser,k=new XMLHttpRequest,m=null,l=new p(c,function(){1!==l.state&&-1!==l.state&&(k.onreadystatechange=null,k.abort(),l.state=-1)});k.onreadystatechange=d?b:function(){4===k.readyState&&b()};f&&(k.responseType="arraybuffer");a.credentials&&(k.withCredentials=!0);k.open("GET",a.src,!0);k.send();return l}function w(a,b){function c(){if(0===r.state)if(m.data)try{t=m.data(b)}catch(a){return u(a)}else t=
b}function d(b){c();H[l]=t;r.progress=b.lengthComputable?Math.max(r.progress,b.loaded/b.total):.75*r.progress+.25;r.ready=a.stream;n(l)}function f(){c();if(0===r.state){if(m.done)try{t=m.done()}catch(a){return u(a)}r.state=1}r.progress=1;r.ready=!0;H[l]=t;k();n("finish "+l)}function h(){u('error loading asset "'+l+'"')}function k(){a.stream&&b.removeEventListener("progress",d);"image"===a.type?b.addEventListener("load",f):b.addEventListener("canplay",f);b.removeEventListener("error",h)}var l=a.name,
m=a.parser,r=new p(l,function(){1!==r.state&&-1!==r.state&&(r.state=-1,k(),b.src="")}),t=b;a.stream&&b.addEventListener("progress",d);"image"===a.type?b.addEventListener("load",f):b.addEventListener("canplay",f);b.addEventListener("error",h);b.crossOrigin=a.credentials?"use-credentials":"anonymous";b.src=a.src;return r}function u(a){-1!==f&&1!==f&&(f=-1,E.forEach(function(a){a.cancel()}),K?"string"===typeof a?K(Error("resl: "+a)):K(a):console.error("resl error:",a))}function n(a){if(-1!==f&&1!==f){var b=
0,c=0;E.forEach(function(a){a.ready&&(c+=1);b+=a.progress});c===E.length?(f=1,x(H)):t&&t(b/E.length,a)}}"object"===typeof d&&d||b("invalid or missing configuration");k(d,c,"config");var r=d.manifest;"object"===typeof r&&r||b("missing manifest");var x=l("onDone");x||b("missing onDone() callback");var t=l("onProgress"),K=l("onError"),H={},f=0,W={text:v,binary:function(a){return v(a)},image:function(a){return w(a,document.createElement("img"))},video:function(a){return w(a,document.createElement("video"))},
audio:function(a){return w(a,document.createElement("audio"))}},E=Object.keys(r).map(function(c){function d(a,c){if(a in f.parser){var g=f.parser[a];"function"!==typeof g&&b("invalid parser callback "+a+' for asset "'+a+'"');return g}return c}var f=r[c];"string"===typeof f?f={src:f}:"object"===typeof f&&f||b('invalid asset definition "'+c+'"');k(f,a,'asset "'+c+'"');var l={};"parser"in f&&("function"===typeof f.parser?l={data:f.parser}:"object"===typeof f.parser&&f.parser?(k(l,h,'parser for asset "'+
c+'"'),"onData"in l||b('missing onData callback for parser in asset "'+c+'"'),l={data:d("onData"),done:d("onDone")}):b('invalid parser for asset "'+c+'"'));return{name:c,type:function(a,d,h){a in f&&(h=f[a]);0>d.indexOf(h)&&b("invalid "+a+' "'+h+'" for asset "'+c+'", possible values: '+d);return h}("type",Object.keys(W),"text"),stream:!!f.stream,credentials:!!f.credentials,src:function(a,d,h){a in f?h=f[a]:d&&b("missing "+a+' for asset "'+c+'"');"string"!==typeof h&&b("invalid "+a+' for asset "'+
c+'", must be a string');return h}("src",!0,""),parser:l}}).map(function(a){return W[a.type](a)})}},{}],37:[function(d,l,r){var b=d("./lib/util/extend"),k=d("./lib/dynamic"),p=d("./lib/util/raf"),c=d("./lib/util/clock"),a=d("./lib/strings"),h=d("./lib/webgl"),m=d("./lib/extension"),A=d("./lib/limits"),v=d("./lib/buffer"),w=d("./lib/elements"),u=d("./lib/texture"),n=d("./lib/renderbuffer"),J=d("./lib/framebuffer"),x=d("./lib/attribute"),t=d("./lib/shader"),K=d("./lib/read"),H=d("./lib/core"),f=d("./lib/stats"),
W=d("./lib/timer");l.exports=function(){function d(){R=p.next(d);G.tick+=1;G.time=(c()-la)/1E3;I();for(var a=0;a<Q.length;++a)(0,Q[a])(G,null,0);C.flush()}function g(a){}function l(a){}function r(a){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var f=a[c];k.isDynamic(f)?d[c]=k.unbox(f,c):b[c]=f});return{dynamic:d,"static":b}}function d(a){for(;t.length<a;)t.push(null);return t}var f=c(a.context||{}),g=c(a.uniforms||{}),h=c(a.attributes||{}),l=c(function(a){function c(a){if(a in d){var b=
d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=b({},a);delete d.uniforms;delete d.attributes;delete d.context;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(a));a={gpuTime:0};var f=U.compile(l,h,g,f,a),m=f.draw,n=f.batch,p=f.scope,t=[];return b(function(a,b){var c;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=
0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return m.call(this,a)},{stats:a})}function ka(){var a=fa.viewport,b=fa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;G.viewportWidth=G.framebufferWidth=G.drawingBufferWidth=a[2]=b[2]=C.drawingBufferWidth;G.viewportHeight=G.framebufferHeight=G.drawingBufferHeight=a[3]=b[3]=C.drawingBufferHeight}function I(){ka();
U.procs.poll()}function ga(){ka();U.procs.refresh()}var y=h(Array.prototype.slice.call(arguments)),C=y.gl,O=y.options,y=a(),X=f(),F=m(C).extensions,da=W(C,F),la=c(),P=C.drawingBufferWidth,M=C.drawingBufferHeight,G={tick:0,time:0,viewportWidth:P,viewportHeight:M,framebufferWidth:P,framebufferHeight:M,drawingBufferWidth:P,drawingBufferHeight:M,pixelRatio:O.pixelRatio},T=A(C,F),ha=v(C,X),qa=w(C,F,ha,X),P=x(C,F,T,ha,y),sa=t(C,y,X),ia=u(C,F,T,I,G,X),ra=n(C,F,T,X),na=J(C,F,T,ia,ra,X),M=K(C,I,G),U=H(C,y,
F,T,ha,qa,ia,na,{},P,sa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},G,da),fa=U.next,V=C.canvas,Q=[],R=0;V&&(V.addEventListener("webglcontextlost",g,!1),V.addEventListener("webglcontextrestored",l,!1));ga();return b(r,{clear:function(a){var b=0;U.procs.poll();var c=a.color;c&&(C.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(C.clearDepth(+a.depth),b|=256);"stencil"in a&&(C.clearStencil(a.stencil|0),b|=1024);C.clear(b)},prop:k.define.bind(null,1),context:k.define.bind(null,
2),"this":k.define.bind(null,3),draw:r({}),buffer:function(a){return ha.create(a,34962)},elements:qa.create,texture:ia.create2D,cube:ia.createCube,renderbuffer:ra.create,framebuffer:na.create,framebufferCube:function(a){},attributes:C.getContextAttributes(),frame:function(a){Q.push(a);!R&&0<Q.length&&d();return{cancel:function(){var b=Q.find(function(b){return b===a});0>b||(Q.splice(b,1),0>=Q.length&&R&&(p.cancel(d),R=0))}}},limits:T,hasExtension:function(a){return 0<=T.extensions.indexOf(a.toLowerCase())},
read:M,destroy:function(){R&&(p.cancel(d),R=0);V&&(V.removeEventListener("webglcontextlost",g),V.removeEventListener("webglcontextrestored",l));sa.clear();na.clear();ra.clear();ia.clear();qa.clear();ha.clear();da&&da.clear();if(O.onDestroy)O.onDestroy()},_gl:C,_refresh:ga,stats:X,updateTimer:function(){da&&da.update()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,
"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);
