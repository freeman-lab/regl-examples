(function e$$0(n,r,a){function k(p,h){if(!r[p]){if(!n[p]){var I="function"==typeof require&&require;if(!h&&I)return I(p,!0);if(l)return l(p,!0);I=Error("Cannot find module '"+p+"'");throw I.code="MODULE_NOT_FOUND",I;}I=r[p]={exports:{}};n[p][0].call(I.exports,function(l){var a=n[p][1][l];return k(a?a:l)},I,I.exports,e$$0,n,r,a)}return r[p].exports}for(var l="function"==typeof require&&require,h=0;h<a.length;h++)k(a[h]);return k})({1:[function(c,n,r){c=c("../regl")();c.clear({color:[0,0,0,1],depth:1});
c({frag:"\n  precision mediump float;\n  uniform vec4 color;\n  void main () {\n    gl_FragColor = color;\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  void main () {\n    gl_Position = vec4(position, 0, 1);\n  }",attributes:{position:[[-1,0],[0,-1],[1,1]]},uniforms:{color:[1,0,0,1]},count:3})()},{"../regl":30}],2:[function(c,n,r){function a(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=
this.offset=0}n.exports=function(k,l,h,p,b){k=h.maxAttributes;l=Array(k);for(h=0;h<k;++h)l[h]=new a;return{Record:a,scope:{},state:l}}},{}],3:[function(c,n,r){function a(l,a){switch(l){case 5121:return new Uint8Array(a);case 5123:return new Uint16Array(a);case 5125:return new Uint32Array(a);case 5120:return new Int8Array(a);case 5122:return new Int16Array(a);case 5124:return new Int32Array(a);case 5126:return new Float32Array(a);default:return null}}var k=c("./util/is-typed-array"),l=c("./util/is-ndarray"),
h=c("./constants/arraytypes.json"),p=c("./constants/dtypes.json"),b=c("./util/values"),I={"static":35044,dynamic:35048,stream:35040};n.exports=function(c){function n(a){this.id=B++;this.buffer=null;this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function z(a){c.isBuffer(a.buffer)||(a.buffer=c.createBuffer());a.bind();c.bufferData(a.type,a.data||a.byteLength,a.usage)}function v(a){var l=a.buffer;c.isBuffer(l)&&c.deleteBuffer(l);a.buffer=null;delete d[a.id]}
function t(b,c,t){function B(d){var b=d||{};if(Array.isArray(b)||k(b)||l(b))b={data:b};else if("number"===typeof b)b={length:b|0};else if(null===b||void 0===b)b={};C.usage="usage"in b?I[b.usage]:35044;d=0;"type"in b&&(d=p[b.type]);var c=b.dimension|0||1,t=0,u=null;if("data"in b)if(u=b.data,null===u)t=b.length|0;else{if(l(u)){var c=u.shape,t=u.stride,b=u.offset,w=0,F=0,v=0,y=0;1===c.length?(w=c[0],F=1,v=t[0],y=0):2===c.length&&(w=c[0],F=c[1],v=t[0],y=t[1]);d=d||h[Object.prototype.toString.call(u.data)]|
0||5126;for(var c=F,t=a(d,w*F),u=u.data,n=0,K=0;K<w;++K)for(var x=0;x<F;++x)t[n++]=u[v*K+y*x+b];u=t}else if(Array.isArray(u))if(0<u.length&&Array.isArray(u[0])){c=u[0].length;d=d||5126;b=a(d,u.length*c);t=u;u=c;for(w=y=0;w<t.length;++w)for(v=t[w],F=0;F<u;++F)b[y++]=v[F];u=b}else d=d||5126,u=a(d,u);else d=d||h[Object.prototype.toString.call(u)]|0;t=u.byteLength}else"length"in b&&(t=b.length|0);C.data=u;C.dtype=d||5121;C.byteLength=t;C.dimension=c;z(C);return B}var C=new n(c);d[C.id]=C;t||B(b);B._reglType=
"buffer";B._buffer=C;B.destroy=function(){v(C)};return B}var B=0,d={};n.prototype.bind=function(){c.bindBuffer(this.type,this.buffer)};return{create:t,createStream:function(a){return t({data:a,usage:"stream"},34962,!1)._buffer},destroyStream:function(a){v(a)},clear:function(){b(d).forEach(v)},refresh:function(){b(d).forEach(z)},getBuffer:function(a){return a&&a._buffer instanceof n?a._buffer:null}}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./util/is-ndarray":21,"./util/is-typed-array":22,
"./util/values":28}],4:[function(c,n,r){n.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(c,n,r){n.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],6:[function(c,n,r){n.exports={points:0,point:0,
lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(c,n,r){function a(a){return Array.isArray(a)||V(a)||z(a)}function k(a){return a.sort(function(a,d){return"viewport"===a?-1:"viewport"===d?1:a<d?-1:1})}function l(a,d,l,b){this.thisDep=a;this.contextDep=d;this.propDep=l;this.append=b}function h(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function p(a){return new l(!1,!1,!1,a)}function b(a,d){var b=a.type;return 0===b?(b=a.data.length,
new l(!0,1<=b,2<=b,d)):new l(3===b,2===b,1===b,d)}var I=c("./util/codegen"),x=c("./util/loop"),V=c("./util/is-typed-array"),z=c("./util/is-ndarray"),v=c("./constants/primitives.json"),t=c("./constants/dtypes.json"),B=["x","y","z","w"],d={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,
"one minus constant alpha":32772,"src alpha saturate":776},u={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},y={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},K={cw:2304,ccw:2305},ba=new l(!1,!1,!1,function(){});n.exports=function(c,n,z,r,W,G,w,F,fa,Q,Y,ga,L){function O(e){return e.replace(".","_")}function E(e,
m,a){var g=O(e);ra.push(e);oa[g]=ja[g]=!!a;ka[g]=m}function A(e,m,a){var g=O(e);ra.push(e);Array.isArray(a)?(ja[g]=a.slice(),oa[g]=a.slice()):ja[g]=oa[g]=a;la[g]=m}function P(){var e=I(),m=e.link,a=e.global;e.id=Ca++;e.batchId="0";var g=m(za),d=e.shared={props:"a0"};Object.keys(za).forEach(function(f){d[f]=a.def(g,".",f)});var D=e.next={},b=e.current={};Object.keys(la).forEach(function(f){Array.isArray(ja[f])&&(D[f]=a.def(d.next,".",f),b[f]=a.def(d.current,".",f))});var f=e.constants={};Object.keys(sa).forEach(function(e){f[e]=
a.def(JSON.stringify(sa[e]))});e.invoke=function(f,S){switch(S.type){case 0:var a=["this",d.context,d.props,e.batchId];return f.def(m(S.data),".call(",a.slice(0,Math.max(S.data.length+1,4)),")");case 1:return f.def(d.props,S.data);case 2:return f.def(d.context,S.data);case 3:return f.def("this",S.data)}};e.attribCache={};var S={};e.scopeAttrib=function(f){f=n.id(f);if(f in S)return S[f];var e=Q.scope[f];e||(e=Q.scope[f]=new pa);return S[f]=m(e)};return e}function ca(e){var m=e["static"];e=e.dynamic;
if("framebuffer"in m){var a=m.framebuffer;return a?(a=F.getFramebuffer(a),p(function(e,m){var g=e.link(a),f=e.shared;m.set(f.framebuffer,".next",g);f=f.context;m.set(f,".framebufferWidth",g+".width");m.set(f,".framebufferHeight",g+".height");return g})):p(function(e,m){var a=e.shared;m.set(a.framebuffer,".next","null");a=a.context;m.set(a,".framebufferWidth",a+".drawingBufferWidth");m.set(a,".framebufferHeight",a+".drawingBufferHeight");return null})}if("framebuffer"in e){var g=e.framebuffer;return b(g,
function(e,m){var a=e.invoke(m,g),f=e.shared,S=f.framebuffer,a=m.def(S,".getFramebuffer(",a,")");m.set(S,".next",a);f=f.context;m.set(f,".framebufferWidth",a+"?"+a+".width:"+f+".drawingBufferWidth");m.set(f,".framebufferHeight",a+"?"+a+".height:"+f+".drawingBufferHeight");return a})}return null}function Z(e,a){function m(f){if(f in g){var e=g[f];f=!0;var ia=e.x|0,Aa=e.y|0,D,q;"w"in e?D=e.w|0:f=!1;"h"in e?q=e.h|0:f=!1;return new l(f&&a&&a.thisDep,f&&a&&a.contextDep,f&&a&&a.propDep,function(f,a){var m=
f.shared.context,g=D;"w"in e||(g=a.def(m,".","framebufferWidth","-",ia));var d=q;"h"in e||(d=a.def(m,".","framebufferHeight","-",Aa));return[ia,Aa,g,d]})}if(f in d){var na=d[f];f=b(na,function(f,a){var e=f.invoke(a,na),m=f.shared.context,g=a.def(e,".x|0"),S=a.def(e,".y|0"),ia=a.def('"w" in ',e,"?",e,".w|0:","(",m,".","framebufferWidth","-",g,")"),e=a.def('"h" in ',e,"?",e,".h|0:","(",m,".","framebufferHeight","-",S,")");return[g,S,ia,e]});a&&(f.thisDep=f.thisDep||a.thisDep,f.contextDep=f.contextDep||
a.contextDep,f.propDep=f.propDep||a.prpoDep);return f}return a?new l(a.thisDep,a.contextDep,a.propDep,function(f,e){var a=f.shared.context;return[0,0,e.def(a,".","framebufferWidth"),e.def(a,".","framebufferHeight")]}):null}var g=e["static"],d=e.dynamic,D=m("viewport");if(D)var q=D,D=new l(D.thisDep,D.contextDep,D.propDep,function(f,e){var a=q.append(f,e),m=f.shared.context;e.set(m,".viewportWidth",a[2]);e.set(m,".viewportHeight",a[3]);return a});return{viewport:D,scissor_box:m("scissor.box")}}function J(e){function a(f){if(f in
m){var e=n.id(m[f]);f=p(function(){return e});f.id=e;return f}if(f in g){var d=g[f];return b(d,function(f,e){var a=f.invoke(e,d);return e.def(f.shared.strings,".id(",a,")")})}return null}var m=e["static"],g=e.dynamic,d=a("frag"),D=a("vert"),q=null;h(d)&&h(D)?(q=Y.program(D.id,d.id),e=p(function(f,e){return f.link(q)})):e=new l(d&&d.thisDep||D&&D.thisDep,d&&d.contextDep||D&&D.contextDep,d&&d.propDep||D&&D.propDep,function(f,e){var a=f.shared.shader,m;m=d?d.append(f,e):e.def(a,".","frag");var g;g=D?
D.append(f,e):e.def(a,".","vert");return e.def(a+".program("+g+","+m+")")});return{frag:d,vert:D,progVar:e,program:q}}function H(e){function m(e,f){if(e in g){var a=g[e]|0;return p(function(e,m){f&&(e.OFFSET=a);return a})}if(e in d){var ia=d[e];return b(ia,function(e,a){var m=e.invoke(a,ia);f&&(e.OFFSET=m);return m})}return f&&q?p(function(f,e){f.OFFSET="0";return 0}):null}var g=e["static"],d=e.dynamic,q=function(){if("elements"in g){var e=g.elements;a(e)?e=G.getElements(G.create(e)):e&&(e=G.getElements(e));
var f=p(function(f,a){if(e){var m=f.link(e);return f.ELEMENTS=m}return f.ELEMENTS=null});f.value=e;return f}if("elements"in d){var m=d.elements;return b(m,function(f,e){var a=f.shared,g=a.isBufferArgs,a=a.elements,d=f.invoke(e,m),q=e.def("null"),g=e.def(g,"(",d,")"),d=f.cond(g).then(q,"=",a,".createStream(",d,");")["else"](q,"=",a,".getElements(",d,");");e.entry(d);e.exit(f.cond(g).then(a,".destroyStream(",q,");"));return f.ELEMENTS=q})}return null}(),D=m("offset",!0);return{elements:q,primitive:function(){if("primitive"in
g){var e=g.primitive;return p(function(f,a){return v[e]})}if("primitive"in d){var f=d.primitive;return b(f,function(e,a){var m=e.constants.primTypes,g=e.invoke(a,f);return a.def(m,"[",g,"]")})}return q?h(q)?q.value?p(function(f,e){return e.def(f.ELEMENTS,".primType")}):p(function(){return 4}):new l(q.thisDep,q.contextDep,q.propDep,function(f,e){var a=f.ELEMENTS;return e.def(a,"?",a,".primType:",4)}):null}(),count:function(){if("count"in g){var e=g.count|0;return p(function(){return e})}if("count"in
d){var f=d.count;return b(f,function(e,a){return e.invoke(a,f)})}return q?h(q)?q?D?new l(D.thisDep,D.contextDep,D.propDep,function(f,e){return e.def(f.ELEMENTS,".vertCount-",f.OFFSET)}):p(function(f,e){return e.def(f.ELEMENTS,".vertCount")}):p(function(){return-1}):new l(q.thisDep||D.thisDep,q.contextDep||D.contextDep,q.propDep||D.propDep,function(f,e){var a=f.ELEMENTS;return f.OFFSET?e.def(a,"?",a,".vertCount-",f.OFFSET,":-1"):e.def(a,"?",a,".vertCount:-1")}):null}(),instances:m("instances",!1),
offset:D}}function T(e){var a=e["static"],m=e.dynamic,g={};ra.forEach(function(e){function q(f,d){if(e in a){var ia=f(a[e]);g[l]=p(function(){return ia})}else if(e in m){var D=m[e];g[l]=b(D,function(f,e){return d(f,e,f.invoke(e,D))})}}var l=O(e);switch(e){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return q(function(f){return f},function(f,
e,a){return a});case "depth.func":return q(function(f){return u[f]},function(f,e,a){return e.def(f.constants.compareFuncs,"[",a,"]")});case "depth.range":return q(function(f){return f},function(f,e,a){f=e.def("+",a,"[0]");e=e.def("+",a,"[1]");return[f,e]});case "blend.func":return q(function(f){return[d["srcRGB"in f?f.srcRGB:f.src],d["dstRGB"in f?f.dstRGB:f.dst],d["srcAlpha"in f?f.srcAlpha:f.src],d["dstAlpha"in f?f.dstAlpha:f.dst]]},function(f,e,a){function m(f,d){var q=e.def('"',f,d,'" in ',a,"?",
a,".",f,d,":",a,".",f);return e.def(g,"[",q,"]")}var g=f.constants.blendFuncs;f=m("src","RGB");var d=m("src","Alpha"),q=m("dst","RGB"),ha=m("dst","Alpha");return[f,q,d,ha]});case "blend.equation":return q(function(f){if("string"===typeof f)return[ma[f],ma[f]];if("object"===typeof f)return[ma[f.rgb],ma[f.alpha]]},function(f,e,a){var m=f.constants.blendEquations,g=e.def(),d=e.def();f=f.cond("typeof ",a,'==="string"');f.then(g,"=",d,"=",m,"[",a,"];");f["else"](g,"=",m,"[",a,".rgb];",d,"=",m,"[",a,".alpha];");
e(f);return[g,d]});case "blend.color":return q(function(f){return x(4,function(e){return+f[e]})},function(f,e,a){return x(4,function(f){return e.def("+",a,"[",f,"]")})});case "stencil.mask":return q(function(f){return f|0},function(f,e,a){return e.def(a,"|0")});case "stencil.func":return q(function(f){return[u[f.cmp||"keep"],f.ref||0,"mask"in f?f.mask:-1]},function(f,e,a){f=e.def('"cmp" in ',a,"?",f.constants.compareFuncs,"[",a,".cmp]",":",7680);var m=e.def(a,".ref|0");e=e.def('"mask" in ',a,"?",
a,".mask|0:-1");return[f,m,e]});case "stencil.opFront":case "stencil.opBack":return q(function(f){return["stencil.opBack"===e?1029:1028,y[f.fail||"keep"],y[f.zfail||"keep"],y[f.pass||"keep"]]},function(f,a,m){function g(f){return a.def('"',f,'" in ',m,"?",d,"[",m,".",f,"]:",7680)}var d=f.constants.stencilOps;return["stencil.opBack"===e?1029:1028,g("fail"),g("zfail"),g("pass")]});case "polygonOffset.offset":return q(function(f){return[f.factor|0,f.units|0]},function(f,e,a){f=e.def(a,".factor|0");e=
e.def(a,".units|0");return[f,e]});case "cull.face":return q(function(f){var e=0;"front"===f?e=1028:"back"===f&&(e=1029);return e},function(f,e,a){return e.def(a,'==="front"?',1028,":",1029)});case "lineWidth":return q(function(e){return e},function(e,a,m){return m});case "frontFace":return q(function(e){return K[e]},function(e,a,m){return a.def(m+'==="cw"?2304:2305')});case "colorMask":return q(function(e){return e.map(function(e){return!!e})},function(e,a,m){return x(4,function(e){return"!!"+m+"["+
e+"]"})});case "sample.coverage":return q(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,a,m){e=a.def('"value" in ',m,"?+",m,".value:1");a=a.def("!!",m,".invert");return[e,a]})}});return g}function R(e){var a=e["static"],m=e.dynamic,g={};Object.keys(a).forEach(function(e){var m=a[e],d;if("number"===typeof m||"boolean"===typeof m)d=p(function(){return m});else if("function"===typeof m&&"texture"===m._reglType)d=p(function(e){return e.link(m)});else if(Array.isArray(m)||V(m))d=p(function(e){return e.global.def("[",
x(m.length,function(e){return m[e]}),"]")});d.value=m;g[e]=d});Object.keys(m).forEach(function(e){var a=m[e];g[e]=b(a,function(e,f){return e.invoke(f,a)})});return g}function aa(e){var m=e["static"],g=e.dynamic,d={};Object.keys(m).forEach(function(e){var g=m[e],q=n.id(e),f=new pa;if(a(g))f.state=1,f.buffer=W.getBuffer(W.create(g,34962,!1)),f.type=f.buffer.dtype;else{var b=W.getBuffer(g);if(b)f.state=1,f.buffer=b,f.type=b.dtype;else if(g.constant){var l=g.constant;f.state=2;"number"===typeof l?f.x=
l:B.forEach(function(e,a){a<l.length&&(f[e]=l[a])})}else{var b=W.getBuffer(g.buffer),k=g.offset|0,h=g.stride|0,c=g.size|0,U=!!g.normalized,na=0;"type"in g&&(na=t[g.type]);g=g.divisor|0;f.buffer=b;f.state=1;f.size=c;f.normalized=U;f.type=na||b.dtype;f.offset=k;f.stride=h;f.divisor=g}}d[e]=p(function(e,a){var m=e.attribCache;if(q in m)return m[q];var g={isStream:!1};Object.keys(f).forEach(function(e){g[e]=f[e]});f.buffer&&(g.buffer=e.link(f.buffer));return m[q]=g})});Object.keys(g).forEach(function(e){var a=
g[e];d[e]=b(a,function(e,f){function m(e){f(l[e],"=",g,".",e,"|0;")}var g=e.invoke(f,a),d=e.shared,q=d.isBufferArgs,b=d.buffer,l={isStream:f.def(!1)},ha=new pa;ha.state=1;Object.keys(ha).forEach(function(e){l[e]=f.def(""+ha[e])});var p=l.buffer,k=l.type;f("if(",q,"(",g,")){",l.isStream,"=true;",p,"=",b,".createStream(",g,");",k,"=",p,".dtype;","}else{",p,"=",b,".getBuffer(",g,");","if(",p,"){",k,"=",p,".dtype;","}else if(",g,".constant){",l.state,"=",2,";",B.map(function(e,a){return l[e]+"="+g+".length>="+
a+"?"+g+"["+a+"]:0;"}).join(""),"}else{",p,"=",b,".getBuffer(",g,".buffer);",k,'="type" in ',g,"?",d.glTypes,"[",g,".type]:",p,".dtype;",l.normalized,"=!!",g,".normalized;");m("size");m("offset");m("stride");m("divisor");f("}}");return l})});return d}function M(e){var a=e["static"],m=e.dynamic,g={};Object.keys(a).forEach(function(e){var m=a[e];g[e]=p(function(e,a){return"number"===typeof m||"boolean"===typeof m?""+m:e.link(m)})});Object.keys(m).forEach(function(e){var a=m[e];g[e]=b(a,function(e,f){return e.invoke(f,
a)})});return g}function N(e,a,m){var g=e.shared.context,d=e.scope();Object.keys(m).forEach(function(q){a.save(g,"."+q);d(g,".",q,"=",m[q].append(e,a),";")});a(d)}function m(e,a,m){var g=e.shared,d=g.gl,q=g.framebuffer,l;ta&&(l=a.def(g.extensions,".webgl_draw_buffers"));var f=e.constants,g=f.drawBuffers,f=f.backBuffer;e=m?m.append(e,a):a.def(q,".next");a("if(",q,".dirty||",e,"!==",q,".cur){","if(",e,"){",d,".bindFramebuffer(",36160,",",e,".framebuffer);");ta&&a(l,".drawBuffersWEBGL(",g,"[",e,".colorAttachments.length]);");
a("}else{",d,".bindFramebuffer(",36160,",null);");ta&&a(l,".drawBuffersWEBGL(",f,");");a("}",q,".cur=",e,";",q,".dirty=false;","}")}function q(e,a,m){var g=e.shared,d=g.gl,q=e.current,l=e.next,f=g.current,b=g.next,p=e.cond(f,".dirty");ra.forEach(function(a){a=O(a);if(!(a in m.state)){var g,ha;if(a in l){g=l[a];ha=q[a];var k=x(ja[a].length,function(e){return p.def(g,"[",e,"]")});p(e.cond(k.map(function(e,a){return e+"==="+ha+"["+a+"]"}).join("&&")).then(d,".",la[a],"(",k,");",k.map(function(e,a){return ha+
"["+a+"]="+e}).join(";"),";"))}else g=p.def(b,".",a),k=e.cond(g,"!==",f,".",a),p(k),a in ka?k(e.cond(g).then(d,".enable(",ka[a],");")["else"](d,".disable(",ka[a],");"),f,".",a,"=",g,";"):k(d,".",la[a],"(",g,");",f,".",a,"=",g,";")}});0===Object.keys(m.state).length&&p(f,".dirty=false;");a(p)}function g(e,a,m,g){var d=e.shared,q=e.current,l=d.current,f=d.gl;k(Object.keys(m)).forEach(function(d){var b=m[d];if(!g||g(b)){var p=b.append(e,a);if(ka[d]){var k=ka[d];h(b)?p?a(f,".enable(",k,");"):a(f,".disable(",
k,");"):a(e.cond(p).then(f,".enable(",k,");")["else"](f,".disable(",k,");"));a(l,".",d,"=",p,";")}else if(Array.isArray(p)){var c=q[d];a(f,".",la[d],"(",p,");",p.map(function(e,a){return c+"["+a+"]="+e}).join(";"),";")}else a(f,".",la[d],"(",p,");",l,".",d,"=",p,";")}})}function U(e,a){qa&&!e.instancing&&(e.instancing=a.def(e.shared.extensions,".angle_instanced_arrays"))}function ua(e,a,m,g,d){function q(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;
case 35666:case 35669:case 35673:return 4;default:return 1}}function l(m,g,d){function q(){a("if(!",h,".pointer){",p,".enableVertexAttribArray(",k,");",h,".pointer=true;}");var f=d.type,m;m=d.size?a.def(d.size,"||",g):g;a("if(",h,".type!==",f,"||",h,".size!==",m,"||",u.map(function(e){return h+"."+e+"!=="+d[e]}).join("||"),"){",p,".bindBuffer(",34962,",",c,".buffer);",p,".vertexAttribPointer(",[k,m,f,d.normalized,d.stride,d.offset],");",h,".type=",f,";",h,".size=",m,";",u.map(function(e){return h+
"."+e+"="+d[e]+";"}).join(""),"}");qa&&(f=d.divisor,a("if(",h,".divisor!==",f,"){",e.instancing,".vertexAttribDivisorANGLE(",[k,f],");",h,".divisor=",f,";}"))}function b(){a("if(",h,".pointer){",p,".disableVertexAttribArray(",k,");",h,".pointer=false;","}if(",B.map(function(e,a){return h+"."+e+"!=="+U[a]}).join("||"),"){",p,".vertexAttrib4f(",k,",",U,");",B.map(function(e,a){return h+"."+e+"="+U[a]+";"}).join(""),"}")}var p=f.gl,k=a.def(m,".location"),h=a.def(f.attributes,"[",k,"]");m=d.state;var c=
d.buffer,U=[d.x,d.y,d.z,d.w],u=["buffer","normalized","offset","stride"];1===m?q():2===m?b():(a("if(",m,"===",1,"){"),q(),a("}else{"),b(),a("}"))}var f=e.shared;g.forEach(function(f){var g=f.name,b=m.attributes[g],p;if(b){if(!d(b))return;p=b.append(e,a)}else{if(!d(ba))return;var k=e.scopeAttrib(g);p={};Object.keys(new pa).forEach(function(e){p[e]=a.def(k,".",e)})}l(e.link(f),q(f.info.type),p)})}function va(e,a,m,g,d){for(var q=e.shared,b=q.gl,f,l=0;l<g.length;++l){var p=g[l],k=p.name,h=p.info.type,
c=m.uniforms[k],p=e.link(p)+".location";if(c){if(!d(c))continue;if(c["static"]){k=c.value;if(35678===h||35680===h)h=e.link(k._texture),a(b,".uniform1i(",p,h+".bind());"),a.exit(h,".unbind()");else if(35674===h||35675===h||35676===h)k=e.global.def("["+k+"]"),c=2,35675===h?c=3:35676===h&&(c=4),a(b,".uniformMatrix",c,"fv(",p,",false,",k,");");else{switch(h){case 5126:f="1f";break;case 35664:f="2f";break;case 35665:f="3f";break;case 35666:f="4f";break;case 35670:f="1i";break;case 5124:f="1i";break;case 35671:f=
"2i";break;case 35667:f="2i";break;case 35672:f="3i";break;case 35668:f="3i";break;case 35673:f="4i";break;case 35669:f="4i"}a(b,".uniform",f,"(",p,",",k,");")}continue}else k=c.append(e,a)}else{if(!d(ba))continue;k=a.def(q.uniforms,"[",n.id(k),"]")}c=",";switch(h){case 35678:case 35680:h=a.def(k,"._texture");a(b,".uniform1i(",p,",",h,".bind());");a.exit(h,".unbind();");continue;case 5124:case 35670:f="1i";break;case 35667:case 35671:f="2iv";break;case 35668:case 35672:f="3iv";break;case 35669:case 35673:f=
"4iv";break;case 5126:f="1f";break;case 35664:f="2fv";break;case 35665:f="3fv";break;case 35666:f="4fv";break;case 35674:f="Matrix2fv";c=",false,";break;case 35675:f="Matrix3fv";c=",false,";break;case 35676:f="Matrix4fv",c=",false,"}a(b,".uniform",f,"(",p,c,k,");")}}function wa(e,a,m,g){function d(f){var g=k[f];return g?g.batchStatic?g.append(e,a):g.append(e,m):a.def(p,".",f)}function q(){function e(){m(v,".drawElementsInstancedANGLE(",[U,t,F,u+"<<(("+F+"-5121)>>1)",w],");")}function a(){m(v,".drawArraysInstancedANGLE(",
[U,u,t,w],");")}c?y?e():(m("if(",c,"){"),e(),m("}else{"),a(),m("}")):a()}function b(){function e(){m(l+".drawElements("+[U,t,F,u+"<<(("+F+"-5121)>>1)"]+");")}function a(){m(l+".drawArrays("+[U,u,t]+");")}c?y?e():(m("if(",c,"){"),e(),m("}else{"),a(),m("}")):a()}var f=e.shared,l=f.gl,p=f.draw,k=g.draw,c=function(){var f=k.elements,g=a;f?(f.batchStatic||(g=m),f=f.append(e,g)):f=g.def(p,".","elements");f&&g("if("+f+")"+l+".bindBuffer(34963,"+f+".buffer.buffer);");return f}(),U=d("primitive"),u=d("offset"),
t=function(){var f=k.count,g=a;f?(f.batchStatic||(g=m),f=f.append(e,g)):f=g.def(p,".","count");return f}();if("number"===typeof t){if(0===t)return}else m("if(",t,"){"),m.exit("}");var w,v;qa&&(w=d("instances"),v=e.instancing);var F=c+".type",y=k.elements&&h(k.elements);qa&&("number"!==typeof w||0<=w)?"string"===typeof w?(m("if(",w,">0){"),q(),m("}else if(",w,"<0){"),b(),m("}")):q():b()}function xa(e,a,m,g,d){a=P();d=a.proc("body",d);qa&&(a.instancing=d.def(a.shared.extensions,".angle_instanced_arrays"));
e(a,d,m,g);return a.compile().body}function Ba(e,a,m,g){U(e,a);ua(e,a,m,g.attributes,function(){return!0});va(e,a,m,g.uniforms,function(){return!0});wa(e,a,a,m)}function Da(e,a){var d=e.proc("draw",1);U(e,d);N(e,d,a.context);m(e,d,a.framebuffer);q(e,d,a);g(e,d,a.state);var b=a.shader.progVar.append(e,d);d(e.shared.gl,".useProgram(",b,".program);");if(a.shader.program)Ba(e,d,a,a.shader.program);else{var l=e.global.def("{}"),p=d.def(b,".id"),k=d.def(l,"[",p,"]");d(e.cond(k).then(k,".call(this,a0);")["else"](k,
"=",l,"[",p,"]=",e.link(function(f){return xa(Ba,e,a,f,1)}),"(",b,");",k,".call(this,a0);"))}0<Object.keys(a.state).length&&d(e.shared.current,".dirty=true;")}function Ea(a,m,g,d){function q(){return!0}a.batchId="a1";U(a,m);ua(a,m,g,d.attributes,q);va(a,m,g,d.uniforms,q);wa(a,m,m,g)}function ya(a,d,q,b){function l(a){return a.contextDep&&k||a.propDep}function p(a){return!l(a)}U(a,d);var k=q.contextDynamic,f=d.def(),h=d.def();a.shared.props=h;a.batchId=f;var c=a.scope(),u=a.scope();d(c.entry,"for(",
f,"=0;",f,"<","a1",";++",f,"){",h,"=","a0","[",f,"];",u,"}",c.exit);q.needsContext&&N(a,u,q.context);q.needsFramebuffer&&m(a,u,q.framebuffer);g(a,u,q.state,l);b?(ua(a,c,q,b.attributes,p),ua(a,u,q,b.attributes,l),va(a,c,q,b.uniforms,p),va(a,u,q,b.uniforms,l),wa(a,c,u,q)):(d=a.global.def("{}"),b=q.shader.progVar.append(a,u),h=u.def(b,".id"),c=u.def(d,"[",h,"]"),u(a.shared.gl,".useProgram(",b,".program);","if(!",c,"){",c,"=",d,"[",h,"]=",a.link(function(f){return xa(Ea,a,q,f,2)}),"(",b,");}",c,".call(this,a0[",
f,"],",f,");"))}function Fa(a,d){var b=a.proc("batch",2);a.batchId="0";U(a,b);var l=!1,p=!0;Object.keys(d.context).forEach(function(a){l=l||d.context[a].propDep});l||(N(a,b,d.context),p=!1);var k=d.framebuffer,h=!1;k&&(k.propDep?l=h=!0:k.contextDep&&l&&(h=!0),h||m(a,b,k));d.state.viewport&&d.state.viewport.propDynamic&&(l=!0);q(a,b,d);g(a,b,d.state,function(a){return!(a.contextDep&&l||a.propDep)});d.contextDep=l;d.needsContext=p;d.needsFramebuffer=h;p=d.shader.progVar;if(p.contextDep&&l||p.propDep)ya(a,
b,d,null);else if(p=p.append(a,b),b(a.shared.gl,".useProgram(",p,".program);"),d.shader.program)ya(a,b,d,d.shader.program);else{var k=a.global.def("{}"),h=b.def(p,".id"),f=b.def(k,"[",h,"]");b(a.cond(f).then(f,".call(this,a0,a1);")["else"](f,"=",k,"[",h,"]=",a.link(function(f){return xa(ya,a,d,f,2)}),"(",p,");",f,".call(this,a0,a1);"))}0<Object.keys(d.state).length&&b(a.shared.current,".dirty=true;")}function Ga(a,m){function g(b){var f=m.shader[b];f&&d.set(q.shader,"."+b,f.append(a,d))}var d=a.proc("scope",
3);a.batchId="a2";var q=a.shared,b=q.current;N(a,d,m.context);m.framebuffer&&m.framebuffer.append(a,d);k(Object.keys(m.state)).forEach(function(g){var f=m.state[g].append(a,d);Array.isArray(f)?f.forEach(function(m,f){d.set(a.next[g],"["+f+"]",m)}):d.set(q.next,"."+g,f)});["elements","offset","count","instances","primitive"].forEach(function(g){var f=m.draw[g];f&&d.set(q.draw,"."+g,""+f.append(a,d))});Object.keys(m.uniforms).forEach(function(g){d.set(q.uniforms,"["+n.id(g)+"]",m.uniforms[g].append(a,
d))});Object.keys(m.attributes).forEach(function(g){var f=m.attributes[g].append(a,d),q=a.scopeAttrib(g);Object.keys(new pa).forEach(function(a){d.set(q,"."+a,f[a])})});g("vert");g("frag");0<Object.keys(m.state).length&&(d(b,".dirty=true;"),d.exit(b,".dirty=true;"));d("a1(",a.shared.context,",a0,0);")}var pa=Q.Record,ma={add:32774,subtract:32778,"reverse subtract":32779};z.ext_blend_minmax&&(ma.min=32775,ma.max=32776);var qa=z.angle_instanced_arrays,ta=z.webgl_draw_buffers,ja={dirty:!0},oa={},ra=
[],ka={},la={};E("dither",3024);E("blend.enable",3042);A("blend.color","blendColor",[0,0,0,0]);A("blend.equation","blendEquationSeparate",[32774,32774]);A("blend.func","blendFuncSeparate",[1,0,1,0]);E("depth.enable",2929,!0);A("depth.func","depthFunc",513);A("depth.range","depthRange",[0,1]);A("depth.mask","depthMask",!0);A("colorMask","colorMask",[!0,!0,!0,!0]);E("cull.enable",2884);A("cull.face","cullFace",1029);A("frontFace","frontFace",2305);A("lineWidth","lineWidth",1);E("polygonOffset.enable",
32823);A("polygonOffset.offset","polygonOffset",[0,0]);E("sample.alpha",32926);E("sample.enable",32928);A("sample.coverage","sampleCoverage",[1,!1]);E("stencil.enable",2960);A("stencil.mask","stencilMask",-1);A("stencil.func","stencilFunc",[519,0,-1]);A("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);A("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);E("scissor.enable",3089);A("scissor.box","scissor",[0,0,c.drawingBufferWidth,c.drawingBufferHeight]);A("viewport","viewport",
[0,0,c.drawingBufferWidth,c.drawingBufferHeight]);var za={gl:c,context:L,strings:n,next:oa,current:ja,draw:ga,elements:G,buffer:W,shader:Y,attributes:Q.state,uniforms:fa,framebuffer:F,extensions:z,isBufferArgs:a},sa={primTypes:v,compareFuncs:u,blendFuncs:d,blendEquations:ma,stencilOps:y,glTypes:t,orientationType:K};ta&&(sa.backBuffer=[1029],sa.drawBuffer=x(r.maxDrawbuffers,function(a){return x(a,function(a){return 36064+a})}));var Ca=0;return{next:oa,current:ja,procs:function(){var a=P(),g=a.proc("poll"),
d=a.proc("refresh"),q=a.block();g(q);d(q);var b=a.shared,l=b.gl,p=b.next,f=b.current;q(f,".dirty=false;");m(a,g);d(b.framebuffer,".dirty=true;");m(a,d);Object.keys(ka).forEach(function(m){var b=ka[m],k=q.def(p,".",m),h=a.block();h("if(",k,"){",l,".enable(",b,")}else{",l,".disable(",b,")}",f,".",m,"=",k,";");d(h);g("if(",k,"!==",f,".",m,"){",h,"}")});Object.keys(la).forEach(function(m){var b=la[m],k=ja[m],h,c,u=a.block();u(l,".",b,"(");Array.isArray(k)?(b=k.length,h=a.global.def(p,".",m),c=a.global.def(f,
".",m),u(x(b,function(a){return h+"["+a+"]"}),");",x(b,function(a){return c+"["+a+"]="+h+"["+a+"];"}).join("")),g("if(",x(b,function(a){return h+"["+a+"]!=="+c+"["+a+"]"}).join("||"),"){",u,"}")):(h=q.def(p,".",m),c=q.def(f,".",m),u(h,");",f,".",m,"=",h,";"),g("if(",h,"!==",c,"){",u,"}"));d(u)});return a.compile()}(),compile:function(a,m,g,d){var q=P(),b;b=ca(a);var l=Z(a,b),f=H(a),p=T(a);a=J(a);var k=l.viewport;k&&(p.viewport=k);k=O("scissor.box");(l=l[k])&&(p[k]=l);l=0<Object.keys(p).length;b={framebuffer:b,
draw:f,shader:a,state:p,dirty:l};b.uniforms=R(g);b.attributes=aa(m);b.context=M(d);Da(q,b);Ga(q,b);Fa(q,b);return q.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":19,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/loop":24}],8:[function(c,n,r){function a(a,b){this.id=h++;this.type=a;this.data=b}function k(a){if(0===a.length)return[];var b=a.charAt(0),l=a.charAt(a.length-1);if(1<a.length&&b===l&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-
2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return k(a.substr(0,b.index)).concat(k(b[1])).concat(k(a.substr(b.index+b[0].length)));b=a.split(".");if(1===b.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(l=0;l<b.length;++l)a=a.concat(k(b[l]));return a}function l(a){return"["+k(a).join("][")+"]"}var h=0;n.exports={define:function(k,b){switch(typeof b){case "boolean":case "number":case "string":return new a(k,
l(b+""));case "undefined":return new a(k|128,null)}},isDynamic:function(l){return"function"===typeof l&&!l._reglType||l instanceof a},unbox:function(k,b){if(k instanceof a){if(k.type&128)return new a(k.type&-129,l(b))}else if("function"===typeof k)return new a(0,k);return k},accessor:l}},{}],9:[function(c,n,r){var a=c("./util/is-typed-array"),k=c("./util/is-ndarray"),l=c("./constants/primitives.json");n.exports=function(h,p,b){function c(){this.buffer=null;this.primType=4;this.type=this.vertCount=
0}function n(h){function x(b){var d=p.oes_element_index_uint;if(b)if("number"===typeof b)t(b);else{var h=null,c="static";Array.isArray(b)||a(b)||k(b)?h=b:("data"in b&&(h=b.data),"usage"in b&&(c=b.usage));Array.isArray(h)||k(h)&&Array.isArray(h.data)||"type"in b?t({type:b.type||(d?"uint32":"uint16"),usage:c,data:h}):t({usage:c,data:h});if(Array.isArray(h)||a(h))t.dimension=3}else t();d=v.buffer.byteLength;h=0;switch(v.buffer.dtype){case 5121:case 5120:h=5121;break;case 5123:case 5122:h=5123;d>>=1;
break;case 5125:case 5124:h=5125,d>>=2}var c=4,n=v.buffer.dimension;1===n&&(c=0);2===n&&(c=1);3===n&&(c=4);"object"===typeof b&&("primitive"in b&&(c=l[b.primitive]),"count"in b&&(d=b.vertCount|0));v.primType=c;v.vertCount=d;v.type=h;return x}var v=new c,t=b.create(null,34963,!0);v.buffer=t._buffer;x(h);x._reglType="elements";x._elements=v;x.destroy=function(){t.destroy();v.buffer=null};return x}c.prototype.bind=function(){this.buffer.bind()};return{create:n,createStream:function(a){return n({usage:"stream",
data:a})._elements},destroyStream:function(a){b.destroyStream(a.buffer)},getElements:function(a){return"function"===typeof a&&a._elements instanceof c?a._elements:null}}}},{"./constants/primitives.json":6,"./util/is-ndarray":21,"./util/is-typed-array":22}],10:[function(c,n,r){n.exports=function(a){function k(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(k){try{l[k]=
a.getExtension(k)}catch(c){}})}var l={};k();return{extensions:l,refresh:k}}},{}],11:[function(c,n,r){var a=c("./util/values"),k=c("./util/extend");n.exports=function(l,h,c,b,n){function x(a,d,b,l){this.target=a;this.level=d;this.texture=b;this.renderbuffer=l}function r(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function z(a,d){var b=d.width,l=d.height;if(a.texture)var k=a.texture._texture,h=Math.max(1,k.params.width>>a.level),c=Math.max(1,
k.params.height>>a.level),b=b||h,l=l||c;else k=a.renderbuffer._renderbuffer,b=b||k.width,l=l||k.height;k.refCount+=1;d.width=b;d.height=l}function v(a,d){d?d.texture?l.framebufferTexture2D(36160,a,d.target,d.texture._texture.texture,d.level):l.framebufferRenderbuffer(36160,a,36161,d.renderbuffer._renderbuffer.renderbuffer):l.framebufferTexture2D(36160,a,3553,null,0)}function t(a){var d=3553,b=0,l=null,k=null;"object"===typeof a&&("level"in a&&(b=a.level|0),"target"in a&&(d=a.target|0));var h=a._reglType;
"texture"===h?l=a:"renderbuffer"===h&&(k=a,d=36161,b=0);return new x(d,b,l,k)}function B(a){return a&&(a.texture||a.renderbuffer)}function d(){this.id=W++;G[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function u(a){l.isFramebuffer(a.framebuffer)||(a.framebuffer=l.createFramebuffer());K.dirty=!0;l.bindFramebuffer(36160,a.framebuffer);for(var d=
a.colorAttachments,b=0;b<d.length;++b)v(36064+b,d[b]);for(b=d.length;b<c.maxColorAttachments;++b)v(36064+b,null);v(36096,a.depthAttachment);v(36128,a.stencilAttachment);v(33306,a.depthStencilAttachment);h.webgl_draw_buffers&&h.webgl_draw_buffers.drawBuffersWEBGL(ea[d.length]);l.checkFramebufferStatus(36160)}function y(a){a=a.framebuffer;l.isFramebuffer(a)&&l.deleteFramebuffer(a)}var K={current:null,next:null,dirty:!1},ba={rgba:6408},C={rgba4:32854,rgb565:36194,"rgb5 a1":32855};h.ext_srgb&&(C.srgba=
35907);h.ext_color_buffer_half_float&&(C.rgba16f=34842,C.rgb16f=34843);h.webgl_color_buffer_float&&(C.rgba32f=34836);var X=[],da=[];h.webgl_depth_texture&&(X.push(6402),da.push(34041));k(k({},ba),C);a(ba);a(C);C=5121;X={uint8:5121};h.oes_texture_half_float&&(C=X["half float"]=36193);h.oes_texture_float&&(C=X["float"]=5126);X.best=C;var ea=function(){for(var a=Array(c.maxDrawbuffers),d=0;d<=c.maxDrawbuffers;++d)for(var b=a[d]=Array(d),l=0;l<d;++l)b[l]=36064+l;return a}(),W=0,G={};return k(K,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof d)?a:null},create:function(a){function k(a){var d,c=a||{},p=a=0;if("shape"in c){var v=c.shape;a=v[0];p=v[1]}else"radius"in c&&(a=p=c.radius),"width"in c&&(a=c.width),"height"in c&&(p=c.height);var y=null,v=!1;if("colorBuffers"in c||"colorBuffer"in c){y=c.colorBuffers||c.colorBuffer;Array.isArray(y)||(y=[y]);h.width=a;h.height=p;y=y.map(t);for(d=0;d<y.length;++d)z(y[d],h);a=h.width;p=h.height}else{var K=!0,w="rgba",C="uint8",G=1,
v=!0;h.width=a=a||l.drawingBufferWidth;h.height=p=p||l.drawingBufferHeight;"format"in c&&(w=c.format,K=w in ba);"type"in c&&(C=c.type);"colorCount"in c&&(G=c.colorCount|0);if(h.ownsColor)for(y=h.colorAttachments;y.length>G;)r(y.pop());else y=[];for(d=0;d<y.length;++d){var J;a:{J=y[d];var H=K,T=w,R=a,X=p;if(J.texture){var M=J.texture;if(H){M({format:T,type:C,width:R,height:X});M._texture.refCount+=1;J=!0;break a}}else if(M=J.renderbuffer,!H){M({format:T,width:R,height:X});M._renderbuffer.refCount+=
1;J=!0;break a}r(J);J=!1}J||(y[d--]=y[y.length-1],y.pop())}for(;y.length<G;)K?y.push(new x(3553,0,b.create({format:w,type:C,width:a,height:p},3553),null)):y.push(new x(36161,0,null,n.create({format:w,width:a,height:p})))}h.width=a;h.height=p;w=K=d=null;C=!1;"depthBuffer"in c&&(d=t(c.depthBuffer));"stencilBuffer"in c&&(K=t(c.stencilBuffer));"depthStencilBuffer"in c&&(w=t(c.depthStencilBuffer));if(d||K||w)z(d||K||w,h);else if(G=!0,H=J=!1,"depth"in c&&(G=!!c.depth),"stencil"in c&&(J=!!c.stencil),"depthTexture"in
c&&(H=!!c.depthTexture),c=h.depthAttachment||h.stencilAttachment||h.depthStencilAttachment,T=null,G||J)C=!0,H?(H=J?"depth stencil":"depth",h.ownsDepthStencil&&c.texture?(c.texture({format:H,width:a,height:p}),c.texture._texture.refCount+=1,T=c):T=new x(3553,0,b.create({format:H,width:a,height:p},3553),null)):(H=G?J?"depth stencil":"depth":"stencil",h.ownsDepthStencil&&c.renderbuffer?(c.renderbuffer({format:H,width:a,height:p}),c.renderbuffer._renderbuffer.refCount+=1,T=c):T=new x(36161,0,null,n.create({format:H,
width:a,height:p}))),G?J?w=T:d=T:K=T;a=h;a.colorAttachments.forEach(r);r(a.depthAttachment);r(a.stencilAttachment);r(a.depthStencilAttachment);h.colorAttachments=y;h.depthAttachment=d;h.stencilAttachment=K;h.depthStencilAttachment=w;h.ownsColor=v;h.ownsDepthStencil=C;k.color=y.map(B);k.depth=B(d);k.stencil=B(K);k.depthStencil=B(w);u(h);k.width=h.width;k.height=h.height;return k}var h=new d;k(a);k._reglType="framebuffer";k._framebuffer=h;k._destroy=function(){y(h)};return k},clear:function(){a(G).forEach(y)},
refresh:function(){a(G).forEach(u)}})}},{"./util/extend":20,"./util/values":28}],12:[function(c,n,r){n.exports=function(a,k){var l=1;k.ext_texture_filter_anisotropic&&(l=a.getParameter(34047));var h=1,c=1;k.webgl_draw_buffers&&(h=a.getParameter(34852),c=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(k).filter(function(a){return!!k[a]}),
maxAnisotropic:l,maxDrawbuffers:h,maxColorAttachments:c,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},{}],13:[function(c,n,r){var a=c("./util/is-typed-array");n.exports=function(k,l,h){return function(c){var b=c||{};a(c)?b={data:b}:2===arguments.length?b={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof c&&(b={});l();var n=b.x||0,x=b.y||0,r=b.width||h.viewportWidth,z=b.height||h.viewportHeight,b=b.data||new Uint8Array(r*z*4);k.pixelStorei(3333,
4);k.readPixels(n,x,r,z,6408,5121,b);return b}}},{"./util/is-typed-array":22}],14:[function(c,n,r){var a=c("./util/values");n.exports=function(k,l,h){function c(){this.id=r++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function b(a){k.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=k.createRenderbuffer());k.bindRenderbuffer(36161,a.renderbuffer);k.renderbufferStorage(36161,a.format,a.width,a.height)}function n(a){var b=a.renderbuffer;k.bindRenderbuffer(36161,
null);k.isRenderbuffer(b)&&k.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete z[a.id]}var x={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};l.ext_srgb&&(x.srgba=35907);l.ext_color_buffer_half_float&&(x.rgba16f=34842,x.rgb16f=34843);l.webgl_color_buffer_float&&(x.rgba32f=34836);var r=0,z={};c.prototype.decRef=function(){0===--this.refCount&&n(this)};return{create:function(a){function k(a){a=a||{};var c=0,h=0;"shape"in a?(h=a.shape,c=h[0]|0,h=
h[1]|0):("radius"in a&&(c=h=a.radius|0),"width"in a&&(c=a.width|0),"height"in a&&(h=a.height|0));k.width=l.width=Math.max(c,1);k.height=l.height=Math.max(h,1);l.format=32854;"format"in a&&(l.format=x[a.format]);b(l);return k}var l=new c;z[l.id]=l;k(a);k._reglType="renderbuffer";k._renderbuffer=l;k.destroy=function(){l.decRef()};return k},refresh:function(){a(z).forEach(b)},clear:function(){a(z).forEach(n)}}}},{"./util/values":28}],15:[function(c,n,r){var a=c("./util/values");n.exports=function(k,
l){function h(a,b,k,l){this.name=a;this.id=b;this.location=k;this.info=l}function c(a,b){for(var k=0;k<a.length;++k)if(a[k].id===b.id){a[k].location=b.location;return}a.push(b)}function b(a,b,c){c=35632===a?r:z;var h=c[b];if(!h){var p=l.str(b),h=k.createShader(a);k.shaderSource(h,p);k.compileShader(h);c[b]=h}return h}function n(a,b){this.id=B++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}function x(a,n){var t,v;t=b(35632,a.fragId);v=b(35633,a.vertId);var x=a.program=
k.createProgram();k.attachShader(x,t);k.attachShader(x,v);k.linkProgram(x);var r=k.getProgramParameter(x,35718),B=a.uniforms;for(t=0;t<r;++t)if(v=k.getActiveUniform(x,t))if(1<v.size)for(var I=0;I<v.size;++I){var z=v.name.replace("[0]","["+I+"]");c(B,new h(z,l.id(z),k.getUniformLocation(x,z),v))}else c(B,new h(v.name,l.id(v.name),k.getUniformLocation(x,v.name),v));r=k.getProgramParameter(x,35721);B=a.attributes;for(t=0;t<r;++t)(v=k.getActiveAttrib(x,t))&&c(B,new h(v.name,l.id(v.name),k.getAttribLocation(x,
v.name),v))}var r={},z={},v={},t=[],B=0;return{clear:function(){var d=k.deleteShader.bind(k);a(r).forEach(d);r={};a(z).forEach(d);z={};t.forEach(function(a){k.deleteProgram(a.program)});t.length=0;v={}},refresh:function(){r={};z={};t.forEach(x)},program:function(a,b,k){var l=v[b];l||(l=v[b]={});var h=l[a];h||(h=new n(b,a),x(h,k),l[a]=h,t.push(h));return h},shader:b,frag:null,vert:null}}},{"./util/values":28}],16:[function(c,n,r){n.exports=function(){var a={"":0},k=[""];return{id:function(l){var h=
a[l];if(h)return h;h=a[l]=k.length;k.push(l);return h},str:function(a){return k[a]}}}},{}],17:[function(c,n,r){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function k(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var k=a[0].length,h=1;h<b;++h)if(!Array.isArray(a[h])||a[h].length!==k)return!1;return!0}function l(a){return Object.prototype.toString.call(a)}function h(a){return"[object HTMLCanvasElement]"===l(a)}function p(a){return"[object CanvasRenderingContext2D]"===
l(a)}var b=c("./util/extend"),I=c("./util/values"),x=c("./util/is-typed-array"),V=c("./util/is-ndarray"),z=c("./util/load-texture"),v=c("./util/to-half-float"),t=c("./util/parse-dds"),B=[9984,9986,9985,9987];n.exports=function(d,c,n,r,ba){function C(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=
this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function X(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function da(a,d){var g,b,h=0,k=0,c=0,l=0,p=0,t=0,n=!1,v=!1,u=!1;for(g=0;g<d.length;++g)b=d[g],l=l||b.width<<b.miplevel,p=p||b.height<<b.miplevel,
h=h||b.type,k=k||b.format,c=c||b.internalformat,t=t||b.channels,n=n||b.needsPoll,v=v||b.needsListeners,b=b.miplevel,u=u||0<b;a.needsPoll=n;a.needsListeners=v;a.width=l;a.height=p;a.format=k;a.internalformat=c;a.type=h;if(3553!==a.target)for(g=0;6>g;++g);g=0<=B.indexOf(a.minFilter);a.genMipmaps=!u&&(a.genMipmaps||g);u=u||a.genMipmaps;a.minFilter||(a.minFilter=u?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(g=0;g<d.length;++g)b=d[g],b.channels||(b.channels=t),b.format||(b.format=k),b.internalformat||
(b.internalformat=c),b.type||(b.type=h)}function ea(a){this.id=T++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new X(a);this.pixels=[]}function W(a,d){function g(a,g){var m=g.mipmap,b;if(Array.isArray(m))for(var h=0;h<m.length;++h)b=new C(a),b.parseFlags(d),b.parseFlags(g),b.parse(m[h],h),k.push(b);else b=new C(a),b.parseFlags(d),b.parse(g,0),k.push(b)}var b;F(a);var h=a.params;X.call(h,a.target);var k=a.pixels;k.length=
0;h.parse(d);if(3553===a.target)g(3553,d);else{var c=d.faces||d;if(Array.isArray(c))for(b=0;6>b;++b)g(34069+b,c[b]);else if("string"!==typeof c)for(b=0;6>b;++b)g(34069+b,{})}da(h,k);h.needsListeners&&w(a);h.needsPoll&&(a.pollId=aa.length,aa.push(a));G(a)}function G(a){d.isTexture(a.texture)||(a.texture=d.createTexture());var b=a.target,g=a.unit;0<=g?(d.activeTexture(33984+g),H=g):d.bindTexture(b,a.texture);for(var b=a.pixels,h=a.params,k=0;k<b.length;++k)b[k].upload(h);h.upload();0>g&&((g=N[H])?d.bindTexture(g.target,
g.texture):(a.unit=H,N[H]=a))}function w(a){function d(a,g,b){var m=t(b);m.pixels.forEach(function(d){var b=new C(m.cube?d.target:a);b.channels=m.channels;b.compressed=m.compressed;b.type=m.type;b.internalformat=m.format;b.format=J[m.format];b.width=d.width;b.height=d.height;b.miplevel=d.miplevel||g;b.data=d.data;h.push(b)})}function g(){for(var g=0;g<h.length;++g){var k=h[g],c=k.image,l=k.video,p=k.xhr;c&&c.complete?(k.width=c.naturalWidth,k.height=c.naturalHeight):l&&2<l.readyState?(k.width=l.width,
k.height=l.height):p&&4===p.readyState&&(h[g]=h[h.length-1],h.pop(),p.removeEventListener("readystatechange",G),d(k.target,k.miplevel,p.response))}da(b,h);G(a)}var b=a.params,h=a.pixels;h.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",g):a.video&&1>a.readyState?a.video.addEventListener("progress",g):a.xhr&&a.xhr.addEventListener("readystatechange",g)});a.cancelPending=function(){h.forEach(function(a){a.image?a.image.removeEventListener("load",g):a.video?a.video.removeEventListener("progress",
g):a.xhr&&(a.xhr.removeEventListener("readystatechange",g),a.xhr.abort())})}}function F(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((aa[b]=aa[aa.length-1]).id=b,aa.pop(),a.pollId=-1)}function fa(a){var b=a.texture,g=a.unit,h=a.target;0<=g&&(d.activeTexture(33984+g),H=g,d.bindTexture(h,null),N[g]=null);F(a);d.isTexture(b)&&d.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete R[a.id]}var Q={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
Y={repeat:10497,clamp:33071,mirror:33648},ga={nearest:9728,linear:9729},L=b({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ga),O={none:0,browser:37444},E={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},A={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},P={};c.ext_srgb&&(A.srgb=35904,A.srgba=35906);c.oes_texture_float&&(E["float"]=5126);c.oes_texture_half_float&&
(E["half float"]=36193);c.webgl_depth_texture&&(b(A,{depth:6402,"depth stencil":34041}),b(E,{uint16:5123,uint32:5125,"depth stencil":34042}));c.webgl_compressed_texture_s3tc&&b(P,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});c.webgl_compressed_texture_atc&&b(P,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});c.webgl_compressed_texture_pvrtc&&b(P,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});c.webgl_compressed_texture_etc1&&(P["rgb etc1"]=36196);var ca=Array.prototype.slice.call(d.getParameter(34467));Object.keys(P).forEach(function(a){var b=P[a];0<=ca.indexOf(b)&&(A[a]=b)});var Z=Object.keys(A);n.textureFormats=Z;var J=Z.reduce(function(a,b){var g=A[b];6409===g||6406===g||6409===g||6410===g||6402===g||34041===g?a[g]=g:32855===g||0<=b.indexOf("rgba")?a[g]=6408:a[g]=6407;return a},{});b(C.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=O[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=A[b];b in E&&(this.type=E[b]);b in P&&(this.compressed=!0)}"type"in a&&(this.type=E[a.type]);var b=this.width,g=this.height,d=this.channels;"shape"in a?(b=a.shape[0],g=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=g=a.radius),"width"in a&&(b=a.width),
"height"in a&&(g=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=g|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(b,d){this.miplevel=d;this.width>>=d;this.height>>=d;var g=b;switch(typeof b){case "object":if(!b)return;
this.parseFlags(b);var c=b.data;if("string"===typeof c||c&&(x(c)||a(c)||V(c)||h(c)||p(c)||"[object HTMLImageElement]"===l(c)||"[object HTMLVideoElement]"===l(c)||k(c)))g=b.data;break;case "undefined":return}"string"===typeof g&&(g=z(g,this.crossOrigin));var c=null,t=!1;if(null!==g)if(x(g))this.data=g;else if(a(g))c=g,t=!0;else if(V(g)){Array.isArray(g.data)?(c=g.data,t=!0):this.data=g.data;var n=g.shape;this.width=n[0];this.height=n[1];this.channels=3===n.length?n[2]:1;n=g.stride;this.strideX=g.stride[0];
this.strideY=g.stride[1];this.strideC=3===n.length?g.stride[2]:1;this.offset=g.offset;this.needsTranspose=!0}else if(h(g)||p(g))h(g)?this.canvas=g:this.canvas=g.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===l(g))this.image=g,g.complete?(this.width=g.naturalWidth,this.height=g.naturalHeight):(this.width=this.width||g.naturalWidth,this.height=this.height||g.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===l(g))this.video=g,1<g.readyState?(this.width=g.width,this.height=g.height):(this.width=this.width||g.width,this.height=this.height||g.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===l(g))this.xhr=g,this.needsListeners=!0;else if(k(g)){var t=g[0].length,n=g.length,u=1,w,r,y,B;if(Array.isArray(g[0][0]))for(u=g[0][0].length,c=Array(t*n*u),r=B=0;r<n;++r)for(w=0;w<t;++w)for(y=0;y<u;++y)c[B++]=g[r][w][y];
else for(c=Array(t*n),r=B=0;r<n;++r)for(w=0;w<t;++w)c[B++]=g[r][w];this.width=t;this.height=n;this.channels=u;t=!0}else b.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||ba.viewportWidth)|0,this.height=(this.height||ba.viewportHeight)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=
[6409,6410,6407,6408][(this.channels=this.channels||4)-1]);g=this.internalformat;n=this.format=J[g];if(!this.channels)switch(n){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}n=this.type;5126!==n&&36193!==n&&(n||(n=6402===g?5125:5121));this.type=n;if(t)switch(n){case 5121:this.data=new Uint8Array(c);break;case 5123:this.data=new Uint16Array(c);break;case 5125:this.data=new Uint32Array(c);break;
case 5126:this.data=new Float32Array(c);break;case 36193:this.data=v(c)}if(this.data&&this.needsTranspose){c=this.data;g=this.width;t=this.height;n=this.channels;u=this.strideX;w=this.strideY;r=this.strideC;y=this.offset;B=new c.constructor(g*t*n);for(var I=0,F=0;F<t;++F)for(var C=0;C<g;++C)for(var A=0;A<n;++A)B[I++]=c[w*F+u*C+r*A+y];this.data=B}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){d.pixelStorei(37440,
this.flipY);d.pixelStorei(37441,this.premultiplyAlpha);d.pixelStorei(37443,this.colorSpace);d.pixelStorei(3317,this.unpackAlignment);var b=this.target,g=this.miplevel,c=this.image,h=this.canvas,k=this.video,l=this.data,p=this.internalformat,n=this.format,t=this.type,v=this.width||Math.max(1,a.width>>g);a=this.height||Math.max(1,a.height>>g);k&&2<k.readyState?d.texImage2D(b,g,n,n,t,k):c&&c.complete?d.texImage2D(b,g,n,n,t,c):h?d.texImage2D(b,g,n,n,t,h):this.compressed?d.compressedTexImage2D(b,g,p,v,
a,0,l):this.copy?(r(),d.copyTexImage2D(b,g,n,this.x,this.y,v,a,0)):l?d.texImage2D(b,g,n,v,a,0,n,t,l):d.texImage2D(b,g,n,v||1,a||1,0,n,t,null)}});b(X.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=L[a.min]);"mag"in a&&(this.magFilter=ga[a.mag]);var b=this.wrapS,g=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=g=Y[d]:Array.isArray(d)&&(b=Y[d[0]],g=Y[d[1]])}else"wrapS"in a&&(b=Y[a.wrapS]),"wrapT"in a&&(g=Y[a.wrapT]);this.wrapS=b;this.wrapT=g;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=Q[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;d.texParameteri(a,10241,this.minFilter);d.texParameteri(a,10240,this.magFilter);d.texParameteri(a,10242,this.wrapS);d.texParameteri(a,10243,this.wrapT);c.ext_texture_filter_anisotropic&&d.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(d.hint(33170,this.mipmapHint),d.generateMipmap(a))}});
var H=0,T=0,R={},aa=[],M=n.maxTextureUnits,N=Array(M).map(function(){return null});b(ea.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<M;++b){var g=N[b];if(g){if(0<g.bindCount)continue;g.unit=-1}N[b]=this;a=b;break}this.unit=a;d.activeTexture(33984+a);d.bindTexture(this.target,this.texture);H=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&fa(this)}});return{create:function(a,b){function d(a,h,k,l,m,p){var n=a||{};34067===
b&&6===arguments.length&&(n=[a,h,k,l,m,p]);W(c,n);d.width=c.params.width;d.height=c.params.height;return d}var c=new ea(b);R[c.id]=c;d(a);d._reglType="texture";d._texture=c;d.destroy=function(){c.decRef()};return d},refresh:function(){I(R).forEach(G);for(var a=0;a<M;++a)N[a]=null;H=0;d.activeTexture(33984)},clear:function(){for(var a=0;a<M;++a)d.activeTexture(33984+a),d.bindTexture(3553,null),N[a]=null;d.activeTexture(33984);H=0;I(R).forEach(fa)},poll:function(){aa.forEach(G)},getTexture:function(a){return null}}}},
{"./util/extend":20,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/load-texture":23,"./util/parse-dds":25,"./util/to-half-float":27,"./util/values":28}],18:[function(c,n,r){n.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],19:[function(c,n,r){function a(a){return Array.prototype.slice.call(a)}function k(c){return a(c).join("")}var l=c("./extend");n.exports=function(){function c(){var h=[],p=[];return l(function(){h.push.apply(h,
a(arguments))},{def:function(){var c="v"+b++;p.push(c);0<arguments.length&&(h.push(c,"="),h.push.apply(h,a(arguments)),h.push(";"));return c},toString:function(){return k([0<p.length?"var "+p+";":"",k(h)])}})}function p(){function a(d,c){k(d,c,"=",b.def(d,c),";")}var b=c(),k=c(),d=b.toString,p=k.toString;return l(b,{entry:b,exit:k,save:a,set:function(d,c,h){a(d,c);b(d,c,"=",h,";")},toString:function(){return d()+p()}})}var b=0,n=[],r=[],V=c(),z={};return{global:V,link:function(a){for(var c=0;c<r.length;++c)if(r[c]===
a)return n[c];c="g"+b++;n.push(c);r.push(a);return c},block:c,proc:function(a,b){function c(){var a="a"+d.length;d.push(a);return a}var d=[];b=b||0;for(var h=0;h<b;++h)c();var h=p(),n=h.toString;return z[a]=l(h,{arg:c,toString:function(){return k(["function(",d.join(),"){",n(),"}"])}})},scope:p,cond:function(){var b=k(arguments),c=p(),h=p(),d=c.toString,n=h.toString;return l(c,{then:function(){c.apply(c,a(arguments));return this},"else":function(){h.apply(h,a(arguments));return this},toString:function(){var a=
n();a&&(a="else{"+a+"}");return k(["if(",b,"){",d(),"}",a])}})},compile:function(){var a=['"use strict";',V,"return {"];Object.keys(z).forEach(function(b){a.push('"',b,'":',z[b].toString(),",")});a.push("}");var b=k(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(b)).apply(null,r)}}}},{"./extend":20}],20:[function(c,n,r){n.exports=function(a,c){for(var l=Object.keys(c),h=0;h<l.length;++h)a[l[h]]=c[l[h]];return a}},{}],21:[function(c,n,r){var a=c("./is-typed-array");
n.exports=function(c){return!!c&&"object"===typeof c&&Array.isArray(c.shape)&&Array.isArray(c.stride)&&"number"===typeof c.offset&&c.shape.length===c.stride.length&&(Array.isArray(c.data)||a(c.data))}},{"./is-typed-array":22}],22:[function(c,n,r){var a=c("../constants/arraytypes.json");n.exports=function(c){return Object.prototype.toString.call(c)in a}},{"../constants/arraytypes.json":4}],23:[function(c,n,r){n.exports=function(a,c){if("undefined"!==typeof document){var l;l=(l=/\.(\w+)(\?.*)?$/.exec(a))&&
l[1]?l[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(l))return l=document.createElement("video"),l.autoplay=!0,l.loop=!0,c&&(l.crossOrigin=c),l.src=a,l;if(0<=["dds"].indexOf(l))return l=new XMLHttpRequest,l.responseType="arraybuffer",l.open("GET",a,!0),l.send(),l;l=new Image;c&&(l.crossOrigin=c);l.src=a;return l}return null}},{}],24:[function(c,n,r){n.exports=function(a,c){for(var l=Array(a),h=0;h<a;++h)l[h]=c(h);return l}},
{}],25:[function(c,n,r){n.exports=function(c){function n(a){for(var b=Q,d=Y,h=0;h<A;++h){var k=Math.max(1,b+3>>2)*Math.max(1,d+3>>2)*O;ca.pixels.push({target:a,miplevel:h,width:b,height:d,data:new Uint8Array(c,P,k)});P+=k;b>>=1;d>>=1}}var r=new Int32Array(c),fa=r[K],Q=r[C],Y=r[ba],ga=x,L=0,O=0,E=4;switch(r[ea]){case t:O=8;fa&v?(E=3,L=l):L=h;break;case B:O=16;L=p;break;case d:O=16;L=b;break;case u:O=8,L=I}var A=1;r[da]&V&&(A=Math.max(1,r[X]));var P=r[y]+4,ca={width:Q,height:Y,channels:E,format:L,type:ga,
compressed:!0,cube:!1,pixels:[]};if(r[W]&z)for(ca.cube=!0,r=0;6>r;++r)n(k+r);else n(a);return ca};var a=3553,k=34069,l=33776,h=33777,p=33778,b=33779,I=36196,x=5121,V=131072,z=512,v=64,t=827611204,B=861165636,d=894720068,u=826496069,y=1,K=2,ba=3,C=4,X=7,da=20,ea=21,W=28},{}],26:[function(c,n,r){n.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,
30)},cancel:clearTimeout}},{}],27:[function(c,n,r){n.exports=function(a){for(var c=new Float32Array(a),c=new Uint32Array(c.buffer),l=new Uint16Array(a.length),h=0;h<a.length;++h)if(isNaN(a[h]))l[h]=65535;else if(Infinity===a[h])l[h]=31744;else if(-Infinity===a[h])l[h]=64512;else{var p=c[h],b=p>>>31<<15,n=(p<<1>>>24)-127,p=p>>13&1023;l[h]=-24>n?b:-14>n?b+(p+1024>>-14-n):15<n?b+31744:b+(n+15<<10)+p}return l}},{}],28:[function(c,n,r){n.exports=function(a){return Object.keys(a).map(function(c){return a[c]})}},
{}],29:[function(c,n,r){function a(a,c){function b(){var b=window.innerWidth,c=window.innerHeight;a!==document.body&&(c=a.getBoundingClientRect(),b=c.right-c.left,c=c.top-c.bottom);n.width=V*b;n.height=V*c;l(n.style,{width:b+"px",height:c+"px"})}var n=document.createElement("canvas"),r=k(n,c);l(n.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(n);a===document.body&&(n.style.position="absolute",l(a.style,{margin:0,padding:0}));var V=+r.options.pixelRatio;window.addEventListener("resize",
b,!1);var z=r.options.onDestroy;r.options=l(l({},r.options),{onDestroy:function(){window.removeEventListener("resize",b);a.removeChild(n);z&&z()}});b();return r}function k(a,c){function b(b){try{return a.getContext(b,k)}catch(c){return null}}var k=c.glOptions||{};return{gl:b("webgl")||b("experimental-webgl")||b("webgl-experimental"),options:l({pixelRatio:window.devicePixelRatio},c)}}var l=c("./util/extend");n.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],
options:c[1]||{}};var p=document.body,b=c[1]||{};if("string"===typeof c[0])p=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)p=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],options:l({pixelRatio:1},b)};b=c[0]}return p.nodeName&&"CANVAS"===p.nodeName.toUpperCase()?k(p,b):a(p,b)}},{"./util/extend":20}],30:[function(c,n,r){var a=c("./lib/util/extend"),k=c("./lib/dynamic"),l=c("./lib/util/raf"),h=c("./lib/util/clock"),p=c("./lib/strings"),
b=c("./lib/webgl"),I=c("./lib/extension"),x=c("./lib/limits"),V=c("./lib/buffer"),z=c("./lib/elements"),v=c("./lib/texture"),t=c("./lib/renderbuffer"),B=c("./lib/framebuffer"),d=c("./lib/attribute"),u=c("./lib/shader"),y=c("./lib/read"),K=c("./lib/core");n.exports=function(){function c(){m=l.next(c);E.count+=1;var a=aa.viewport,b=aa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;E.viewportWidth=E.frameBufferWidth=E.drawingBufferWidth=a[2]=b[2]=w.drawingBufferWidth;E.viewportHeight=E.frameBufferWidth=E.drawingBufferHeight=
a[3]=b[3]=w.drawingBufferHeight;a=h();E.deltaTime=(a-ga)/1E3;E.time=(a-Y)/1E3;ga=a;R.procs.refresh();Z.poll();for(a=0;a<N.length;++a)(0,N[a])(E,null,0)}function n(){m&&(l.cancel(c),m=0)}function r(a){n();a.preventDefault();if(F.onContextLost)F.onContextLost()}function da(a){w.getError();fa.refresh();R.procs.refresh();A.refresh();Z.refresh();J.refresh();H.refresh();ca.refresh();if(F.onContextRestored)F.onContextRestored();c()}function ea(b){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var g=
a[c];k.isDynamic(g)?d[c]=k.unbox(g,c):b[c]=g});return{dynamic:d,"static":b}}function d(a){for(;t.length<a;)t.push(null);return t}var h=c(b.context||{}),l=c(b.uniforms||{}),m=c(b.attributes||{});b=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(b));var h=R.compile(b,
m,l,h),p=h.draw,n=h.batch,r=h.scope,t=[];return function(a,b){var c;if("function"===typeof a)return r.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)r.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)r.call(this,a[c],b,c);else return r.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return p.call(this,a)}}function W(){R.procs.poll()}
var G=b(Array.prototype.slice.call(arguments)),w=G.gl,F=G.options,G=p(),fa=I(w),Q=fa.extensions,Y=h(),ga=Y,L=w.drawingBufferWidth,O=w.drawingBufferHeight,E={count:0,deltaTime:0,time:0,viewportWidth:L,viewportHeight:O,framebufferWidth:L,framebufferHeight:O,drawingBufferWidth:L,drawingBufferHeight:O,pixelRatio:F.pixelRatio},L=x(w,Q),A=V(w),P=z(w,Q,A),O=d(w,Q,L,A,G),ca=u(w,G),Z=v(w,Q,L,W,E),J=t(w,Q,L),H=B(w,Q,L,Z,J),T=y(w,W,E),R=K(w,G,Q,L,A,P,Z,H,{},O,ca,{elements:null,primitive:4,count:-1,offset:0,
instances:-1},E),aa=R.next,M=w.canvas,N=[],m=0;M&&(M.addEventListener("webglcontextlost",r,!1),M.addEventListener("webglcontextrestored",da,!1));R.procs.refresh();return a(ea,{clear:function(a){var b=0;W();var c=a.color;c&&(w.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(w.clearDepth(+a.depth),b|=256);"stencil"in a&&(w.clearStencil(a.stencil|0),b|=1024);w.clear(b)},prop:k.define.bind(null,1),context:k.define.bind(null,2),"this":k.define.bind(null,3),draw:ea({}),elements:function(a){return P.create(a)},
buffer:function(a){return A.create(a,34962)},texture:function(a){return Z.create(a,3553)},cube:function(a){return 6===arguments.length?Z.create(Array.prototype.slice.call(arguments),34067):Z.create(a,34067)},renderbuffer:function(a){return J.create(a)},framebuffer:function(a){return H.create(a)},framebufferCube:function(a){},attributes:w.getContextAttributes(),frame:function(a){N.push(a);!m&&0<N.length&&c();return{cancel:function(){var b=N.find(function(b){return b===a});0>b||(N.splice(b,1),0>=N.length&&
n())}}},limits:L,read:T,destroy:function(){n();M&&(M.removeEventListener("webglcontextlost",r),M.removeEventListener("webglcontextrestored",da));ca.clear();H.clear();J.clear();Z.clear();A.clear();if(F.onDestroy)F.onDestroy()},_gl:w,_refresh:function(){R.procs.refresh()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":7,"./lib/dynamic":8,"./lib/elements":9,"./lib/extension":10,"./lib/framebuffer":11,"./lib/limits":12,"./lib/read":13,"./lib/renderbuffer":14,"./lib/shader":15,"./lib/strings":16,
"./lib/texture":17,"./lib/util/clock":18,"./lib/util/extend":20,"./lib/util/raf":26,"./lib/webgl":29}]},{},[1]);
