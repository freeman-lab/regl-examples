<!DOCTYPE html>
      <html>
        <head>
          <title>example/cube.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function(){function g(d,q,a){function b(e,u){if(!q[e]){if(!d[e]){var l="function"==typeof require&&require;if(!u&&l)return l(e,!0);if(c)return c(e,!0);l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l;}l=q[e]={exports:{}};d[e][0].call(l.exports,function(a){return b(d[e][1][a]||a)},l,l.exports,g,d,q,a)}return q[e].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)b(a[e]);return b}return g})()({1:[function(g,d,q){var a=g("regl")(),b=g("gl-mat4"),c=a({frag:"\n  precision mediump float;\n  varying vec2 vUv;\n  uniform sampler2D tex;\n  void main () {\n    gl_FragColor = texture2D(tex,vUv);\n  }",
vert:"\n  precision mediump float;\n  attribute vec3 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n  uniform mat4 projection, view;\n  void main() {\n    vUv = uv;\n    gl_Position = projection * view * vec4(position, 1);\n  }",attributes:{position:[[-.5,.5,.5],[.5,.5,.5],[.5,-.5,.5],[-.5,-.5,.5],[.5,.5,.5],[.5,.5,-.5],[.5,-.5,-.5],[.5,-.5,.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,-.5,-.5],[.5,-.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[-.5,-.5,.5],[-.5,-.5,-.5],[-.5,.5,-.5],[.5,.5,-.5],[.5,.5,.5],[-.5,.5,
.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,-.5,.5],[-.5,-.5,.5]],uv:[[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[0,1]]},elements:[[2,1,0],[2,0,3],[6,5,4],[6,4,7],[10,9,8],[10,8,11],[14,13,12],[14,12,15],[18,17,16],[18,16,19],[20,21,22],[23,20,22]],uniforms:{view:function(a){a=.01*a.tick;return b.lookAt([],[5*Math.cos(a),2.5*Math.sin(a),5*Math.sin(a)],[0,0,0],[0,1,0])},projection:function(a){return b.perspective([],
Math.PI/4,a.viewportWidth/a.viewportHeight,.01,10)},tex:a.prop("texture")}});g("resl")({manifest:{texture:{type:"image",src:"assets/lena.png",parser:function(b){return a.texture({data:b,mag:"linear",min:"linear"})}}},onDone:function(b){var k=b.texture;a.frame(function(){a.clear({color:[0,0,0,255],depth:1});c({texture:k})})}})},{"gl-mat4":17,regl:32,resl:33}],2:[function(g,d,q){d.exports=function(a,b){var c=b[0],e=b[1],k=b[2],u=b[3],l=b[4],K=b[5],D=b[6],t=b[7],A=b[8],z=b[9],d=b[10],g=b[11],y=b[12],
E=b[13],B=b[14],C=b[15];a[0]=K*(d*C-g*B)-z*(D*C-t*B)+E*(D*g-t*d);a[1]=-(e*(d*C-g*B)-z*(k*C-u*B)+E*(k*g-u*d));a[2]=e*(D*C-t*B)-K*(k*C-u*B)+E*(k*t-u*D);a[3]=-(e*(D*g-t*d)-K*(k*g-u*d)+z*(k*t-u*D));a[4]=-(l*(d*C-g*B)-A*(D*C-t*B)+y*(D*g-t*d));a[5]=c*(d*C-g*B)-A*(k*C-u*B)+y*(k*g-u*d);a[6]=-(c*(D*C-t*B)-l*(k*C-u*B)+y*(k*t-u*D));a[7]=c*(D*g-t*d)-l*(k*g-u*d)+A*(k*t-u*D);a[8]=l*(z*C-g*E)-A*(K*C-t*E)+y*(K*g-t*z);a[9]=-(c*(z*C-g*E)-A*(e*C-u*E)+y*(e*g-u*z));a[10]=c*(K*C-t*E)-l*(e*C-u*E)+y*(e*t-u*K);a[11]=-(c*
(K*g-t*z)-l*(e*g-u*z)+A*(e*t-u*K));a[12]=-(l*(z*B-d*E)-A*(K*B-D*E)+y*(K*d-D*z));a[13]=c*(z*B-d*E)-A*(e*B-k*E)+y*(e*d-k*z);a[14]=-(c*(K*B-D*E)-l*(e*B-k*E)+y*(e*D-k*K));a[15]=c*(K*d-D*z)-l*(e*d-k*z)+A*(e*D-k*K);return a}},{}],3:[function(g,d,q){d.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}},{}],4:[function(g,d,q){d.exports=
function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],5:[function(g,d,q){d.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],6:[function(g,d,q){d.exports=function(a){var b=a[0],c=a[1],e=a[2],k=a[3],u=a[4],l=a[5],K=a[6],D=a[7],
t=a[8],d=a[9],g=a[10],G=a[11],q=a[12],y=a[13],E=a[14];a=a[15];return(b*l-c*u)*(g*a-G*E)-(b*K-e*u)*(d*a-G*y)+(b*D-k*u)*(d*E-g*y)+(c*K-e*l)*(t*a-G*q)-(c*D-k*l)*(t*E-g*q)+(e*D-k*K)*(t*y-d*q)}},{}],7:[function(g,d,q){d.exports=function(a,b){var c=b[0],e=b[1],k=b[2],u=b[3],l=c+c,K=e+e,d=k+k,c=c*l,g=e*l,e=e*K,A=k*l,z=k*K,k=k*d,l=u*l,K=u*K,u=u*d;a[0]=1-e-k;a[1]=g+u;a[2]=A-K;a[3]=0;a[4]=g-u;a[5]=1-c-k;a[6]=z+l;a[7]=0;a[8]=A+K;a[9]=z-l;a[10]=1-c-e;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],8:[function(g,
d,q){d.exports=function(a,b,c){var e,k,u=c[0],l=c[1];c=c[2];e=Math.sqrt(u*u+l*l+c*c);if(1E-6>Math.abs(e))return null;e=1/e;u*=e;l*=e;c*=e;e=Math.sin(b);b=Math.cos(b);k=1-b;a[0]=u*u*k+b;a[1]=l*u*k+c*e;a[2]=c*u*k-l*e;a[3]=0;a[4]=u*l*k-c*e;a[5]=l*l*k+b;a[6]=c*l*k+u*e;a[7]=0;a[8]=u*c*k+l*e;a[9]=l*c*k-u*e;a[10]=c*c*k+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],9:[function(g,d,q){d.exports=function(a,b,c){var e=b[0],k=b[1],u=b[2],l=b[3],K=e+e,d=k+k,g=u+u;b=e*K;var A=e*d,e=e*g,z=k*d,k=k*g,u=
u*g,K=l*K,d=l*d,l=l*g;a[0]=1-(z+u);a[1]=A+l;a[2]=e-d;a[3]=0;a[4]=A-l;a[5]=1-(b+u);a[6]=k+K;a[7]=0;a[8]=e+d;a[9]=k-K;a[10]=1-(b+z);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}},{}],10:[function(g,d,q){d.exports=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],11:[function(g,d,q){d.exports=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;
a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a}},{}],12:[function(g,d,q){d.exports=function(a,b){var c=Math.sin(b),e=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=e;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=e;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],13:[function(g,d,q){d.exports=function(a,b){var c=Math.sin(b),e=Math.cos(b);a[0]=e;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=e;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],14:[function(g,d,
q){d.exports=function(a,b){var c=Math.sin(b),e=Math.cos(b);a[0]=e;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=e;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],15:[function(g,d,q){d.exports=function(a,b,c,e,k,u,l){var d=1/(c-b),g=1/(k-e),t=1/(u-l);a[0]=2*u*d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*u*g;a[6]=0;a[7]=0;a[8]=(c+b)*d;a[9]=(k+e)*g;a[10]=(l+u)*t;a[11]=-1;a[12]=0;a[13]=0;a[14]=l*u*2*t;a[15]=0;return a}},{}],16:[function(g,d,q){d.exports=function(a){a[0]=1;a[1]=
0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],17:[function(g,d,q){d.exports={create:g("./create"),clone:g("./clone"),copy:g("./copy"),identity:g("./identity"),transpose:g("./transpose"),invert:g("./invert"),adjoint:g("./adjoint"),determinant:g("./determinant"),multiply:g("./multiply"),translate:g("./translate"),scale:g("./scale"),rotate:g("./rotate"),rotateX:g("./rotateX"),rotateY:g("./rotateY"),rotateZ:g("./rotateZ"),fromRotation:g("./fromRotation"),
fromRotationTranslation:g("./fromRotationTranslation"),fromScaling:g("./fromScaling"),fromTranslation:g("./fromTranslation"),fromXRotation:g("./fromXRotation"),fromYRotation:g("./fromYRotation"),fromZRotation:g("./fromZRotation"),fromQuat:g("./fromQuat"),frustum:g("./frustum"),perspective:g("./perspective"),perspectiveFromFieldOfView:g("./perspectiveFromFieldOfView"),ortho:g("./ortho"),lookAt:g("./lookAt"),str:g("./str")}},{"./adjoint":2,"./clone":3,"./copy":4,"./create":5,"./determinant":6,"./fromQuat":7,
"./fromRotation":8,"./fromRotationTranslation":9,"./fromScaling":10,"./fromTranslation":11,"./fromXRotation":12,"./fromYRotation":13,"./fromZRotation":14,"./frustum":15,"./identity":16,"./invert":18,"./lookAt":19,"./multiply":20,"./ortho":21,"./perspective":22,"./perspectiveFromFieldOfView":23,"./rotate":24,"./rotateX":25,"./rotateY":26,"./rotateZ":27,"./scale":28,"./str":29,"./translate":30,"./transpose":31}],18:[function(g,d,q){d.exports=function(a,b){var c=b[0],e=b[1],k=b[2],u=b[3],l=b[4],d=b[5],
g=b[6],t=b[7],A=b[8],z=b[9],G=b[10],q=b[11],y=b[12],E=b[13],B=b[14],C=b[15],J=c*d-e*l,H=c*g-k*l,w=c*t-u*l,F=e*g-k*d,M=e*t-u*d,R=k*t-u*g,X=A*E-z*y,S=A*B-G*y,Z=A*C-q*y,ra=z*B-G*E,ga=z*C-q*E,U=G*C-q*B,V=J*U-H*ga+w*ra+F*Z-M*S+R*X;if(!V)return null;V=1/V;a[0]=(d*U-g*ga+t*ra)*V;a[1]=(k*ga-e*U-u*ra)*V;a[2]=(E*R-B*M+C*F)*V;a[3]=(G*M-z*R-q*F)*V;a[4]=(g*Z-l*U-t*S)*V;a[5]=(c*U-k*Z+u*S)*V;a[6]=(B*w-y*R-C*H)*V;a[7]=(A*R-G*w+q*H)*V;a[8]=(l*ga-d*Z+t*X)*V;a[9]=(e*Z-c*ga-u*X)*V;a[10]=(y*M-E*w+C*J)*V;a[11]=(z*w-A*
M-q*J)*V;a[12]=(d*S-l*ra-g*X)*V;a[13]=(c*ra-e*S+k*X)*V;a[14]=(E*H-y*F-B*J)*V;a[15]=(A*F-z*H+G*J)*V;return a}},{}],19:[function(g,d,q){var a=g("./identity");d.exports=function(b,c,e,k){var u,l,d,g,t,A,z,G,q=c[0],y=c[1];c=c[2];d=k[0];g=k[1];l=k[2];z=e[0];k=e[1];u=e[2];if(1E-6>Math.abs(q-z)&&1E-6>Math.abs(y-k)&&1E-6>Math.abs(c-u))return a(b);e=q-z;k=y-k;z=c-u;G=1/Math.sqrt(e*e+k*k+z*z);e*=G;k*=G;z*=G;u=g*z-l*k;l=l*e-d*z;d=d*k-g*e;(G=Math.sqrt(u*u+l*l+d*d))?(G=1/G,u*=G,l*=G,d*=G):d=l=u=0;g=k*d-z*l;t=
z*u-e*d;A=e*l-k*u;(G=Math.sqrt(g*g+t*t+A*A))?(G=1/G,g*=G,t*=G,A*=G):A=t=g=0;b[0]=u;b[1]=g;b[2]=e;b[3]=0;b[4]=l;b[5]=t;b[6]=k;b[7]=0;b[8]=d;b[9]=A;b[10]=z;b[11]=0;b[12]=-(u*q+l*y+d*c);b[13]=-(g*q+t*y+A*c);b[14]=-(e*q+k*y+z*c);b[15]=1;return b}},{"./identity":16}],20:[function(g,d,q){d.exports=function(a,b,c){var e=b[0],k=b[1],u=b[2],l=b[3],d=b[4],g=b[5],t=b[6],A=b[7],z=b[8],q=b[9],ba=b[10],y=b[11],E=b[12],B=b[13],C=b[14];b=b[15];var J=c[0],H=c[1],w=c[2],F=c[3];a[0]=J*e+H*d+w*z+F*E;a[1]=J*k+H*g+w*q+
F*B;a[2]=J*u+H*t+w*ba+F*C;a[3]=J*l+H*A+w*y+F*b;J=c[4];H=c[5];w=c[6];F=c[7];a[4]=J*e+H*d+w*z+F*E;a[5]=J*k+H*g+w*q+F*B;a[6]=J*u+H*t+w*ba+F*C;a[7]=J*l+H*A+w*y+F*b;J=c[8];H=c[9];w=c[10];F=c[11];a[8]=J*e+H*d+w*z+F*E;a[9]=J*k+H*g+w*q+F*B;a[10]=J*u+H*t+w*ba+F*C;a[11]=J*l+H*A+w*y+F*b;J=c[12];H=c[13];w=c[14];F=c[15];a[12]=J*e+H*d+w*z+F*E;a[13]=J*k+H*g+w*q+F*B;a[14]=J*u+H*t+w*ba+F*C;a[15]=J*l+H*A+w*y+F*b;return a}},{}],21:[function(g,d,q){d.exports=function(a,b,c,e,k,d,l){var g=1/(b-c),q=1/(e-k),t=1/(d-l);
a[0]=-2*g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*q;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*t;a[11]=0;a[12]=(b+c)*g;a[13]=(k+e)*q;a[14]=(l+d)*t;a[15]=1;return a}},{}],22:[function(g,d,q){d.exports=function(a,b,c,e,k){b=1/Math.tan(b/2);var d=1/(e-k);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(k+e)*d;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*k*e*d;a[15]=0;return a}},{}],23:[function(g,d,q){d.exports=function(a,b,c,e){var k=Math.tan(b.upDegrees*Math.PI/180),d=Math.tan(b.downDegrees*
Math.PI/180),l=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var g=2/(l+b),q=2/(k+d);a[0]=g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=q;a[6]=0;a[7]=0;a[8]=-((l-b)*g*.5);a[9]=(k-d)*q*.5;a[10]=e/(c-e);a[11]=-1;a[12]=0;a[13]=0;a[14]=e*c/(c-e);a[15]=0;return a}},{}],24:[function(g,d,q){d.exports=function(a,b,c,e){var k=e[0],d=e[1];e=e[2];var l=Math.sqrt(k*k+d*d+e*e),g,q,t,A,z,G,ba,y,E,B,C,J,H,w,F,M,R,X,S,Z;if(1E-6>Math.abs(l))return null;l=1/l;k*=l;d*=l;e*=l;g=Math.sin(c);q=Math.cos(c);
t=1-q;c=b[0];l=b[1];A=b[2];z=b[3];G=b[4];ba=b[5];y=b[6];E=b[7];B=b[8];C=b[9];J=b[10];H=b[11];w=k*k*t+q;F=d*k*t+e*g;M=e*k*t-d*g;R=k*d*t-e*g;X=d*d*t+q;S=e*d*t+k*g;Z=k*e*t+d*g;k=d*e*t-k*g;d=e*e*t+q;a[0]=c*w+G*F+B*M;a[1]=l*w+ba*F+C*M;a[2]=A*w+y*F+J*M;a[3]=z*w+E*F+H*M;a[4]=c*R+G*X+B*S;a[5]=l*R+ba*X+C*S;a[6]=A*R+y*X+J*S;a[7]=z*R+E*X+H*S;a[8]=c*Z+G*k+B*d;a[9]=l*Z+ba*k+C*d;a[10]=A*Z+y*k+J*d;a[11]=z*Z+E*k+H*d;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],25:[function(g,d,q){d.exports=
function(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[4],g=b[5],l=b[6],q=b[7],D=b[8],t=b[9],A=b[10],z=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=d*c+D*e;a[5]=g*c+t*e;a[6]=l*c+A*e;a[7]=q*c+z*e;a[8]=D*c-d*e;a[9]=t*c-g*e;a[10]=A*c-l*e;a[11]=z*c-q*e;return a}},{}],26:[function(g,d,q){d.exports=function(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[0],g=b[1],l=b[2],q=b[3],D=b[8],t=b[9],A=b[10],z=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=
b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*c-D*e;a[1]=g*c-t*e;a[2]=l*c-A*e;a[3]=q*c-z*e;a[8]=d*e+D*c;a[9]=g*e+t*c;a[10]=l*e+A*c;a[11]=q*e+z*c;return a}},{}],27:[function(g,d,q){d.exports=function(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[0],g=b[1],l=b[2],q=b[3],D=b[4],t=b[5],A=b[6],z=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*c+D*e;a[1]=g*c+t*e;a[2]=l*c+A*e;a[3]=q*c+z*e;a[4]=D*c-d*e;a[5]=t*c-g*e;
a[6]=A*c-l*e;a[7]=z*c-q*e;return a}},{}],28:[function(g,d,q){d.exports=function(a,b,c){var e=c[0],d=c[1];c=c[2];a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*d;a[5]=b[5]*d;a[6]=b[6]*d;a[7]=b[7]*d;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],29:[function(g,d,q){d.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+
a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],30:[function(g,d,q){d.exports=function(a,b,c){var e=c[0],d=c[1];c=c[2];var g,l,q,D,t,A,z,G,ba,y,E,B;b===a?(a[12]=b[0]*e+b[4]*d+b[8]*c+b[12],a[13]=b[1]*e+b[5]*d+b[9]*c+b[13],a[14]=b[2]*e+b[6]*d+b[10]*c+b[14],a[15]=b[3]*e+b[7]*d+b[11]*c+b[15]):(g=b[0],l=b[1],q=b[2],D=b[3],t=b[4],A=b[5],z=b[6],G=b[7],ba=b[8],y=b[9],E=b[10],B=b[11],a[0]=g,a[1]=l,a[2]=q,a[3]=D,a[4]=t,a[5]=A,a[6]=z,a[7]=G,a[8]=ba,a[9]=y,a[10]=E,a[11]=B,a[12]=g*e+t*d+ba*c+b[12],a[13]=l*e+
A*d+y*c+b[13],a[14]=q*e+z*d+E*c+b[14],a[15]=D*e+G*d+B*c+b[15]);return a}},{}],31:[function(g,d,q){d.exports=function(a,b){if(a===b){var c=b[1],e=b[2],d=b[3],g=b[6],l=b[7],q=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=e;a[9]=g;a[11]=b[14];a[12]=d;a[13]=l;a[14]=q}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],32:[function(g,d,q){(function(a,
b){"object"===typeof q&&"undefined"!==typeof d?d.exports=b():"function"===typeof define&&define.amd?define(b):a.createREGL=b()})(this,function(){function a(a){return"undefined"!==typeof atob?atob(a):"base64:"+a}function b(a){a=Error("(regl) "+a);console.error(a);throw a;}function c(a,m){a||b(m)}function e(a){return a?": "+a:""}function d(a,b){switch(b){case "number":return"number"===typeof a;case "object":return"object"===typeof a;case "string":return"string"===typeof a;case "boolean":return"boolean"===
typeof a;case "function":return"function"===typeof a;case "undefined":return"undefined"===typeof a;case "symbol":return"symbol"===typeof a}}function g(a,m,f){0>m.indexOf(a)&&b("invalid value"+e(f)+". must be one of: "+m)}function l(a,b){for(a+="";a.length<b;)a=" "+a;return a}function q(){this.name="unknown";this.lines=[];this.index={};this.hasErrors=!1}function D(a,b){this.number=a;this.line=b;this.errors=[]}function t(a,b,f){this.file=a;this.line=b;this.message=f}function A(){var a=Error(),a=(a.stack||
a).toString(),b=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(a);return b?b[1]:(a=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(a))?a[1]:"unknown"}function z(){var a=Error(),a=(a.stack||a).toString(),b=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(a);return b?b[1]:(a=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(a))?a[1]:"unknown"}function G(h,b){var f=h.split("\n"),c=1,d=0,e={unknown:new q,0:new q};e.unknown.name=e[0].name=b||A();e.unknown.lines.push(new D(0,""));for(var g=0;g<f.length;++g){var T=f[g],l=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(T);
if(l)switch(l[1]){case "line":if(l=/(\d+)(\s+\d+)?/.exec(l[2]))c=l[1]|0,l[2]&&(d=l[2]|0,d in e||(e[d]=new q));break;case "define":if(l=/SHADER_NAME(_B64)?\s+(.*)$/.exec(l[2]))e[d].name=l[1]?a(l[2]):l[2]}e[d].lines.push(new D(c++,T))}Object.keys(e).forEach(function(a){var h=e[a];h.lines.forEach(function(a){h.index[a.number]=a})});return e}function ba(a){var b=[];a.split("\n").forEach(function(a){if(!(5>a.length)){var h=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(a);h?b.push(new t(h[1]|0,h[2]|0,h[3].trim())):
0<a.length&&b.push(new t("unknown",0,a))}});return b}function y(a,b){b.forEach(function(b){var f=a[b.file];if(f){var m=f.index[b.line];if(m){m.errors.push(b);f.hasErrors=!0;return}}a.unknown.hasErrors=!0;a.unknown.lines[0].errors.push(b)})}function E(a){a._commandRef=A()}function B(a,f){var ha=z();b(a+" in command "+(f||A())+("unknown"===ha?"":" called from "+ha))}function C(a,b,f,c){d(a,b)||B("invalid parameter type"+e(f)+". expected "+b+", got "+typeof a,c||A())}function J(a,b){return 32820===a||
32819===a||33635===a?2:34042===a?4:la[a]*b}function H(a,b){this.id=Qb++;this.type=a;this.data=b}function w(a){if(0===a.length)return[];var b=a.charAt(0),f=a.charAt(a.length-1);if(1<a.length&&b===f&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return w(a.substr(0,b.index)).concat(w(b[1])).concat(w(a.substr(b.index+b[0].length)));b=a.split(".");if(1===b.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,
'\\"')+'"'];a=[];for(f=0;f<b.length;++f)a=a.concat(w(b[f]));return a}function F(a){return"["+w(a).join("][")+"]"}function M(){var a={"":0},b=[""];return{id:function(f){var c=a[f];if(c)return c;c=a[f]=b.length;b.push(f);return c},str:function(a){return b[a]}}}function R(a,b,f){function c(){var b=window.innerWidth,m=window.innerHeight;a!==document.body&&(m=a.getBoundingClientRect(),b=m.right-m.left,m=m.bottom-m.top);e.width=f*b;e.height=f*m;Y(e.style,{width:b+"px",height:m+"px"})}var e=document.createElement("canvas");
Y(e.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(e);a===document.body&&(e.style.position="absolute",Y(a.style,{margin:0,padding:0}));var d;a!==document.body&&"function"===typeof ResizeObserver?(d=new ResizeObserver(function(){setTimeout(c)}),d.observe(a)):window.addEventListener("resize",c,!1);c();return{canvas:e,onDestroy:function(){d?d.disconnect():window.removeEventListener("resize",c);a.removeChild(e)}}}function X(a,b){function f(c){try{return a.getContext(c,b)}catch(e){return null}}
return f("webgl")||f("experimental-webgl")||f("webgl-experimental")}function S(a){if("string"===typeof a)return a.split();f(Array.isArray(a),"invalid extension array");return a}function Z(a){return"string"===typeof a?(f("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(a)):a}function ra(a){var b=a||{},c,e,d,g;a={};var l=[],T=[],k="undefined"===typeof window?1:window.devicePixelRatio,n=!1,p=function(a){a&&f.raise(a)},x=function(){};"string"===typeof b?(f("undefined"!==
typeof document,"selector queries only supported in DOM enviroments"),c=document.querySelector(b),f(c,"invalid query string for element")):"object"===typeof b?"string"===typeof b.nodeName&&"function"===typeof b.appendChild&&"function"===typeof b.getBoundingClientRect?c=b:"function"===typeof b.drawArrays||"function"===typeof b.drawElements?(g=b,d=g.canvas):(f.constructor(b),"gl"in b?g=b.gl:"canvas"in b?d=Z(b.canvas):"container"in b&&(e=Z(b.container)),"attributes"in b&&(a=b.attributes,f.type(a,"object",
"invalid context attributes")),"extensions"in b&&(l=S(b.extensions)),"optionalExtensions"in b&&(T=S(b.optionalExtensions)),"onDone"in b&&(f.type(b.onDone,"function","invalid or missing onDone callback"),p=b.onDone),"profile"in b&&(n=!!b.profile),"pixelRatio"in b&&(k=+b.pixelRatio,f(0<k,"invalid pixel ratio"))):f.raise("invalid arguments to regl");c&&("canvas"===c.nodeName.toLowerCase()?d=c:e=c);if(!g){if(!d){f("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");
c=R(e||document.body,p,k);if(!c)return null;d=c.canvas;x=c.onDestroy}void 0===a.premultipliedAlpha&&(a.premultipliedAlpha=!0);g=X(d,a)}return g?{gl:g,canvas:d,container:e,extensions:l,optionalExtensions:T,pixelRatio:k,profile:n,onDone:p,onDestroy:x}:(x(),p("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ga(a,b){function c(b){f.type(b,"string","extension name must be string");b=b.toLowerCase();var m;try{m=e[b]=a.getExtension(b)}catch(d){}return!!m}
for(var e={},d=0;d<b.extensions.length;++d){var g=b.extensions[d];if(!c(g))return b.onDestroy(),b.onDone('"'+g+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}b.optionalExtensions.forEach(c);return{extensions:e,restore:function(){Object.keys(e).forEach(function(a){if(e[a]&&!c(a))throw Error("(regl): error restoring extension "+a);})}}}function U(a,b){for(var f=Array(a),c=0;c<a;++c)f[c]=b(c);return f}function V(a){var b,f;b=(65535<
a)<<4;a>>>=b;f=(255<a)<<3;a>>>=f;b|=f;f=(15<a)<<2;a>>>=f;b|=f;f=(3<a)<<1;return b|f|a>>>f>>1}function tb(){function a(b){a:{for(var h=16;268435456>=h;h*=16)if(b<=h){b=h;break a}b=0}h=f[V(b)>>2];return 0<h.length?h.pop():new ArrayBuffer(b)}function b(a){f[V(a.byteLength)>>2].push(a)}var f=U(8,function(){return[]});return{alloc:a,free:b,allocType:function(b,f){var m=null;switch(b){case 5120:m=new Int8Array(a(f),0,f);break;case 5121:m=new Uint8Array(a(f),0,f);break;case 5122:m=new Int16Array(a(2*f),
0,f);break;case 5123:m=new Uint16Array(a(2*f),0,f);break;case 5124:m=new Int32Array(a(4*f),0,f);break;case 5125:m=new Uint32Array(a(4*f),0,f);break;case 5126:m=new Float32Array(a(4*f),0,f);break;default:return null}return m.length!==f?m.subarray(0,f):m},freeType:function(a){b(a.buffer)}}}function pa(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||aa(a.data))}function Ja(a,b,f,
c,e,d){for(var g=0;g<b;++g)for(var l=a[g],k=0;k<f;++k)for(var n=l[k],p=0;p<c;++p)e[d++]=n[p]}function ub(a,b,f,c,e){for(var d=1,g=f+1;g<b.length;++g)d*=b[g];var l=b[f];if(4===b.length-f){var k=b[f+1],n=b[f+2];b=b[f+3];for(g=0;g<l;++g)Ja(a[g],k,n,b,c,e),e+=d}else for(g=0;g<l;++g)ub(a[g],b,f+1,c,e),e+=d}function $a(a){return ab[Object.prototype.toString.call(a)]|0}function vb(a,b){for(var f=0;f<b.length;++f)a[f]=b[f]}function wb(a,b,f,c,e,d,g){for(var l=0,k=0;k<f;++k)for(var n=0;n<c;++n)a[l++]=b[e*
k+d*n+g]}function Rb(a,b,c,e){function d(b){this.id=q++;this.buffer=a.createBuffer();this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;c.profile&&(this.stats={size:0})}function g(b,f,c){b.byteLength=f.byteLength;a.bufferData(b.type,f,c)}function l(a,b,h,c,e,m){a.usage=h;if(Array.isArray(b)){if(a.dtype=c||5126,0<b.length)if(Array.isArray(b[0])){e=xb(b);for(var d=c=1;d<e.length;++d)c*=e[d];a.dimension=c;b=jb(b,e,a.dtype);g(a,b,h);m?a.persistentData=
b:P.freeType(b)}else"number"===typeof b[0]?(a.dimension=e,e=P.allocType(a.dtype,b.length),vb(e,b),g(a,e,h),m?a.persistentData=e:P.freeType(e)):aa(b[0])?(a.dimension=b[0].length,a.dtype=c||$a(b[0])||5126,b=jb(b,[b.length,b[0].length],a.dtype),g(a,b,h),m?a.persistentData=b:P.freeType(b)):f.raise("invalid buffer data")}else if(aa(b))a.dtype=c||$a(b),a.dimension=e,g(a,b,h),m&&(a.persistentData=new Uint8Array(new Uint8Array(b.buffer)));else if(pa(b)){e=b.shape;var O=b.stride,d=b.offset,ha=0,k=0,n=0,T=
0;1===e.length?(ha=e[0],k=1,n=O[0],T=0):2===e.length?(ha=e[0],k=e[1],n=O[0],T=O[1]):f.raise("invalid shape");a.dtype=c||$a(b.data)||5126;a.dimension=k;e=P.allocType(a.dtype,ha*k);wb(e,b.data,ha,k,n,T,d);g(a,e,h);m?a.persistentData=e:P.freeType(e)}else b instanceof ArrayBuffer?(a.dtype=5121,a.dimension=e,g(a,b,h),m&&(a.persistentData=new Uint8Array(new Uint8Array(b)))):f.raise("invalid buffer data")}function k(c){b.bufferCount--;e(c);var d=c.buffer;f(d,"buffer must not be deleted already");a.deleteBuffer(d);
c.buffer=null;delete n[c.id]}var q=0,n={};d.prototype.bind=function(){a.bindBuffer(this.type,this.buffer)};d.prototype.destroy=function(){k(this)};var p=[];c.profile&&(b.getTotalBufferSize=function(){var a=0;Object.keys(n).forEach(function(b){a+=n[b].stats.size});return a});return{create:function(e,g,v,W){function L(b){var e=35044,d=null,m=0,g=0,x=1;Array.isArray(b)||aa(b)||pa(b)||b instanceof ArrayBuffer?d=b:"number"===typeof b?m=b|0:b&&(f.type(b,"object","buffer arguments must be an object, a number or an array"),
"data"in b&&(f(null===d||Array.isArray(d)||aa(d)||pa(d),"invalid data for buffer"),d=b.data),"usage"in b&&(f.parameter(b.usage,cb,"invalid buffer usage"),e=cb[b.usage]),"type"in b&&(f.parameter(b.type,Fa,"invalid buffer type"),g=Fa[b.type]),"dimension"in b&&(f.type(b.dimension,"number","invalid dimension"),x=b.dimension|0),"length"in b&&(f.nni(m,"buffer length must be a nonnegative integer"),m=b.length|0));r.bind();d?l(r,d,e,g,x,W):(m&&a.bufferData(r.type,m,e),r.dtype=g||5121,r.usage=e,r.dimension=
x,r.byteLength=m);c.profile&&(r.stats.size=r.byteLength*va[r.dtype]);return L}function ya(b,c){f(c+b.byteLength<=r.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+b.byteLength+" starting from offset "+c+" to a buffer of size "+r.byteLength);a.bufferSubData(r.type,c,b)}b.bufferCount++;var r=new d(g);n[r.id]=r;v||L(e);L._reglType="buffer";L._buffer=r;L.subdata=function(a,b){var h=(b||0)|0,c;r.bind();if(aa(a)||a instanceof ArrayBuffer)ya(a,h);else if(Array.isArray(a)){if(0<
a.length)if("number"===typeof a[0]){var e=P.allocType(r.dtype,a.length);vb(e,a);ya(e,h);P.freeType(e)}else Array.isArray(a[0])||aa(a[0])?(c=xb(a),e=jb(a,c,r.dtype),ya(e,h),P.freeType(e)):f.raise("invalid buffer data")}else if(pa(a)){c=a.shape;var d=a.stride,m=e=0,g=0,l=0;1===c.length?(e=c[0],m=1,g=d[0],l=0):2===c.length?(e=c[0],m=c[1],g=d[0],l=d[1]):f.raise("invalid shape");c=Array.isArray(a.data)?r.dtype:$a(a.data);c=P.allocType(c,e*m);wb(c,a.data,e,m,g,l,a.offset);ya(c,h);P.freeType(c)}else f.raise("invalid data for buffer subdata");
return L};c.profile&&(L.stats=r.stats);L.destroy=function(){k(r)};return L},createStream:function(a,b){var h=p.pop();h||(h=new d(a));h.bind();l(h,b,35040,0,1,!1);return h},destroyStream:function(a){p.push(a)},clear:function(){ka(n).forEach(k);p.forEach(k)},getBuffer:function(a){return a&&a._buffer instanceof d?a._buffer:null},restore:function(){ka(n).forEach(function(b){b.buffer=a.createBuffer();a.bindBuffer(b.type,b.buffer);a.bufferData(b.type,b.persistentData||b.byteLength,b.usage)})},_initBuffer:l}}
function Sb(a,b,c,e){function d(a){this.id=q++;k[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function g(e,d,l,k,L,n,r){e.buffer.bind();var O;d?((O=r)||aa(d)&&(!pa(d)||aa(d.data))||(O=b.oes_element_index_uint?5125:5123),c._initBuffer(e.buffer,d,l,O,3)):(a.bufferData(34963,n,l),e.buffer.dtype=O||5121,e.buffer.usage=l,e.buffer.dimension=3,e.buffer.byteLength=n);O=r;if(!r){switch(e.buffer.dtype){case 5121:case 5120:O=5121;break;case 5123:case 5122:O=5123;break;case 5125:case 5124:O=
5125;break;default:f.raise("unsupported type for element array")}e.buffer.dtype=O}e.type=O;f(5125!==O||!!b.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");d=L;0>d&&(d=e.buffer.byteLength,5123===O?d>>=1:5125===O&&(d>>=2));e.vertCount=d;d=k;0>k&&(d=4,k=e.buffer.dimension,1===k&&(d=0),2===k&&(d=1),3===k&&(d=4));e.primType=d}function l(a){e.elementsCount--;f(null!==a.buffer,"must not double destroy elements");delete k[a.id];a.buffer.destroy();a.buffer=
null}var k={},q=0,n={uint8:5121,uint16:5123};b.oes_element_index_uint&&(n.uint32=5125);d.prototype.bind=function(){this.buffer.bind()};var p=[];return{create:function(a,b){function h(a){if(a)if("number"===typeof a)m(a),L.primType=4,L.vertCount=a|0,L.type=5121;else{var b=null,e=35044,c=-1,d=-1,l=0,ha=0;if(Array.isArray(a)||aa(a)||pa(a))b=a;else if(f.type(a,"object","invalid arguments for elements"),"data"in a&&(b=a.data,f(Array.isArray(b)||aa(b)||pa(b),"invalid data for element buffer")),"usage"in
a&&(f.parameter(a.usage,cb,"invalid element buffer usage"),e=cb[a.usage]),"primitive"in a&&(f.parameter(a.primitive,La,"invalid element buffer primitive"),c=La[a.primitive]),"count"in a&&(f("number"===typeof a.count&&0<=a.count,"invalid vertex count for elements"),d=a.count|0),"type"in a&&(f.parameter(a.type,n,"invalid buffer type"),ha=n[a.type]),"length"in a)l=a.length|0;else if(l=d,5123===ha||5122===ha)l*=2;else if(5125===ha||5124===ha)l*=4;g(L,b,e,c,d,l,ha)}else m(),L.primType=4,L.vertCount=0,
L.type=5121;return h}var m=c.create(null,34963,!0),L=new d(m._buffer);e.elementsCount++;h(a);h._reglType="elements";h._elements=L;h.subdata=function(a,b){m.subdata(a,b);return h};h.destroy=function(){l(L)};return h},createStream:function(a){var b=p.pop();b||(b=new d(c.create(null,34963,!0,!1)._buffer));g(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){p.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof d?a._elements:null},clear:function(){ka(k).forEach(l)}}}
function yb(a){for(var b=P.allocType(5123,a.length),f=0;f<a.length;++f)if(isNaN(a[f]))b[f]=65535;else if(Infinity===a[f])b[f]=31744;else if(-Infinity===a[f])b[f]=64512;else{zb[0]=a[f];var e=Tb[0],c=e>>>31<<15,d=(e<<1>>>24)-127,e=e>>13&1023;b[f]=-24>d?c:-14>d?c+(e+1024>>-14-d):15<d?c+31744:c+(d+15<<10)+e}return b}function N(a){return Array.isArray(a)||aa(a)}function Ma(a){return"[object "+a+"]"}function Ab(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function Bb(a){return Array.isArray(a)&&
0!==a.length&&N(a[0])?!0:!1}function ma(a){return Object.prototype.toString.call(a)}function lb(a){if(!a)return!1;var b=ma(a);return 0<=Ub.indexOf(b)?!0:Ab(a)||Bb(a)||pa(a)}function Cb(a,b){36193===a.type?(a.data=yb(b),P.freeType(b)):a.data=b}function db(a,b,f,e,c,d){a="undefined"!==typeof ca[a]?ca[a]:fa[a]*Na[b];d&&(a*=6);if(c){for(e=0;1<=f;)e+=a*f*f,f/=2;return e}return a*f*e}function Vb(a,b,e,c,d,g,l){function k(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=
this.compressed=!1;this.unpackAlignment=1;this.colorSpace=37444;this.channels=this.height=this.width=0}function q(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function n(a,h){if("object"===typeof h&&h){"premultiplyAlpha"in h&&(f.type(h.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),
a.premultiplyAlpha=h.premultiplyAlpha);"flipY"in h&&(f.type(h.flipY,"boolean","invalid texture flip"),a.flipY=h.flipY);"alignment"in h&&(f.oneOf(h.alignment,[1,2,4,8],"invalid texture unpack alignment"),a.unpackAlignment=h.alignment);"colorSpace"in h&&(f.parameter(h.colorSpace,G,"invalid colorSpace"),a.colorSpace=G[h.colorSpace]);if("type"in h){var c=h.type;f(b.oes_texture_float||!("float"===c||"float32"===c),"you must enable the OES_texture_float extension in order to use floating point textures.");
f(b.oes_texture_half_float||!("half float"===c||"float16"===c),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures.");f(b.webgl_depth_texture||!("uint16"===c||"uint32"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures.");f.parameter(c,sa,"invalid texture type");a.type=sa[c]}var d=a.width,g=a.height,l=a.channels,c=!1;"shape"in h?(f(Array.isArray(h.shape)&&2<=h.shape.length,"shape must be an array"),
d=h.shape[0],g=h.shape[1],3===h.shape.length&&(l=h.shape[2],f(0<l&&4>=l,"invalid number of channels"),c=!0),f(0<=d&&d<=e.maxTextureSize,"invalid width"),f(0<=g&&g<=e.maxTextureSize,"invalid height")):("radius"in h&&(d=g=h.radius,f(0<=d&&d<=e.maxTextureSize,"invalid radius")),"width"in h&&(d=h.width,f(0<=d&&d<=e.maxTextureSize,"invalid width")),"height"in h&&(g=h.height,f(0<=g&&g<=e.maxTextureSize,"invalid height")),"channels"in h&&(l=h.channels,f(0<l&&4>=l,"invalid number of channels"),c=!0));a.width=
d|0;a.height=g|0;a.channels=l|0;d=!1;"format"in h&&(d=h.format,f(b.webgl_depth_texture||!("depth"===d||"depth stencil"===d),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),f.parameter(d,y,"invalid texture format"),g=a.internalformat=y[d],a.format=Wa[g],d in sa&&!("type"in h)&&(a.type=sa[d]),d in C&&(a.compressed=!0),d=!0);!c&&d?a.channels=fa[a.format]:c&&!d?a.channels!==eb[a.format]&&(a.format=a.internalformat=eb[a.channels]):d&&c&&f(a.channels===fa[a.format],
"number of channels inconsistent with specified format")}}function p(b){a.pixelStorei(37440,b.flipY);a.pixelStorei(37441,b.premultiplyAlpha);a.pixelStorei(37443,b.colorSpace);a.pixelStorei(3317,b.unpackAlignment)}function x(){k.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function w(a,b){var h=null;lb(b)?h=b:b&&(f.type(b,"object","invalid pixel data type"),n(a,b),"x"in b&&(a.xOffset=b.x|0),"y"in b&&(a.yOffset=b.y|0),lb(b.data)&&(h=b.data));
f(!a.compressed||h instanceof Uint8Array,"compressed texture data must be stored in a uint8array");if(b.copy){f(!h,"can not specify copy and data field for the same texture");var c=d.viewportWidth,g=d.viewportHeight;a.width=a.width||c-a.xOffset;a.height=a.height||g-a.yOffset;a.needsCopy=!0;f(0<=a.xOffset&&a.xOffset<c&&0<=a.yOffset&&a.yOffset<g&&0<a.width&&a.width<=c&&0<a.height&&a.height<=g,"copy texture read out of bounds")}else if(!h)a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||
4;else if(aa(h))a.channels=a.channels||4,a.data=h,"type"in b||5121!==a.type||(a.type=ab[Object.prototype.toString.call(h)]|0);else if(Ab(h)){a.channels=a.channels||4;c=h;g=c.length;switch(a.type){case 5121:case 5123:case 5125:case 5126:g=P.allocType(a.type,g);g.set(c);a.data=g;break;case 36193:a.data=yb(c);break;default:f.raise("unsupported texture type, must specify a typed array")}a.alignment=1;a.needsFree=!0}else if(pa(h)){c=h.data;Array.isArray(c)||5121!==a.type||(a.type=ab[Object.prototype.toString.call(c)]|
0);var g=h.shape,m=h.stride,l,L,k,r;3===g.length?(k=g[2],r=m[2]):(f(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),r=k=1);l=g[0];L=g[1];g=m[0];m=m[1];a.alignment=1;a.width=l;a.height=L;a.channels=k;a.format=a.internalformat=eb[k];a.needsFree=!0;l=r;h=h.offset;k=a.width;r=a.height;L=a.channels;for(var Q=P.allocType(36193===a.type?5126:a.type,k*r*L),ea=0,ia=0;ia<r;++ia)for(var wa=0;wa<k;++wa)for(var mb=0;mb<L;++mb)Q[ea++]=c[g*wa+m*ia+l*mb+h];Cb(a,Q)}else if(ma(h)===nb||ma(h)===ob||ma(h)===
Db)ma(h)===nb||ma(h)===ob?a.element=h:a.element=h.canvas,a.width=a.element.width,a.height=a.element.height,a.channels=4;else if(ma(h)===Eb)a.element=h,a.width=h.width,a.height=h.height,a.channels=4;else if(ma(h)===Fb)a.element=h,a.width=h.naturalWidth,a.height=h.naturalHeight,a.channels=4;else if(ma(h)===Gb)a.element=h,a.width=h.videoWidth,a.height=h.videoHeight,a.channels=4;else if(Bb(h)){c=a.width||h[0].length;g=a.height||h.length;m=a.channels;m=N(h[0][0])?m||h[0][0].length:m||1;l=fb.shape(h);k=
1;for(r=0;r<l.length;++r)k*=l[r];k=P.allocType(36193===a.type?5126:a.type,k);fb.flatten(h,l,"",k);Cb(a,k);a.alignment=1;a.width=c;a.height=g;a.channels=m;a.format=a.internalformat=eb[m];a.needsFree=!0}5126===a.type?f(0<=e.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):36193===a.type&&f(0<=e.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}function v(b,f,e,d,g){var m=b.element,l=b.data,k=b.internalformat,L=b.format,r=b.type,
Q=b.width,ea=b.height;p(b);m?a.texSubImage2D(f,g,e,d,L,r,m):b.compressed?a.compressedTexSubImage2D(f,g,e,d,k,Q,ea,l):b.needsCopy?(c(),a.copyTexSubImage2D(f,g,e,d,b.xOffset,b.yOffset,Q,ea)):a.texSubImage2D(f,g,e,d,Q,ea,L,r,l)}function W(){return U.pop()||new x}function L(a){a.needsFree&&P.freeType(a.data);x.call(a);U.push(a)}function u(){k.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function r(a,b,h){var f=a.images[0]=W();a.mipmask=1;f.width=a.width=b;f.height=
a.height=h;f.channels=a.channels=4}function O(a,b){var h=null;if(lb(b))h=a.images[0]=W(),q(h,a),w(h,b),a.mipmask=1;else if(n(a,b),Array.isArray(b.mipmap))for(var c=b.mipmap,e=0;e<c.length;++e)h=a.images[e]=W(),q(h,a),h.width>>=e,h.height>>=e,w(h,c[e]),a.mipmask|=1<<e;else h=a.images[0]=W(),q(h,a),w(h,b),a.mipmask=1;q(a,a.images[0]);!a.compressed||33776!==a.internalformat&&33777!==a.internalformat&&33778!==a.internalformat&&33779!==a.internalformat||f(0===a.width%4&&0===a.height%4,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}
function t(b,f){for(var e=b.images,d=0;d<e.length&&e[d];++d){var g=e[d],m=f,l=d,k=g.element,L=g.data,r=g.internalformat,Q=g.format,ea=g.type,ia=g.width,wa=g.height;p(g);k?a.texImage2D(m,l,Q,Q,ea,k):g.compressed?a.compressedTexImage2D(m,l,r,ia,wa,0,L):g.needsCopy?(c(),a.copyTexImage2D(m,l,Q,g.xOffset,g.yOffset,ia,wa,0)):a.texImage2D(m,l,Q,ia,wa,0,Q,ea,L||null)}}function z(){var a=X.pop()||new u;k.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function A(a){for(var b=a.images,h=0;h<
b.length;++h)b[h]&&L(b[h]),b[h]=null;X.push(a)}function F(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function B(a,b){if("min"in b){var h=b.min;f.parameter(h,gb);a.minFilter=gb[h];0<=Xb.indexOf(a.minFilter)&&!("faces"in b)&&(a.genMipmaps=!0)}"mag"in b&&(h=b.mag,f.parameter(h,Xa),a.magFilter=Xa[h]);var h=a.wrapS,c=a.wrapT;if("wrap"in b){var d=b.wrap;"string"===typeof d?(f.parameter(d,M),h=c=M[d]):Array.isArray(d)&&(f.parameter(d[0],
M),f.parameter(d[1],M),h=M[d[0]],c=M[d[1]])}else"wrapS"in b&&(h=b.wrapS,f.parameter(h,M),h=M[h]),"wrapT"in b&&(c=b.wrapT,f.parameter(c,M),c=M[c]);a.wrapS=h;a.wrapT=c;"anisotropic"in b&&(h=b.anisotropic,f("number"===typeof h&&1<=h&&h<=e.maxAnisotropic,"aniso samples must be between 1 and "),a.anisotropic=b.anisotropic);if("mipmap"in b){h=!1;switch(typeof b.mipmap){case "string":f.parameter(b.mipmap,Hb,"invalid mipmap hint");a.mipmapHint=Hb[b.mipmap];h=a.genMipmaps=!0;break;case "boolean":h=a.genMipmaps=
b.mipmap;break;case "object":f(Array.isArray(b.mipmap),"invalid mipmap type");a.genMipmaps=!1;h=!0;break;default:f.raise("invalid mipmap type")}!h||"min"in b||(a.minFilter=9984)}}function E(f,c){a.texParameteri(c,10241,f.minFilter);a.texParameteri(c,10240,f.magFilter);a.texParameteri(c,10242,f.wrapS);a.texParameteri(c,10243,f.wrapT);b.ext_texture_filter_anisotropic&&a.texParameteri(c,34046,f.anisotropic);f.genMipmaps&&(a.hint(33170,f.mipmapHint),a.generateMipmap(c))}function kb(b){k.call(this);this.mipmask=
0;this.internalformat=6408;this.id=V++;this.refCount=1;this.target=b;this.texture=a.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new F;l.profile&&(this.stats={size:0})}function Ka(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function Oa(){var b=ga[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function I(b){var c=b.texture;f(c,"must not double destroy texture");var e=b.unit,d=b.target;0<=e&&(a.activeTexture(33984+e),a.bindTexture(d,null),ga[e]=null);a.deleteTexture(c);
b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete S[b.id];g.textureCount--}var Hb={"don't care":4352,"dont care":4352,nice:4354,fast:4353},M={repeat:10497,clamp:33071,mirror:33648},Xa={nearest:9728,linear:9729},gb=Y({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Xa),G={none:0,browser:37444},sa={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,
rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},C={};b.ext_srgb&&(y.srgb=35904,y.srgba=35906);b.oes_texture_float&&(sa.float32=sa["float"]=5126);b.oes_texture_half_float&&(sa.float16=sa["half float"]=36193);b.webgl_depth_texture&&(Y(y,{depth:6402,"depth stencil":34041}),Y(sa,{uint16:5123,uint32:5125,"depth stencil":34042}));b.webgl_compressed_texture_s3tc&&Y(C,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});b.webgl_compressed_texture_atc&&Y(C,{"rgb atc":35986,
"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});b.webgl_compressed_texture_pvrtc&&Y(C,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});b.webgl_compressed_texture_etc1&&(C["rgb etc1"]=36196);var Z=Array.prototype.slice.call(a.getParameter(34467));Object.keys(C).forEach(function(a){var b=C[a];0<=Z.indexOf(b)&&(y[a]=b)});var D=Object.keys(y);e.textureFormats=D;var H=[];Object.keys(y).forEach(function(a){H[y[a]]=a});var K=[];
Object.keys(sa).forEach(function(a){K[sa[a]]=a});var J=[];Object.keys(Xa).forEach(function(a){J[Xa[a]]=a});var Ya=[];Object.keys(gb).forEach(function(a){Ya[gb[a]]=a});var Ga=[];Object.keys(M).forEach(function(a){Ga[M[a]]=a});var Wa=D.reduce(function(a,h){var f=y[h];6409===f||6406===f||6409===f||6410===f||6402===f||34041===f||b.ext_srgb&&(35904===f||35906===f)?a[f]=f:32855===f||0<=h.indexOf("rgba")?a[f]=6408:a[f]=6407;return a},{}),U=[],X=[],V=0,S={},R=e.maxTextureUnits,ga=Array(R).map(function(){return null});
Y(kb.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<R;++c){var e=ga[c];if(e){if(0<e.bindCount)continue;e.unit=-1}ga[c]=this;b=c;break}b>=R&&f.raise("insufficient number of texture units");l.profile&&g.maxTextureUnits<b+1&&(g.maxTextureUnits=b+1);this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&I(this)}});l.profile&&(g.getTotalTextureSize=function(){var a=
0;Object.keys(S).forEach(function(b){a+=S[b].stats.size});return a});return{create2D:function(b,c){function d(a,b){var h=m.texInfo;F.call(h);var c=z();"number"===typeof a?"number"===typeof b?r(c,a|0,b|0):r(c,a|0,a|0):a?(f.type(a,"object","invalid arguments to regl.texture"),B(h,a),O(c,a)):r(c,1,1);h.genMipmaps&&(c.mipmask=(c.width<<1)-1);m.mipmask=c.mipmask;q(m,c);f.texture2D(h,c,e);m.internalformat=c.internalformat;d.width=c.width;d.height=c.height;Ka(m);t(c,3553);E(h,3553);Oa();A(c);l.profile&&
(m.stats.size=db(m.internalformat,m.type,c.width,c.height,h.genMipmaps,!1));d.format=H[m.internalformat];d.type=K[m.type];d.mag=J[h.magFilter];d.min=Ya[h.minFilter];d.wrapS=Ga[h.wrapS];d.wrapT=Ga[h.wrapT];return d}var m=new kb(3553);S[m.id]=m;g.textureCount++;d(b,c);d.subimage=function(a,b,h,c){f(!!a,"must specify image data");b|=0;h|=0;c|=0;var e=W();q(e,m);e.width=0;e.height=0;w(e,a);e.width=e.width||(m.width>>c)-b;e.height=e.height||(m.height>>c)-h;f(m.type===e.type&&m.format===e.format&&m.internalformat===
e.internalformat,"incompatible format for texture.subimage");f(0<=b&&0<=h&&b+e.width<=m.width&&h+e.height<=m.height,"texture.subimage write out of bounds");f(m.mipmask&1<<c,"missing mipmap data");f(e.data||e.element||e.needsCopy,"missing image data");Ka(m);v(e,3553,b,h,c);Oa();L(e);return d};d.resize=function(b,f){var c=b|0,e=f|0||c;if(c===m.width&&e===m.height)return d;d.width=m.width=c;d.height=m.height=e;Ka(m);for(var g=0;m.mipmask>>g;++g){var k=c>>g,Q=e>>g;if(!k||!Q)break;a.texImage2D(3553,g,
m.format,k,Q,0,m.format,m.type,null)}Oa();l.profile&&(m.stats.size=db(m.internalformat,m.type,c,e,!1,!1));return d};d._reglType="texture2d";d._texture=m;l.profile&&(d.stats=m.stats);d.destroy=function(){m.decRef()};return d},createCube:function(b,c,d,m,k,T){function p(a,b,h,c,d,m){var g,na=I.texInfo;F.call(na);for(g=0;6>g;++g)x[g]=z();if("number"!==typeof a&&a)if("object"===typeof a)if(b)O(x[0],a),O(x[1],b),O(x[2],h),O(x[3],c),O(x[4],d),O(x[5],m);else if(B(na,a),n(I,a),"faces"in a)for(a=a.faces,f(Array.isArray(a)&&
6===a.length,"cube faces must be a length 6 array"),g=0;6>g;++g)f("object"===typeof a[g]&&!!a[g],"invalid input for cube map face"),q(x[g],I),O(x[g],a[g]);else for(g=0;6>g;++g)O(x[g],a);else f.raise("invalid arguments to cube map");else for(a=a|0||1,g=0;6>g;++g)r(x[g],a,a);q(I,x[0]);e.npotTextureCube||f(Ib(I.width)&&Ib(I.height),"your browser does not support non power or two texture dimensions");I.mipmask=na.genMipmaps?(x[0].width<<1)-1:x[0].mipmask;f.textureCube(I,na,x,e);I.internalformat=x[0].internalformat;
p.width=x[0].width;p.height=x[0].height;Ka(I);for(g=0;6>g;++g)t(x[g],34069+g);E(na,34067);Oa();l.profile&&(I.stats.size=db(I.internalformat,I.type,p.width,p.height,na.genMipmaps,!0));p.format=H[I.internalformat];p.type=K[I.type];p.mag=J[na.magFilter];p.min=Ya[na.minFilter];p.wrapS=Ga[na.wrapS];p.wrapT=Ga[na.wrapT];for(g=0;6>g;++g)A(x[g]);return p}var I=new kb(34067);S[I.id]=I;g.cubeCount++;var x=Array(6);p(b,c,d,m,k,T);p.subimage=function(a,b,h,c,e){f(!!b,"must specify image data");f("number"===typeof a&&
a===(a|0)&&0<=a&&6>a,"invalid face");h|=0;c|=0;e|=0;var d=W();q(d,I);d.width=0;d.height=0;w(d,b);d.width=d.width||(I.width>>e)-h;d.height=d.height||(I.height>>e)-c;f(I.type===d.type&&I.format===d.format&&I.internalformat===d.internalformat,"incompatible format for texture.subimage");f(0<=h&&0<=c&&h+d.width<=I.width&&c+d.height<=I.height,"texture.subimage write out of bounds");f(I.mipmask&1<<e,"missing mipmap data");f(d.data||d.element||d.needsCopy,"missing image data");Ka(I);v(d,34069+a,h,c,e);Oa();
L(d);return p};p.resize=function(b){b|=0;if(b!==I.width){p.width=I.width=b;p.height=I.height=b;Ka(I);for(var f=0;6>f;++f)for(var c=0;I.mipmask>>c;++c)a.texImage2D(34069+f,c,I.format,b>>c,b>>c,0,I.format,I.type,null);Oa();l.profile&&(I.stats.size=db(I.internalformat,I.type,p.width,p.height,!1,!0));return p}};p._reglType="textureCube";p._texture=I;l.profile&&(p.stats=I.stats);p.destroy=function(){I.decRef()};return p},clear:function(){for(var b=0;b<R;++b)a.activeTexture(33984+b),a.bindTexture(3553,
null),ga[b]=null;ka(S).forEach(I);g.cubeCount=0;g.textureCount=0},getTexture:function(a){return null},restore:function(){for(var b=0;b<R;++b){var f=ga[b];f&&(f.bindCount=0,f.unit=-1,ga[b]=null)}ka(S).forEach(function(b){b.texture=a.createTexture();a.bindTexture(b.target,b.texture);for(var f=0;32>f;++f)if(0!==(b.mipmask&1<<f))if(3553===b.target)a.texImage2D(3553,f,b.internalformat,b.width>>f,b.height>>f,0,b.internalformat,b.type,null);else for(var c=0;6>c;++c)a.texImage2D(34069+c,f,b.internalformat,
b.width>>f,b.height>>f,0,b.internalformat,b.type,null);E(b.texInfo,b.target)})}}}function Yb(a,b,c,d,e,g){function l(a,b,h){this.target=a;this.texture=b;this.renderbuffer=h;var f=a=0;b?(a=b.width,f=b.height):h&&(a=h.width,f=h.height);this.width=a;this.height=f}function k(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function q(a,b,h){if(a){if(a.texture){a=a.texture._texture;var c=Math.max(1,a.height);f(Math.max(1,a.width)===b&&c===h,"inconsistent width/height for supplied texture")}else a=
a.renderbuffer._renderbuffer,f(a.width===b&&a.height===h,"inconsistent width/height for renderbuffer");a.refCount+=1}}function n(b,f){f&&(f.texture?a.framebufferTexture2D(36160,b,f.target,f.texture._texture.texture,0):a.framebufferRenderbuffer(36160,b,36161,f.renderbuffer._renderbuffer.renderbuffer))}function p(a){var b=3553,h=null,c=null,d=a;"object"===typeof a&&(d=a.data,"target"in a&&(b=a.target|0));f.type(d,"function","invalid attachment data");a=d._reglType;"texture2d"===a?(h=d,f(3553===b)):
"textureCube"===a?(h=d,f(34069<=b&&34075>b,"invalid cube map target")):"renderbuffer"===a?(c=d,b=36161):f.raise("invalid regl object for attachment");return new l(b,h,c)}function x(a,b,h,f,c){if(h)return a=d.create2D({width:a,height:b,format:f,type:c}),a._texture.refCount=0,new l(3553,a,null);a=e.create({width:a,height:b,format:f});a._renderbuffer.refCount=0;return new l(36161,null,a)}function w(a){return a&&(a.texture||a.renderbuffer)}function v(a,b,h){a&&(a.texture?a.texture.resize(b,h):a.renderbuffer&&
a.renderbuffer.resize(b,h),a.width=b,a.height=h)}function W(){this.id=M++;y[this.id]=this;this.framebuffer=a.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function L(a){a.colorAttachments.forEach(k);k(a.depthAttachment);k(a.stencilAttachment);k(a.depthStencilAttachment)}function u(b){var c=b.framebuffer;f(c,"must not double destroy framebuffer");a.deleteFramebuffer(c);b.framebuffer=null;g.framebufferCount--;
delete y[b.id]}function r(b){var d;a.bindFramebuffer(36160,b.framebuffer);var e=b.colorAttachments;for(d=0;d<e.length;++d)n(36064+d,e[d]);for(d=e.length;d<c.maxColorAttachments;++d)a.framebufferTexture2D(36160,36064+d,3553,null,0);a.framebufferTexture2D(36160,33306,3553,null,0);a.framebufferTexture2D(36160,36096,3553,null,0);a.framebufferTexture2D(36160,36128,3553,null,0);n(36096,b.depthAttachment);n(36128,b.stencilAttachment);n(33306,b.depthStencilAttachment);b=a.checkFramebufferStatus(36160);a.isContextLost()||
36053===b||f.raise("framebuffer configuration not supported, status = "+Zb[b]);a.bindFramebuffer(36160,t.next?t.next.framebuffer:null);t.cur=t.next;a.getError()}function O(a,h){function d(a,h){var g;f(t.next!==e,"can not update framebuffer which is currently in use");var l=0,k=0,n=!0,W=!0;g=null;var O=!0,T="rgba",v="uint8",ya=1,u=null,Ta=null,Za=null,bb=!1;if("number"===typeof a)l=a|0,k=h|0||l;else if(a){f.type(a,"object","invalid arguments for framebuffer");"shape"in a?(k=a.shape,f(Array.isArray(k)&&
2<=k.length,"invalid shape for framebuffer"),l=k[0],k=k[1]):("radius"in a&&(l=k=a.radius),"width"in a&&(l=a.width),"height"in a&&(k=a.height));if("color"in a||"colors"in a)g=a.color||a.colors,Array.isArray(g)&&f(1===g.length||b.webgl_draw_buffers,"multiple render targets not supported");if(!g){"colorCount"in a&&(ya=a.colorCount|0,f(0<ya,"invalid color buffer count"));"colorTexture"in a&&(O=!!a.colorTexture,T="rgba4");if("colorType"in a){v=a.colorType;if(O)f(b.oes_texture_float||!("float"===v||"float32"===
v),"you must enable OES_texture_float in order to use floating point framebuffer objects"),f(b.oes_texture_half_float||!("half float"===v||"float16"===v),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects");else if("half float"===v||"float16"===v)f(b.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),T="rgba16f";else if("float"===v||"float32"===v)f(b.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),
T="rgba32f";f.oneOf(v,F,"invalid color type")}if("colorFormat"in a)if(T=a.colorFormat,0<=z.indexOf(T))O=!0;else if(0<=A.indexOf(T))O=!1;else if(O)f.oneOf(a.colorFormat,z,"invalid color format for texture");else f.oneOf(a.colorFormat,A,"invalid color format for renderbuffer")}if("depthTexture"in a||"depthStencilTexture"in a)bb=!(!a.depthTexture&&!a.depthStencilTexture),f(!bb||b.webgl_depth_texture,"webgl_depth_texture extension not supported");"depth"in a&&("boolean"===typeof a.depth?n=a.depth:(u=
a.depth,W=!1));"stencil"in a&&("boolean"===typeof a.stencil?W=a.stencil:(Ta=a.stencil,n=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?n=W=a.depthStencil:(Za=a.depthStencil,W=n=!1))}else l=k=1;var y=null,M=null,C=null,B=null;if(Array.isArray(g))y=g.map(p);else if(g)y=[p(g)];else for(y=Array(ya),g=0;g<ya;++g)y[g]=x(l,k,O,T,v);f(b.webgl_draw_buffers||1>=y.length,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers.");f(y.length<=c.maxColorAttachments,
"too many color attachments, not supported");l=l||y[0].width;k=k||y[0].height;u?M=p(u):n&&!W&&(M=x(l,k,bb,"depth","uint32"));Ta?C=p(Ta):W&&!n&&(C=x(l,k,!1,"stencil","uint8"));Za?B=p(Za):!u&&!Ta&&W&&n&&(B=x(l,k,bb,"depth stencil","depth stencil"));f(1>=!!u+!!Ta+!!Za,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");n=null;for(g=0;g<y.length;++g)q(y[g],l,k),f(!y[g]||y[g].texture&&0<=$b.indexOf(y[g].texture._texture.format)||y[g].renderbuffer&&0<=ac.indexOf(y[g].renderbuffer._renderbuffer.format),
"framebuffer color attachment "+g+" is invalid"),y[g]&&y[g].texture&&(W=pb[y[g].texture._texture.format]*hb[y[g].texture._texture.type],null===n?n=W:f(n===W,"all color attachments much have the same number of bits per pixel."));q(M,l,k);f(!M||M.texture&&6402===M.texture._texture.format||M.renderbuffer&&33189===M.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object");q(C,l,k);f(!C||C.renderbuffer&&36168===C.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object");
q(B,l,k);f(!B||B.texture&&34041===B.texture._texture.format||B.renderbuffer&&34041===B.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object");L(e);e.width=l;e.height=k;e.colorAttachments=y;e.depthAttachment=M;e.stencilAttachment=C;e.depthStencilAttachment=B;d.color=y.map(w);d.depth=w(M);d.stencil=w(C);d.depthStencil=w(B);d.width=e.width;d.height=e.height;r(e);return d}var e=new W;g.framebufferCount++;d(a,h);return Y(d,{resize:function(a,b){f(t.next!==e,"can not resize a framebuffer which is currently in use");
var h=Math.max(a|0,1),c=Math.max(b|0||h,1);if(h===e.width&&c===e.height)return d;for(var g=e.colorAttachments,m=0;m<g.length;++m)v(g[m],h,c);v(e.depthAttachment,h,c);v(e.stencilAttachment,h,c);v(e.depthStencilAttachment,h,c);e.width=d.width=h;e.height=d.height=c;r(e);return d},_reglType:"framebuffer",_framebuffer:e,destroy:function(){u(e);L(e)},use:function(a){t.setFBO({framebuffer:d},a)}})}var t={cur:null,next:null,dirty:!1,setFBO:null},z=["rgba"],A=["rgba4","rgb565","rgb5 a1"];b.ext_srgb&&A.push("srgba");
b.ext_color_buffer_half_float&&A.push("rgba16f","rgb16f");b.webgl_color_buffer_float&&A.push("rgba32f");var F=["uint8"];b.oes_texture_half_float&&F.push("half float","float16");b.oes_texture_float&&F.push("float","float32");var M=0,y={};return Y(t,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof W)?a:null},create:O,createCube:function(a){function h(a){var c;f(0>e.indexOf(t.next),"can not update framebuffer which is currently in use");
var g={color:null},l=0,k=null;c="rgba";var L="uint8",r=1;if("number"===typeof a)l=a|0;else if(a){f.type(a,"object","invalid arguments for framebuffer");"shape"in a?(l=a.shape,f(Array.isArray(l)&&2<=l.length,"invalid shape for framebuffer"),f(l[0]===l[1],"cube framebuffer must be square"),l=l[0]):("radius"in a&&(l=a.radius|0),"width"in a?(l=a.width|0,"height"in a&&f(a.height===l,"must be square")):"height"in a&&(l=a.height|0));if("color"in a||"colors"in a)k=a.color||a.colors,Array.isArray(k)&&f(1===
k.length||b.webgl_draw_buffers,"multiple render targets not supported");k||("colorCount"in a&&(r=a.colorCount|0,f(0<r,"invalid color buffer count")),"colorType"in a&&(f.oneOf(a.colorType,F,"invalid color type"),L=a.colorType),"colorFormat"in a&&(c=a.colorFormat,f.oneOf(a.colorFormat,z,"invalid color format for texture")));"depth"in a&&(g.depth=a.depth);"stencil"in a&&(g.stencil=a.stencil);"depthStencil"in a&&(g.depthStencil=a.depthStencil)}else l=1;if(k)if(Array.isArray(k))for(a=[],c=0;c<k.length;++c)a[c]=
k[c];else a=[k];else for(a=Array(r),k={radius:l,format:c,type:L},c=0;c<r;++c)a[c]=d.createCube(k);g.color=Array(a.length);for(c=0;c<a.length;++c)r=a[c],f("function"===typeof r&&"textureCube"===r._reglType,"invalid cube map"),l=l||r.width,f(r.width===l&&r.height===l,"invalid cube map shape"),g.color[c]={target:34069,data:a[c]};for(c=0;6>c;++c){for(r=0;r<a.length;++r)g.color[r].target=34069+c;0<c&&(g.depth=e[0].depth,g.stencil=e[0].stencil,g.depthStencil=e[0].depthStencil);if(e[c])e[c](g);else e[c]=
O(g)}return Y(h,{width:l,height:l,color:a})}var e=Array(6);h(a);return Y(h,{faces:e,resize:function(a){var b=a|0;f(0<b&&b<=c.maxCubeMapSize,"invalid radius for cube fbo");if(b===h.width)return h;var d=h.color;for(a=0;a<d.length;++a)d[a].resize(b);for(a=0;6>a;++a)e[a].resize(b);h.width=h.height=b;return h},_reglType:"framebufferCube",destroy:function(){e.forEach(function(a){a.destroy()})}})},clear:function(){ka(y).forEach(u)},restore:function(){t.cur=null;t.next=null;t.dirty=!0;ka(y).forEach(function(b){b.framebuffer=
a.createFramebuffer();r(b)})}})}function qb(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function bc(a,b,c,d,e){function g(a){if(a!==W.currentVAO){var h=b.oes_vertex_array_object;a?h.bindVertexArrayOES(a.vao):h.bindVertexArrayOES(null);W.currentVAO=a}}function l(f){if(f!==W.currentVAO){if(f)f.bindAttrs();else for(var c=b.angle_instanced_arrays,e=0;e<x.length;++e){var d=x[e];d.buffer?(a.enableVertexAttribArray(e),
a.vertexAttribPointer(e,d.size,d.type,d.normalized,d.stride,d.offfset),c&&c.vertexAttribDivisorANGLE(e,d.divisor)):(a.disableVertexAttribArray(e),a.vertexAttrib4f(e,d.x,d.y,d.z,d.w))}W.currentVAO=f}}function k(){ka(v).forEach(function(a){a.destroy()})}function q(){this.id=++w;this.attributes=[];var a=b.oes_vertex_array_object;this.vao=a?a.createVertexArrayOES():null;v[this.id]=this;this.buffers=[]}function n(){b.oes_vertex_array_object&&ka(v).forEach(function(a){a.refresh()})}var p=c.maxAttributes,
x=Array(p);for(c=0;c<p;++c)x[c]=new qb;var w=0,v={},W={Record:qb,scope:{},state:x,currentVAO:null,targetVAO:null,restore:b.oes_vertex_array_object?n:function(){},createVAO:function(a){function h(a){f(Array.isArray(a),"arguments to vertex array constructor must be an array");f(a.length<p,"too many attributes");f(0<a.length,"must specify at least one attribute");for(var d=0;d<c.buffers.length;++d)c.buffers[d].destroy();c.buffers.length=0;d=c.attributes;d.length=a.length;for(var g=0;g<a.length;++g){var l=
a[g],k=d[g]=new qb;Array.isArray(l)||aa(l)||pa(l)?(l=e.create(l,34962,!1,!0),k.buffer=e.getBuffer(l),k.size=k.buffer.dimension|0,k.normalized=!1,k.type=k.buffer.dtype,k.offset=0,k.stride=0,k.divisor=0,k.state=1,c.buffers.push(l)):e.getBuffer(l)?(k.buffer=e.getBuffer(l),k.size=k.buffer.dimension|0,k.normalized=!1,k.type=k.buffer.dtype,k.offset=0,k.stride=0,k.divisor=0,k.state=1):e.getBuffer(l.buffer)?(k.buffer=e.getBuffer(l.buffer),k.size=(+l.size||k.buffer.dimension)|0,k.normalized=!!l.normalized||
!1,"type"in l?(f.parameter(l.type,Fa,"invalid buffer type"),k.type=Fa[l.type]):k.type=k.buffer.dtype,k.offset=(l.offset||0)|0,k.stride=(l.stride||0)|0,k.divisor=(l.divisor||0)|0,k.state=1,f(1<=k.size&&4>=k.size,"size must be between 1 and 4"),f(0<=k.offset,"invalid offset"),f(0<=k.stride&&255>=k.stride,"stride must be between 0 and 255"),f(0<=k.divisor,"divisor must be positive"),f(!k.divisor||!!b.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in l?(f(0<g,"first attribute must not be a constant"),
k.x=+l.x||0,k.y=+l.y||0,k.z=+l.z||0,k.w=+l.w||0,k.state=2):f(!1,"invalid attribute spec for location "+g)}c.refresh();return h}var c=new q;d.vaoCount+=1;h.destroy=function(){c.destroy()};h._vao=c;h._reglType="vao";return h(a)},getVAO:function(a){return"function"===typeof a&&a._vao?a._vao:null},destroyBuffer:function(b){for(var c=0;c<x.length;++c){var f=x[c];f.buffer===b&&(a.disableVertexAttribArray(c),f.buffer=null)}},setVAO:b.oes_vertex_array_object?g:l,clear:b.oes_vertex_array_object?k:function(){}};
q.prototype.bindAttrs=function(){for(var c=b.angle_instanced_arrays,f=this.attributes,d=0;d<f.length;++d){var e=f[d];e.buffer?(a.enableVertexAttribArray(d),a.bindBuffer(34962,e.buffer.buffer),a.vertexAttribPointer(d,e.size,e.type,e.normalized,e.stride,e.offset),c&&c.vertexAttribDivisorANGLE(d,e.divisor)):(a.disableVertexAttribArray(d),a.vertexAttrib4f(d,e.x,e.y,e.z,e.w))}for(c=f.length;c<p;++c)a.disableVertexAttribArray(c)};q.prototype.refresh=function(){var a=b.oes_vertex_array_object;a&&(a.bindVertexArrayOES(this.vao),
this.bindAttrs(),W.currentVAO=this)};q.prototype.destroy=function(){if(this.vao){var a=b.oes_vertex_array_object;this===W.currentVAO&&(W.currentVAO=null,a.bindVertexArrayOES(null));a.deleteVertexArrayOES(this.vao);this.vao=null}v[this.id]&&(delete v[this.id],--d.vaoCount)};return W}function cc(a,b,c,d){function e(a,b,c,h){this.name=a;this.id=b;this.location=c;this.info=h}function g(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function l(c,d,e){var g=
35632===c?n:p,k=g[d];if(!k){var x=b.str(d),k=a.createShader(c);a.shaderSource(k,x);a.compileShader(k);f.shaderError(a,k,x,c,e);g[d]=k}return k}function k(a,b){this.id=v++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];d.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function q(c,k,n){var p;p=l(35632,c.fragId);var x=l(35633,c.vertId),v=c.program=a.createProgram();a.attachShader(v,p);a.attachShader(v,x);if(n)for(p=0;p<n.length;++p)x=n[p],a.bindAttribLocation(v,
x[0],x[1]);a.linkProgram(v);f.linkError(a,v,b.str(c.fragId),b.str(c.vertId),k);n=a.getProgramParameter(v,35718);d.profile&&(c.stats.uniformsCount=n);x=c.uniforms;for(p=0;p<n;++p)if(k=a.getActiveUniform(v,p))if(1<k.size)for(var ha=0;ha<k.size;++ha){var w=k.name.replace("[0]","["+ha+"]");g(x,new e(w,b.id(w),a.getUniformLocation(v,w),k))}else g(x,new e(k.name,b.id(k.name),a.getUniformLocation(v,k.name),k));n=a.getProgramParameter(v,35721);d.profile&&(c.stats.attributesCount=n);c=c.attributes;for(p=0;p<
n;++p)(k=a.getActiveAttrib(v,p))&&g(c,new e(k.name,b.id(k.name),a.getAttribLocation(v,k.name),k))}var n={},p={},x={},w=[],v=0;d.profile&&(c.getMaxUniformsCount=function(){var a=0;w.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)});return a},c.getMaxAttributesCount=function(){var a=0;w.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});return{clear:function(){var b=a.deleteShader.bind(a);ka(n).forEach(b);n={};ka(p).forEach(b);p={};w.forEach(function(b){a.deleteProgram(b.program)});
w.length=0;x={};c.shaderCount=0},program:function(a,b,h,d){f.command(0<=a,"missing vertex shader",h);f.command(0<=b,"missing fragment shader",h);var e=x[b];e||(e=x[b]={});var g=e[a];if(g&&!d)return g;b=new k(b,a);c.shaderCount++;q(b,h,d);g||(e[a]=b);w.push(b);return b},restore:function(){n={};p={};for(var a=0;a<w.length;++a)q(w[a],null,w[a].attributes.map(function(a){return[a.location,a.name]}))},shader:l,frag:-1,vert:-1}}function dc(a,b,c,d,e,g,k){function l(n){var p;null===b.next?(f(e.preserveDrawingBuffer,
'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),p=5121):(f(null!==b.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),p=b.next.colorAttachments[0].texture._texture.type,g.oes_texture_float?(f(5121===p||5126===p,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),5126===p&&f(k.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):
f(5121===p,"Reading from a framebuffer is only allowed for the type 'uint8'"));var x=0,q=0,v=d.framebufferWidth,w=d.framebufferHeight,T=null;aa(n)?T=n:n&&(f.type(n,"object","invalid arguments to regl.read()"),x=n.x|0,q=n.y|0,f(0<=x&&x<d.framebufferWidth,"invalid x offset for regl.read"),f(0<=q&&q<d.framebufferHeight,"invalid y offset for regl.read"),v=(n.width||d.framebufferWidth-x)|0,w=(n.height||d.framebufferHeight-q)|0,T=n.data||null);T&&(5121===p?f(T instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):
5126===p&&f(T instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"));f(0<v&&v+x<=d.framebufferWidth,"invalid width for read pixels");f(0<w&&w+q<=d.framebufferHeight,"invalid height for read pixels");c();n=v*w*4;T||(5121===p?T=new Uint8Array(n):5126===p&&(T=T||new Float32Array(n)));f.isTypedArray(T,"data buffer for regl.read() must be a typedarray");f(T.byteLength>=n,"data buffer for regl.read() too small");a.pixelStorei(3333,4);a.readPixels(x,q,v,
w,6408,p,T);return T}function q(a){var c;b.setFBO({framebuffer:a.framebuffer},function(){c=l(a)});return c}return function(a){return a&&"framebuffer"in a?q(a):l(a)}}function Pa(a){return Array.prototype.slice.call(a)}function Qa(a){return Pa(a).join("")}function ec(){function a(){var b=[],f=[];return Y(function(){b.push.apply(b,Pa(arguments))},{def:function(){var a="v"+c++;f.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,Pa(arguments)),b.push(";"));return a},toString:function(){return Qa([0<
f.length?"var "+f.join(",")+";":"",Qa(b)])}})}function b(){function c(a,b){d(a,b,"=",f.def(a,b),";")}var f=a(),d=a(),e=f.toString,g=d.toString;return Y(function(){f.apply(f,Pa(arguments))},{def:f.def,entry:f,exit:d,save:c,set:function(a,b,h){c(a,b);f(a,b,"=",h,";")},toString:function(){return e()+g()}})}var c=0,f=[],d=[],e=a(),g={};return{global:e,link:function(a){for(var b=0;b<d.length;++b)if(d[b]===a)return f[b];b="g"+c++;f.push(b);d.push(a);return b},block:a,proc:function(a,c){function f(){var a=
"a"+h.length;h.push(a);return a}var h=[];c=c||0;for(var d=0;d<c;++d)f();var d=b(),e=d.toString;return g[a]=Y(d,{arg:f,toString:function(){return Qa(["function(",h.join(),"){",e(),"}"])}})},scope:b,cond:function(){var a=Qa(arguments),c=b(),f=b(),h=c.toString,d=f.toString;return Y(c,{then:function(){c.apply(c,Pa(arguments));return this},"else":function(){f.apply(f,Pa(arguments));return this},toString:function(){var b=d();b&&(b="else{"+b+"}");return Qa(["if(",a,"){",h(),"}",b])}})},compile:function(){var a=
['"use strict";',e,"return {"];Object.keys(g).forEach(function(b){a.push('"',b,'":',g[b].toString(),",")});a.push("}");var b=Qa(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,f.concat(b)).apply(null,d)}}}function ib(a){return Array.isArray(a)||aa(a)||pa(a)}function Jb(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function qa(a,b,c,f){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=f}function Da(a){return a&&
!(a.thisDep||a.contextDep||a.propDep)}function da(a){return new qa(!1,!1,!1,a)}function oa(a,b){var c=a.type;return 0===c?(c=a.data.length,new qa(!0,1<=c,2<=c,b)):4===c?(c=a.data,new qa(c.thisDep,c.contextDep,c.propDep,b)):new qa(3===c,2===c,1===c,b)}function fc(a,b,c,d,e,g,k,l,q,n,p,w,t,v,u){function y(a){return a.replace(".","_")}function z(a,b,c){var f=y(a);Va.push(a);Ua[f]=Aa[f]=!!c;Ba[f]=b}function r(a,b,c){var f=y(a);Va.push(a);Array.isArray(c)?(Aa[f]=c.slice(),Ua[f]=c.slice()):Aa[f]=Ua[f]=
c;Ca[f]=b}function A(){var a=ec(),c=a.link,d=a.global;a.id=va++;a.batchId="0";var e=c(Ja),h=a.shared={props:"a0"};Object.keys(Ja).forEach(function(a){h[a]=d.def(e,".",a)});f.optional(function(){a.CHECK=c(f);a.commandStr=f.guessCommand();a.command=c(a.commandStr);a.assert=function(a,b,f){a("if(!(",b,"))",this.CHECK,".commandRaise(",c(f),",",this.command,");")};ma.invalidBlendCombinations=Kb});var g=a.next={},k=a.current={};Object.keys(Ca).forEach(function(a){Array.isArray(Aa[a])&&(g[a]=d.def(h.next,
".",a),k[a]=d.def(h.current,".",a))});var l=a.constants={};Object.keys(ma).forEach(function(a){l[a]=d.def(JSON.stringify(ma[a]))});a.invoke=function(b,f){switch(f.type){case 0:var d=["this",h.context,h.props,a.batchId];return b.def(c(f.data),".call(",d.slice(0,Math.max(f.data.length+1,4)),")");case 1:return b.def(h.props,f.data);case 2:return b.def(h.context,f.data);case 3:return b.def("this",f.data);case 4:return f.data.append(a,b),f.data.ref}};a.attribCache={};var Ia={};a.scopeAttrib=function(a){a=
b.id(a);if(a in Ia)return Ia[a];var f=n.scope[a];f||(f=n.scope[a]=new fa);return Ia[a]=c(f)};return a}function F(a){var b=a["static"];a=a.dynamic;var c;if("profile"in b){var f=!!b.profile;c=da(function(a,b){return f});c.enable=f}else if("profile"in a){var d=a.profile;c=oa(d,function(a,b){return a.invoke(b,d)})}return c}function M(a,b){var c=a["static"],d=a.dynamic;if("framebuffer"in c){var e=c.framebuffer;return e?(e=l.getFramebuffer(e),f.command(e,"invalid framebuffer object"),da(function(a,b){var c=
a.link(e),f=a.shared;b.set(f.framebuffer,".next",c);f=f.context;b.set(f,".framebufferWidth",c+".width");b.set(f,".framebufferHeight",c+".height");return c})):da(function(a,b){var c=a.shared;b.set(c.framebuffer,".next","null");c=c.context;b.set(c,".framebufferWidth",c+".drawingBufferWidth");b.set(c,".framebufferHeight",c+".drawingBufferHeight");return"null"})}if("framebuffer"in d){var h=d.framebuffer;return oa(h,function(a,b){var c=a.invoke(b,h),d=a.shared,e=d.framebuffer,g=b.def(e,".getFramebuffer(",
c,")");f.optional(function(){a.assert(b,"!"+c+"||"+g,"invalid framebuffer object")});b.set(e,".next",g);d=d.context;b.set(d,".framebufferWidth",g+"?"+g+".width:"+d+".drawingBufferWidth");b.set(d,".framebufferHeight",g+"?"+g+".height:"+d+".drawingBufferHeight");return g})}return null}function B(a,b,c){function d(a){if(a in e){var g=e[a];f.commandType(g,"object","invalid "+a,c.commandStr);var k=!0,l=g.x|0,Q=g.y|0,m,na;"width"in g?(m=g.width|0,f.command(0<=m,"invalid "+a,c.commandStr)):k=!1;"height"in
g?(na=g.height|0,f.command(0<=na,"invalid "+a,c.commandStr)):k=!1;return new qa(!k&&b&&b.thisDep,!k&&b&&b.contextDep,!k&&b&&b.propDep,function(a,b){var c=a.shared.context,f=m;"width"in g||(f=b.def(c,".","framebufferWidth","-",l));var d=na;"height"in g||(d=b.def(c,".","framebufferHeight","-",Q));return[l,Q,f,d]})}if(a in h){var wa=h[a],k=oa(wa,function(b,c){var d=b.invoke(c,wa);f.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+a)});var e=b.shared.context,h=c.def(d,".x|0"),g=
c.def(d,".y|0"),k=c.def('"width" in ',d,"?",d,".width|0:","(",e,".","framebufferWidth","-",h,")"),l=c.def('"height" in ',d,"?",d,".height|0:","(",e,".","framebufferHeight","-",g,")");f.optional(function(){b.assert(c,k+">=0&&"+l+">=0","invalid "+a)});return[h,g,k,l]});b&&(k.thisDep=k.thisDep||b.thisDep,k.contextDep=k.contextDep||b.contextDep,k.propDep=k.propDep||b.propDep);return k}return b?new qa(b.thisDep,b.contextDep,b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),
b.def(c,".","framebufferHeight")]}):null}var e=a["static"],h=a.dynamic;if(a=d("viewport")){var g=a;a=new qa(a.thisDep,a.contextDep,a.propDep,function(a,b){var c=g.append(a,b),f=a.shared.context;b.set(f,".viewportWidth",c[2]);b.set(f,".viewportHeight",c[3]);return c})}return{viewport:a,scissor_box:d("scissor.box")}}function C(a,b){var c=a["static"];if("string"===typeof c.frag&&"string"===typeof c.vert){if(0<Object.keys(b.dynamic).length)return null;var c=b["static"],d=Object.keys(c);if(0<d.length&&
"number"===typeof c[d[0]]){for(var e=[],h=0;h<d.length;++h)f("number"===typeof c[d[h]],"must specify all vertex attribute locations when using vaos"),e.push([c[d[h]]|0,d[h]]);return e}}return null}function E(a,c,d){function e(a){if(a in h){var c=b.id(h[a]);f.optional(function(){p.shader(Lb[a],c,f.guessCommand())});var d=da(function(){return c});d.id=c;return d}if(a in g){var k=g[a];return oa(k,function(b,c){var d=b.invoke(c,k),e=c.def(b.shared.strings,".id(",d,")");f.optional(function(){c(b.shared.shader,
".shader(",Lb[a],",",e,",",b.command,");")});return e})}return null}var h=a["static"],g=a.dynamic,k=e("frag"),l=e("vert"),Ia=null;Da(k)&&Da(l)?(Ia=p.program(l.id,k.id,null,d),a=da(function(a,b){return a.link(Ia)})):a=new qa(k&&k.thisDep||l&&l.thisDep,k&&k.contextDep||l&&l.contextDep,k&&k.propDep||l&&l.propDep,function(a,b){var c=a.shared.shader,d;d=k?k.append(a,b):b.def(c,".","frag");var e;e=l?l.append(a,b):b.def(c,".","vert");var h=c+".program("+e+","+d;f.optional(function(){h+=","+a.command});return b.def(h+
")")});return{frag:k,vert:l,progVar:a,program:Ia}}function G(a,b){function c(a,g){if(a in d){var k=d[a]|0;f.command(!g||0<=k,"invalid "+a,b.commandStr);return da(function(a,b){g&&(a.OFFSET=k);return k})}if(a in e){var l=e[a];return oa(l,function(b,c){var d=b.invoke(c,l);g&&(b.OFFSET=d,f.optional(function(){b.assert(c,d+">=0","invalid "+a)}));return d})}return g&&h?da(function(a,b){a.OFFSET="0";return 0}):null}var d=a["static"],e=a.dynamic,h=function(){if("elements"in d){var a=d.elements;ib(a)?a=g.getElements(g.create(a,
!0)):a&&(a=g.getElements(a),f.command(a,"invalid elements",b.commandStr));var c=da(function(b,c){if(a){var d=b.link(a);return b.ELEMENTS=d}return b.ELEMENTS=null});c.value=a;return c}if("elements"in e){var h=e.elements;return oa(h,function(a,b){var c=a.shared,d=c.isBufferArgs,c=c.elements,e=a.invoke(b,h),g=b.def("null"),d=b.def(d,"(",e,")"),k=a.cond(d).then(g,"=",c,".createStream(",e,");")["else"](g,"=",c,".getElements(",e,");");f.optional(function(){a.assert(k["else"],"!"+e+"||"+g,"invalid elements")});
b.entry(k);b.exit(a.cond(d).then(c,".destroyStream(",g,");"));return a.ELEMENTS=g})}return null}(),k=c("offset",!0);return{elements:h,primitive:function(){if("primitive"in d){var a=d.primitive;f.commandParameter(a,La,"invalid primitve",b.commandStr);return da(function(b,c){return La[a]})}if("primitive"in e){var c=e.primitive;return oa(c,function(a,b){var d=a.constants.primTypes,e=a.invoke(b,c);f.optional(function(){a.assert(b,e+" in "+d,"invalid primitive, must be one of "+Object.keys(La))});return b.def(d,
"[",e,"]")})}return h?Da(h)?h.value?da(function(a,b){return b.def(a.ELEMENTS,".primType")}):da(function(){return 4}):new qa(h.thisDep,h.contextDep,h.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in d){var a=d.count|0;f.command("number"===typeof a&&0<=a,"invalid vertex count",b.commandStr);return da(function(){return a})}if("count"in e){var c=e.count;return oa(c,function(a,b){var d=a.invoke(b,c);f.optional(function(){a.assert(b,"typeof "+
d+'==="number"&&'+d+">=0&&"+d+"===("+d+"|0)","invalid vertex count")});return d})}if(h){if(Da(h)){if(h)return k?new qa(k.thisDep,k.contextDep,k.propDep,function(a,b){var c=b.def(a.ELEMENTS,".vertCount-",a.OFFSET);f.optional(function(){a.assert(b,c+">=0","invalid vertex offset/element buffer too small")});return c}):da(function(a,b){return b.def(a.ELEMENTS,".vertCount")});var g=da(function(){return-1});f.optional(function(){g.MISSING=!0});return g}var l=new qa(h.thisDep||k.thisDep,h.contextDep||k.contextDep,
h.propDep||k.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")});f.optional(function(){l.DYNAMIC=!0});return l}return null}(),instances:c("instances",!1),offset:k}}function D(a,b){var c=a["static"],e=a.dynamic,h={};Va.forEach(function(a){function g(b,d){if(a in c){var f=b(c[a]);h[k]=da(function(){return f})}else if(a in e){var l=e[a];h[k]=oa(l,function(a,b){return d(a,b,a.invoke(b,l))})}}var k=y(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return g(function(c){f.commandType(c,
"boolean",a,b.commandStr);return c},function(b,c,d){f.optional(function(){b.assert(c,"typeof "+d+'==="boolean"',"invalid flag "+a,b.commandStr)});return d});case "depth.func":return g(function(c){f.commandParameter(c,Ra,"invalid "+a,b.commandStr);return Ra[c]},function(b,c,d){var e=b.constants.compareFuncs;f.optional(function(){b.assert(c,d+" in "+e,"invalid "+a+", must be one of "+Object.keys(Ra))});return c.def(e,"[",d,"]")});case "depth.range":return g(function(a){f.command(N(a)&&2===a.length&&
"number"===typeof a[0]&&"number"===typeof a[1]&&a[0]<=a[1],"depth range is 2d array",b.commandStr);return a},function(a,b,c){f.optional(function(){a.assert(b,a.shared.isArrayLike+"("+c+")&&"+c+".length===2&&typeof "+c+'[0]==="number"&&typeof '+c+'[1]==="number"&&'+c+"[0]<="+c+"[1]","depth range must be a 2d array")});var d=b.def("+",c,"[0]"),e=b.def("+",c,"[1]");return[d,e]});case "blend.func":return g(function(a){f.commandType(a,"object","blend.func",b.commandStr);var c="srcRGB"in a?a.srcRGB:a.src,
d="srcAlpha"in a?a.srcAlpha:a.src,e="dstRGB"in a?a.dstRGB:a.dst;a="dstAlpha"in a?a.dstAlpha:a.dst;f.commandParameter(c,xa,k+".srcRGB",b.commandStr);f.commandParameter(d,xa,k+".srcAlpha",b.commandStr);f.commandParameter(e,xa,k+".dstRGB",b.commandStr);f.commandParameter(a,xa,k+".dstAlpha",b.commandStr);f.command(-1===Kb.indexOf(c+", "+e),"unallowed blending combination (srcRGB, dstRGB) = ("+c+", "+e+")",b.commandStr);return[xa[c],xa[e],xa[d],xa[a]]},function(b,c,d){function e(g,k){var l=c.def('"',g,
k,'" in ',d,"?",d,".",g,k,":",d,".",g);f.optional(function(){b.assert(c,l+" in "+h,"invalid "+a+"."+g+k+", must be one of "+Object.keys(xa))});return l}var h=b.constants.blendFuncs;f.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid blend func, must be an object")});var g=e("src","RGB"),k=e("dst","RGB");f.optional(function(){b.assert(c,b.constants.invalidBlendCombinations+".indexOf("+g+'+", "+'+k+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var l=c.def(h,
"[",g,"]"),Q=c.def(h,"[",e("src","Alpha"),"]"),m=c.def(h,"[",k,"]"),ea=c.def(h,"[",e("dst","Alpha"),"]");return[l,m,Q,ea]});case "blend.equation":return g(function(c){if("string"===typeof c)return f.commandParameter(c,ta,"invalid "+a,b.commandStr),[ta[c],ta[c]];if("object"===typeof c)return f.commandParameter(c.rgb,ta,a+".rgb",b.commandStr),f.commandParameter(c.alpha,ta,a+".alpha",b.commandStr),[ta[c.rgb],ta[c.alpha]];f.commandRaise("invalid blend.equation",b.commandStr)},function(b,c,d){var e=b.constants.blendEquations,
h=c.def(),g=c.def(),k=b.cond("typeof ",d,'==="string"');f.optional(function(){function c(a,d,f){b.assert(a,f+" in "+e,"invalid "+d+", must be one of "+Object.keys(ta))}c(k.then,a,d);b.assert(k["else"],d+"&&typeof "+d+'==="object"',"invalid "+a);c(k["else"],a+".rgb",d+".rgb");c(k["else"],a+".alpha",d+".alpha")});k.then(h,"=",g,"=",e,"[",d,"];");k["else"](h,"=",e,"[",d,".rgb];",g,"=",e,"[",d,".alpha];");c(k);return[h,g]});case "blend.color":return g(function(a){f.command(N(a)&&4===a.length,"blend.color must be a 4d array",
b.commandStr);return U(4,function(b){return+a[b]})},function(a,b,c){f.optional(function(){a.assert(b,a.shared.isArrayLike+"("+c+")&&"+c+".length===4","blend.color must be a 4d array")});return U(4,function(a){return b.def("+",c,"[",a,"]")})});case "stencil.mask":return g(function(a){f.commandType(a,"number",k,b.commandStr);return a|0},function(a,b,c){f.optional(function(){a.assert(b,"typeof "+c+'==="number"',"invalid stencil.mask")});return b.def(c,"|0")});case "stencil.func":return g(function(c){f.commandType(c,
"object",k,b.commandStr);var d=c.cmp||"keep",e=c.ref||0;c="mask"in c?c.mask:-1;f.commandParameter(d,Ra,a+".cmp",b.commandStr);f.commandType(e,"number",a+".ref",b.commandStr);f.commandType(c,"number",a+".mask",b.commandStr);return[Ra[d],e,c]},function(a,b,c){var d=a.constants.compareFuncs;f.optional(function(){function e(){a.assert(b,Array.prototype.join.call(arguments,""),"invalid stencil.func")}e(c+"&&typeof ",c,'==="object"');e('!("cmp" in ',c,")||(",c,".cmp in ",d,")")});var e=b.def('"cmp" in ',
c,"?",d,"[",c,".cmp]",":",7680),h=b.def(c,".ref|0"),g=b.def('"mask" in ',c,"?",c,".mask|0:-1");return[e,h,g]});case "stencil.opFront":case "stencil.opBack":return g(function(c){f.commandType(c,"object",k,b.commandStr);var d=c.fail||"keep",e=c.zfail||"keep";c=c.zpass||"keep";f.commandParameter(d,Ea,a+".fail",b.commandStr);f.commandParameter(e,Ea,a+".zfail",b.commandStr);f.commandParameter(c,Ea,a+".zpass",b.commandStr);return["stencil.opBack"===a?1029:1028,Ea[d],Ea[e],Ea[c]]},function(b,c,d){function e(g){f.optional(function(){b.assert(c,
'!("'+g+'" in '+d+")||("+d+"."+g+" in "+h+")","invalid "+a+"."+g+", must be one of "+Object.keys(Ea))});return c.def('"',g,'" in ',d,"?",h,"[",d,".",g,"]:",7680)}var h=b.constants.stencilOps;f.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+a)});return["stencil.opBack"===a?1029:1028,e("fail"),e("zfail"),e("zpass")]});case "polygonOffset.offset":return g(function(a){f.commandType(a,"object",k,b.commandStr);var c=a.factor|0;a=a.units|0;f.commandType(c,"number",k+".factor",b.commandStr);
f.commandType(a,"number",k+".units",b.commandStr);return[c,a]},function(b,c,d){f.optional(function(){b.assert(c,d+"&&typeof "+d+'==="object"',"invalid "+a)});var e=c.def(d,".factor|0"),h=c.def(d,".units|0");return[e,h]});case "cull.face":return g(function(a){var c=0;"front"===a?c=1028:"back"===a&&(c=1029);f.command(!!c,k,b.commandStr);return c},function(a,b,c){f.optional(function(){a.assert(b,c+'==="front"||'+c+'==="back"',"invalid cull.face")});return b.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return g(function(a){f.command("number"===
typeof a&&a>=d.lineWidthDims[0]&&a<=d.lineWidthDims[1],"invalid line width, must be a positive number between "+d.lineWidthDims[0]+" and "+d.lineWidthDims[1],b.commandStr);return a},function(a,b,c){f.optional(function(){a.assert(b,"typeof "+c+'==="number"&&'+c+">="+d.lineWidthDims[0]+"&&"+c+"<="+d.lineWidthDims[1],"invalid line width")});return c});case "frontFace":return g(function(a){f.commandParameter(a,rb,k,b.commandStr);return rb[a]},function(a,b,c){f.optional(function(){a.assert(b,c+'==="cw"||'+
c+'==="ccw"',"invalid frontFace, must be one of cw,ccw")});return b.def(c+'==="cw"?2304:2305')});case "colorMask":return g(function(a){f.command(N(a)&&4===a.length,"color.mask must be length 4 array",b.commandStr);return a.map(function(a){return!!a})},function(a,b,c){f.optional(function(){a.assert(b,a.shared.isArrayLike+"("+c+")&&"+c+".length===4","invalid color.mask")});return U(4,function(a){return"!!"+c+"["+a+"]"})});case "sample.coverage":return g(function(a){f.command("object"===typeof a&&a,
k,b.commandStr);var c="value"in a?a.value:1;a=!!a.invert;f.command("number"===typeof c&&0<=c&&1>=c,"sample.coverage.value must be a number between 0 and 1",b.commandStr);return[c,a]},function(a,b,c){f.optional(function(){a.assert(b,c+"&&typeof "+c+'==="object"',"invalid sample.coverage")});var d=b.def('"value" in ',c,"?+",c,".value:1"),e=b.def("!!",c,".invert");return[d,e]})}});return h}function Z(a,b){var c=a["static"],d=a.dynamic,e={};Object.keys(c).forEach(function(a){var d=c[a],h;if("number"===
typeof d||"boolean"===typeof d)h=da(function(){return d});else if("function"===typeof d){var g=d._reglType;"texture2d"===g||"textureCube"===g?h=da(function(a){return a.link(d)}):"framebuffer"===g||"framebufferCube"===g?(f.command(0<d.color.length,'missing color attachment for framebuffer sent to uniform "'+a+'"',b.commandStr),h=da(function(a){return a.link(d.color[0])})):f.commandRaise('invalid data for uniform "'+a+'"',b.commandStr)}else N(d)?h=da(function(b){return b.global.def("[",U(d.length,function(c){f.command("number"===
typeof d[c]||"boolean"===typeof d[c],"invalid uniform "+a,b.commandStr);return d[c]}),"]")}):f.commandRaise('invalid or missing data for uniform "'+a+'"',b.commandStr);h.value=d;e[a]=h});Object.keys(d).forEach(function(a){var b=d[a];e[a]=oa(b,function(a,c){return a.invoke(c,b)})});return e}function H(a,c){var d=a["static"],h=a.dynamic,g={};Object.keys(d).forEach(function(a){var h=d[a],k=b.id(a),l=new fa;if(ib(h))l.state=1,l.buffer=e.getBuffer(e.create(h,34962,!1,!0)),l.type=0;else{var Q=e.getBuffer(h);
if(Q)l.state=1,l.buffer=Q,l.type=0;else if(f.command("object"===typeof h&&h,"invalid data for attribute "+a,c.commandStr),"constant"in h){var Ha=h.constant;l.buffer="null";l.state=2;"number"===typeof Ha?l.x=Ha:(f.command(N(Ha)&&0<Ha.length&&4>=Ha.length,"invalid constant for attribute "+a,c.commandStr),Sa.forEach(function(a,b){b<Ha.length&&(l[a]=Ha[b])}))}else{Q=ib(h.buffer)?e.getBuffer(e.create(h.buffer,34962,!1,!0)):e.getBuffer(h.buffer);f.command(!!Q,'missing buffer for attribute "'+a+'"',c.commandStr);
var p=h.offset|0;f.command(0<=p,'invalid offset for attribute "'+a+'"',c.commandStr);var q=h.stride|0;f.command(0<=q&&256>q,'invalid stride for attribute "'+a+'", must be integer betweeen [0, 255]',c.commandStr);var n=h.size|0;f.command(!("size"in h)||0<n&&4>=n,'invalid size for attribute "'+a+'", must be 1,2,3,4',c.commandStr);var w=!!h.normalized,x=0;"type"in h&&(f.commandParameter(h.type,Fa,"invalid type for attribute "+a,c.commandStr),x=Fa[h.type]);var v=h.divisor|0;"divisor"in h&&(f.command(0===
v||za,'cannot specify divisor for attribute "'+a+'", instancing not supported',c.commandStr),f.command(0<=v,'invalid divisor for attribute "'+a+'"',c.commandStr));f.optional(function(){var b=c.commandStr,d="buffer offset divisor normalized type size stride".split(" ");Object.keys(h).forEach(function(c){f.command(0<=d.indexOf(c),'unknown parameter "'+c+'" for attribute pointer "'+a+'" (valid parameters are '+d+")",b)})});l.buffer=Q;l.state=1;l.size=n;l.normalized=w;l.type=x||Q.dtype;l.offset=p;l.stride=
q;l.divisor=v}}g[a]=da(function(a,b){var c=a.attribCache;if(k in c)return c[k];var d={isStream:!1};Object.keys(l).forEach(function(a){d[a]=l[a]});l.buffer&&(d.buffer=a.link(l.buffer),d.type=d.type||d.buffer+".dtype");return c[k]=d})});Object.keys(h).forEach(function(a){var b=h[a];g[a]=oa(b,function(c,d){function e(a){d(m[a],"=",h,".",a,"|0;")}var h=c.invoke(d,b),g=c.shared,k=c.constants,l=g.isBufferArgs,Q=g.buffer;f.optional(function(){c.assert(d,h+"&&(typeof "+h+'==="object"||typeof '+h+'==="function")&&('+
l+"("+h+")||"+Q+".getBuffer("+h+")||"+Q+".getBuffer("+h+".buffer)||"+l+"("+h+'.buffer)||("constant" in '+h+"&&(typeof "+h+'.constant==="number"||'+g.isArrayLike+"("+h+".constant))))",'invalid dynamic attribute "'+a+'"')});var m={isStream:d.def(!1)},ea=new fa;ea.state=1;Object.keys(ea).forEach(function(a){m[a]=d.def(""+ea[a])});var ia=m.buffer,p=m.type;d("if(",l,"(",h,")){",m.isStream,"=true;",ia,"=",Q,".createStream(",34962,",",h,");",p,"=",ia,".dtype;","}else{",ia,"=",Q,".getBuffer(",h,");","if(",
ia,"){",p,"=",ia,".dtype;",'}else if("constant" in ',h,"){",m.state,"=",2,";","if(typeof "+h+'.constant === "number"){',m[Sa[0]],"=",h,".constant;",Sa.slice(1).map(function(a){return m[a]}).join("="),"=0;","}else{",Sa.map(function(a,b){return m[a]+"="+h+".constant.length>"+b+"?"+h+".constant["+b+"]:0;"}).join(""),"}}else{","if(",l,"(",h,".buffer)){",ia,"=",Q,".createStream(",34962,",",h,".buffer);","}else{",ia,"=",Q,".getBuffer(",h,".buffer);","}",p,'="type" in ',h,"?",k.glTypes,"[",h,".type]:",ia,
".dtype;",m.normalized,"=!!",h,".normalized;");e("size");e("offset");e("stride");e("divisor");d("}}");d.exit("if(",m.isStream,"){",Q,".destroyStream(",ia,");","}");return m})});return g}function I(a,b){var c=a["static"],d=a.dynamic;if("vao"in c){var h=c.vao;null!==h&&null===n.getVAO(h)&&(h=n.createVAO(h));return da(function(a){return a.link(n.getVAO(h))})}if("vao"in d){var e=d.vao;return oa(e,function(a,b){var c=a.invoke(b,e);return b.def(a.shared.vao+".getVAO("+c+")")})}return null}function K(a){var b=
a["static"],c=a.dynamic,d={};Object.keys(b).forEach(function(a){var c=b[a];d[a]=da(function(a,b){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var b=c[a];d[a]=oa(b,function(a,c){return a.invoke(c,b)})});return d}function J(a,b,d,h,e){function g(a){var b=q[a];b&&(x[a]=b)}var k=a["static"],l=a.dynamic;f.optional(function(){function a(c){Object.keys(c).forEach(function(a){f.command(0<=b.indexOf(a),'unknown parameter "'+a+'"',e.commandStr)})}var b=
"framebuffer vert frag elements primitive offset count instances profile vao".split(" ").concat(Va);a(k);a(l)});var m=C(a,b),p=M(a,e),q=B(a,p,e),w=G(a,e),x=D(a,e),v=E(a,e,m);g("viewport");g(y("scissor.box"));var r=0<Object.keys(x).length,p={framebuffer:p,draw:w,shader:v,state:x,dirty:r,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};p.profile=F(a,e);p.uniforms=Z(d,e);p.drawVAO=p.scopeVAO=I(a,e);if(!p.drawVAO&&v.program&&!m&&c.angle_instanced_arrays){var t=!0;a=v.program.attributes.map(function(a){a=
b["static"][a];t=t&&!!a;return a});if(t&&0<a.length){var u=n.getVAO(n.createVAO(a));p.drawVAO=new qa(null,null,null,function(a,b){return a.link(u)});p.useVAO=!0}}m?p.useVAO=!0:p.attributes=H(b,e);p.context=K(h,e);return p}function X(a,b,c){var d=a.shared.context,h=a.scope();Object.keys(c).forEach(function(e){b.save(d,"."+e);h(d,".",e,"=",c[e].append(a,b),";")});b(h)}function S(a,b,c,d){var h=a.shared,e=h.gl,f=h.framebuffer,g;ja&&(g=b.def(h.extensions,".webgl_draw_buffers"));var k=a.constants,h=k.drawBuffer,
k=k.backBuffer;a=c?c.append(a,b):b.def(f,".next");d||b("if(",a,"!==",f,".cur){");b("if(",a,"){",e,".bindFramebuffer(",36160,",",a,".framebuffer);");ja&&b(g,".drawBuffersWEBGL(",h,"[",a,".colorAttachments.length]);");b("}else{",e,".bindFramebuffer(",36160,",null);");ja&&b(g,".drawBuffersWEBGL(",k,");");b("}",f,".cur=",a,";");d||b("}")}function ga(a,b,c){var d=a.shared,h=d.gl,e=a.current,f=a.next,g=d.current,k=d.next,l=a.cond(g,".dirty");Va.forEach(function(b){b=y(b);if(!(b in c.state)){var d,m;if(b in
f){d=f[b];m=e[b];var ea=U(Aa[b].length,function(a){return l.def(d,"[",a,"]")});l(a.cond(ea.map(function(a,b){return a+"!=="+m+"["+b+"]"}).join("||")).then(h,".",Ca[b],"(",ea,");",ea.map(function(a,b){return m+"["+b+"]="+a}).join(";"),";"))}else d=l.def(k,".",b),ea=a.cond(d,"!==",g,".",b),l(ea),b in Ba?ea(a.cond(d).then(h,".enable(",Ba[b],");")["else"](h,".disable(",Ba[b],");"),g,".",b,"=",d,";"):ea(h,".",Ca[b],"(",d,");",g,".",b,"=",d,";")}});0===Object.keys(c.state).length&&l(g,".dirty=false;");
b(l)}function V(a,b,c,d){var h=a.shared,e=a.current,f=h.current,g=h.gl;Jb(Object.keys(c)).forEach(function(h){var k=c[h];if(!d||d(k)){var l=k.append(a,b);if(Ba[h]){var m=Ba[h];Da(k)?l?b(g,".enable(",m,");"):b(g,".disable(",m,");"):b(a.cond(l).then(g,".enable(",m,");")["else"](g,".disable(",m,");"));b(f,".",h,"=",l,";")}else if(N(l)){var p=e[h];b(g,".",Ca[h],"(",l,");",l.map(function(a,b){return p+"["+b+"]="+a}).join(";"),";")}else b(g,".",Ca[h],"(",l,");",f,".",h,"=",l,";")}})}function R(a,b){za&&
(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function Y(a,b,c,d,h){function e(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function f(a){n=b.def();a(n,"=",e(),";");"string"===typeof h?a(m,".count+=",h,";"):a(m,".count++;");v&&(d?(w=b.def(),a(w,"=",q,".getNumPendingQueries();")):a(q,".beginQuery(",m,");"))}function g(a){a(m,".cpuTime+=",e(),"-",n,";");v&&(d?a(q,".pushScopeStats(",w,",",q,".getNumPendingQueries(),",m,");"):a(q,".endQuery();"))}function k(a){var c=
b.def(p,".profile");b(p,".profile=",a,";");b.exit(p,".profile=",c,";")}var l=a.shared,m=a.stats,p=l.current,q=l.timer;c=c.profile;var n,w;if(c){if(Da(c)){c.enable?(f(b),g(b.exit),k("true")):k("false");return}c=c.append(a,b);k(c)}else c=b.def(p,".profile");l=a.block();f(l);b("if(",c,"){",l,"}");a=a.block();g(a);b.exit("if(",c,"){",a,"}")}function P(a,b,c,d,h){function e(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;
default:return 1}}function g(c,d,h){function e(){b("if(!",p,".buffer){",l,".enableVertexAttribArray(",m,");}");var c=h.type,f;f=h.size?b.def(h.size,"||",d):d;b("if(",p,".type!==",c,"||",p,".size!==",f,"||",w.map(function(a){return p+"."+a+"!=="+h[a]}).join("||"),"){",l,".bindBuffer(",34962,",",q,".buffer);",l,".vertexAttribPointer(",[m,f,c,h.normalized,h.stride,h.offset],");",p,".type=",c,";",p,".size=",f,";",w.map(function(a){return p+"."+a+"="+h[a]+";"}).join(""),"}");za&&(c=h.divisor,b("if(",p,
".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[m,c],");",p,".divisor=",c,";}"))}function f(){b("if(",p,".buffer){",l,".disableVertexAttribArray(",m,");",p,".buffer=null;","}if(",Sa.map(function(a,b){return p+"."+a+"!=="+n[b]}).join("||"),"){",l,".vertexAttrib4f(",m,",",n,");",Sa.map(function(a,b){return p+"."+a+"="+n[b]+";"}).join(""),"}")}var l=k.gl,m=b.def(c,".location"),p=b.def(k.attributes,"[",m,"]");c=h.state;var q=h.buffer,n=[h.x,h.y,h.z,h.w],w=["buffer","normalized","offset",
"stride"];1===c?e():2===c?f():(b("if(",c,"===",1,"){"),e(),b("}else{"),f(),b("}"))}var k=a.shared;d.forEach(function(d){var k=d.name,l=c.attributes[k],m;if(l){if(!h(l))return;m=l.append(a,b)}else{if(!h(Mb))return;var p=a.scopeAttrib(k);f.optional(function(){a.assert(b,p+".state","missing attribute "+k)});m={};Object.keys(new fa).forEach(function(a){m[a]=b.def(p,".",a)})}g(a.link(d),e(d.info.type),m)})}function ra(a,c,d,h,e){for(var g=a.shared,k=g.gl,l,p=0;p<h.length;++p){var q=h[p],n=q.name,w=q.info.type,
x=d.uniforms[n],q=a.link(q)+".location",v;if(x){if(!e(x))continue;if(Da(x)){var r=x.value;f.command(null!==r&&"undefined"!==typeof r,'missing uniform "'+n+'"',a.commandStr);if(35678===w||35680===w)f.command("function"===typeof r&&(35678===w&&("texture2d"===r._reglType||"framebuffer"===r._reglType)||35680===w&&("textureCube"===r._reglType||"framebufferCube"===r._reglType)),"invalid texture for uniform "+n,a.commandStr),x=a.link(r._texture||r.color[0]._texture),c(k,".uniform1i(",q,",",x+".bind());"),
c.exit(x,".unbind();");else if(35674===w||35675===w||35676===w){f.optional(function(){f.command(N(r),"invalid matrix for uniform "+n,a.commandStr);f.command(35674===w&&4===r.length||35675===w&&9===r.length||35676===w&&16===r.length,"invalid length for matrix uniform "+n,a.commandStr)});var x=a.global.def("new Float32Array(["+Array.prototype.slice.call(r)+"])"),t=2;35675===w?t=3:35676===w&&(t=4);c(k,".uniformMatrix",t,"fv(",q,",false,",x,");")}else{switch(w){case 5126:f.commandType(r,"number","uniform "+
n,a.commandStr);l="1f";break;case 35664:f.command(N(r)&&2===r.length,"uniform "+n,a.commandStr);l="2f";break;case 35665:f.command(N(r)&&3===r.length,"uniform "+n,a.commandStr);l="3f";break;case 35666:f.command(N(r)&&4===r.length,"uniform "+n,a.commandStr);l="4f";break;case 35670:f.commandType(r,"boolean","uniform "+n,a.commandStr);l="1i";break;case 5124:f.commandType(r,"number","uniform "+n,a.commandStr);l="1i";break;case 35671:f.command(N(r)&&2===r.length,"uniform "+n,a.commandStr);l="2i";break;
case 35667:f.command(N(r)&&2===r.length,"uniform "+n,a.commandStr);l="2i";break;case 35672:f.command(N(r)&&3===r.length,"uniform "+n,a.commandStr);l="3i";break;case 35668:f.command(N(r)&&3===r.length,"uniform "+n,a.commandStr);l="3i";break;case 35673:f.command(N(r)&&4===r.length,"uniform "+n,a.commandStr);l="4i";break;case 35669:f.command(N(r)&&4===r.length,"uniform "+n,a.commandStr),l="4i"}c(k,".uniform",l,"(",q,",",N(r)?Array.prototype.slice.call(r):r,");")}continue}else v=x.append(a,c)}else{if(!e(Mb))continue;
v=c.def(g.uniforms,"[",b.id(n),"]")}35678===w?c("if(",v,"&&",v,'._reglType==="framebuffer"){',v,"=",v,".color[0];","}"):35680===w&&c("if(",v,"&&",v,'._reglType==="framebufferCube"){',v,"=",v,".color[0];","}");f.optional(function(){function b(d,h){a.assert(c,d,'bad data or missing for uniform "'+n+'".  '+h)}function d(a){b("typeof "+v+'==="'+a+'"',"invalid type, expected "+a)}function h(c,d){b(g.isArrayLike+"("+v+")&&"+v+".length==="+c,"invalid vector, should have length "+c,a.commandStr)}function e(c){b("typeof "+
v+'==="function"&&'+v+'._reglType==="texture'+(3553===c?"2d":"Cube")+'"',"invalid texture type",a.commandStr)}switch(w){case 5124:d("number");break;case 35667:h(2,"number");break;case 35668:h(3,"number");break;case 35669:h(4,"number");break;case 5126:d("number");break;case 35664:h(2,"number");break;case 35665:h(3,"number");break;case 35666:h(4,"number");break;case 35670:d("boolean");break;case 35671:h(2,"boolean");break;case 35672:h(3,"boolean");break;case 35673:h(4,"boolean");break;case 35674:h(4,
"number");break;case 35675:h(9,"number");break;case 35676:h(16,"number");break;case 35678:e(3553);break;case 35680:e(34067)}});x=1;switch(w){case 35678:case 35680:x=c.def(v,"._texture");c(k,".uniform1i(",q,",",x,".bind());");c.exit(x,".unbind();");continue;case 5124:case 35670:l="1i";break;case 35667:case 35671:l="2i";x=2;break;case 35668:case 35672:l="3i";x=3;break;case 35669:case 35673:l="4i";x=4;break;case 5126:l="1f";break;case 35664:l="2f";x=2;break;case 35665:l="3f";x=3;break;case 35666:l="4f";
x=4;break;case 35674:l="Matrix2fv";break;case 35675:l="Matrix3fv";break;case 35676:l="Matrix4fv"}c(k,".uniform",l,"(",q,",");if("M"===l.charAt(0)){var q=Math.pow(w-35674+2,2),u=a.global.def("new Float32Array(",q,")");c("false,(Array.isArray(",v,")||",v," instanceof Float32Array)?",v,":(",U(q,function(a){return u+"["+a+"]="+v+"["+a+"]"}),",",u,")")}else 1<x?c(U(x,function(a){return v+"["+a+"]"})):c(v);c(");")}}function ba(a,b,c,d){function h(e){var f=p[e];return f?f.contextDep&&d.contextDynamic||f.propDep?
f.append(a,c):f.append(a,b):b.def(m,".",e)}function e(){function a(){c(v,".drawElementsInstancedANGLE(",[q,r,t,w+"<<(("+t+"-5121)>>1)",x],");")}function b(){c(v,".drawArraysInstancedANGLE(",[q,w,r,x],");")}n?u?a():(c("if(",n,"){"),a(),c("}else{"),b(),c("}")):b()}function g(){function a(){c(k+".drawElements("+[q,r,t,w+"<<(("+t+"-5121)>>1)"]+");")}function b(){c(k+".drawArrays("+[q,w,r]+");")}n?u?a():(c("if(",n,"){"),a(),c("}else{"),b(),c("}")):b()}var l=a.shared,k=l.gl,m=l.draw,p=d.draw,n=function(){var h=
p.elements,e=b;if(h){if(h.contextDep&&d.contextDynamic||h.propDep)e=c;h=h.append(a,e)}else h=e.def(m,".","elements");h&&e("if("+h+")"+k+".bindBuffer(34963,"+h+".buffer.buffer);");return h}(),q=h("primitive"),w=h("offset"),r=function(){var h=p.count,e,g=b;if(h){if(h.contextDep&&d.contextDynamic||h.propDep)g=c;e=h.append(a,g);f.optional(function(){h.MISSING&&a.assert(b,"false","missing vertex count");h.DYNAMIC&&a.assert(g,e+">=0","missing vertex count")})}else e=g.def(m,".","count"),f.optional(function(){a.assert(g,
e+">=0","missing vertex count")});return e}();if("number"===typeof r){if(0===r)return}else c("if(",r,"){"),c.exit("}");var x,v;za&&(x=h("instances"),v=a.instancing);var t=n+".type",u=p.elements&&Da(p.elements);za&&("number"!==typeof x||0<=x)?"string"===typeof x?(c("if(",x,">0){"),e(),c("}else if(",x,"<0){"),g(),c("}")):e():g()}function ca(a,b,c,d,h){var e=A();h=e.proc("body",h);f.optional(function(){e.commandStr=b.commandStr;e.command=e.link(b.commandStr)});za&&(e.instancing=h.def(e.shared.extensions,
".angle_instanced_arrays"));a(e,h,c,d);return e.compile().body}function aa(a,b,c,d){R(a,b);c.useVAO?c.drawVAO?b(a.shared.vao,".setVAO(",c.drawVAO.append(a,b),");"):b(a.shared.vao,".setVAO(",a.shared.vao,".targetVAO);"):(b(a.shared.vao,".setVAO(null);"),P(a,b,c,d.attributes,function(){return!0}));ra(a,b,c,d.uniforms,function(){return!0});ba(a,b,b,c)}function Ya(a,b){var c=a.proc("draw",1);R(a,c);X(a,c,b.context);S(a,c,b.framebuffer);ga(a,c,b);V(a,c,b.state);Y(a,c,b,!1,!0);var d=b.shader.progVar.append(a,
c);c(a.shared.gl,".useProgram(",d,".program);");if(b.shader.program)aa(a,c,b,b.shader.program);else{c(a.shared.vao,".setVAO(null);");var h=a.global.def("{}"),e=c.def(d,".id"),f=c.def(h,"[",e,"]");c(a.cond(f).then(f,".call(this,a0);")["else"](f,"=",h,"[",e,"]=",a.link(function(c){return ca(aa,a,b,c,1)}),"(",d,");",f,".call(this,a0);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function Ga(a,b,c,d){function h(){return!0}a.batchId="a1";R(a,b);P(a,b,c,d.attributes,h);ra(a,b,c,
d.uniforms,h);ba(a,b,b,c)}function Wa(a,b,c,d){function h(a){return a.contextDep&&f||a.propDep}function e(a){return!h(a)}R(a,b);var f=c.contextDep,g=b.def(),l=b.def();a.shared.props=l;a.batchId=g;var k=a.scope(),m=a.scope();b(k.entry,"for(",g,"=0;",g,"<","a1",";++",g,"){",l,"=","a0","[",g,"];",m,"}",k.exit);c.needsContext&&X(a,m,c.context);c.needsFramebuffer&&S(a,m,c.framebuffer);V(a,m,c.state,h);c.profile&&h(c.profile)&&Y(a,m,c,!1,!0);d?(c.useVAO?c.drawVAO?h(c.drawVAO)?m(a.shared.vao,".setVAO(",
c.drawVAO.append(a,m),");"):k(a.shared.vao,".setVAO(",c.drawVAO.append(a,k),");"):k(a.shared.vao,".setVAO(",a.shared.vao,".targetVAO);"):(k(a.shared.vao,".setVAO(null);"),P(a,k,c,d.attributes,e),P(a,m,c,d.attributes,h)),ra(a,k,c,d.uniforms,e),ra(a,m,c,d.uniforms,h),ba(a,k,m,c)):(b=a.global.def("{}"),d=c.shader.progVar.append(a,m),l=m.def(d,".id"),k=m.def(b,"[",l,"]"),m(a.shared.gl,".useProgram(",d,".program);","if(!",k,"){",k,"=",b,"[",l,"]=",a.link(function(b){return ca(Ga,a,c,b,2)}),"(",d,");}",
k,".call(this,a0[",g,"],",g,");"))}function Wb(a,b){function c(a){return a.contextDep&&h||a.propDep}var d=a.proc("batch",2);a.batchId="0";R(a,d);var h=!1,e=!0;Object.keys(b.context).forEach(function(a){h=h||b.context[a].propDep});h||(X(a,d,b.context),e=!1);var f=b.framebuffer,g=!1;f?(f.propDep?h=g=!0:f.contextDep&&h&&(g=!0),g||S(a,d,f)):S(a,d,null);b.state.viewport&&b.state.viewport.propDep&&(h=!0);ga(a,d,b);V(a,d,b.state,function(a){return!c(a)});b.profile&&c(b.profile)||Y(a,d,b,!1,"a1");b.contextDep=
h;b.needsContext=e;b.needsFramebuffer=g;e=b.shader.progVar;if(e.contextDep&&h||e.propDep)Wa(a,d,b,null);else if(e=e.append(a,d),d(a.shared.gl,".useProgram(",e,".program);"),b.shader.program)Wa(a,d,b,b.shader.program);else{d(a.shared.vao,".setVAO(null);");var f=a.global.def("{}"),g=d.def(e,".id"),k=d.def(f,"[",g,"]");d(a.cond(k).then(k,".call(this,a0,a1);")["else"](k,"=",f,"[",g,"]=",a.link(function(c){return ca(Wa,a,b,c,2)}),"(",e,");",k,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&d(a.shared.current,
".dirty=true;")}function pa(a,c){function d(b){var f=c.shader[b];f&&h.set(e.shader,"."+b,f.append(a,h))}var h=a.proc("scope",3);a.batchId="a2";var e=a.shared,f=e.current;X(a,h,c.context);c.framebuffer&&c.framebuffer.append(a,h);Jb(Object.keys(c.state)).forEach(function(b){var d=c.state[b].append(a,h);N(d)?d.forEach(function(c,d){h.set(a.next[b],"["+d+"]",c)}):h.set(e.next,"."+b,d)});Y(a,h,c,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(b){var d=c.draw[b];d&&h.set(e.draw,
"."+b,""+d.append(a,h))});Object.keys(c.uniforms).forEach(function(d){h.set(e.uniforms,"["+b.id(d)+"]",c.uniforms[d].append(a,h))});Object.keys(c.attributes).forEach(function(b){var d=c.attributes[b].append(a,h),e=a.scopeAttrib(b);Object.keys(new fa).forEach(function(a){h.set(e,"."+a,d[a])})});c.scopeVAO&&h.set(e.vao,".targetVAO",c.scopeVAO.append(a,h));d("vert");d("frag");0<Object.keys(c.state).length&&(h(f,".dirty=true;"),h.exit(f,".dirty=true;"));h("a1(",a.shared.context,",a0,",a.batchId,");")}
function la(a){if("object"===typeof a&&!N(a)){for(var b=Object.keys(a),c=0;c<b.length;++c)if(ua.isDynamic(a[b[c]]))return!0;return!1}}function ka(a,b,c){function d(a,b){f.forEach(function(c){var d=h[c];ua.isDynamic(d)&&(d=a.invoke(b,d),b(m,".",c,"=",d,";"))})}var h=b["static"][c];if(h&&la(h)){var e=a.global,f=Object.keys(h),g=!1,k=!1,l=!1,m=a.global.def("{}");f.forEach(function(b){var c=h[b];if(ua.isDynamic(c))"function"===typeof c&&(c=h[b]=ua.unbox(c)),b=oa(c,null),g=g||b.thisDep,l=l||b.propDep,
k=k||b.contextDep;else{e(m,".",b,"=");switch(typeof c){case "number":e(c);break;case "string":e('"',c,'"');break;case "object":Array.isArray(c)&&e("[",c.join(),"]");break;default:e(a.link(c))}e(";")}});b.dynamic[c]=new ua.DynamicVariable(4,{thisDep:g,contextDep:k,propDep:l,ref:m,append:d});delete b["static"][c]}}var fa=n.Record,ta={add:32774,subtract:32778,"reverse subtract":32779};c.ext_blend_minmax&&(ta.min=32775,ta.max=32776);var za=c.angle_instanced_arrays,ja=c.webgl_draw_buffers,Aa={dirty:!0,
profile:u.profile},Ua={},Va=[],Ba={},Ca={};z("dither",3024);z("blend.enable",3042);r("blend.color","blendColor",[0,0,0,0]);r("blend.equation","blendEquationSeparate",[32774,32774]);r("blend.func","blendFuncSeparate",[1,0,1,0]);z("depth.enable",2929,!0);r("depth.func","depthFunc",513);r("depth.range","depthRange",[0,1]);r("depth.mask","depthMask",!0);r("colorMask","colorMask",[!0,!0,!0,!0]);z("cull.enable",2884);r("cull.face","cullFace",1029);r("frontFace","frontFace",2305);r("lineWidth","lineWidth",
1);z("polygonOffset.enable",32823);r("polygonOffset.offset","polygonOffset",[0,0]);z("sample.alpha",32926);z("sample.enable",32928);r("sample.coverage","sampleCoverage",[1,!1]);z("stencil.enable",2960);r("stencil.mask","stencilMask",-1);r("stencil.func","stencilFunc",[519,0,-1]);r("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);r("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);z("scissor.enable",3089);r("scissor.box","scissor",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);
r("viewport","viewport",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);var Ja={gl:a,context:t,strings:b,next:Ua,current:Aa,draw:w,elements:g,buffer:e,shader:p,attributes:n.state,vao:n,uniforms:q,framebuffer:l,extensions:c,timer:v,isBufferArgs:ib},ma={primTypes:La,compareFuncs:Ra,blendFuncs:xa,blendEquations:ta,stencilOps:Ea,glTypes:Fa,orientationType:rb};f.optional(function(){Ja.isArrayLike=N});ja&&(ma.backBuffer=[1029],ma.drawBuffer=U(d.maxDrawbuffers,function(a){return 0===a?[0]:U(a,function(a){return 36064+
a})}));var va=0;return{next:Ua,current:Aa,procs:function(){var a=A(),b=a.proc("poll"),h=a.proc("refresh"),e=a.block();b(e);h(e);var f=a.shared,g=f.gl,k=f.next,l=f.current;e(l,".dirty=false;");S(a,b);S(a,h,null,!0);var m;za&&(m=a.link(za));c.oes_vertex_array_object&&h(a.link(c.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var p=0;p<d.maxAttributes;++p){var n=h.def(f.attributes,"[",p,"]"),q=a.cond(n,".buffer");q.then(g,".enableVertexAttribArray(",p,");",g,".bindBuffer(",34962,",",n,".buffer.buffer);",
g,".vertexAttribPointer(",p,",",n,".size,",n,".type,",n,".normalized,",n,".stride,",n,".offset);")["else"](g,".disableVertexAttribArray(",p,");",g,".vertexAttrib4f(",p,",",n,".x,",n,".y,",n,".z,",n,".w);",n,".buffer=null;");h(q);za&&h(m,".vertexAttribDivisorANGLE(",p,",",n,".divisor);")}h(a.shared.vao,".currentVAO=null;",a.shared.vao,".setVAO(",a.shared.vao,".targetVAO);");Object.keys(Ba).forEach(function(c){var d=Ba[c],f=e.def(k,".",c),m=a.block();m("if(",f,"){",g,".enable(",d,")}else{",g,".disable(",
d,")}",l,".",c,"=",f,";");h(m);b("if(",f,"!==",l,".",c,"){",m,"}")});Object.keys(Ca).forEach(function(c){var d=Ca[c],f=Aa[c],m,p,n=a.block();n(g,".",d,"(");N(f)?(d=f.length,m=a.global.def(k,".",c),p=a.global.def(l,".",c),n(U(d,function(a){return m+"["+a+"]"}),");",U(d,function(a){return p+"["+a+"]="+m+"["+a+"];"}).join("")),b("if(",U(d,function(a){return m+"["+a+"]!=="+p+"["+a+"]"}).join("||"),"){",n,"}")):(m=e.def(k,".",c),p=e.def(l,".",c),n(m,");",l,".",c,"=",m,";"),b("if(",m,"!==",p,"){",n,"}"));
h(n)});return a.compile()}(),compile:function(a,b,c,d,h){var e=A();e.stats=e.link(h);Object.keys(b["static"]).forEach(function(a){ka(e,b,a)});gc.forEach(function(b){ka(e,a,b)});c=J(a,b,c,d,e);Ya(e,c);pa(e,c);Wb(e,c);return e.compile()}}}function Nb(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var aa=function(a){return a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Float32Array||
a instanceof Float64Array||a instanceof Uint8ClampedArray},Y=function(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d)a[c[d]]=b[c[d]];return a},Ob="gl canvas container attributes pixelRatio extensions optionalExtensions profile onDone".split(" "),la={};la[5120]=la[5121]=1;la[5122]=la[5123]=la[36193]=la[33635]=la[32819]=la[32820]=2;la[5124]=la[5125]=la[5126]=la[34042]=4;var f=Y(c,{optional:function(a){a()},raise:b,commandRaise:B,command:function(a,b,c){a||B(b,c||A())},parameter:function(a,c,d){a in
c||b("unknown parameter ("+a+")"+e(d)+". possible values: "+Object.keys(c).join())},commandParameter:function(a,b,c,d){a in b||B("unknown parameter ("+a+")"+e(c)+". possible values: "+Object.keys(b).join(),d||A())},constructor:function(a){Object.keys(a).forEach(function(a){0>Ob.indexOf(a)&&b('invalid regl constructor argument "'+a+'". must be one of '+Ob)})},type:function(a,c,f){d(a,c)||b("invalid parameter type"+e(f)+". expected "+c+", got "+typeof a)},commandType:C,isTypedArray:function(a,c){aa(a)||
b("invalid parameter type"+e(c)+". must be a typed array")},nni:function(a,c){0<=a&&(a|0)===a||b("invalid parameter type, ("+a+")"+e(c)+". must be a nonnegative integer")},oneOf:g,shaderError:function(a,b,d,e,f){if(!a.getShaderParameter(b,a.COMPILE_STATUS)){b=a.getShaderInfoLog(b);a=e===a.FRAGMENT_SHADER?"fragment":"vertex";C(d,"string",a+" shader source must be a string",f);var g=G(d,f);d=ba(b);y(g,d);Object.keys(g).forEach(function(a){function b(a,c){d.push(a);h.push(c||"")}var c=g[a];if(c.hasErrors){var d=
[""],h=[""];b("file number "+a+": "+c.name+"\n","color:red;text-decoration:underline;font-weight:bold");c.lines.forEach(function(a){if(0<a.errors.length){b(l(a.number,4)+"|  ","background-color:yellow; font-weight:bold");b(a.line+"\n","color:red; background-color:yellow; font-weight:bold");var c=0;a.errors.forEach(function(d){d=d.message;var h=/^\s*'(.*)'\s*:\s*(.*)$/.exec(d);if(h){var e=h[1];d=h[2];switch(e){case "assign":e="="}c=Math.max(a.line.indexOf(e,c),0)}else c=0;b(l("| ",6));b(l("^^^",c+
3)+"\n","font-weight:bold");b(l("| ",6));b(d+"\n","font-weight:bold")});b(l("| ",6)+"\n")}else b(l(a.number,4)+"|  "),b(a.line+"\n","color:red")});"undefined"===typeof document||window.chrome?console.log(d.join("")):(h[0]=d.join("%c"),console.log.apply(console,h))}});c.raise("Error compiling "+a+" shader, "+g[0].name)}},linkError:function(a,b,d,e,f){a.getProgramParameter(b,a.LINK_STATUS)||(a=a.getProgramInfoLog(b),d=G(d,f),e='Error linking program with vertex shader, "'+G(e,f)[0].name+'", and fragment shader "'+
d[0].name+'"',"undefined"!==typeof document?console.log("%c"+e+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(e+"\n"+a),c.raise(e))},callSite:z,saveCommandRef:E,saveDrawInfo:function(a,b,c,d){function e(a){return a?d.id(a):0}function f(a,b){Object.keys(b).forEach(function(b){a[d.id(b)]=!0})}E(a);a._fragId=e(a["static"].frag);a._vertId=e(a["static"].vert);var g=a._uniformSet={};f(g,b["static"]);f(g,b.dynamic);b=a._attributeSet={};f(b,c["static"]);f(b,c.dynamic);
a._hasCount="count"in a["static"]||"count"in a.dynamic||"elements"in a["static"]||"elements"in a.dynamic},framebufferFormat:function(a,b,c){a.texture?g(a.texture._texture.internalformat,b,"unsupported texture format for attachment"):g(a.renderbuffer._renderbuffer.format,c,"unsupported renderbuffer format for attachment")},guessCommand:A,texture2D:function(a,b,d){var e=b.width,f=b.height,g=b.channels;c(0<e&&e<=d.maxTextureSize&&0<f&&f<=d.maxTextureSize,"invalid texture shape");33071===a.wrapS&&33071===
a.wrapT||c(!(e&e-1)&&!!e&&!(f&f-1)&&!!f,"incompatible wrap mode for texture, both width and height must be power of 2");1===b.mipmask?1!==e&&1!==f&&c(9984!==a.minFilter&&9986!==a.minFilter&&9985!==a.minFilter&&9987!==a.minFilter,"min filter requires mipmap"):(c(!(e&e-1)&&!!e&&!(f&f-1)&&!!f,"texture must be a square power of 2 to support mipmapping"),c(b.mipmask===(e<<1)-1,"missing or incomplete mipmap data"));5126===b.type&&(0>d.extensions.indexOf("oes_texture_float_linear")&&c(9728===a.minFilter&&
9728===a.magFilter,"filter not supported, must enable oes_texture_float_linear"),c(!a.genMipmaps,"mipmap generation not supported with float textures"));var k=b.images;for(d=0;16>d;++d)if(k[d]){var l=e>>d,q=f>>d;c(b.mipmask&1<<d,"missing mipmap data");var n=k[d];c(n.width===l&&n.height===q,"invalid shape for mip images");c(n.format===b.format&&n.internalformat===b.internalformat&&n.type===b.type,"incompatible type for mip image");!n.compressed&&n.data&&(l=Math.ceil(J(n.type,g)*l/n.unpackAlignment)*
n.unpackAlignment,c(n.data.byteLength===l*q,"invalid data for image, buffer size is inconsistent with image format"))}else a.genMipmaps||c(0===(b.mipmask&1<<d),"extra mipmap data");b.compressed&&c(!a.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(a,b,d,e){var f=a.width,g=a.height,k=a.channels;c(0<f&&f<=e.maxTextureSize&&0<g&&g<=e.maxTextureSize,"invalid texture shape");c(f===g,"cube map must be square");c(33071===b.wrapS&&33071===b.wrapT,"wrap mode not supported by cube map");
for(e=0;e<d.length;++e){var l=d[e];c(l.width===f&&l.height===g,"inconsistent cube map face shape");b.genMipmaps&&(c(!l.compressed,"can not generate mipmap for compressed textures"),c(1===l.mipmask,"can not specify mipmaps and generate mipmaps"));for(var q=l.images,n=0;16>n;++n){var p=q[n];if(p){var w=f>>n,t=g>>n;c(l.mipmask&1<<n,"missing mipmap data");c(p.width===w&&p.height===t,"invalid shape for mip images");c(p.format===a.format&&p.internalformat===a.internalformat&&p.type===a.type,"incompatible type for mip image");
p.compressed||p.data&&c(p.data.byteLength===w*t*Math.max(J(p.type,k),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}}),Qb=0,ua={DynamicVariable:H,define:function(a,b){return new H(a,F(b+""))},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof H},unbox:function(a,b){return"function"===typeof a?new H(0,a):a},accessor:F},sb={next:"function"===typeof requestAnimationFrame?function(a){return requestAnimationFrame(a)}:function(a){return setTimeout(a,
16)},cancel:"function"===typeof cancelAnimationFrame?function(a){return cancelAnimationFrame(a)}:clearTimeout},Pb="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},P=tb();P.zero=tb();var hc=function(a,b){var c=1;b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,e=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),e=a.getParameter(36063));var f=!!b.oes_texture_float;if(f){f=a.createTexture();a.bindTexture(3553,f);a.texImage2D(3553,
0,6408,1,1,0,6408,5126,null);var g=a.createFramebuffer();a.bindFramebuffer(36160,g);a.framebufferTexture2D(36160,36064,3553,f,0);a.bindTexture(3553,null);if(36053!==a.checkFramebufferStatus(36160))f=!1;else{a.viewport(0,0,1,1);a.clearColor(1,0,0,1);a.clear(16384);var k=P.allocType(5126,4);a.readPixels(0,0,1,1,6408,5126,k);a.getError()?f=!1:(a.deleteFramebuffer(g),a.deleteTexture(f),f=1===k[0]);P.freeType(k)}}k=!0;"undefined"!==typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||
/Edge/.test(navigator.userAgent))||(k=a.createTexture(),g=P.allocType(5121,36),a.activeTexture(33984),a.bindTexture(34067,k),a.texImage2D(34069,0,6408,3,3,0,6408,5121,g),P.freeType(g),a.bindTexture(34067,null),a.deleteTexture(k),k=!a.getError());return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),
maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:e,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938),readFloat:f,npotTextureCube:k}},ka=function(a){return Object.keys(a).map(function(b){return a[b]})},fb={shape:function(a){for(var b=[];a.length;a=a[0])b.push(a.length);return b},flatten:function(a,b,c,d){var e=1;if(b.length)for(var f=0;f<b.length;++f)e*=b[f];else e=0;c=d||P.allocType(c,e);switch(b.length){case 0:break;case 1:d=b[0];for(b=0;b<d;++b)c[b]=
a[b];break;case 2:d=b[0];b=b[1];for(f=e=0;f<d;++f)for(var g=a[f],k=0;k<b;++k)c[e++]=g[k];break;case 3:Ja(a,b[0],b[1],b[2],c,0);break;default:ub(a,b,0,c,0)}return c}},ab={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Fa={int8:5120,int16:5122,int32:5124,uint8:5121,
uint16:5123,uint32:5125,"float":5126,float32:5126},cb={dynamic:35048,stream:35040,"static":35044},jb=fb.flatten,xb=fb.shape,va=[];va[5120]=1;va[5122]=2;va[5124]=4;va[5121]=1;va[5123]=2;va[5125]=4;va[5126]=4;var La={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},zb=new Float32Array(1),Tb=new Uint32Array(zb.buffer),Ib=function(a){return!(a&a-1)&&!!a},Xb=[9984,9986,9985,9987],eb=[0,6409,6410,6407,6408],fa={};fa[6409]=fa[6406]=
fa[6402]=1;fa[34041]=fa[6410]=2;fa[6407]=fa[35904]=3;fa[6408]=fa[35906]=4;var nb=Ma("HTMLCanvasElement"),ob=Ma("OffscreenCanvas"),Db=Ma("CanvasRenderingContext2D"),Eb=Ma("ImageBitmap"),Fb=Ma("HTMLImageElement"),Gb=Ma("HTMLVideoElement"),Ub=Object.keys(ab).concat([nb,ob,Db,Eb,Fb,Gb]),Na=[];Na[5121]=1;Na[5126]=4;Na[36193]=2;Na[5123]=2;Na[5125]=4;var ca=[];ca[32854]=2;ca[32855]=2;ca[36194]=2;ca[34041]=4;ca[33776]=.5;ca[33777]=.5;ca[33778]=1;ca[33779]=1;ca[35986]=.5;ca[35987]=1;ca[34798]=1;ca[35840]=
.5;ca[35841]=.25;ca[35842]=.5;ca[35843]=.25;ca[36196]=.5;var ja=[];ja[32854]=2;ja[32855]=2;ja[36194]=2;ja[33189]=2;ja[36168]=1;ja[34041]=4;ja[35907]=4;ja[34836]=16;ja[34842]=8;ja[34843]=6;var ic=function(a,b,c,d,e){function g(a){this.id=n++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;e.profile&&(this.stats={size:0})}function k(b){var c=b.renderbuffer;f(c,"must not double destroy renderbuffer");a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(c);b.renderbuffer=
null;b.refCount=0;delete p[b.id];d.renderbufferCount--}var l={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(l.srgba=35907);b.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);b.webgl_color_buffer_float&&(l.rgba32f=34836);var q=[];Object.keys(l).forEach(function(a){q[l[a]]=a});var n=0,p={};g.prototype.decRef=function(){0>=--this.refCount&&k(this)};e.profile&&(d.getTotalRenderbufferSize=function(){var a=0;Object.keys(p).forEach(function(b){a+=
p[b].stats.size});return a});return{create:function(b,k){function m(b,d){var g=0,k=0,p=32854;"object"===typeof b&&b?("shape"in b?(k=b.shape,f(Array.isArray(k)&&2<=k.length,"invalid renderbuffer shape"),g=k[0]|0,k=k[1]|0):("radius"in b&&(g=k=b.radius|0),"width"in b&&(g=b.width|0),"height"in b&&(k=b.height|0)),"format"in b&&(f.parameter(b.format,l,"invalid renderbuffer format"),p=l[b.format])):"number"===typeof b?(g=b|0,k="number"===typeof d?d|0:g):b?f.raise("invalid arguments to renderbuffer constructor"):
g=k=1;f(0<g&&0<k&&g<=c.maxRenderbufferSize&&k<=c.maxRenderbufferSize,"invalid renderbuffer size");if(g!==n.width||k!==n.height||p!==n.format)return m.width=n.width=g,m.height=n.height=k,n.format=p,a.bindRenderbuffer(36161,n.renderbuffer),a.renderbufferStorage(36161,p,g,k),f(0===a.getError(),"invalid render buffer format"),e.profile&&(n.stats.size=ja[n.format]*n.width*n.height),m.format=q[n.format],m}var n=new g(a.createRenderbuffer());p[n.id]=n;d.renderbufferCount++;m(b,k);m.resize=function(b,d){var g=
b|0,k=d|0||g;if(g===n.width&&k===n.height)return m;f(0<g&&0<k&&g<=c.maxRenderbufferSize&&k<=c.maxRenderbufferSize,"invalid renderbuffer size");m.width=n.width=g;m.height=n.height=k;a.bindRenderbuffer(36161,n.renderbuffer);a.renderbufferStorage(36161,n.format,g,k);f(0===a.getError(),"invalid render buffer format");e.profile&&(n.stats.size=ja[n.format]*n.width*n.height);return m};m._reglType="renderbuffer";m._renderbuffer=n;e.profile&&(m.stats=n.stats);m.destroy=function(){n.decRef()};return m},clear:function(){ka(p).forEach(k)},
restore:function(){ka(p).forEach(function(b){b.renderbuffer=a.createRenderbuffer();a.bindRenderbuffer(36161,b.renderbuffer);a.renderbufferStorage(36161,b.format,b.width,b.height)});a.bindRenderbuffer(36161,null)}}},$b=[6407,6408],pb=[];pb[6408]=4;pb[6407]=3;var hb=[];hb[5121]=1;hb[5126]=4;hb[36193]=2;var ac=[32854,32855,36194,35907,34842,34843,34836],Zb={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"},Sa=["x",
"y","z","w"],gc="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),xa={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Kb="constant color, constant alpha;one minus constant color, constant alpha;constant color, one minus constant alpha;one minus constant color, one minus constant alpha;constant alpha, constant color;constant alpha, one minus constant color;one minus constant alpha, constant color;one minus constant alpha, one minus constant color".split(";"),
Ra={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ea={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Lb={frag:35632,vert:35633},rb={cw:2304,ccw:2305},Mb=new qa(!1,!1,!1,function(){}),jc=function(a,b){function c(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function d(a,b,e){var f=
g.pop()||new c;f.startQueryIndex=a;f.endQueryIndex=b;f.sum=0;f.stats=e;k.push(f)}if(!b.ext_disjoint_timer_query)return null;var e=[],f=[],g=[],k=[],l=[],n=[];return{beginQuery:function(a){var c=e.pop()||b.ext_disjoint_timer_query.createQueryEXT();b.ext_disjoint_timer_query.beginQueryEXT(35007,c);f.push(c);d(f.length-1,f.length,a)},endQuery:function(){b.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:d,update:function(){var a,c;a=f.length;if(0!==a){n.length=Math.max(n.length,a+1);l.length=
Math.max(l.length,a+1);l[0]=0;var d=n[0]=0;for(c=a=0;c<f.length;++c){var h=f[c];b.ext_disjoint_timer_query.getQueryObjectEXT(h,34919)?(d+=b.ext_disjoint_timer_query.getQueryObjectEXT(h,34918),e.push(h)):f[a++]=h;l[c+1]=d;n[c+1]=a}f.length=a;for(c=a=0;c<k.length;++c){var d=k[c],q=d.startQueryIndex,h=d.endQueryIndex;d.sum+=l[h]-l[q];q=n[q];h=n[h];h===q?(d.stats.gpuTime+=d.sum/1E6,g.push(d)):(d.startQueryIndex=q,d.endQueryIndex=h,k[a++]=d)}k.length=a}},getNumPendingQueries:function(){return f.length},
clear:function(){e.push.apply(e,f);for(var a=0;a<e.length;a++)b.ext_disjoint_timer_query.deleteQueryEXT(e[a]);f.length=0;e.length=0},restore:function(){f.length=0;e.length=0}}};return function(a){function b(){if(0===N.length)B&&B.update(),aa=null;else{aa=sb.next(b);p();for(var a=N.length-1;0<=a;--a){var c=N[a];c&&c(D,null,0)}v.flush();B&&B.update()}}function c(){!aa&&0<N.length&&(aa=sb.next(b))}function d(){aa&&(sb.cancel(b),aa=null)}function e(a){a.preventDefault();z=!0;d();ba.forEach(function(a){a()})}
function g(a){v.getError();z=!1;y.restore();S.restore();H.restore();X.restore();J.restore();R.restore();K.restore();B&&B.restore();U.procs.refresh();c();ca.forEach(function(a){a()})}function k(a){function b(a){var c={},d={};Object.keys(a).forEach(function(b){var e=a[b];ua.isDynamic(e)?d[b]=ua.unbox(e,b):c[b]=e});return{dynamic:d,"static":c}}function c(a){for(;p.length<a;)p.push(null);return p}f(!!a,"invalid args to regl({...})");f.type(a,"object","invalid args to regl({...})");var d=b(a.context||
{}),e=b(a.uniforms||{}),g=b(a.attributes||{}),h=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=Y({},a);delete c.uniforms;delete c.attributes;delete c.context;delete c.vao;"stencil"in c&&c.stencil.op&&(c.stencil.opBack=c.stencil.opFront=c.stencil.op,delete c.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");"vao"in a&&(c.vao=a.vao);return c}(a));a={gpuTime:0,cpuTime:0,count:0};
var d=U.compile(h,g,e,d,a),l=d.draw,m=d.batch,n=d.scope,p=[];return Y(function(a,b){var d;z&&f.raise("context lost");if("function"===typeof a)return n.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(d=0;d<a;++d)n.call(this,null,b,d);else if(Array.isArray(a))for(d=0;d<a.length;++d)n.call(this,a[d],b,d);else return n.call(this,a,b,0);else if("number"===typeof a){if(0<a)return m.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return m.call(this,a,a.length)}else return l.call(this,
a)},{stats:a})}function l(a,b){var c=0;U.procs.poll();var d=b.color;d&&(v.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384);"depth"in b&&(v.clearDepth(+b.depth),c|=256);"stencil"in b&&(v.clearStencil(b.stencil|0),c|=1024);f(!!c,"called regl.clear with no buffer specified");v.clear(c)}function q(a){f.type(a,"function","regl.frame() callback must be a function");N.push(a);c();return{cancel:function(){function b(){var a=Nb(N,b);N[a]=N[N.length-1];--N.length;0>=N.length&&d()}var c=Nb(N,a);f(0<=
c,"cannot cancel a frame twice");N[c]=b}}}function n(){var a=V.viewport,b=V.scissor_box;a[0]=a[1]=b[0]=b[1]=0;D.viewportWidth=D.framebufferWidth=D.drawingBufferWidth=a[2]=b[2]=v.drawingBufferWidth;D.viewportHeight=D.framebufferHeight=D.drawingBufferHeight=a[3]=b[3]=v.drawingBufferHeight}function p(){D.tick+=1;D.time=t();n();U.procs.poll()}function w(){n();U.procs.refresh();B&&B.update()}function t(){return(Pb()-C)/1E3}a=ra(a);if(!a)return null;var v=a.gl,u=v.getContextAttributes(),z=v.isContextLost(),
y=ga(v,a);if(!y)return null;var r=M(),A={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},F=y.extensions,B=jc(v,F),C=Pb(),E=v.drawingBufferWidth,G=v.drawingBufferHeight,D={tick:0,time:0,viewportWidth:E,viewportHeight:G,framebufferWidth:E,framebufferHeight:G,drawingBufferWidth:E,drawingBufferHeight:G,pixelRatio:a.pixelRatio},Z=hc(v,F),H=Rb(v,A,a,function(a){return K.destroyBuffer(a)}),K=bc(v,F,Z,A,H),I=Sb(v,
F,H,A),S=cc(v,r,A,a),X=Vb(v,F,Z,function(){U.procs.poll()},D,A,a),J=ic(v,F,Z,A,a),R=Yb(v,F,Z,X,J,A),U=fc(v,r,F,Z,H,I,X,R,{},K,S,{elements:null,primitive:4,count:-1,offset:0,instances:-1},D,B,a),r=dc(v,R,U.procs.poll,D,u,F,Z),V=U.next,P=v.canvas,N=[],ba=[],ca=[],da=[a.onDestroy],aa=null;P&&(P.addEventListener("webglcontextlost",e,!1),P.addEventListener("webglcontextrestored",g,!1));var fa=R.setFBO=k({framebuffer:ua.define.call(null,1,"framebuffer")});w();u=Y(k,{clear:function(a){f("object"===typeof a&&
a,"regl.clear() takes an object as input");if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)fa(Y({framebuffer:a.framebuffer.faces[b]},a),l);else fa(a,l);else l(null,a)},prop:ua.define.bind(null,1),context:ua.define.bind(null,2),"this":ua.define.bind(null,3),draw:k({}),buffer:function(a){return H.create(a,34962,!1,!1)},elements:function(a){return I.create(a,!1)},texture:X.create2D,cube:X.createCube,renderbuffer:J.create,framebuffer:R.create,framebufferCube:R.createCube,
vao:K.createVAO,attributes:u,frame:q,on:function(a,b){f.type(b,"function","listener callback must be a function");var c;switch(a){case "frame":return q(b);case "lost":c=ba;break;case "restore":c=ca;break;case "destroy":c=da;break;default:f.raise("invalid event, must be one of frame,lost,restore,destroy")}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:Z,hasExtension:function(a){return 0<=Z.extensions.indexOf(a.toLowerCase())},
read:r,destroy:function(){N.length=0;d();P&&(P.removeEventListener("webglcontextlost",e),P.removeEventListener("webglcontextrestored",g));S.clear();R.clear();J.clear();X.clear();I.clear();H.clear();K.clear();B&&B.clear();da.forEach(function(a){a()})},_gl:v,_refresh:w,poll:function(){p();B&&B.update()},now:t,stats:A});a.onDone(null,u);return u}})},{}],33:[function(g,d,q){function a(a){throw Error("resl: "+a);}function b(b,c,d){Object.keys(b).forEach(function(b){0>c.indexOf(b)&&a('invalid parameter "'+
b+'" in '+d)})}function c(a,b){this.state=0;this.ready=!1;this.progress=0;this.name=a;this.cancel=b}var e=["manifest","onDone","onProgress","onError"],k=["type","src","stream","credentials","parser"],u=["onData","onDone"];d.exports=function(d){function g(b,c){if(b in d){var e=d[b];"function"!==typeof e&&a('invalid callback "'+b+'"');return e}return null}function q(a){function b(){if(!(2>l.readyState||1===u.state||-1===u.state)){if(200!==l.status)return A('error loading resource "'+a.name+'"');if(2<
l.readyState&&0===u.state){var c;c="binary"===a.type?l.response:l.responseText;if(k.data)try{t=k.data(c)}catch(e){return A(e)}else t=c}if(3<l.readyState&&0===u.state){if(k.done)try{t=k.done()}catch(e){return A(e)}u.state=1}B[d]=t;u.progress=.75*u.progress+.25;u.ready=a.stream&&!!t||1===u.state;z()}}var d=a.name,e=a.stream,g="binary"===a.type,k=a.parser,l=new XMLHttpRequest,t=null,u=new c(d,function(){1!==u.state&&-1!==u.state&&(l.onreadystatechange=null,l.abort(),u.state=-1)});l.onreadystatechange=
e?b:function(){4===l.readyState&&b()};g&&(l.responseType="arraybuffer");a.credentials&&(l.withCredentials=!0);l.open("GET",a.src,!0);l.send();return u}function t(a,b){function d(){if(0===t.state)if(u.data)try{y=u.data(b)}catch(a){return A(a)}else y=b}function e(a){d();B[q]=y;t.progress=a.lengthComputable?Math.max(t.progress,a.loaded/a.total):.75*t.progress+.25;z(q)}function g(){d();if(0===t.state){if(u.done)try{y=u.done()}catch(a){return A(a)}t.state=1}t.progress=1;t.ready=!0;B[q]=y;l();z("finish "+
q)}function k(){A('error loading asset "'+q+'"')}function l(){a.stream&&b.removeEventListener("progress",e);"image"===a.type?b.addEventListener("load",g):b.addEventListener("canplay",g);b.removeEventListener("error",k)}var q=a.name,u=a.parser,t=new c(q,function(){1!==t.state&&-1!==t.state&&(t.state=-1,l(),b.src="")}),y=b;a.stream&&b.addEventListener("progress",e);if("image"===a.type)b.addEventListener("load",g);else{var C=!1,D=!1;b.addEventListener("loadedmetadata",function(){D=!0;C&&g()});b.addEventListener("canplay",
function(){C=!0;D&&g()})}b.addEventListener("error",k);b.crossOrigin=a.credentials?"use-credentials":"anonymous";b.src=a.src;return t}function A(a){-1!==C&&1!==C&&(C=-1,H.forEach(function(a){a.cancel()}),E?"string"===typeof a?E(Error("resl: "+a)):E(a):console.error("resl error:",a))}function z(a){if(-1!==C&&1!==C){var b=0,c=0;H.forEach(function(a){a.ready&&(c+=1);b+=a.progress});c===H.length?(C=1,ba(B)):y&&y(b/H.length,a)}}"object"===typeof d&&d||a("invalid or missing configuration");b(d,e,"config");
var G=d.manifest;"object"===typeof G&&G||a("missing manifest");var ba=g("onDone");ba||a("missing onDone() callback");var y=g("onProgress"),E=g("onError"),B={},C=0,J={text:q,binary:function(a){return q(a)},image:function(a){return t(a,document.createElement("img"))},video:function(a){return t(a,document.createElement("video"))},audio:function(a){return t(a,document.createElement("audio"))}},H=Object.keys(G).map(function(c){function d(b,c){if(b in e.parser){var g=e.parser[b];"function"!==typeof g&&
a("invalid parser callback "+b+' for asset "'+b+'"');return g}return c}var e=G[c];"string"===typeof e?e={src:e}:"object"===typeof e&&e||a('invalid asset definition "'+c+'"');b(e,k,'asset "'+c+'"');var g={};"parser"in e&&("function"===typeof e.parser?g={data:e.parser}:"object"===typeof e.parser&&e.parser?(b(g,u,'parser for asset "'+c+'"'),"onData"in g||a('missing onData callback for parser in asset "'+c+'"'),g={data:d("onData"),done:d("onDone")}):a('invalid parser for asset "'+c+'"'));return{name:c,
type:function(b,d,g){b in e&&(g=e[b]);0>d.indexOf(g)&&a("invalid "+b+' "'+g+'" for asset "'+c+'", possible values: '+d);return g}("type",Object.keys(J),"text"),stream:!!e.stream,credentials:!!e.credentials,src:function(b,d,g){b in e?g=e[b]:d&&a("missing "+b+' for asset "'+c+'"');"string"!==typeof g&&a("invalid "+b+' for asset "'+c+'", must be a string');return g}("src",!0,""),parser:g}}).map(function(a){return J[a.type](a)});0===H.length&&setTimeout(function(){z("done")},1)}},{}]},{},[1]);

        </script>
        </body>
      </html>