<!DOCTYPE html>
      <html>
        <head>
          <title>example/dynamic.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(p,r,b){function g(m,l){if(!r[m]){if(!p[m]){var H="function"==typeof require&&require;if(!l&&H)return H(m,!0);if(a)return a(m,!0);H=Error("Cannot find module '"+m+"'");throw H.code="MODULE_NOT_FOUND",H;}H=r[m]={exports:{}};p[m][0].call(H.exports,function(a){var b=p[m][1][a];return g(b?b:a)},H,H.exports,e$$0,p,r,b)}return r[m].exports}for(var a="function"==typeof require&&require,l=0;l<b.length;l++)g(b[l]);return g})({1:[function(n,p,r){var b=n("../regl")(),g=b({frag:"\n    precision mediump float;\n    uniform vec4 color;\n    void main() {\n      gl_FragColor = color;\n    }",
vert:"\n    precision mediump float;\n    attribute vec2 position;\n    uniform float angle;\n    void main() {\n      gl_Position = vec4(\n        cos(angle) * position.x + sin(angle) * position.y,\n        -sin(angle) * position.x + cos(angle) * position.y, 0, 1);\n    }",attributes:{position:[-1,0,0,-1,1,1]},uniforms:{color:b.prop("color"),angle:function(a){return.01*a.count}},depth:{enable:!1},count:3});b.frame(function(a){a=a.count;b.clear({color:[0,0,0,1]});g({color:[Math.sin(.001*a),Math.cos(.02*
a),Math.sin(.3*a),1]})})},{"../regl":30}],2:[function(n,p,r){function b(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}p.exports=function(g,a,l,m,h){g=l.maxAttributes;a=Array(g);for(l=0;l<g;++l)a[l]=new b;return{Record:b,scope:{},state:a}}},{}],3:[function(n,p,r){function b(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);
case 5122:return new Int16Array(b);case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var g=n("./util/is-typed-array"),a=n("./util/is-ndarray"),l=n("./constants/arraytypes.json"),m=n("./constants/dtypes.json"),h=n("./util/values"),H={"static":35044,dynamic:35048,stream:35040};p.exports=function(n){function p(a){this.id=y++;this.buffer=null;this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function B(a){n.isBuffer(a.buffer)||
(a.buffer=n.createBuffer());a.bind();n.bufferData(a.type,a.data||a.byteLength,a.usage)}function u(a){var b=a.buffer;n.isBuffer(b)&&n.deleteBuffer(b);a.buffer=null;delete c[a.id]}function q(h,n,q){function y(c){var h=c||{};if(Array.isArray(h)||g(h)||a(h))h={data:h};else if("number"===typeof h)h={length:h|0};else if(null===h||void 0===h)h={};x.usage="usage"in h?H[h.usage]:35044;c=0;"type"in h&&(c=m[h.type]);var n=h.dimension|0||1,q=0,w=null;if("data"in h)if(w=h.data,null===w)q=h.length|0;else{if(a(w)){var n=
w.shape,q=w.stride,h=w.offset,v=0,G=0,u=0,K=0;1===n.length?(v=n[0],G=1,u=q[0],K=0):2===n.length&&(v=n[0],G=n[1],u=q[0],K=q[1]);c=c||l[Object.prototype.toString.call(w.data)]|0||5126;for(var n=G,q=b(c,v*G),w=w.data,p=0,z=0;z<v;++z)for(var F=0;F<G;++F)q[p++]=w[u*z+K*F+h];w=q}else if(Array.isArray(w))if(0<w.length&&Array.isArray(w[0])){n=w[0].length;c=c||5126;h=b(c,w.length*n);q=w;w=n;for(v=K=0;v<q.length;++v)for(u=q[v],G=0;G<w;++G)h[K++]=u[G];w=h}else c=c||5126,w=b(c,w);else c=c||l[Object.prototype.toString.call(w)]|
0;q=w.byteLength}else"length"in h&&(q=h.length|0);x.data=w;x.dtype=c||5121;x.byteLength=q;x.dimension=n;B(x);return y}var x=new p(n);c[x.id]=x;q||y(h);y._reglType="buffer";y._buffer=x;y.destroy=function(){u(x)};return y}var y=0,c={};p.prototype.bind=function(){n.bindBuffer(this.type,this.buffer)};return{create:q,createStream:function(a){return q({data:a,usage:"stream"},34962,!1)._buffer},destroyStream:function(a){u(a)},clear:function(){h(c).forEach(u)},refresh:function(){h(c).forEach(B)},getBuffer:function(a){return a&&
a._buffer instanceof p?a._buffer:null}}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/values":28}],4:[function(n,p,r){p.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(n,
p,r){p.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],6:[function(n,p,r){p.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(n,p,r){function b(a){return Array.isArray(a)||da(a)||B(a)}function g(a){return a.sort(function(a,c){return"viewport"===a?-1:"viewport"===c?1:a<c?-1:1})}function a(a,c,b,h){this.thisDep=a;this.contextDep=c;this.propDep=b;this.append=
h}function l(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function m(c){return new a(!1,!1,!1,c)}function h(c,b){var h=c.type;return 0===h?(h=c.data.length,new a(!0,1<=h,2<=h,b)):new a(3===h,2===h,1===h,b)}var H=n("./util/codegen"),F=n("./util/loop"),da=n("./util/is-typed-array"),B=n("./util/is-ndarray"),u=n("./constants/primitives.json"),q=n("./constants/dtypes.json"),y=["x","y","z","w"],c={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,
"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},w={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},K={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,
invert:5386},z={cw:2304,ccw:2305},aa=new a(!1,!1,!1,function(){});p.exports=function(n,p,B,r,W,I,v,G,ga,S,Y,ha,N){function Q(d){return d.replace(".","_")}function E(d,e,a){var k=Q(d);qa.push(d);na[k]=ia[k]=!!a;ja[k]=e}function C(d,e,a){var k=Q(d);qa.push(d);Array.isArray(a)?(ia[k]=a.slice(),na[k]=a.slice()):ia[k]=na[k]=a;ka[k]=e}function R(){var d=H(),e=d.link,a=d.global;d.id=Ca++;d.batchId="0";var k=e(za),c=d.shared={props:"a0"};Object.keys(za).forEach(function(f){c[f]=a.def(k,".",f)});var D=d.next=
{},b=d.current={};Object.keys(ka).forEach(function(f){Array.isArray(ia[f])&&(D[f]=a.def(c.next,".",f),b[f]=a.def(c.current,".",f))});var f=d.constants={};Object.keys(sa).forEach(function(d){f[d]=a.def(JSON.stringify(sa[d]))});d.invoke=function(f,U){switch(U.type){case 0:var a=["this",c.context,c.props,d.batchId];return f.def(e(U.data),".call(",a.slice(0,Math.max(U.data.length+1,4)),")");case 1:return f.def(c.props,U.data);case 2:return f.def(c.context,U.data);case 3:return f.def("this",U.data)}};
d.attribCache={};var U={};d.scopeAttrib=function(f){f=p.id(f);if(f in U)return U[f];var d=S.scope[f];d||(d=S.scope[f]=new oa);return U[f]=e(d)};return d}function ca(d){var e=d["static"];d=d.dynamic;if("framebuffer"in e){var a=e.framebuffer;return a?(a=G.getFramebuffer(a),m(function(d,e){var k=d.link(a),f=d.shared;e.set(f.framebuffer,".next",k);f=f.context;e.set(f,".framebufferWidth",k+".width");e.set(f,".framebufferHeight",k+".height");return k})):m(function(d,e){var a=d.shared;e.set(a.framebuffer,
".next","null");a=a.context;e.set(a,".framebufferWidth",a+".drawingBufferWidth");e.set(a,".framebufferHeight",a+".drawingBufferHeight");return null})}if("framebuffer"in d){var k=d.framebuffer;return h(k,function(d,a){var e=d.invoke(a,k),f=d.shared,U=f.framebuffer,e=a.def(U,".getFramebuffer(",e,")");a.set(U,".next",e);f=f.context;a.set(f,".framebufferWidth",e+"?"+e+".width:"+f+".drawingBufferWidth");a.set(f,".framebufferHeight",e+"?"+e+".height:"+f+".drawingBufferHeight");return e})}return null}function M(d,
e){function k(f){if(f in c){var d=c[f];f=!0;var ra=d.x|0,Aa=d.y|0,D,t;"w"in d?D=d.w|0:f=!1;"h"in d?t=d.h|0:f=!1;return new a(f&&e&&e.thisDep,f&&e&&e.contextDep,f&&e&&e.propDep,function(f,e){var a=f.shared.context,k=D;"w"in d||(k=e.def(a,".","framebufferWidth","-",ra));var c=t;"h"in d||(c=e.def(a,".","framebufferHeight","-",Aa));return[ra,Aa,k,c]})}if(f in b){var ma=b[f];f=h(ma,function(f,e){var d=f.invoke(e,ma),a=f.shared.context,k=e.def(d,".x|0"),U=e.def(d,".y|0"),ra=e.def('"w" in ',d,"?",d,".w|0:",
"(",a,".","framebufferWidth","-",k,")"),d=e.def('"h" in ',d,"?",d,".h|0:","(",a,".","framebufferHeight","-",U,")");return[k,U,ra,d]});e&&(f.thisDep=f.thisDep||e.thisDep,f.contextDep=f.contextDep||e.contextDep,f.propDep=f.propDep||e.prpoDep);return f}return e?new a(e.thisDep,e.contextDep,e.propDep,function(f,d){var e=f.shared.context;return[0,0,d.def(e,".","framebufferWidth"),d.def(e,".","framebufferHeight")]}):null}var c=d["static"],b=d.dynamic,D=k("viewport");if(D)var t=D,D=new a(D.thisDep,D.contextDep,
D.propDep,function(f,d){var e=t.append(f,d),a=f.shared.context;d.set(a,".viewportWidth",e[2]);d.set(a,".viewportHeight",e[3]);return e});return{viewport:D,scissor_box:k("scissor.box")}}function L(d){function e(f){if(f in k){var d=p.id(k[f]);f=m(function(){return d});f.id=d;return f}if(f in c){var a=c[f];return h(a,function(f,d){var e=f.invoke(d,a);return d.def(f.shared.strings,".id(",e,")")})}return null}var k=d["static"],c=d.dynamic,b=e("frag"),D=e("vert"),t=null;l(b)&&l(D)?(t=Y.program(D.id,b.id),
d=m(function(f,d){return f.link(t)})):d=new a(b&&b.thisDep||D&&D.thisDep,b&&b.contextDep||D&&D.contextDep,b&&b.propDep||D&&D.propDep,function(f,d){var e=f.shared.shader,a;a=b?b.append(f,d):d.def(e,".","frag");var k;k=D?D.append(f,d):d.def(e,".","vert");return d.def(e+".program("+k+","+a+")")});return{frag:b,vert:D,progVar:d,program:t}}function J(d){function e(d,f){if(d in k){var a=k[d]|0;return m(function(d,e){f&&(d.OFFSET=a);return a})}if(d in c){var b=c[d];return h(b,function(d,e){var a=d.invoke(e,
b);f&&(d.OFFSET=a);return a})}return f&&t?m(function(f,d){f.OFFSET="0";return 0}):null}var k=d["static"],c=d.dynamic,t=function(){if("elements"in k){var d=k.elements;b(d)?d=I.getElements(I.create(d)):d&&(d=I.getElements(d));var f=m(function(f,e){if(d){var a=f.link(d);return f.ELEMENTS=a}return f.ELEMENTS=null});f.value=d;return f}if("elements"in c){var e=c.elements;return h(e,function(f,d){var a=f.shared,k=a.isBufferArgs,a=a.elements,c=f.invoke(d,e),b=d.def("null"),k=d.def(k,"(",c,")"),c=f.cond(k).then(b,
"=",a,".createStream(",c,");")["else"](b,"=",a,".getElements(",c,");");d.entry(c);d.exit(f.cond(k).then(a,".destroyStream(",b,");"));return f.ELEMENTS=b})}return null}(),D=e("offset",!0);return{elements:t,primitive:function(){if("primitive"in k){var d=k.primitive;return m(function(f,e){return u[d]})}if("primitive"in c){var f=c.primitive;return h(f,function(d,e){var a=d.constants.primTypes,k=d.invoke(e,f);return e.def(a,"[",k,"]")})}return t?l(t)?t.value?m(function(f,d){return d.def(f.ELEMENTS,".primType")}):
m(function(){return 4}):new a(t.thisDep,t.contextDep,t.propDep,function(f,d){var e=f.ELEMENTS;return d.def(e,"?",e,".primType:",4)}):null}(),count:function(){if("count"in k){var d=k.count|0;return m(function(){return d})}if("count"in c){var f=c.count;return h(f,function(d,e){return d.invoke(e,f)})}return t?l(t)?t?D?new a(D.thisDep,D.contextDep,D.propDep,function(f,d){return d.def(f.ELEMENTS,".vertCount-",f.OFFSET)}):m(function(f,d){return d.def(f.ELEMENTS,".vertCount")}):m(function(){return-1}):new a(t.thisDep||
D.thisDep,t.contextDep||D.contextDep,t.propDep||D.propDep,function(f,d){var e=f.ELEMENTS;return f.OFFSET?d.def(e,"?",e,".vertCount-",f.OFFSET,":-1"):d.def(e,"?",e,".vertCount:-1")}):null}(),instances:e("instances",!1),offset:D}}function V(d){var e=d["static"],a=d.dynamic,k={};qa.forEach(function(d){function b(f,c){if(d in e){var D=f(e[d]);k[t]=m(function(){return D})}else if(d in a){var g=a[d];k[t]=h(g,function(f,d){return c(f,d,f.invoke(d,g))})}}var t=Q(d);switch(d){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return b(function(f){return f},
function(f,d,e){return e});case "depth.func":return b(function(f){return w[f]},function(f,d,e){return d.def(f.constants.compareFuncs,"[",e,"]")});case "depth.range":return b(function(f){return f},function(f,d,e){f=d.def("+",e,"[0]");d=d.def("+",e,"[1]");return[f,d]});case "blend.func":return b(function(f){return[c["srcRGB"in f?f.srcRGB:f.src],c["dstRGB"in f?f.dstRGB:f.dst],c["srcAlpha"in f?f.srcAlpha:f.src],c["dstAlpha"in f?f.dstAlpha:f.dst]]},function(f,d,e){function a(f,c){var b=d.def('"',f,c,'" in ',
e,"?",e,".",f,c,":",e,".",f);return d.def(k,"[",b,"]")}var k=f.constants.blendFuncs;f=a("src","RGB");var c=a("src","Alpha"),b=a("dst","RGB"),t=a("dst","Alpha");return[f,b,c,t]});case "blend.equation":return b(function(f){if("string"===typeof f)return[la[f],la[f]];if("object"===typeof f)return[la[f.rgb],la[f.alpha]]},function(f,d,e){var a=f.constants.blendEquations,k=d.def(),c=d.def();f=f.cond("typeof ",e,'==="string"');f.then(k,"=",c,"=",a,"[",e,"];");f["else"](k,"=",a,"[",e,".rgb];",c,"=",a,"[",
e,".alpha];");d(f);return[k,c]});case "blend.color":return b(function(f){return F(4,function(d){return+f[d]})},function(f,d,e){return F(4,function(f){return d.def("+",e,"[",f,"]")})});case "stencil.mask":return b(function(f){return f|0},function(f,d,e){return d.def(e,"|0")});case "stencil.func":return b(function(f){return[w[f.cmp||"keep"],f.ref||0,"mask"in f?f.mask:-1]},function(f,d,e){f=d.def('"cmp" in ',e,"?",f.constants.compareFuncs,"[",e,".cmp]",":",7680);var a=d.def(e,".ref|0");d=d.def('"mask" in ',
e,"?",e,".mask|0:-1");return[f,a,d]});case "stencil.opFront":case "stencil.opBack":return b(function(f){return["stencil.opBack"===d?1029:1028,K[f.fail||"keep"],K[f.zfail||"keep"],K[f.pass||"keep"]]},function(f,e,a){function k(f){return e.def('"',f,'" in ',a,"?",c,"[",a,".",f,"]:",7680)}var c=f.constants.stencilOps;return["stencil.opBack"===d?1029:1028,k("fail"),k("zfail"),k("pass")]});case "polygonOffset.offset":return b(function(f){return[f.factor|0,f.units|0]},function(f,d,e){f=d.def(e,".factor|0");
d=d.def(e,".units|0");return[f,d]});case "cull.face":return b(function(f){var d=0;"front"===f?d=1028:"back"===f&&(d=1029);return d},function(f,d,e){return d.def(e,'==="front"?',1028,":",1029)});case "lineWidth":return b(function(d){return d},function(d,e,a){return a});case "frontFace":return b(function(d){return z[d]},function(d,e,a){return e.def(a+'==="cw"?2304:2305')});case "colorMask":return b(function(d){return d.map(function(d){return!!d})},function(d,e,a){return F(4,function(d){return"!!"+a+
"["+d+"]"})});case "sample.coverage":return b(function(d){return["value"in d?d.value:1,!!d.invert]},function(d,e,a){d=e.def('"value" in ',a,"?+",a,".value:1");e=e.def("!!",a,".invert");return[d,e]})}});return k}function T(d){var e=d["static"],a=d.dynamic,k={};Object.keys(e).forEach(function(d){var a=e[d],c;if("number"===typeof a||"boolean"===typeof a)c=m(function(){return a});else if("function"===typeof a&&"texture"===a._reglType)c=m(function(d){return d.link(a)});else if(Array.isArray(a)||da(a))c=
m(function(d){return d.global.def("[",F(a.length,function(d){return a[d]}),"]")});c.value=a;k[d]=c});Object.keys(a).forEach(function(d){var e=a[d];k[d]=h(e,function(d,f){return d.invoke(f,e)})});return k}function Z(d){var e=d["static"],a=d.dynamic,k={};Object.keys(e).forEach(function(d){var a=e[d],c=p.id(d),f=new oa;if(b(a))f.state=1,f.buffer=W.getBuffer(W.create(a,34962,!1)),f.type=f.buffer.dtype;else{var t=W.getBuffer(a);if(t)f.state=1,f.buffer=t,f.type=t.dtype;else if(a.constant){var h=a.constant;
f.state=2;"number"===typeof h?f.x=h:y.forEach(function(d,e){e<h.length&&(f[d]=h[e])})}else{var t=W.getBuffer(a.buffer),g=a.offset|0,l=a.stride|0,A=a.size|0,n=!!a.normalized,ma=0;"type"in a&&(ma=q[a.type]);a=a.divisor|0;f.buffer=t;f.state=1;f.size=A;f.normalized=n;f.type=ma||t.dtype;f.offset=g;f.stride=l;f.divisor=a}}k[d]=m(function(d,e){var a=d.attribCache;if(c in a)return a[c];var k={isStream:!1};Object.keys(f).forEach(function(d){k[d]=f[d]});f.buffer&&(k.buffer=d.link(f.buffer));return a[c]=k})});
Object.keys(a).forEach(function(d){var e=a[d];k[d]=h(e,function(d,f){function a(d){f(h[d],"=",k,".",d,"|0;")}var k=d.invoke(f,e),c=d.shared,b=c.isBufferArgs,t=c.buffer,h={isStream:f.def(!1)},ba=new oa;ba.state=1;Object.keys(ba).forEach(function(d){h[d]=f.def(""+ba[d])});var g=h.buffer,m=h.type;f("if(",b,"(",k,")){",h.isStream,"=true;",g,"=",t,".createStream(",k,");",m,"=",g,".dtype;","}else{",g,"=",t,".getBuffer(",k,");","if(",g,"){",m,"=",g,".dtype;","}else if(",k,".constant){",h.state,"=",2,";",
y.map(function(d,e){return h[d]+"="+k+".length>="+e+"?"+k+"["+e+"]:0;"}).join(""),"}else{",g,"=",t,".getBuffer(",k,".buffer);",m,'="type" in ',k,"?",c.glTypes,"[",k,".type]:",g,".dtype;",h.normalized,"=!!",k,".normalized;");a("size");a("offset");a("stride");a("divisor");f("}}");return h})});return k}function O(d){var e=d["static"],a=d.dynamic,k={};Object.keys(e).forEach(function(d){var a=e[d];k[d]=m(function(d,e){return"number"===typeof a||"boolean"===typeof a?""+a:d.link(a)})});Object.keys(a).forEach(function(d){var e=
a[d];k[d]=h(e,function(d,f){return d.invoke(f,e)})});return k}function P(d,e,a){var k=d.shared.context,c=d.scope();Object.keys(a).forEach(function(b){e.save(k,"."+b);c(k,".",b,"=",a[b].append(d,e),";")});e(c)}function e(d,e,a){var k=d.shared,c=k.gl,b=k.framebuffer,t;ta&&(t=e.def(k.extensions,".webgl_draw_buffers"));var f=d.constants,k=f.drawBuffers,f=f.backBuffer;d=a?a.append(d,e):e.def(b,".next");e("if(",b,".dirty||",d,"!==",b,".cur){","if(",d,"){",c,".bindFramebuffer(",36160,",",d,".framebuffer);");
ta&&e(t,".drawBuffersWEBGL(",k,"[",d,".colorAttachments.length]);");e("}else{",c,".bindFramebuffer(",36160,",null);");ta&&e(t,".drawBuffersWEBGL(",f,");");e("}",b,".cur=",d,";",b,".dirty=false;","}")}function t(d,e,a){var k=d.shared,c=k.gl,b=d.current,t=d.next,f=k.current,h=k.next,g=d.cond(f,".dirty");qa.forEach(function(e){e=Q(e);if(!(e in a.state)){var k,m;if(e in t){k=t[e];m=b[e];var ba=F(ia[e].length,function(d){return g.def(k,"[",d,"]")});g(d.cond(ba.map(function(d,e){return d+"==="+m+"["+e+
"]"}).join("&&")).then(c,".",ka[e],"(",ba,");",ba.map(function(d,e){return m+"["+e+"]="+d}).join(";"),";"))}else k=g.def(h,".",e),ba=d.cond(k,"!==",f,".",e),g(ba),e in ja?ba(d.cond(k).then(c,".enable(",ja[e],");")["else"](c,".disable(",ja[e],");"),f,".",e,"=",k,";"):ba(c,".",ka[e],"(",k,");",f,".",e,"=",k,";")}});0===Object.keys(a.state).length&&g(f,".dirty=false;");e(g)}function k(d,e,a,k){var c=d.shared,b=d.current,t=c.current,f=c.gl;g(Object.keys(a)).forEach(function(c){var h=a[c];if(!k||k(h)){var g=
h.append(d,e);if(ja[c]){var m=ja[c];l(h)?g?e(f,".enable(",m,");"):e(f,".disable(",m,");"):e(d.cond(g).then(f,".enable(",m,");")["else"](f,".disable(",m,");"));e(t,".",c,"=",g,";")}else if(Array.isArray(g)){var A=b[c];e(f,".",ka[c],"(",g,");",g.map(function(d,e){return A+"["+e+"]="+d}).join(";"),";")}else e(f,".",ka[c],"(",g,");",t,".",c,"=",g,";")}})}function A(d,e){pa&&!d.instancing&&(d.instancing=e.def(d.shared.extensions,".angle_instanced_arrays"))}function ua(d,e,a,k,c){function b(d){switch(d){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function t(a,k,c){function b(){e("if(!",l,".pointer){",g,".enableVertexAttribArray(",m,");",l,".pointer=true;}");var a=c.type,f;f=c.size?e.def(c.size,"||",k):k;e("if(",l,".type!==",a,"||",l,".size!==",f,"||",w.map(function(d){return l+"."+d+"!=="+c[d]}).join("||"),"){",g,".bindBuffer(",34962,",",A,".buffer);",g,".vertexAttribPointer(",[m,f,a,c.normalized,c.stride,c.offset],");",l,".type=",a,";",l,
".size=",f,";",w.map(function(d){return l+"."+d+"="+c[d]+";"}).join(""),"}");pa&&(a=c.divisor,e("if(",l,".divisor!==",a,"){",d.instancing,".vertexAttribDivisorANGLE(",[m,a],");",l,".divisor=",a,";}"))}function h(){e("if(",l,".pointer){",g,".disableVertexAttribArray(",m,");",l,".pointer=false;","}if(",y.map(function(d,e){return l+"."+d+"!=="+n[e]}).join("||"),"){",g,".vertexAttrib4f(",m,",",n,");",y.map(function(d,e){return l+"."+d+"="+n[e]+";"}).join(""),"}")}var g=f.gl,m=e.def(a,".location"),l=e.def(f.attributes,
"[",m,"]");a=c.state;var A=c.buffer,n=[c.x,c.y,c.z,c.w],w=["buffer","normalized","offset","stride"];1===a?b():2===a?h():(e("if(",a,"===",1,"){"),b(),e("}else{"),h(),e("}"))}var f=d.shared;k.forEach(function(f){var k=f.name,h=a.attributes[k],g;if(h){if(!c(h))return;g=h.append(d,e)}else{if(!c(aa))return;var m=d.scopeAttrib(k);g={};Object.keys(new oa).forEach(function(d){g[d]=e.def(m,".",d)})}t(d.link(f),b(f.info.type),g)})}function va(d,e,a,k,c){for(var b=d.shared,t=b.gl,f,h=0;h<k.length;++h){var g=
k[h],m=g.name,l=g.info.type,A=a.uniforms[m],g=d.link(g)+".location";if(A){if(!c(A))continue;if(A["static"]){m=A.value;if(35678===l||35680===l)l=d.link(m._texture),e(t,".uniform1i(",g,l+".bind());"),e.exit(l,".unbind()");else if(35674===l||35675===l||35676===l)m=d.global.def("["+m+"]"),A=2,35675===l?A=3:35676===l&&(A=4),e(t,".uniformMatrix",A,"fv(",g,",false,",m,");");else{switch(l){case 5126:f="1f";break;case 35664:f="2f";break;case 35665:f="3f";break;case 35666:f="4f";break;case 35670:f="1i";break;
case 5124:f="1i";break;case 35671:f="2i";break;case 35667:f="2i";break;case 35672:f="3i";break;case 35668:f="3i";break;case 35673:f="4i";break;case 35669:f="4i"}e(t,".uniform",f,"(",g,",",m,");")}continue}else m=A.append(d,e)}else{if(!c(aa))continue;m=e.def(b.uniforms,"[",p.id(m),"]")}A=",";switch(l){case 35678:case 35680:l=e.def(m,"._texture");e(t,".uniform1i(",g,",",l,".bind());");e.exit(l,".unbind();");continue;case 5124:case 35670:f="1i";break;case 35667:case 35671:f="2iv";break;case 35668:case 35672:f=
"3iv";break;case 35669:case 35673:f="4iv";break;case 5126:f="1f";break;case 35664:f="2fv";break;case 35665:f="3fv";break;case 35666:f="4fv";break;case 35674:f="Matrix2fv";A=",false,";break;case 35675:f="Matrix3fv";A=",false,";break;case 35676:f="Matrix4fv",A=",false,"}e(t,".uniform",f,"(",g,A,m,");")}}function wa(d,e,a,k){function c(f){var k=m[f];return k?k.batchStatic?k.append(d,e):k.append(d,a):e.def(g,".",f)}function b(){function d(){a(u,".drawElementsInstancedANGLE(",[n,q,G,w+"<<(("+G+"-5121)>>1)",
v],");")}function e(){a(u,".drawArraysInstancedANGLE(",[n,w,q,v],");")}A?K?d():(a("if(",A,"){"),d(),a("}else{"),e(),a("}")):e()}function t(){function d(){a(h+".drawElements("+[n,q,G,w+"<<(("+G+"-5121)>>1)"]+");")}function e(){a(h+".drawArrays("+[n,w,q]+");")}A?K?d():(a("if(",A,"){"),d(),a("}else{"),e(),a("}")):e()}var f=d.shared,h=f.gl,g=f.draw,m=k.draw,A=function(){var f=m.elements,k=e;f?(f.batchStatic||(k=a),f=f.append(d,k)):f=k.def(g,".","elements");f&&k("if("+f+")"+h+".bindBuffer(34963,"+f+".buffer.buffer);");
return f}(),n=c("primitive"),w=c("offset"),q=function(){var f=m.count,k=e;f?(f.batchStatic||(k=a),f=f.append(d,k)):f=k.def(g,".","count");return f}();if("number"===typeof q){if(0===q)return}else a("if(",q,"){"),a.exit("}");var v,u;pa&&(v=c("instances"),u=d.instancing);var G=A+".type",K=m.elements&&l(m.elements);pa&&("number"!==typeof v||0<=v)?"string"===typeof v?(a("if(",v,">0){"),b(),a("}else if(",v,"<0){"),t(),a("}")):b():t()}function xa(d,e,a,k,c){e=R();c=e.proc("body",c);pa&&(e.instancing=c.def(e.shared.extensions,
".angle_instanced_arrays"));d(e,c,a,k);return e.compile().body}function Ba(d,e,a,k){A(d,e);ua(d,e,a,k.attributes,function(){return!0});va(d,e,a,k.uniforms,function(){return!0});wa(d,e,e,a)}function Da(d,a){var c=d.proc("draw",1);A(d,c);P(d,c,a.context);e(d,c,a.framebuffer);t(d,c,a);k(d,c,a.state);var b=a.shader.progVar.append(d,c);c(d.shared.gl,".useProgram(",b,".program);");if(a.shader.program)Ba(d,c,a,a.shader.program);else{var h=d.global.def("{}"),g=c.def(b,".id"),m=c.def(h,"[",g,"]");c(d.cond(m).then(m,
".call(this,a0);")["else"](m,"=",h,"[",g,"]=",d.link(function(e){return xa(Ba,d,a,e,1)}),"(",b,");",m,".call(this,a0);"))}0<Object.keys(a.state).length&&c(d.shared.current,".dirty=true;")}function Ea(d,e,a,k){function c(){return!0}d.batchId="a1";A(d,e);ua(d,e,a,k.attributes,c);va(d,e,a,k.uniforms,c);wa(d,e,e,a)}function ya(d,a,c,b){function t(e){return e.contextDep&&g||e.propDep}function h(e){return!t(e)}A(d,a);var g=c.contextDynamic,f=a.def(),m=a.def();d.shared.props=m;d.batchId=f;var l=d.scope(),
n=d.scope();a(l.entry,"for(",f,"=0;",f,"<","a1",";++",f,"){",m,"=","a0","[",f,"];",n,"}",l.exit);c.needsContext&&P(d,n,c.context);c.needsFramebuffer&&e(d,n,c.framebuffer);k(d,n,c.state,t);b?(ua(d,l,c,b.attributes,h),ua(d,n,c,b.attributes,t),va(d,l,c,b.uniforms,h),va(d,n,c,b.uniforms,t),wa(d,l,n,c)):(a=d.global.def("{}"),b=c.shader.progVar.append(d,n),m=n.def(b,".id"),l=n.def(a,"[",m,"]"),n(d.shared.gl,".useProgram(",b,".program);","if(!",l,"){",l,"=",a,"[",m,"]=",d.link(function(e){return xa(Ea,d,
c,e,2)}),"(",b,");}",l,".call(this,a0[",f,"],",f,");"))}function Fa(d,a){var c=d.proc("batch",2);d.batchId="0";A(d,c);var b=!1,h=!0;Object.keys(a.context).forEach(function(e){b=b||a.context[e].propDep});b||(P(d,c,a.context),h=!1);var g=a.framebuffer,m=!1;g&&(g.propDep?b=m=!0:g.contextDep&&b&&(m=!0),m||e(d,c,g));a.state.viewport&&a.state.viewport.propDynamic&&(b=!0);t(d,c,a);k(d,c,a.state,function(e){return!(e.contextDep&&b||e.propDep)});a.contextDep=b;a.needsContext=h;a.needsFramebuffer=m;h=a.shader.progVar;
if(h.contextDep&&b||h.propDep)ya(d,c,a,null);else if(h=h.append(d,c),c(d.shared.gl,".useProgram(",h,".program);"),a.shader.program)ya(d,c,a,a.shader.program);else{var g=d.global.def("{}"),m=c.def(h,".id"),f=c.def(g,"[",m,"]");c(d.cond(f).then(f,".call(this,a0,a1);")["else"](f,"=",g,"[",m,"]=",d.link(function(e){return xa(ya,d,a,e,2)}),"(",h,");",f,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&c(d.shared.current,".dirty=true;")}function Ga(e,a){function k(h){var f=a.shader[h];f&&c.set(b.shader,
"."+h,f.append(e,c))}var c=e.proc("scope",3);e.batchId="a2";var b=e.shared,h=b.current;P(e,c,a.context);a.framebuffer&&a.framebuffer.append(e,c);g(Object.keys(a.state)).forEach(function(k){var f=a.state[k].append(e,c);Array.isArray(f)?f.forEach(function(a,f){c.set(e.next[k],"["+f+"]",a)}):c.set(b.next,"."+k,f)});["elements","offset","count","instances","primitive"].forEach(function(k){var f=a.draw[k];f&&c.set(b.draw,"."+k,""+f.append(e,c))});Object.keys(a.uniforms).forEach(function(k){c.set(b.uniforms,
"["+p.id(k)+"]",a.uniforms[k].append(e,c))});Object.keys(a.attributes).forEach(function(k){var f=a.attributes[k].append(e,c),b=e.scopeAttrib(k);Object.keys(new oa).forEach(function(e){c.set(b,"."+e,f[e])})});k("vert");k("frag");0<Object.keys(a.state).length&&(c(h,".dirty=true;"),c.exit(h,".dirty=true;"));c("a1(",e.shared.context,",a0,0);")}var oa=S.Record,la={add:32774,subtract:32778,"reverse subtract":32779};B.ext_blend_minmax&&(la.min=32775,la.max=32776);var pa=B.angle_instanced_arrays,ta=B.webgl_draw_buffers,
ia={dirty:!0},na={},qa=[],ja={},ka={};E("dither",3024);E("blend.enable",3042);C("blend.color","blendColor",[0,0,0,0]);C("blend.equation","blendEquationSeparate",[32774,32774]);C("blend.func","blendFuncSeparate",[1,0,1,0]);E("depth.enable",2929,!0);C("depth.func","depthFunc",513);C("depth.range","depthRange",[0,1]);C("depth.mask","depthMask",!0);C("colorMask","colorMask",[!0,!0,!0,!0]);E("cull.enable",2884);C("cull.face","cullFace",1029);C("frontFace","frontFace",2305);C("lineWidth","lineWidth",1);
E("polygonOffset.enable",32823);C("polygonOffset.offset","polygonOffset",[0,0]);E("sample.alpha",32926);E("sample.enable",32928);C("sample.coverage","sampleCoverage",[1,!1]);E("stencil.enable",2960);C("stencil.mask","stencilMask",-1);C("stencil.func","stencilFunc",[519,0,-1]);C("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);C("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);E("scissor.enable",3089);C("scissor.box","scissor",[0,0,n.drawingBufferWidth,n.drawingBufferHeight]);
C("viewport","viewport",[0,0,n.drawingBufferWidth,n.drawingBufferHeight]);var za={gl:n,context:N,strings:p,next:na,current:ia,draw:ha,elements:I,buffer:W,shader:Y,attributes:S.state,uniforms:ga,framebuffer:G,extensions:B,isBufferArgs:b},sa={primTypes:u,compareFuncs:w,blendFuncs:c,blendEquations:la,stencilOps:K,glTypes:q,orientationType:z};ta&&(sa.backBuffer=[1029],sa.drawBuffer=F(r.maxDrawbuffers,function(e){return F(e,function(e){return 36064+e})}));var Ca=0;return{next:na,current:ia,procs:function(){var d=
R(),a=d.proc("poll"),k=d.proc("refresh"),c=d.block();a(c);k(c);var b=d.shared,h=b.gl,t=b.next,f=b.current;c(f,".dirty=false;");e(d,a);k(b.framebuffer,".dirty=true;");e(d,k);Object.keys(ja).forEach(function(e){var b=ja[e],g=c.def(t,".",e),m=d.block();m("if(",g,"){",h,".enable(",b,")}else{",h,".disable(",b,")}",f,".",e,"=",g,";");k(m);a("if(",g,"!==",f,".",e,"){",m,"}")});Object.keys(ka).forEach(function(e){var b=ka[e],g=ia[e],m,l,A=d.block();A(h,".",b,"(");Array.isArray(g)?(b=g.length,m=d.global.def(t,
".",e),l=d.global.def(f,".",e),A(F(b,function(e){return m+"["+e+"]"}),");",F(b,function(e){return l+"["+e+"]="+m+"["+e+"];"}).join("")),a("if(",F(b,function(e){return m+"["+e+"]!=="+l+"["+e+"]"}).join("||"),"){",A,"}")):(m=c.def(t,".",e),l=c.def(f,".",e),A(m,");",f,".",e,"=",m,";"),a("if(",m,"!==",l,"){",A,"}"));k(A)});return d.compile()}(),compile:function(e,a,k,c){var b=R(),h;h=ca(e);var t=M(e,h),f=J(e),m=V(e);e=L(e);var g=t.viewport;g&&(m.viewport=g);g=Q("scissor.box");(t=t[g])&&(m[g]=t);t=0<Object.keys(m).length;
h={framebuffer:h,draw:f,shader:e,state:m,dirty:t};h.uniforms=T(k);h.attributes=Z(a);h.context=O(c);Da(b,h);Ga(b,h);Fa(b,h);return b.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":19,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/loop":24}],8:[function(n,p,r){function b(a,b){this.id=l++;this.type=a;this.data=b}function g(a){if(0===a.length)return[];var b=a.charAt(0),l=a.charAt(a.length-1);if(1<a.length&&b===l&&('"'===b||"'"===b))return['"'+a.substr(1,
a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return g(a.substr(0,b.index)).concat(g(b[1])).concat(g(a.substr(b.index+b[0].length)));b=a.split(".");if(1===b.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(l=0;l<b.length;++l)a=a.concat(g(b[l]));return a}function a(a){return"["+g(a).join("][")+"]"}var l=0;p.exports={define:function(g,h){switch(typeof h){case "boolean":case "number":case "string":return new b(g,
a(h+""));case "undefined":return new b(g|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof b},unbox:function(g,h){if(g instanceof b){if(g.type&128)return new b(g.type&-129,a(h))}else if("function"===typeof g)return new b(0,g);return g},accessor:a}},{}],9:[function(n,p,r){var b=n("./util/is-typed-array"),g=n("./util/is-ndarray"),a=n("./constants/primitives.json");p.exports=function(l,m,h){function n(){this.buffer=null;this.primType=4;this.type=this.vertCount=
0}function p(l){function F(h){var c=m.oes_element_index_uint;if(h)if("number"===typeof h)q(h);else{var l=null,n="static";Array.isArray(h)||b(h)||g(h)?l=h:("data"in h&&(l=h.data),"usage"in h&&(n=h.usage));Array.isArray(l)||g(l)&&Array.isArray(l.data)||"type"in h?q({type:h.type||(c?"uint32":"uint16"),usage:n,data:l}):q({usage:n,data:l});if(Array.isArray(l)||b(l))q.dimension=3}else q();c=u.buffer.byteLength;l=0;switch(u.buffer.dtype){case 5121:case 5120:l=5121;break;case 5123:case 5122:l=5123;c>>=1;
break;case 5125:case 5124:l=5125,c>>=2}var n=4,p=u.buffer.dimension;1===p&&(n=0);2===p&&(n=1);3===p&&(n=4);"object"===typeof h&&("primitive"in h&&(n=a[h.primitive]),"count"in h&&(c=h.vertCount|0));u.primType=n;u.vertCount=c;u.type=l;return F}var u=new n,q=h.create(null,34963,!0);u.buffer=q._buffer;F(l);F._reglType="elements";F._elements=u;F.destroy=function(){q.destroy();u.buffer=null};return F}n.prototype.bind=function(){this.buffer.bind()};return{create:p,createStream:function(a){return p({usage:"stream",
data:a})._elements},destroyStream:function(a){h.destroyStream(a.buffer)},getElements:function(a){return"function"===typeof a&&a._elements instanceof n?a._elements:null}}}},{"./constants/primitives.json":6,"./util/is-ndarray":21,"./util/is-typed-array":22}],10:[function(n,p,r){p.exports=function(b){function g(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(g){try{a[g]=
b.getExtension(g)}catch(m){}})}var a={};g();return{extensions:a,refresh:g}}},{}],11:[function(n,p,r){var b=n("./util/values"),g=n("./util/extend");p.exports=function(a,l,m,h,n){function p(a,c,b,h){this.target=a;this.level=c;this.texture=b;this.renderbuffer=h}function r(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function B(a,c){var b=c.width,h=c.height;if(a.texture)var g=a.texture._texture,l=Math.max(1,g.params.width>>a.level),m=Math.max(1,
g.params.height>>a.level),b=b||l,h=h||m;else g=a.renderbuffer._renderbuffer,b=b||g.width,h=h||g.height;g.refCount+=1;c.width=b;c.height=h}function u(c,b){b?b.texture?a.framebufferTexture2D(36160,c,b.target,b.texture._texture.texture,b.level):a.framebufferRenderbuffer(36160,c,36161,b.renderbuffer._renderbuffer.renderbuffer):a.framebufferTexture2D(36160,c,3553,null,0)}function q(a){var c=3553,b=0,h=null,g=null;"object"===typeof a&&("level"in a&&(b=a.level|0),"target"in a&&(c=a.target|0));var l=a._reglType;
"texture"===l?h=a:"renderbuffer"===l&&(g=a,c=36161,b=0);return new p(c,b,h,g)}function y(a){return a&&(a.texture||a.renderbuffer)}function c(){this.id=W++;I[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function w(c){a.isFramebuffer(c.framebuffer)||(c.framebuffer=a.createFramebuffer());z.dirty=!0;a.bindFramebuffer(36160,c.framebuffer);for(var b=
c.colorAttachments,h=0;h<b.length;++h)u(36064+h,b[h]);for(h=b.length;h<m.maxColorAttachments;++h)u(36064+h,null);u(36096,c.depthAttachment);u(36128,c.stencilAttachment);u(33306,c.depthStencilAttachment);l.webgl_draw_buffers&&l.webgl_draw_buffers.drawBuffersWEBGL(fa[b.length]);a.checkFramebufferStatus(36160)}function K(c){c=c.framebuffer;a.isFramebuffer(c)&&a.deleteFramebuffer(c)}var z={current:null,next:null,dirty:!1},aa={rgba:6408},x={rgba4:32854,rgb565:36194,"rgb5 a1":32855};l.ext_srgb&&(x.srgba=
35907);l.ext_color_buffer_half_float&&(x.rgba16f=34842,x.rgb16f=34843);l.webgl_color_buffer_float&&(x.rgba32f=34836);var X=[],ea=[];l.webgl_depth_texture&&(X.push(6402),ea.push(34041));g(g({},aa),x);b(aa);b(x);x=5121;X={uint8:5121};l.oes_texture_half_float&&(x=X["half float"]=36193);l.oes_texture_float&&(x=X["float"]=5126);X.best=x;var fa=function(){for(var a=Array(m.maxDrawbuffers),c=0;c<=m.maxDrawbuffers;++c)for(var b=a[c]=Array(c),h=0;h<c;++h)b[h]=36064+h;return a}(),W=0,I={};return g(z,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof c)?a:null},create:function(b){function g(c){var b,m=c||{},u=c=0;if("shape"in m){var K=m.shape;c=K[0];u=K[1]}else"radius"in m&&(c=u=m.radius),"width"in m&&(c=m.width),"height"in m&&(u=m.height);var z=null,K=!1;if("colorBuffers"in m||"colorBuffer"in m){z=m.colorBuffers||m.colorBuffer;Array.isArray(z)||(z=[z]);l.width=c;l.height=u;z=z.map(q);for(b=0;b<z.length;++b)B(z[b],l);c=l.width;u=l.height}else{var v=!0,x="rgba",I="uint8",M=1,
K=!0;l.width=c=c||a.drawingBufferWidth;l.height=u=u||a.drawingBufferHeight;"format"in m&&(x=m.format,v=x in aa);"type"in m&&(I=m.type);"colorCount"in m&&(M=m.colorCount|0);if(l.ownsColor)for(z=l.colorAttachments;z.length>M;)r(z.pop());else z=[];for(b=0;b<z.length;++b){var L;a:{L=z[b];var J=v,V=x,T=c,X=u;if(L.texture){var O=L.texture;if(J){O({format:V,type:I,width:T,height:X});O._texture.refCount+=1;L=!0;break a}}else if(O=L.renderbuffer,!J){O({format:V,width:T,height:X});O._renderbuffer.refCount+=
1;L=!0;break a}r(L);L=!1}L||(z[b--]=z[z.length-1],z.pop())}for(;z.length<M;)v?z.push(new p(3553,0,h.create({format:x,type:I,width:c,height:u},3553),null)):z.push(new p(36161,0,null,n.create({format:x,width:c,height:u})))}l.width=c;l.height=u;x=v=b=null;I=!1;"depthBuffer"in m&&(b=q(m.depthBuffer));"stencilBuffer"in m&&(v=q(m.stencilBuffer));"depthStencilBuffer"in m&&(x=q(m.depthStencilBuffer));if(b||v||x)B(b||v||x,l);else if(M=!0,J=L=!1,"depth"in m&&(M=!!m.depth),"stencil"in m&&(L=!!m.stencil),"depthTexture"in
m&&(J=!!m.depthTexture),m=l.depthAttachment||l.stencilAttachment||l.depthStencilAttachment,V=null,M||L)I=!0,J?(J=L?"depth stencil":"depth",l.ownsDepthStencil&&m.texture?(m.texture({format:J,width:c,height:u}),m.texture._texture.refCount+=1,V=m):V=new p(3553,0,h.create({format:J,width:c,height:u},3553),null)):(J=M?L?"depth stencil":"depth":"stencil",l.ownsDepthStencil&&m.renderbuffer?(m.renderbuffer({format:J,width:c,height:u}),m.renderbuffer._renderbuffer.refCount+=1,V=m):V=new p(36161,0,null,n.create({format:J,
width:c,height:u}))),M?L?x=V:b=V:v=V;c=l;c.colorAttachments.forEach(r);r(c.depthAttachment);r(c.stencilAttachment);r(c.depthStencilAttachment);l.colorAttachments=z;l.depthAttachment=b;l.stencilAttachment=v;l.depthStencilAttachment=x;l.ownsColor=K;l.ownsDepthStencil=I;g.color=z.map(y);g.depth=y(b);g.stencil=y(v);g.depthStencil=y(x);w(l);g.width=l.width;g.height=l.height;return g}var l=new c;g(b);g._reglType="framebuffer";g._framebuffer=l;g._destroy=function(){K(l)};return g},clear:function(){b(I).forEach(K)},
refresh:function(){b(I).forEach(w)}})}},{"./util/extend":20,"./util/values":28}],12:[function(n,p,r){p.exports=function(b,g){var a=1;g.ext_texture_filter_anisotropic&&(a=b.getParameter(34047));var l=1,m=1;g.webgl_draw_buffers&&(l=b.getParameter(34852),m=b.getParameter(36063));return{colorBits:[b.getParameter(3410),b.getParameter(3411),b.getParameter(3412),b.getParameter(3413)],depthBits:b.getParameter(3414),stencilBits:b.getParameter(3415),subpixelBits:b.getParameter(3408),extensions:Object.keys(g).filter(function(a){return!!g[a]}),
maxAnisotropic:a,maxDrawbuffers:l,maxColorAttachments:m,pointSizeDims:b.getParameter(33901),lineWidthDims:b.getParameter(33902),maxViewportDims:b.getParameter(3386),maxCombinedTextureUnits:b.getParameter(35661),maxCubeMapSize:b.getParameter(34076),maxRenderbufferSize:b.getParameter(34024),maxTextureUnits:b.getParameter(34930),maxTextureSize:b.getParameter(3379),maxAttributes:b.getParameter(34921),maxVertexUniforms:b.getParameter(36347),maxVertexTextureUnits:b.getParameter(35660),maxVaryingVectors:b.getParameter(36348),
maxFragmentUniforms:b.getParameter(36349),glsl:b.getParameter(35724),renderer:b.getParameter(7937),vendor:b.getParameter(7936),version:b.getParameter(7938)}}},{}],13:[function(n,p,r){var b=n("./util/is-typed-array");p.exports=function(g,a,l){return function(m){var h=m||{};b(m)?h={data:h}:2===arguments.length?h={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof m&&(h={});a();var n=h.x||0,p=h.y||0,r=h.width||l.viewportWidth,B=h.height||l.viewportHeight,h=h.data||new Uint8Array(r*B*4);g.pixelStorei(3333,
4);g.readPixels(n,p,r,B,6408,5121,h);return h}}},{"./util/is-typed-array":22}],14:[function(n,p,r){var b=n("./util/values");p.exports=function(g,a,l){function m(){this.id=r++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function h(a){g.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=g.createRenderbuffer());g.bindRenderbuffer(36161,a.renderbuffer);g.renderbufferStorage(36161,a.format,a.width,a.height)}function n(a){var b=a.renderbuffer;g.bindRenderbuffer(36161,
null);g.isRenderbuffer(b)&&g.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete B[a.id]}var p={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};a.ext_srgb&&(p.srgba=35907);a.ext_color_buffer_half_float&&(p.rgba16f=34842,p.rgb16f=34843);a.webgl_color_buffer_float&&(p.rgba32f=34836);var r=0,B={};m.prototype.decRef=function(){0===--this.refCount&&n(this)};return{create:function(a){function b(a){a=a||{};var l=0,m=0;"shape"in a?(m=a.shape,l=m[0]|0,m=
m[1]|0):("radius"in a&&(l=m=a.radius|0),"width"in a&&(l=a.width|0),"height"in a&&(m=a.height|0));b.width=g.width=Math.max(l,1);b.height=g.height=Math.max(m,1);g.format=32854;"format"in a&&(g.format=p[a.format]);h(g);return b}var g=new m;B[g.id]=g;b(a);b._reglType="renderbuffer";b._renderbuffer=g;b.destroy=function(){g.decRef()};return b},refresh:function(){b(B).forEach(h)},clear:function(){b(B).forEach(n)}}}},{"./util/values":28}],15:[function(n,p,r){var b=n("./util/values");p.exports=function(g,
a){function l(a,b,g,h){this.name=a;this.id=b;this.location=g;this.info=h}function m(a,b){for(var g=0;g<a.length;++g)if(a[g].id===b.id){a[g].location=b.location;return}a.push(b)}function h(c,b,h){h=35632===c?r:B;var l=h[b];if(!l){var m=a.str(b),l=g.createShader(c);g.shaderSource(l,m);g.compileShader(l);h[b]=l}return l}function n(a,b){this.id=y++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}function p(c,b){var n,q;n=h(35632,c.fragId);q=h(35633,c.vertId);var u=c.program=
g.createProgram();g.attachShader(u,n);g.attachShader(u,q);g.linkProgram(u);var r=g.getProgramParameter(u,35718),y=c.uniforms;for(n=0;n<r;++n)if(q=g.getActiveUniform(u,n))if(1<q.size)for(var H=0;H<q.size;++H){var F=q.name.replace("[0]","["+H+"]");m(y,new l(F,a.id(F),g.getUniformLocation(u,F),q))}else m(y,new l(q.name,a.id(q.name),g.getUniformLocation(u,q.name),q));r=g.getProgramParameter(u,35721);y=c.attributes;for(n=0;n<r;++n)(q=g.getActiveAttrib(u,n))&&m(y,new l(q.name,a.id(q.name),g.getAttribLocation(u,
q.name),q))}var r={},B={},u={},q=[],y=0;return{clear:function(){var a=g.deleteShader.bind(g);b(r).forEach(a);r={};b(B).forEach(a);B={};q.forEach(function(a){g.deleteProgram(a.program)});q.length=0;u={}},refresh:function(){r={};B={};q.forEach(p)},program:function(a,b,g){var h=u[b];h||(h=u[b]={});var l=h[a];l||(l=new n(b,a),p(l,g),h[a]=l,q.push(l));return l},shader:h,frag:null,vert:null}}},{"./util/values":28}],16:[function(n,p,r){p.exports=function(){var b={"":0},g=[""];return{id:function(a){var l=
b[a];if(l)return l;l=b[a]=g.length;g.push(a);return l},str:function(a){return g[a]}}}},{}],17:[function(n,p,r){function b(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function g(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var g=a[0].length,h=1;h<b;++h)if(!Array.isArray(a[h])||a[h].length!==g)return!1;return!0}function a(a){return Object.prototype.toString.call(a)}function l(b){return"[object HTMLCanvasElement]"===a(b)}function m(b){return"[object CanvasRenderingContext2D]"===
a(b)}var h=n("./util/extend"),H=n("./util/values"),F=n("./util/is-typed-array"),da=n("./util/is-ndarray"),B=n("./util/load-texture"),u=n("./util/to-half-float"),q=n("./util/parse-dds"),y=[9984,9986,9985,9987];p.exports=function(c,n,p,r,aa){function x(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=
this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function X(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ea(a,b){var c,g,h=0,l=0,m=0,n=0,q=0,p=0,u=!1,r=!1,v=!1;for(c=0;c<b.length;++c)g=b[c],n=n||g.width<<g.miplevel,q=q||g.height<<g.miplevel,
h=h||g.type,l=l||g.format,m=m||g.internalformat,p=p||g.channels,u=u||g.needsPoll,r=r||g.needsListeners,g=g.miplevel,v=v||0<g;a.needsPoll=u;a.needsListeners=r;a.width=n;a.height=q;a.format=l;a.internalformat=m;a.type=h;if(3553!==a.target)for(c=0;6>c;++c);c=0<=y.indexOf(a.minFilter);a.genMipmaps=!v&&(a.genMipmaps||c);v=v||a.genMipmaps;a.minFilter||(a.minFilter=v?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)g=b[c],g.channels||(g.channels=p),g.format||(g.format=l),g.internalformat||
(g.internalformat=m),g.type||(g.type=h)}function fa(a){this.id=V++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new X(a);this.pixels=[]}function W(a,b){function c(a,e){var k=e.mipmap,g;if(Array.isArray(k))for(var h=0;h<k.length;++h)g=new x(a),g.parseFlags(b),g.parseFlags(e),g.parse(k[h],h),l.push(g);else g=new x(a),g.parseFlags(b),g.parse(e,0),l.push(g)}var g;G(a);var h=a.params;X.call(h,a.target);var l=a.pixels;l.length=
0;h.parse(b);if(3553===a.target)c(3553,b);else{var m=b.faces||b;if(Array.isArray(m))for(g=0;6>g;++g)c(34069+g,m[g]);else if("string"!==typeof m)for(g=0;6>g;++g)c(34069+g,{})}ea(h,l);h.needsListeners&&v(a);h.needsPoll&&(a.pollId=Z.length,Z.push(a));I(a)}function I(a){c.isTexture(a.texture)||(a.texture=c.createTexture());var b=a.target,k=a.unit;0<=k?(c.activeTexture(33984+k),J=k):c.bindTexture(b,a.texture);for(var b=a.pixels,g=a.params,h=0;h<b.length;++h)b[h].upload(g);g.upload();0>k&&((k=P[J])?c.bindTexture(k.target,
k.texture):(a.unit=J,P[J]=a))}function v(a){function b(a,e,c){var k=q(c);k.pixels.forEach(function(b){var c=new x(k.cube?b.target:a);c.channels=k.channels;c.compressed=k.compressed;c.type=k.type;c.internalformat=k.format;c.format=L[k.format];c.width=b.width;c.height=b.height;c.miplevel=b.miplevel||e;c.data=b.data;h.push(c)})}function c(){for(var k=0;k<h.length;++k){var l=h[k],m=l.image,n=l.video,q=l.xhr;m&&m.complete?(l.width=m.naturalWidth,l.height=m.naturalHeight):n&&2<n.readyState?(l.width=n.width,
l.height=n.height):q&&4===q.readyState&&(h[k]=h[h.length-1],h.pop(),q.removeEventListener("readystatechange",I),b(l.target,l.miplevel,q.response))}ea(g,h);I(a)}var g=a.params,h=a.pixels;h.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){h.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",
c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function G(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((Z[b]=Z[Z.length-1]).id=b,Z.pop(),a.pollId=-1)}function ga(a){var b=a.texture,k=a.unit,g=a.target;0<=k&&(c.activeTexture(33984+k),J=k,c.bindTexture(g,null),P[k]=null);G(a);c.isTexture(b)&&c.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete T[a.id]}var S={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
Y={repeat:10497,clamp:33071,mirror:33648},ha={nearest:9728,linear:9729},N=h({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ha),Q={none:0,browser:37444},E={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},C={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},R={};n.ext_srgb&&(C.srgb=35904,C.srgba=35906);n.oes_texture_float&&(E["float"]=5126);n.oes_texture_half_float&&
(E["half float"]=36193);n.webgl_depth_texture&&(h(C,{depth:6402,"depth stencil":34041}),h(E,{uint16:5123,uint32:5125,"depth stencil":34042}));n.webgl_compressed_texture_s3tc&&h(R,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});n.webgl_compressed_texture_atc&&h(R,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});n.webgl_compressed_texture_pvrtc&&h(R,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});n.webgl_compressed_texture_etc1&&(R["rgb etc1"]=36196);var ca=Array.prototype.slice.call(c.getParameter(34467));Object.keys(R).forEach(function(a){var b=R[a];0<=ca.indexOf(b)&&(C[a]=b)});var M=Object.keys(C);p.textureFormats=M;var L=M.reduce(function(a,b){var c=C[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});h(x.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=Q[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=C[b];b in E&&(this.type=E[b]);b in R&&(this.compressed=!0)}"type"in a&&(this.type=E[a.type]);var b=this.width,c=this.height,g=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(g=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=a.width),
"height"in a&&(c=a.height),"channels"in a&&(g=a.channels));this.width=b|0;this.height=c|0;this.channels=g|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*g,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(e,c){this.miplevel=c;this.width>>=c;this.height>>=c;var k=e;switch(typeof e){case "object":if(!e)return;
this.parseFlags(e);var h=e.data;if("string"===typeof h||h&&(F(h)||b(h)||da(h)||l(h)||m(h)||"[object HTMLImageElement]"===a(h)||"[object HTMLVideoElement]"===a(h)||g(h)))k=e.data;break;case "undefined":return}"string"===typeof k&&(k=B(k,this.crossOrigin));var h=null,n=!1;if(null!==k)if(F(k))this.data=k;else if(b(k))h=k,n=!0;else if(da(k)){Array.isArray(k.data)?(h=k.data,n=!0):this.data=k.data;var q=k.shape;this.width=q[0];this.height=q[1];this.channels=3===q.length?q[2]:1;q=k.stride;this.strideX=k.stride[0];
this.strideY=k.stride[1];this.strideC=3===q.length?k.stride[2]:1;this.offset=k.offset;this.needsTranspose=!0}else if(l(k)||m(k))l(k)?this.canvas=k:this.canvas=k.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===a(k))this.image=k,k.complete?(this.width=k.naturalWidth,this.height=k.naturalHeight):(this.width=this.width||k.naturalWidth,this.height=this.height||k.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===a(k))this.video=k,1<k.readyState?(this.width=k.width,this.height=k.height):(this.width=this.width||k.width,this.height=this.height||k.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===a(k))this.xhr=k,this.needsListeners=!0;else if(g(k)){var n=k[0].length,q=k.length,p=1,v,r,w,y;if(Array.isArray(k[0][0]))for(p=k[0][0].length,h=Array(n*q*p),r=y=0;r<q;++r)for(v=0;v<n;++v)for(w=0;w<p;++w)h[y++]=k[r][v][w];
else for(h=Array(n*q),r=y=0;r<q;++r)for(v=0;v<n;++v)h[y++]=k[r][v];this.width=n;this.height=q;this.channels=p;n=!0}else e.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||aa.viewportWidth)|0,this.height=(this.height||aa.viewportHeight)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=
[6409,6410,6407,6408][(this.channels=this.channels||4)-1]);k=this.internalformat;q=this.format=L[k];if(!this.channels)switch(q){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}q=this.type;5126!==q&&36193!==q&&(q||(q=6402===k?5125:5121));this.type=q;if(n)switch(q){case 5121:this.data=new Uint8Array(h);break;case 5123:this.data=new Uint16Array(h);break;case 5125:this.data=new Uint32Array(h);break;
case 5126:this.data=new Float32Array(h);break;case 36193:this.data=u(h)}if(this.data&&this.needsTranspose){h=this.data;k=this.width;n=this.height;q=this.channels;p=this.strideX;v=this.strideY;r=this.strideC;w=this.offset;y=new h.constructor(k*n*q);for(var z=0,H=0;H<n;++H)for(var x=0;x<k;++x)for(var G=0;G<q;++G)y[z++]=h[v*H+p*x+r*G+w];this.data=y}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){c.pixelStorei(37440,
this.flipY);c.pixelStorei(37441,this.premultiplyAlpha);c.pixelStorei(37443,this.colorSpace);c.pixelStorei(3317,this.unpackAlignment);var b=this.target,k=this.miplevel,g=this.image,h=this.canvas,l=this.video,m=this.data,n=this.internalformat,q=this.format,p=this.type,u=this.width||Math.max(1,a.width>>k);a=this.height||Math.max(1,a.height>>k);l&&2<l.readyState?c.texImage2D(b,k,q,q,p,l):g&&g.complete?c.texImage2D(b,k,q,q,p,g):h?c.texImage2D(b,k,q,q,p,h):this.compressed?c.compressedTexImage2D(b,k,n,u,
a,0,m):this.copy?(r(),c.copyTexImage2D(b,k,q,this.x,this.y,u,a,0)):m?c.texImage2D(b,k,q,u,a,0,q,p,m):c.texImage2D(b,k,q,u||1,a||1,0,q,p,null)}});h(X.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=N[a.min]);"mag"in a&&(this.magFilter=ha[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var g=a.wrap;"string"===typeof g?b=c=Y[g]:Array.isArray(g)&&(b=Y[g[0]],c=Y[g[1]])}else"wrapS"in a&&(b=Y[a.wrapS]),"wrapT"in a&&(c=Y[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=S[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;c.texParameteri(a,10241,this.minFilter);c.texParameteri(a,10240,this.magFilter);c.texParameteri(a,10242,this.wrapS);c.texParameteri(a,10243,this.wrapT);n.ext_texture_filter_anisotropic&&c.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(c.hint(33170,this.mipmapHint),c.generateMipmap(a))}});
var J=0,V=0,T={},Z=[],O=p.maxTextureUnits,P=Array(O).map(function(){return null});h(fa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<O;++b){var g=P[b];if(g){if(0<g.bindCount)continue;g.unit=-1}P[b]=this;a=b;break}this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture);J=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&ga(this)}});return{create:function(a,b){function c(a,e,h,l,m,n){var q=a||{};34067===b&&
6===arguments.length&&(q=[a,e,h,l,m,n]);W(g,q);c.width=g.params.width;c.height=g.params.height;return c}var g=new fa(b);T[g.id]=g;c(a);c._reglType="texture";c._texture=g;c.destroy=function(){g.decRef()};return c},refresh:function(){H(T).forEach(I);for(var a=0;a<O;++a)P[a]=null;J=0;c.activeTexture(33984)},clear:function(){for(var a=0;a<O;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),P[a]=null;c.activeTexture(33984);J=0;H(T).forEach(ga)},poll:function(){Z.forEach(I)},getTexture:function(a){return null}}}},
{"./util/extend":20,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/load-texture":23,"./util/parse-dds":25,"./util/to-half-float":27,"./util/values":28}],18:[function(n,p,r){p.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],19:[function(n,p,r){function b(a){return Array.prototype.slice.call(a)}function g(a){return b(a).join("")}var a=n("./extend");p.exports=function(){function l(){var l=[],m=[];return a(function(){l.push.apply(l,
b(arguments))},{def:function(){var a="v"+h++;m.push(a);0<arguments.length&&(l.push(a,"="),l.push.apply(l,b(arguments)),l.push(";"));return a},toString:function(){return g([0<m.length?"var "+m+";":"",g(l)])}})}function m(){function b(a,c){h(a,c,"=",g.def(a,c),";")}var g=l(),h=l(),c=g.toString,m=h.toString;return a(g,{entry:g,exit:h,save:b,set:function(a,c,h){b(a,c);g(a,c,"=",h,";")},toString:function(){return c()+m()}})}var h=0,n=[],p=[],r=l(),B={};return{global:r,link:function(a){for(var b=0;b<p.length;++b)if(p[b]===
a)return n[b];b="g"+h++;n.push(b);p.push(a);return b},block:l,proc:function(b,h){function l(){var a="a"+c.length;c.push(a);return a}var c=[];h=h||0;for(var n=0;n<h;++n)l();var n=m(),p=n.toString;return B[b]=a(n,{arg:l,toString:function(){return g(["function(",c.join(),"){",p(),"}"])}})},scope:m,cond:function(){var h=g(arguments),l=m(),n=m(),c=l.toString,p=n.toString;return a(l,{then:function(){l.apply(l,b(arguments));return this},"else":function(){n.apply(n,b(arguments));return this},toString:function(){var a=
p();a&&(a="else{"+a+"}");return g(["if(",h,"){",c(),"}",a])}})},compile:function(){var a=['"use strict";',r,"return {"];Object.keys(B).forEach(function(b){a.push('"',b,'":',B[b].toString(),",")});a.push("}");var b=g(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(b)).apply(null,p)}}}},{"./extend":20}],20:[function(n,p,r){p.exports=function(b,g){for(var a=Object.keys(g),l=0;l<a.length;++l)b[a[l]]=g[a[l]];return b}},{}],21:[function(n,p,r){var b=n("./is-typed-array");
p.exports=function(g){return!!g&&"object"===typeof g&&Array.isArray(g.shape)&&Array.isArray(g.stride)&&"number"===typeof g.offset&&g.shape.length===g.stride.length&&(Array.isArray(g.data)||b(g.data))}},{"./is-typed-array":22}],22:[function(n,p,r){var b=n("../constants/arraytypes.json");p.exports=function(g){return Object.prototype.toString.call(g)in b}},{"../constants/arraytypes.json":4}],23:[function(n,p,r){p.exports=function(b,g){if("undefined"!==typeof document){var a;a=(a=/\.(\w+)(\?.*)?$/.exec(b))&&
a[1]?a[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(a))return a=document.createElement("video"),a.autoplay=!0,a.loop=!0,g&&(a.crossOrigin=g),a.src=b,a;if(0<=["dds"].indexOf(a))return a=new XMLHttpRequest,a.responseType="arraybuffer",a.open("GET",b,!0),a.send(),a;a=new Image;g&&(a.crossOrigin=g);a.src=b;return a}return null}},{}],24:[function(n,p,r){p.exports=function(b,g){for(var a=Array(b),l=0;l<b;++l)a[l]=g(l);return a}},
{}],25:[function(n,p,r){p.exports=function(n){function p(a){for(var b=S,c=Y,g=0;g<C;++g){var h=Math.max(1,b+3>>2)*Math.max(1,c+3>>2)*Q;ca.pixels.push({target:a,miplevel:g,width:b,height:c,data:new Uint8Array(n,R,h)});R+=h;b>>=1;c>>=1}}var r=new Int32Array(n),ga=r[z],S=r[x],Y=r[aa],ha=F,N=0,Q=0,E=4;switch(r[fa]){case q:Q=8;ga&u?(E=3,N=a):N=l;break;case y:Q=16;N=m;break;case c:Q=16;N=h;break;case w:Q=8,N=H}var C=1;r[ea]&da&&(C=Math.max(1,r[X]));var R=r[K]+4,ca={width:S,height:Y,channels:E,format:N,
type:ha,compressed:!0,cube:!1,pixels:[]};if(r[W]&B)for(ca.cube=!0,r=0;6>r;++r)p(g+r);else p(b);return ca};var b=3553,g=34069,a=33776,l=33777,m=33778,h=33779,H=36196,F=5121,da=131072,B=512,u=64,q=827611204,y=861165636,c=894720068,w=826496069,K=1,z=2,aa=3,x=4,X=7,ea=20,fa=21,W=28},{}],26:[function(n,p,r){p.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(b){return requestAnimationFrame(b)},cancel:function(b){return cancelAnimationFrame(b)}}:
{next:function(b){setTimeout(b,30)},cancel:clearTimeout}},{}],27:[function(n,p,r){p.exports=function(b){for(var g=new Float32Array(b),g=new Uint32Array(g.buffer),a=new Uint16Array(b.length),l=0;l<b.length;++l)if(isNaN(b[l]))a[l]=65535;else if(Infinity===b[l])a[l]=31744;else if(-Infinity===b[l])a[l]=64512;else{var m=g[l],h=m>>>31<<15,n=(m<<1>>>24)-127,m=m>>13&1023;a[l]=-24>n?h:-14>n?h+(m+1024>>-14-n):15<n?h+31744:h+(n+15<<10)+m}return a}},{}],28:[function(n,p,r){p.exports=function(b){return Object.keys(b).map(function(g){return b[g]})}},
{}],29:[function(n,p,r){function b(b,m){function h(){var g=window.innerWidth,h=window.innerHeight;b!==document.body&&(h=b.getBoundingClientRect(),g=h.right-h.left,h=h.top-h.bottom);n.width=r*g;n.height=r*h;a(n.style,{width:g+"px",height:h+"px"})}var n=document.createElement("canvas"),p=g(n,m);a(n.style,{border:0,margin:0,padding:0,top:0,left:0});b.appendChild(n);b===document.body&&(n.style.position="absolute",a(b.style,{margin:0,padding:0}));var r=+p.options.pixelRatio;window.addEventListener("resize",
h,!1);var B=p.options.onDestroy;p.options=a(a({},p.options),{onDestroy:function(){window.removeEventListener("resize",h);b.removeChild(n);B&&B()}});h();return p}function g(b,g){function h(a){try{return b.getContext(a,n)}catch(g){return null}}var n=g.glOptions||{};return{gl:h("webgl")||h("experimental-webgl")||h("webgl-experimental"),options:a({pixelRatio:window.devicePixelRatio},g)}}var a=n("./util/extend");p.exports=function(l){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:l[0],
options:l[1]||{}};var m=document.body,h=l[1]||{};if("string"===typeof l[0])m=document.querySelector(l[0])||document.body;else if("object"===typeof l[0])if(l[0]instanceof HTMLElement)m=l[0];else{if(l[0]instanceof WebGLRenderingContext)return{gl:l[0],options:a({pixelRatio:1},h)};h=l[0]}return m.nodeName&&"CANVAS"===m.nodeName.toUpperCase()?g(m,h):b(m,h)}},{"./util/extend":20}],30:[function(n,p,r){var b=n("./lib/util/extend"),g=n("./lib/dynamic"),a=n("./lib/util/raf"),l=n("./lib/util/clock"),m=n("./lib/strings"),
h=n("./lib/webgl"),H=n("./lib/extension"),F=n("./lib/limits"),da=n("./lib/buffer"),B=n("./lib/elements"),u=n("./lib/texture"),q=n("./lib/renderbuffer"),y=n("./lib/framebuffer"),c=n("./lib/attribute"),w=n("./lib/shader"),K=n("./lib/read"),z=n("./lib/core");p.exports=function(){function n(){e=a.next(n);E.count+=1;var b=Z.viewport,c=Z.scissor_box;b[0]=b[1]=c[0]=c[1]=0;E.viewportWidth=E.frameBufferWidth=E.drawingBufferWidth=b[2]=c[2]=v.drawingBufferWidth;E.viewportHeight=E.frameBufferWidth=E.drawingBufferHeight=
b[3]=c[3]=v.drawingBufferHeight;b=l();E.deltaTime=(b-ha)/1E3;E.time=(b-Y)/1E3;ha=b;T.procs.refresh();M.poll();for(b=0;b<P.length;++b)(0,P[b])(E,null,0)}function p(){e&&(a.cancel(n),e=0)}function r(a){p();a.preventDefault();if(G.onContextLost)G.onContextLost()}function ea(a){v.getError();ga.refresh();T.procs.refresh();C.refresh();M.refresh();L.refresh();J.refresh();ca.refresh();if(G.onContextRestored)G.onContextRestored();n()}function fa(a){function c(a){var b={},e={};Object.keys(a).forEach(function(c){var h=
a[c];g.isDynamic(h)?e[c]=g.unbox(h,c):b[c]=h});return{dynamic:e,"static":b}}function e(a){for(;r.length<a;)r.push(null);return r}var h=c(a.context||{}),l=c(a.uniforms||{}),m=c(a.attributes||{});a=c(function(a){function c(a){if(a in e){var b=e[a];delete e[a];Object.keys(b).forEach(function(c){e[a+"."+c]=b[c]})}}var e=b({},a);delete e.uniforms;delete e.attributes;delete e.context;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return e}(a));var h=T.compile(a,
m,l,h),n=h.draw,p=h.batch,q=h.scope,r=[];return function(a,b){var c;if("function"===typeof a)return q.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)q.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)q.call(this,a[c],b,c);else return q.call(this,a,b,0);else if("number"===typeof a){if(0<a)return p.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return p.call(this,a,a.length)}else return n.call(this,a)}}function W(){T.procs.poll()}
var I=h(Array.prototype.slice.call(arguments)),v=I.gl,G=I.options,I=m(),ga=H(v),S=ga.extensions,Y=l(),ha=Y,N=v.drawingBufferWidth,Q=v.drawingBufferHeight,E={count:0,deltaTime:0,time:0,viewportWidth:N,viewportHeight:Q,framebufferWidth:N,framebufferHeight:Q,drawingBufferWidth:N,drawingBufferHeight:Q,pixelRatio:G.pixelRatio},N=F(v,S),C=da(v),R=B(v,S,C),Q=c(v,S,N,C,I),ca=w(v,I),M=u(v,S,N,W,E),L=q(v,S,N),J=y(v,S,N,M,L),V=K(v,W,E),T=z(v,I,S,N,C,R,M,J,{},Q,ca,{elements:null,primitive:4,count:-1,offset:0,
instances:-1},E),Z=T.next,O=v.canvas,P=[],e=0;O&&(O.addEventListener("webglcontextlost",r,!1),O.addEventListener("webglcontextrestored",ea,!1));T.procs.refresh();return b(fa,{clear:function(a){var b=0;W();var c=a.color;c&&(v.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(v.clearDepth(+a.depth),b|=256);"stencil"in a&&(v.clearStencil(a.stencil|0),b|=1024);v.clear(b)},prop:g.define.bind(null,1),context:g.define.bind(null,2),"this":g.define.bind(null,3),draw:fa({}),elements:function(a){return R.create(a)},
buffer:function(a){return C.create(a,34962)},texture:function(a){return M.create(a,3553)},cube:function(a){return 6===arguments.length?M.create(Array.prototype.slice.call(arguments),34067):M.create(a,34067)},renderbuffer:function(a){return L.create(a)},framebuffer:function(a){return J.create(a)},framebufferCube:function(a){},attributes:v.getContextAttributes(),frame:function(a){P.push(a);!e&&0<P.length&&n();return{cancel:function(){var b=P.find(function(b){return b===a});0>b||(P.splice(b,1),0>=P.length&&
p())}}},limits:N,read:V,destroy:function(){p();O&&(O.removeEventListener("webglcontextlost",r),O.removeEventListener("webglcontextrestored",ea));ca.clear();J.clear();L.clear();M.clear();C.clear();if(G.onDestroy)G.onDestroy()},_gl:v,_refresh:function(){T.procs.refresh()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":7,"./lib/dynamic":8,"./lib/elements":9,"./lib/extension":10,"./lib/framebuffer":11,"./lib/limits":12,"./lib/read":13,"./lib/renderbuffer":14,"./lib/shader":15,"./lib/strings":16,
"./lib/texture":17,"./lib/util/clock":18,"./lib/util/extend":20,"./lib/util/raf":26,"./lib/webgl":29}]},{},[1]);

        </script>
        </body>
      </html>