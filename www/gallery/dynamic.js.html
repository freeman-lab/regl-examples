<!DOCTYPE html>
      <html>
        <head>
          <title>example/dynamic.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(m,q,n){function l(b,e){if(!q[b]){if(!m[b]){var h="function"==typeof require&&require;if(!e&&h)return h(b,!0);if(p)return p(b,!0);h=Error("Cannot find module '"+b+"'");throw h.code="MODULE_NOT_FOUND",h;}h=q[b]={exports:{}};m[b][0].call(h.exports,function(e){var h=m[b][1][e];return l(h?h:e)},h,h.exports,e$$0,m,q,n)}return q[b].exports}for(var p="function"==typeof require&&require,h=0;h<n.length;h++)l(n[h]);return l})({1:[function(c,m,q){var n=c("../regl")(),l=n({frag:"\n    precision mediump float;\n    uniform vec4 color;\n    void main() {\n      gl_FragColor = color;\n    }",
vert:"\n    precision mediump float;\n    attribute vec2 position;\n    uniform float angle;\n    void main() {\n      gl_Position = vec4(\n        cos(angle) * position.x + sin(angle) * position.y,\n        -sin(angle) * position.x + cos(angle) * position.y, 0, 1);\n    }",attributes:{position:[-1,0,0,-1,1,1]},uniforms:{color:n.prop("color"),angle:function(l){return.01*l.count}},depth:{enable:!1},count:3});n.frame(function(p){p=p.count;n.clear({color:[0,0,0,1]});l({color:[Math.sin(2E-5*p),Math.cos(4E-4*
p),Math.sin(.006*p),1]})})},{"../regl":30}],2:[function(c,m,q){function n(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(l,p,h,b,e){l=h.maxAttributes;p=Array(l);for(h=0;h<l;++h)p[h]=new n;return{Record:n,scope:{},state:p}}},{}],3:[function(c,m,q){function n(b){return H[Object.prototype.toString.call(b)]|0}function l(b,e){for(var h=0;h<e.length;++h)b[h]=e[h]}function p(b,e,h,l,n,a,p){for(var c=
0,U=0;U<h;++U)for(var la=0;la<l;++la)b[c++]=e[n*U+a*la+p]}function h(b,e,h){for(var l=0,n=0;n<e.length;++n)for(var a=e[n],p=0;p<h;++p)b[l++]=a[p]}var b=c("./util/is-typed-array"),e=c("./util/is-ndarray"),x=c("./util/values"),A=c("./util/pool"),H=c("./constants/arraytypes.json"),E=c("./constants/dtypes.json"),t=c("./constants/usage.json");m.exports=function(z){function c(b){this.id=a++;this.buffer=z.createBuffer();this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function C(b,
e,h){b.byteLength=e.byteLength;z.bufferData(b.type,e,h)}function r(a,k,z,c,r){a.usage=z;if(Array.isArray(k))a.dtype=c||5126,0<k.length&&(Array.isArray(k[0])?(a.dimension=k[0].length,c=A.allocType(a.dtype,k.length*a.dimension),h(c,k,a.dimension),C(a,c,z),A.freeType(c)):"number"===typeof k[0]?(a.dimension=r,c=A.allocType(a.dtype,k.length),l(c,k),C(a,c,z),A.freeType(c)):b(k[0])&&(a.dimension=k[0].length,a.dtype=c||n(k[0])||5126,c=A.allocType(a.dtype,k.length*a.dimension),h(c,k,a.dimension),C(a,c,z),
A.freeType(c)));else if(b(k))a.dtype=c||n(k),a.dimension=r,C(a,k,z);else if(e(k)){var D=k.shape,x=k.stride;r=k.offset;var P=0,R=0,M=0,S=0;1===D.length?(P=D[0],R=1,M=x[0],S=0):2===D.length&&(P=D[0],R=D[1],M=x[0],S=x[1]);a.dtype=c||n(k.data)||5126;a.dimension=R;c=A.allocType(a.dtype,P*R);p(c,k.data,P,R,M,S,r);C(a,c,z);A.freeType(c)}}function k(b){var e=b.buffer;z.isBuffer(e)&&z.deleteBuffer(e);b.buffer=null;delete V[b.id]}var a=0,V={};c.prototype.bind=function(){z.bindBuffer(this.type,this.buffer)};
var m=[];return{create:function(a,C,x){function m(a){var h=35044,k=null,l=0,n=0,c=1;Array.isArray(a)||b(a)||e(a)?k=a:"number"===typeof a?l=a|0:a&&("data"in a&&(k=a.data),"usage"in a&&(h=t[a.usage]),"type"in a&&(n=E[a.type]),"dimension"in a&&(c=a.dimension|0),"length"in a&&(l=a.length|0));B.bind();k?r(B,k,h,n,c):(z.bufferData(B.type,l,h),B.dtype=n||5121,B.usage=h,B.dimension=c,B.byteLength=l);return m}var B=new c(C);V[B.id]=B;x||m(a);m._reglType="buffer";m._buffer=B;m.subdata=function(a,k){var c=(k||
0)|0;B.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var r=A.allocType(B.dtype,a.length);l(r,a);z.bufferSubData(B.type,c,r);A.freeType(r)}else if(Array.isArray(a[0])||b(a[0])){var r=a[0].length,C=A.allocType(B.dtype,a.length*r);h(C,a,r);z.bufferSubData(B.type,c,C);A.freeType(C)}}else if(b(a))z.bufferSubData(B.type,c,a);else if(e(a)){var x=a.shape,M=a.stride,V=C=r=0,t=0;1===x.length?(r=x[0],C=1,V=M[0],t=0):2===x.length&&(r=x[0],C=x[1],V=M[0],t=M[1]);x=Array.isArray(a.data)?B.dtype:
n(a.data);x=A.allocType(x,r*C);p(x,a.data,r,C,V,t,a.offset);z.bufferSubData(B.type,c,x);A.freeType(x)}return m};m.destroy=function(){k(B)};return m},createStream:function(a,b){var e=m.pop();e||(e=new c(a),e.buffer=z.createBuffer());e.bind();r(e,b,35040,0,1);return e},destroyStream:function(a){m.push(a)},clear:function(){x(V).forEach(k)},getBuffer:function(a){return a&&a._buffer instanceof c?a._buffer:null},_initBuffer:r}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,
"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/pool":25,"./util/values":28}],4:[function(c,m,q){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(c,m,q){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,
"float":5126,float32:5126}},{}],6:[function(c,m,q){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(c,m,q){m.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(c,m,q){function n(a){return Array.isArray(a)||H(a)||E(a)}function l(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function p(a,b,e,h){this.thisDep=a;this.contextDep=b;this.propDep=e;this.append=
h}function h(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function b(a){return new p(!1,!1,!1,a)}function e(a,b){var e=a.type;return 0===e?(e=a.data.length,new p(!0,1<=e,2<=e,b)):new p(3===e,2===e,1===e,b)}var x=c("./util/codegen"),A=c("./util/loop"),H=c("./util/is-typed-array"),E=c("./util/is-ndarray"),t=c("./constants/primitives.json"),z=c("./constants/dtypes.json"),M=["x","y","z","w"],C={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,
"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},r={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},k={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,
invert:5386},a={cw:2304,ccw:2305},V=new p(!1,!1,!1,function(){});m.exports=function(c,m,E,q,G,N,D,ha,P,R,Y,S,ia){function K(d){return d.replace(".","_")}function I(d,a,b){var e=K(d);y.push(d);u[e]=f[e]=!!b;ma[e]=a}function J(d,a,b){var e=K(d);y.push(d);Array.isArray(b)?(f[e]=b.slice(),u[e]=b.slice()):f[e]=u[e]=b;na[e]=a}function ja(){var d=x(),a=d.link,e=d.global;d.id=X++;d.batchId="0";var b=a(Fa),F=d.shared={props:"a0"};Object.keys(Fa).forEach(function(g){F[g]=e.def(b,".",g)});var v=d.next={},Ha=
d.current={};Object.keys(na).forEach(function(g){Array.isArray(f[g])&&(v[g]=e.def(F.next,".",g),Ha[g]=e.def(F.current,".",g))});var g=d.constants={};Object.keys(Aa).forEach(function(d){g[d]=e.def(JSON.stringify(Aa[d]))});d.invoke=function(g,f){switch(f.type){case 0:var xa=["this",F.context,F.props,d.batchId];return g.def(a(f.data),".call(",xa.slice(0,Math.max(f.data.length+1,4)),")");case 1:return g.def(F.props,f.data);case 2:return g.def(F.context,f.data);case 3:return g.def("this",f.data)}};d.attribCache=
{};var xa={};d.scopeAttrib=function(g){g=m.id(g);if(g in xa)return xa[g];var d=R.scope[g];d||(d=R.scope[g]=new ra);return xa[g]=a(d)};return d}function fa(d){var f=d["static"];d=d.dynamic;if("framebuffer"in f){var a=f.framebuffer;return a?(a=ha.getFramebuffer(a),b(function(d,f){var w=d.link(a),g=d.shared;f.set(g.framebuffer,".next",w);g=g.context;f.set(g,".framebufferWidth",w+".width");f.set(g,".framebufferHeight",w+".height");return w})):b(function(d,f){var a=d.shared;f.set(a.framebuffer,".next",
"null");a=a.context;f.set(a,".framebufferWidth",a+".drawingBufferWidth");f.set(a,".framebufferHeight",a+".drawingBufferHeight");return null})}if("framebuffer"in d){var h=d.framebuffer;return e(h,function(d,f){var a=d.invoke(f,h),g=d.shared,w=g.framebuffer,a=f.def(w,".getFramebuffer(",a,")");f.set(w,".next",a);g=g.context;f.set(g,".framebufferWidth",a+"?"+a+".width:"+g+".drawingBufferWidth");f.set(g,".framebufferHeight",a+"?"+a+".height:"+g+".drawingBufferHeight");return a})}return null}function oa(d,
f){function a(g){if(g in b){var d=b[g];g=!0;var Ga=d.x|0,v=d.y|0,h,za;"w"in d?h=d.w|0:g=!1;"h"in d?za=d.h|0:g=!1;return new p(g&&f&&f.thisDep,g&&f&&f.contextDep,g&&f&&f.propDep,function(g,f){var a=g.shared.context,w=h;"w"in d||(w=f.def(a,".","framebufferWidth","-",Ga));var e=za;"h"in d||(e=f.def(a,".","framebufferHeight","-",v));return[Ga,v,w,e]})}if(g in F){var k=F[g];g=e(k,function(g,d){var f=g.invoke(d,k),a=g.shared.context,w=d.def(f,".x|0"),e=d.def(f,".y|0"),b=d.def('"w" in ',f,"?",f,".w|0:",
"(",a,".","framebufferWidth","-",w,")"),f=d.def('"h" in ',f,"?",f,".h|0:","(",a,".","framebufferHeight","-",e,")");return[w,e,b,f]});f&&(g.thisDep=g.thisDep||f.thisDep,g.contextDep=g.contextDep||f.contextDep,g.propDep=g.propDep||f.prpoDep);return g}return f?new p(f.thisDep,f.contextDep,f.propDep,function(g,d){var f=g.shared.context;return[0,0,d.def(f,".","framebufferWidth"),d.def(f,".","framebufferHeight")]}):null}var b=d["static"],F=d.dynamic,v=a("viewport");if(v)var h=v,v=new p(v.thisDep,v.contextDep,
v.propDep,function(g,d){var f=h.append(g,d),a=g.shared.context;d.set(a,".viewportWidth",f[2]);d.set(a,".viewportHeight",f[3]);return f});return{viewport:v,scissor_box:a("scissor.box")}}function L(d){function f(g){if(g in a){var d=m.id(a[g]);g=b(function(){return d});g.id=d;return g}if(g in k){var w=k[g];return e(w,function(g,d){var f=g.invoke(d,w);return d.def(g.shared.strings,".id(",f,")")})}return null}var a=d["static"],k=d.dynamic,F=f("frag"),v=f("vert"),l=null;h(F)&&h(v)?(l=Y.program(v.id,F.id),
d=b(function(g,d){return g.link(l)})):d=new p(F&&F.thisDep||v&&v.thisDep,F&&F.contextDep||v&&v.contextDep,F&&F.propDep||v&&v.propDep,function(g,d){var f=g.shared.shader,a;a=F?F.append(g,d):d.def(f,".","frag");var w;w=v?v.append(g,d):d.def(f,".","vert");return d.def(f+".program("+w+","+a+")")});return{frag:F,vert:v,progVar:d,program:l}}function ta(d){function f(d,g){if(d in a){var w=a[d]|0;return b(function(d,f){g&&(d.OFFSET=w);return w})}if(d in k){var v=k[d];return e(v,function(d,f){var a=d.invoke(f,
v);g&&(d.OFFSET=a);return a})}return g&&F?b(function(g,d){g.OFFSET="0";return 0}):null}var a=d["static"],k=d.dynamic,F=function(){if("elements"in a){var d=a.elements;n(d)?d=N.getElements(N.create(d)):d&&(d=N.getElements(d));var g=b(function(g,f){if(d){var a=g.link(d);return g.ELEMENTS=a}return g.ELEMENTS=null});g.value=d;return g}if("elements"in k){var f=k.elements;return e(f,function(g,d){var a=g.shared,w=a.isBufferArgs,a=a.elements,e=g.invoke(d,f),b=d.def("null"),w=d.def(w,"(",e,")"),e=g.cond(w).then(b,
"=",a,".createStream(",e,");")["else"](b,"=",a,".getElements(",e,");");d.entry(e);d.exit(g.cond(w).then(a,".destroyStream(",b,");"));return g.ELEMENTS=b})}return null}(),v=f("offset",!0);return{elements:F,primitive:function(){if("primitive"in a){var d=a.primitive;return b(function(g,f){return t[d]})}if("primitive"in k){var g=k.primitive;return e(g,function(d,f){var a=d.constants.primTypes,w=d.invoke(f,g);return f.def(a,"[",w,"]")})}return F?h(F)?F.value?b(function(g,d){return d.def(g.ELEMENTS,".primType")}):
b(function(){return 4}):new p(F.thisDep,F.contextDep,F.propDep,function(g,d){var f=g.ELEMENTS;return d.def(f,"?",f,".primType:",4)}):null}(),count:function(){if("count"in a){var d=a.count|0;return b(function(){return d})}if("count"in k){var g=k.count;return e(g,function(d,f){return d.invoke(f,g)})}return F?h(F)?F?v?new p(v.thisDep,v.contextDep,v.propDep,function(g,d){return d.def(g.ELEMENTS,".vertCount-",g.OFFSET)}):b(function(g,d){return d.def(g.ELEMENTS,".vertCount")}):b(function(){return-1}):new p(F.thisDep||
v.thisDep,F.contextDep||v.contextDep,F.propDep||v.propDep,function(g,d){var f=g.ELEMENTS;return g.OFFSET?d.def(f,"?",f,".vertCount-",g.OFFSET,":-1"):d.def(f,"?",f,".vertCount:-1")}):null}(),instances:f("instances",!1),offset:v}}function Q(d){var f=d["static"],h=d.dynamic,l={};y.forEach(function(d){function v(g,a){if(d in f){var v=g(f[d]);l[y]=b(function(){return v})}else if(d in h){var k=h[d];l[y]=e(k,function(g,d){return a(g,d,g.invoke(d,k))})}}var y=K(d);switch(d){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return v(function(g){return g},
function(g,d,f){return f});case "depth.func":return v(function(g){return r[g]},function(g,d,f){return d.def(g.constants.compareFuncs,"[",f,"]")});case "depth.range":return v(function(g){return g},function(g,d,f){g=d.def("+",f,"[0]");d=d.def("+",f,"[1]");return[g,d]});case "blend.func":return v(function(d){return[C["srcRGB"in d?d.srcRGB:d.src],C["dstRGB"in d?d.dstRGB:d.dst],C["srcAlpha"in d?d.srcAlpha:d.src],C["dstAlpha"in d?d.dstAlpha:d.dst]]},function(d,f,a){function w(d,g){var b=f.def('"',d,g,'" in ',
a,"?",a,".",d,g,":",a,".",d);return f.def(e,"[",b,"]")}var e=d.constants.blendFuncs;d=w("src","RGB");var b=w("src","Alpha"),v=w("dst","RGB"),k=w("dst","Alpha");return[d,v,b,k]});case "blend.equation":return v(function(d){if("string"===typeof d)return[Z[d],Z[d]];if("object"===typeof d)return[Z[d.rgb],Z[d.alpha]]},function(d,f,a){var w=d.constants.blendEquations,e=f.def(),b=f.def();d=d.cond("typeof ",a,'==="string"');d.then(e,"=",b,"=",w,"[",a,"];");d["else"](e,"=",w,"[",a,".rgb];",b,"=",w,"[",a,".alpha];");
f(d);return[e,b]});case "blend.color":return v(function(d){return A(4,function(f){return+d[f]})},function(d,f,a){return A(4,function(d){return f.def("+",a,"[",d,"]")})});case "stencil.mask":return v(function(d){return d|0},function(d,f,a){return f.def(a,"|0")});case "stencil.func":return v(function(d){return[r[d.cmp||"keep"],d.ref||0,"mask"in d?d.mask:-1]},function(d,f,a){d=f.def('"cmp" in ',a,"?",d.constants.compareFuncs,"[",a,".cmp]",":",7680);var w=f.def(a,".ref|0");f=f.def('"mask" in ',a,"?",
a,".mask|0:-1");return[d,w,f]});case "stencil.opFront":case "stencil.opBack":return v(function(f){return["stencil.opBack"===d?1029:1028,k[f.fail||"keep"],k[f.zfail||"keep"],k[f.pass||"keep"]]},function(f,a,w){function e(d){return a.def('"',d,'" in ',w,"?",b,"[",w,".",d,"]:",7680)}var b=f.constants.stencilOps;return["stencil.opBack"===d?1029:1028,e("fail"),e("zfail"),e("pass")]});case "polygonOffset.offset":return v(function(d){return[d.factor|0,d.units|0]},function(d,f,a){d=f.def(a,".factor|0");f=
f.def(a,".units|0");return[d,f]});case "cull.face":return v(function(d){var f=0;"front"===d?f=1028:"back"===d&&(f=1029);return f},function(d,f,a){return f.def(a,'==="front"?',1028,":",1029)});case "lineWidth":return v(function(d){return d},function(d,f,a){return a});case "frontFace":return v(function(d){return a[d]},function(d,f,a){return f.def(a+'==="cw"?2304:2305')});case "colorMask":return v(function(d){return d.map(function(d){return!!d})},function(d,f,a){return A(4,function(d){return"!!"+a+"["+
d+"]"})});case "sample.coverage":return v(function(d){return["value"in d?d.value:1,!!d.invert]},function(d,f,a){d=f.def('"value" in ',a,"?+",a,".value:1");f=f.def("!!",a,".invert");return[d,f]})}});return l}function pa(d){var f=d["static"],a=d.dynamic,k={};Object.keys(f).forEach(function(d){var a=f[d],e;if("number"===typeof a||"boolean"===typeof a)e=b(function(){return a});else if("function"===typeof a&&("texture2d"===a._reglType||"textureCube"===a._reglTYpe))e=b(function(d){return d.link(a)});else if(Array.isArray(a)||
H(a))e=b(function(d){return d.global.def("[",A(a.length,function(d){return a[d]}),"]")});e.value=a;k[d]=e});Object.keys(a).forEach(function(d){var f=a[d];k[d]=e(f,function(d,a){return d.invoke(a,f)})});return k}function T(d){var f=d["static"],a=d.dynamic,k={};Object.keys(f).forEach(function(d){var a=f[d],e=m.id(d),g=new ra;if(n(a))g.state=1,g.buffer=G.getBuffer(G.create(a,34962,!1)),g.type=g.buffer.dtype;else{var h=G.getBuffer(a);if(h)g.state=1,g.buffer=h,g.type=h.dtype;else if(a.constant){var l=
a.constant;g.state=2;"number"===typeof l?g.x=l:M.forEach(function(d,f){f<l.length&&(g[d]=l[f])})}else{var h=G.getBuffer(a.buffer),y=a.offset|0,u=a.stride|0,c=a.size|0,za=!!a.normalized,p=0;"type"in a&&(p=z[a.type]);a=a.divisor|0;g.buffer=h;g.state=1;g.size=c;g.normalized=za;g.type=p||h.dtype;g.offset=y;g.stride=u;g.divisor=a}}k[d]=b(function(d,f){var a=d.attribCache;if(e in a)return a[e];var w={isStream:!1};Object.keys(g).forEach(function(d){w[d]=g[d]});g.buffer&&(w.buffer=d.link(g.buffer));return a[e]=
w})});Object.keys(a).forEach(function(d){var f=a[d];k[d]=e(f,function(d,a){function w(d){a(l[d],"=",e,".",d,"|0;")}var e=d.invoke(a,f),b=d.shared,k=b.isBufferArgs,h=b.buffer,l={isStream:a.def(!1)},y=new ra;y.state=1;Object.keys(y).forEach(function(d){l[d]=a.def(""+y[d])});var u=l.buffer,c=l.type;a("if(",k,"(",e,")){",l.isStream,"=true;",u,"=",h,".createStream(",34962,",",e,");",c,"=",u,".dtype;","}else{",u,"=",h,".getBuffer(",e,");","if(",u,"){",c,"=",u,".dtype;","}else if(",e,".constant){",l.state,
"=",2,";",M.map(function(d,f){return l[d]+"="+e+".length>="+f+"?"+e+"["+f+"]:0;"}).join(""),"}else{",u,"=",h,".getBuffer(",e,".buffer);",c,'="type" in ',e,"?",b.glTypes,"[",e,".type]:",u,".dtype;",l.normalized,"=!!",e,".normalized;");w("size");w("offset");w("stride");w("divisor");a("}}");return l})});return k}function O(d){var f=d["static"],a=d.dynamic,k={};Object.keys(f).forEach(function(d){var a=f[d];k[d]=b(function(d,f){return"number"===typeof a||"boolean"===typeof a?""+a:d.link(a)})});Object.keys(a).forEach(function(d){var f=
a[d];k[d]=e(f,function(d,a){return d.invoke(a,f)})});return k}function W(d,f,a){var e=d.shared.context,b=d.scope();Object.keys(a).forEach(function(k){f.save(e,"."+k);b(e,".",k,"=",a[k].append(d,f),";")});f(b)}function ba(d,f,a){var e=d.shared,b=e.gl,k=e.framebuffer,h;ga&&(h=f.def(e.extensions,".webgl_draw_buffers"));var g=d.constants,e=g.drawBuffer,g=g.backBuffer;d=a?a.append(d,f):f.def(k,".next");f("if(",k,".dirty||",d,"!==",k,".cur){","if(",d,"){",b,".bindFramebuffer(",36160,",",d,".framebuffer);");
ga&&f(h,".drawBuffersWEBGL(",e,"[",d,".colorAttachments.length]);");f("}else{",b,".bindFramebuffer(",36160,",null);");ga&&f(h,".drawBuffersWEBGL(",g,");");f("}",k,".cur=",d,";",k,".dirty=false;","}")}function qa(d,a,e){var b=d.shared,k=b.gl,h=d.current,l=d.next,g=b.current,u=b.next,c=d.cond(g,".dirty");y.forEach(function(a){a=K(a);if(!(a in e.state)){var b,w;if(a in l){b=l[a];w=h[a];var y=A(f[a].length,function(d){return c.def(b,"[",d,"]")});c(d.cond(y.map(function(d,f){return d+"==="+w+"["+f+"]"}).join("&&")).then(k,
".",na[a],"(",y,");",y.map(function(d,f){return w+"["+f+"]="+d}).join(";"),";"))}else b=c.def(u,".",a),y=d.cond(b,"!==",g,".",a),c(y),a in ma?y(d.cond(b).then(k,".enable(",ma[a],");")["else"](k,".disable(",ma[a],");"),g,".",a,"=",b,";"):y(k,".",na[a],"(",b,");",g,".",a,"=",b,";")}});0===Object.keys(e.state).length&&c(g,".dirty=false;");a(c)}function ua(d,f,a,e){var b=d.shared,k=d.current,y=b.current,g=b.gl;l(Object.keys(a)).forEach(function(b){var l=a[b];if(!e||e(l)){var c=l.append(d,f);if(ma[b]){var u=
ma[b];h(l)?c?f(g,".enable(",u,");"):f(g,".disable(",u,");"):f(d.cond(c).then(g,".enable(",u,");")["else"](g,".disable(",u,");"));f(y,".",b,"=",c,";")}else if(Array.isArray(c)){var n=k[b];f(g,".",na[b],"(",c,");",c.map(function(d,f){return n+"["+f+"]="+d}).join(";"),";")}else f(g,".",na[b],"(",c,");",y,".",b,"=",c,";")}})}function sa(d,f){ka&&!d.instancing&&(d.instancing=f.def(d.shared.extensions,".angle_instanced_arrays"))}function va(d,f,a,e,b){function k(d){switch(d){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function h(a,e,b){function k(){f("if(!",u,".pointer){",c,".enableVertexAttribArray(",y,");",u,".pointer=true;}");var a=b.type,g;g=b.size?f.def(b.size,"||",e):e;f("if(",u,".type!==",a,"||",u,".size!==",g,"||",p.map(function(d){return u+"."+d+"!=="+b[d]}).join("||"),"){",c,".bindBuffer(",34962,",",n,".buffer);",c,".vertexAttribPointer(",[y,g,a,b.normalized,b.stride,b.offset],");",u,".type=",a,";",u,
".size=",g,";",p.map(function(d){return u+"."+d+"="+b[d]+";"}).join(""),"}");ka&&(a=b.divisor,f("if(",u,".divisor!==",a,"){",d.instancing,".vertexAttribDivisorANGLE(",[y,a],");",u,".divisor=",a,";}"))}function l(){f("if(",u,".pointer){",c,".disableVertexAttribArray(",y,");",u,".pointer=false;","}if(",M.map(function(d,f){return u+"."+d+"!=="+v[f]}).join("||"),"){",c,".vertexAttrib4f(",y,",",v,");",M.map(function(d,f){return u+"."+d+"="+v[f]+";"}).join(""),"}")}var c=g.gl,y=f.def(a,".location"),u=f.def(g.attributes,
"[",y,"]");a=b.state;var n=b.buffer,v=[b.x,b.y,b.z,b.w],p=["buffer","normalized","offset","stride"];1===a?k():2===a?l():(f("if(",a,"===",1,"){"),k(),f("}else{"),l(),f("}"))}var g=d.shared;e.forEach(function(g){var e=g.name,l=a.attributes[e],u;if(l){if(!b(l))return;u=l.append(d,f)}else{if(!b(V))return;var c=d.scopeAttrib(e);u={};Object.keys(new ra).forEach(function(d){u[d]=f.def(c,".",d)})}h(d.link(g),k(g.info.type),u)})}function aa(d,f,a,b,e){for(var k=d.shared,h=k.gl,g,l=0;l<b.length;++l){var u=
b[l],c=u.name,y=u.info.type,n=a.uniforms[c],u=d.link(u)+".location";if(n){if(!e(n))continue;if(n["static"]){c=n.value;if(35678===y||35680===y)y=d.link(c._texture),f(h,".uniform1i(",u,y+".bind());"),f.exit(y,".unbind()");else if(35674===y||35675===y||35676===y)c=d.global.def("["+c+"]"),n=2,35675===y?n=3:35676===y&&(n=4),f(h,".uniformMatrix",n,"fv(",u,",false,",c,");");else{switch(y){case 5126:g="1f";break;case 35664:g="2f";break;case 35665:g="3f";break;case 35666:g="4f";break;case 35670:g="1i";break;
case 5124:g="1i";break;case 35671:g="2i";break;case 35667:g="2i";break;case 35672:g="3i";break;case 35668:g="3i";break;case 35673:g="4i";break;case 35669:g="4i"}f(h,".uniform",g,"(",u,",",c,");")}continue}else c=n.append(d,f)}else{if(!e(V))continue;c=f.def(k.uniforms,"[",m.id(c),"]")}n=",";switch(y){case 35678:case 35680:y=f.def(c,"._texture");f(h,".uniform1i(",u,",",y,".bind());");f.exit(y,".unbind();");continue;case 5124:case 35670:g="1i";break;case 35667:case 35671:g="2iv";break;case 35668:case 35672:g=
"3iv";break;case 35669:case 35673:g="4iv";break;case 5126:g="1f";break;case 35664:g="2fv";break;case 35665:g="3fv";break;case 35666:g="4fv";break;case 35674:g="Matrix2fv";n=",false,";break;case 35675:g="Matrix3fv";n=",false,";break;case 35676:g="Matrix4fv",n=",false,"}f(h,".uniform",g,"(",u,n,c,");")}}function ca(d,f,a,b){function e(g){var b=c[g];return b?b.batchStatic?b.append(d,f):b.append(d,a):f.def(y,".",g)}function k(){function d(){a(D,".drawElementsInstancedANGLE(",[p,r,C,z+"<<(("+C+"-5121)>>1)",
x],");")}function f(){a(D,".drawArraysInstancedANGLE(",[p,z,r,x],");")}n?m?d():(a("if(",n,"){"),d(),a("}else{"),f(),a("}")):f()}function u(){function d(){a(l+".drawElements("+[p,r,C,z+"<<(("+C+"-5121)>>1)"]+");")}function f(){a(l+".drawArrays("+[p,z,r]+");")}n?m?d():(a("if(",n,"){"),d(),a("}else{"),f(),a("}")):f()}var g=d.shared,l=g.gl,y=g.draw,c=b.draw,n=function(){var g=c.elements,b=f;g?(g.batchStatic||(b=a),g=g.append(d,b)):g=b.def(y,".","elements");g&&b("if("+g+")"+l+".bindBuffer(34963,"+g+".buffer.buffer);");
return g}(),p=e("primitive"),z=e("offset"),r=function(){var g=c.count,b=f;g?(g.batchStatic||(b=a),g=g.append(d,b)):g=b.def(y,".","count");return g}();if("number"===typeof r){if(0===r)return}else a("if(",r,"){"),a.exit("}");var x,D;ka&&(x=e("instances"),D=d.instancing);var C=n+".type",m=c.elements&&h(c.elements);ka&&("number"!==typeof x||0<=x)?"string"===typeof x?(a("if(",x,">0){"),k(),a("}else if(",x,"<0){"),u(),a("}")):k():u()}function da(d,f,a,b,e){f=ja();e=f.proc("body",e);ka&&(f.instancing=e.def(f.shared.extensions,
".angle_instanced_arrays"));d(f,e,a,b);return f.compile().body}function Ba(d,f,a,b){sa(d,f);va(d,f,a,b.attributes,function(){return!0});aa(d,f,a,b.uniforms,function(){return!0});ca(d,f,f,a)}function Ca(d,f){var a=d.proc("draw",1);sa(d,a);W(d,a,f.context);ba(d,a,f.framebuffer);qa(d,a,f);ua(d,a,f.state);var b=f.shader.progVar.append(d,a);a(d.shared.gl,".useProgram(",b,".program);");if(f.shader.program)Ba(d,a,f,f.shader.program);else{var e=d.global.def("{}"),k=a.def(b,".id"),u=a.def(e,"[",k,"]");a(d.cond(u).then(u,
".call(this,a0);")["else"](u,"=",e,"[",k,"]=",d.link(function(a){return da(Ba,d,f,a,1)}),"(",b,");",u,".call(this,a0);"))}0<Object.keys(f.state).length&&a(d.shared.current,".dirty=true;")}function Ea(d,f,a,b){function e(){return!0}d.batchId="a1";sa(d,f);va(d,f,a,b.attributes,e);aa(d,f,a,b.uniforms,e);ca(d,f,f,a)}function wa(d,f,a,b){function e(d){return d.contextDep&&u||d.propDep}function k(d){return!e(d)}sa(d,f);var u=a.contextDynamic,g=f.def(),h=f.def();d.shared.props=h;d.batchId=g;var l=d.scope(),
c=d.scope();f(l.entry,"for(",g,"=0;",g,"<","a1",";++",g,"){",h,"=","a0","[",g,"];",c,"}",l.exit);a.needsContext&&W(d,c,a.context);a.needsFramebuffer&&ba(d,c,a.framebuffer);ua(d,c,a.state,e);b?(va(d,l,a,b.attributes,k),va(d,c,a,b.attributes,e),aa(d,l,a,b.uniforms,k),aa(d,c,a,b.uniforms,e),ca(d,l,c,a)):(f=d.global.def("{}"),b=a.shader.progVar.append(d,c),h=c.def(b,".id"),l=c.def(f,"[",h,"]"),c(d.shared.gl,".useProgram(",b,".program);","if(!",l,"){",l,"=",f,"[",h,"]=",d.link(function(f){return da(Ea,
d,a,f,2)}),"(",b,");}",l,".call(this,a0[",g,"],",g,");"))}function Da(d,f){var a=d.proc("batch",2);d.batchId="0";sa(d,a);var b=!1,e=!0;Object.keys(f.context).forEach(function(d){b=b||f.context[d].propDep});b||(W(d,a,f.context),e=!1);var k=f.framebuffer,c=!1;k&&(k.propDep?b=c=!0:k.contextDep&&b&&(c=!0),c||ba(d,a,k));f.state.viewport&&f.state.viewport.propDynamic&&(b=!0);qa(d,a,f);ua(d,a,f.state,function(d){return!(d.contextDep&&b||d.propDep)});f.contextDep=b;f.needsContext=e;f.needsFramebuffer=c;e=
f.shader.progVar;if(e.contextDep&&b||e.propDep)wa(d,a,f,null);else if(e=e.append(d,a),a(d.shared.gl,".useProgram(",e,".program);"),f.shader.program)wa(d,a,f,f.shader.program);else{var k=d.global.def("{}"),c=a.def(e,".id"),g=a.def(k,"[",c,"]");a(d.cond(g).then(g,".call(this,a0,a1);")["else"](g,"=",k,"[",c,"]=",d.link(function(a){return da(wa,d,f,a,2)}),"(",e,");",g,".call(this,a0,a1);"))}0<Object.keys(f.state).length&&a(d.shared.current,".dirty=true;")}function ya(d,f){function a(k){var g=f.shader[k];
g&&b.set(e.shader,"."+k,g.append(d,b))}var b=d.proc("scope",3);d.batchId="a2";var e=d.shared,k=e.current;W(d,b,f.context);f.framebuffer&&f.framebuffer.append(d,b);l(Object.keys(f.state)).forEach(function(a){var g=f.state[a].append(d,b);Array.isArray(g)?g.forEach(function(f,g){b.set(d.next[a],"["+g+"]",f)}):b.set(e.next,"."+a,g)});["elements","offset","count","instances","primitive"].forEach(function(a){var g=f.draw[a];g&&b.set(e.draw,"."+a,""+g.append(d,b))});Object.keys(f.uniforms).forEach(function(a){b.set(e.uniforms,
"["+m.id(a)+"]",f.uniforms[a].append(d,b))});Object.keys(f.attributes).forEach(function(a){var g=f.attributes[a].append(d,b),e=d.scopeAttrib(a);Object.keys(new ra).forEach(function(d){b.set(e,"."+d,g[d])})});a("vert");a("frag");0<Object.keys(f.state).length&&(b(k,".dirty=true;"),b.exit(k,".dirty=true;"));b("a1(",d.shared.context,",a0,0);")}var ra=R.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};E.ext_blend_minmax&&(Z.min=32775,Z.max=32776);var ka=E.angle_instanced_arrays,ga=E.webgl_draw_buffers,
f={dirty:!0},u={},y=[],ma={},na={};I("dither",3024);I("blend.enable",3042);J("blend.color","blendColor",[0,0,0,0]);J("blend.equation","blendEquationSeparate",[32774,32774]);J("blend.func","blendFuncSeparate",[1,0,1,0]);I("depth.enable",2929,!0);J("depth.func","depthFunc",513);J("depth.range","depthRange",[0,1]);J("depth.mask","depthMask",!0);J("colorMask","colorMask",[!0,!0,!0,!0]);I("cull.enable",2884);J("cull.face","cullFace",1029);J("frontFace","frontFace",2305);J("lineWidth","lineWidth",1);I("polygonOffset.enable",
32823);J("polygonOffset.offset","polygonOffset",[0,0]);I("sample.alpha",32926);I("sample.enable",32928);J("sample.coverage","sampleCoverage",[1,!1]);I("stencil.enable",2960);J("stencil.mask","stencilMask",-1);J("stencil.func","stencilFunc",[519,0,-1]);J("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);J("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);I("scissor.enable",3089);J("scissor.box","scissor",[0,0,c.drawingBufferWidth,c.drawingBufferHeight]);J("viewport","viewport",
[0,0,c.drawingBufferWidth,c.drawingBufferHeight]);var Fa={gl:c,context:ia,strings:m,next:u,current:f,draw:S,elements:N,buffer:G,shader:Y,attributes:R.state,uniforms:P,framebuffer:ha,extensions:E,isBufferArgs:n},Aa={primTypes:t,compareFuncs:r,blendFuncs:C,blendEquations:Z,stencilOps:k,glTypes:z,orientationType:a};ga&&(Aa.backBuffer=[1029],Aa.drawBuffer=A(q.maxDrawbuffers,function(d){return 0===d?[0]:A(d,function(d){return 36064+d})}));var X=0;return{next:u,current:f,procs:function(){var d=ja(),a=d.proc("poll"),
b=d.proc("refresh"),e=d.block();a(e);b(e);var k=d.shared,c=k.gl,l=k.next,g=k.current;e(g,".dirty=false;");ba(d,a);b(k.framebuffer,".dirty=true;");ba(d,b);Object.keys(ma).forEach(function(f){var k=ma[f],u=e.def(l,".",f),h=d.block();h("if(",u,"){",c,".enable(",k,")}else{",c,".disable(",k,")}",g,".",f,"=",u,";");b(h);a("if(",u,"!==",g,".",f,"){",h,"}")});Object.keys(na).forEach(function(k){var u=na[k],h=f[k],y,n,p=d.block();p(c,".",u,"(");Array.isArray(h)?(u=h.length,y=d.global.def(l,".",k),n=d.global.def(g,
".",k),p(A(u,function(d){return y+"["+d+"]"}),");",A(u,function(d){return n+"["+d+"]="+y+"["+d+"];"}).join("")),a("if(",A(u,function(d){return y+"["+d+"]!=="+n+"["+d+"]"}).join("||"),"){",p,"}")):(y=e.def(l,".",k),n=e.def(g,".",k),p(y,");",g,".",k,"=",y,";"),a("if(",y,"!==",n,"){",p,"}"));b(p)});return d.compile()}(),compile:function(d,f,a,b){var e=ja(),k;k=fa(d);var c=oa(d,k),g=ta(d),u=Q(d);d=L(d);var l=c.viewport;l&&(u.viewport=l);l=K("scissor.box");(c=c[l])&&(u[l]=c);c=0<Object.keys(u).length;
k={framebuffer:k,draw:g,shader:d,state:u,dirty:c};k.uniforms=pa(a);k.attributes=T(f);k.context=O(b);Ca(e,k);ya(e,k);Da(e,k);return e.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":20,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/loop":24}],9:[function(c,m,q){function n(b,e){this.id=h++;this.type=b;this.data=e}function l(b){if(0===b.length)return[];var e=b.charAt(0),c=b.charAt(b.length-1);if(1<b.length&&e===c&&('"'===e||"'"===e))return['"'+b.substr(1,
b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return l(b.substr(0,e.index)).concat(l(e[1])).concat(l(b.substr(e.index+e[0].length)));e=b.split(".");if(1===e.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(c=0;c<e.length;++c)b=b.concat(l(e[c]));return b}function p(b){return"["+l(b).join("][")+"]"}var h=0;m.exports={define:function(b,e){switch(typeof e){case "boolean":case "number":case "string":return new n(b,
p(e+""));case "undefined":return new n(b|128,null)}},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof n},unbox:function(b,e){if(b instanceof n){if(b.type&128)return new n(b.type&-129,p(e))}else if("function"===typeof b)return new n(0,b);return b},accessor:p}},{}],10:[function(c,m,q){var n=c("./util/is-typed-array"),l=c("./util/is-ndarray"),p=c("./constants/primitives.json"),h=c("./constants/usage.json");m.exports=function(b,e,c){function m(b){this.buffer=b;this.primType=
4;this.type=this.vertCount=0}function H(b,h,p,r,k,a,m){(a=m)||n(h)&&(!l(h)||n(h.data))||(a=e.oes_element_index_uint?5125:5123);b.buffer.bind();c._initBuffer(b.buffer,h,p,a,3);h=m;if(!m){switch(b.buffer.dtype){case 5121:case 5120:h=5121;break;case 5123:case 5122:h=5123;break;case 5125:case 5124:h=5125}b.buffer.dtype=h}b.type=h;0>k&&(k=b.buffer.byteLength,5123===h?k>>=1:5125===h&&(k>>=2));b.vertCount=k;k=r;0>r&&(k=4,r=b.buffer.dimension,1===r&&(k=0),2===r&&(k=1),3===r&&(k=4));b.primType=k}var E={uint8:5121,
uint16:5123};e.oes_element_index_uint&&(E.uint32=5125);m.prototype.bind=function(){this.buffer.bind()};var t=[];return{create:function(e){function t(e){if(e)if("number"===typeof e)C(e),r.primType=4,r.vertCount=e|0,r.type=5121;else{var a=null,c=35044,z=-1,m=-1,x=0,A=0;Array.isArray(e)||n(e)||l(e)?a=e:("data"in e&&(a=e.data),"usage"in e&&(c=h[e.usage]),"primitive"in e&&(z=p[e.primitive]),"count"in e&&(m=e.count|0),"length"in e&&(x=e.length|0),"type"in e&&(A=E[e.type]));a?H(r,a,c,z,m,x,A):(e=r.buffer,
e.bind(),b.bufferData(34963,x,c),e.dtype=A||5121,e.usage=c,e.dimension=3,e.byteLength=x,r.primType=0>z?4:z,r.vertCount=0>m?0:m,r.type=e.dtype)}else C(),r.primType=4,r.vertCount=0,r.type=5121;return t}var C=c.create(null,34963,!0),r=new m(C._buffer);t(e);t._reglType="elements";t._elements=r;t.subdata=function(b,a){C.subdata(b,a);return t};t.destroy=function(){C.destroy();r.buffer=null};return t},createStream:function(b){var e=t.pop();e||(e=new m(c.create(null,34963,!0)._buffer));H(e,b,35040,-1,-1,
0,0);return e},destroyStream:function(b){t.push(b)},getElements:function(b){return"function"===typeof b&&b._elements instanceof m?b._elements:null}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":22,"./util/is-typed-array":23}],11:[function(c,m,q){m.exports=function(c){function l(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(h){try{p[h]=
c.getExtension(h)}catch(b){}})}var p={};l();return{extensions:p,refresh:l}}},{}],12:[function(c,m,q){var n=c("./util/values"),l=c("./util/extend");m.exports=function(c,h,b,e,m){function A(a,b,e,c){this.target=a;this.level=b;this.texture=e;this.renderbuffer=c}function H(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function E(a,b){var e=b.width,c=b.height;if(a.texture)var k=a.texture._texture,h=Math.max(1,k.params.width>>a.level),l=Math.max(1,
k.params.height>>a.level),e=e||h,c=c||l;else k=a.renderbuffer._renderbuffer,e=e||k.width,c=c||k.height;k.refCount+=1;b.width=e;b.height=c}function t(a,b){b?b.texture?c.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):c.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):c.framebufferTexture2D(36160,a,3553,null,0)}function z(a){var b=3553,e=0,c=null,k=null;"object"===typeof a&&("level"in a&&(e=a.level|0),"target"in a&&(b=a.target|0));var h=a._reglType;
"texture"===h?c=a:"renderbuffer"===h&&(k=a,b=36161,e=0);return new A(b,e,c,k)}function M(a){return a&&(a.texture||a.renderbuffer)}function C(){this.id=G++;N[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function r(e){c.isFramebuffer(e.framebuffer)||(e.framebuffer=c.createFramebuffer());a.dirty=!0;c.bindFramebuffer(36160,e.framebuffer);for(var k=
e.colorAttachments,l=0;l<k.length;++l)t(36064+l,k[l]);for(l=k.length;l<b.maxColorAttachments;++l)t(36064+l,null);t(36096,e.depthAttachment);t(36128,e.stencilAttachment);t(33306,e.depthStencilAttachment);h.webgl_draw_buffers&&h.webgl_draw_buffers.drawBuffersWEBGL(ea[k.length]);c.checkFramebufferStatus(36160)}function k(a){a=a.framebuffer;c.isFramebuffer(a)&&c.deleteFramebuffer(a)}var a={current:null,next:null,dirty:!1},V={rgba:6408},B={rgba4:32854,rgb565:36194,"rgb5 a1":32855};h.ext_srgb&&(B.srgba=
35907);h.ext_color_buffer_half_float&&(B.rgba16f=34842,B.rgb16f=34843);h.webgl_color_buffer_float&&(B.rgba32f=34836);var q=[],la=[];h.webgl_depth_texture&&(q.push(6402),la.push(34041));l(l({},V),B);n(V);n(B);B=5121;q={uint8:5121};h.oes_texture_half_float&&(B=q["half float"]=36193);h.oes_texture_float&&(B=q["float"]=5126);q.best=B;var ea=function(){for(var a=Array(b.maxDrawbuffers),e=0;e<=b.maxDrawbuffers;++e)for(var c=a[e]=Array(e),k=0;k<e;++k)c[k]=36064+k;return a}(),G=0,N={};return l(a,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof C)?a:null},create:function(a){function b(a){var k,l=a||{},n=a=0;if("shape"in l){var C=l.shape;a=C[0];n=C[1]}else"radius"in l&&(a=n=l.radius),"width"in l&&(a=l.width),"height"in l&&(n=l.height);var t=null,C=!1;if("colorBuffers"in l||"colorBuffer"in l){t=l.colorBuffers||l.colorBuffer;Array.isArray(t)||(t=[t]);h.width=a;h.height=n;t=t.map(z);for(k=0;k<t.length;++k)E(t[k],h);a=h.width;n=h.height}else{var q=!0,B="rgba",D="uint8",G=1,
C=!0;h.width=a=a||c.drawingBufferWidth;h.height=n=n||c.drawingBufferHeight;"format"in l&&(B=l.format,q=B in V);"type"in l&&(D=l.type);"colorCount"in l&&(G=l.colorCount|0);if(h.ownsColor)for(t=h.colorAttachments;t.length>G;)H(t.pop());else t=[];for(k=0;k<t.length;++k){var L;a:{L=t[k];var U=q,Q=B,N=a,T=n;if(L.texture){var O=L.texture;if(U){O({format:Q,type:D,width:N,height:T});O._texture.refCount+=1;L=!0;break a}}else if(O=L.renderbuffer,!U){O({format:Q,width:N,height:T});O._renderbuffer.refCount+=
1;L=!0;break a}H(L);L=!1}L||(t[k--]=t[t.length-1],t.pop())}for(;t.length<G;)q?t.push(new A(3553,0,e.create2D({format:B,type:D,width:a,height:n},3553),null)):t.push(new A(36161,0,null,m.create({format:B,width:a,height:n})))}h.width=a;h.height=n;B=q=k=null;D=!1;"depthBuffer"in l&&(k=z(l.depthBuffer));"stencilBuffer"in l&&(q=z(l.stencilBuffer));"depthStencilBuffer"in l&&(B=z(l.depthStencilBuffer));if(k||q||B)E(k||q||B,h);else if(G=!0,U=L=!1,"depth"in l&&(G=!!l.depth),"stencil"in l&&(L=!!l.stencil),"depthTexture"in
l&&(U=!!l.depthTexture),l=h.depthAttachment||h.stencilAttachment||h.depthStencilAttachment,Q=null,G||L)D=!0,U?(U=L?"depth stencil":"depth",h.ownsDepthStencil&&l.texture?(l.texture({format:U,width:a,height:n}),l.texture._texture.refCount+=1,Q=l):Q=new A(3553,0,e.create({format:U,width:a,height:n},3553),null)):(U=G?L?"depth stencil":"depth":"stencil",h.ownsDepthStencil&&l.renderbuffer?(l.renderbuffer({format:U,width:a,height:n}),l.renderbuffer._renderbuffer.refCount+=1,Q=l):Q=new A(36161,0,null,m.create({format:U,
width:a,height:n}))),G?L?B=Q:k=Q:q=Q;a=h;a.colorAttachments.forEach(H);H(a.depthAttachment);H(a.stencilAttachment);H(a.depthStencilAttachment);h.colorAttachments=t;h.depthAttachment=k;h.stencilAttachment=q;h.depthStencilAttachment=B;h.ownsColor=C;h.ownsDepthStencil=D;b.color=t.map(M);b.depth=M(k);b.stencil=M(q);b.depthStencil=M(B);r(h);b.width=h.width;b.height=h.height;return b}var h=new C;b(a);b._reglType="framebuffer";b._framebuffer=h;b._destroy=function(){k(h)};return b},clear:function(){n(N).forEach(k)},
refresh:function(){n(N).forEach(r)}})}},{"./util/extend":21,"./util/values":28}],13:[function(c,m,q){m.exports=function(c,l){var p=1;l.ext_texture_filter_anisotropic&&(p=c.getParameter(34047));var h=1,b=1;l.webgl_draw_buffers&&(h=c.getParameter(34852),b=c.getParameter(36063));return{colorBits:[c.getParameter(3410),c.getParameter(3411),c.getParameter(3412),c.getParameter(3413)],depthBits:c.getParameter(3414),stencilBits:c.getParameter(3415),subpixelBits:c.getParameter(3408),extensions:Object.keys(l).filter(function(b){return!!l[b]}),
maxAnisotropic:p,maxDrawbuffers:h,maxColorAttachments:b,pointSizeDims:c.getParameter(33901),lineWidthDims:c.getParameter(33902),maxViewportDims:c.getParameter(3386),maxCombinedTextureUnits:c.getParameter(35661),maxCubeMapSize:c.getParameter(34076),maxRenderbufferSize:c.getParameter(34024),maxTextureUnits:c.getParameter(34930),maxTextureSize:c.getParameter(3379),maxAttributes:c.getParameter(34921),maxVertexUniforms:c.getParameter(36347),maxVertexTextureUnits:c.getParameter(35660),maxVaryingVectors:c.getParameter(36348),
maxFragmentUniforms:c.getParameter(36349),glsl:c.getParameter(35724),renderer:c.getParameter(7937),vendor:c.getParameter(7936),version:c.getParameter(7938)}}},{}],14:[function(c,m,q){var n=c("./util/is-typed-array");m.exports=function(c,p,h){return function(b){var e=b||{};n(b)?e={data:e}:2===arguments.length?e={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof b&&(e={});p();var m=e.x||0,A=e.y||0,q=e.width||h.viewportWidth,E=e.height||h.viewportHeight,e=e.data||new Uint8Array(q*E*4);c.pixelStorei(3333,
4);c.readPixels(m,A,q,E,6408,5121,e);return e}}},{"./util/is-typed-array":23}],15:[function(c,m,q){var n=c("./util/values");m.exports=function(c,p,h){function b(){this.id=q++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function e(b){c.isRenderbuffer(b.renderbuffer)||(b.renderbuffer=c.createRenderbuffer());c.bindRenderbuffer(36161,b.renderbuffer);c.renderbufferStorage(36161,b.format,b.width,b.height)}function m(b){var e=b.renderbuffer;c.bindRenderbuffer(36161,
null);c.isRenderbuffer(e)&&c.deleteRenderbuffer(e);b.renderbuffer=null;b.refCount=0;delete E[b.id]}var A={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};p.ext_srgb&&(A.srgba=35907);p.ext_color_buffer_half_float&&(A.rgba16f=34842,A.rgb16f=34843);p.webgl_color_buffer_float&&(A.rgba32f=34836);var q=0,E={};b.prototype.decRef=function(){0===--this.refCount&&m(this)};return{create:function(c){function l(b){b=b||{};var c=0,k=0;"shape"in b?(k=b.shape,c=k[0]|0,k=
k[1]|0):("radius"in b&&(c=k=b.radius|0),"width"in b&&(c=b.width|0),"height"in b&&(k=b.height|0));l.width=h.width=Math.max(c,1);l.height=h.height=Math.max(k,1);h.format=32854;"format"in b&&(h.format=A[b.format]);e(h);return l}var h=new b;E[h.id]=h;l(c);l._reglType="renderbuffer";l._renderbuffer=h;l.destroy=function(){h.decRef()};return l},refresh:function(){n(E).forEach(e)},clear:function(){n(E).forEach(m)}}}},{"./util/values":28}],16:[function(c,m,q){var n=c("./util/values");m.exports=function(c,
p){function h(b,e,c,a){this.name=b;this.id=e;this.location=c;this.info=a}function b(b,e){for(var c=0;c<b.length;++c)if(b[c].id===e.id){b[c].location=e.location;return}b.push(e)}function e(b,e,h){h=35632===b?q:E;var a=h[e];if(!a){var n=p.str(e),a=c.createShader(b);c.shaderSource(a,n);c.compileShader(a);h[e]=a}return a}function m(b,e){this.id=M++;this.fragId=b;this.vertId=e;this.program=null;this.uniforms=[];this.attributes=[]}function A(n,m){var k,a;k=e(35632,n.fragId);a=e(35633,n.vertId);var t=n.program=
c.createProgram();c.attachShader(t,k);c.attachShader(t,a);c.linkProgram(t);var z=c.getProgramParameter(t,35718),x=n.uniforms;for(k=0;k<z;++k)if(a=c.getActiveUniform(t,k))if(1<a.size)for(var A=0;A<a.size;++A){var q=a.name.replace("[0]","["+A+"]");b(x,new h(q,p.id(q),c.getUniformLocation(t,q),a))}else b(x,new h(a.name,p.id(a.name),c.getUniformLocation(t,a.name),a));z=c.getProgramParameter(t,35721);x=n.attributes;for(k=0;k<z;++k)(a=c.getActiveAttrib(t,k))&&b(x,new h(a.name,p.id(a.name),c.getAttribLocation(t,
a.name),a))}var q={},E={},t={},z=[],M=0;return{clear:function(){var b=c.deleteShader.bind(c);n(q).forEach(b);q={};n(E).forEach(b);E={};z.forEach(function(b){c.deleteProgram(b.program)});z.length=0;t={}},refresh:function(){q={};E={};z.forEach(A)},program:function(b,e,c){var a=t[e];a||(a=t[e]={});var h=a[b];h||(h=new m(e,b),A(h,c),a[b]=h,z.push(h));return h},shader:e,frag:null,vert:null}}},{"./util/values":28}],17:[function(c,m,q){m.exports=function(){var c={"":0},l=[""];return{id:function(p){var h=
c[p];if(h)return h;h=c[p]=l.length;l.push(p);return h},str:function(c){return l[c]}}}},{}],18:[function(c,m,q){function n(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function l(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var e=a[0].length,c=1;c<b;++c)if(!Array.isArray(a[c])||a[c].length!==e)return!1;return!0}function p(a){return Object.prototype.toString.call(a)}function h(a){if(!a)return!1;var b=p(a);return 0<=k.indexOf(b)?!0:
n(a)||l(a)||H(a)}function b(a,b){36193===a.type?(a.data=t(b),E.freeType(b)):a.data=b}var e=c("./util/extend"),x=c("./util/values"),A=c("./util/is-typed-array"),H=c("./util/is-ndarray"),E=c("./util/pool"),t=c("./util/to-half-float");q=c("./constants/arraytypes.json");var z=c("./constants/arraytypes.json"),M=[9984,9986,9985,9987],C=[0,6409,6410,6407,6408],r={};r[6409]=r[6406]=r[6402]=1;r[34041]=r[6410]=2;r[6407]=3;r[6408]=4;var k=Object.keys(q).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]",
"[object HTMLImageElement]","[object HTMLVideoElement]"]);m.exports=function(a,c,k,m,q){function ea(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function G(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;
a.width=b.width;a.height=b.height;a.channels=b.channels}function N(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=va[b.colorSpace]);"type"in b&&(a.type=aa[b.type]);var e=a.width,c=a.height,h=a.channels,k=!1;"shape"in b?(e=b.shape[0],c=b.shape[1],3===b.shape.length&&(h=b.shape[2],k=!0)):("radius"in b&&(e=c=b.radius),"width"in b&&(e=b.width),
"height"in b&&(c=b.height),"channels"in b&&(h=b.channels,k=!0));a.width=e|0;a.height=c|0;a.channels=h|0;e=!1;"format"in b&&(e=b.format,c=a.internalformat=ca[e],a.format=Ea[c],e in aa&&!("type"in b)&&(a.type=aa[e]),e in da&&(a.compressed=!0),e=!0);!k&&e?a.channels=r[a.format]:k&&!e&&a.channels!==C[a.format]&&(a.format=a.internalformat=C[a.channels])}}function D(f){a.pixelStorei(37440,f.flipY);a.pixelStorei(37441,f.premultiplyAlpha);a.pixelStorei(37443,f.colorSpace);a.pixelStorei(3317,f.unpackAlignment)}
function ha(){ea.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function P(a,e){var c=null;h(e)?c=e:e&&(N(a,e),"x"in e&&(a.xOffset=e.x|0),"y"in e&&(a.yOffset=e.y|0),h(e.data)&&(c=e.data));if(e.copy){var k=q.viewportWidth,m=q.viewportHeight;a.width=a.width||k-a.xOffset;a.height=a.height||m-a.yOffset;a.needsCopy=!0}else if(!c)a.width=a.width||1,a.height=a.height||1;else if(A(c))a.data=c,"type"in e||5121!==a.type||(a.type=z[Object.prototype.toString.call(c)]|
0);else if(n(c)){k=c;m=a.width*a.height*a.channels;switch(a.type){case 5121:case 5123:case 5125:case 5126:m=E.allocType(a.type,m);m.set(k);a.data=m;break;case 36193:a.data=t(k)}a.alignment=1;a.needsFree=!0}else if(H(c)){k=c.data;Array.isArray(k)||5121!==a.type||(a.type=z[Object.prototype.toString.call(k)]|0);var m=c.shape,x=c.stride,r,X,d,w;3===m.length?(d=m[2],w=x[2]):w=d=1;r=m[0];X=m[1];m=x[0];x=x[1];a.alignment=1;a.width=r;a.height=X;a.channels=d;a.format=a.internalformat=C[d];a.needsFree=!0;r=
w;c=c.offset;d=a.width;w=a.height;X=a.channels;for(var B=E.allocType(36193===a.type?5126:a.type,d*w*X),D=0,F=0;F<w;++F)for(var v=0;v<d;++v)for(var ba=0;ba<X;++ba)B[D++]=k[m*v+x*F+r*ba+c];b(a,B)}else if("[object HTMLCanvasElement]"===p(c)||"[object CanvasRenderingContext2D]"===p(c))"[object HTMLCanvasElement]"===p(c)?a.element=c:a.element=c.canvas,a.width=a.element.width,a.height=a.element.height;else if("[object HTMLImageElement]"===p(c))a.element=c,a.width=c.naturalWidth,a.height=c.naturalHeight;
else if("[object HTMLVideoElement]"===p(c))a.element=c,a.width=c.videoWidth,a.height=c.videoHeight,a.needsPoll=!0;else if(l(c)){k=c[0].length;m=c.length;x=1;if(Array.isArray(c[0][0])){r=x=c[0][0].length;d=E.allocType(36193===a.type?5126:a.type,k*m*r);for(X=w=0;X<m;++X)for(B=c[X],D=0;D<k;++D)for(F=B[D],v=0;v<r;++v)d[w++]=F[v];b(a,d)}else{r=E.allocType(36193===a.type?5126:a.type,k*m);for(w=d=0;w<m;++w)for(X=c[w],B=0;B<k;++B)r[d++]=X[B];b(a,r)}a.alignment=1;a.width=k;a.height=m;a.channels=x;a.format=
a.internalformat=C[x];a.needsFree=!0}}function R(b,e,c,h,k){var l=b.element,n=b.data,p=b.internalformat,d=b.format,x=b.type,t=b.width,z=b.height;D(b);l?a.texSubImage2D(e,k,c,h,d,x,l):b.compressed?a.compressedTexSubImage2D(e,k,c,h,p,t,z,n):b.needsCopy?(m(),a.copyTexSubImage2D(e,k,c,h,b.xOffset,b.yOffset,t,z)):a.texSubImage2D(e,k,c,h,t,z,d,x,n)}function Y(){return wa.pop()||new ha}function S(a){a.needsFree&&E.freeType(a.data);ha.call(a);wa.push(a)}function ia(){ea.call(this);this.genMipmaps=!1;this.mipmapHint=
4352;this.mipmask=0;this.images=Array(16)}function K(a,b,e){var c=a.images[0]=Y();a.mipmask=1;c.width=a.width=b;c.height=a.height=e}function I(a,b){var e=null;if(h(b))e=a.images[0]=Y(),P(e,b),a.mipmask=1;else if(N(a,b),Array.isArray(b.mipmap))for(var c=b.mipmap,k=0;k<c.length;++k)e=a.images[k]=Y(),G(e,a),e.width>>=k,e.height>>=k,P(e,c[k]),a.mipmask|=1<<k;else e=a.images[0]=Y(),G(e,a),P(e,b),a.mipmask=1;G(a,a.images[0])}function J(b,e){for(var c=b.images,k=0;k<c.length&&c[k];++k){var h=c[k],l=e,n=
k,p=h.element,d=h.data,x=h.internalformat,t=h.format,z=h.type,r=h.width,v=h.height;D(h);p?a.texImage2D(l,n,t,t,z,p):h.compressed?a.compressedTexImage2D(l,n,x,r,v,0,d):h.needsCopy?(m(),a.copyTexImage2D(l,n,t,h.xOffset,h.yOffset,r,v,0)):a.texImage2D(l,n,t,r,v,0,t,z,d)}}function ja(){var a=Da.pop()||new ia;ea.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function fa(a){for(var b=a.images,e=0;e<b.length;++e)b[e]&&S(b[e]),b[e]=null;Da.push(a)}function oa(){this.magFilter=this.minFilter=
9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function L(a,b){"min"in b&&(a.minFilter=sa[b.min],0<=M.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=ua[b.mag]);var e=a.wrapS,c=a.wrapT;if("wrap"in b){var h=b.wrap;"string"===typeof h?e=c=qa[h]:Array.isArray(h)&&(e=qa[h[0]],c=qa[h[1]])}else"wrapS"in b&&(e=qa[b.wrapS]),"wrapT"in b&&(c=qa[b.wrapT]);a.wrapS=e;a.wrapT=c;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){e=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=
ba[b.mipmap];e=a.genMipmaps=!0;break;case "boolean":e=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,e=!0}!e||"min"in b||(a.minFilter=9984)}}function ta(b,e){a.texParameteri(e,10241,b.minFilter);a.texParameteri(e,10240,b.magFilter);a.texParameteri(e,10242,b.wrapS);a.texParameteri(e,10243,b.wrapT);c.ext_texture_filter_anisotropic&&a.texParameteri(e,34046,b.anisotropic);b.genMipmaps&&(a.hint(33170,b.mipmapHint),a.generateMipmap(e))}function Q(){var a=ya.pop()||new oa;oa.call(a);return a}
function pa(b){ea.call(this);this.mipmask=0;this.id=ra++;this.refCount=1;this.target=b;this.texture=a.createTexture();this.unit=-1;this.bindCount=0}function T(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function O(){var b=ga[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function W(b){var e=b.texture,c=b.unit,h=b.target;0<=c&&(a.activeTexture(33984+c),a.bindTexture(h,null),ga[c]=null);a.deleteTexture(e);b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete Z[b.id]}
var ba={"don't care":4352,"dont care":4352,nice:4354,fast:4353},qa={repeat:10497,clamp:33071,mirror:33648},ua={nearest:9728,linear:9729},sa=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ua),va={none:0,browser:37444},aa={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ca={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},da={};c.ext_srgb&&(ca.srgb=35904,
ca.srgba=35906);c.oes_texture_float&&(aa["float"]=5126);c.oes_texture_half_float&&(aa.float16=aa["half float"]=36193);c.webgl_depth_texture&&(e(ca,{depth:6402,"depth stencil":34041}),e(aa,{uint16:5123,uint32:5125,"depth stencil":34042}));c.webgl_compressed_texture_s3tc&&e(da,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});c.webgl_compressed_texture_atc&&e(da,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});c.webgl_compressed_texture_pvrtc&&
e(da,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});c.webgl_compressed_texture_etc1&&(da["rgb etc1"]=36196);var Ba=Array.prototype.slice.call(a.getParameter(34467));Object.keys(da).forEach(function(a){var b=da[a];0<=Ba.indexOf(b)&&(ca[a]=b)});var Ca=Object.keys(ca);k.textureFormats=Ca;var Ea=Ca.reduce(function(a,b){var e=ca[b];6409===e||6406===e||6409===e||6410===e||6402===e||34041===e?a[e]=e:32855===e||0<=b.indexOf("rgba")?a[e]=6408:a[e]=
6407;return a},{}),wa=[],Da=[],ya=[],ra=0,Z={},ka=k.maxTextureUnits,ga=Array(ka).map(function(){return null});e(pa.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var e=0;e<ka;++e){var c=ga[e];if(c){if(0<c.bindCount)continue;c.unit=-1}ga[e]=this;b=e;break}this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&W(this)}});return{create2D:function(a,b){function e(a,b){var f=
Q(),h=ja();"number"===typeof a?"number"===typeof b?K(h,a|0,b|0):K(h,a|0,a|0):a?(L(f,a),I(h,a)):K(h,1,1);f.genMipmaps&&(h.mipmask=(h.width<<1)-1);c.mipmask=h.mipmask;G(c,h);e.width=h.width;e.height=h.height;T(c);J(h,3553);ta(f,3553);O();ya.push(f);fa(h);return e}var c=new pa(3553);Z[c.id]=c;e(a,b);e.subimage=function(a,b,f,h){b|=0;f|=0;h|=0;var d=Y();G(d,c);d.width>>=h;d.height>>=h;d.width-=b;d.height-=f;P(d,a);T(c);R(d,3553,b,f,h);O();S(d);return e};e._reglType="texture2d";e._texture=c;e.destroy=
function(){c.decRef()};return e},createCube:function(a,b,e,c,h,k){function l(a,b,e,c,f,h){var g,k=Q();for(g=0;6>g;++g)d[g]=ja();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)K(d[g],a,a);else if("object"===typeof a)if(b)I(d[0],a),I(d[1],b),I(d[2],e),I(d[3],c),I(d[4],f),I(d[5],h);else if(L(k,a),N(n,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)G(d[g],n),I(d[g],a[g]);else for(g=0;6>g;++g)I(d[g],a);G(n,d[0]);n.mipmask=k.genMipmaps?(d[0].width<<1)-1:d[0].mipmask;l.width=d[0].width;l.height=d[0].height;
T(n);for(g=0;6>g;++g)J(d[g],34069+g);ta(k,34067);O();ya.push(k);for(g=0;6>g;++g)fa(d[g]);return l}var n=new pa(34067);Z[n.id]=n;var d=Array(6);l(a,b,e,c,h,k);l.subimage=function(a,b,d,e,c){d|=0;e|=0;c|=0;var f=Y();G(f,n);f.width>>=c;f.height>>=c;f.width-=d;f.height-=e;P(f,b);T(n);R(f,34069+a,d,e,c);O();S(f);return l};l._reglType="textureCube";l._texture=n;l.destroy=function(){n.decRef()};return l},clear:function(){for(var b=0;b<ka;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ga[b]=null;x(Z).forEach(W)},
getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":21,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/pool":25,"./util/to-half-float":27,"./util/values":28}],19:[function(c,m,q){m.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],20:[function(c,m,q){function n(c){return Array.prototype.slice.call(c)}function l(c){return n(c).join("")}var p=c("./extend");m.exports=function(){function c(){var b=
[],h=[];return p(function(){b.push.apply(b,n(arguments))},{def:function(){var c="v"+e++;h.push(c);0<arguments.length&&(b.push(c,"="),b.push.apply(b,n(arguments)),b.push(";"));return c},toString:function(){return l([0<h.length?"var "+h+";":"",l(b)])}})}function b(){function b(c,a){l(c,a,"=",e.def(c,a),";")}var e=c(),l=c(),n=e.toString,m=l.toString;return p(e,{entry:e,exit:l,save:b,set:function(c,a,h){b(c,a);e(c,a,"=",h,";")},toString:function(){return n()+m()}})}var e=0,m=[],q=[],H=c(),E={};return{global:H,
link:function(b){for(var c=0;c<q.length;++c)if(q[c]===b)return m[c];c="g"+e++;m.push(c);q.push(b);return c},block:c,proc:function(e,c){function h(){var a="a"+n.length;n.push(a);return a}var n=[];c=c||0;for(var m=0;m<c;++m)h();var m=b(),k=m.toString;return E[e]=p(m,{arg:h,toString:function(){return l(["function(",n.join(),"){",k(),"}"])}})},scope:b,cond:function(){var e=l(arguments),c=b(),h=b(),m=c.toString,x=h.toString;return p(c,{then:function(){c.apply(c,n(arguments));return this},"else":function(){h.apply(h,
n(arguments));return this},toString:function(){var b=x();b&&(b="else{"+b+"}");return l(["if(",e,"){",m(),"}",b])}})},compile:function(){var b=['"use strict";',H,"return {"];Object.keys(E).forEach(function(e){b.push('"',e,'":',E[e].toString(),",")});b.push("}");var e=l(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,m.concat(e)).apply(null,q)}}}},{"./extend":21}],21:[function(c,m,q){m.exports=function(c,l){for(var m=Object.keys(l),h=0;h<m.length;++h)c[m[h]]=
l[m[h]];return c}},{}],22:[function(c,m,q){var n=c("./is-typed-array");m.exports=function(c){return!!c&&"object"===typeof c&&Array.isArray(c.shape)&&Array.isArray(c.stride)&&"number"===typeof c.offset&&c.shape.length===c.stride.length&&(Array.isArray(c.data)||n(c.data))}},{"./is-typed-array":23}],23:[function(c,m,q){var n=c("../constants/arraytypes.json");m.exports=function(c){return Object.prototype.toString.call(c)in n}},{"../constants/arraytypes.json":4}],24:[function(c,m,q){m.exports=function(c,
l){for(var m=Array(c),h=0;h<c;++h)m[h]=l(h);return m}},{}],25:[function(c,m,q){function n(b){var e,c;e=(65535<b)<<4;b>>>=e;c=(255<b)<<3;b>>>=c;e|=c;c=(15<b)<<2;b>>>=c;e|=c;c=(3<b)<<1;return e|c|b>>>c>>1}function l(b){a:{for(var e=16;268435456>=e;e*=16)if(b<=e){b=e;break a}b=0}e=h[n(b)>>2];return 0<e.length?e.pop():new ArrayBuffer(b)}function p(b){h[n(b.byteLength)>>2].push(b)}var h=c("./loop")(8,function(){return[]});m.exports={alloc:l,free:p,allocType:function(b,e){var c=null;switch(b){case 5120:c=
new Int8Array(l(e),0,e);break;case 5121:c=new Uint8Array(l(e),0,e);break;case 5122:c=new Int16Array(l(2*e),0,e);break;case 5123:c=new Uint16Array(l(2*e),0,e);break;case 5124:c=new Int32Array(l(4*e),0,e);break;case 5125:c=new Uint32Array(l(4*e),0,e);break;case 5126:c=new Float32Array(l(4*e),0,e);break;default:return null}return c.length!==e?c.subarray(0,e):c},freeType:function(b){p(b.buffer)}}},{"./loop":24}],26:[function(c,m,q){m.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?
{next:function(c){return requestAnimationFrame(c)},cancel:function(c){return cancelAnimationFrame(c)}}:{next:function(c){setTimeout(c,30)},cancel:clearTimeout}},{}],27:[function(c,m,q){var n=c("./pool"),l=new Float32Array(1),p=new Uint32Array(l.buffer);m.exports=function(c){for(var b=n.allocType(5123,c.length),e=0;e<c.length;++e)if(isNaN(c[e]))b[e]=65535;else if(Infinity===c[e])b[e]=31744;else if(-Infinity===c[e])b[e]=64512;else{l[0]=c[e];var m=p[0],q=m>>>31<<15,H=(m<<1>>>24)-127,m=m>>13&1023;b[e]=
-24>H?q:-14>H?q+(m+1024>>-14-H):15<H?q+31744:q+(H+15<<10)+m}return b}},{"./pool":25}],28:[function(c,m,q){m.exports=function(c){return Object.keys(c).map(function(l){return c[l]})}},{}],29:[function(c,m,q){function n(c,b){function e(){var b=window.innerWidth,e=window.innerHeight;c!==document.body&&(e=c.getBoundingClientRect(),b=e.right-e.left,e=e.top-e.bottom);m.width=q*b;m.height=q*e;p(m.style,{width:b+"px",height:e+"px"})}var m=document.createElement("canvas"),n=l(m,b);p(m.style,{border:0,margin:0,
padding:0,top:0,left:0});c.appendChild(m);c===document.body&&(m.style.position="absolute",p(c.style,{margin:0,padding:0}));var q=+n.options.pixelRatio;window.addEventListener("resize",e,!1);var E=n.options.onDestroy;n.options=p(p({},n.options),{onDestroy:function(){window.removeEventListener("resize",e);c.removeChild(m);E&&E()}});e();return n}function l(c,b){function e(b){try{return c.getContext(b,l)}catch(e){return null}}var l=b.glOptions||{};return{gl:e("webgl")||e("experimental-webgl")||e("webgl-experimental"),
options:p({pixelRatio:window.devicePixelRatio},b)}}var p=c("./util/extend");m.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],options:c[1]||{}};var b=document.body,e=c[1]||{};if("string"===typeof c[0])b=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)b=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],options:p({pixelRatio:1},e)};e=c[0]}return b.nodeName&&"CANVAS"===b.nodeName.toUpperCase()?
l(b,e):n(b,e)}},{"./util/extend":21}],30:[function(c,m,q){var n=c("./lib/util/extend"),l=c("./lib/dynamic"),p=c("./lib/util/raf"),h=c("./lib/util/clock"),b=c("./lib/strings"),e=c("./lib/webgl"),x=c("./lib/extension"),A=c("./lib/limits"),H=c("./lib/buffer"),E=c("./lib/elements"),t=c("./lib/texture"),z=c("./lib/renderbuffer"),M=c("./lib/framebuffer"),C=c("./lib/attribute"),r=c("./lib/shader"),k=c("./lib/read"),a=c("./lib/core");m.exports=function(){function c(){W=p.next(c);K.count+=1;var a=h();K.deltaTime=
(a-Y)/1E3;K.time=(a-R)/1E3;Y=a;G();for(a=0;a<O.length;++a)(0,O[a])(K,null,0)}function m(a){}function q(a){}function la(a){function b(a){var c={},e={};Object.keys(a).forEach(function(b){var h=a[b];l.isDynamic(h)?e[b]=l.unbox(h,b):c[b]=h});return{dynamic:e,"static":c}}function c(a){for(;r.length<a;)r.push(null);return r}var e=b(a.context||{}),h=b(a.uniforms||{}),k=b(a.attributes||{});a=b(function(a){function b(a){if(a in c){var e=c[a];delete c[a];Object.keys(e).forEach(function(b){c[a+"."+b]=e[b]})}}
var c=n({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));var e=Q.compile(a,k,h,e),m=e.draw,p=e.batch,q=e.scope,r=[];return function(a,b){var e;if("function"===typeof a)return q.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(e=0;e<a;++e)q.call(this,null,b,e);else if(Array.isArray(a))for(e=0;e<a.length;++e)q.call(this,a[e],b,e);else return q.call(this,a,b,0);else if("number"===
typeof a){if(0<a)return p.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return p.call(this,a,a.length)}else return m.call(this,a)}}function ea(){Q.procs.poll()}function G(){var a=pa.viewport,b=pa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;K.viewportWidth=K.frameBufferWidth=K.drawingBufferWidth=a[2]=b[2]=D.drawingBufferWidth;K.viewportHeight=K.frameBufferWidth=K.drawingBufferHeight=a[3]=b[3]=D.drawingBufferHeight;Q.procs.refresh()}var N=e(Array.prototype.slice.call(arguments)),D=N.gl,ha=N.options,
N=b(),P=x(D).extensions,R=h(),Y=R,S=D.drawingBufferWidth,ia=D.drawingBufferHeight,K={count:0,deltaTime:0,time:0,viewportWidth:S,viewportHeight:ia,framebufferWidth:S,framebufferHeight:ia,drawingBufferWidth:S,drawingBufferHeight:ia,pixelRatio:ha.pixelRatio},I=A(D,P),J=H(D),S=E(D,P,J),ia=C(D,P,I,J,N),ja=r(D,N),fa=t(D,P,I,ea,K),oa=z(D,P,I),L=M(D,P,I,fa,oa),ta=k(D,ea,K),Q=a(D,N,P,I,J,S,fa,L,{},ia,ja,{elements:null,primitive:4,count:-1,offset:0,instances:-1},K),pa=Q.next,T=D.canvas,O=[],W=0;T&&(T.addEventListener("webglcontextlost",
m,!1),T.addEventListener("webglcontextrestored",q,!1));G();return n(la,{clear:function(a){var b=0;ea();var c=a.color;c&&(D.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(D.clearDepth(+a.depth),b|=256);"stencil"in a&&(D.clearStencil(a.stencil|0),b|=1024);D.clear(b)},prop:l.define.bind(null,1),context:l.define.bind(null,2),"this":l.define.bind(null,3),draw:la({}),buffer:function(a){return J.create(a,34962)},elements:S.create,texture:fa.create2D,cube:fa.createCube,renderbuffer:oa.create,
framebuffer:L.create,framebufferCube:function(a){},attributes:D.getContextAttributes(),frame:function(a){O.push(a);!W&&0<O.length&&c();return{cancel:function(){var b=O.find(function(b){return b===a});0>b||(O.splice(b,1),0>=O.length&&W&&(p.cancel(c),W=0))}}},limits:I,hasExtension:function(a){return 0<=I.extensions.indexOf(a.toLowerCase())},read:ta,destroy:function(){W&&(p.cancel(c),W=0);T&&(T.removeEventListener("webglcontextlost",m),T.removeEventListener("webglcontextrestored",q));ja.clear();L.clear();
oa.clear();fa.clear();J.clear();if(ha.onDestroy)ha.onDestroy()},_gl:D,_refresh:G})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/strings":17,"./lib/texture":18,"./lib/util/clock":19,"./lib/util/extend":21,"./lib/util/raf":26,"./lib/webgl":29}]},{},[1]);

        </script>
        </body>
      </html>