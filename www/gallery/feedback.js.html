<!DOCTYPE html>
      <html>
        <head>
          <title>example/feedback.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(m,r,h){function a(e,f){if(!r[e]){if(!m[e]){var c="function"==typeof require&&require;if(!f&&c)return c(e,!0);if(t)return t(e,!0);c=Error("Cannot find module '"+e+"'");throw c.code="MODULE_NOT_FOUND",c;}c=r[e]={exports:{}};m[e][0].call(c.exports,function(f){var c=m[e][1][f];return a(c?c:f)},c,c.exports,e$$0,m,r,h)}return r[e].exports}for(var t="function"==typeof require&&require,y=0;y<h.length;y++)a(h[y]);return a})({1:[function(k,m,r){var h=k("../regl")(),a=k("mouse-change")(),t=h.texture(),
y=h({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:t,mouse:function(e){var f=e.pixelRatio;return[a.x*f,e.viewportHeight-a.y*f]},t:function(a){return.01*a.tick}},count:3});h.frame(function(){h.clear({color:[0,0,0,1]});y();t({copy:!0})})},{"../regl":35,"mouse-change":33}],2:[function(k,m,r){function h(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(a,t,y,e,f){a=y.maxAttributes;t=
Array(a);for(y=0;y<a;++y)t[y]=new h;return{Record:h,scope:{},state:t}}},{}],3:[function(k,m,r){function h(a){return F[Object.prototype.toString.call(a)]|0}function a(a,e){for(var f=0;f<e.length;++f)a[f]=e[f]}function t(a,e,f,c,g,h,t){for(var l=0,b=0;b<f;++b)for(var L=0;L<c;++L)a[l++]=e[g*b+h*L+t]}function y(a,e,f){for(var c=0,g=0;g<e.length;++g)for(var h=e[g],t=0;t<f;++t)a[c++]=h[t]}var e=k("./util/is-typed-array"),f=k("./util/is-ndarray"),c=k("./util/values"),A=k("./util/pool"),F=k("./constants/arraytypes.json"),
G=k("./constants/dtypes.json"),z=k("./constants/usage.json"),q=[];q[5120]=1;q[5122]=2;q[5124]=4;q[5121]=1;q[5123]=2;q[5125]=4;q[5126]=4;m.exports=function(k,v,m){function n(a){this.id=l++;this.buffer=k.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;m.profile&&(this.stats={size:0})}function g(a,e,f){a.byteLength=e.byteLength;k.bufferData(a.type,e,f)}function C(b,c,k,l,n,L){b.usage=k;if(Array.isArray(c))b.dtype=l||5126,0<c.length&&
(Array.isArray(c[0])?(b.dimension=c[0].length,l=A.allocType(b.dtype,c.length*b.dimension),y(l,c,b.dimension),g(b,l,k),L?b.persistentData=l:A.freeType(l)):"number"===typeof c[0]?(b.dimension=n,l=A.allocType(b.dtype,c.length),a(l,c),g(b,l,k),L?b.persistentData=l:A.freeType(l)):e(c[0])&&(b.dimension=c[0].length,b.dtype=l||h(c[0])||5126,l=A.allocType(b.dtype,c.length*b.dimension),y(l,c,b.dimension),g(b,l,k),L?b.persistentData=l:A.freeType(l)));else if(e(c))b.dtype=l||h(c),b.dimension=n,g(b,c,k),L&&(b.persistentData=
new Uint8Array(new Uint8Array(c.buffer)));else if(f(c)){var q=c.shape,T=c.stride;n=c.offset;var v=0,C=0,p=0,Z=0;1===q.length?(v=q[0],C=1,p=T[0],Z=0):2===q.length&&(v=q[0],C=q[1],p=T[0],Z=T[1]);b.dtype=l||h(c.data)||5126;b.dimension=C;l=A.allocType(b.dtype,v*C);t(l,c.data,v,C,p,Z,n);g(b,l,k);L?b.persistentData=l:A.freeType(l)}}function I(a){v.bufferCount--;k.deleteBuffer(a.buffer);a.buffer=null;delete b[a.id]}var l=0,b={};n.prototype.bind=function(){k.bindBuffer(this.type,this.buffer)};n.prototype.destroy=
function(){I(this)};var L=[];m.profile&&(v.getTotalBufferSize=function(){var a=0;Object.keys(b).forEach(function(e){a+=b[e].stats.size});return a});return{create:function(c,g,l,L){function F(a){var b=35044,c=null,g=0,l=0,h=1;Array.isArray(a)||e(a)||f(a)?c=a:"number"===typeof a?g=a|0:a&&("data"in a&&(c=a.data),"usage"in a&&(b=z[a.usage]),"type"in a&&(l=G[a.type]),"dimension"in a&&(h=a.dimension|0),"length"in a&&(g=a.length|0));r.bind();c?C(r,c,b,l,h,L):(k.bufferData(r.type,g,b),r.dtype=l||5121,r.usage=
b,r.dimension=h,r.byteLength=g);m.profile&&(r.stats.size=r.byteLength*q[r.dtype]);return F}v.bufferCount++;var r=new n(g);b[r.id]=r;l||F(c);F._reglType="buffer";F._buffer=r;F.subdata=function(b,c){var g=(c||0)|0;r.bind();if(Array.isArray(b)){if(0<b.length)if("number"===typeof b[0]){var l=A.allocType(r.dtype,b.length);a(l,b);k.bufferSubData(r.type,g,l);A.freeType(l)}else if(Array.isArray(b[0])||e(b[0])){var l=b[0].length,p=A.allocType(r.dtype,b.length*l);y(p,b,l);k.bufferSubData(r.type,g,p);A.freeType(p)}}else if(e(b))k.bufferSubData(r.type,
g,b);else if(f(b)){var L=b.shape,n=b.stride,q=p=l=0,v=0;1===L.length?(l=L[0],p=1,q=n[0],v=0):2===L.length&&(l=L[0],p=L[1],q=n[0],v=n[1]);L=Array.isArray(b.data)?r.dtype:h(b.data);L=A.allocType(L,l*p);t(L,b.data,l,p,q,v,b.offset);k.bufferSubData(r.type,g,L);A.freeType(L)}return F};m.profile&&(F.stats=r.stats);F.destroy=function(){I(r)};return F},createStream:function(a,b){var e=L.pop();e||(e=new n(a));e.bind();C(e,b,35040,0,1,!1);return e},destroyStream:function(a){L.push(a)},clear:function(){c(b).forEach(I);
L.forEach(I)},getBuffer:function(a){return a&&a._buffer instanceof n?a._buffer:null},restore:function(){c(b).forEach(function(a){a.buffer=k.createBuffer();k.bindBuffer(a.type,a.buffer);k.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:C}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(k,m,r){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,
"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(k,m,r){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(k,m,r){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},
{}],7:[function(k,m,r){m.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(k,m,r){function h(a){return Array.isArray(a)||F(a)||G(a)}function a(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function t(a,b,e,c){this.thisDep=a;this.contextDep=b;this.propDep=e;this.append=c}function y(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function e(a){return new t(!1,!1,!1,a)}function f(a,b){var e=a.type;return 0===e?(e=a.data.length,new t(!0,1<=e,
2<=e,b)):4===e?(e=a.data,new t(e.thisDep,e.contextDep,e.propDep,b)):new t(3===e,2===e,1===e,b)}var c=k("./util/codegen"),A=k("./util/loop"),F=k("./util/is-typed-array"),G=k("./util/is-ndarray"),z=k("./util/is-array-like"),q=k("./dynamic"),J=k("./constants/primitives.json"),v=k("./constants/dtypes.json"),H=["x","y","z","w"],n="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),g={0:0,1:1,zero:0,one:1,"src color":768,
"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},C={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},I={0:0,zero:0,keep:7680,replace:7681,increment:7682,
decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},l={cw:2304,ccw:2305},b=new t(!1,!1,!1,function(){});m.exports=function(k,m,r,G,F,na,oa,P,T,pa,va,p,Z,aa,ja){function W(d){return d.replace(".","_")}function N(d,a,b){var e=W(d);Ha.push(d);x[e]=u[e]=!!b;wa[e]=a}function E(d,a,b){var e=W(d);Ha.push(d);Array.isArray(b)?(u[e]=b.slice(),x[e]=b.slice()):u[e]=x[e]=b;xa[e]=a}function ya(){var d=c(),a=d.link,b=d.global;d.id=Pa++;d.batchId="0";var e=a(Oa),f=d.shared={props:"a0"};Object.keys(Oa).forEach(function(d){f[d]=
b.def(e,".",d)});var K=d.next={},O=d.current={};Object.keys(xa).forEach(function(d){Array.isArray(u[d])&&(K[d]=b.def(f.next,".",d),O[d]=b.def(f.current,".",d))});var Qa=d.constants={};Object.keys(Ia).forEach(function(d){Qa[d]=b.def(JSON.stringify(Ia[d]))});d.invoke=function(D,b){switch(b.type){case 0:var e=["this",f.context,f.props,d.batchId];return D.def(a(b.data),".call(",e.slice(0,Math.max(b.data.length+1,4)),")");case 1:return D.def(f.props,b.data);case 2:return D.def(f.context,b.data);case 3:return D.def("this",
b.data);case 4:return b.data.append(d,D),b.data.ref}};d.attribCache={};var D={};d.scopeAttrib=function(d){d=m.id(d);if(d in D)return D[d];var w=pa.scope[d];w||(w=pa.scope[d]=new da);return D[d]=a(w)};return d}function qa(d){var a=d["static"];d=d.dynamic;var b;if("profile"in a){var c=!!a.profile;b=e(function(d,a){return c});b.enable=c}else if("profile"in d){var g=d.profile;b=f(g,function(d,a){return d.invoke(a,g)})}return b}function Aa(d,a){var b=d["static"],c=d.dynamic;if("framebuffer"in b){var g=
b.framebuffer;return g?(g=P.getFramebuffer(g),e(function(d,a){var D=d.link(g),b=d.shared;a.set(b.framebuffer,".next",D);b=b.context;a.set(b,".framebufferWidth",D+".width");a.set(b,".framebufferHeight",D+".height");return D})):e(function(d,a){var D=d.shared;a.set(D.framebuffer,".next","null");D=D.context;a.set(D,".framebufferWidth",D+".drawingBufferWidth");a.set(D,".framebufferHeight",D+".drawingBufferHeight");return"null"})}if("framebuffer"in c){var K=c.framebuffer;return f(K,function(d,a){var D=
d.invoke(a,K),b=d.shared,w=b.framebuffer,D=a.def(w,".getFramebuffer(",D,")");a.set(w,".next",D);b=b.context;a.set(b,".framebufferWidth",D+"?"+D+".width:"+b+".drawingBufferWidth");a.set(b,".framebufferHeight",D+"?"+D+".height:"+b+".drawingBufferHeight");return D})}return null}function R(d,a,b){function e(d){if(d in c){var b=c[d];d=!0;var w=b.x|0,za=b.y|0,O,Na;"width"in b?O=b.width|0:d=!1;"height"in b?Na=b.height|0:d=!1;return new t(!d&&a&&a.thisDep,!d&&a&&a.contextDep,!d&&a&&a.propDep,function(d,a){var e=
d.shared.context,B=O;"width"in b||(B=a.def(e,".","framebufferWidth","-",w));var c=Na;"height"in b||(c=a.def(e,".","framebufferHeight","-",za));return[w,za,B,c]})}if(d in g){var l=g[d];d=f(l,function(d,a){var b=d.invoke(a,l),D=d.shared.context,w=a.def(b,".x|0"),za=a.def(b,".y|0"),e=a.def('"width" in ',b,"?",b,".width|0:","(",D,".","framebufferWidth","-",w,")"),b=a.def('"height" in ',b,"?",b,".height|0:","(",D,".","framebufferHeight","-",za,")");return[w,za,e,b]});a&&(d.thisDep=d.thisDep||a.thisDep,
d.contextDep=d.contextDep||a.contextDep,d.propDep=d.propDep||a.propDep);return d}return a?new t(a.thisDep,a.contextDep,a.propDep,function(d,a){var b=d.shared.context;return[0,0,a.def(b,".","framebufferWidth"),a.def(b,".","framebufferHeight")]}):null}var c=d["static"],g=d.dynamic;if(d=e("viewport")){var O=d;d=new t(d.thisDep,d.contextDep,d.propDep,function(d,a){var b=O.append(d,a),w=d.shared.context;a.set(w,".viewportWidth",b[2]);a.set(w,".viewportHeight",b[3]);return b})}return{viewport:d,scissor_box:e("scissor.box")}}
function ga(d){function a(d){if(d in b){var D=m.id(b[d]);d=e(function(){return D});d.id=D;return d}if(d in c){var w=c[d];return f(w,function(d,a){var b=d.invoke(a,w);return a.def(d.shared.strings,".id(",b,")")})}return null}var b=d["static"],c=d.dynamic,g=a("frag"),K=a("vert"),O=null;y(g)&&y(K)?(O=va.program(K.id,g.id),d=e(function(d,a){return d.link(O)})):d=new t(g&&g.thisDep||K&&K.thisDep,g&&g.contextDep||K&&K.contextDep,g&&g.propDep||K&&K.propDep,function(d,a){var b=d.shared.shader,w;w=g?g.append(d,
a):a.def(b,".","frag");var e;e=K?K.append(d,a):a.def(b,".","vert");return a.def(b+".program("+e+","+w+")")});return{frag:g,vert:K,progVar:d,program:O}}function ha(d,a){function b(d,a){if(d in c){var w=c[d]|0;return e(function(d,b){a&&(d.OFFSET=w);return w})}if(d in g){var za=g[d];return f(za,function(d,b){var w=d.invoke(b,za);a&&(d.OFFSET=w);return w})}return a&&K?e(function(d,a){d.OFFSET="0";return 0}):null}var c=d["static"],g=d.dynamic,K=function(){if("elements"in c){var d=c.elements;h(d)?d=na.getElements(na.create(d,
!0)):d&&(d=na.getElements(d));var a=e(function(a,b){if(d){var w=a.link(d);return a.ELEMENTS=w}return a.ELEMENTS=null});a.value=d;return a}if("elements"in g){var b=g.elements;return f(b,function(d,a){var w=d.shared,D=w.isBufferArgs,w=w.elements,e=d.invoke(a,b),B=a.def("null"),D=a.def(D,"(",e,")"),e=d.cond(D).then(B,"=",w,".createStream(",e,");")["else"](B,"=",w,".getElements(",e,");");a.entry(e);a.exit(d.cond(D).then(w,".destroyStream(",B,");"));return d.ELEMENTS=B})}return null}(),O=b("offset",!0);
return{elements:K,primitive:function(){if("primitive"in c){var d=c.primitive;return e(function(a,b){return J[d]})}if("primitive"in g){var a=g.primitive;return f(a,function(d,b){var w=d.constants.primTypes,e=d.invoke(b,a);return b.def(w,"[",e,"]")})}return K?y(K)?K.value?e(function(d,a){return a.def(d.ELEMENTS,".primType")}):e(function(){return 4}):new t(K.thisDep,K.contextDep,K.propDep,function(d,a){var b=d.ELEMENTS;return a.def(b,"?",b,".primType:",4)}):null}(),count:function(){if("count"in c){var d=
c.count|0;return e(function(){return d})}if("count"in g){var a=g.count;return f(a,function(d,b){return d.invoke(b,a)})}return K?y(K)?K?O?new t(O.thisDep,O.contextDep,O.propDep,function(d,a){return a.def(d.ELEMENTS,".vertCount-",d.OFFSET)}):e(function(d,a){return a.def(d.ELEMENTS,".vertCount")}):e(function(){return-1}):new t(K.thisDep||O.thisDep,K.contextDep||O.contextDep,K.propDep||O.propDep,function(d,a){var b=d.ELEMENTS;return d.OFFSET?a.def(b,"?",b,".vertCount-",d.OFFSET,":-1"):a.def(b,"?",b,".vertCount:-1")}):
null}(),instances:b("instances",!1),offset:O}}function sa(d,a){var b=d["static"],c=d.dynamic,x={};Ha.forEach(function(d){function a(D,B){if(d in b){var g=D(b[d]);x[w]=e(function(){return g})}else if(d in c){var O=c[d];x[w]=f(O,function(d,a){return B(d,a,d.invoke(a,O))})}}var w=W(d);switch(d){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return a(function(d){return d},
function(d,a,b){return b});case "depth.func":return a(function(d){return C[d]},function(d,a,b){return a.def(d.constants.compareFuncs,"[",b,"]")});case "depth.range":return a(function(d){return d},function(d,a,b){d=a.def("+",b,"[0]");a=a.def("+",b,"[1]");return[d,a]});case "blend.func":return a(function(d){return[g["srcRGB"in d?d.srcRGB:d.src],g["dstRGB"in d?d.dstRGB:d.dst],g["srcAlpha"in d?d.srcAlpha:d.src],g["dstAlpha"in d?d.dstAlpha:d.dst]]},function(d,a,b){function w(d,e){return a.def('"',d,e,
'" in ',b,"?",b,".",d,e,":",b,".",d)}d=d.constants.blendFuncs;var e=w("src","RGB"),B=w("dst","RGB"),e=a.def(d,"[",e,"]"),c=a.def(d,"[",w("src","Alpha"),"]"),B=a.def(d,"[",B,"]");d=a.def(d,"[",w("dst","Alpha"),"]");return[e,B,c,d]});case "blend.equation":return a(function(d){if("string"===typeof d)return[ka[d],ka[d]];if("object"===typeof d)return[ka[d.rgb],ka[d.alpha]]},function(d,a,b){var w=d.constants.blendEquations,e=a.def(),B=a.def();d=d.cond("typeof ",b,'==="string"');d.then(e,"=",B,"=",w,"[",
b,"];");d["else"](e,"=",w,"[",b,".rgb];",B,"=",w,"[",b,".alpha];");a(d);return[e,B]});case "blend.color":return a(function(d){return A(4,function(a){return+d[a]})},function(d,a,b){return A(4,function(d){return a.def("+",b,"[",d,"]")})});case "stencil.mask":return a(function(d){return d|0},function(d,a,b){return a.def(b,"|0")});case "stencil.func":return a(function(d){return[C[d.cmp||"keep"],d.ref||0,"mask"in d?d.mask:-1]},function(d,a,b){d=a.def('"cmp" in ',b,"?",d.constants.compareFuncs,"[",b,".cmp]",
":",7680);var w=a.def(b,".ref|0");a=a.def('"mask" in ',b,"?",b,".mask|0:-1");return[d,w,a]});case "stencil.opFront":case "stencil.opBack":return a(function(a){return["stencil.opBack"===d?1029:1028,I[a.fail||"keep"],I[a.zfail||"keep"],I[a.zpass||"keep"]]},function(a,b,w){function e(d){return b.def('"',d,'" in ',w,"?",B,"[",w,".",d,"]:",7680)}var B=a.constants.stencilOps;return["stencil.opBack"===d?1029:1028,e("fail"),e("zfail"),e("zpass")]});case "polygonOffset.offset":return a(function(d){return[d.factor|
0,d.units|0]},function(d,a,b){d=a.def(b,".factor|0");a=a.def(b,".units|0");return[d,a]});case "cull.face":return a(function(d){var a=0;"front"===d?a=1028:"back"===d&&(a=1029);return a},function(d,a,b){return a.def(b,'==="front"?',1028,":",1029)});case "lineWidth":return a(function(d){return d},function(d,a,b){return b});case "frontFace":return a(function(d){return l[d]},function(d,a,b){return a.def(b+'==="cw"?2304:2305')});case "colorMask":return a(function(d){return d.map(function(d){return!!d})},
function(d,a,b){return A(4,function(d){return"!!"+b+"["+d+"]"})});case "sample.coverage":return a(function(d){return["value"in d?d.value:1,!!d.invert]},function(d,a,b){d=a.def('"value" in ',b,"?+",b,".value:1");a=a.def("!!",b,".invert");return[d,a]})}});return x}function ia(d,a){var b=d["static"],c=d.dynamic,g={};Object.keys(b).forEach(function(d){var a=b[d],w;if("number"===typeof a||"boolean"===typeof a)w=e(function(){return a});else if("function"===typeof a){var B=a._reglType;if("texture2d"===B||
"textureCube"===B)w=e(function(d){return d.link(a)});else if("framebuffer"===B||"framebufferCube"===B)w=e(function(d){return d.link(a.color[0])})}else z(a)&&(w=e(function(d){return d.global.def("[",A(a.length,function(d){return a[d]}),"]")}));w.value=a;g[d]=w});Object.keys(c).forEach(function(d){var a=c[d];g[d]=f(a,function(d,b){return d.invoke(b,a)})});return g}function X(d,a){var b=d["static"],c=d.dynamic,g={};Object.keys(b).forEach(function(d){var a=b[d],w=m.id(d),B=new da;if(h(a))B.state=1,B.buffer=
F.getBuffer(F.create(a,34962,!1,!0)),B.type=B.buffer.dtype;else{var c=F.getBuffer(a);if(c)B.state=1,B.buffer=c,B.type=c.dtype;else if(a.constant){var f=a.constant;B.buffer="null";B.state=2;"number"===typeof f?B.x=f:H.forEach(function(d,a){a<f.length&&(B[d]=f[a])})}else{var c=h(a.buffer)?F.getBuffer(F.create(a.buffer,34962,!1,!0)):F.getBuffer(a.buffer),l=a.offset|0,x=a.stride|0,u=a.size|0,p=!!a.normalized,k=0;"type"in a&&(k=v[a.type]);a=a.divisor|0;B.buffer=c;B.state=1;B.size=u;B.normalized=p;B.type=
k||c.dtype;B.offset=l;B.stride=x;B.divisor=a}}g[d]=e(function(d,a){var b=d.attribCache;if(w in b)return b[w];var e={isStream:!1};Object.keys(B).forEach(function(d){e[d]=B[d]});B.buffer&&(e.buffer=d.link(B.buffer));return b[w]=e})});Object.keys(c).forEach(function(d){var a=c[d];g[d]=f(a,function(d,b){function w(d){b(f[d],"=",e,".",d,"|0;")}var e=d.invoke(b,a),B=d.shared,c=B.isBufferArgs,g=B.buffer,f={isStream:b.def(!1)},l=new da;l.state=1;Object.keys(l).forEach(function(d){f[d]=b.def(""+l[d])});var x=
f.buffer,u=f.type;b("if(",c,"(",e,")){",f.isStream,"=true;",x,"=",g,".createStream(",34962,",",e,");",u,"=",x,".dtype;","}else{",x,"=",g,".getBuffer(",e,");","if(",x,"){",u,"=",x,".dtype;",'}else if("constant" in ',e,"){",f.state,"=",2,";","if(typeof "+e+'.constant === "number"){',f[H[0]],"=",e,".constant;",H.slice(1).map(function(d){return f[d]}).join("="),"=0;","}else{",H.map(function(d,a){return f[d]+"="+e+".constant.length>="+a+"?"+e+".constant["+a+"]:0;"}).join(""),"}}else{","if(",c,"(",e,".buffer)){",
x,"=",g,".createStream(",34962,",",e,".buffer);","}else{",x,"=",g,".getBuffer(",e,".buffer);","}",u,'="type" in ',e,"?",B.glTypes,"[",e,".type]:",x,".dtype;",f.normalized,"=!!",e,".normalized;");w("size");w("offset");w("stride");w("divisor");b("}}");b.exit("if(",f.isStream,"){",g,".destroyStream(",x,");","}");return f})});return g}function ta(d){var a=d["static"],b=d.dynamic,c={};Object.keys(a).forEach(function(d){var b=a[d];c[d]=e(function(d,a){return"number"===typeof b||"boolean"===typeof b?""+
b:d.link(b)})});Object.keys(b).forEach(function(d){var a=b[d];c[d]=f(a,function(d,b){return d.invoke(b,a)})});return c}function ra(d,a,b,e,c){var g=Aa(d,c),f=R(d,g,c),x=ha(d,c),l=sa(d,c),u=ga(d,c),h=f.viewport;h&&(l.viewport=h);h=W("scissor.box");(f=f[h])&&(l[h]=f);f=0<Object.keys(l).length;g={framebuffer:g,draw:x,shader:u,state:l,dirty:f};g.profile=qa(d,c);g.uniforms=ia(b,c);g.attributes=X(a,c);g.context=ta(e,c);return g}function M(d,a,b){var e=d.shared.context,c=d.scope();Object.keys(b).forEach(function(g){a.save(e,
"."+g);c(e,".",g,"=",b[g].append(d,a),";")});a(c)}function ba(a,b,e,c){var g=a.shared,f=g.gl,x=g.framebuffer,l;d&&(l=b.def(g.extensions,".webgl_draw_buffers"));var u=a.constants,g=u.drawBuffer,u=u.backBuffer;a=e?e.append(a,b):b.def(x,".next");c||b("if(",a,"!==",x,".cur){");b("if(",a,"){",f,".bindFramebuffer(",36160,",",a,".framebuffer);");d&&b(l,".drawBuffersWEBGL(",g,"[",a,".colorAttachments.length]);");b("}else{",f,".bindFramebuffer(",36160,",null);");d&&b(l,".drawBuffersWEBGL(",u,");");b("}",x,
".cur=",a,";");c||b("}")}function ea(d,a,b){var e=d.shared,c=e.gl,g=d.current,f=d.next,x=e.current,l=e.next,h=d.cond(x,".dirty");Ha.forEach(function(a){a=W(a);if(!(a in b.state)){var e,B;if(a in f){e=f[a];B=g[a];var p=A(u[a].length,function(d){return h.def(e,"[",d,"]")});h(d.cond(p.map(function(d,a){return d+"!=="+B+"["+a+"]"}).join("||")).then(c,".",xa[a],"(",p,");",p.map(function(d,a){return B+"["+a+"]="+d}).join(";"),";"))}else e=h.def(l,".",a),p=d.cond(e,"!==",x,".",a),h(p),a in wa?p(d.cond(e).then(c,
".enable(",wa[a],");")["else"](c,".disable(",wa[a],");"),x,".",a,"=",e,";"):p(c,".",xa[a],"(",e,");",x,".",a,"=",e,";")}});0===Object.keys(b.state).length&&h(x,".dirty=false;");a(h)}function Q(d,b,e,c){var g=d.shared,f=d.current,x=g.current,l=g.gl;a(Object.keys(e)).forEach(function(a){var g=e[a];if(!c||c(g)){var u=g.append(d,b);if(wa[a]){var h=wa[a];y(g)?u?b(l,".enable(",h,");"):b(l,".disable(",h,");"):b(d.cond(u).then(l,".enable(",h,");")["else"](l,".disable(",h,");"));b(x,".",a,"=",u,";")}else if(z(u)){var p=
f[a];b(l,".",xa[a],"(",u,");",u.map(function(d,a){return p+"["+a+"]="+d}).join(";"),";")}else b(l,".",xa[a],"(",u,");",x,".",a,"=",u,";")}})}function S(d,a){la&&(d.instancing=a.def(d.shared.extensions,".angle_instanced_arrays"))}function V(d,a,b,e,c){function g(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function f(d){t=a.def();d(t,"=",g(),";");"string"===typeof c?d(h,".count+=",c,";"):d(h,".count++;");aa&&(e?(n=a.def(),d(n,"=",k,".getNumPendingQueries();")):d(k,".beginQuery(",
h,");"))}function x(d){d(h,".cpuTime+=",g(),"-",t,";");aa&&(e?d(k,".pushScopeStats(",n,",",k,".getNumPendingQueries(),",h,");"):d(k,".endQuery();"))}function l(d){var b=a.def(p,".profile");a(p,".profile=",d,";");a.exit(p,".profile=",b,";")}var u=d.shared,h=d.stats,p=u.current,k=u.timer;b=b.profile;var t,n;if(b){if(y(b)){b.enable?(f(a),x(a.exit),l("true")):l("false");return}b=b.append(d,a);l(b)}else b=a.def(p,".profile");u=d.block();f(u);a("if(",b,"){",u,"}");d=d.block();x(d);a.exit("if(",b,"){",d,
"}")}function Y(d,a,e,c,g){function f(d){switch(d){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function x(b,e,c){function g(){a("if(!",p,".buffer){",u,".enableVertexAttribArray(",h,");}");var b=c.type,f;f=c.size?a.def(c.size,"||",e):e;a("if(",p,".type!==",b,"||",p,".size!==",f,"||",n.map(function(d){return p+"."+d+"!=="+c[d]}).join("||"),"){",u,".bindBuffer(",34962,",",k,".buffer);",u,".vertexAttribPointer(",
[h,f,b,c.normalized,c.stride,c.offset],");",p,".type=",b,";",p,".size=",f,";",n.map(function(d){return p+"."+d+"="+c[d]+";"}).join(""),"}");la&&(b=c.divisor,a("if(",p,".divisor!==",b,"){",d.instancing,".vertexAttribDivisorANGLE(",[h,b],");",p,".divisor=",b,";}"))}function f(){a("if(",p,".buffer){",u,".disableVertexAttribArray(",h,");","}if(",H.map(function(d,a){return p+"."+d+"!=="+t[a]}).join("||"),"){",u,".vertexAttrib4f(",h,",",t,");",H.map(function(d,a){return p+"."+d+"="+t[a]+";"}).join(""),
"}")}var u=l.gl,h=a.def(b,".location"),p=a.def(l.attributes,"[",h,"]");b=c.state;var k=c.buffer,t=[c.x,c.y,c.z,c.w],n=["buffer","normalized","offset","stride"];1===b?g():2===b?f():(a("if(",b,"===",1,"){"),g(),a("}else{"),f(),a("}"))}var l=d.shared;c.forEach(function(c){var l=c.name,u=e.attributes[l],h;if(u){if(!g(u))return;h=u.append(d,a)}else{if(!g(b))return;var p=d.scopeAttrib(l);h={};Object.keys(new da).forEach(function(d){h[d]=a.def(p,".",d)})}x(d.link(c),f(c.info.type),h)})}function fa(d,a,e,
c,g){for(var f=d.shared,l=f.gl,u,x=0;x<c.length;++x){var h=c[x],p=h.name,k=h.info.type,t=e.uniforms[p],h=d.link(h)+".location",n;if(t){if(!g(t))continue;if(y(t)){p=t.value;if(35678===k||35680===k)k=d.link(p._texture||p.color[0]._texture),a(l,".uniform1i(",h,",",k+".bind());"),a.exit(k,".unbind();");else if(35674===k||35675===k||35676===k)p=d.global.def("new Float32Array(["+Array.prototype.slice.call(p)+"])"),t=2,35675===k?t=3:35676===k&&(t=4),a(l,".uniformMatrix",t,"fv(",h,",false,",p,");");else{switch(k){case 5126:u=
"1f";break;case 35664:u="2f";break;case 35665:u="3f";break;case 35666:u="4f";break;case 35670:u="1i";break;case 5124:u="1i";break;case 35671:u="2i";break;case 35667:u="2i";break;case 35672:u="3i";break;case 35668:u="3i";break;case 35673:u="4i";break;case 35669:u="4i"}a(l,".uniform",u,"(",h,",",z(p)?Array.prototype.slice.call(p):p,");")}continue}else n=t.append(d,a)}else{if(!g(b))continue;n=a.def(f.uniforms,"[",m.id(p),"]")}35678===k?a("if(",n,"&&",n,'._reglType==="framebuffer"){',n,"=",n,".color[0];",
"}"):35680===k&&a("if(",n,"&&",n,'._reglType==="framebufferCube"){',n,"=",n,".color[0];","}");p=1;switch(k){case 35678:case 35680:k=a.def(n,"._texture");a(l,".uniform1i(",h,",",k,".bind());");a.exit(k,".unbind();");continue;case 5124:case 35670:u="1i";break;case 35667:case 35671:u="2i";p=2;break;case 35668:case 35672:u="3i";p=3;break;case 35669:case 35673:u="4i";p=4;break;case 5126:u="1f";break;case 35664:u="2f";p=2;break;case 35665:u="3f";p=3;break;case 35666:u="4f";p=4;break;case 35674:u="Matrix2fv";
break;case 35675:u="Matrix3fv";break;case 35676:u="Matrix4fv"}a(l,".uniform",u,"(",h,",");if("M"===u.charAt(0)){var h=Math.pow(k-35674+2,2),q=d.global.def("new Float32Array(",h,")");a("false,(Array.isArray(",n,")||",n," instanceof Float32Array)?",n,":(",A(h,function(d){return q+"["+d+"]="+n+"["+d+"]"}),",",q,")")}else 1<p?a(A(p,function(d){return n+"["+d+"]"})):a(n);a(");")}}function ca(d,a,b,e){function c(g){var f=p[g];return f?f.contextDep&&e.contextDynamic||f.propDep?f.append(d,b):f.append(d,a):
a.def(x,".",g)}function g(){function d(){b(v,".drawElementsInstancedANGLE(",[k,t,A,n+"<<(("+A+"-5121)>>1)",q],");")}function a(){b(v,".drawArraysInstancedANGLE(",[k,n,t,q],");")}h?L?d():(b("if(",h,"){"),d(),b("}else{"),a(),b("}")):a()}function f(){function d(){b(l+".drawElements("+[k,t,A,n+"<<(("+A+"-5121)>>1)"]+");")}function a(){b(l+".drawArrays("+[k,n,t]+");")}h?L?d():(b("if(",h,"){"),d(),b("}else{"),a(),b("}")):a()}var u=d.shared,l=u.gl,x=u.draw,p=e.draw,h=function(){var c=p.elements,g=a;if(c){if(c.contextDep&&
e.contextDynamic||c.propDep)g=b;c=c.append(d,g)}else c=g.def(x,".","elements");c&&g("if("+c+")"+l+".bindBuffer(34963,"+c+".buffer.buffer);");return c}(),k=c("primitive"),n=c("offset"),t=function(){var c=p.count,g=a;if(c){if(c.contextDep&&e.contextDynamic||c.propDep)g=b;c=c.append(d,g)}else c=g.def(x,".","count");return c}();if("number"===typeof t){if(0===t)return}else b("if(",t,"){"),b.exit("}");var q,v;la&&(q=c("instances"),v=d.instancing);var A=h+".type",L=p.elements&&y(p.elements);la&&("number"!==
typeof q||0<=q)?"string"===typeof q?(b("if(",q,">0){"),g(),b("}else if(",q,"<0){"),f(),b("}")):g():f()}function Ca(d,a,b,e,c){a=ya();c=a.proc("body",c);la&&(a.instancing=c.def(a.shared.extensions,".angle_instanced_arrays"));d(a,c,b,e);return a.compile().body}function Da(d,a,b,c){S(d,a);Y(d,a,b,c.attributes,function(){return!0});fa(d,a,b,c.uniforms,function(){return!0});ca(d,a,a,b)}function Ea(d,a){var b=d.proc("draw",1);S(d,b);M(d,b,a.context);ba(d,b,a.framebuffer);ea(d,b,a);Q(d,b,a.state);V(d,b,
a,!1,!0);var c=a.shader.progVar.append(d,b);b(d.shared.gl,".useProgram(",c,".program);");if(a.shader.program)Da(d,b,a,a.shader.program);else{var e=d.global.def("{}"),g=b.def(c,".id"),f=b.def(e,"[",g,"]");b(d.cond(f).then(f,".call(this,a0);")["else"](f,"=",e,"[",g,"]=",d.link(function(b){return Ca(Da,d,a,b,1)}),"(",c,");",f,".call(this,a0);"))}0<Object.keys(a.state).length&&b(d.shared.current,".dirty=true;")}function Fa(d,a,b,c){function e(){return!0}d.batchId="a1";S(d,a);Y(d,a,b,c.attributes,e);fa(d,
a,b,c.uniforms,e);ca(d,a,a,b)}function ua(d,a,b,c){function e(d){return d.contextDep&&f||d.propDep}function g(d){return!e(d)}S(d,a);var f=b.contextDep,u=a.def(),l=a.def();d.shared.props=l;d.batchId=u;var x=d.scope(),p=d.scope();a(x.entry,"for(",u,"=0;",u,"<","a1",";++",u,"){",l,"=","a0","[",u,"];",p,"}",x.exit);b.needsContext&&M(d,p,b.context);b.needsFramebuffer&&ba(d,p,b.framebuffer);Q(d,p,b.state,e);b.profile&&e(b.profile)&&V(d,p,b,!1,!0);c?(Y(d,x,b,c.attributes,g),Y(d,p,b,c.attributes,e),fa(d,
x,b,c.uniforms,g),fa(d,p,b,c.uniforms,e),ca(d,x,p,b)):(a=d.global.def("{}"),c=b.shader.progVar.append(d,p),l=p.def(c,".id"),x=p.def(a,"[",l,"]"),p(d.shared.gl,".useProgram(",c,".program);","if(!",x,"){",x,"=",a,"[",l,"]=",d.link(function(a){return Ca(Fa,d,b,a,2)}),"(",c,");}",x,".call(this,a0[",u,"],",u,");"))}function Ma(d,a){function b(d){return d.contextDep&&e||d.propDep}var c=d.proc("batch",2);d.batchId="0";S(d,c);var e=!1,g=!0;Object.keys(a.context).forEach(function(d){e=e||a.context[d].propDep});
e||(M(d,c,a.context),g=!1);var f=a.framebuffer,u=!1;f?(f.propDep?e=u=!0:f.contextDep&&e&&(u=!0),u||ba(d,c,f)):ba(d,c,null);a.state.viewport&&a.state.viewport.propDep&&(e=!0);ea(d,c,a);Q(d,c,a.state,function(d){return!b(d)});a.profile&&b(a.profile)||V(d,c,a,!1,"a1");a.contextDep=e;a.needsContext=g;a.needsFramebuffer=u;g=a.shader.progVar;if(g.contextDep&&e||g.propDep)ua(d,c,a,null);else if(g=g.append(d,c),c(d.shared.gl,".useProgram(",g,".program);"),a.shader.program)ua(d,c,a,a.shader.program);else{var f=
d.global.def("{}"),u=c.def(g,".id"),l=c.def(f,"[",u,"]");c(d.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",f,"[",u,"]=",d.link(function(b){return Ca(ua,d,a,b,2)}),"(",g,");",l,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&c(d.shared.current,".dirty=true;")}function Ja(d,b){function c(a){var f=b.shader[a];f&&e.set(g.shader,"."+a,f.append(d,e))}var e=d.proc("scope",3);d.batchId="a2";var g=d.shared,f=g.current;M(d,e,b.context);b.framebuffer&&b.framebuffer.append(d,e);a(Object.keys(b.state)).forEach(function(a){var c=
b.state[a].append(d,e);z(c)?c.forEach(function(b,c){e.set(d.next[a],"["+c+"]",b)}):e.set(g.next,"."+a,c)});V(d,e,b,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(a){var c=b.draw[a];c&&e.set(g.draw,"."+a,""+c.append(d,e))});Object.keys(b.uniforms).forEach(function(a){e.set(g.uniforms,"["+m.id(a)+"]",b.uniforms[a].append(d,e))});Object.keys(b.attributes).forEach(function(a){var c=b.attributes[a].append(d,e),g=d.scopeAttrib(a);Object.keys(new da).forEach(function(d){e.set(g,
"."+d,c[d])})});c("vert");c("frag");0<Object.keys(b.state).length&&(e(f,".dirty=true;"),e.exit(f,".dirty=true;"));e("a1(",d.shared.context,",a0,",d.batchId,");")}function Ka(d){if("object"===typeof d&&!z(d)){for(var a=Object.keys(d),b=0;b<a.length;++b)if(q.isDynamic(d[a[b]]))return!0;return!1}}function La(d,a,b){function c(d,a){u.forEach(function(b){var c=e[b];q.isDynamic(c)&&(c=d.invoke(a,c),a(h,".",b,"=",c,";"))})}var e=a["static"][b];if(e&&Ka(e)){var g=d.global,u=Object.keys(e),l=!1,x=!1,p=!1,
h=d.global.def("{}");u.forEach(function(a){var b=e[a];if(q.isDynamic(b))"function"===typeof b&&(b=e[a]=q.unbox(b)),a=f(b,null),l=l||a.thisDep,p=p||a.propDep,x=x||a.contextDep;else{g(h,".",a,"=");switch(typeof b){case "number":g(b);break;case "string":g('"',b,'"');break;case "object":Array.isArray(b)&&g("[",b.join(),"]");break;default:g(d.link(b))}g(";")}});a.dynamic[b]=new q.DynamicVariable(4,{thisDep:l,contextDep:x,propDep:p,ref:h,append:c});delete a["static"][b]}}var da=pa.Record,ka={add:32774,
subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(ka.min=32775,ka.max=32776);var la=r.angle_instanced_arrays,d=r.webgl_draw_buffers,u={dirty:!0,profile:ja.profile},x={},Ha=[],wa={},xa={};N("dither",3024);N("blend.enable",3042);E("blend.color","blendColor",[0,0,0,0]);E("blend.equation","blendEquationSeparate",[32774,32774]);E("blend.func","blendFuncSeparate",[1,0,1,0]);N("depth.enable",2929,!0);E("depth.func","depthFunc",513);E("depth.range","depthRange",[0,1]);E("depth.mask","depthMask",
!0);E("colorMask","colorMask",[!0,!0,!0,!0]);N("cull.enable",2884);E("cull.face","cullFace",1029);E("frontFace","frontFace",2305);E("lineWidth","lineWidth",1);N("polygonOffset.enable",32823);E("polygonOffset.offset","polygonOffset",[0,0]);N("sample.alpha",32926);N("sample.enable",32928);E("sample.coverage","sampleCoverage",[1,!1]);N("stencil.enable",2960);E("stencil.mask","stencilMask",-1);E("stencil.func","stencilFunc",[519,0,-1]);E("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);E("stencil.opBack",
"stencilOpSeparate",[1029,7680,7680,7680]);N("scissor.enable",3089);E("scissor.box","scissor",[0,0,k.drawingBufferWidth,k.drawingBufferHeight]);E("viewport","viewport",[0,0,k.drawingBufferWidth,k.drawingBufferHeight]);var Oa={gl:k,context:Z,strings:m,next:x,current:u,draw:p,elements:na,buffer:F,shader:va,attributes:pa.state,uniforms:T,framebuffer:P,extensions:r,timer:aa,isBufferArgs:h},Ia={primTypes:J,compareFuncs:C,blendFuncs:g,blendEquations:ka,stencilOps:I,glTypes:v,orientationType:l};d&&(Ia.backBuffer=
[1029],Ia.drawBuffer=A(G.maxDrawbuffers,function(d){return 0===d?[0]:A(d,function(d){return 36064+d})}));var Pa=0;return{next:x,current:u,procs:function(){var d=ya(),a=d.proc("poll"),b=d.proc("refresh"),c=d.block();a(c);b(c);var e=d.shared,g=e.gl,f=e.next,l=e.current;c(l,".dirty=false;");ba(d,a);ba(d,b,null,!0);var x=k.getExtension("angle_instanced_arrays"),p;x&&(p=d.link(x));for(var h=0;h<G.maxAttributes;++h){var n=b.def(e.attributes,"[",h,"]"),t=d.cond(n,".buffer");t.then(g,".enableVertexAttribArray(",
h,");",g,".bindBuffer(",34962,",",n,".buffer.buffer);",g,".vertexAttribPointer(",h,",",n,".size,",n,".type,",n,".normalized,",n,".stride,",n,".offset);")["else"](g,".disableVertexAttribArray(",h,");",g,".vertexAttrib4f(",h,",",n,".x,",n,".y,",n,".z,",n,".w);",n,".buffer=null;");b(t);x&&b(p,".vertexAttribDivisorANGLE(",h,",",n,".divisor);")}Object.keys(wa).forEach(function(e){var u=wa[e],x=c.def(f,".",e),p=d.block();p("if(",x,"){",g,".enable(",u,")}else{",g,".disable(",u,")}",l,".",e,"=",x,";");b(p);
a("if(",x,"!==",l,".",e,"){",p,"}")});Object.keys(xa).forEach(function(e){var x=xa[e],p=u[e],h,n,k=d.block();k(g,".",x,"(");z(p)?(x=p.length,h=d.global.def(f,".",e),n=d.global.def(l,".",e),k(A(x,function(d){return h+"["+d+"]"}),");",A(x,function(d){return n+"["+d+"]="+h+"["+d+"];"}).join("")),a("if(",A(x,function(d){return h+"["+d+"]!=="+n+"["+d+"]"}).join("||"),"){",k,"}")):(h=c.def(f,".",e),n=c.def(l,".",e),k(h,");",l,".",e,"=",h,";"),a("if(",h,"!==",n,"){",k,"}"));b(k)});return d.compile()}(),
compile:function(d,a,b,e,c){var g=ya();g.stats=g.link(c);Object.keys(a["static"]).forEach(function(d){La(g,a,d)});n.forEach(function(a){La(g,d,a)});b=ra(d,a,b,e,g);Ea(g,b);Ja(g,b);Ma(g,b);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(k,m,r){function h(a,f){this.id=y++;this.type=a;this.data=f}function a(e){if(0===e.length)return[];
var f=e.charAt(0),c=e.charAt(e.length-1);if(1<e.length&&f===c&&('"'===f||"'"===f))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(f=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return a(e.substr(0,f.index)).concat(a(f[1])).concat(a(e.substr(f.index+f[0].length)));f=e.split(".");if(1===f.length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];e=[];for(c=0;c<f.length;++c)e=e.concat(a(f[c]));return e}function t(e){return"["+a(e).join("][")+"]"}var y=
0;m.exports={DynamicVariable:h,define:function(a,f){return new h(a,t(f+""))},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof h},unbox:function(a,f){return"function"===typeof a?new h(0,a):a},accessor:t}},{}],10:[function(k,m,r){var h=k("./util/is-typed-array"),a=k("./util/is-ndarray"),t=k("./util/values"),y=k("./constants/primitives.json"),e=k("./constants/usage.json");m.exports=function(f,c,k,m){function r(a){this.id=v++;J[this.id]=this;this.buffer=a;this.primType=4;
this.type=this.vertCount=0}function z(e,f,n,l,b,t,q){(t=q)||h(f)&&(!a(f)||h(f.data))||(t=c.oes_element_index_uint?5125:5123);e.buffer.bind();k._initBuffer(e.buffer,f,n,t,3);f=q;if(!q){switch(e.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;break;case 5125:case 5124:f=5125}e.buffer.dtype=f}e.type=f;0>b&&(b=e.buffer.byteLength,5123===f?b>>=1:5125===f&&(b>>=2));e.vertCount=b;b=l;0>l&&(b=4,l=e.buffer.dimension,1===l&&(b=0),2===l&&(b=1),3===l&&(b=4));e.primType=b}function q(a){m.elementsCount--;
delete J[a.id];a.buffer.destroy();a.buffer=null}var J={},v=0,H={uint8:5121,uint16:5123};c.oes_element_index_uint&&(H.uint32=5125);r.prototype.bind=function(){this.buffer.bind()};var n=[];return{create:function(c,n){function t(c){if(c)if("number"===typeof c)l(c),b.primType=4,b.vertCount=c|0,b.type=5121;else{var g=null,n=35044,k=-1,q=-1,v=0,A=0;Array.isArray(c)||h(c)||a(c)?g=c:("data"in c&&(g=c.data),"usage"in c&&(n=e[c.usage]),"primitive"in c&&(k=y[c.primitive]),"count"in c&&(q=c.count|0),"length"in
c&&(v=c.length|0),"type"in c&&(A=H[c.type]));g?z(b,g,n,k,q,v,A):(c=b.buffer,c.bind(),f.bufferData(34963,v,n),c.dtype=A||5121,c.usage=n,c.dimension=3,c.byteLength=v,b.primType=0>k?4:k,b.vertCount=0>q?0:q,b.type=c.dtype)}else l(),b.primType=4,b.vertCount=0,b.type=5121;return t}var l=k.create(null,34963,!0),b=new r(l._buffer);m.elementsCount++;t(c);t._reglType="elements";t._elements=b;t.subdata=function(a,b){l.subdata(a,b);return t};t.destroy=function(){q(b)};return t},createStream:function(a){var c=
n.pop();c||(c=new r(k.create(null,34963,!0,!1)._buffer));z(c,a,35040,-1,-1,0,0);return c},destroyStream:function(a){n.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof r?a._elements:null},clear:function(){t(J).forEach(q)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(k,m,r){m.exports=function(h,a){function k(a){a=a.toLowerCase();var e;try{e=y[a]=h.getExtension(a)}catch(f){}return!!e}
for(var y={},e=0;e<a.extensions.length;++e){var f=a.extensions[e];if(!k(f))return a.onDestroy(),a.onDone('"'+f+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}a.optionalExtensions.forEach(k);return{extensions:y,restore:function(){Object.keys(y).forEach(function(a){if(!k(a))throw Error("(regl): error restoring extension "+a);})}}}},{}],12:[function(k,m,r){var h=k("./util/values"),a=k("./util/extend"),t=[];t[6408]=4;var y=[];y[5121]=
1;y[5126]=4;y[36193]=2;m.exports=function(e,f,c,k,m,r){function z(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var e=a=0;b?(a=b.width,e=b.height):c&&(a=c.width,e=c.height);this.width=a;this.height=e}function q(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function J(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function v(a,b){b?b.texture?e.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,
0):e.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):e.framebufferTexture2D(36160,a,3553,null,0)}function H(a){var b=3553,c=null,e=null,g=a;"object"===typeof a&&(g=a.data,"target"in a&&(b=a.target|0));a=g._reglType;"texture2d"===a?c=g:"textureCube"===a?c=g:"renderbuffer"===a&&(e=g,b=36161);return new z(b,c,e)}function n(a,b,c,e,g){if(c)return a=k.create2D({width:a,height:b,format:e,type:g}),a._texture.refCount=0,new z(3553,a,null);a=m.create({width:a,height:b,format:e});
a._renderbuffer.refCount=0;return new z(36161,null,a)}function g(a){return a&&(a.texture||a.renderbuffer)}function C(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function I(){this.id=oa++;P[this.id]=this;this.framebuffer=e.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function l(a){a.colorAttachments.forEach(q);q(a.depthAttachment);q(a.stencilAttachment);q(a.depthStencilAttachment)}
function b(a){e.deleteFramebuffer(a.framebuffer);a.framebuffer=null;r.framebufferCount--;delete P[a.id]}function L(a){var b;e.bindFramebuffer(36160,a.framebuffer);var g=a.colorAttachments;for(b=0;b<g.length;++b)v(36064+b,g[b]);for(b=g.length;b<c.maxColorAttachments;++b)v(36064+b,null);v(36096,a.depthAttachment);v(36128,a.stencilAttachment);v(33306,a.depthStencilAttachment);e.checkFramebufferStatus(36160);e.bindFramebuffer(36160,ma.next);ma.cur=ma.next;e.getError()}function U(c,e){function f(a,b){var c,
e=0,k=0,q=!0,v=!0;c=null;var A=!0,m="rgba",r="uint8",z=1,C=null,F=null,I=null,G=!1;if("number"===typeof a)e=a|0,k=b|0||e;else if(a){"shape"in a?(k=a.shape,e=k[0],k=k[1]):("radius"in a&&(e=k=a.radius),"width"in a&&(e=a.width),"height"in a&&(k=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);if(!c){"colorCount"in a&&(z=a.colorCount|0);"colorTexture"in a&&(A=!!a.colorTexture,m="rgba4");if("colorType"in a&&(r=a.colorType,!A))if("half float"===r||"float16"===r)m="rgba16f";else if("float"===
r||"float32"===r)m="rgba32f";"colorFormat"in a&&(m=a.colorFormat,0<=Ga.indexOf(m)?A=!0:0<=Ba.indexOf(m)&&(A=!1))}if("depthTexture"in a||"depthStencilTexture"in a)G=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?q=a.depth:(C=a.depth,v=!1));"stencil"in a&&("boolean"===typeof a.stencil?v=a.stencil:(F=a.stencil,q=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?q=v=a.depthStencil:(I=a.depthStencil,v=q=!1))}else e=k=1;var U=null,T=null,M=null,ma=null;if(Array.isArray(c))U=
c.map(H);else if(c)U=[H(c)];else for(U=Array(z),c=0;c<z;++c)U[c]=n(e,k,A,m,r);e=e||U[0].width;k=k||U[0].height;C?T=H(C):q&&!v&&(T=n(e,k,G,"depth","uint32"));F?M=H(F):v&&!q&&(M=n(e,k,!1,"stencil","uint8"));I?ma=H(I):!C&&!F&&v&&q&&(ma=n(e,k,G,"depth stencil","depth stencil"));q=null;for(c=0;c<U.length;++c)J(U[c],e,k),U[c]&&U[c].texture&&(v=t[U[c].texture._texture.format]*y[U[c].texture._texture.type],null===q&&(q=v));J(T,e,k);J(M,e,k);J(ma,e,k);l(h);h.width=e;h.height=k;h.colorAttachments=U;h.depthAttachment=
T;h.stencilAttachment=M;h.depthStencilAttachment=ma;f.color=U.map(g);f.depth=g(T);f.stencil=g(M);f.depthStencil=g(ma);f.width=h.width;f.height=h.height;L(h);return f}var h=new I;r.framebufferCount++;f(c,e);return a(f,{resize:function(a,b){var c=a|0,e=b|0||c;if(c===h.width&&e===h.height)return f;for(var g=h.colorAttachments,l=0;l<g.length;++l)C(g[l],c,e);C(h.depthAttachment,c,e);C(h.stencilAttachment,c,e);C(h.depthStencilAttachment,c,e);h.width=f.width=c;h.height=f.height=e;L(h);return f},_reglType:"framebuffer",
_framebuffer:h,destroy:function(){b(h);l(h)}})}var ma={cur:null,next:null,dirty:!1},Ga=["rgba"],Ba=["rgba4","rgb565","rgb5 a1"];f.ext_srgb&&Ba.push("srgba");f.ext_color_buffer_half_float&&Ba.push("rgba16f","rgb16f");f.webgl_color_buffer_float&&Ba.push("rgba32f");var na=["uint8"];f.oes_texture_half_float&&na.push("half float","float16");f.oes_texture_float&&na.push("float","float32");var oa=0,P={};return a(ma,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=
a._framebuffer,a instanceof I)?a:null},create:U,createCube:function(b){function c(b){var g,f={color:null},h=0,l=null;g="rgba";var n="uint8",t=1;if("number"===typeof b)h=b|0;else if(b){"shape"in b?h=b.shape[0]:("radius"in b&&(h=b.radius|0),"width"in b?h=b.width|0:"height"in b&&(h=b.height|0));if("color"in b||"colors"in b)l=b.color||b.colors,Array.isArray(l);l||("colorCount"in b&&(t=b.colorCount|0),"colorType"in b&&(n=b.colorType),"colorFormat"in b&&(g=b.colorFormat));"depth"in b&&(f.depth=b.depth);
"stencil"in b&&(f.stencil=b.stencil);"depthStencil"in b&&(f.depthStencil=b.depthStencil)}else h=1;if(l)if(Array.isArray(l))for(b=[],g=0;g<l.length;++g)b[g]=l[g];else b=[l];else for(b=Array(t),l={radius:h,format:g,type:n},g=0;g<t;++g)b[g]=k.createCube(l);f.color=Array(b.length);for(g=0;g<b.length;++g)t=b[g],h=h||t.width,f.color[g]={target:34069,data:b[g]};for(g=0;6>g;++g){for(t=0;t<b.length;++t)f.color[t].target=34069+g;0<g&&(f.depth=e[0].depth,f.stencil=e[0].stencil,f.depthStencil=e[0].depthStencil);
if(e[g])e[g](f);else e[g]=U(f)}return a(c,{width:h,height:h,color:b})}var e=Array(6);c(b);return a(c,{faces:e,resize:function(a){var b=a|0;if(b===c.width)return c;var g=c.color;for(a=0;a<g.length;++a)g[a].resize(b);for(a=0;6>a;++a)e[a].resize(b);c.width=c.height=b;return c},_reglType:"framebufferCube",destroy:function(){e.forEach(function(a){a.destroy()})}})},clear:function(){h(P).forEach(b)},restore:function(){h(P).forEach(function(a){a.framebuffer=e.createFramebuffer();L(a)})}})}},{"./util/extend":23,
"./util/values":31}],13:[function(k,m,r){m.exports=function(h,a){var k=1;a.ext_texture_filter_anisotropic&&(k=h.getParameter(34047));var y=1,e=1;a.webgl_draw_buffers&&(y=h.getParameter(34852),e=h.getParameter(36063));return{colorBits:[h.getParameter(3410),h.getParameter(3411),h.getParameter(3412),h.getParameter(3413)],depthBits:h.getParameter(3414),stencilBits:h.getParameter(3415),subpixelBits:h.getParameter(3408),extensions:Object.keys(a).filter(function(e){return!!a[e]}),maxAnisotropic:k,maxDrawbuffers:y,
maxColorAttachments:e,pointSizeDims:h.getParameter(33901),lineWidthDims:h.getParameter(33902),maxViewportDims:h.getParameter(3386),maxCombinedTextureUnits:h.getParameter(35661),maxCubeMapSize:h.getParameter(34076),maxRenderbufferSize:h.getParameter(34024),maxTextureUnits:h.getParameter(34930),maxTextureSize:h.getParameter(3379),maxAttributes:h.getParameter(34921),maxVertexUniforms:h.getParameter(36347),maxVertexTextureUnits:h.getParameter(35660),maxVaryingVectors:h.getParameter(36348),maxFragmentUniforms:h.getParameter(36349),
glsl:h.getParameter(35724),renderer:h.getParameter(7937),vendor:h.getParameter(7936),version:h.getParameter(7938)}}},{}],14:[function(k,m,r){var h=k("./util/is-typed-array");m.exports=function(a,k,y,e,f,c){return function(c){var f;f=null===k.next?5121:k.next.colorAttachments[0].texture._texture.type;var m=0,r=0,q=e.framebufferWidth,J=e.framebufferHeight,v=null;h(c)?v=c:c&&(m=c.x|0,r=c.y|0,q=(c.width||e.framebufferWidth-m)|0,J=(c.height||e.framebufferHeight-r)|0,v=c.data||null);y();c=q*J*4;v||(5121===
f?v=new Uint8Array(c):5126===f&&(v=v||new Float32Array(c)));a.pixelStorei(3333,4);a.readPixels(m,r,q,J,6408,f,v);return v}}},{"./util/is-typed-array":26}],15:[function(k,m,r){var h=k("./util/values"),a=[];a[32854]=2;a[32855]=2;a[36194]=2;a[33189]=2;a[36168]=1;a[34041]=4;a[35907]=4;a[34836]=16;a[34842]=8;a[34843]=6;m.exports=function(k,y,e,f,c){function m(a){this.id=q++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;c.profile&&(this.stats={size:0})}function r(a){var c=
a.renderbuffer;k.bindRenderbuffer(36161,null);k.deleteRenderbuffer(c);a.renderbuffer=null;a.refCount=0;delete J[a.id];f.renderbufferCount--}var G={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};y.ext_srgb&&(G.srgba=35907);y.ext_color_buffer_half_float&&(G.rgba16f=34842,G.rgb16f=34843);y.webgl_color_buffer_float&&(G.rgba32f=34836);var z=[];Object.keys(G).forEach(function(a){z[G[a]]=a});var q=0,J={};m.prototype.decRef=function(){0>=--this.refCount&&r(this)};
c.profile&&(f.getTotalRenderbufferSize=function(){var a=0;Object.keys(J).forEach(function(c){a+=J[c].stats.size});return a});return{create:function(e,h){function n(e,f){var h=0,b=0,q=32854;"object"===typeof e&&e?("shape"in e?(b=e.shape,h=b[0]|0,b=b[1]|0):("radius"in e&&(h=b=e.radius|0),"width"in e&&(h=e.width|0),"height"in e&&(b=e.height|0)),"format"in e&&(q=G[e.format])):"number"===typeof e?(h=e|0,b="number"===typeof f?f|0:h):e||(h=b=1);if(h!==g.width||b!==g.height||q!==g.format)return n.width=g.width=
h,n.height=g.height=b,g.format=q,k.bindRenderbuffer(36161,g.renderbuffer),k.renderbufferStorage(36161,q,h,b),c.profile&&(g.stats.size=a[g.format]*g.width*g.height),n.format=z[g.format],n}var g=new m(k.createRenderbuffer());J[g.id]=g;f.renderbufferCount++;n(e,h);n.resize=function(e,f){var h=e|0,b=f|0||h;if(h===g.width&&b===g.height)return n;n.width=g.width=h;n.height=g.height=b;k.bindRenderbuffer(36161,g.renderbuffer);k.renderbufferStorage(36161,g.format,h,b);c.profile&&(g.stats.size=a[g.format]*g.width*
g.height);return n};n._reglType="renderbuffer";n._renderbuffer=g;c.profile&&(n.stats=g.stats);n.destroy=function(){g.decRef()};return n},clear:function(){h(J).forEach(r)},restore:function(){h(J).forEach(function(a){a.renderbuffer=k.createRenderbuffer();k.bindRenderbuffer(36161,a.renderbuffer);k.renderbufferStorage(36161,a.format,a.width,a.height)});k.bindRenderbuffer(36161,null)}}}},{"./util/values":31}],16:[function(k,m,r){var h=k("./util/values");m.exports=function(a,k,m,e){function f(a,c,e,f){this.name=
a;this.id=c;this.location=e;this.info=f}function c(a,c){for(var e=0;e<a.length;++e)if(a[e].id===c.id){a[e].location=c.location;return}a.push(c)}function r(c,e,f){f=35632===c?z:q;var h=f[e];if(!h){var l=k.str(e),h=a.createShader(c);a.shaderSource(h,l);a.compileShader(h);f[e]=h}return h}function F(a,c){this.id=H++;this.fragId=a;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[];e.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function G(h,g){var q,m;q=r(35632,h.fragId);m=
r(35633,h.vertId);var l=h.program=a.createProgram();a.attachShader(l,q);a.attachShader(l,m);a.linkProgram(l);var b=a.getProgramParameter(l,35718);e.profile&&(h.stats.uniformsCount=b);var v=h.uniforms;for(q=0;q<b;++q)if(m=a.getActiveUniform(l,q))if(1<m.size)for(var y=0;y<m.size;++y){var z=m.name.replace("[0]","["+y+"]");c(v,new f(z,k.id(z),a.getUniformLocation(l,z),m))}else c(v,new f(m.name,k.id(m.name),a.getUniformLocation(l,m.name),m));b=a.getProgramParameter(l,35721);e.profile&&(h.stats.attributesCount=
b);v=h.attributes;for(q=0;q<b;++q)(m=a.getActiveAttrib(l,q))&&c(v,new f(m.name,k.id(m.name),a.getAttribLocation(l,m.name),m))}var z={},q={},J={},v=[],H=0;e.profile&&(m.getMaxUniformsCount=function(){var a=0;v.forEach(function(c){c.stats.uniformsCount>a&&(a=c.stats.uniformsCount)});return a},m.getMaxAttributesCount=function(){var a=0;v.forEach(function(c){c.stats.attributesCount>a&&(a=c.stats.attributesCount)});return a});return{clear:function(){var c=a.deleteShader.bind(a);h(z).forEach(c);z={};h(q).forEach(c);
q={};v.forEach(function(c){a.deleteProgram(c.program)});v.length=0;J={};m.shaderCount=0},program:function(a,c,e){m.shaderCount++;var f=J[c];f||(f=J[c]={});var h=f[a];h||(h=new F(c,a),G(h,e),f[a]=h,v.push(h));return h},restore:function(){z={};q={};for(var a=0;a<v.length;++a)G(v[a])},shader:r,frag:-1,vert:-1}}},{"./util/values":31}],17:[function(k,m,r){m.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},
{}],18:[function(k,m,r){m.exports=function(){var h={"":0},a=[""];return{id:function(k){var m=h[k];if(m)return m;m=h[k]=a.length;a.push(k);return m},str:function(h){return a[h]}}}},{}],19:[function(k,m,r){function h(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&J(a[0])?!0:!1}function t(a){return Object.prototype.toString.call(a)}function y(b){if(!b)return!1;var c=t(b);return 0<=C.indexOf(c)?!0:h(b)||a(b)||G(b)}function e(a,c){36193===
a.type?(a.data=q(c),z.freeType(c)):a.data=c}function f(a,c,e,f,h,k){a="undefined"!==typeof l[a]?l[a]:g[a]*I[c];k&&(a*=6);if(h){for(f=0;1<=e;)f+=a*e*e,e/=2;return f}return a*e*f}var c=k("./util/extend"),A=k("./util/values"),F=k("./util/is-typed-array"),G=k("./util/is-ndarray"),z=k("./util/pool"),q=k("./util/to-half-float"),J=k("./util/is-array-like");r=k("./constants/arraytypes.json");var v=k("./constants/arraytypes.json"),H=[9984,9986,9985,9987],n=[0,6409,6410,6407,6408],g={};g[6409]=g[6406]=g[6402]=
1;g[34041]=g[6410]=2;g[6407]=g[35904]=3;g[6408]=g[35906]=4;var C=Object.keys(r).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),I=[];I[5121]=1;I[5126]=4;I[36193]=2;I[5123]=2;I[5125]=4;var l=[];l[32854]=2;l[32855]=2;l[36194]=2;l[34041]=4;l[33776]=.5;l[33777]=.5;l[33778]=1;l[33779]=1;l[35986]=.5;l[35987]=1;l[34798]=1;l[35840]=.5;l[35841]=.25;l[35842]=.5;l[35843]=.25;l[36196]=.5;m.exports=function(b,k,l,m,r,C,I){function oa(){this.format=
this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function P(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function T(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in
b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=Q[b.colorSpace]);"type"in b&&(a.type=S[b.type]);var c=a.width,e=a.height,f=a.channels,h=!1;"shape"in b?(c=b.shape[0],e=b.shape[1],3===b.shape.length&&(f=b.shape[2],h=!0)):("radius"in b&&(c=e=b.radius),"width"in b&&(c=b.width),"height"in b&&(e=b.height),"channels"in b&&(f=b.channels,h=!0));a.width=c|0;a.height=e|0;a.channels=f|0;c=!1;"format"in b&&
(c=b.format,e=a.internalformat=V[c],a.format=Ma[e],c in S&&!("type"in b)&&(a.type=S[c]),c in Y&&(a.compressed=!0),c=!0);!h&&c?a.channels=g[a.format]:h&&!c&&a.channels!==n[a.format]&&(a.format=a.internalformat=n[a.channels])}}function pa(a){b.pixelStorei(37440,a.flipY);b.pixelStorei(37441,a.premultiplyAlpha);b.pixelStorei(37443,a.colorSpace);b.pixelStorei(3317,a.unpackAlignment)}function va(){oa.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=
!1}function p(d,b){var c=null;y(b)?c=b:b&&(T(d,b),"x"in b&&(d.xOffset=b.x|0),"y"in b&&(d.yOffset=b.y|0),y(b.data)&&(c=b.data));if(b.copy){var f=r.viewportWidth,g=r.viewportHeight;d.width=d.width||f-d.xOffset;d.height=d.height||g-d.yOffset;d.needsCopy=!0}else if(!c)d.width=d.width||1,d.height=d.height||1;else if(F(c))d.data=c,"type"in b||5121!==d.type||(d.type=v[Object.prototype.toString.call(c)]|0);else if(h(c)){f=c;g=d.width*d.height*d.channels;switch(d.type){case 5121:case 5123:case 5125:case 5126:g=
z.allocType(d.type,g);g.set(f);d.data=g;break;case 36193:d.data=q(f)}d.alignment=1;d.needsFree=!0}else if(G(c)){f=c.data;Array.isArray(f)||5121!==d.type||(d.type=v[Object.prototype.toString.call(f)]|0);var g=c.shape,k=c.stride,l,m,p,w;3===g.length?(p=g[2],w=k[2]):w=p=1;l=g[0];m=g[1];g=k[0];k=k[1];d.alignment=1;d.width=l;d.height=m;d.channels=p;d.format=d.internalformat=n[p];d.needsFree=!0;l=w;c=c.offset;p=d.width;w=d.height;m=d.channels;for(var A=z.allocType(36193===d.type?5126:d.type,p*w*m),H=0,
C=0;C<w;++C)for(var ca=0;ca<p;++ca)for(var K=0;K<m;++K)A[H++]=f[g*ca+k*C+l*K+c];e(d,A)}else if("[object HTMLCanvasElement]"===t(c)||"[object CanvasRenderingContext2D]"===t(c))"[object HTMLCanvasElement]"===t(c)?d.element=c:d.element=c.canvas,d.width=d.element.width,d.height=d.element.height;else if("[object HTMLImageElement]"===t(c))d.element=c,d.width=c.naturalWidth,d.height=c.naturalHeight;else if("[object HTMLVideoElement]"===t(c))d.element=c,d.width=c.videoWidth,d.height=c.videoHeight,d.needsPoll=
!0;else if(a(c)){f=c[0].length;g=c.length;k=1;if(J(c[0][0])){l=k=c[0][0].length;p=z.allocType(36193===d.type?5126:d.type,f*g*l);for(m=w=0;m<g;++m)for(A=c[m],H=0;H<f;++H)for(C=A[H],ca=0;ca<l;++ca)p[w++]=C[ca];e(d,p)}else{l=z.allocType(36193===d.type?5126:d.type,f*g);for(w=p=0;w<g;++w)for(m=c[w],A=0;A<f;++A)l[p++]=m[A];e(d,l)}d.alignment=1;d.width=f;d.height=g;d.channels=k;d.format=d.internalformat=n[k];d.needsFree=!0}}function Z(a,c,e,f,g){var h=a.element,k=a.data,l=a.internalformat,q=a.format,p=a.type,
n=a.width,t=a.height;pa(a);h?b.texSubImage2D(c,g,e,f,q,p,h):a.compressed?b.compressedTexSubImage2D(c,g,e,f,l,n,t,k):a.needsCopy?(m(),b.copyTexSubImage2D(c,g,e,f,a.xOffset,a.yOffset,n,t)):b.texSubImage2D(c,g,e,f,n,t,q,p,k)}function aa(){return Ja.pop()||new va}function ja(a){a.needsFree&&z.freeType(a.data);va.call(a);Ja.push(a)}function W(){oa.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function N(a,b,c){var e=a.images[0]=aa();a.mipmask=1;e.width=a.width=
b;e.height=a.height=c}function E(a,b){var c=null;if(y(b))c=a.images[0]=aa(),P(c,a),p(c,b),a.mipmask=1;else if(T(a,b),Array.isArray(b.mipmap))for(var e=b.mipmap,f=0;f<e.length;++f)c=a.images[f]=aa(),P(c,a),c.width>>=f,c.height>>=f,p(c,e[f]),a.mipmask|=1<<f;else c=a.images[0]=aa(),P(c,a),p(c,b),a.mipmask=1;P(a,a.images[0])}function ya(a,c){for(var e=a.images,f=0;f<e.length&&e[f];++f){var g=e[f],h=c,k=f,l=g.element,q=g.data,p=g.internalformat,n=g.format,t=g.type,v=g.width,r=g.height;pa(g);l?b.texImage2D(h,
k,n,n,t,l):g.compressed?b.compressedTexImage2D(h,k,p,v,r,0,q):g.needsCopy?(m(),b.copyTexImage2D(h,k,n,g.xOffset,g.yOffset,v,r,0)):b.texImage2D(h,k,n,v,r,0,n,t,q)}}function qa(){var a=Ka.pop()||new W;oa.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function Aa(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&ja(b[c]),b[c]=null;Ka.push(a)}function R(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ga(a,
b){"min"in b&&(a.minFilter=ea[b.min],0<=H.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=ba[b.mag]);var c=a.wrapS,e=a.wrapT;if("wrap"in b){var f=b.wrap;"string"===typeof f?c=e=M[f]:Array.isArray(f)&&(c=M[f[0]],e=M[f[1]])}else"wrapS"in b&&(c=M[b.wrapS]),"wrapT"in b&&(e=M[b.wrapT]);a.wrapS=c;a.wrapT=e;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=ra[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=
b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function ha(a,c){b.texParameteri(c,10241,a.minFilter);b.texParameteri(c,10240,a.magFilter);b.texParameteri(c,10242,a.wrapS);b.texParameteri(c,10243,a.wrapT);k.ext_texture_filter_anisotropic&&b.texParameteri(c,34046,a.anisotropic);a.genMipmaps&&(b.hint(33170,a.mipmapHint),b.generateMipmap(c))}function sa(a){oa.call(this);this.mipmask=0;this.internalformat=6408;this.id=La++;this.refCount=1;this.target=a;this.texture=
b.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new R;I.profile&&(this.stats={size:0})}function ia(a){b.activeTexture(33984);b.bindTexture(a.target,a.texture)}function X(){var a=la[0];a?b.bindTexture(a.target,a.texture):b.bindTexture(3553,null)}function ta(a){var c=a.texture,e=a.unit,f=a.target;0<=e&&(b.activeTexture(33984+e),b.bindTexture(f,null),la[e]=null);b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete da[a.id];C.textureCount--}var ra={"don't care":4352,
"dont care":4352,nice:4354,fast:4353},M={repeat:10497,clamp:33071,mirror:33648},ba={nearest:9728,linear:9729},ea=c({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},ba),Q={none:0,browser:37444},S={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},V={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Y={};k.ext_srgb&&(V.srgb=35904,V.srgba=35906);k.oes_texture_float&&
(S.float32=S["float"]=5126);k.oes_texture_half_float&&(S.float16=S["half float"]=36193);k.webgl_depth_texture&&(c(V,{depth:6402,"depth stencil":34041}),c(S,{uint16:5123,uint32:5125,"depth stencil":34042}));k.webgl_compressed_texture_s3tc&&c(Y,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});k.webgl_compressed_texture_atc&&c(Y,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});k.webgl_compressed_texture_pvrtc&&c(Y,{"rgb pvrtc 4bppv1":35840,
"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});k.webgl_compressed_texture_etc1&&(Y["rgb etc1"]=36196);var fa=Array.prototype.slice.call(b.getParameter(34467));Object.keys(Y).forEach(function(a){var b=Y[a];0<=fa.indexOf(b)&&(V[a]=b)});var ca=Object.keys(V);l.textureFormats=ca;var Ca=[];Object.keys(V).forEach(function(a){Ca[V[a]]=a});var Da=[];Object.keys(S).forEach(function(a){Da[S[a]]=a});var Ea=[];Object.keys(ba).forEach(function(a){Ea[ba[a]]=a});var Fa=[];Object.keys(ea).forEach(function(a){Fa[ea[a]]=
a});var ua=[];Object.keys(M).forEach(function(a){ua[M[a]]=a});var Ma=ca.reduce(function(a,b){var c=V[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ja=[],Ka=[],La=0,da={},ka=l.maxTextureUnits,la=Array(ka).map(function(){return null});c(sa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var c=0;c<ka;++c){var e=la[c];if(e){if(0<e.bindCount)continue;e.unit=-1}la[c]=this;a=c;break}I.profile&&
C.maxTextureUnits<a+1&&(C.maxTextureUnits=a+1);this.unit=a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&ta(this)}});I.profile&&(C.getTotalTextureSize=function(){var a=0;Object.keys(da).forEach(function(b){a+=da[b].stats.size});return a});return{create2D:function(a,c){function e(a,b){var d=g.texInfo;R.call(d);var c=qa();"number"===typeof a?"number"===typeof b?N(c,a|0,b|0):N(c,a|0,a|0):a?(ga(d,a),
E(c,a)):N(c,1,1);d.genMipmaps&&(c.mipmask=(c.width<<1)-1);g.mipmask=c.mipmask;P(g,c);g.internalformat=c.internalformat;e.width=c.width;e.height=c.height;ia(g);ya(c,3553);ha(d,3553);X();Aa(c);I.profile&&(g.stats.size=f(g.internalformat,g.type,c.width,c.height,d.genMipmaps,!1));e.format=Ca[g.internalformat];e.type=Da[g.type];e.mag=Ea[d.magFilter];e.min=Fa[d.minFilter];e.wrapS=ua[d.wrapS];e.wrapT=ua[d.wrapT];return e}var g=new sa(3553);da[g.id]=g;C.textureCount++;e(a,c);e.subimage=function(a,b,d,c){b|=
0;d|=0;c|=0;var f=aa();P(f,g);f.width>>=c;f.height>>=c;f.width-=b;f.height-=d;p(f,a);ia(g);Z(f,3553,b,d,c);X();ja(f);return e};e.resize=function(a,d){var c=a|0,h=d|0||c;if(c===g.width&&h===g.height)return e;e.width=g.width=c;e.height=g.height=h;ia(g);for(var k=0;g.mipmask>>k;++k)b.texImage2D(3553,k,g.format,c>>k,h>>k,0,g.format,g.type,null);X();I.profile&&(g.stats.size=f(g.internalformat,g.type,c,h,!1,!1));return e};e._reglType="texture2d";e._texture=g;I.profile&&(e.stats=g.stats);e.destroy=function(){g.decRef()};
return e},createCube:function(a,c,e,g,h,k){function l(a,b,d,c,e,g){var h,k=q.texInfo;R.call(k);for(h=0;6>h;++h)n[h]=qa();if("number"===typeof a||!a)for(a=a|0||1,h=0;6>h;++h)N(n[h],a,a);else if("object"===typeof a)if(b)E(n[0],a),E(n[1],b),E(n[2],d),E(n[3],c),E(n[4],e),E(n[5],g);else if(ga(k,a),T(q,a),"faces"in a)for(a=a.faces,h=0;6>h;++h)P(n[h],q),E(n[h],a[h]);else for(h=0;6>h;++h)E(n[h],a);P(q,n[0]);q.mipmask=k.genMipmaps?(n[0].width<<1)-1:n[0].mipmask;q.internalformat=n[0].internalformat;l.width=
n[0].width;l.height=n[0].height;ia(q);for(h=0;6>h;++h)ya(n[h],34069+h);ha(k,34067);X();I.profile&&(q.stats.size=f(q.internalformat,q.type,l.width,l.height,k.genMipmaps,!0));l.format=Ca[q.internalformat];l.type=Da[q.type];l.mag=Ea[k.magFilter];l.min=Fa[k.minFilter];l.wrapS=ua[k.wrapS];l.wrapT=ua[k.wrapT];for(h=0;6>h;++h)Aa(n[h]);return l}var q=new sa(34067);da[q.id]=q;C.cubeCount++;var n=Array(6);l(a,c,e,g,h,k);l.subimage=function(a,b,d,c,e){d|=0;c|=0;e|=0;var f=aa();P(f,q);f.width>>=e;f.height>>=
e;f.width-=d;f.height-=c;p(f,b);ia(q);Z(f,34069+a,d,c,e);X();ja(f);return l};l.resize=function(a){a|=0;if(a!==q.width){l.width=q.width=a;l.height=q.height=a;ia(q);for(var d=0;6>d;++d)for(var c=0;q.mipmask>>c;++c)b.texImage2D(34069+d,c,q.format,a>>c,a>>c,0,q.format,q.type,null);X();I.profile&&(q.stats.size=f(q.internalformat,q.type,l.width,l.height,!1,!0));return l}};l._reglType="textureCube";l._texture=q;I.profile&&(l.stats=q.stats);l.destroy=function(){q.decRef()};return l},clear:function(){for(var a=
0;a<ka;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),la[a]=null;A(da).forEach(ta);C.cubeCount=0;C.textureCount=0},getTexture:function(a){return null},restore:function(){A(da).forEach(function(a){a.texture=b.createTexture();b.bindTexture(a.target,a.texture);for(var c=0;32>c;++c)if(0!==(a.mipmask&1<<c))if(3553===a.target)b.texImage2D(3553,c,a.internalformat,a.width>>c,a.height>>c,0,a.internalformat,a.type,null);else for(var e=0;6>e;++e)b.texImage2D(34069+e,c,a.internalformat,a.width>>c,a.height>>
c,0,a.internalformat,a.type,null);ha(a.texInfo,a.target)})}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(k,m,r){m.exports=function(h,a){function k(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function m(a,c,e){var f=r.pop()||new k;f.startQueryIndex=a;f.endQueryIndex=c;f.sum=0;f.stats=e;F.push(f)}var e=a.ext_disjoint_timer_query;
if(!e)return null;var f=[],c=[],r=[],F=[],G=[],z=[];return{beginQuery:function(a){var h=f.pop()||e.createQueryEXT();e.beginQueryEXT(35007,h);c.push(h);m(c.length-1,c.length,a)},endQuery:function(){e.endQueryEXT(35007)},pushScopeStats:m,update:function(){var a,h;a=c.length;if(0!==a){z.length=Math.max(z.length,a+1);G.length=Math.max(G.length,a+1);G[0]=0;var k=z[0]=0;for(h=a=0;h<c.length;++h){var m=c[h];e.getQueryObjectEXT(m,34919)?(k+=e.getQueryObjectEXT(m,34918),f.push(m)):c[a++]=m;G[h+1]=k;z[h+1]=
a}c.length=a;for(h=a=0;h<F.length;++h){var k=F[h],n=k.startQueryIndex,m=k.endQueryIndex;k.sum+=G[m]-G[n];n=z[n];m=z[m];m===n?(k.stats.gpuTime+=k.sum/1E6,r.push(k)):(k.startQueryIndex=n,k.endQueryIndex=m,F[a++]=k)}F.length=a}},getNumPendingQueries:function(){return c.length},clear:function(){f.push.apply(f,c);for(var a=0;a<f.length;a++)e.deleteQueryEXT(f[a]);c.length=0;f.length=0},restore:function(){c.length=0;f.length=0}}}},{}],21:[function(k,m,r){m.exports="undefined"!==typeof performance&&performance.now?
function(){return performance.now()}:function(){return+new Date}},{}],22:[function(k,m,r){function h(a){return Array.prototype.slice.call(a)}function a(a){return h(a).join("")}var t=k("./extend");m.exports=function(){function k(){var c=[],e=[];return t(function(){c.push.apply(c,h(arguments))},{def:function(){var a="v"+f++;e.push(a);0<arguments.length&&(c.push(a,"="),c.push.apply(c,h(arguments)),c.push(";"));return a},toString:function(){return a([0<e.length?"var "+e+";":"",a(c)])}})}function e(){function a(f,
g){e(f,g,"=",c.def(f,g),";")}var c=k(),e=k(),f=c.toString,m=e.toString;return t(function(){c.apply(c,h(arguments))},{def:c.def,entry:c,exit:e,save:a,set:function(e,f,h){a(e,f);c(e,f,"=",h,";")},toString:function(){return f()+m()}})}var f=0,c=[],m=[],r=k(),G={};return{global:r,link:function(a){for(var e=0;e<m.length;++e)if(m[e]===a)return c[e];e="g"+f++;c.push(e);m.push(a);return e},block:k,proc:function(c,f){function h(){var a="a"+k.length;k.push(a);return a}var k=[];f=f||0;for(var m=0;m<f;++m)h();
var m=e(),n=m.toString;return G[c]=t(m,{arg:h,toString:function(){return a(["function(",k.join(),"){",n(),"}"])}})},scope:e,cond:function(){var c=a(arguments),f=e(),k=e(),m=f.toString,r=k.toString;return t(f,{then:function(){f.apply(f,h(arguments));return this},"else":function(){k.apply(k,h(arguments));return this},toString:function(){var e=r();e&&(e="else{"+e+"}");return a(["if(",c,"){",m(),"}",e])}})},compile:function(){var e=['"use strict";',r,"return {"];Object.keys(G).forEach(function(a){e.push('"',
a,'":',G[a].toString(),",")});e.push("}");var f=a(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,c.concat(f)).apply(null,m)}}}},{"./extend":23}],23:[function(k,m,r){m.exports=function(h,a){for(var k=Object.keys(a),m=0;m<k.length;++m)h[k[m]]=a[k[m]];return h}},{}],24:[function(k,m,r){var h=k("./is-typed-array");m.exports=function(a){return Array.isArray(a)||h(a)}},{"./is-typed-array":26}],25:[function(k,m,r){var h=k("./is-typed-array");m.exports=function(a){return!!a&&
"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||h(a.data))}},{"./is-typed-array":26}],26:[function(k,m,r){var h=k("../constants/arraytypes.json");m.exports=function(a){return Object.prototype.toString.call(a)in h}},{"../constants/arraytypes.json":4}],27:[function(k,m,r){m.exports=function(h,a){for(var k=Array(h),m=0;m<h;++m)k[m]=a(m);return k}},{}],28:[function(k,m,r){function h(a){var f,c;
f=(65535<a)<<4;a>>>=f;c=(255<a)<<3;a>>>=c;f|=c;c=(15<a)<<2;a>>>=c;f|=c;c=(3<a)<<1;return f|c|a>>>c>>1}function a(a){a:{for(var f=16;268435456>=f;f*=16)if(a<=f){a=f;break a}a=0}f=y[h(a)>>2];return 0<f.length?f.pop():new ArrayBuffer(a)}function t(a){y[h(a.byteLength)>>2].push(a)}var y=k("./loop")(8,function(){return[]});m.exports={alloc:a,free:t,allocType:function(e,f){var c=null;switch(e){case 5120:c=new Int8Array(a(f),0,f);break;case 5121:c=new Uint8Array(a(f),0,f);break;case 5122:c=new Int16Array(a(2*
f),0,f);break;case 5123:c=new Uint16Array(a(2*f),0,f);break;case 5124:c=new Int32Array(a(4*f),0,f);break;case 5125:c=new Uint32Array(a(4*f),0,f);break;case 5126:c=new Float32Array(a(4*f),0,f);break;default:return null}return c.length!==f?c.subarray(0,f):c},freeType:function(a){t(a.buffer)}}},{"./loop":27}],29:[function(k,m,r){m.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(h){return requestAnimationFrame(h)},cancel:function(h){return cancelAnimationFrame(h)}}:
{next:function(h){return setTimeout(h,16)},cancel:clearTimeout}},{}],30:[function(k,m,r){var h=k("./pool"),a=new Float32Array(1),t=new Uint32Array(a.buffer);m.exports=function(k){for(var e=h.allocType(5123,k.length),f=0;f<k.length;++f)if(isNaN(k[f]))e[f]=65535;else if(Infinity===k[f])e[f]=31744;else if(-Infinity===k[f])e[f]=64512;else{a[0]=k[f];var c=t[0],m=c>>>31<<15,r=(c<<1>>>24)-127,c=c>>13&1023;e[f]=-24>r?m:-14>r?m+(c+1024>>-14-r):15<r?m+31744:m+(r+15<<10)+c}return e}},{"./pool":28}],31:[function(k,
m,r){m.exports=function(h){return Object.keys(h).map(function(a){return h[a]})}},{}],32:[function(k,m,r){function h(a,c,h){function k(){var c=window.innerWidth,q=window.innerHeight;a!==document.body&&(q=a.getBoundingClientRect(),c=q.right-q.left,q=q.top-q.bottom);m.width=h*c;m.height=h*q;e(m.style,{width:c+"px",height:q+"px"})}var m=document.createElement("canvas");e(m.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(m);a===document.body&&(m.style.position="absolute",e(a.style,{margin:0,
padding:0}));window.addEventListener("resize",k,!1);k();return{canvas:m,onDestroy:function(){window.removeEventListener("resize",k);a.removeChild(m)}}}function a(a,c){function e(h){try{return a.getContext(h,c)}catch(k){return null}}return e("webgl")||e("experimental-webgl")||e("webgl-experimental")}function t(a){return"string"===typeof a?a.split():a}function y(a){return"string"===typeof a?document.querySelector(a):a}var e=k("./util/extend");m.exports=function(e){var c=e||{},k,m,r,z;e={};var q=[],
J=[],v="undefined"===typeof window?1:window.devicePixelRatio,H=!1,n=function(a){},g=function(){};"string"===typeof c?k=document.querySelector(c):"object"===typeof c&&("string"===typeof c.nodeName&&"function"===typeof c.appendChild&&"function"===typeof c.getBoundingClientRect?k=c:"function"===typeof c.drawArrays||"function"===typeof c.drawElements?(z=c,r=z.canvas):("gl"in c?z=c.gl:"canvas"in c?r=y(c.canvas):"container"in c&&(m=y(c.container)),"attributes"in c&&(e=c.attributes),"extensions"in c&&(q=
t(c.extensions)),"optionalExtensions"in c&&(J=t(c.optionalExtensions)),"onDone"in c&&(n=c.onDone),"profile"in c&&(H=!!c.profile),"pixelRatio"in c&&(v=+c.pixelRatio)));k&&("canvas"===k.nodeName.toLowerCase()?r=k:m=k);if(!z){if(!r){k=h(m||document.body,n,v);if(!k)return null;r=k.canvas;g=k.onDestroy}z=a(r,e)}return z?{gl:z,canvas:r,container:m,extensions:q,optionalExtensions:J,pixelRatio:v,profile:H,onDone:n,onDestroy:g}:(g(),n("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),
null)}},{"./util/extend":23}],33:[function(k,m,r){m.exports=function(a,k){function m(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==g.alt,g.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==g.shift,g.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==g.control,g.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==g.meta,g.meta=!!a.metaKey);return b}function e(a,b){var c=h.x(b),e=h.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==v||c!==H||e!==n||m(b))v=a|0,H=c||0,n=e||0,k&&k(v,H,n,g)}function f(a){e(0,
a)}function c(){if(v||H||n||g.shift||g.alt||g.meta||g.control)v=H=n=0,g.shift=g.alt=g.control=g.meta=!1,k&&k(0,0,0,g)}function r(a){m(a)&&k&&k(v,H,n,g)}function F(a){0===h.buttons(a)?e(0,a):e(v,a)}function G(a){e(v|h.buttons(a),a)}function z(a){e(v&~h.buttons(a),a)}function q(){C||(C=!0,a.addEventListener("mousemove",F),a.addEventListener("mousedown",G),a.addEventListener("mouseup",z),a.addEventListener("mouseleave",f),a.addEventListener("mouseenter",f),a.addEventListener("mouseout",f),a.addEventListener("mouseover",
f),a.addEventListener("blur",c),a.addEventListener("keyup",r),a.addEventListener("keydown",r),a.addEventListener("keypress",r),a!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",r),window.addEventListener("keydown",r),window.addEventListener("keypress",r)))}function J(){C&&(C=!1,a.removeEventListener("mousemove",F),a.removeEventListener("mousedown",G),a.removeEventListener("mouseup",z),a.removeEventListener("mouseleave",f),a.removeEventListener("mouseenter",f),a.removeEventListener("mouseout",
f),a.removeEventListener("mouseover",f),a.removeEventListener("blur",c),a.removeEventListener("keyup",r),a.removeEventListener("keydown",r),a.removeEventListener("keypress",r),a!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",r),window.removeEventListener("keydown",r),window.removeEventListener("keypress",r)))}k||(k=a,a=window);var v=0,H=0,n=0,g={shift:!1,alt:!1,control:!1,meta:!1},C=!1;q();var I={element:a};Object.defineProperties(I,{enabled:{get:function(){return C},
set:function(a){a?q():J},enumerable:!0},buttons:{get:function(){return v},enumerable:!0},x:{get:function(){return H},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return g},enumerable:!0}});return I};var h=k("mouse-event")},{"mouse-event":34}],34:[function(k,m,r){function h(a){return a.target||a.srcElement||window}r.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<
a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};r.element=h;r.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var k=h(a).getBoundingClientRect();return a.clientX-k.left}return 0};r.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var k=h(a).getBoundingClientRect();return a.clientY-k.top}return 0}},{}],35:[function(k,m,r){function h(a,c){for(var e=0;e<a.length;++e)if(a[e]===c)return e;return-1}var a=
k("./lib/util/extend"),t=k("./lib/dynamic"),y=k("./lib/util/raf"),e=k("./lib/util/clock"),f=k("./lib/strings"),c=k("./lib/webgl"),A=k("./lib/extension"),F=k("./lib/limits"),G=k("./lib/buffer"),z=k("./lib/elements"),q=k("./lib/texture"),J=k("./lib/renderbuffer"),v=k("./lib/framebuffer"),H=k("./lib/attribute"),n=k("./lib/shader"),g=k("./lib/read"),C=k("./lib/core"),I=k("./lib/stats"),l=k("./lib/timer");m.exports=function(b){function k(){if(0===Q.length)E&&E.update(),fa=null;else{fa=y.next(k);T();for(var a=
Q.length-1;0<=a;--a){var b=Q[a];b&&b(R,null,0)}p.flush();E&&E.update()}}function m(){!fa&&0<Q.length&&(fa=y.next(k))}function r(){fa&&(y.cancel(k),fa=null)}function Ga(a){a.preventDefault();r();S.forEach(function(a){a()})}function Ba(a){p.getError();aa.restore();ia.restore();ha.restore();X.restore();ta.restore();ra.restore();E&&E.restore();M.procs.refresh();m();V.forEach(function(a){a()})}function na(b){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var e=a[c];t.isDynamic(e)?d[c]=
t.unbox(e,c):b[c]=e});return{dynamic:d,"static":b}}function e(a){for(;p.length<a;)p.push(null);return p}var f=c(b.context||{}),g=c(b.uniforms||{}),h=c(b.attributes||{}),k=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;"stencil"in d&&d.stencil.op&&(d.stencil.opBack=d.stencil.opFront=d.stencil.op,delete d.stencil.op);c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");
c("scissor");c("sample");return d}(b));b={gpuTime:0,cpuTime:0,count:0};var f=M.compile(k,h,g,f,b),l=f.draw,m=f.batch,n=f.scope,p=[];return a(function(a,b){var c;if("function"===typeof a)return n.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)n.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)n.call(this,a[c],b,c);else return n.call(this,a,b,0);else if("number"===typeof a){if(0<a)return m.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return m.call(this,
a,a.length)}else return l.call(this,a)},{stats:b})}function oa(a){Q.push(a);m();return{cancel:function(){function b(){var a=h(Q,b);Q[a]=Q[Q.length-1];--Q.length;0>=Q.length&&r()}var c=h(Q,a);Q[c]=b}}}function P(){var a=ba.viewport,b=ba.scissor_box;a[0]=a[1]=b[0]=b[1]=0;R.viewportWidth=R.framebufferWidth=R.drawingBufferWidth=a[2]=b[2]=p.drawingBufferWidth;R.viewportHeight=R.framebufferHeight=R.drawingBufferHeight=a[3]=b[3]=p.drawingBufferHeight}function T(){R.tick+=1;R.time=va();P();M.procs.poll()}
function pa(){P();M.procs.refresh();E&&E.update()}function va(){return(e()-ya)/1E3}b=c(b);if(!b)return null;var p=b.gl,Z=p.getContextAttributes();p.isContextLost();var aa=A(p,b);if(!aa)return null;var ja=f(),W=I(),N=aa.extensions,E=l(p,N),ya=e(),qa=p.drawingBufferWidth,Aa=p.drawingBufferHeight,R={tick:0,time:0,viewportWidth:qa,viewportHeight:Aa,framebufferWidth:qa,framebufferHeight:Aa,drawingBufferWidth:qa,drawingBufferHeight:Aa,pixelRatio:b.pixelRatio},ga=F(p,N),ha=G(p,W,b),sa=z(p,N,ha,W),qa=H(p,
N,ga,ha,ja),ia=n(p,ja,W,b),X=q(p,N,ga,function(){M.procs.poll()},R,W,b),ta=J(p,N,ga,W,b),ra=v(p,N,ga,X,ta,W),M=C(p,ja,N,ga,ha,sa,X,ra,{},qa,ia,{elements:null,primitive:4,count:-1,offset:0,instances:-1},R,E,b),ja=g(p,ra,M.procs.poll,R,Z,N),ba=M.next,ea=p.canvas,Q=[],S=[],V=[],Y=[b.onDestroy],fa=null;ea&&(ea.addEventListener("webglcontextlost",Ga,!1),ea.addEventListener("webglcontextrestored",Ba,!1));pa();Z=a(na,{clear:function(a){var b=0;M.procs.poll();var c=a.color;c&&(p.clearColor(+c[0]||0,+c[1]||
0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(p.clearDepth(+a.depth),b|=256);"stencil"in a&&(p.clearStencil(a.stencil|0),b|=1024);p.clear(b)},prop:t.define.bind(null,1),context:t.define.bind(null,2),"this":t.define.bind(null,3),draw:na({}),buffer:function(a){return ha.create(a,34962,!1,!1)},elements:function(a){return sa.create(a,!1)},texture:X.create2D,cube:X.createCube,renderbuffer:ta.create,framebuffer:ra.create,framebufferCube:ra.createCube,attributes:Z,frame:oa,on:function(a,b){var c;switch(a){case "frame":return oa(b);
case "lost":c=S;break;case "restore":c=V;break;case "destroy":c=Y}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ga,hasExtension:function(a){return 0<=ga.extensions.indexOf(a.toLowerCase())},read:ja,destroy:function(){Q.length=0;r();ea&&(ea.removeEventListener("webglcontextlost",Ga),ea.removeEventListener("webglcontextrestored",Ba));ia.clear();ra.clear();ta.clear();X.clear();sa.clear();ha.clear();E&&E.clear();Y.forEach(function(a){a()})},
_gl:p,_refresh:pa,poll:function(){T();E&&E.update()},now:va,stats:W});b.onDone(null,Z);return Z}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>