<!DOCTYPE html>
      <html>
        <head>
          <title>example/feedback.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(m,t,h){function a(c,e){if(!t[c]){if(!m[c]){var g="function"==typeof require&&require;if(!e&&g)return g(c,!0);if(k)return k(c,!0);g=Error("Cannot find module '"+c+"'");throw g.code="MODULE_NOT_FOUND",g;}g=t[c]={exports:{}};m[c][0].call(g.exports,function(e){var g=m[c][1][e];return a(g?g:e)},g,g.exports,e$$0,m,t,h)}return t[c].exports}for(var k="function"==typeof require&&require,g=0;g<h.length;g++)a(h[g]);return a})({1:[function(d,m,t){var h=d("../regl")(),a=d("mouse-change")(),k=h.texture(),
g=h({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:k,mouse:function(c){var e=c.pixelRatio;return[a.x*e,c.viewportHeight-a.y*e]},t:function(a){return.01*a.tick}},count:3});h.frame(function(){h.clear({color:[0,0,0,1]});g();k({copy:!0})})},{"../regl":35,"mouse-change":33}],2:[function(d,m,t){function h(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(a,k,g,c,e){a=g.maxAttributes;k=
Array(a);for(g=0;g<a;++g)k[g]=new h;return{Record:h,scope:{},state:k}}},{}],3:[function(d,m,t){function h(a){return L[Object.prototype.toString.call(a)]|0}function a(a,c){for(var e=0;e<c.length;++e)a[e]=c[e]}function k(a,c,e,g,h,k,b){for(var d=0,n=0;n<e;++n)for(var A=0;A<g;++A)a[d++]=c[h*n+k*A+b]}function g(a,c,e){for(var g=0,h=0;h<c.length;++h)for(var k=c[h],b=0;b<e;++b)a[g++]=k[b]}var c=d("./util/is-typed-array"),e=d("./util/is-ndarray"),z=d("./util/values"),p=d("./util/pool"),L=d("./constants/arraytypes.json"),
D=d("./constants/dtypes.json"),w=d("./constants/usage.json");m.exports=function(d,m){function y(a){this.id=b++;this.buffer=d.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function q(a,c,e){a.byteLength=c.byteLength;d.bufferData(a.type,c,e)}function F(b,d,l,n,z){b.usage=l;if(Array.isArray(d))b.dtype=n||5126,0<d.length&&(Array.isArray(d[0])?(b.dimension=d[0].length,n=p.allocType(b.dtype,d.length*b.dimension),g(n,d,b.dimension),q(b,n,l),p.freeType(n)):
"number"===typeof d[0]?(b.dimension=z,n=p.allocType(b.dtype,d.length),a(n,d),q(b,n,l),p.freeType(n)):c(d[0])&&(b.dimension=d[0].length,b.dtype=n||h(d[0])||5126,n=p.allocType(b.dtype,d.length*b.dimension),g(n,d,b.dimension),q(b,n,l),p.freeType(n)));else if(c(d))b.dtype=n||h(d),b.dimension=z,q(b,d,l);else if(e(d)){var R=d.shape,B=d.stride;z=d.offset;var E=0,w=0,m=0,N=0;1===R.length?(E=R[0],w=1,m=B[0],N=0):2===R.length&&(E=R[0],w=R[1],m=B[0],N=B[1]);b.dtype=n||h(d.data)||5126;b.dimension=w;n=p.allocType(b.dtype,
E*w);k(n,d.data,E,w,m,N,z);q(b,n,l);p.freeType(n)}}function l(a){m.bufferCount--;var c=a.buffer;d.isBuffer(c)&&d.deleteBuffer(c);a.buffer=null;delete T[a.id]}var b=0,T={};y.prototype.bind=function(){d.bindBuffer(this.type,this.buffer)};y.prototype.destroy=function(){l(this)};var n=[];return{create:function(b,n,q){function z(a){var b=35044,g=null,h=0,n=0,k=1;Array.isArray(a)||c(a)||e(a)?g=a:"number"===typeof a?h=a|0:a&&("data"in a&&(g=a.data),"usage"in a&&(b=w[a.usage]),"type"in a&&(n=D[a.type]),"dimension"in
a&&(k=a.dimension|0),"length"in a&&(h=a.length|0));v.bind();g?F(v,g,b,n,k):(d.bufferData(v.type,h,b),v.dtype=n||5121,v.usage=b,v.dimension=k,v.byteLength=h);return z}m.bufferCount++;var v=new y(n);T[v.id]=v;q||z(b);z._reglType="buffer";z._buffer=v;z.subdata=function(b,n){var l=(n||0)|0;v.bind();if(Array.isArray(b)){if(0<b.length)if("number"===typeof b[0]){var A=p.allocType(v.dtype,b.length);a(A,b);d.bufferSubData(v.type,l,A);p.freeType(A)}else if(Array.isArray(b[0])||c(b[0])){var A=b[0].length,q=
p.allocType(v.dtype,b.length*A);g(q,b,A);d.bufferSubData(v.type,l,q);p.freeType(q)}}else if(c(b))d.bufferSubData(v.type,l,b);else if(e(b)){var w=b.shape,m=b.stride,y=q=A=0,F=0;1===w.length?(A=w[0],q=1,y=m[0],F=0):2===w.length&&(A=w[0],q=w[1],y=m[0],F=m[1]);w=Array.isArray(b.data)?v.dtype:h(b.data);w=p.allocType(w,A*q);k(w,b.data,A,q,y,F,b.offset);d.bufferSubData(v.type,l,w);p.freeType(w)}return z};z.destroy=function(){l(v)};return z},createStream:function(a,b){var c=n.pop();c||(c=new y(a),c.buffer=
d.createBuffer());c.bind();F(c,b,35040,0,1);return c},destroyStream:function(a){n.push(a)},clear:function(){z(T).forEach(l)},getBuffer:function(a){return a&&a._buffer instanceof y?a._buffer:null},_initBuffer:F}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(d,m,t){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,
"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(d,m,t){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(d,m,t){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(d,m,t){m.exports={"static":35044,
dynamic:35048,stream:35040}},{}],8:[function(d,m,t){function h(a){return Array.isArray(a)||L(a)||D(a)}function a(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function k(a,b,c,e){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=e}function g(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function c(a){return new k(!1,!1,!1,a)}function e(a,b){var c=a.type;return 0===c?(c=a.data.length,new k(!0,1<=c,2<=c,b)):new k(3===c,2===c,1===c,b)}var z=d("./util/codegen"),
p=d("./util/loop"),L=d("./util/is-typed-array"),D=d("./util/is-ndarray"),w=d("./util/is-array-like"),B=d("./constants/primitives.json"),M=d("./constants/dtypes.json"),y=["x","y","z","w"],q={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},
F={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},l={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},b={cw:2304,ccw:2305},T=new k(!1,!1,!1,function(){});m.exports=function(d,A,m,D,L,v,R,ba,E,W,t,N,ga,la){function S(a){return a.replace(".","_")}function K(a,f,b){var c=S(a);za.push(a);xa[c]=u[c]=!!b;pa[c]=
f}function G(a,f,b){var c=S(a);za.push(a);Array.isArray(b)?(u[c]=b.slice(),xa[c]=b.slice()):u[c]=xa[c]=b;qa[c]=f}function X(){var a=z(),f=a.link,b=a.global;a.id=Ja++;a.batchId="0";var c=f(Ia),e=a.shared={props:"a0"};Object.keys(Ia).forEach(function(a){e[a]=b.def(c,".",a)});var H=a.next={},g=a.current={};Object.keys(qa).forEach(function(a){Array.isArray(u[a])&&(H[a]=b.def(e.next,".",a),g[a]=b.def(e.current,".",a))});var C=a.constants={};Object.keys(Ba).forEach(function(a){C[a]=b.def(JSON.stringify(Ba[a]))});
a.invoke=function(C,b){switch(b.type){case 0:var c=["this",e.context,e.props,a.batchId];return C.def(f(b.data),".call(",c.slice(0,Math.max(b.data.length+1,4)),")");case 1:return C.def(e.props,b.data);case 2:return C.def(e.context,b.data);case 3:return C.def("this",b.data)}};a.attribCache={};var Ga={};a.scopeAttrib=function(a){a=A.id(a);if(a in Ga)return Ga[a];var C=W.scope[a];C||(C=W.scope[a]=new ma);return Ga[a]=f(C)};return a}function ia(a){var f=a["static"];a=a.dynamic;if("framebuffer"in f){var b=
f.framebuffer;return b?(b=ba.getFramebuffer(b),c(function(a,f){var r=a.link(b),C=a.shared;f.set(C.framebuffer,".next",r);C=C.context;f.set(C,".framebufferWidth",r+".width");f.set(C,".framebufferHeight",r+".height");return r})):c(function(a,f){var b=a.shared;f.set(b.framebuffer,".next","null");b=b.context;f.set(b,".framebufferWidth",b+".drawingBufferWidth");f.set(b,".framebufferHeight",b+".drawingBufferHeight");return null})}if("framebuffer"in a){var g=a.framebuffer;return e(g,function(a,f){var b=
a.invoke(f,g),C=a.shared,r=C.framebuffer,b=f.def(r,".getFramebuffer(",b,")");f.set(r,".next",b);C=C.context;f.set(C,".framebufferWidth",b+"?"+b+".width:"+C+".drawingBufferWidth");f.set(C,".framebufferHeight",b+"?"+b+".height:"+C+".drawingBufferHeight");return b})}return null}function ra(a,f){function b(a){if(a in c){var r=c[a];a=!0;var Aa=r.x|0,H=r.y|0,ha,d;"w"in r?ha=r.w|0:a=!1;"h"in r?d=r.h|0:a=!1;return new k(a&&f&&f.thisDep,a&&f&&f.contextDep,a&&f&&f.propDep,function(a,f){var C=a.shared.context,
b=ha;"w"in r||(b=f.def(C,".","framebufferWidth","-",Aa));var c=d;"h"in r||(c=f.def(C,".","framebufferHeight","-",H));return[Aa,H,b,c]})}if(a in g){var h=g[a];a=e(h,function(a,f){var C=a.invoke(f,h),b=a.shared.context,r=f.def(C,".x|0"),c=f.def(C,".y|0"),J=f.def('"w" in ',C,"?",C,".w|0:","(",b,".","framebufferWidth","-",r,")"),C=f.def('"h" in ',C,"?",C,".h|0:","(",b,".","framebufferHeight","-",c,")");return[r,c,J,C]});f&&(a.thisDep=a.thisDep||f.thisDep,a.contextDep=a.contextDep||f.contextDep,a.propDep=
a.propDep||f.prpoDep);return a}return f?new k(f.thisDep,f.contextDep,f.propDep,function(a,f){var C=a.shared.context;return[0,0,f.def(C,".","framebufferWidth"),f.def(C,".","framebufferHeight")]}):null}var c=a["static"],g=a.dynamic,H=b("viewport");if(H)var d=H,H=new k(H.thisDep,H.contextDep,H.propDep,function(a,f){var b=d.append(a,f),r=a.shared.context;f.set(r,".viewportWidth",b[2]);f.set(r,".viewportHeight",b[3]);return b});return{viewport:H,scissor_box:b("scissor.box")}}function Q(a){function f(a){if(a in
b){var r=A.id(b[a]);a=c(function(){return r});a.id=r;return a}if(a in d){var J=d[a];return e(J,function(a,f){var b=a.invoke(f,J);return f.def(a.shared.strings,".id(",b,")")})}return null}var b=a["static"],d=a.dynamic,I=f("frag"),H=f("vert"),h=null;g(I)&&g(H)?(h=t.program(H.id,I.id),a=c(function(a,f){return a.link(h)})):a=new k(I&&I.thisDep||H&&H.thisDep,I&&I.contextDep||H&&H.contextDep,I&&I.propDep||H&&H.propDep,function(a,f){var b=a.shared.shader,r;r=I?I.append(a,f):f.def(b,".","frag");var c;c=H?
H.append(a,f):f.def(b,".","vert");return f.def(b+".program("+c+","+r+")")});return{frag:I,vert:H,progVar:a,program:h}}function O(a){function f(a,C){if(a in b){var r=b[a]|0;return c(function(a,f){C&&(a.OFFSET=r);return r})}if(a in d){var J=d[a];return e(J,function(a,f){var b=a.invoke(f,J);C&&(a.OFFSET=b);return b})}return C&&I?c(function(a,f){a.OFFSET="0";return 0}):null}var b=a["static"],d=a.dynamic,I=function(){if("elements"in b){var a=b.elements;h(a)?a=v.getElements(v.create(a)):a&&(a=v.getElements(a));
var f=c(function(f,b){if(a){var C=f.link(a);return f.ELEMENTS=C}return f.ELEMENTS=null});f.value=a;return f}if("elements"in d){var r=d.elements;return e(r,function(a,f){var b=a.shared,C=b.isBufferArgs,b=b.elements,c=a.invoke(f,r),J=f.def("null"),C=f.def(C,"(",c,")"),c=a.cond(C).then(J,"=",b,".createStream(",c,");")["else"](J,"=",b,".getElements(",c,");");f.entry(c);f.exit(a.cond(C).then(b,".destroyStream(",J,");"));return a.ELEMENTS=J})}return null}(),H=f("offset",!0);return{elements:I,primitive:function(){if("primitive"in
b){var a=b.primitive;return c(function(f,b){return B[a]})}if("primitive"in d){var f=d.primitive;return e(f,function(a,b){var r=a.constants.primTypes,c=a.invoke(b,f);return b.def(r,"[",c,"]")})}return I?g(I)?I.value?c(function(a,f){return f.def(a.ELEMENTS,".primType")}):c(function(){return 4}):new k(I.thisDep,I.contextDep,I.propDep,function(a,f){var b=a.ELEMENTS;return f.def(b,"?",b,".primType:",4)}):null}(),count:function(){if("count"in b){var a=b.count|0;return c(function(){return a})}if("count"in
d){var f=d.count;return e(f,function(a,b){return a.invoke(b,f)})}return I?g(I)?I?H?new k(H.thisDep,H.contextDep,H.propDep,function(a,f){return f.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):c(function(a,f){return f.def(a.ELEMENTS,".vertCount")}):c(function(){return-1}):new k(I.thisDep||H.thisDep,I.contextDep||H.contextDep,I.propDep||H.propDep,function(a,f){var b=a.ELEMENTS;return a.OFFSET?f.def(b,"?",b,".vertCount-",a.OFFSET,":-1"):f.def(b,"?",b,".vertCount:-1")}):null}(),instances:f("instances",!1),
offset:H}}function sa(a){var f=a["static"],d=a.dynamic,g={};za.forEach(function(a){function r(b,H){if(a in f){var Aa=b(f[a]);g[h]=c(function(){return Aa})}else if(a in d){var u=d[a];g[h]=e(u,function(a,f){return H(a,f,a.invoke(f,u))})}}var h=S(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return r(function(a){return a},function(a,
f,b){return b});case "depth.func":return r(function(a){return F[a]},function(a,f,b){return f.def(a.constants.compareFuncs,"[",b,"]")});case "depth.range":return r(function(a){return a},function(a,f,b){a=f.def("+",b,"[0]");f=f.def("+",b,"[1]");return[a,f]});case "blend.func":return r(function(a){return[q["srcRGB"in a?a.srcRGB:a.src],q["dstRGB"in a?a.dstRGB:a.dst],q["srcAlpha"in a?a.srcAlpha:a.src],q["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,f,b){function r(a,C){var J=f.def('"',a,C,'" in ',b,"?",
b,".",a,C,":",b,".",a);return f.def(c,"[",J,"]")}var c=a.constants.blendFuncs;a=r("src","RGB");var J=r("src","Alpha"),e=r("dst","RGB"),d=r("dst","Alpha");return[a,e,J,d]});case "blend.equation":return r(function(a){if("string"===typeof a)return[Z[a],Z[a]];if("object"===typeof a)return[Z[a.rgb],Z[a.alpha]]},function(a,f,b){var r=a.constants.blendEquations,c=f.def(),J=f.def();a=a.cond("typeof ",b,'==="string"');a.then(c,"=",J,"=",r,"[",b,"];");a["else"](c,"=",r,"[",b,".rgb];",J,"=",r,"[",b,".alpha];");
f(a);return[c,J]});case "blend.color":return r(function(a){return p(4,function(f){return+a[f]})},function(a,f,b){return p(4,function(a){return f.def("+",b,"[",a,"]")})});case "stencil.mask":return r(function(a){return a|0},function(a,f,b){return f.def(b,"|0")});case "stencil.func":return r(function(a){return[F[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,f,b){a=f.def('"cmp" in ',b,"?",a.constants.compareFuncs,"[",b,".cmp]",":",7680);var r=f.def(b,".ref|0");f=f.def('"mask" in ',b,"?",
b,".mask|0:-1");return[a,r,f]});case "stencil.opFront":case "stencil.opBack":return r(function(f){return["stencil.opBack"===a?1029:1028,l[f.fail||"keep"],l[f.zfail||"keep"],l[f.pass||"keep"]]},function(f,b,r){function c(a){return b.def('"',a,'" in ',r,"?",J,"[",r,".",a,"]:",7680)}var J=f.constants.stencilOps;return["stencil.opBack"===a?1029:1028,c("fail"),c("zfail"),c("pass")]});case "polygonOffset.offset":return r(function(a){return[a.factor|0,a.units|0]},function(a,f,b){a=f.def(b,".factor|0");f=
f.def(b,".units|0");return[a,f]});case "cull.face":return r(function(a){var f=0;"front"===a?f=1028:"back"===a&&(f=1029);return f},function(a,f,b){return f.def(b,'==="front"?',1028,":",1029)});case "lineWidth":return r(function(a){return a},function(a,f,b){return b});case "frontFace":return r(function(a){return b[a]},function(a,f,b){return f.def(b+'==="cw"?2304:2305')});case "colorMask":return r(function(a){return a.map(function(a){return!!a})},function(a,f,b){return p(4,function(a){return"!!"+b+"["+
a+"]"})});case "sample.coverage":return r(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,f,b){a=f.def('"value" in ',b,"?+",b,".value:1");f=f.def("!!",b,".invert");return[a,f]})}});return g}function na(a){var f=a["static"],b=a.dynamic,d={};Object.keys(f).forEach(function(a){var b=f[a],r;"number"===typeof b||"boolean"===typeof b?r=c(function(){return b}):"function"!==typeof b||"texture2d"!==b._reglType&&"textureCube"!==b._reglType?w(b)&&(r=c(function(a){return a.global.def("[",p(b.length,
function(a){return b[a]}),"]")})):r=c(function(a){return a.link(b)});r.value=b;d[a]=r});Object.keys(b).forEach(function(a){var f=b[a];d[a]=e(f,function(a,b){return a.invoke(b,f)})});return d}function P(a){var f=a["static"],b=a.dynamic,d={};Object.keys(f).forEach(function(a){var b=f[a],r=A.id(a),e=new ma;if(h(b))e.state=1,e.buffer=L.getBuffer(L.create(b,34962,!1)),e.type=e.buffer.dtype;else{var g=L.getBuffer(b);if(g)e.state=1,e.buffer=g,e.type=g.dtype;else if(b.constant){var u=b.constant;e.state=2;
"number"===typeof u?e.x=u:y.forEach(function(a,f){f<u.length&&(e[a]=u[f])})}else{var g=L.getBuffer(b.buffer),ha=b.offset|0,x=b.stride|0,k=b.size|0,l=!!b.normalized,n=0;"type"in b&&(n=M[b.type]);b=b.divisor|0;e.buffer=g;e.state=1;e.size=k;e.normalized=l;e.type=n||g.dtype;e.offset=ha;e.stride=x;e.divisor=b}}d[a]=c(function(a,f){var b=a.attribCache;if(r in b)return b[r];var c={isStream:!1};Object.keys(e).forEach(function(a){c[a]=e[a]});e.buffer&&(c.buffer=a.link(e.buffer));return b[r]=c})});Object.keys(b).forEach(function(a){var f=
b[a];d[a]=e(f,function(a,b){function r(a){b(g[a],"=",c,".",a,"|0;")}var c=a.invoke(b,f),e=a.shared,J=e.isBufferArgs,d=e.buffer,g={isStream:b.def(!1)},h=new ma;h.state=1;Object.keys(h).forEach(function(a){g[a]=b.def(""+h[a])});var u=g.buffer,ha=g.type;b("if(",J,"(",c,")){",g.isStream,"=true;",u,"=",d,".createStream(",34962,",",c,");",ha,"=",u,".dtype;","}else{",u,"=",d,".getBuffer(",c,");","if(",u,"){",ha,"=",u,".dtype;","}else if(",c,".constant){",g.state,"=",2,";",y.map(function(a,f){return g[a]+
"="+c+".length>="+f+"?"+c+"["+f+"]:0;"}).join(""),"}else{",u,"=",d,".getBuffer(",c,".buffer);",ha,'="type" in ',c,"?",e.glTypes,"[",c,".type]:",u,".dtype;",g.normalized,"=!!",c,".normalized;");r("size");r("offset");r("stride");r("divisor");b("}}");return g})});return d}function oa(a){var f=a["static"],b=a.dynamic,g={};Object.keys(f).forEach(function(a){var b=f[a];g[a]=c(function(a,f){return"number"===typeof b||"boolean"===typeof b?""+b:a.link(b)})});Object.keys(b).forEach(function(a){var f=b[a];g[a]=
e(f,function(a,b){return a.invoke(b,f)})});return g}function Y(a,f,b){var c=a.shared.context,e=a.scope();Object.keys(b).forEach(function(g){f.save(c,"."+g);e(c,".",g,"=",b[g].append(a,f),";")});f(e)}function U(a,f,b){var c=a.shared,e=c.gl,g=c.framebuffer,d;x&&(d=f.def(c.extensions,".webgl_draw_buffers"));var h=a.constants,c=h.drawBuffer,h=h.backBuffer;a=b?b.append(a,f):f.def(g,".next");f("if(",g,".dirty||",a,"!==",g,".cur){","if(",a,"){",e,".bindFramebuffer(",36160,",",a,".framebuffer);");x&&f(d,
".drawBuffersWEBGL(",c,"[",a,".colorAttachments.length]);");f("}else{",e,".bindFramebuffer(",36160,",null);");x&&f(d,".drawBuffersWEBGL(",h,");");f("}",g,".cur=",a,";",g,".dirty=false;","}")}function V(a,f,b){var c=a.shared,e=c.gl,g=a.current,d=a.next,h=c.current,x=c.next,k=a.cond(h,".dirty");za.forEach(function(f){f=S(f);if(!(f in b.state)){var c,J;if(f in d){c=d[f];J=g[f];var l=p(u[f].length,function(a){return k.def(c,"[",a,"]")});k(a.cond(l.map(function(a,f){return a+"==="+J+"["+f+"]"}).join("&&")).then(e,
".",qa[f],"(",l,");",l.map(function(a,f){return J+"["+f+"]="+a}).join(";"),";"))}else c=k.def(x,".",f),l=a.cond(c,"!==",h,".",f),k(l),f in pa?l(a.cond(c).then(e,".enable(",pa[f],");")["else"](e,".disable(",pa[f],");"),h,".",f,"=",c,";"):l(e,".",qa[f],"(",c,");",h,".",f,"=",c,";")}});0===Object.keys(b.state).length&&k(h,".dirty=false;");f(k)}function ca(f,b,c,e){var d=f.shared,h=f.current,u=d.current,k=d.gl;a(Object.keys(c)).forEach(function(a){var d=c[a];if(!e||e(d)){var l=d.append(f,b);if(pa[a]){var x=
pa[a];g(d)?l?b(k,".enable(",x,");"):b(k,".disable(",x,");"):b(f.cond(l).then(k,".enable(",x,");")["else"](k,".disable(",x,");"));b(u,".",a,"=",l,";")}else if(w(l)){var n=h[a];b(k,".",qa[a],"(",l,");",l.map(function(a,f){return n+"["+f+"]="+a}).join(";"),";")}else b(k,".",qa[a],"(",l,");",u,".",a,"=",l,";")}})}function ta(a,b){f&&!a.instancing&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function Ca(a,f,b){b=a.stats;a=a.shared;la&&f(a.timer,".beginQuery(",b,");")}function ja(a,
f,b){a=a.shared;la&&f(a.timer,".endQuery();")}function da(a,b,c,e,g){function d(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function h(c,e,g){function d(){b("if(!",n,".pointer){",k,".enableVertexAttribArray(",x,");",n,".pointer=true;}");var c=g.type,h;h=g.size?b.def(g.size,"||",e):e;b("if(",n,".type!==",c,"||",n,".size!==",h,"||",A.map(function(a){return n+"."+a+"!=="+g[a]}).join("||"),
"){",k,".bindBuffer(",34962,",",ha,".buffer);",k,".vertexAttribPointer(",[x,h,c,g.normalized,g.stride,g.offset],");",n,".type=",c,";",n,".size=",h,";",A.map(function(a){return n+"."+a+"="+g[a]+";"}).join(""),"}");f&&(c=g.divisor,b("if(",n,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[x,c],");",n,".divisor=",c,";}"))}function l(){b("if(",n,".pointer){",k,".disableVertexAttribArray(",x,");",n,".pointer=false;","}if(",y.map(function(a,f){return n+"."+a+"!=="+I[f]}).join("||"),"){",
k,".vertexAttrib4f(",x,",",I,");",y.map(function(a,f){return n+"."+a+"="+I[f]+";"}).join(""),"}")}var k=u.gl,x=b.def(c,".location"),n=b.def(u.attributes,"[",x,"]");c=g.state;var ha=g.buffer,I=[g.x,g.y,g.z,g.w],A=["buffer","normalized","offset","stride"];1===c?d():2===c?l():(b("if(",c,"===",1,"){"),d(),b("}else{"),l(),b("}"))}var u=a.shared;e.forEach(function(f){var e=f.name,u=c.attributes[e],k;if(u){if(!g(u))return;k=u.append(a,b)}else{if(!g(T))return;var l=a.scopeAttrib(e);k={};Object.keys(new ma).forEach(function(a){k[a]=
b.def(l,".",a)})}h(a.link(f),d(f.info.type),k)})}function ea(a,f,b,c,e){for(var d=a.shared,h=d.gl,u,k=0;k<c.length;++k){var l=c[k],x=l.name,n=l.info.type,q=b.uniforms[x],l=a.link(l)+".location",z;if(q){if(!e(q))continue;if(g(q)){x=q.value;if(35678===n||35680===n)n=a.link(x._texture),f(h,".uniform1i(",l,",",n+".bind());"),f.exit(n,".unbind();");else if(35674===n||35675===n||35676===n)x=a.global.def("new Float32Array(["+Array.prototype.slice.call(x)+"])"),q=2,35675===n?q=3:35676===n&&(q=4),f(h,".uniformMatrix",
q,"fv(",l,",false,",x,");");else{switch(n){case 5126:u="1f";break;case 35664:u="2f";break;case 35665:u="3f";break;case 35666:u="4f";break;case 35670:u="1i";break;case 5124:u="1i";break;case 35671:u="2i";break;case 35667:u="2i";break;case 35672:u="3i";break;case 35668:u="3i";break;case 35673:u="4i";break;case 35669:u="4i"}f(h,".uniform",u,"(",l,",",w(x)?Array.prototype.slice.call(x):x,");")}continue}else z=q.append(a,f)}else{if(!e(T))continue;z=f.def(d.uniforms,"[",A.id(x),"]")}x=1;switch(n){case 35678:case 35680:n=
f.def(z,"._texture");f(h,".uniform1i(",l,",",n,".bind());");f.exit(n,".unbind();");continue;case 5124:case 35670:u="1i";break;case 35667:case 35671:u="2i";x=2;break;case 35668:case 35672:u="3i";x=3;break;case 35669:case 35673:u="4i";x=4;break;case 5126:u="1f";break;case 35664:u="2f";x=2;break;case 35665:u="3f";x=3;break;case 35666:u="4f";x=4;break;case 35674:u="Matrix2fv";break;case 35675:u="Matrix3fv";break;case 35676:u="Matrix4fv"}f(h,".uniform",u,"(",l,",");if("M"===u.charAt(0)){var l=Math.pow(n-
35674+2,2),m=a.global.def("new Float32Array(",l,")");f("false,(Array.isArray(",z,")||",z," instanceof Float32Array)?",z,":(",p(l,function(a){return m+"["+a+"]="+z+"["+a+"]"}),",",m,")")}else 1<x?f(p(x,function(a){return z+"["+a+"]"})):f(z);f(");")}}function ya(a,b,c,e){function d(f){var g=n[f];return g?g.contextDep&&e.contextDynamic||g.propDep?g.append(a,c):g.append(a,b):b.def(k,".",f)}function u(){function a(){c(E,".drawElementsInstancedANGLE(",[z,w,p,A+"<<(("+p+"-5121)>>1)",m],");")}function f(){c(E,
".drawArraysInstancedANGLE(",[z,A,w,m],");")}q?B?a():(c("if(",q,"){"),a(),c("}else{"),f(),c("}")):f()}function h(){function a(){c(l+".drawElements("+[z,w,p,A+"<<(("+p+"-5121)>>1)"]+");")}function f(){c(l+".drawArrays("+[z,A,w]+");")}q?B?a():(c("if(",q,"){"),a(),c("}else{"),f(),c("}")):f()}var x=a.shared,l=x.gl,k=x.draw,n=e.draw,q=function(){var f=n.elements,g=b;if(f){if(f.contextDep&&e.contextDynamic||f.propDep)g=c;f=f.append(a,g)}else f=g.def(k,".","elements");f&&g("if("+f+")"+l+".bindBuffer(34963,"+
f+".buffer.buffer);");return f}(),z=d("primitive"),A=d("offset"),w=function(){var f=n.count,g=b;if(f){if(f.contextDep&&e.contextDynamic||f.propDep)g=c;f=f.append(a,g)}else f=g.def(k,".","count");return f}();if("number"===typeof w){if(0===w)return}else c("if(",w,"){"),c.exit("}");var m,E;f&&(m=d("instances"),E=a.instancing);var p=q+".type",B=n.elements&&g(n.elements);f&&("number"!==typeof m||0<=m)?"string"===typeof m?(c("if(",m,">0){"),u(),c("}else if(",m,"<0){"),h(),c("}")):u():h()}function va(a,
b,c,e,g){b=X();g=b.proc("body",g);f&&(b.instancing=g.def(b.shared.extensions,".angle_instanced_arrays"));a(b,g,c,e);return b.compile().body}function Da(a,f,b,c){ta(a,f);da(a,f,b,c.attributes,function(){return!0});ea(a,f,b,c.uniforms,function(){return!0});ya(a,f,f,b)}function Ea(a,f){var b=a.proc("draw",1);ta(a,b);Y(a,b,f.context);U(a,b,f.framebuffer);V(a,b,f);ca(a,b,f.state);Ca(a,b,f);var c=f.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",c,".program);");if(f.shader.program)Da(a,b,f,f.shader.program);
else{var e=a.global.def("{}"),g=b.def(c,".id"),d=b.def(e,"[",g,"]");b(a.cond(d).then(d,".call(this,a0);")["else"](d,"=",e,"[",g,"]=",a.link(function(b){return va(Da,a,f,b,1)}),"(",c,");",d,".call(this,a0);"))}0<Object.keys(f.state).length&&b(a.shared.current,".dirty=true;");ja(a,b,f)}function Fa(a,f,b,c){function e(){return!0}a.batchId="a1";ta(a,f);da(a,f,b,c.attributes,e);ea(a,f,b,c.uniforms,e);ya(a,f,f,b)}function ua(a,f,b,c){function e(a){return a.contextDep&&d||a.propDep}function g(a){return!e(a)}
ta(a,f);var d=b.contextDynamic,u=f.def(),h=f.def();a.shared.props=h;a.batchId=u;var x=a.scope(),l=a.scope();f(x.entry,"for(",u,"=0;",u,"<","a1",";++",u,"){",h,"=","a0","[",u,"];",l,"}",x.exit);b.needsContext&&Y(a,l,b.context);b.needsFramebuffer&&U(a,l,b.framebuffer);ca(a,l,b.state,e);c?(da(a,x,b,c.attributes,g),da(a,l,b,c.attributes,e),ea(a,x,b,c.uniforms,g),ea(a,l,b,c.uniforms,e),ya(a,x,l,b)):(f=a.global.def("{}"),c=b.shader.progVar.append(a,l),h=l.def(c,".id"),x=l.def(f,"[",h,"]"),l(a.shared.gl,
".useProgram(",c,".program);","if(!",x,"){",x,"=",f,"[",h,"]=",a.link(function(f){return va(Fa,a,b,f,2)}),"(",c,");}",x,".call(this,a0[",u,"],",u,");"))}function Ha(a,f){var b=a.proc("batch",2);a.batchId="0";ta(a,b);var c=!1,e=!0;Object.keys(f.context).forEach(function(a){c=c||f.context[a].propDep});c||(Y(a,b,f.context),e=!1);var g=f.framebuffer,d=!1;g&&(g.propDep?c=d=!0:g.contextDep&&c&&(d=!0),d||U(a,b,g));f.state.viewport&&f.state.viewport.propDynamic&&(c=!0);V(a,b,f);ca(a,b,f.state,function(a){return!(a.contextDep&&
c||a.propDep)});Ca(a,b,f);f.contextDep=c;f.needsContext=e;f.needsFramebuffer=d;e=f.shader.progVar;if(e.contextDep&&c||e.propDep)ua(a,b,f,null);else if(e=e.append(a,b),b(a.shared.gl,".useProgram(",e,".program);"),f.shader.program)ua(a,b,f,f.shader.program);else{var g=a.global.def("{}"),d=b.def(e,".id"),u=b.def(g,"[",d,"]");b(a.cond(u).then(u,".call(this,a0,a1);")["else"](u,"=",g,"[",d,"]=",a.link(function(b){return va(ua,a,f,b,2)}),"(",e,");",u,".call(this,a0,a1);"))}0<Object.keys(f.state).length&&
b(a.shared.current,".dirty=true;");ja(a,b,f)}function wa(f,b){function c(a){var d=b.shader[a];d&&e.set(g.shader,"."+a,d.append(f,e))}var e=f.proc("scope",3);f.batchId="a2";var g=f.shared,d=g.current,u=g.timer,h;la&&(h=e.def(u,".getNumPendingQueries()"));Y(f,e,b.context);b.framebuffer&&b.framebuffer.append(f,e);a(Object.keys(b.state)).forEach(function(a){var c=b.state[a].append(f,e);w(c)?c.forEach(function(b,c){e.set(f.next[a],"["+c+"]",b)}):e.set(g.next,"."+a,c)});["elements","offset","count","instances",
"primitive"].forEach(function(a){var c=b.draw[a];c&&e.set(g.draw,"."+a,""+c.append(f,e))});Object.keys(b.uniforms).forEach(function(a){e.set(g.uniforms,"["+A.id(a)+"]",b.uniforms[a].append(f,e))});Object.keys(b.attributes).forEach(function(a){var c=b.attributes[a].append(f,e),g=f.scopeAttrib(a);Object.keys(new ma).forEach(function(a){e.set(g,"."+a,c[a])})});c("vert");c("frag");0<Object.keys(b.state).length&&(e(d,".dirty=true;"),e.exit(d,".dirty=true;"));e("a1(",f.shared.context,",a0,0);");if(la){var l=
f.stats,d=e.def(u,".getNumPendingQueries()-1");e(u,".pushScopeStats(",h,",",d,",",l,");")}}var ma=W.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};m.ext_blend_minmax&&(Z.min=32775,Z.max=32776);var f=m.angle_instanced_arrays,x=m.webgl_draw_buffers,u={dirty:!0},xa={},za=[],pa={},qa={};K("dither",3024);K("blend.enable",3042);G("blend.color","blendColor",[0,0,0,0]);G("blend.equation","blendEquationSeparate",[32774,32774]);G("blend.func","blendFuncSeparate",[1,0,1,0]);K("depth.enable",2929,
!0);G("depth.func","depthFunc",513);G("depth.range","depthRange",[0,1]);G("depth.mask","depthMask",!0);G("colorMask","colorMask",[!0,!0,!0,!0]);K("cull.enable",2884);G("cull.face","cullFace",1029);G("frontFace","frontFace",2305);G("lineWidth","lineWidth",1);K("polygonOffset.enable",32823);G("polygonOffset.offset","polygonOffset",[0,0]);K("sample.alpha",32926);K("sample.enable",32928);G("sample.coverage","sampleCoverage",[1,!1]);K("stencil.enable",2960);G("stencil.mask","stencilMask",-1);G("stencil.func",
"stencilFunc",[519,0,-1]);G("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);G("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);K("scissor.enable",3089);G("scissor.box","scissor",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);G("viewport","viewport",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);var Ia={gl:d,context:ga,strings:A,next:xa,current:u,draw:N,elements:v,buffer:L,shader:t,attributes:W.state,uniforms:E,framebuffer:ba,extensions:m,timer:la,isBufferArgs:h},Ba={primTypes:B,
compareFuncs:F,blendFuncs:q,blendEquations:Z,stencilOps:l,glTypes:M,orientationType:b};x&&(Ba.backBuffer=[1029],Ba.drawBuffer=p(D.maxDrawbuffers,function(a){return 0===a?[0]:p(a,function(a){return 36064+a})}));var Ja=0;return{next:xa,current:u,procs:function(){var a=X(),f=a.proc("poll"),b=a.proc("refresh"),c=a.block();f(c);b(c);var e=a.shared,g=e.gl,d=e.next,h=e.current;c(h,".dirty=false;");U(a,f);b(e.framebuffer,".dirty=true;");U(a,b);Object.keys(pa).forEach(function(e){var u=pa[e],l=c.def(d,".",
e),x=a.block();x("if(",l,"){",g,".enable(",u,")}else{",g,".disable(",u,")}",h,".",e,"=",l,";");b(x);f("if(",l,"!==",h,".",e,"){",x,"}")});Object.keys(qa).forEach(function(e){var l=qa[e],x=u[e],k,n,q=a.block();q(g,".",l,"(");w(x)?(l=x.length,k=a.global.def(d,".",e),n=a.global.def(h,".",e),q(p(l,function(a){return k+"["+a+"]"}),");",p(l,function(a){return n+"["+a+"]="+k+"["+a+"];"}).join("")),f("if(",p(l,function(a){return k+"["+a+"]!=="+n+"["+a+"]"}).join("||"),"){",q,"}")):(k=c.def(d,".",e),n=c.def(h,
".",e),q(k,");",h,".",e,"=",k,";"),f("if(",k,"!==",n,"){",q,"}"));b(q)});return a.compile()}(),compile:function(a,f,b,c,e){var g=X();g.stats=g.link(e);e=ia(a);var d=ra(a,e),u=O(a),h=sa(a);a=Q(a);var l=d.viewport;l&&(h.viewport=l);l=S("scissor.box");(d=d[l])&&(h[l]=d);d=0<Object.keys(h).length;e={framebuffer:e,draw:u,shader:a,state:h,dirty:d};e.uniforms=na(b);e.attributes=P(f);e.context=oa(c);Ea(g,e);wa(g,e);Ha(g,e);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,
"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(d,m,t){function h(a,e){this.id=g++;this.type=a;this.data=e}function a(c){if(0===c.length)return[];var e=c.charAt(0),g=c.charAt(c.length-1);if(1<c.length&&e===g&&('"'===e||"'"===e))return['"'+c.substr(1,c.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(c))return a(c.substr(0,e.index)).concat(a(e[1])).concat(a(c.substr(e.index+
e[0].length)));e=c.split(".");if(1===e.length)return['"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];c=[];for(g=0;g<e.length;++g)c=c.concat(a(e[g]));return c}function k(c){return"["+a(c).join("][")+"]"}var g=0;m.exports={define:function(a,e){switch(typeof e){case "boolean":case "number":case "string":return new h(a,k(e+""));case "undefined":return new h(a|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof h},unbox:function(a,e){if(a instanceof h){if(a.type&
128)return new h(a.type&-129,k(e))}else if("function"===typeof a)return new h(0,a);return a},accessor:k}},{}],10:[function(d,m,t){var h=d("./util/is-typed-array"),a=d("./util/is-ndarray"),k=d("./util/values"),g=d("./constants/primitives.json"),c=d("./constants/usage.json");m.exports=function(e,d,m,L){function D(a){this.id=y++;M[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function w(c,b,e,g,k,q,w){(q=w)||h(b)&&(!a(b)||h(b.data))||(q=d.oes_element_index_uint?5125:5123);c.buffer.bind();
m._initBuffer(c.buffer,b,e,q,3);b=w;if(!w){switch(c.buffer.dtype){case 5121:case 5120:b=5121;break;case 5123:case 5122:b=5123;break;case 5125:case 5124:b=5125}c.buffer.dtype=b}c.type=b;0>k&&(k=c.buffer.byteLength,5123===b?k>>=1:5125===b&&(k>>=2));c.vertCount=k;k=g;0>g&&(k=4,g=c.buffer.dimension,1===g&&(k=0),2===g&&(k=1),3===g&&(k=4));c.primType=k}function B(a){L.elementsCount--;delete M[a.id];a.buffer.destroy();a.buffer=null}var M={},y=0,q={uint8:5121,uint16:5123};d.oes_element_index_uint&&(q.uint32=
5125);D.prototype.bind=function(){this.buffer.bind()};var F=[];return{create:function(d){function b(d){if(d)if("number"===typeof d)k(d),n.primType=4,n.vertCount=d|0,n.type=5121;else{var l=null,m=35044,z=-1,B=-1,p=0,y=0;Array.isArray(d)||h(d)||a(d)?l=d:("data"in d&&(l=d.data),"usage"in d&&(m=c[d.usage]),"primitive"in d&&(z=g[d.primitive]),"count"in d&&(B=d.count|0),"length"in d&&(p=d.length|0),"type"in d&&(y=q[d.type]));l?w(n,l,m,z,B,p,y):(d=n.buffer,d.bind(),e.bufferData(34963,p,m),d.dtype=y||5121,
d.usage=m,d.dimension=3,d.byteLength=p,n.primType=0>z?4:z,n.vertCount=0>B?0:B,n.type=d.dtype)}else k(),n.primType=4,n.vertCount=0,n.type=5121;return b}var k=m.create(null,34963,!0),n=new D(k._buffer);L.elementsCount++;b(d);b._reglType="elements";b._elements=n;b.subdata=function(a,c){k.subdata(a,c);return b};b.destroy=function(){B(n)};return b},createStream:function(a){var b=F.pop();b||(b=new D(m.create(null,34963,!0)._buffer));w(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){F.push(a)},
getElements:function(a){return"function"===typeof a&&a._elements instanceof D?a._elements:null},clear:function(){k(M).forEach(B)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(d,m,t){m.exports=function(d){function a(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb ext_disjoint_timer_query angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{k[a]=
d.getExtension(a)}catch(c){}})}var k={};a();return{extensions:k,refresh:a}}},{}],12:[function(d,m,t){var h=d("./util/values"),a=d("./util/extend");m.exports=function(d,g,c,e,m,p){function L(a,b,c,e){this.target=a;this.level=b;this.texture=c;this.renderbuffer=e}function D(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function w(a,b){var c=b.width,e=b.height;if(a.texture)var d=a.texture._texture,g=Math.max(1,d.width>>a.level),h=Math.max(1,d.height>>
a.level),c=c||g,e=e||h;else d=a.renderbuffer._renderbuffer,c=c||d.width,e=e||d.height;d.refCount+=1;b.width=c;b.height=e}function B(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function M(a){var b=3553,c=0,e=null,d=null;"object"===typeof a&&("level"in a&&(c=a.level|0),"target"in a&&(b=a.target|0));var g=a._reglType;"texture2d"===
g?e=a:"textureCube"===g?e=a:"renderbuffer"===g&&(d=a,b=36161,c=0);return new L(b,c,e,d)}function y(a){return a&&(a.texture||a.renderbuffer)}function q(){this.id=ka++;v[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function F(a){d.isFramebuffer(a.framebuffer)||(a.framebuffer=d.createFramebuffer());b.dirty=!0;d.bindFramebuffer(36160,a.framebuffer);
for(var e=a.colorAttachments,h=0;h<e.length;++h)B(36064+h,e[h]);for(h=e.length;h<c.maxColorAttachments;++h)B(36064+h,null);B(36096,a.depthAttachment);B(36128,a.stencilAttachment);B(33306,a.depthStencilAttachment);g.webgl_draw_buffers&&g.webgl_draw_buffers.drawBuffersWEBGL(aa[e.length]);d.checkFramebufferStatus(36160)}function l(a){d.deleteFramebuffer(a.framebuffer);p.framebufferCount--;delete v[a.id]}var b={current:null,next:null,dirty:!1},T={rgba:6408},n={rgba4:32854,rgb565:36194,"rgb5 a1":32855};
g.ext_srgb&&(n.srgba=35907);g.ext_color_buffer_half_float&&(n.rgba16f=34842,n.rgb16f=34843);g.webgl_color_buffer_float&&(n.rgba32f=34836);var A=[],t=[];g.webgl_depth_texture&&(A.push(6402),t.push(34041));a(a({},T),n);h(T);h(n);n=5121;A={uint8:5121};g.oes_texture_half_float&&(n=A["half float"]=36193);g.oes_texture_float&&(n=A["float"]=5126);A.best=n;var aa=function(){for(var a=Array(c.maxDrawbuffers),b=0;b<=c.maxDrawbuffers;++b)for(var e=a[b]=Array(b),d=0;d<b;++d)e[d]=36064+d;return a}(),ka=0,v={};
return a(b,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof q)?a:null},create:function(a){function b(a){var g,h=a||{},l=a=0;if("shape"in h){var n=h.shape;a=n[0];l=n[1]}else"radius"in h&&(a=l=h.radius),"width"in h&&(a=h.width),"height"in h&&(l=h.height);var q=null,n=!1;if("colorBuffers"in h||"colorBuffer"in h){q=h.colorBuffers||h.colorBuffer;Array.isArray(q)||(q=[q]);c.width=a;c.height=l;q=q.map(M);for(g=0;g<q.length;++g)w(q[g],c);
a=c.width;l=c.height}else{var B=!0,p="rgba",A="uint8",t=1,n=!0;c.width=a=a||d.drawingBufferWidth;c.height=l=l||d.drawingBufferHeight;"format"in h&&(p=h.format,B=p in T);"type"in h&&(A=h.type);"colorCount"in h&&(t=h.colorCount|0);if(c.ownsColor)for(q=c.colorAttachments;q.length>t;)D(q.pop());else q=[];for(g=0;g<q.length;++g){var v;a:{v=q[g];var Q=B,O=p,aa=a,R=l;if(v.texture){var P=v.texture;if(Q){P({format:O,type:A,width:aa,height:R});P._texture.refCount+=1;v=!0;break a}}else if(P=v.renderbuffer,!Q){P({format:O,
width:aa,height:R});P._renderbuffer.refCount+=1;v=!0;break a}D(v);v=!1}v||(q[g--]=q[q.length-1],q.pop())}for(;q.length<t;)B?q.push(new L(3553,0,e.create2D({format:p,type:A,width:a,height:l},3553),null)):q.push(new L(36161,0,null,m.create({format:p,width:a,height:l})))}c.width=a;c.height=l;p=B=g=null;A=!1;"depthBuffer"in h&&(g=M(h.depthBuffer));"stencilBuffer"in h&&(B=M(h.stencilBuffer));"depthStencilBuffer"in h&&(p=M(h.depthStencilBuffer));if(g||B||p)w(g||B||p,c);else if(t=!0,Q=v=!1,"depth"in h&&
(t=!!h.depth),"stencil"in h&&(v=!!h.stencil),"depthTexture"in h&&(Q=!!h.depthTexture),h=c.depthAttachment||c.stencilAttachment||c.depthStencilAttachment,O=null,t||v)A=!0,Q?(Q=v?"depth stencil":"depth",c.ownsDepthStencil&&h.texture?(h.texture({format:Q,width:a,height:l}),h.texture._texture.refCount+=1,O=h):O=new L(3553,0,e.create({format:Q,width:a,height:l},3553),null)):(Q=t?v?"depth stencil":"depth":"stencil",c.ownsDepthStencil&&h.renderbuffer?(h.renderbuffer({format:Q,width:a,height:l}),h.renderbuffer._renderbuffer.refCount+=
1,O=h):O=new L(36161,0,null,m.create({format:Q,width:a,height:l}))),t?v?p=O:g=O:B=O;a=c;a.colorAttachments.forEach(D);D(a.depthAttachment);D(a.stencilAttachment);D(a.depthStencilAttachment);c.colorAttachments=q;c.depthAttachment=g;c.stencilAttachment=B;c.depthStencilAttachment=p;c.ownsColor=n;c.ownsDepthStencil=A;b.color=q.map(y);b.depth=y(g);b.stencil=y(B);b.depthStencil=y(p);F(c);b.width=c.width;b.height=c.height;return b}var c=new q;p.framebufferCount++;b(a);b._reglType="framebuffer";b._framebuffer=
c;b._destroy=function(){l(c)};return b},clear:function(){h(v).forEach(l)},refresh:function(){h(v).forEach(F)}})}},{"./util/extend":23,"./util/values":31}],13:[function(d,m,t){m.exports=function(d,a){var k=1;a.ext_texture_filter_anisotropic&&(k=d.getParameter(34047));var g=1,c=1;a.webgl_draw_buffers&&(g=d.getParameter(34852),c=d.getParameter(36063));return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),
subpixelBits:d.getParameter(3408),extensions:Object.keys(a).filter(function(c){return!!a[c]}),maxAnisotropic:k,maxDrawbuffers:g,maxColorAttachments:c,pointSizeDims:d.getParameter(33901),lineWidthDims:d.getParameter(33902),maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),
maxVertexTextureUnits:d.getParameter(35660),maxVaryingVectors:d.getParameter(36348),maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),renderer:d.getParameter(7937),vendor:d.getParameter(7936),version:d.getParameter(7938)}}},{}],14:[function(d,m,t){var h=d("./util/is-typed-array");m.exports=function(a,d,g){return function(c){var e=c||{};h(c)?e={data:e}:2===arguments.length?e={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof c&&(e={});d();var m=e.x||0,p=e.y||0,t=e.width||
g.viewportWidth,D=e.height||g.viewportHeight,e=e.data||new Uint8Array(t*D*4);a.pixelStorei(3333,4);a.readPixels(m,p,t,D,6408,5121,e);return e}}},{"./util/is-typed-array":26}],15:[function(d,m,t){var h=d("./util/values");m.exports=function(a,d,g,c){function e(a){this.id=t++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0}function m(e){var d=e.renderbuffer;a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(d);e.renderbuffer=null;e.refCount=0;delete D[e.id];c.renderbufferCount--}
var p={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};d.ext_srgb&&(p.srgba=35907);d.ext_color_buffer_half_float&&(p.rgba16f=34842,p.rgb16f=34843);d.webgl_color_buffer_float&&(p.rgba32f=34836);var t=0,D={};e.prototype.decRef=function(){0===--this.refCount&&m(this)};return{create:function(d,g){function h(c,e){var d=0,b=0,g=32854;"object"===typeof c&&c?("shape"in c?(b=c.shape,d=b[0]|0,b=b[1]|0):("radius"in c&&(d=b=c.radius|0),"width"in c&&(d=c.width|0),"height"in
c&&(b=c.height|0)),"format"in c&&(g=p[c.format])):"number"===typeof c?(d=c|0,"number"===typeof e?b=e|0:d=b):c||(d=b=1);if(d!==k.width||b!==k.height||g!==k.format)return h.width=k.width=d,h.height=k.height=b,k.format=g,a.bindRenderbuffer(36161,k.renderbuffer),a.renderbufferStorage(36161,g,d,b),h}var k=new e(a.createRenderbuffer());D[k.id]=k;c.renderbufferCount++;h(d,g);h.resize=function(c,d){var e=c|0,b=d|0||e;if(e!==k.width||b!==k.height)return h.width=k.width=e,h.height=k.height=b,a.bindRenderbuffer(36161,
k.renderbuffer),a.renderbufferStorage(36161,k.format,e,b),h};h._reglType="renderbuffer";h._renderbuffer=k;h.destroy=function(){k.decRef()};return h},clear:function(){h(D).forEach(m)}}}},{"./util/values":31}],16:[function(d,m,t){var h=d("./util/values");m.exports=function(a,d,g){function c(a,c,d,b){this.name=a;this.id=c;this.location=d;this.info=b}function e(a,c){for(var d=0;d<a.length;++d)if(a[d].id===c.id){a[d].location=c.location;return}a.push(c)}function m(c,e,g){g=35632===c?D:w;var b=g[e];if(!b){var h=
d.str(e),b=a.createShader(c);a.shaderSource(b,h);a.compileShader(b);g[e]=b}return b}function p(a,c){this.id=y++;this.fragId=a;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[]}function t(g,h){var l,b;l=m(35632,g.fragId);b=m(35633,g.vertId);var p=g.program=a.createProgram();a.attachShader(p,l);a.attachShader(p,b);a.linkProgram(p);var n=a.getProgramParameter(p,35718),w=g.uniforms;for(l=0;l<n;++l)if(b=a.getActiveUniform(p,l))if(1<b.size)for(var B=0;B<b.size;++B){var y=b.name.replace("[0]",
"["+B+"]");e(w,new c(y,d.id(y),a.getUniformLocation(p,y),b))}else e(w,new c(b.name,d.id(b.name),a.getUniformLocation(p,b.name),b));n=a.getProgramParameter(p,35721);w=g.attributes;for(l=0;l<n;++l)(b=a.getActiveAttrib(p,l))&&e(w,new c(b.name,d.id(b.name),a.getAttribLocation(p,b.name),b))}var D={},w={},B={},M=[],y=0;return{clear:function(){var c=a.deleteShader.bind(a);h(D).forEach(c);D={};h(w).forEach(c);w={};M.forEach(function(c){a.deleteProgram(c.program)});M.length=0;B={};g.shaderCount=0},refresh:function(){D=
{};w={};M.forEach(t)},program:function(a,c,d){g.shaderCount++;var b=B[c];b||(b=B[c]={});var e=b[a];e||(e=new p(c,a),t(e,d),b[a]=e,M.push(e));return e},shader:m,frag:null,vert:null}}},{"./util/values":31}],17:[function(d,m,t){m.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(d,m,t){m.exports=function(){var d={"":0},a=[""];return{id:function(k){var g=d[k];if(g)return g;g=d[k]=a.length;a.push(k);
return g},str:function(d){return a[d]}}}},{}],19:[function(d,m,t){function h(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&B(a[0])?!0:!1}function k(a){return Object.prototype.toString.call(a)}function g(b){if(!b)return!1;var c=k(b);return 0<=l.indexOf(c)?!0:h(b)||a(b)||L(b)}function c(a,c){36193===a.type?(a.data=w(c),D.freeType(c)):a.data=c}var e=d("./util/extend"),z=d("./util/values"),p=d("./util/is-typed-array"),L=d("./util/is-ndarray"),
D=d("./util/pool"),w=d("./util/to-half-float"),B=d("./util/is-array-like");t=d("./constants/arraytypes.json");var M=d("./constants/arraytypes.json"),y=[9984,9986,9985,9987],q=[0,6409,6410,6407,6408],F={};F[6409]=F[6406]=F[6402]=1;F[34041]=F[6410]=2;F[6407]=3;F[6408]=4;var l=Object.keys(t).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);m.exports=function(b,d,l,m,t,aa){function ka(){this.format=this.internalformat=6408;
this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function v(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function R(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=
b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=Ca[b.colorSpace]);"type"in b&&(a.type=ja[b.type]);var c=a.width,d=a.height,e=a.channels,g=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(e=b.shape[2],g=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(e=b.channels,g=!0));a.width=c|0;a.height=d|0;a.channels=e|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=
da[c],a.format=Da[d],c in ja&&!("type"in b)&&(a.type=ja[c]),c in ea&&(a.compressed=!0),c=!0);!g&&c?a.channels=F[a.format]:g&&!c&&a.channels!==q[a.format]&&(a.format=a.internalformat=q[a.channels])}}function ba(a){b.pixelStorei(37440,a.flipY);b.pixelStorei(37441,a.premultiplyAlpha);b.pixelStorei(37443,a.colorSpace);b.pixelStorei(3317,a.unpackAlignment)}function E(){ka.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function W(b,d){var e=null;
g(d)?e=d:d&&(R(b,d),"x"in d&&(b.xOffset=d.x|0),"y"in d&&(b.yOffset=d.y|0),g(d.data)&&(e=d.data));if(d.copy){var l=t.viewportWidth,n=t.viewportHeight;b.width=b.width||l-b.xOffset;b.height=b.height||n-b.yOffset;b.needsCopy=!0}else if(!e)b.width=b.width||1,b.height=b.height||1;else if(p(e))b.data=e,"type"in d||5121!==b.type||(b.type=M[Object.prototype.toString.call(e)]|0);else if(h(e)){l=e;n=b.width*b.height*b.channels;switch(b.type){case 5121:case 5123:case 5125:case 5126:n=D.allocType(b.type,n);n.set(l);
b.data=n;break;case 36193:b.data=w(l)}b.alignment=1;b.needsFree=!0}else if(L(e)){l=e.data;Array.isArray(l)||5121!==b.type||(b.type=M[Object.prototype.toString.call(l)]|0);var n=e.shape,m=e.stride,z,y,A,v;3===n.length?(A=n[2],v=m[2]):v=A=1;z=n[0];y=n[1];n=m[0];m=m[1];b.alignment=1;b.width=z;b.height=y;b.channels=A;b.format=b.internalformat=q[A];b.needsFree=!0;z=v;e=e.offset;A=b.width;v=b.height;y=b.channels;for(var r=D.allocType(36193===b.type?5126:b.type,A*v*y),F=0,ca=0;ca<v;++ca)for(var E=0;E<A;++E)for(var I=
0;I<y;++I)r[F++]=l[n*E+m*ca+z*I+e];c(b,r)}else if("[object HTMLCanvasElement]"===k(e)||"[object CanvasRenderingContext2D]"===k(e))"[object HTMLCanvasElement]"===k(e)?b.element=e:b.element=e.canvas,b.width=b.element.width,b.height=b.element.height;else if("[object HTMLImageElement]"===k(e))b.element=e,b.width=e.naturalWidth,b.height=e.naturalHeight;else if("[object HTMLVideoElement]"===k(e))b.element=e,b.width=e.videoWidth,b.height=e.videoHeight,b.needsPoll=!0;else if(a(e)){l=e[0].length;n=e.length;
m=1;if(B(e[0][0])){z=m=e[0][0].length;A=D.allocType(36193===b.type?5126:b.type,l*n*z);for(y=v=0;y<n;++y)for(r=e[y],F=0;F<l;++F)for(ca=r[F],E=0;E<z;++E)A[v++]=ca[E];c(b,A)}else{z=D.allocType(36193===b.type?5126:b.type,l*n);for(v=A=0;v<n;++v)for(y=e[v],r=0;r<l;++r)z[A++]=y[r];c(b,z)}b.alignment=1;b.width=l;b.height=n;b.channels=m;b.format=b.internalformat=q[m];b.needsFree=!0}}function fa(a,c,d,e,g){var h=a.element,k=a.data,l=a.internalformat,n=a.format,p=a.type,r=a.width,q=a.height;ba(a);h?b.texSubImage2D(c,
g,d,e,n,p,h):a.compressed?b.compressedTexSubImage2D(c,g,d,e,l,r,q,k):a.needsCopy?(m(),b.copyTexSubImage2D(c,g,d,e,a.xOffset,a.yOffset,r,q)):b.texSubImage2D(c,g,d,e,r,q,n,p,k)}function N(){return Ea.pop()||new E}function ga(a){a.needsFree&&D.freeType(a.data);E.call(a);Ea.push(a)}function la(){ka.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function S(a,b,c){var d=a.images[0]=N();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function K(a,b){var c=null;
if(g(b))c=a.images[0]=N(),v(c,a),W(c,b),a.mipmask=1;else if(R(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,e=0;e<d.length;++e)c=a.images[e]=N(),v(c,a),c.width>>=e,c.height>>=e,W(c,d[e]),a.mipmask|=1<<e;else c=a.images[0]=N(),v(c,a),W(c,b),a.mipmask=1;v(a,a.images[0])}function G(a,c){for(var e=a.images,d=0;d<e.length&&e[d];++d){var g=e[d],h=c,k=d,l=g.element,n=g.data,p=g.internalformat,q=g.format,w=g.type,z=g.width,B=g.height;ba(g);l?b.texImage2D(h,k,q,q,w,l):g.compressed?b.compressedTexImage2D(h,
k,p,z,B,0,n):g.needsCopy?(m(),b.copyTexImage2D(h,k,q,g.xOffset,g.yOffset,z,B,0)):b.texImage2D(h,k,q,z,B,0,q,w,n)}}function X(){var a=Fa.pop()||new la;ka.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ia(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&ga(b[c]),b[c]=null;Fa.push(a)}function ra(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function Q(a,b){"min"in b&&(a.minFilter=ta[b.min],0<=y.indexOf(a.minFilter)&&
(a.genMipmaps=!0));"mag"in b&&(a.magFilter=ca[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var e=b.wrap;"string"===typeof e?c=d=V[e]:Array.isArray(e)&&(c=V[e[0]],d=V[e[1]])}else"wrapS"in b&&(c=V[b.wrapS]),"wrapT"in b&&(d=V[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=U[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in
b||(a.minFilter=9984)}}function O(a,c){b.texParameteri(c,10241,a.minFilter);b.texParameteri(c,10240,a.magFilter);b.texParameteri(c,10242,a.wrapS);b.texParameteri(c,10243,a.wrapT);d.ext_texture_filter_anisotropic&&b.texParameteri(c,34046,a.anisotropic);a.genMipmaps&&(b.hint(33170,a.mipmapHint),b.generateMipmap(c))}function sa(){var a=ua.pop()||new ra;ra.call(a);return a}function na(a){ka.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ha++;this.refCount=1;this.target=a;this.texture=b.createTexture();
this.unit=-1;this.bindCount=0}function P(a){b.activeTexture(33984);b.bindTexture(a.target,a.texture)}function oa(){var a=Z[0];a?b.bindTexture(a.target,a.texture):b.bindTexture(3553,null)}function Y(a){var c=a.texture,e=a.unit,d=a.target;0<=e&&(b.activeTexture(33984+e),b.bindTexture(d,null),Z[e]=null);b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete wa[a.id]}var U={"don't care":4352,"dont care":4352,nice:4354,fast:4353},V={repeat:10497,clamp:33071,mirror:33648},ca=
{nearest:9728,linear:9729},ta=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ca),Ca={none:0,browser:37444},ja={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},da={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ea={};d.ext_srgb&&(da.srgb=35904,da.srgba=35906);d.oes_texture_float&&(ja["float"]=5126);d.oes_texture_half_float&&(ja.float16=ja["half float"]=
36193);d.webgl_depth_texture&&(e(da,{depth:6402,"depth stencil":34041}),e(ja,{uint16:5123,uint32:5125,"depth stencil":34042}));d.webgl_compressed_texture_s3tc&&e(ea,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});d.webgl_compressed_texture_atc&&e(ea,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});d.webgl_compressed_texture_pvrtc&&e(ea,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
d.webgl_compressed_texture_etc1&&(ea["rgb etc1"]=36196);var ya=Array.prototype.slice.call(b.getParameter(34467));Object.keys(ea).forEach(function(a){var b=ea[a];0<=ya.indexOf(b)&&(da[a]=b)});var va=Object.keys(da);l.textureFormats=va;var Da=va.reduce(function(a,b){var c=da[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ea=[],Fa=[],ua=[],Ha=0,wa={},ma=l.maxTextureUnits,Z=Array(ma).map(function(){return null});
e(na.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var c=0;c<ma;++c){var e=Z[c];if(e){if(0<e.bindCount)continue;e.unit=-1}Z[c]=this;a=c;break}this.unit=a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&Y(this)}});return{create2D:function(a,b){function c(a,b){var d=sa(),f=X();"number"===typeof a?"number"===typeof b?S(f,a|0,b|0):S(f,a|0,a|0):a?(Q(d,a),K(f,a)):S(f,1,1);d.genMipmaps&&
(f.mipmask=(f.width<<1)-1);e.mipmask=f.mipmask;v(e,f);e.internalformat=f.internalformat;c.width=f.width;c.height=f.height;P(e);G(f,3553);O(d,3553);oa();ua.push(d);ia(f);return c}var e=new na(3553);wa[e.id]=e;aa.textureCount++;c(a,b);c.subimage=function(a,b,d,f){b|=0;d|=0;f|=0;var g=N();v(g,e);g.width>>=f;g.height>>=f;g.width-=b;g.height-=d;W(g,a);P(e);fa(g,3553,b,d,f);oa();ga(g);return c};c._reglType="texture2d";c._texture=e;c.destroy=function(){e.decRef()};return c},createCube:function(a,b,c,e,d,
g){function h(a,b,c,e,d,f){var g,n=sa();for(g=0;6>g;++g)l[g]=X();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)S(l[g],a,a);else if("object"===typeof a)if(b)K(l[0],a),K(l[1],b),K(l[2],c),K(l[3],e),K(l[4],d),K(l[5],f);else if(Q(n,a),R(k,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)v(l[g],k),K(l[g],a[g]);else for(g=0;6>g;++g)K(l[g],a);v(k,l[0]);k.mipmask=n.genMipmaps?(l[0].width<<1)-1:l[0].mipmask;k.internalformat=l[0].internalformat;h.width=l[0].width;h.height=l[0].height;P(k);for(g=0;6>g;++g)G(l[g],
34069+g);O(n,34067);oa();ua.push(n);for(g=0;6>g;++g)ia(l[g]);return h}var k=new na(34067);wa[k.id]=k;aa.cubeCount++;var l=Array(6);h(a,b,c,e,d,g);h.subimage=function(a,b,c,e,d){c|=0;e|=0;d|=0;var f=N();v(f,k);f.width>>=d;f.height>>=d;f.width-=c;f.height-=e;W(f,b);P(k);fa(f,34069+a,c,e,d);oa();ga(f);return h};h._reglType="textureCube";h._texture=k;h.destroy=function(){k.decRef()};return h},clear:function(){for(var a=0;a<ma;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),Z[a]=null;z(wa).forEach(Y);
aa.cubeCount=0;aa.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(d,m,t){m.exports=function(d,a){function k(){this.endQueryIndex=this.startQueryIndex=-1;this.stats=null}var g=a.ext_disjoint_timer_query;if(!g)return null;var c=[],e=[],m,p,t=[],D=[];return{beginQuery:function(a){m=a;p=t.pop()||
g.createQueryEXT();g.beginQueryEXT(g.TIME_ELAPSED_EXT,p)},endQuery:function(){g.endQueryEXT(g.TIME_ELAPSED_EXT);var a=D.pop()||new k;a.startQueryIndex=c.length;a.endQueryIndex=a.startQueryIndex;a.stats=m;e.push(a);c.push(p)},update:function(){if(0!==c.length){var a=[],d,h;for(d=0;d<c.length;d++)a[d]=1E-6*g.getQueryObjectEXT(c[d],g.QUERY_RESULT_EXT),t.push(c[d]);c=[];for(d=0;d<e.length;d++){var k=e[d];for(h=k.startQueryIndex;h<=k.endQueryIndex;h++)k.stats.gpuTime+=a[h];D.push(k)}e=[]}},getNumPendingQueries:function(){return c.length},
pushScopeStats:function(a,c,d){var g=D.pop()||new k;g.startQueryIndex=a;g.endQueryIndex=c;g.stats=d;e.push(g)},clear:function(){for(var a=0;a<t.length;a++)g.deleteQueryEXT(t[a])}}}},{}],21:[function(d,m,t){m.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(d,m,t){function h(a){return Array.prototype.slice.call(a)}function a(a){return h(a).join("")}var k=d("./extend");m.exports=function(){function d(){var c=
[],g=[];return k(function(){c.push.apply(c,h(arguments))},{def:function(){var a="v"+e++;g.push(a);0<arguments.length&&(c.push(a,"="),c.push.apply(c,h(arguments)),c.push(";"));return a},toString:function(){return a([0<g.length?"var "+g+";":"",a(c)])}})}function c(){function a(d,g){e(d,g,"=",c.def(d,g),";")}var c=d(),e=d(),h=c.toString,m=e.toString;return k(c,{entry:c,exit:e,save:a,set:function(d,e,b){a(d,e);c(d,e,"=",b,";")},toString:function(){return h()+m()}})}var e=0,m=[],p=[],t=d(),D={};return{global:t,
link:function(a){for(var c=0;c<p.length;++c)if(p[c]===a)return m[c];c="g"+e++;m.push(c);p.push(a);return c},block:d,proc:function(d,e){function g(){var a="a"+h.length;h.push(a);return a}var h=[];e=e||0;for(var m=0;m<e;++m)g();var m=c(),p=m.toString;return D[d]=k(m,{arg:g,toString:function(){return a(["function(",h.join(),"){",p(),"}"])}})},scope:c,cond:function(){var d=a(arguments),e=c(),g=c(),m=e.toString,p=g.toString;return k(e,{then:function(){e.apply(e,h(arguments));return this},"else":function(){g.apply(g,
h(arguments));return this},toString:function(){var c=p();c&&(c="else{"+c+"}");return a(["if(",d,"){",m(),"}",c])}})},compile:function(){var c=['"use strict";',t,"return {"];Object.keys(D).forEach(function(a){c.push('"',a,'":',D[a].toString(),",")});c.push("}");var d=a(c).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,m.concat(d)).apply(null,p)}}}},{"./extend":23}],23:[function(d,m,t){m.exports=function(d,a){for(var k=Object.keys(a),g=0;g<k.length;++g)d[k[g]]=
a[k[g]];return d}},{}],24:[function(d,m,t){var h=d("./is-typed-array");m.exports=function(a){return Array.isArray(a)||h(a)}},{"./is-typed-array":26}],25:[function(d,m,t){var h=d("./is-typed-array");m.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||h(a.data))}},{"./is-typed-array":26}],26:[function(d,m,t){var h=d("../constants/arraytypes.json");m.exports=function(a){return Object.prototype.toString.call(a)in
h}},{"../constants/arraytypes.json":4}],27:[function(d,m,t){m.exports=function(d,a){for(var k=Array(d),g=0;g<d;++g)k[g]=a(g);return k}},{}],28:[function(d,m,t){function h(a){var d,g;d=(65535<a)<<4;a>>>=d;g=(255<a)<<3;a>>>=g;d|=g;g=(15<a)<<2;a>>>=g;d|=g;g=(3<a)<<1;return d|g|a>>>g>>1}function a(a){a:{for(var d=16;268435456>=d;d*=16)if(a<=d){a=d;break a}a=0}d=g[h(a)>>2];return 0<d.length?d.pop():new ArrayBuffer(a)}function k(a){g[h(a.byteLength)>>2].push(a)}var g=d("./loop")(8,function(){return[]});
m.exports={alloc:a,free:k,allocType:function(c,d){var g=null;switch(c){case 5120:g=new Int8Array(a(d),0,d);break;case 5121:g=new Uint8Array(a(d),0,d);break;case 5122:g=new Int16Array(a(2*d),0,d);break;case 5123:g=new Uint16Array(a(2*d),0,d);break;case 5124:g=new Int32Array(a(4*d),0,d);break;case 5125:g=new Uint32Array(a(4*d),0,d);break;case 5126:g=new Float32Array(a(4*d),0,d);break;default:return null}return g.length!==d?g.subarray(0,d):g},freeType:function(a){k(a.buffer)}}},{"./loop":27}],29:[function(d,
m,t){m.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(d){return requestAnimationFrame(d)},cancel:function(d){return cancelAnimationFrame(d)}}:{next:function(d){setTimeout(d,30)},cancel:clearTimeout}},{}],30:[function(d,m,t){var h=d("./pool"),a=new Float32Array(1),k=new Uint32Array(a.buffer);m.exports=function(d){for(var c=h.allocType(5123,d.length),e=0;e<d.length;++e)if(isNaN(d[e]))c[e]=65535;else if(Infinity===d[e])c[e]=31744;else if(-Infinity===
d[e])c[e]=64512;else{a[0]=d[e];var m=k[0],p=m>>>31<<15,t=(m<<1>>>24)-127,m=m>>13&1023;c[e]=-24>t?p:-14>t?p+(m+1024>>-14-t):15<t?p+31744:p+(t+15<<10)+m}return c}},{"./pool":28}],31:[function(d,m,t){m.exports=function(d){return Object.keys(d).map(function(a){return d[a]})}},{}],32:[function(d,m,t){function h(d,c){function e(){var a=window.innerWidth,c=window.innerHeight;d!==document.body&&(c=d.getBoundingClientRect(),a=c.right-c.left,c=c.top-c.bottom);h.width=t*a;h.height=t*c;k(h.style,{width:a+"px",
height:c+"px"})}var h=document.createElement("canvas"),m=a(h,c);k(h.style,{border:0,margin:0,padding:0,top:0,left:0});d.appendChild(h);d===document.body&&(h.style.position="absolute",k(d.style,{margin:0,padding:0}));var t=+m.options.pixelRatio;window.addEventListener("resize",e,!1);var D=m.options.onDestroy;m.options=k(k({},m.options),{onDestroy:function(){window.removeEventListener("resize",e);d.removeChild(h);D&&D()}});e();return m}function a(a,c){function d(c){try{return a.getContext(c,h)}catch(e){return null}}
var h=c.glOptions||{};return{gl:d("webgl")||d("experimental-webgl")||d("webgl-experimental"),options:k({pixelRatio:window.devicePixelRatio},c)}}var k=d("./util/extend");m.exports=function(d){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:d[0],options:d[1]||{}};var c=document.body,e=d[1]||{};if("string"===typeof d[0])c=document.querySelector(d[0])||document.body;else if("object"===typeof d[0])if(d[0]instanceof HTMLElement)c=d[0];else{if(d[0]instanceof WebGLRenderingContext)return{gl:d[0],
options:k({pixelRatio:1},e)};e=d[0]}return c.nodeName&&"CANVAS"===c.nodeName.toUpperCase()?a(c,e):h(c,e)}},{"./util/extend":23}],33:[function(d,m,t){m.exports=function(a,d){function g(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==l.alt,l.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==l.shift,l.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==l.control,l.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==l.meta,l.meta=!!a.metaKey);return b}function c(a,b){var c=h.x(b),e=h.y(b);"buttons"in b&&
(a=b.buttons|0);if(a!==y||c!==q||e!==F||g(b))y=a|0,q=c||0,F=e||0,d&&d(y,q,F,l)}function e(a){c(0,a)}function m(){if(y||q||F||l.shift||l.alt||l.meta||l.control)y=q=F=0,l.shift=l.alt=l.control=l.meta=!1,d&&d(0,0,0,l)}function p(a){g(a)&&d&&d(y,q,F,l)}function t(a){0===h.buttons(a)?c(0,a):c(y,a)}function D(a){c(y|h.buttons(a),a)}function w(a){c(y&~h.buttons(a),a)}function B(){b||(b=!0,a.addEventListener("mousemove",t),a.addEventListener("mousedown",D),a.addEventListener("mouseup",w),a.addEventListener("mouseleave",
e),a.addEventListener("mouseenter",e),a.addEventListener("mouseout",e),a.addEventListener("mouseover",e),a.addEventListener("blur",m),a.addEventListener("keyup",p),a.addEventListener("keydown",p),a.addEventListener("keypress",p),a!==window&&(window.addEventListener("blur",m),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}function M(){b&&(b=!1,a.removeEventListener("mousemove",t),a.removeEventListener("mousedown",D),a.removeEventListener("mouseup",
w),a.removeEventListener("mouseleave",e),a.removeEventListener("mouseenter",e),a.removeEventListener("mouseout",e),a.removeEventListener("mouseover",e),a.removeEventListener("blur",m),a.removeEventListener("keyup",p),a.removeEventListener("keydown",p),a.removeEventListener("keypress",p),a!==window&&(window.removeEventListener("blur",m),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}d||(d=a,a=window);var y=0,q=0,F=0,l={shift:!1,
alt:!1,control:!1,meta:!1},b=!1;B();var T={element:a};Object.defineProperties(T,{enabled:{get:function(){return b},set:function(a){a?B():M},enumerable:!0},buttons:{get:function(){return y},enumerable:!0},x:{get:function(){return q},enumerable:!0},y:{get:function(){return F},enumerable:!0},mods:{get:function(){return l},enumerable:!0}});return T};var h=d("mouse-event")},{"mouse-event":34}],34:[function(d,m,t){function h(a){return a.target||a.srcElement||window}t.buttons=function(a){if("object"===typeof a){if("buttons"in
a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};t.element=h;t.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var d=h(a).getBoundingClientRect();return a.clientX-d.left}return 0};t.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var d=h(a).getBoundingClientRect();return a.clientY-d.top}return 0}},{}],
35:[function(d,m,t){var h=d("./lib/util/extend"),a=d("./lib/dynamic"),k=d("./lib/util/raf"),g=d("./lib/util/clock"),c=d("./lib/strings"),e=d("./lib/webgl"),z=d("./lib/extension"),p=d("./lib/limits"),L=d("./lib/buffer"),D=d("./lib/elements"),w=d("./lib/texture"),B=d("./lib/renderbuffer"),M=d("./lib/framebuffer"),y=d("./lib/attribute"),q=d("./lib/shader"),F=d("./lib/read"),l=d("./lib/core"),b=d("./lib/stats"),T=d("./lib/timer");m.exports=function(){function d(){V=k.next(d);G.tick+=1;G.time=(g()-la)/
1E3;v();for(var a=0;a<U.length;++a)(0,U[a])(G,null,0);E.flush()}function m(a){}function t(a){}function aa(b){function c(b){var d={},e={};Object.keys(b).forEach(function(c){var g=b[c];a.isDynamic(g)?e[c]=a.unbox(g,c):d[c]=g});return{dynamic:e,"static":d}}function d(a){for(;q.length<a;)q.push(null);return q}var e=c(b.context||{}),g=c(b.uniforms||{}),k=c(b.attributes||{}),l=c(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=h({},
a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(b));b={gpuTime:0};var e=P.compile(l,k,g,e,b),m=e.draw,n=e.batch,p=e.scope,q=[];return h(function(a,b){var c;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,
b,0);else if("number"===typeof a){if(0<a)return n.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return m.call(this,a)},{stats:b})}function ka(){var a=oa.viewport,b=oa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;G.viewportWidth=G.frameBufferWidth=G.drawingBufferWidth=a[2]=b[2]=E.drawingBufferWidth;G.viewportHeight=G.frameBufferWidth=G.drawingBufferHeight=a[3]=b[3]=E.drawingBufferHeight}function v(){ka();P.procs.poll()}function R(){ka();P.procs.refresh()}var ba=
e(Array.prototype.slice.call(arguments)),E=ba.gl,W=ba.options,ba=c(),fa=b(),N=z(E).extensions,ga=T(E,N),la=g(),S=E.drawingBufferWidth,K=E.drawingBufferHeight,G={tick:0,time:0,viewportWidth:S,viewportHeight:K,framebufferWidth:S,framebufferHeight:K,drawingBufferWidth:S,drawingBufferHeight:K,pixelRatio:W.pixelRatio},X=p(E,N),ia=L(E,fa),ra=D(E,N,ia,fa),S=y(E,N,X,ia,ba),Q=q(E,ba,fa),O=w(E,N,X,v,G,fa),sa=B(E,N,X,fa),na=M(E,N,X,O,sa,fa),K=F(E,v,G),P=l(E,ba,N,X,ia,ra,O,na,{},S,Q,{elements:null,primitive:4,
count:-1,offset:0,instances:-1},G,ga),oa=P.next,Y=E.canvas,U=[],V=0;Y&&(Y.addEventListener("webglcontextlost",m,!1),Y.addEventListener("webglcontextrestored",t,!1));R();return h(aa,{clear:function(a){var b=0;P.procs.poll();var c=a.color;c&&(E.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(E.clearDepth(+a.depth),b|=256);"stencil"in a&&(E.clearStencil(a.stencil|0),b|=1024);E.clear(b)},prop:a.define.bind(null,1),context:a.define.bind(null,2),"this":a.define.bind(null,3),draw:aa({}),
buffer:function(a){return ia.create(a,34962)},elements:ra.create,texture:O.create2D,cube:O.createCube,renderbuffer:sa.create,framebuffer:na.create,framebufferCube:function(a){},attributes:E.getContextAttributes(),frame:function(a){U.push(a);!V&&0<U.length&&d();return{cancel:function(){var b=U.find(function(b){return b===a});0>b||(U.splice(b,1),0>=U.length&&V&&(k.cancel(d),V=0))}}},limits:X,hasExtension:function(a){return 0<=X.extensions.indexOf(a.toLowerCase())},read:K,destroy:function(){V&&(k.cancel(d),
V=0);Y&&(Y.removeEventListener("webglcontextlost",m),Y.removeEventListener("webglcontextrestored",t));Q.clear();na.clear();sa.clear();O.clear();ra.clear();ia.clear();ga&&ga.clear();if(W.onDestroy)W.onDestroy()},_gl:E,_refresh:R,stats:fa,updateTimer:function(){ga.update()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,
"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>