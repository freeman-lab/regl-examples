<!DOCTYPE html>
      <html>
        <head>
          <title>example/feedback.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(h,q,d){function a(e,g){if(!q[e]){if(!h[e]){var C="function"==typeof require&&require;if(!g&&C)return C(e,!0);if(c)return c(e,!0);C=Error("Cannot find module '"+e+"'");throw C.code="MODULE_NOT_FOUND",C;}C=q[e]={exports:{}};h[e][0].call(C.exports,function(c){var d=h[e][1][c];return a(d?d:c)},C,C.exports,e$$0,h,q,d)}return q[e].exports}for(var c="function"==typeof require&&require,e=0;e<d.length;e++)a(d[e]);return a})({1:[function(f,h,q){var d=f("../regl")(),a=f("mouse-change")(),c=d.texture(),
e=d({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:d.buffer([-2,0,0,-2,2,2])},uniforms:{texture:c,mouse:function(c,d){var e=d.pixelRatio;return[a.x*e,d.height-a.y*e]},t:function(c,a){return.01*a.count}},count:3});d.frame(function(){d.clear({color:[0,0,0,1]});e();c({copy:!0})})},{"../regl":35,"mouse-change":33}],2:[function(f,h,q){var d=f("./constants/dtypes.json");h.exports=function(a,c,e,P,g){function C(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=
this.stride=this.offset=0}function l(c){this.records=[];this.name=c}function f(d,b,k,e){e=k.size||e;var m;m=b.pointer?k.pointer&&b.buffer===k.buffer&&b.size===e&&b.normalized===k.normalized&&b.type===(k.type||k.buffer.dtype||5126)&&b.offset===k.offset&&b.stride===k.stride&&b.divisor===k.divisor:!k.pointer&&b.x===k.x&&b.y===k.y&&b.z===k.z&&b.w===k.w;m||(k.pointer?(a.enableVertexAttribArray(d),k.buffer.bind(),a.vertexAttribPointer(d,e,k.type||k.buffer.dtype||5126,k.normalized,k.stride,k.offset),(m=
c.angle_instanced_arrays)&&m.vertexAttribDivisorANGLE(d,k.divisor)):(a.disableVertexAttribArray(d),a.vertexAttrib4f(d,k.x,k.y,k.z,k.w)),(b.pointer=k.pointer)?(b.buffer=k.buffer,b.size=e,b.normalized=k.normalized,b.type=k.type||k.buffer.dtype||5126,b.offset=k.offset,b.stride=k.stride,b.divisor=k.divisor):(b.x=k.x,b.y=k.y,b.z=k.z,b.w=k.w))}var h={};e=e.maxAttributes;for(var A=Array(e),m=0;m<e;++m)A[m]=new C;return{bindings:A,bind:function(c,b,k,a){k=k.records;f(c,b,k[k.length-1],a)},bindRecord:f,def:function(c){var b=
g.id(c),a=h[b];a||(a=h[b]=new l(c));return a},box:function(c){var b=[new C];return{alloc:function(c){var a;a=0>=b.length?new C:b.pop();if("number"===typeof c)a.pointer=!1,a.x=c,a.y=0,a.z=0,a.w=0;else if(Array.isArray(c))a.pointer=!1,a.x=c[0],a.y=c[1],a.z=c[2],a.w=c[3];else{var e=P.getBuffer(c),m=0,g=0,l=0,f=0,h=!1,z=0;e||(e=P.getBuffer(c.buffer),m=c.size||0,g=c.stride||0,l=c.offset||0,f=c.divisor||0,h=c.normalized||!1,z=0,"type"in c&&(z=d[c.type]));a.pointer=!0;a.buffer=e;a.size=m;a.offset=l;a.stride=
g;a.divisor=f;a.normalized=h;a.type=z}return a},free:function(c){b.push(c)}}},state:h}}},{"./constants/dtypes.json":6}],3:[function(f,h,q){function d(c,a){switch(c){case 5121:return new Uint8Array(a);case 5123:return new Uint16Array(a);case 5125:return new Uint32Array(a);case 5120:return new Int8Array(a);case 5122:return new Int16Array(a);case 5124:return new Int32Array(a);case 5126:return new Float32Array(a);default:return null}}var a=f("./util/is-typed-array"),c=f("./util/is-ndarray"),e=f("./constants/arraytypes.json"),
P=f("./constants/dtypes.json"),g=f("./util/values"),C={"static":35044,dynamic:35048,stream:35040};h.exports=function(l,f){function h(a,c){this.id=z++;this.buffer=a;this.type=c;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function A(a){f(a);l.isBuffer(a.buffer)||(a.buffer=l.createBuffer());a.bind();l.bufferData(a.type,a.data||a.byteLength,a.usage)}function m(a){var c=a.buffer;f(a);l.isBuffer(c)&&l.deleteBuffer(c);a.buffer=null;delete b[a.id]}var z=0,b={};h.prototype.bind=
function(){l.bindBuffer(this.type,this.buffer)};return{create:function(k,g,f){function z(b){var k=b||{};if(Array.isArray(k)||a(k)||c(k))k={data:k};else if("number"===typeof k)k={length:k|0};else if(null===k||void 0===k)k={};u.usage="usage"in k?C[k.usage]:35044;b=0;"type"in k&&(b=P[k.type]);var m=k.dimension|0||1,g=0,l=null;if("data"in k)if(l=k.data,null===l)g=k.length|0;else{if(c(l)){var m=l.shape,g=l.stride,k=l.offset,f=0,h=0,r=0,Q=0;1===m.length?(f=m[0],h=1,r=g[0],Q=0):2===m.length&&(f=m[0],h=m[1],
r=g[0],Q=g[1]);b=b||e[Object.prototype.toString.call(l)]|0||5126;for(var m=h,g=d(b,f*h),l=l.data,ma=0,T=0;T<f;++T)for(var t=0;t<h;++t)g[ma++]=l[r*T+Q*t+k];l=g}else if(Array.isArray(l))if(0<l.length&&Array.isArray(l[0])){m=l[0].length;b=b||5126;k=d(b,l.length*m);g=l;l=m;for(f=Q=0;f<g.length;++f)for(r=g[f],h=0;h<l;++h)k[Q++]=r[h];l=k}else b=b||5126,l=d(b,l);else b=b||e[Object.prototype.toString.call(l)]|0;g=l.byteLength}else"length"in k&&(g=k.length|0);u.data=l;u.dtype=b||5121;u.byteLength=g;u.dimension=
m;A(u);return z}var D=l.createBuffer(),u=new h(D,g);b[u.id]=u;f||z(k);z._reglType="buffer";z._buffer=u;z.destroy=function(){m(u)};return z},clear:function(){g(b).forEach(m)},refresh:function(){g(b).forEach(A)},getBuffer:function(a){return a&&a._buffer instanceof h?a._buffer:null}}}},{"./constants/arraytypes.json":5,"./constants/dtypes.json":6,"./util/is-ndarray":24,"./util/is-typed-array":25,"./util/values":31}],4:[function(f,h,q){function d(a){switch(a){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function a(a,c,d,e){var b,k=",";switch(c){case 5126:b="1f";break;case 35664:b="2fv";break;case 35665:b="3fv";break;case 35666:b="4fv";break;case 35670:case 5124:b="1i";break;case 35671:case 35667:b="2iv";break;case 35672:case 35668:b="3iv";break;case 35673:case 35669:b="4iv";break;case 35674:b="Matrix2fv";k=",false,";break;case 35675:b="Matrix3fv";k=",false,";break;case 35676:b="Matrix4fv",k=",false,"}return a+
".uniform"+b+"("+d+k+e+");"}function c(a){return a+"["+a+".length-1]"}function e(a,c){return"framebuffer"===a||a<c?-1:a>c?1:0}var P=f("./util/codegen"),g=f("./constants/primitives.json"),C={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},
l={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},D={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};h.exports=function(f,h,m,z,b,k,E,t,G,q,u,N,U,la,V){function ja(b,r,h,z,W){function E(y){var a=ra[y];return a?a:a=ra[y]=F(Z[y])}function A(y){var a=y.id,c=ba[a];if(c)return c;switch(y.type){case 0:c=n.def(F(y.data),
".call(this,",O,",",M,")");break;case 1:c=n.def(O,y.data);break;case 2:c=n.def(M,y.data);break;case 3:c=n.def("this",y.data)}return ba[a]=c}function ha(y,a){for(var c=0;c<y.length;++c)if(y[c].name===a)return y[c];return null}function B(y){return K&&!(y in r||y in W)}var G=P(),F=G.link,n=G.proc("batch"),v=G.block(),I=n.def,fa=n.arg,w=F(f),p=F(b.program),R=F(u.bind),na=F(u.bindRecord),M=F(la),Y=F(t),aa=F(U.count),ia=F(U.offset),qa=F(U.instances),S=F(U.primitive),ra={},x=F(k.elements),aa=I(c(aa)),ia=
I(c(ia)),S=I(c(S)),x=I(c(x)),J,N,ka=m.angle_instanced_arrays;ka&&(J=I(c(qa)),N=F(ka));var K="elements"in r,qa=fa(),fa=fa(),O=I(),V=I(),ba={};n(w,".useProgram(",p,");");b.uniforms.forEach(function(y){if(!(y.name in h)){var c=F(y.location),b=F(q.def(y.name)),b=b+"["+b+".length-1]";y=y.info.type;35678===y||35680===y?(y=I(b+"._texture"),n(a(w,5124,c,y+".bind()")),v(y,".unbind();")):n(a(w,y,c,b))}});b.attributes.forEach(function(y){if(!(y.name in z)){var a=F(u.def(y.name));n(R,"(",y.location,",",F(u.bindings[y.location]),
",",a,",",d(y.info.type),");")}});K||n("if(",x,")",w,".bindBuffer(",34963,",",x,".buffer.buffer);");n("for(",V,"=0;",V,"<",qa,";++",V,"){",O,"=",fa,"[",V,"];",M,".batchId=",V,";");Object.keys(r).sort(e).forEach(function(y){function a(y){n("if(",c,"){",w,".enable(",y,");}else{",w,".disable(",y,");}")}var c=A(r[y]);switch(y){case "framebuffer":y=E("viewport");var b=E("scissor.box");n("if(",Y,".push(",c,"&&",c,"._framebuffer)){",Y,".poll();",y,".setDirty();",b,".setDirty();","}");break;case "cull.enable":a(2884);
break;case "blend.enable":a(3042);break;case "dither":a(3024);break;case "stencil.enable":a(2960);break;case "depth.enable":a(2929);break;case "scissor.enable":a(3089);break;case "polygonOffset.enable":a(32823);break;case "sample.alpha":a(32926);break;case "sample.enable":a(32928);break;case "depth.mask":n(w,".depthMask(",c,");");break;case "depth.func":y=F(l);n(w,".depthFunc(",y,"[",c,"]);");break;case "depth.range":n(w,".depthRange(",c,"[0],",c,"[1]);");break;case "blend.color":n(w,".blendColor(",
c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "blend.equation":y=F(L);n("if(typeof ",c,'==="string"){',w,".blendEquation(",y,"[",c,"]);","}else{",w,".blendEquationSeparate(",y,"[",c,".rgb],",y,"[",c,".alpha]);","}");break;case "blend.func":y=F(C);n(w,".blendFuncSeparate(",y,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",y,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",y,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",y,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");break;case "stencil.mask":n(w,
".stencilMask(",c,");");break;case "stencil.func":y=F(l);n(w,".stencilFunc(",y,"[",c,'.cmp||"always"],',c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":b=F(D);n(w,".stencilOpSeparate(","stencil.opFront"===y?1028:1029,",",b,"[",c,'.fail||"keep"],',b,"[",c,'.zfail||"keep"],',b,"[",c,'.pass||"keep"]);');break;case "polygonOffset.offset":n(w,".polygonOffset(",c,".factor||0,",c,".units||0);");break;case "cull.face":n(w,".cullFace(",c,'==="front"?',1028,
":",1029,");");break;case "lineWidth":n(w,".lineWidth(",c,");");break;case "frontFace":n(w,".frontFace(",c,'==="cw"?',2304,":",2305,");");break;case "colorMask":n(w,".colorMask(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "sample.coverage":n(w,".sampleCoverage(",c,".value,",c,".invert);");break;case "scissor.box":case "viewport":y=E(y),n(y,".push(",c,".x||0,",c,".y||0,",c,".w||-1,",c,".h||-1);")}});("viewport"in r||"framebuffer"in r)&&n(E("viewport"),".poll();");("scissor.box"in r||"framebuffer"in
r)&&n(E("scissor.box"),".poll();");"framebuffer"in r&&n(Y,".pop();");var ca=b.uniforms,ta=[];Object.keys(h).forEach(function(c){var b=ha(ca,c);if(b){var p=b.info.type,d=F(b.location);c=A(h[c]);35678===b.info.type||35680===b.info.type?(b=I(c+"._texture"),ta.push(b),n(a(w,5124,d,b+".bind()"))):n(a(w,p,d,c))}});ta.forEach(function(c){n(c,".unbind();")});var pa=b.attributes;Object.keys(z).forEach(function(c){var a=ha(pa,c);if(a){var b=F(u.box(c));c=A(z[c]);c=I(b+".alloc("+c+")");n(na,"(",a.location,",",
F(u.bindings[a.location]),",",c,",",d(a.info.type),");");v(b,".free(",c,");")}});r.count&&n(aa,"=",A(r.count),";");r.offset&&n(ia,"=",A(r.offset),";");r.primitive&&n(S,"=",F(g),"[",A(r.primitive),"];");ka&&r.instances&&n(J,"=",A(r.instances),";");K&&(b=A(r.elements),n(x,"=",b,"?",b,"._elements:null;"));B("offset")&&n(ia,"=0;");n("if(",x,"){");B("count")&&n(aa,"=",x,".vertCount;");n("if(",aa,">0){");B("primitive")&&n(S,"=",x,".primType;");K&&n(w,".bindBuffer(",34963,",",x,".buffer.buffer);");ka&&n("if(",
J,">0){",N,".drawElementsInstancedANGLE(",S,",",aa,",",x,".type,",ia,",",J,");}else ");n(w,".drawElements(",S,",",aa,",",x,".type,",ia,");");n("}}else if(",aa,">0){");B("count")||(B("primitive")&&n(S,"=",4,";"),ka&&n("if(",J,">0){",N,".drawArraysInstancedANGLE(",S,",",ia,",",aa,",",J,");}else{"),n(w,".drawArrays(",S,",",ia,",",aa,");"),ka&&n("}"));n("}}",v);return G.compile().batch}var Z=G.contextState,L={add:32774,subtract:32778,"reverse subtract":32779};m.ext_blend_minmax&&(L.min=32775,L.max=32776);
var r=0;return{draw:function(b){var e=P(),l=e.link,g=e.proc("draw"),r=g.def,h=l(f),C=l(b.program),z=l(u.bind),t=l(U.count),E=l(U.offset),A=l(U.instances),n=l(U.primitive),v=l(k.elements),D=[];g(h,".useProgram(",C,");");b.attributes.forEach(function(c){var a=l(u.def(c.name));g(z,"(",c.location,",",l(u.bindings[c.location]),",",a,",",d(c.info.type),");")});b.uniforms.forEach(function(c){var b=l(c.location),p=l(q.def(c.name)),p=p+"["+p+".length-1]";c=c.info.type;35678===c||35680===c?(c=r(p+"._texture"),
D.push(c),g(a(h,5124,b,c+".bind()"))):g(a(h,c,b,p))});D.forEach(function(c){g(c,".unbind();")});b=r(c(n));t=r(c(t));E=r(c(E));v=r(c(v));g("if(",t,"){");(C=m.angle_instanced_arrays)?(A=r(c(A)),C=l(C),g("if(",v,"){",v,".bind();","if(",A,">0){",C,".drawElementsInstancedANGLE(",b,",",t,",",v,".type,",E,",",A,");}else{",h,".drawElements(",b,",",t,",",v,".type,",E,");}","}else if(",A,">0){",C,".drawArraysInstancedANGLE(",b,",",E,",",t,",",A,");}else{",h,".drawArrays(",b,",",E,",",t,");}}")):g("if(",v,"){",
v,".bind();",h,".drawElements(",b,",",t,",",v,".type,",E,");","}else{",h,".drawArrays(",b,",",E,",",t,");}}");return e.compile().draw},command:function(c,a,b,d,m,f,z,E){function B(c){var a=ra[c];return a?a:a=ra[c]=v(Z[c])}function G(c,a){var b=B(c);x(b,".push(",a,");");J(b,".pop();")}function F(c){var a=c.id,b=ua[a];if(b)return b;switch(c.type){case 0:b=K.def(v(c.data),".call(this,",oa,",",S,")");break;case 1:b=K.def(oa,c.data);break;case 2:b=K.def(S,c.data);break;case 3:b=K.def("this",c.data)}return ua[a]=
b}var n=P(),v=n.link,I=n.block,H=n.proc,w=r++,p=v(V),R=v(N),na=v(t),M={count:v(U.count),offset:v(U.offset),instances:v(U.instances),primitive:v(U.primitive)},Y=v(k.elements),aa=v(g),ia=v(l),qa=v(D),S=v(la),ra={},x=I(),J=I(),oa;E&&(oa=x.def());x(S,".batchId=0;");var ka=I();Object.keys(z["static"]).forEach(function(c){var a=x.def(S,".",c);ka(S,".",c,"=",v(z["static"][c]),";");J(S,".",c,"=",a,";")});Object.keys(z.dynamic).forEach(function(c){var a=x.def(S,".",c),b=x.def(),p=z.dynamic[c];ka(S,".",c,"=",
b,";");switch(p.type){case 0:x(b,"=",v(p.data),".call(this,",oa,",",S,");");break;case 1:x(b,"=",oa,p.data,";");break;case 2:x(b,"=",S,p.data,";");break;case 3:x(b,"=","this",p.data,";")}J(S,".",c,"=",a,";")});x(ka);Object.keys(c).sort(e).forEach(function(a){var b=c[a];switch(a){case "frag":case "vert":b=h.id(b);N.shader("frag"===a?35632:35633,b);x(R,".",a,".push(",b,");");J(R,".",a,".pop();");break;case "framebuffer":t.getFramebuffer(b);a=B("viewport");var p=B("scissor.box");x("if(",na,".push(",
v(b&&b._framebuffer),")){",a,".setDirty();",p,".setDirty();","}");J("if(",na,".pop()){",a,".setDirty();",p,".setDirty();","}");break;case "count":case "offset":case "instances":x(M[a],".push(",b,");");J(M[a],".pop();");break;case "primitive":x(M.primitive,".push(",g[b],");");J(M.primitive,".pop();");break;case "elements":p=k.getElements(b);b=!("primitive"in c);a=!("count"in c);p?(p=v(p),x(Y,".push(",p,");"),b&&x(M.primitive,".push(",p,".primType);"),a&&x(M.count,".push(",p,".vertCount);")):(x(Y,".push(null);"),
b&&x(M.primitive,".push(",4,");"),a&&x(M.count,".push(0);"));b&&J(M.primitive,".pop();");a&&J(M.count,".pop();");"offset"in c||(x(M.offset,".push(0);"),J(M.offset,".pop();"));J(Y,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":G(a,b);break;case "depth.func":G(a,l[b]);break;case "depth.range":a=B(a);x(a,".push(",b[0],",",b[1],");");
J(a,".pop();");break;case "blend.func":a=B(a);x(a,".push(",C["srcRGB"in b?b.srcRGB:b.src],",",C["dstRGB"in b?b.dstRGB:b.dst],",",C["srcAlpha"in b?b.srcAlpha:b.src],",",C["dstAlpha"in b?b.dstAlpha:b.dst],");");J(a,".pop();");break;case "blend.equation":a=B(a);"string"===typeof b?x(a,".push(",L[b],",",L[b],");"):"object"===typeof b&&x(a,".push(",L[b.rgb],",",L[b.alpha],");");J(a,".pop();");break;case "blend.color":a=B(a);x(a,".push(",b[0],",",b[1],",",b[2],",",b[3],");");J(a,".pop();");break;case "stencil.mask":a=
B(a);x(a,".push(",b,");");J(a,".pop();");break;case "stencil.func":var p=b.cmp||"keep",d=b.ref||0,b="mask"in b?b.mask:-1;a=B(a);x(a,".push(",l[p],",",d,",",b,");");J(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":p=b.fail||"keep";d=b.zfail||"keep";b=b.pass||"keep";a=B(a);x(a,".push(",D[p],",",D[d],",",D[b],");");J(a,".pop();");break;case "polygonOffset.offset":p=b.factor||0;b=b.units||0;a=B(a);x(a,".push(",p,",",b,");");J(a,".pop();");break;case "cull.face":p=0;"front"===b?p=1028:
"back"===b&&(p=1029);b=B(a);x(b,".push(",p,");");J(b,".pop();");break;case "lineWidth":G(a,b);break;case "frontFace":p=0;"cw"===b?p=2304:"ccw"===b&&(p=2305);b=B(a);x(b,".push(",p,");");J(b,".pop();");break;case "colorMask":a=B(a);x(a,".push(",b.map(function(c){return!!c}).join(),");");J(a,".pop();");break;case "sample.coverage":p="value"in b?b.value:1;b=!!b.invert;a=B(a);x(a,".push(",p,",",b,");");J(a,".pop();");break;case "viewport":case "scissor.box":var p=b.x||0,d=b.y||0,e=-1,m=-1;"w"in b&&(e=
b.w);"h"in b&&(m=b.h);b=B(a);x(b,".push(",p,",",d,",",e,",",m,");");J(b,".pop();")}});Object.keys(a).forEach(function(c){var b=v(q.def(c));c=a[c];c="function"===typeof c&&c._reglType?v(c):Array.isArray(c)?v(c.slice()):+c;x(b,".push(",c,");");J(b,".pop();")});Object.keys(b).forEach(function(c){var a=b[c],p=v(u.def(c));c=v(u.box(c).alloc(a));x(p,".records.push(",c,");");J(p,".records.pop();")});var K=n.block(),O=n.block(),ua={};Object.keys(d).sort(e).forEach(function(b){var a=F(d[b]);switch(b){case "framebuffer":b=
B("viewport");var p=B("scissor.box");K("if(",na,".push(",a,"&&",a,"._framebuffer)){",b,".setDirty();",p,".setDirty();","}");O("if(",na,".pop()){",b,".setDirty();",p,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":b=B(b);K(b,".push(",a,");");O(b,".pop();");break;case "count":case "offset":case "instances":b=
M[b];K(b,".push(",a,");");O(b,".pop();");break;case "primitive":b=M.primitive;K(b,".push(",aa,"[",a,"]);");O(b,".pop();");break;case "depth.func":b=B(b);K(b,".push(",ia,"[",a,"]);");O(b,".pop();");break;case "blend.func":b=B(b);p=v(C);K(b,".push(",p,'["srcRGB" in ',a,"?",a,".srcRGB:",a,".src],",p,'["dstRGB" in ',a,"?",a,".dstRGB:",a,".dst],",p,'["srcAlpha" in ',a,"?",a,".srcAlpha:",a,".src],",p,'["dstAlpha" in ',a,"?",a,".dstAlpha:",a,".dst]);");O(b,".pop();");break;case "blend.equation":b=B(b);p=
v(L);K("if(typeof ",a,'==="string"){',b,".push(",p,"[",a,"],",p,"[",a,"]);","}else{",b,".push(",p,"[",a,".rgb],",p,"[",a,".alpha]);","}");O(b,".pop();");break;case "blend.color":b=B(b);K(b,".push(",a,"[0],",a,"[1],",a,"[2],",a,"[3]);");O(b,".pop();");break;case "stencil.mask":b=B(b);K(b,".push(",a,");");O(b,".pop();");break;case "stencil.func":b=B(b);K(b,".push(",ia,"[",a,".cmp],",a,".ref|0,",'"mask" in ',a,"?",a,".mask:-1);");O(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":b=B(b);
K(b,".push(",qa,"[",a,'.fail||"keep"],',qa,"[",a,'.zfail||"keep"],',qa,"[",a,'.pass||"keep"]);');O(b,".pop();");break;case "polygonOffset.offset":b=B(b);K(b,".push(",a,".factor||0,",a,".units||0);");O(b,".pop();");break;case "cull.face":b=B(b);K(b,".push(",a,'==="front"?',1028,":",1029,");");O(b,".pop();");break;case "frontFace":b=B(b);K(b,".push(",a,'==="cw"?',2304,":",2305,");");O(b,".pop();");break;case "colorMask":b=B(b);K(b,".push(",a,"[0],",a,"[1],",a,"[2],",a,"[3]);");O(b,".pop();");break;
case "sample.coverage":b=B(b);K(b,".push(",a,".value,",a,".invert);");O(b,".pop();");break;case "scissor.box":case "viewport":b=B(b);K(b,".push(",a,".x||0,",a,".y||0,",'"w" in ',a,"?",a,".w:-1,",'"h" in ',a,"?",a,".h:-1);");O(b,".pop();");break;case "elements":b=!("primitive"in d)&&!("primitive"in c);var p=!("count"in d)&&!("count"in c),e=!("offset"in d)&&!("offset"in c),k=K.def();K("if(",a,"){",k,"=",a,"._elements;",Y,".push(",k,");",b?M.primitive+".push("+k+".primType);":"",p?M.count+".push("+k+
".vertCount);":"",e?M.offset+".push("+k+".offset);":"","}else{",Y,".push(null);","}");O(Y,".pop();","if(",a,"){",b?M.primitive+".pop();":"",p?M.count+".pop();":"",e?M.offset+".pop();":"","}")}});Object.keys(m).forEach(function(b){var a=v(q.def(b));b=F(m[b]);K(a,".push(",b,");");O(a,".pop();")});Object.keys(f).forEach(function(b){var a=v(u.def(b)),c=F(f[b]);b=v(u.box(b));K(a,".records.push(",b,".alloc(",c,"));");O(b,".free(",a,".records.pop());")});var ba=H("scope"),ca=ba.arg(),ta=ba.arg();E&&ba(oa,
"=",ca,";");ba(x);E&&ba(K);ba(ta,"(",ca,",",S,");",E?O:"",J);ba=I();I=ba.def();c.frag&&c.vert?(ca=c.frag,ba(I,"=",v(N.program(h.id(c.vert),h.id(ca))),";")):ba(I,"=",R,".program","(",R,".vert[",R,".vert.length-1]",",",R,".frag[",R,".frag.length-1]",");");ca=H("draw");E&&ca(oa,"=",ca.arg(),";");ca(x,ba);E&&ca(K);ca(p,"();","if(",I,")",I,".draw.call(this",E?","+oa:"",");",E?O:"",J);var pa=H("batch"),H=pa.arg(),ca=pa.arg();E&&pa(oa,"=",ca,"[0];");pa(x,ba);E=v(function(b,a,p){var e=b.batchCache[w];e||
(e=b.batchCache[w]=ja(b,d,m,f,c));return e.call(this,a,p)});pa("if(",I,"){",p,"();",E,".call(this,",I,",",H,",",ca,");");Object.keys(d).forEach(function(b){(b=ra[b])&&pa(b,".setDirty();")});pa("}",J);return n.compile()}}}},{"./constants/primitives.json":7,"./util/codegen":22}],5:[function(f,h,q){h.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,
"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],6:[function(f,h,q){h.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],7:[function(f,h,q){h.exports={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],8:[function(f,h,q){h.exports=function(d){return{primitive:[4],count:[-1],offset:[0],instances:[0]}}},{}],9:[function(f,h,q){function d(a,c){this.id=e++;this.type=a;
this.data=c}function a(c){if(0===c.length)return[];var d=c.charAt(0),e=c.charAt(c.length-1);if(1<c.length&&d===e&&('"'===d||"'"===d))return['"'+c.substr(1,c.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(d=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(c))return a(c.substr(0,d.index)).concat(a(d[1])).concat(a(c.substr(d.index+d[0].length)));d=c.split(".");if(1===d.length)return['"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];c=[];for(e=0;e<d.length;++e)c=c.concat(a(d[e]));return c}
function c(c){return"["+a(c).join("][")+"]"}var e=0;h.exports={define:function(a,e){switch(typeof e){case "boolean":case "number":case "string":return new d(a,c(e+""));case "undefined":return new d(a|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof d},unbox:function(a,e){if(a instanceof d){if(a.type&128)return new d(a.type&-129,c(e))}else if("function"===typeof a)return new d(0,a);return a},accessor:c}},{}],10:[function(f,h,q){var d=f("./util/is-typed-array"),
a=f("./util/is-ndarray"),c=f("./constants/primitives.json");h.exports=function(e,f,g){function h(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}h.prototype.bind=function(){this.buffer.bind()};return{create:function(e){function D(e){var l=f.oes_element_index_uint;if(e)if("number"===typeof e)A(e);else{var b=null,k="static",g=0;Array.isArray(e)||d(e)||a(e)?b=e:("data"in e&&(b=e.data),"usage"in e&&(k=e.usage),"length"in e&&(g=e.length));Array.isArray(b)||a(b)&&"array"===b.dtype||"type"in
e?A({type:e.type||(l?"uint32":"uint16"),usage:k,data:b,length:g}):A({usage:k,data:b,length:g});if(Array.isArray(b)||d(b))A.dimension=3}else A();l=H.buffer.byteLength;b=0;switch(H.buffer.dtype){case 5121:case 5120:b=5121;break;case 5123:case 5122:b=5123;l>>=1;break;case 5125:case 5124:b=5125,l>>=2}k=4;g=H.buffer.dimension;1===g&&(k=0);2===g&&(k=1);3===g&&(k=4);"object"===typeof e&&("primitive"in e&&(k=c[e.primitive]),"count"in e&&(l=e.vertCount|0));H.primType=k;H.vertCount=l;H.type=b;return D}var H=
new h,A=g.create(null,34963,!0);H.buffer=A._buffer;D(e);D._reglType="elements";D._elements=H;D.destroy=function(){A.destroy();H.buffer=null};return D},elements:[null],getElements:function(a){return a&&a._elements instanceof h?a._elements:null}}}},{"./constants/primitives.json":7,"./util/is-ndarray":24,"./util/is-typed-array":25}],11:[function(f,h,q){h.exports=function(d){function a(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{c[a]=
d.getExtension(a)}catch(f){}})}var c={};a();return{extensions:c,refresh:a}}},{}],12:[function(f,h,q){var d=f("./util/values"),a=f("./util/extend"),c=[1029];h.exports=function(e,f,g,h,l){function D(b,a,c,e){this.target=b;this.level=a;this.texture=c;this.renderbuffer=e}function H(b){b&&(b.texture&&b.texture._texture.decRef(),b.renderbuffer&&b.renderbuffer._renderbuffer.decRef())}function A(b,a){var c=a.width,e=a.height;if(b.texture)var d=b.texture._texture,k=Math.max(1,d.params.width>>b.level),l=Math.max(1,
d.params.height>>b.level),c=c||k,e=e||l;else d=b.renderbuffer._renderbuffer,c=c||d.width,e=e||d.height;d.refCount+=1;a.width=c;a.height=e}function m(b,a){a?a.texture?e.framebufferTexture2D(36160,b,a.target,a.texture._texture.texture,a.level):e.framebufferRenderbuffer(36160,b,36161,a.renderbuffer._renderbuffer.renderbuffer):e.framebufferTexture2D(36160,b,3553,null,0)}function z(b){var a=3553,c=0,e=null,d=null;"object"===typeof b&&("level"in b&&(c=b.level|0),"target"in b&&(a=b.target|0));var k=b._reglType;
"texture"===k?e=b:"renderbuffer"===k&&(d=b,a=36161,c=0);return new D(a,c,e,d)}function b(b){return b&&(b.texture||b.renderbuffer)}function k(){this.id=V++;ja[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function E(b){e.isFramebuffer(b.framebuffer)||(b.framebuffer=e.createFramebuffer());L=!0;e.bindFramebuffer(36160,b.framebuffer);for(var a=b.colorAttachments,
c=0;c<a.length;++c)m(36064+c,a[c]);for(c=a.length;c<g.maxColorAttachments;++c)m(36064+c,null);m(36096,b.depthAttachment);m(36128,b.stencilAttachment);m(33306,b.depthStencilAttachment);f.webgl_draw_buffers&&f.webgl_draw_buffers.drawBuffersWEBGL(la[a.length]);e.checkFramebufferStatus(36160)}function t(b){b=b.framebuffer;e.isFramebuffer(b)&&e.deleteFramebuffer(b)}function G(){return Z[Z.length-1]}var q={rgba:6408},u={rgba4:32854,rgb565:36194,"rgb5 a1":32855};f.ext_srgb&&(u.srgba=35907);f.ext_color_buffer_half_float&&
(u.rgba16f=34842,u.rgb16f=34843);f.webgl_color_buffer_float&&(u.rgba32f=34836);var N=[],U=[];f.webgl_depth_texture&&(N.push(6402),U.push(34041));a(a({},q),u);d(q);d(u);u=5121;N={uint8:5121};f.oes_texture_half_float&&(u=N["half float"]=36193);f.oes_texture_float&&(u=N["float"]=5126);N.best=u;var la=function(){for(var b=Array(g.maxDrawbuffers),a=0;a<=g.maxDrawbuffers;++a)for(var c=b[a]=Array(a),e=0;e<a;++e)c[e]=36064+e;return b}(),V=0,ja={},Z=[null],L=!0;return{top:G,dirty:function(){return L},push:function(b){b=
b||null;L=L||b!==G();Z.push(b);return L},pop:function(){var b=G();Z.pop();return L=L||b!==G()},getFramebuffer:function(b){return"function"===typeof b&&"framebuffer"===b._reglType&&(b=b._framebuffer,b instanceof k)?b:null},poll:function(){if(L){var b=Z[Z.length-1],a=f.webgl_draw_buffers;b?(e.bindFramebuffer(36160,b.framebuffer),a&&a.drawBuffersWEBGL(la[b.colorAttachments.length])):(e.bindFramebuffer(36160,null),a&&a.drawBuffersWEBGL(c));L=!1}},create:function(a){function c(a){var k,g=a||{},m=a=0;if("shape"in
g){var f=g.shape;a=f[0];m=f[1]}else"radius"in g&&(a=m=g.radius),"width"in g&&(a=g.width),"height"in g&&(m=g.height);var t=null,f=!1;if("colorBuffers"in g||"colorBuffer"in g){t=g.colorBuffers||g.colorBuffer;Array.isArray(t)||(t=[t]);d.width=a;d.height=m;t=t.map(z);for(k=0;k<t.length;++k)A(t[k],d);a=d.width;m=d.height}else{var u=!0,r="rgba",P="uint8",n=1,f=!0;d.width=a=a||e.drawingBufferWidth;d.height=m=m||e.drawingBufferHeight;"format"in g&&(r=g.format,u=r in q);"type"in g&&(P=g.type);"colorCount"in
g&&(n=g.colorCount|0);if(d.ownsColor)for(t=d.colorAttachments;t.length>n;)H(t.pop());else t=[];for(k=0;k<t.length;++k){var v;a:{v=t[k];var G=u,N=r,w=a,p=m;if(v.texture){var R=v.texture;if(G){R({format:N,type:P,width:w,height:p});R._texture.refCount+=1;v=!0;break a}}else if(R=v.renderbuffer,!G){R({format:N,width:w,height:p});R._renderbuffer.refCount+=1;v=!0;break a}H(v);v=!1}v||(t[k--]=t[t.length-1],t.pop())}for(;t.length<n;)u?t.push(new D(3553,0,h.create({format:r,type:P,width:a,height:m},3553),null)):
t.push(new D(36161,0,null,l.create({format:r,width:a,height:m})))}d.width=a;d.height=m;r=u=k=null;P=!1;"depthBuffer"in g&&(k=z(g.depthBuffer));"stencilBuffer"in g&&(u=z(g.stencilBuffer));"depthStencilBuffer"in g&&(r=z(g.depthStencilBuffer));if(k||u||r)A(k||u||r,d);else if(n=!0,G=v=!1,"depth"in g&&(n=!!g.depth),"stencil"in g&&(v=!!g.stencil),"depthTexture"in g&&(G=!!g.depthTexture),g=d.depthAttachment||d.stencilAttachment||d.depthStencilAttachment,N=null,n||v)P=!0,G?(G=v?"depth stencil":"depth",d.ownsDepthStencil&&
g.texture?(g.texture({format:G,width:a,height:m}),g.texture._texture.refCount+=1,N=g):N=new D(3553,0,h.create({format:G,width:a,height:m},3553),null)):(G=n?v?"depth stencil":"depth":"stencil",d.ownsDepthStencil&&g.renderbuffer?(g.renderbuffer({format:G,width:a,height:m}),g.renderbuffer._renderbuffer.refCount+=1,N=g):N=new D(36161,0,null,l.create({format:G,width:a,height:m}))),n?v?r=N:k=N:u=N;a=d;a.colorAttachments.forEach(H);H(a.depthAttachment);H(a.stencilAttachment);H(a.depthStencilAttachment);
d.colorAttachments=t;d.depthAttachment=k;d.stencilAttachment=u;d.depthStencilAttachment=r;d.ownsColor=f;d.ownsDepthStencil=P;c.color=t.map(b);c.depth=b(k);c.stencil=b(u);c.depthStencil=b(r);E(d);c.width=d.width;c.height=d.height;return c}var d=new k;c(a);c._reglType="framebuffer";c._framebuffer=d;c._destroy=function(){t(d)};return c},clear:function(){d(ja).forEach(t)},refresh:function(){d(ja).forEach(E)}}}},{"./util/extend":23,"./util/values":31}],13:[function(f,h,q){h.exports=function(d,a){var c=
1;a.ext_texture_filter_anisotropic&&(c=d.getParameter(34047));var e=1,f=1;a.webgl_draw_buffers&&(e=d.getParameter(34852),f=d.getParameter(36063));return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),subpixelBits:d.getParameter(3408),extensions:Object.keys(a).filter(function(c){return!!a[c]}),maxAnisotropic:c,maxDrawbuffers:e,maxColorAttachments:f,pointSizeDims:d.getParameter(33901),lineWidthDims:d.getParameter(33902),
maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),maxVertexTextureUnits:d.getParameter(35660),maxVaryingVectors:d.getParameter(36348),maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),renderer:d.getParameter(7937),vendor:d.getParameter(7936),
version:d.getParameter(7938)}}},{}],14:[function(f,h,q){var d=f("./util/is-typed-array");h.exports=function(a,c,e){return function(f){var g=f||{};d(f)?g={data:g}:2===arguments.length?g={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof f&&(g={});c();var h=g.x||0,l=g.y||0,D=g.width||e.width,q=g.height||e.height,g=g.data||new Uint8Array(D*q*4);a.pixelStorei(3333,4);a.readPixels(h,l,D,q,6408,5121,g);return g}}},{"./util/is-typed-array":25}],15:[function(f,h,q){var d=f("./util/values");h.exports=
function(a,c,e){function f(){this.id=D++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function g(c){a.isRenderbuffer(c.renderbuffer)||(c.renderbuffer=a.createRenderbuffer());a.bindRenderbuffer(36161,c.renderbuffer);a.renderbufferStorage(36161,c.format,c.width,c.height)}function h(c){var d=c.renderbuffer;a.bindRenderbuffer(36161,null);a.isRenderbuffer(d)&&a.deleteRenderbuffer(d);c.renderbuffer=null;c.refCount=0;delete q[c.id]}var l={rgba4:32854,rgb565:36194,"rgb5 a1":32855,
depth:33189,stencil:36168,"depth stencil":34041};c.ext_srgb&&(l.srgba=35907);c.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);c.webgl_color_buffer_float&&(l.rgba32f=34836);var D=0,q={};f.prototype.decRef=function(){0===--this.refCount&&h(this)};return{create:function(a){function c(b){b=b||{};var a=0,e=0;"shape"in b?(e=b.shape,a=e[0]|0,e=e[1]|0):("radius"in b&&(a=e=b.radius|0),"width"in b&&(a=b.width|0),"height"in b&&(e=b.height|0));c.width=d.width=Math.max(a,1);c.height=d.height=Math.max(e,
1);d.format=32854;"format"in b&&(d.format=l[b.format]);g(d);return c}var d=new f;q[d.id]=d;c(a);c._reglType="renderbuffer";c._renderbuffer=d;c.destroy=function(){d.decRef()};return c},refresh:function(){d(q).forEach(g)},clear:function(){d(q).forEach(h)}}}},{"./util/values":31}],16:[function(f,h,q){function d(a,d,f,g){this.name=a;this.id=d;this.location=f;this.info=g}var a=f("./util/values");h.exports=function(c,e,f,g,h){function l(b,a){var d=35632===b?A:m,e=d[a];if(!e){var g=h.str(a),e=c.createShader(b);
c.shaderSource(e,g);c.compileShader(e);d[a]=e}return e}function D(b,a){this.fragId=b;this.vertId=a;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function q(b){var a,m;a=l(35632,b.fragId);m=l(35633,b.vertId);var z=b.program=c.createProgram();c.attachShader(z,a);c.attachShader(z,m);c.linkProgram(z);var D=c.getProgramParameter(z,35718),u=b.uniforms=[];for(a=0;a<D;++a)if(m=c.getActiveUniform(z,a))if(1<m.size)for(var A=0;A<m.size;++A){var H=m.name.replace("[0]",
"["+A+"]");f.def(H);u.push(new d(H,h.id(H),c.getUniformLocation(z,H),m))}else f.def(m.name),u.push(new d(m.name,h.id(m.name),c.getUniformLocation(z,m.name),m));D=c.getProgramParameter(z,35721);u=b.attributes=[];for(a=0;a<D;++a)if(m=c.getActiveAttrib(z,a))e.def(m.name),u.push(new d(m.name,h.id(m.name),c.getAttribLocation(z,m.name),m));b.draw=g(b);b.batchCache={}}var A={},m={},z={},b=[];return{clear:function(){var d=c.deleteShader.bind(c);a(A).forEach(d);A={};a(m).forEach(d);m={};b.forEach(function(b){c.deleteProgram(b.program)});
b.length=0;z={}},refresh:function(){A={};m={};b.forEach(q)},program:function(a,c){var d=z[c];d||(d=z[c]={});var e=d[a];e||(e=new D(c,a),q(e),d[a]=e,b.push(e));return e},shader:l,frag:[-1],vert:[-1]}}},{"./util/values":31}],17:[function(f,h,q){var d=f("./util/stack"),a=f("./util/codegen");h.exports=function(c,e,f){function g(a,e){var b=d([!!e],function(b){b?c.enable(a):c.disable(a)});b.flag=a;return b}var h={dither:g(3024),"blend.enable":g(3042),"blend.color":d([0,0,0,0],function(a,d,b,e){c.blendColor(a,
d,b,e)}),"blend.equation":d([32774,32774],function(a,d){c.blendEquationSeparate(a,d)}),"blend.func":d([1,0,1,0],function(a,d,b,e){c.blendFuncSeparate(a,d,b,e)}),"depth.enable":g(2929,!0),"depth.func":d([513],function(a){c.depthFunc(a)}),"depth.range":d([0,1],function(a,d){c.depthRange(a,d)}),"depth.mask":d([!0],function(a){c.depthMask(a)}),"cull.enable":g(2884),"cull.face":d([1029],function(a){c.cullFace(a)}),frontFace:d([2305],function(a){c.frontFace(a)}),colorMask:d([!0,!0,!0,!0],function(a,d,b,
e){c.colorMask(a,d,b,e)}),lineWidth:d([1],function(a){c.lineWidth(a)}),"polygonOffset.enable":g(32823),"polygonOffset.offset":d([0,0],function(a,d){c.polygonOffset(a,d)}),"sample.alpha":g(32926),"sample.enable":g(32928),"sample.coverage":d([1,!1],function(a,d){c.sampleCoverage(a,d)}),"stencil.enable":g(2960),"stencil.mask":d([-1],function(a){c.stencilMask(a)}),"stencil.func":d([519,0,-1],function(a,d,b){c.stencilFunc(a,d,b)}),"stencil.opFront":d([7680,7680,7680],function(a,d,b){c.stencilOpSeparate(1028,
a,d,b)}),"stencil.opBack":d([7680,7680,7680],function(a,d,b){c.stencilOpSeparate(1029,a,d,b)}),"scissor.enable":g(3089),"scissor.box":d([0,0,-1,-1],function(a,d,b,g){var l=b,f=e.top();0>b&&(l=f?f.width-a:c.drawingBufferWidth-a);b=g;0>g&&(b=f?f.height-d:c.drawingBufferHeight-d);c.scissor(a,d,l,b)}),viewport:d([0,0,-1,-1],function(a,d,b,g){var l=b,h=e.top();0>b&&(l=h?h.width-a:c.drawingBufferWidth-a);b=g;0>g&&(b=h?h.height-d:c.drawingBufferHeight-d);c.viewport(a,d,l,b);f.width=l;f.height=b})},l=a(),
D=l.proc("poll"),q=l.proc("refresh");Object.keys(h).forEach(function(a){a=l.link(h[a]);D(a,".poll();");q(a,".setDirty();")});var A=l.compile();return{contextState:h,viewport:f,poll:A.poll,refresh:A.refresh,notifyViewportChanged:function(){h.viewport.setDirty();h["scissor.box"].setDirty()}}}},{"./util/codegen":22,"./util/stack":29}],18:[function(f,h,q){h.exports=function(){var d={"":0},a=[""];return{id:function(c){var e=d[c];if(e)return e;e=d[c]=a.length;a.push(c);return e},str:function(c){return a[c]}}}},
{}],19:[function(f,h,q){function d(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){if(!Array.isArray(a))return!1;var c=a.length;if(0===c||!Array.isArray(a[0]))return!1;for(var d=a[0].length,e=1;e<c;++e)if(!Array.isArray(a[e])||a[e].length!==d)return!1;return!0}function c(a){return Object.prototype.toString.call(a)}function e(a){return"[object HTMLCanvasElement]"===c(a)}function P(a){return"[object CanvasRenderingContext2D]"===c(a)}var g=f("./util/extend"),C=f("./util/values"),
l=f("./util/is-typed-array"),D=f("./util/is-ndarray"),H=f("./util/load-texture"),A=f("./util/to-half-float"),m=f("./util/parse-dds"),z=[9984,9986,9985,9987];h.exports=function(b,f,h,t,q){function ga(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=
this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function u(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function N(a,b){var c,d,e=0,g=0,l=0,f=0,h=0,k=0,m=!1,u=!1,n=!1;for(c=0;c<b.length;++c)d=b[c],f=f||d.width<<d.miplevel,h=h||d.height<<d.miplevel,e=e||d.type,g=g||d.format,l=l||d.internalformat,
k=k||d.channels,m=m||d.needsPoll,u=u||d.needsListeners,d=d.miplevel,n=n||0<d;a.needsPoll=m;a.needsListeners=u;a.width=f;a.height=h;a.format=g;a.internalformat=l;a.type=e;if(3553!==a.target)for(c=0;6>c;++c);c=0<=z.indexOf(a.minFilter);a.genMipmaps=!n&&(a.genMipmaps||c);n=n||a.genMipmaps;a.minFilter||(a.minFilter=n?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=k),d.format||(d.format=g),d.internalformat||(d.internalformat=l),d.type||(d.type=
e)}function U(a){this.id=n++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new u(a);this.pixels=[]}function la(a,b){function c(a,d){var e=d.mipmap,p;if(Array.isArray(e))for(var l=0;l<e.length;++l)p=new ga(a),p.parseFlags(b),p.parseFlags(d),p.parse(e[l],l),g.push(p);else p=new ga(a),p.parseFlags(b),p.parse(d,0),g.push(p)}var d;Z(a);var e=a.params;u.call(e,a.target);var g=a.pixels;g.length=0;e.parse(b);if(3553===a.target)c(3553,
b);else{var l=b.faces||b;if(Array.isArray(l))for(d=0;6>d;++d)c(34069+d,l[d]);else if("string"!==typeof l)for(d=0;6>d;++d)c(34069+d,{})}N(e,g);e.needsListeners&&ja(a);e.needsPoll&&(a.pollId=I.length,I.push(a));V(a)}function V(a){b.isTexture(a.texture)||(a.texture=b.createTexture());var c=a.target,d=a.unit;0<=d?(b.activeTexture(33984+d),F=d):b.bindTexture(c,a.texture);for(var c=a.pixels,e=a.params,g=0;g<c.length;++g)c[g].upload(e);e.upload();0>d&&((d=w[F])?b.bindTexture(d.target,d.texture):(a.unit=
F,w[F]=a))}function ja(a){function b(a,c,d){var p=m(d);p.pixels.forEach(function(b){var d=new ga(p.cube?b.target:a);d.channels=p.channels;d.compressed=p.compressed;d.type=p.type;d.internalformat=p.format;d.format=sa[p.format];d.width=b.width;d.height=b.height;d.miplevel=b.miplevel||c;d.data=b.data;e.push(d)})}function c(){for(var g=0;g<e.length;++g){var l=e[g],f=l.image,h=l.video,k=l.xhr;f&&f.complete?(l.width=f.naturalWidth,l.height=f.naturalHeight):h&&2<h.readyState?(l.width=h.width,l.height=h.height):
k&&4===k.readyState&&(e[g]=e[e.length-1],e.pop(),k.removeEventListener("readystatechange",V),b(l.target,l.miplevel,k.response))}N(d,e);V(a)}var d=a.params,e=a.pixels;e.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){e.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",
c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function Z(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((I[b]=I[I.length-1]).id=b,I.pop(),a.pollId=-1)}function L(a){var c=a.texture,d=a.unit,e=a.target;0<=d&&(b.activeTexture(33984+d),F=d,b.bindTexture(e,null),w[d]=null);Z(a);b.isTexture(c)&&b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete v[a.id]}var r={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
Q={repeat:10497,clamp:33071,mirror:33648},ma={nearest:9728,linear:9729},T=g({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ma),ea={none:0,browser:37444},W={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},X={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},da={};f.ext_srgb&&(X.srgb=35904,X.srgba=35906);f.oes_texture_float&&(W["float"]=5126);f.oes_texture_half_float&&
(W["half float"]=36193);f.webgl_depth_texture&&(g(X,{depth:6402,"depth stencil":34041}),g(W,{uint16:5123,uint32:5125,"depth stencil":34042}));f.webgl_compressed_texture_s3tc&&g(da,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});f.webgl_compressed_texture_atc&&g(da,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});f.webgl_compressed_texture_pvrtc&&g(da,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});f.webgl_compressed_texture_etc1&&(da["rgb etc1"]=36196);var ha=Array.prototype.slice.call(b.getParameter(34467));Object.keys(da).forEach(function(a){var b=da[a];0<=ha.indexOf(b)&&(X[a]=b)});var B=Object.keys(X);h.textureFormats=B;var sa=B.reduce(function(a,b){var c=X[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});g(ga.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=ea[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=X[b];b in W&&(this.type=W[b]);b in da&&(this.compressed=!0)}"type"in a&&(this.type=W[a.type]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=a.width),
"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(b,g){this.miplevel=g;this.width>>=g;this.height>>=g;var f=b;switch(typeof b){case "object":if(!b)return;
this.parseFlags(b);var h=b.data;if("string"===typeof h||h&&(l(h)||d(h)||D(h)||e(h)||P(h)||"[object HTMLImageElement]"===c(h)||"[object HTMLVideoElement]"===c(h)||a(h)))f=b.data;break;case "undefined":return}"string"===typeof f&&(f=H(f,this.crossOrigin));var h=null,k=!1;if(null!==f)if(l(f))this.data=f;else if(d(f))h=f,k=!0;else if(D(f)){Array.isArray(f.data)?(h=f.data,k=!0):this.data=f.data;var m=f.shape;this.width=m[0];this.height=m[1];this.channels=3===m.length?m[2]:1;m=f.stride;this.strideX=f.stride[0];
this.strideY=f.stride[1];this.strideC=3===m.length?f.stride[2]:1;this.offset=f.offset;this.needsTranspose=!0}else if(e(f)||P(f))e(f)?this.canvas=f:this.canvas=f.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===c(f))this.image=f,f.complete?(this.width=f.naturalWidth,this.height=f.naturalHeight):(this.width=this.width||f.naturalWidth,this.height=this.height||f.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===c(f))this.video=f,1<f.readyState?(this.width=f.width,this.height=f.height):(this.width=this.width||f.width,this.height=this.height||f.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===c(f))this.xhr=f,this.needsListeners=!0;else if(a(f)){var k=f[0].length,m=f.length,u=1,n,r,C,x;if(Array.isArray(f[0][0]))for(u=f[0][0].length,h=Array(k*m*u),r=x=0;r<m;++r)for(n=0;n<k;++n)for(C=0;C<u;++C)h[x++]=f[r][n][C];
else for(h=Array(k*m),r=x=0;r<m;++r)for(n=0;n<k;++n)h[x++]=f[r][n];this.width=k;this.height=m;this.channels=u;k=!0}else b.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||q.width)|0,this.height=(this.height||q.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,
6410,6407,6408][(this.channels=this.channels||4)-1]);f=this.internalformat;m=this.format=sa[f];if(!this.channels)switch(m){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}m=this.type;5126!==m&&36193!==m&&(m||(m=6402===f?5125:5121));this.type=m;if(k)switch(m){case 5121:this.data=new Uint8Array(h);break;case 5123:this.data=new Uint16Array(h);break;case 5125:this.data=new Uint32Array(h);break;case 5126:this.data=
new Float32Array(h);break;case 36193:this.data=A(h)}if(this.data&&this.needsTranspose){h=this.data;f=this.width;k=this.height;m=this.channels;u=this.strideX;n=this.strideY;r=this.strideC;C=this.offset;x=new h.constructor(f*k*m);for(var v=0,t=0;t<k;++t)for(var w=0;w<f;++w)for(var z=0;z<m;++z)x[v++]=h[n*t+u*w+r*z+C];this.data=x}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){b.pixelStorei(37440,
this.flipY);b.pixelStorei(37441,this.premultiplyAlpha);b.pixelStorei(37443,this.colorSpace);b.pixelStorei(3317,this.unpackAlignment);var c=this.target,d=this.miplevel,e=this.image,f=this.canvas,g=this.video,l=this.data,h=this.internalformat,k=this.format,m=this.type,n=this.width||Math.max(1,a.width>>d);a=this.height||Math.max(1,a.height>>d);g&&2<g.readyState?b.texImage2D(c,d,k,k,m,g):e&&e.complete?b.texImage2D(c,d,k,k,m,e):f?b.texImage2D(c,d,k,k,m,f):this.compressed?b.compressedTexImage2D(c,d,h,n,
a,0,l):this.copy?(t(),b.copyTexImage2D(c,d,k,this.x,this.y,n,a,0)):l?b.texImage2D(c,d,k,n,a,0,k,m,l):b.texImage2D(c,d,k,n||1,a||1,0,k,m,null)}});g(u.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=T[a.min]);"mag"in a&&(this.magFilter=ma[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=Q[d]:Array.isArray(d)&&(b=Q[d[0]],c=Q[d[1]])}else"wrapS"in a&&(b=Q[a.wrapS]),"wrapT"in a&&(c=Q[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=r[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;b.texParameteri(a,10241,this.minFilter);b.texParameteri(a,10240,this.magFilter);b.texParameteri(a,10242,this.wrapS);b.texParameteri(a,10243,this.wrapT);f.ext_texture_filter_anisotropic&&b.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(b.hint(33170,this.mipmapHint),b.generateMipmap(a))}});
var F=0,n=0,v={},I=[],fa=h.maxTextureUnits,w=Array(fa).map(function(){return null});g(U.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var c=0;c<fa;++c){var d=w[c];if(d){if(0<d.bindCount)continue;d.unit=-1}w[c]=this;a=c;break}this.unit=a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture);F=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&L(this)}});return{create:function(a,b){function c(a,e,f,g,l,h){var k=a||{};34067===
b&&6===arguments.length&&(k=[a,e,f,g,l,h]);la(d,k);c.width=d.params.width;c.height=d.params.height;return c}var d=new U(b);v[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){C(v).forEach(V);for(var a=0;a<fa;++a)w[a]=null;F=0;b.activeTexture(33984)},clear:function(){for(var a=0;a<fa;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),w[a]=null;b.activeTexture(33984);F=0;C(v).forEach(L)},poll:function(){I.forEach(V)},getTexture:function(a){return null}}}},
{"./util/extend":23,"./util/is-ndarray":24,"./util/is-typed-array":25,"./util/load-texture":26,"./util/parse-dds":27,"./util/to-half-float":30,"./util/values":31}],20:[function(f,h,q){h.exports=function(d){var a={};return{def:function(c){c=d.id(c);var e=a[c];e||(e=a[c]=[]);return e},uniforms:a}}},{}],21:[function(f,h,q){h.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(f,h,q){var d=f("./extend");h.exports=
function(){function a(){var a=[],e=[];return d(function(){a.push.apply(a,Array.prototype.slice.call(arguments))},{def:function(){var d="v"+c++;e.push(d);0<arguments.length&&(a.push(d,"="),a.push.apply(a,Array.prototype.slice.call(arguments)),a.push(";"));return d},toString:function(){return[0<e.length?"var "+e+";":"",a.join("")].join("")}})}var c=0,e=[],f=[],g={};return{link:function(a){var d="g"+c++;e.push(d);f.push(a);return d},block:a,proc:function(e){var f=[],h=a(),q=h.toString;return g[e]=d(h,
{arg:function(){var a="a"+c++;f.push(a);return a},toString:function(){return["function(",f.join(),"){",q(),"}"].join("")}})},compile:function(){var a=['"use strict";return {'];Object.keys(g).forEach(function(c){a.push('"',c,'":',g[c].toString(),",")});a.push("}");return Function.apply(null,e.concat([a.join("")])).apply(null,f)}}}},{"./extend":23}],23:[function(f,h,q){h.exports=function(d,a){for(var c=Object.keys(a),e=0;e<c.length;++e)d[c[e]]=a[c[e]];return d}},{}],24:[function(f,h,q){var d=f("./is-typed-array");
h.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||d(a.data))}},{"./is-typed-array":25}],25:[function(f,h,q){var d=f("../constants/arraytypes.json");h.exports=function(a){return Object.prototype.toString.call(a)in d}},{"../constants/arraytypes.json":5}],26:[function(f,h,q){h.exports=function(d,a){if("undefined"!==typeof document){var c;c=(c=/\.(\w+)(\?.*)?$/.exec(d))&&
c[1]?c[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(c))return c=document.createElement("video"),c.autoplay=!0,c.loop=!0,a&&(c.crossOrigin=a),c.src=d,c;if(0<=["dds"].indexOf(c))return c=new XMLHttpRequest,c.responseType="arraybuffer",c.open("GET",d,!0),c.send(),c;c=new Image;a&&(c.crossOrigin=a);c.src=d;return c}return null}},{}],27:[function(f,h,q){h.exports=function(f){function h(a){for(var b=r,c=Q,d=0;d<X;++d){var e=Math.max(1,
b+3>>2)*Math.max(1,c+3>>2)*ea;ha.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(f,da,e)});da+=e;b>>=1;c>>=1}}var q=new Int32Array(f),L=q[t],r=q[ga],Q=q[G],ma=l,T=0,ea=0,W=4;switch(q[U]){case m:ea=8;L&A?(W=3,T=c):T=e;break;case z:ea=16;T=P;break;case b:ea=16;T=g;break;case k:ea=8,T=C}var X=1;q[N]&D&&(X=Math.max(1,q[u]));var da=q[E]+4,ha={width:r,height:Q,channels:W,format:T,type:ma,compressed:!0,cube:!1,pixels:[]};if(q[la]&H)for(ha.cube=!0,q=0;6>q;++q)h(a+q);else h(d);return ha};
var d=3553,a=34069,c=33776,e=33777,P=33778,g=33779,C=36196,l=5121,D=131072,H=512,A=64,m=827611204,z=861165636,b=894720068,k=826496069,E=1,t=2,G=3,ga=4,u=7,N=20,U=21,la=28},{}],28:[function(f,h,q){h.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(d){return requestAnimationFrame(d)},cancel:function(d){return cancelAnimationFrame(d)}}:{next:function(d){setTimeout(d,30)},cancel:clearTimeout}},{}],29:[function(f,h,q){h.exports=function(d,a){var c=
d.length,e=d.slice(),f=d.slice(),g=!1,h=!0;return{push:function(){g=!1;for(var a=0;a<c;++a){var d=arguments[a];g=g||d!==f[a];e.push(d)}},pop:function(){g=!1;e.length-=c;for(var a=0;a<c;++a)g=g||e[e.length-c+a]!==f[a]},poll:function(){var d=e.length-c;if(g||h){switch(c){case 1:a(e[d]);break;case 2:a(e[d],e[d+1]);break;case 3:a(e[d],e[d+1],e[d+2]);break;case 4:a(e[d],e[d+1],e[d+2],e[d+3]);break;case 5:a(e[d],e[d+1],e[d+2],e[d+3],e[d+4]);break;case 6:a(e[d],e[d+1],e[d+2],e[d+3],e[d+4],e[d+5]);break;
default:a.apply(null,e.slice(d,e.length))}for(var q=0;q<c;++q)f[q]=e[d+q];h=g=!1}},setDirty:function(){h=!0}}}},{}],30:[function(f,h,q){h.exports=function(d){for(var a=new Float32Array(d),a=new Uint32Array(a.buffer),c=new Uint16Array(d.length),e=0;e<d.length;++e)if(isNaN(d[e]))c[e]=65535;else if(Infinity===d[e])c[e]=31744;else if(-Infinity===d[e])c[e]=64512;else{var f=a[e],g=f>>>31<<15,h=(f<<1>>>24)-127,f=f>>13&1023;c[e]=-24>h?g:-14>h?g+(f+1024>>-14-h):15<h?g+31744:g+(h+15<<10)+f}return c}},{}],31:[function(f,
h,q){h.exports=function(d){return Object.keys(d).map(function(a){return d[a]})}},{}],32:[function(f,h,q){function d(d,f){function g(){var a=window.innerWidth,f=window.innerHeight;d!==document.body&&(f=d.getBoundingClientRect(),a=f.right-f.left,f=f.top-f.bottom);h.width=q*a;h.height=q*f;c(h.style,{width:a+"px",height:f+"px"})}var h=document.createElement("canvas"),l=a(h,f);c(h.style,{border:0,margin:0,padding:0,top:0,left:0});d.appendChild(h);d===document.body&&(h.style.position="absolute",c(d.style,
{margin:0,padding:0}));var q=+l.options.pixelRatio;window.addEventListener("resize",g,!1);var H=l.options.onDestroy;l.options=c(c({},l.options),{onDestroy:function(){window.removeEventListener("resize",g);d.removeChild(h);H&&H()}});g();return l}function a(a,d){function f(c){try{return a.getContext(c,h)}catch(d){return null}}var h=d.glOptions||{};return{gl:f("webgl")||f("experimental-webgl")||f("webgl-experimental"),options:c({pixelRatio:window.devicePixelRatio},d)}}var c=f("./util/extend");h.exports=
function(e){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:e[0],options:e[1]||{}};var f=document.body,g=e[1]||{};if("string"===typeof e[0])f=document.querySelector(e[0])||document.body;else if("object"===typeof e[0])if(e[0]instanceof HTMLElement)f=e[0];else{if(e[0]instanceof WebGLRenderingContext)return{gl:e[0],options:c({pixelRatio:1},g)};g=e[0]}return f.nodeName&&"CANVAS"===f.nodeName.toUpperCase()?a(f,g):d(f,g)}},{"./util/extend":23}],33:[function(f,h,q){h.exports=
function(a,c){function e(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==t.alt,t.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==t.shift,t.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==t.control,t.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==t.meta,t.meta=!!a.metaKey);return b}function f(a,g){var h=d.x(g),l=d.y(g);"buttons"in g&&(a=g.buttons|0);if(a!==b||h!==k||l!==E||e(g))b=a|0,k=h||0,E=l||0,c&&c(b,k,E,t)}function g(a){f(0,a)}function h(){if(b||k||E||t.shift||t.alt||t.meta||t.control)b=
k=E=0,t.shift=t.alt=t.control=t.meta=!1,c&&c(0,0,0,t)}function l(a){e(a)&&c&&c(b,k,E,t)}function q(a){0===d.buttons(a)?f(0,a):f(b,a)}function H(a){f(b|d.buttons(a),a)}function A(a){f(b&~d.buttons(a),a)}function m(){G||(G=!0,a.addEventListener("mousemove",q),a.addEventListener("mousedown",H),a.addEventListener("mouseup",A),a.addEventListener("mouseleave",g),a.addEventListener("mouseenter",g),a.addEventListener("mouseout",g),a.addEventListener("mouseover",g),a.addEventListener("blur",h),a.addEventListener("keyup",
l),a.addEventListener("keydown",l),a.addEventListener("keypress",l),a!==window&&(window.addEventListener("blur",h),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}function z(){G&&(G=!1,a.removeEventListener("mousemove",q),a.removeEventListener("mousedown",H),a.removeEventListener("mouseup",A),a.removeEventListener("mouseleave",g),a.removeEventListener("mouseenter",g),a.removeEventListener("mouseout",g),a.removeEventListener("mouseover",
g),a.removeEventListener("blur",h),a.removeEventListener("keyup",l),a.removeEventListener("keydown",l),a.removeEventListener("keypress",l),a!==window&&(window.removeEventListener("blur",h),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))}c||(c=a,a=window);var b=0,k=0,E=0,t={shift:!1,alt:!1,control:!1,meta:!1},G=!1;m();var ga={element:a};Object.defineProperties(ga,{enabled:{get:function(){return G},set:function(a){a?m():z},enumerable:!0},
buttons:{get:function(){return b},enumerable:!0},x:{get:function(){return k},enumerable:!0},y:{get:function(){return E},enumerable:!0},mods:{get:function(){return t},enumerable:!0}});return ga};var d=f("mouse-event")},{"mouse-event":34}],34:[function(f,h,q){function d(a){return a.target||a.srcElement||window}q.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;
if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};q.element=d;q.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var c=d(a).getBoundingClientRect();return a.clientX-c.left}return 0};q.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var c=d(a).getBoundingClientRect();return a.clientY-c.top}return 0}},{}],35:[function(f,h,q){var d=f("./lib/util/extend"),a=f("./lib/webgl"),c=f("./lib/strings"),e=f("./lib/extension"),P=f("./lib/limits"),
g=f("./lib/buffer"),C=f("./lib/elements"),l=f("./lib/texture"),D=f("./lib/renderbuffer"),H=f("./lib/framebuffer"),A=f("./lib/uniform"),m=f("./lib/attribute"),z=f("./lib/shader"),b=f("./lib/draw"),k=f("./lib/state"),E=f("./lib/compile"),t=f("./lib/read"),G=f("./lib/dynamic"),ga=f("./lib/util/raf"),u=f("./lib/util/clock");h.exports=function(){function f(){aa=ga.next(f);w.count+=1;p.count=w.count;if(w.width!==r.drawingBufferWidth||w.height!==r.drawingBufferHeight)p.viewportWidth=p.drawingBufferWidth=
w.width=r.drawingBufferWidth,p.viewportHeight=p.drawingBufferHeight=w.height=r.drawingBufferHeight,R.notifyViewportChanged();var a=u();w.dt=a-w.t;w.t=a;p.deltaTime=w.dt/1E3;p.time=(a-fa)/1E3;n.poll();for(var b=0;b<Y.length;++b)(0,Y[b])(null,p);w.renderTime=u()-a}function h(){aa&&(ga.cancel(f),aa=0)}function q(a){h();a.preventDefault();if(Q.onContextLost)Q.onContextLost()}function V(a){r.getError();ma.refresh();X.refresh();n.refresh();v.refresh();I.refresh();sa.refresh();R.refresh();if(Q.onContextRestored)Q.onContextRestored();
f()}function ja(a){function b(a){var c={},d={};Object.keys(a).forEach(function(b){var f=a[b];G.isDynamic(f)?(e=!0,d[b]=G.unbox(f,b)):c[b]=f});return{dynamic:d,"static":c}}function c(a){for(;n.length<a;)n.push(null);return n}var e=!1,f=b(a.context||{}),g=b(a.uniforms||{}),h=b(a.attributes||{});a=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=d({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");
b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));var f=na.command(a["static"],g["static"],h["static"],a.dynamic,g.dynamic,h.dynamic,f,e),k=f.draw,l=f.batch,m=f.scope,n=[];return function(a,b){return"function"===typeof a?m.call(this,null,a):"function"===typeof b?m.call(this,a,b):"number"===typeof a?l.call(this,a|0,c(a|0)):Array.isArray(a)?l.call(this,a.length,a):k.call(this,a)}}function Z(){I.poll();R.poll()}var L=a(Array.prototype.slice.call(arguments)),r=L.gl,Q=L.options,
L=c(),ma=e(r),T=ma.extensions,ea={width:r.drawingBufferWidth,height:r.drawingBufferHeight},W=P(r,T),X=g(r,function(a){for(var b=0;b<B.bindings.length;++b){var c=B.bindings[b];c.pointer&&c.buffer===a&&(c.pointer=!1,c.buffer=null,c.x=c.y=c.z=c.w=NaN,r.disableVertexAttribArray(b))}}),da=C(r,T,X),ha=A(L),B=m(r,T,W,X,L),sa=z(r,B,ha,function(a){return na.draw(a)},L),F=b(r,T,X),n=l(r,T,W,Z,ea),v=D(r,T,W),I=H(r,T,W,n,v),fa=u(),w={count:0,start:fa,dt:0,t:fa,renderTime:0,width:r.drawingBufferWidth,height:r.drawingBufferHeight,
pixelRatio:Q.pixelRatio},p={count:0,batchId:0,deltaTime:0,time:0,viewportWidth:w.width,viewportHeight:w.height,drawingBufferWidth:w.width,drawingBufferHeight:w.height,pixelRatio:w.pixelRatio},R=k(r,I,ea),ea=t(r,Z,ea),na=E(r,L,T,W,X,da,n,I,R,ha,B,sa,F,p,Z),M=r.canvas,Y=[],aa=0;M&&(M.addEventListener("webglcontextlost",q,!1),M.addEventListener("webglcontextrestored",V,!1));return d(ja,{clear:function(a){var b=0;Z();var c=a.color;c&&(r.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in
a&&(r.clearDepth(+a.depth),b|=256);"stencil"in a&&(r.clearStencil(a.stencil|0),b|=1024);r.clear(b)},prop:G.define.bind(null,1),context:G.define.bind(null,2),"this":G.define.bind(null,3),draw:ja({}),elements:function(a){return da.create(a)},buffer:function(a){return X.create(a,34962)},texture:function(a){return n.create(a,3553)},cube:function(a){return 6===arguments.length?n.create(Array.prototype.slice.call(arguments),34067):n.create(a,34067)},renderbuffer:function(a){return v.create(a)},framebuffer:function(a){return I.create(a)},
framebufferCube:function(a){},frame:function(a){Y.push(a);!aa&&0<Y.length&&f();return{cancel:function(){var b=Y.find(function(b){return b===a});0>b||(Y.splice(b,1),0>=Y.length&&h())}}},stats:w,limits:W,read:ea,destroy:function(){h();M&&(M.removeEventListener("webglcontextlost",q),M.removeEventListener("webglcontextrestored",V));sa.clear();I.clear();v.clear();n.clear();X.clear();if(Q.onDestroy)Q.onDestroy()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/compile":4,"./lib/draw":8,"./lib/dynamic":9,
"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/state":17,"./lib/strings":18,"./lib/texture":19,"./lib/uniform":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":28,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>