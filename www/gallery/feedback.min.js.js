(function e$$0(q,x,k){function a(f,e){if(!x[f]){if(!q[f]){var c="function"==typeof require&&require;if(!e&&c)return c(f,!0);if(r)return r(f,!0);c=Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}c=x[f]={exports:{}};q[f][0].call(c.exports,function(e){var c=q[f][1][e];return a(c?c:e)},c,c.exports,e$$0,q,x,k)}return x[f].exports}for(var r="function"==typeof require&&require,z=0;z<k.length;z++)a(k[z]);return a})({1:[function(h,q,x){var k=h("../regl")(),a=h("mouse-change")(),r=k.texture(),
z=k({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:r,mouse:function(f){var e=f.pixelRatio;return[a.x*e,f.viewportHeight-a.y*e]},t:function(a){return.01*a.tick}},count:3});k.frame(function(){k.clear({color:[0,0,0,1]});z();r({copy:!0})})},{"../regl":35,"mouse-change":33}],2:[function(h,q,x){function k(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}q.exports=function(a,r,z,f,e){a=z.maxAttributes;r=
Array(a);for(z=0;z<a;++z)r[z]=new k;return{Record:k,scope:{},state:r}}},{}],3:[function(h,q,x){function k(a){return A[Object.prototype.toString.call(a)]|0}function a(a,f){for(var e=0;e<f.length;++e)a[e]=f[e]}function r(a,e,f,c,p,k,r){for(var m=0,b=0;b<f;++b)for(var u=0;u<c;++u)a[m++]=e[p*b+k*u+r]}function z(a,e,f){for(var c=0,p=0;p<e.length;++p)for(var k=e[p],r=0;r<f;++r)a[c++]=k[r]}var f=h("./util/is-typed-array"),e=h("./util/is-ndarray"),c=h("./util/values"),u=h("./util/pool"),A=h("./constants/arraytypes.json"),
G=h("./constants/dtypes.json"),C=h("./constants/usage.json"),t=[];t[5120]=1;t[5122]=2;t[5124]=4;t[5121]=1;t[5123]=2;t[5125]=4;t[5126]=4;q.exports=function(h,v,B){function g(a){this.id=m++;this.buffer=h.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;B.profile&&(this.stats={size:0})}function p(a,b,e){a.byteLength=b.byteLength;h.bufferData(a.type,b,e)}function q(b,c,m,g,h){b.usage=m;if(Array.isArray(c))b.dtype=g||5126,0<c.length&&(Array.isArray(c[0])?(b.dimension=
c[0].length,g=u.allocType(b.dtype,c.length*b.dimension),z(g,c,b.dimension),p(b,g,m),u.freeType(g)):"number"===typeof c[0]?(b.dimension=h,g=u.allocType(b.dtype,c.length),a(g,c),p(b,g,m),u.freeType(g)):f(c[0])&&(b.dimension=c[0].length,b.dtype=g||k(c[0])||5126,g=u.allocType(b.dtype,c.length*b.dimension),z(g,c,b.dimension),p(b,g,m),u.freeType(g)));else if(f(c))b.dtype=g||k(c),b.dimension=h,p(b,c,m);else if(e(c)){var t=c.shape,B=c.stride;h=c.offset;var H=0,v=0,K=0,D=0;1===t.length?(H=t[0],v=1,K=B[0],
D=0):2===t.length&&(H=t[0],v=t[1],K=B[0],D=B[1]);b.dtype=g||k(c.data)||5126;b.dimension=v;g=u.allocType(b.dtype,H*v);r(g,c.data,H,v,K,D,h);p(b,g,m);u.freeType(g)}}function I(a){v.bufferCount--;h.deleteBuffer(a.buffer);a.buffer=null;delete b[a.id]}var m=0,b={};g.prototype.bind=function(){h.bindBuffer(this.type,this.buffer)};g.prototype.destroy=function(){I(this)};var V=[];B.profile&&(v.getTotalBufferSize=function(){var a=0;Object.keys(b).forEach(function(e){a+=b[e].stats.size});return a});return{create:function(c,
m,p){function V(a){var b=35044,c=null,m=0,g=0,p=1;Array.isArray(a)||f(a)||e(a)?c=a:"number"===typeof a?m=a|0:a&&("data"in a&&(c=a.data),"usage"in a&&(b=C[a.usage]),"type"in a&&(g=G[a.type]),"dimension"in a&&(p=a.dimension|0),"length"in a&&(m=a.length|0));A.bind();c?q(A,c,b,g,p):(h.bufferData(A.type,m,b),A.dtype=g||5121,A.usage=b,A.dimension=p,A.byteLength=m);B.profile&&(A.stats.size=A.byteLength*t[A.dtype]);return V}v.bufferCount++;var A=new g(m);b[A.id]=A;p||V(c);V._reglType="buffer";V._buffer=A;
V.subdata=function(b,c){var m=(c||0)|0;A.bind();if(Array.isArray(b)){if(0<b.length)if("number"===typeof b[0]){var g=u.allocType(A.dtype,b.length);a(g,b);h.bufferSubData(A.type,m,g);u.freeType(g)}else if(Array.isArray(b[0])||f(b[0])){var g=b[0].length,p=u.allocType(A.dtype,b.length*g);z(p,b,g);h.bufferSubData(A.type,m,p);u.freeType(p)}}else if(f(b))h.bufferSubData(A.type,m,b);else if(e(b)){var D=b.shape,t=b.stride,B=p=g=0,v=0;1===D.length?(g=D[0],p=1,B=t[0],v=0):2===D.length&&(g=D[0],p=D[1],B=t[0],
v=t[1]);D=Array.isArray(b.data)?A.dtype:k(b.data);D=u.allocType(D,g*p);r(D,b.data,g,p,B,v,b.offset);h.bufferSubData(A.type,m,D);u.freeType(D)}return V};B.profile&&(V.stats=A.stats);V.destroy=function(){I(A)};return V},createStream:function(b,a){var e=V.pop();e||(e=new g(b));e.bind();q(e,a,35040,0,1);return e},destroyStream:function(b){V.push(b)},clear:function(){c(b).forEach(I);V.forEach(I)},getBuffer:function(b){return b&&b._buffer instanceof g?b._buffer:null},_initBuffer:q}}},{"./constants/arraytypes.json":4,
"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(h,q,x){q.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(h,q,x){q.exports={int8:5120,
int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(h,q,x){q.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(h,q,x){q.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(h,q,x){function k(a){return Array.isArray(a)||A(a)||G(a)}function a(a){return a.sort(function(b,a){return"viewport"===b?-1:"viewport"===a?1:b<a?-1:1})}function r(a,b,
e,c){this.thisDep=a;this.contextDep=b;this.propDep=e;this.append=c}function z(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function f(a){return new r(!1,!1,!1,a)}function e(a,b){var e=a.type;return 0===e?(e=a.data.length,new r(!0,1<=e,2<=e,b)):new r(3===e,2===e,1===e,b)}var c=h("./util/codegen"),u=h("./util/loop"),A=h("./util/is-typed-array"),G=h("./util/is-ndarray"),C=h("./util/is-array-like"),t=h("./constants/primitives.json"),K=h("./constants/dtypes.json"),v=["x","y","z","w"],B={0:0,1:1,
zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},g={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},p={0:0,zero:0,
keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},L={cw:2304,ccw:2305},I=new r(!1,!1,!1,function(){});q.exports=function(m,b,h,q,A,G,x,pa,da,J,H,T,ga,D,W){function Y(d){return d.replace(".","_")}function P(d,y,a){var b=Y(d);F.push(d);l[b]=Z[b]=!!a;w[b]=y}function M(d,a,b){var e=Y(d);F.push(d);Array.isArray(b)?(Z[e]=b.slice(),l[e]=b.slice()):Z[e]=l[e]=b;qa[e]=a}function N(){var d=c(),a=d.link,l=d.global;d.id=La++;d.batchId="0";var e=a(Ja),
O=d.shared={props:"a0"};Object.keys(Ja).forEach(function(n){O[n]=l.def(e,".",n)});var Ca=d.next={},f=d.current={};Object.keys(qa).forEach(function(n){Array.isArray(Z[n])&&(Ca[n]=l.def(O.next,".",n),f[n]=l.def(O.current,".",n))});var n=d.constants={};Object.keys(Da).forEach(function(d){n[d]=l.def(JSON.stringify(Da[d]))});d.invoke=function(n,b){switch(b.type){case 0:var l=["this",O.context,O.props,d.batchId];return n.def(a(b.data),".call(",l.slice(0,Math.max(b.data.length+1,4)),")");case 1:return n.def(O.props,
b.data);case 2:return n.def(O.context,b.data);case 3:return n.def("this",b.data)}};d.attribCache={};var Aa={};d.scopeAttrib=function(n){n=b.id(n);if(n in Aa)return Aa[n];var d=J.scope[n];d||(d=J.scope[n]=new la);return Aa[n]=a(d)};return d}function Q(d){var a=d["static"];d=d.dynamic;var b;if("profile"in a){var l=!!a.profile;b=f(function(d,a){return l});b.enable=l}else if("profile"in d){var O=d.profile;b=e(O,function(d,a){return d.invoke(a,O)})}return b}function ha(d){var a=d["static"];d=d.dynamic;
if("framebuffer"in a){var b=a.framebuffer;return b?(b=pa.getFramebuffer(b),f(function(d,a){var y=d.link(b),n=d.shared;a.set(n.framebuffer,".next",y);n=n.context;a.set(n,".framebufferWidth",y+".width");a.set(n,".framebufferHeight",y+".height");return y})):f(function(d,a){var b=d.shared;a.set(b.framebuffer,".next","null");b=b.context;a.set(b,".framebufferWidth",b+".drawingBufferWidth");a.set(b,".framebufferHeight",b+".drawingBufferHeight");return"null"})}if("framebuffer"in d){var l=d.framebuffer;return e(l,
function(d,a){var b=d.invoke(a,l),n=d.shared,y=n.framebuffer,b=a.def(y,".getFramebuffer(",b,")");a.set(y,".next",b);n=n.context;a.set(n,".framebufferWidth",b+"?"+b+".width:"+n+".drawingBufferWidth");a.set(n,".framebufferHeight",b+"?"+b+".height:"+n+".drawingBufferHeight");return b})}return null}function ra(d,a){function b(n){if(n in l){var d=l[n];n=!0;var Ka=d.x|0,f=d.y|0,X,g;"width"in d?X=d.width|0:n=!1;"height"in d?g=d.height|0:n=!1;return new r(!n&&a&&a.thisDep,!n&&a&&a.contextDep,!n&&a&&a.propDep,
function(n,a){var b=n.shared.context,l=X;"width"in d||(l=a.def(b,".","framebufferWidth","-",Ka));var y=g;"height"in d||(y=a.def(b,".","framebufferHeight","-",f));return[Ka,f,l,y]})}if(n in c){var Ca=c[n];n=e(Ca,function(n,d){var a=n.invoke(d,Ca),b=n.shared.context,l=d.def(a,".x|0"),y=d.def(a,".y|0"),Aa=d.def('"width" in ',a,"?",a,".width|0:","(",b,".","framebufferWidth","-",l,")"),a=d.def('"height" in ',a,"?",a,".height|0:","(",b,".","framebufferHeight","-",y,")");return[l,y,Aa,a]});a&&(n.thisDep=
n.thisDep||a.thisDep,n.contextDep=n.contextDep||a.contextDep,n.propDep=n.propDep||a.propDep);return n}return a?new r(a.thisDep,a.contextDep,a.propDep,function(n,d){var a=n.shared.context;return[0,0,d.def(a,".","framebufferWidth"),d.def(a,".","framebufferHeight")]}):null}var l=d["static"],c=d.dynamic,f=b("viewport");if(f)var g=f,f=new r(f.thisDep,f.contextDep,f.propDep,function(n,d){var a=g.append(n,d),b=n.shared.context;d.set(b,".viewportWidth",a[2]);d.set(b,".viewportHeight",a[3]);return a});return{viewport:f,
scissor_box:b("scissor.box")}}function wa(d){function a(n){if(n in l){var d=b.id(l[n]);n=f(function(){return d});n.id=d;return n}if(n in c){var y=c[n];return e(y,function(d,n){var a=d.invoke(n,y);return n.def(d.shared.strings,".id(",a,")")})}return null}var l=d["static"],c=d.dynamic,O=a("frag"),g=a("vert"),p=null;z(O)&&z(g)?(p=H.program(g.id,O.id),d=f(function(d,a){return d.link(p)})):d=new r(O&&O.thisDep||g&&g.thisDep,O&&O.contextDep||g&&g.contextDep,O&&O.propDep||g&&g.propDep,function(d,a){var b=
d.shared.shader,l;l=O?O.append(d,a):a.def(b,".","frag");var y;y=g?g.append(d,a):a.def(b,".","vert");return a.def(b+".program("+y+","+l+")")});return{frag:O,vert:g,progVar:d,program:p}}function ia(d){function a(d,n){if(d in b){var y=b[d]|0;return f(function(d,a){n&&(d.OFFSET=y);return y})}if(d in l){var g=l[d];return e(g,function(d,a){var b=d.invoke(a,g);n&&(d.OFFSET=b);return b})}return n&&c?f(function(d,a){d.OFFSET="0";return 0}):null}var b=d["static"],l=d.dynamic,c=function(){if("elements"in b){var d=
b.elements;k(d)?d=G.getElements(G.create(d)):d&&(d=G.getElements(d));var a=f(function(a,n){if(d){var b=a.link(d);return a.ELEMENTS=b}return a.ELEMENTS=null});a.value=d;return a}if("elements"in l){var y=l.elements;return e(y,function(d,a){var n=d.shared,b=n.isBufferArgs,n=n.elements,l=d.invoke(a,y),e=a.def("null"),b=a.def(b,"(",l,")"),l=d.cond(b).then(e,"=",n,".createStream(",l,");")["else"](e,"=",n,".getElements(",l,");");a.entry(l);a.exit(d.cond(b).then(n,".destroyStream(",e,");"));return d.ELEMENTS=
e})}return null}(),g=a("offset",!0);return{elements:c,primitive:function(){if("primitive"in b){var d=b.primitive;return f(function(a,n){return t[d]})}if("primitive"in l){var a=l.primitive;return e(a,function(d,b){var l=d.constants.primTypes,y=d.invoke(b,a);return b.def(l,"[",y,"]")})}return c?z(c)?c.value?f(function(d,a){return a.def(d.ELEMENTS,".primType")}):f(function(){return 4}):new r(c.thisDep,c.contextDep,c.propDep,function(d,a){var n=d.ELEMENTS;return a.def(n,"?",n,".primType:",4)}):null}(),
count:function(){if("count"in b){var d=b.count|0;return f(function(){return d})}if("count"in l){var a=l.count;return e(a,function(d,b){return d.invoke(b,a)})}return c?z(c)?c?g?new r(g.thisDep,g.contextDep,g.propDep,function(d,a){return a.def(d.ELEMENTS,".vertCount-",d.OFFSET)}):f(function(d,a){return a.def(d.ELEMENTS,".vertCount")}):f(function(){return-1}):new r(c.thisDep||g.thisDep,c.contextDep||g.contextDep,c.propDep||g.propDep,function(d,a){var n=d.ELEMENTS;return d.OFFSET?a.def(n,"?",n,".vertCount-",
d.OFFSET,":-1"):a.def(n,"?",n,".vertCount:-1")}):null}(),instances:a("instances",!1),offset:g}}function sa(d){var a=d["static"],b=d.dynamic,l={};F.forEach(function(d){function c(n,g){if(d in a){var p=n(a[d]);l[w]=f(function(){return p})}else if(d in b){var m=b[d];l[w]=e(m,function(d,a){return g(d,a,d.invoke(a,m))})}}var w=Y(d);switch(d){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return c(function(d){return d},
function(d,a,b){return b});case "depth.func":return c(function(d){return g[d]},function(d,a,b){return a.def(d.constants.compareFuncs,"[",b,"]")});case "depth.range":return c(function(d){return d},function(d,a,b){d=a.def("+",b,"[0]");a=a.def("+",b,"[1]");return[d,a]});case "blend.func":return c(function(d){return[B["srcRGB"in d?d.srcRGB:d.src],B["dstRGB"in d?d.dstRGB:d.dst],B["srcAlpha"in d?d.srcAlpha:d.src],B["dstAlpha"in d?d.dstAlpha:d.dst]]},function(d,a,b){function l(d,n){var c=a.def('"',d,n,'" in ',
b,"?",b,".",d,n,":",b,".",d);return a.def(y,"[",c,"]")}var y=d.constants.blendFuncs;d=l("src","RGB");var c=l("src","Alpha"),e=l("dst","RGB"),g=l("dst","Alpha");return[d,e,c,g]});case "blend.equation":return c(function(d){if("string"===typeof d)return[ma[d],ma[d]];if("object"===typeof d)return[ma[d.rgb],ma[d.alpha]]},function(d,a,b){var l=d.constants.blendEquations,y=a.def(),c=a.def();d=d.cond("typeof ",b,'==="string"');d.then(y,"=",c,"=",l,"[",b,"];");d["else"](y,"=",l,"[",b,".rgb];",c,"=",l,"[",
b,".alpha];");a(d);return[y,c]});case "blend.color":return c(function(d){return u(4,function(a){return+d[a]})},function(d,a,b){return u(4,function(d){return a.def("+",b,"[",d,"]")})});case "stencil.mask":return c(function(d){return d|0},function(d,a,b){return a.def(b,"|0")});case "stencil.func":return c(function(d){return[g[d.cmp||"keep"],d.ref||0,"mask"in d?d.mask:-1]},function(d,a,b){d=a.def('"cmp" in ',b,"?",d.constants.compareFuncs,"[",b,".cmp]",":",7680);var l=a.def(b,".ref|0");a=a.def('"mask" in ',
b,"?",b,".mask|0:-1");return[d,l,a]});case "stencil.opFront":case "stencil.opBack":return c(function(a){return["stencil.opBack"===d?1029:1028,p[a.fail||"keep"],p[a.zfail||"keep"],p[a.pass||"keep"]]},function(a,b,l){function y(d){return b.def('"',d,'" in ',l,"?",c,"[",l,".",d,"]:",7680)}var c=a.constants.stencilOps;return["stencil.opBack"===d?1029:1028,y("fail"),y("zfail"),y("pass")]});case "polygonOffset.offset":return c(function(d){return[d.factor|0,d.units|0]},function(d,a,b){d=a.def(b,".factor|0");
a=a.def(b,".units|0");return[d,a]});case "cull.face":return c(function(d){var a=0;"front"===d?a=1028:"back"===d&&(a=1029);return a},function(d,a,b){return a.def(b,'==="front"?',1028,":",1029)});case "lineWidth":return c(function(d){return d},function(d,a,b){return b});case "frontFace":return c(function(d){return L[d]},function(d,a,b){return a.def(b+'==="cw"?2304:2305')});case "colorMask":return c(function(d){return d.map(function(d){return!!d})},function(d,a,b){return u(4,function(d){return"!!"+b+
"["+d+"]"})});case "sample.coverage":return c(function(d){return["value"in d?d.value:1,!!d.invert]},function(d,a,b){d=a.def('"value" in ',b,"?+",b,".value:1");a=a.def("!!",b,".invert");return[d,a]})}});return l}function ja(d){var a=d["static"],b=d.dynamic,l={};Object.keys(a).forEach(function(d){var b=a[d],c;"number"===typeof b||"boolean"===typeof b?c=f(function(){return b}):"function"!==typeof b||"texture2d"!==b._reglType&&"textureCube"!==b._reglType?C(b)&&(c=f(function(d){return d.global.def("[",
u(b.length,function(d){return b[d]}),"]")})):c=f(function(d){return d.link(b)});c.value=b;l[d]=c});Object.keys(b).forEach(function(d){var a=b[d];l[d]=e(a,function(d,b){return d.invoke(b,a)})});return l}function ba(d){var a=d["static"],l=d.dynamic,c={};Object.keys(a).forEach(function(d){var l=a[d],e=b.id(d),n=new la;if(k(l))n.state=1,n.buffer=A.getBuffer(A.create(l,34962,!1)),n.type=n.buffer.dtype;else{var g=A.getBuffer(l);if(g)n.state=1,n.buffer=g,n.type=g.dtype;else if(l.constant){var X=l.constant;
n.state=2;"number"===typeof X?n.x=X:v.forEach(function(d,a){a<X.length&&(n[d]=X[a])})}else{var g=A.getBuffer(l.buffer),p=l.offset|0,w=l.stride|0,m=l.size|0,F=!!l.normalized,D=0;"type"in l&&(D=K[l.type]);l=l.divisor|0;n.buffer=g;n.state=1;n.size=m;n.normalized=F;n.type=D||g.dtype;n.offset=p;n.stride=w;n.divisor=l}}c[d]=f(function(d,a){var b=d.attribCache;if(e in b)return b[e];var l={isStream:!1};Object.keys(n).forEach(function(d){l[d]=n[d]});n.buffer&&(l.buffer=d.link(n.buffer));return b[e]=l})});
Object.keys(l).forEach(function(d){var a=l[d];c[d]=e(a,function(d,b){function l(d){b(f[d],"=",y,".",d,"|0;")}var y=d.invoke(b,a),c=d.shared,e=c.isBufferArgs,g=c.buffer,f={isStream:b.def(!1)},X=new la;X.state=1;Object.keys(X).forEach(function(d){f[d]=b.def(""+X[d])});var p=f.buffer,w=f.type;b("if(",e,"(",y,")){",f.isStream,"=true;",p,"=",g,".createStream(",34962,",",y,");",w,"=",p,".dtype;","}else{",p,"=",g,".getBuffer(",y,");","if(",p,"){",w,"=",p,".dtype;","}else if(",y,".constant){",f.state,"=",
2,";",v.map(function(d,a){return f[d]+"="+y+".length>="+a+"?"+y+"["+a+"]:0;"}).join(""),"}else{",p,"=",g,".getBuffer(",y,".buffer);",w,'="type" in ',y,"?",c.glTypes,"[",y,".type]:",p,".dtype;",f.normalized,"=!!",y,".normalized;");l("size");l("offset");l("stride");l("divisor");b("}}");b.exit("if(",f.isStream,"){",g,".destroyStream(",p,");","}");return f})});return c}function ta(d){var a=d["static"],b=d.dynamic,l={};Object.keys(a).forEach(function(d){var b=a[d];l[d]=f(function(d,a){return"number"===
typeof b||"boolean"===typeof b?""+b:d.link(b)})});Object.keys(b).forEach(function(d){var a=b[d];l[d]=e(a,function(d,b){return d.invoke(b,a)})});return l}function S(d,a,b){var l=d.shared.context,c=d.scope();Object.keys(b).forEach(function(e){a.save(l,"."+e);c(l,".",e,"=",b[e].append(d,a),";")});a(c)}function E(d,a,b){var l=d.shared,c=l.gl,e=l.framebuffer,g;ua&&(g=a.def(l.extensions,".webgl_draw_buffers"));var n=d.constants,l=n.drawBuffer,n=n.backBuffer;d=b?b.append(d,a):a.def(e,".next");a("if(",e,
".dirty||",d,"!==",e,".cur){","if(",d,"){",c,".bindFramebuffer(",36160,",",d,".framebuffer);");ua&&a(g,".drawBuffersWEBGL(",l,"[",d,".colorAttachments.length]);");a("}else{",c,".bindFramebuffer(",36160,",null);");ua&&a(g,".drawBuffersWEBGL(",n,");");a("}",e,".cur=",d,";",e,".dirty=false;","}")}function aa(d,a,b){var l=d.shared,c=l.gl,e=d.current,g=d.next,n=l.current,f=l.next,p=d.cond(n,".dirty");F.forEach(function(a){a=Y(a);if(!(a in b.state)){var l,y;if(a in g){l=g[a];y=e[a];var m=u(Z[a].length,
function(d){return p.def(l,"[",d,"]")});p(d.cond(m.map(function(d,a){return d+"!=="+y+"["+a+"]"}).join("||")).then(c,".",qa[a],"(",m,");",m.map(function(d,a){return y+"["+a+"]="+d}).join(";"),";"))}else l=p.def(f,".",a),m=d.cond(l,"!==",n,".",a),p(m),a in w?m(d.cond(l).then(c,".enable(",w[a],");")["else"](c,".disable(",w[a],");"),n,".",a,"=",l,";"):m(c,".",qa[a],"(",l,");",n,".",a,"=",l,";")}});0===Object.keys(b.state).length&&p(n,".dirty=false;");a(p)}function R(d,b,l,c){var e=d.shared,g=d.current,
f=e.current,n=e.gl;a(Object.keys(l)).forEach(function(a){var e=l[a];if(!c||c(e)){var p=e.append(d,b);if(w[a]){var m=w[a];z(e)?p?b(n,".enable(",m,");"):b(n,".disable(",m,");"):b(d.cond(p).then(n,".enable(",m,");")["else"](n,".disable(",m,");"));b(f,".",a,"=",p,";")}else if(C(p)){var F=g[a];b(n,".",qa[a],"(",p,");",p.map(function(d,a){return F+"["+a+"]="+d}).join(";"),";")}else b(n,".",qa[a],"(",p,");",f,".",a,"=",p,";")}})}function U(d,a){ca&&!d.instancing&&(d.instancing=a.def(d.shared.extensions,
".angle_instanced_arrays"))}function xa(d,a,b,l,c){function e(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function g(d){k=a.def();d(k,"=",e(),";");"string"===typeof c?d(m,".count+=",c,";"):d(m,".count++;");D&&(l?(r=a.def(),d(r,"=",F,".getNumPendingQueries();")):d(F,".beginQuery(",m,");"))}function n(d){d(m,".cpuTime+=",e(),"-",k,";");D&&(l?d(F,".pushScopeStats(",r,",",F,".getNumPendingQueries(),",m,");"):d(F,".endQuery();"))}function f(d){var b=a.def(w,".profile");a(w,
".profile=",d,";");a.exit(w,".profile=",b,";")}var p=d.shared,m=d.stats,w=p.current,F=p.timer;b=b.profile;var k,r;if(b){if(z(b)){b.enable?(g(a),n(a.exit),f("true")):f("false");return}b=b.append(d,a);f(b)}else b=a.def(w,".profile");p=d.block();g(p);a("if(",b,"){",p,"}");d=d.block();n(d);a.exit("if(",b,"){",d,"}")}function ya(d,a,b,l,c){function e(d){switch(d){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}
function g(b,l,c){function e(){a("if(!",w,".pointer){",p,".enableVertexAttribArray(",m,");",w,".pointer=true;}");var b=c.type,n;n=c.size?a.def(c.size,"||",l):l;a("if(",w,".type!==",b,"||",w,".size!==",n,"||",k.map(function(d){return w+"."+d+"!=="+c[d]}).join("||"),"){",p,".bindBuffer(",34962,",",F,".buffer);",p,".vertexAttribPointer(",[m,n,b,c.normalized,c.stride,c.offset],");",w,".type=",b,";",w,".size=",n,";",k.map(function(d){return w+"."+d+"="+c[d]+";"}).join(""),"}");ca&&(b=c.divisor,a("if(",
w,".divisor!==",b,"){",d.instancing,".vertexAttribDivisorANGLE(",[m,b],");",w,".divisor=",b,";}"))}function f(){a("if(",w,".pointer){",p,".disableVertexAttribArray(",m,");",w,".pointer=false;","}if(",v.map(function(d,a){return w+"."+d+"!=="+X[a]}).join("||"),"){",p,".vertexAttrib4f(",m,",",X,");",v.map(function(d,a){return w+"."+d+"="+X[a]+";"}).join(""),"}")}var p=n.gl,m=a.def(b,".location"),w=a.def(n.attributes,"[",m,"]");b=c.state;var F=c.buffer,X=[c.x,c.y,c.z,c.w],k=["buffer","normalized","offset",
"stride"];1===b?e():2===b?f():(a("if(",b,"===",1,"){"),e(),a("}else{"),f(),a("}"))}var n=d.shared;l.forEach(function(l){var n=l.name,f=b.attributes[n],p;if(f){if(!c(f))return;p=f.append(d,a)}else{if(!c(I))return;var w=d.scopeAttrib(n);p={};Object.keys(new la).forEach(function(d){p[d]=a.def(w,".",d)})}g(d.link(l),e(l.info.type),p)})}function za(d,a,l,c,e){for(var g=d.shared,f=g.gl,n,p=0;p<c.length;++p){var w=c[p],m=w.name,F=w.info.type,k=l.uniforms[m],w=d.link(w)+".location",D;if(k){if(!e(k))continue;
if(z(k)){m=k.value;if(35678===F||35680===F)F=d.link(m._texture),a(f,".uniform1i(",w,",",F+".bind());"),a.exit(F,".unbind();");else if(35674===F||35675===F||35676===F)m=d.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),k=2,35675===F?k=3:35676===F&&(k=4),a(f,".uniformMatrix",k,"fv(",w,",false,",m,");");else{switch(F){case 5126:n="1f";break;case 35664:n="2f";break;case 35665:n="3f";break;case 35666:n="4f";break;case 35670:n="1i";break;case 5124:n="1i";break;case 35671:n="2i";break;
case 35667:n="2i";break;case 35672:n="3i";break;case 35668:n="3i";break;case 35673:n="4i";break;case 35669:n="4i"}a(f,".uniform",n,"(",w,",",C(m)?Array.prototype.slice.call(m):m,");")}continue}else D=k.append(d,a)}else{if(!e(I))continue;D=a.def(g.uniforms,"[",b.id(m),"]")}m=1;switch(F){case 35678:case 35680:F=a.def(D,"._texture");a(f,".uniform1i(",w,",",F,".bind());");a.exit(F,".unbind();");continue;case 5124:case 35670:n="1i";break;case 35667:case 35671:n="2i";m=2;break;case 35668:case 35672:n="3i";
m=3;break;case 35669:case 35673:n="4i";m=4;break;case 5126:n="1f";break;case 35664:n="2f";m=2;break;case 35665:n="3f";m=3;break;case 35666:n="4f";m=4;break;case 35674:n="Matrix2fv";break;case 35675:n="Matrix3fv";break;case 35676:n="Matrix4fv"}a(f,".uniform",n,"(",w,",");if("M"===n.charAt(0)){var w=Math.pow(F-35674+2,2),r=d.global.def("new Float32Array(",w,")");a("false,(Array.isArray(",D,")||",D," instanceof Float32Array)?",D,":(",u(w,function(d){return r+"["+d+"]="+D+"["+d+"]"}),",",r,")")}else 1<
m?a(u(m,function(d){return D+"["+d+"]"})):a(D);a(");")}}function ea(d,a,b,l){function c(n){var e=m[n];return e?e.contextDep&&l.contextDynamic||e.propDep?e.append(d,b):e.append(d,a):a.def(p,".",n)}function e(){function d(){b(h,".drawElementsInstancedANGLE(",[F,D,t,k+"<<(("+t+"-5121)>>1)",r],");")}function a(){b(h,".drawArraysInstancedANGLE(",[F,k,D,r],");")}w?H?d():(b("if(",w,"){"),d(),b("}else{"),a(),b("}")):a()}function g(){function d(){b(f+".drawElements("+[F,D,t,k+"<<(("+t+"-5121)>>1)"]+");")}
function a(){b(f+".drawArrays("+[F,k,D]+");")}w?H?d():(b("if(",w,"){"),d(),b("}else{"),a(),b("}")):a()}var n=d.shared,f=n.gl,p=n.draw,m=l.draw,w=function(){var c=m.elements,e=a;if(c){if(c.contextDep&&l.contextDynamic||c.propDep)e=b;c=c.append(d,e)}else c=e.def(p,".","elements");c&&e("if("+c+")"+f+".bindBuffer(34963,"+c+".buffer.buffer);");return c}(),F=c("primitive"),k=c("offset"),D=function(){var c=m.count,e=a;if(c){if(c.contextDep&&l.contextDynamic||c.propDep)e=b;c=c.append(d,e)}else c=e.def(p,
".","count");return c}();if("number"===typeof D){if(0===D)return}else b("if(",D,"){"),b.exit("}");var r,h;ca&&(r=c("instances"),h=d.instancing);var t=w+".type",H=m.elements&&z(m.elements);ca&&("number"!==typeof r||0<=r)?"string"===typeof r?(b("if(",r,">0){"),e(),b("}else if(",r,"<0){"),g(),b("}")):e():g()}function fa(d,a,b,l,c){a=N();c=a.proc("body",c);ca&&(a.instancing=c.def(a.shared.extensions,".angle_instanced_arrays"));d(a,c,b,l);return a.compile().body}function ka(d,a,b,l){U(d,a);ya(d,a,b,l.attributes,
function(){return!0});za(d,a,b,l.uniforms,function(){return!0});ea(d,a,a,b)}function Ha(d,a){var b=d.proc("draw",1);U(d,b);S(d,b,a.context);E(d,b,a.framebuffer);aa(d,b,a);R(d,b,a.state);xa(d,b,a,!1,!0);var l=a.shader.progVar.append(d,b);b(d.shared.gl,".useProgram(",l,".program);");if(a.shader.program)ka(d,b,a,a.shader.program);else{var c=d.global.def("{}"),e=b.def(l,".id"),g=b.def(c,"[",e,"]");b(d.cond(g).then(g,".call(this,a0);")["else"](g,"=",c,"[",e,"]=",d.link(function(b){return fa(ka,d,a,b,1)}),
"(",l,");",g,".call(this,a0);"))}0<Object.keys(a.state).length&&b(d.shared.current,".dirty=true;")}function Ea(d,a,b,l){function c(){return!0}d.batchId="a1";U(d,a);ya(d,a,b,l.attributes,c);za(d,a,b,l.uniforms,c);ea(d,a,a,b)}function Ba(d,a,b,l){function c(d){return d.contextDep&&g||d.propDep}function e(d){return!c(d)}U(d,a);var g=b.contextDep,n=a.def(),f=a.def();d.shared.props=f;d.batchId=n;var p=d.scope(),m=d.scope();a(p.entry,"for(",n,"=0;",n,"<","a1",";++",n,"){",f,"=","a0","[",n,"];",m,"}",p.exit);
b.needsContext&&S(d,m,b.context);b.needsFramebuffer&&E(d,m,b.framebuffer);R(d,m,b.state,c);b.profile&&c(b.profile)&&xa(d,m,b,!1,!0);l?(ya(d,p,b,l.attributes,e),ya(d,m,b,l.attributes,c),za(d,p,b,l.uniforms,e),za(d,m,b,l.uniforms,c),ea(d,p,m,b)):(a=d.global.def("{}"),l=b.shader.progVar.append(d,m),f=m.def(l,".id"),p=m.def(a,"[",f,"]"),m(d.shared.gl,".useProgram(",l,".program);","if(!",p,"){",p,"=",a,"[",f,"]=",d.link(function(a){return fa(Ea,d,b,a,2)}),"(",l,");}",p,".call(this,a0[",n,"],",n,");"))}
function Fa(d,a){function b(a){return a.contextDep&&c||a.propDep}var l=d.proc("batch",2);d.batchId="0";U(d,l);var c=!1,e=!0;Object.keys(a.context).forEach(function(d){c=c||a.context[d].propDep});c||(S(d,l,a.context),e=!1);var g=a.framebuffer,n=!1;g?(g.propDep?c=n=!0:g.contextDep&&c&&(n=!0),n||E(d,l,g)):E(d,l,null);a.state.viewport&&a.state.viewport.propDep&&(c=!0);aa(d,l,a);R(d,l,a.state,function(a){return!b(a)});a.profile&&b(a.profile)||xa(d,l,a,!1,"a1");a.contextDep=c;a.needsContext=e;a.needsFramebuffer=
n;e=a.shader.progVar;if(e.contextDep&&c||e.propDep)Ba(d,l,a,null);else if(e=e.append(d,l),l(d.shared.gl,".useProgram(",e,".program);"),a.shader.program)Ba(d,l,a,a.shader.program);else{var g=d.global.def("{}"),n=l.def(e,".id"),f=l.def(g,"[",n,"]");l(d.cond(f).then(f,".call(this,a0,a1);")["else"](f,"=",g,"[",n,"]=",d.link(function(b){return fa(Ba,d,a,b,2)}),"(",e,");",f,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&l(d.shared.current,".dirty=true;")}function Ga(d,l){function c(a){var b=l.shader[a];
b&&e.set(g.shader,"."+a,b.append(d,e))}var e=d.proc("scope",3);d.batchId="a2";var g=d.shared,f=g.current;S(d,e,l.context);l.framebuffer&&l.framebuffer.append(d,e);a(Object.keys(l.state)).forEach(function(a){var b=l.state[a].append(d,e);C(b)?b.forEach(function(b,l){e.set(d.next[a],"["+l+"]",b)}):e.set(g.next,"."+a,b)});xa(d,e,l,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(a){var b=l.draw[a];b&&e.set(g.draw,"."+a,""+b.append(d,e))});Object.keys(l.uniforms).forEach(function(a){e.set(g.uniforms,
"["+b.id(a)+"]",l.uniforms[a].append(d,e))});Object.keys(l.attributes).forEach(function(a){var b=l.attributes[a].append(d,e),c=d.scopeAttrib(a);Object.keys(new la).forEach(function(a){e.set(c,"."+a,b[a])})});c("vert");c("frag");0<Object.keys(l.state).length&&(e(f,".dirty=true;"),e.exit(f,".dirty=true;"));e("a1(",d.shared.context,",a0,",d.batchId,");")}var la=J.Record,ma={add:32774,subtract:32778,"reverse subtract":32779};h.ext_blend_minmax&&(ma.min=32775,ma.max=32776);var ca=h.angle_instanced_arrays,
ua=h.webgl_draw_buffers,Z={dirty:!0,profile:W.profile},l={},F=[],w={},qa={};P("dither",3024);P("blend.enable",3042);M("blend.color","blendColor",[0,0,0,0]);M("blend.equation","blendEquationSeparate",[32774,32774]);M("blend.func","blendFuncSeparate",[1,0,1,0]);P("depth.enable",2929,!0);M("depth.func","depthFunc",513);M("depth.range","depthRange",[0,1]);M("depth.mask","depthMask",!0);M("colorMask","colorMask",[!0,!0,!0,!0]);P("cull.enable",2884);M("cull.face","cullFace",1029);M("frontFace","frontFace",
2305);M("lineWidth","lineWidth",1);P("polygonOffset.enable",32823);M("polygonOffset.offset","polygonOffset",[0,0]);P("sample.alpha",32926);P("sample.enable",32928);M("sample.coverage","sampleCoverage",[1,!1]);P("stencil.enable",2960);M("stencil.mask","stencilMask",-1);M("stencil.func","stencilFunc",[519,0,-1]);M("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);M("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);P("scissor.enable",3089);M("scissor.box","scissor",[0,0,m.drawingBufferWidth,
m.drawingBufferHeight]);M("viewport","viewport",[0,0,m.drawingBufferWidth,m.drawingBufferHeight]);var Ja={gl:m,context:ga,strings:b,next:l,current:Z,draw:T,elements:G,buffer:A,shader:H,attributes:J.state,uniforms:da,framebuffer:pa,extensions:h,timer:D,isBufferArgs:k},Da={primTypes:t,compareFuncs:g,blendFuncs:B,blendEquations:ma,stencilOps:p,glTypes:K,orientationType:L};ua&&(Da.backBuffer=[1029],Da.drawBuffer=u(q.maxDrawbuffers,function(a){return 0===a?[0]:u(a,function(a){return 36064+a})}));var La=
0;return{next:l,current:Z,procs:function(){var a=N(),b=a.proc("poll"),l=a.proc("refresh"),c=a.block();b(c);l(c);var e=a.shared,g=e.gl,f=e.next,n=e.current;c(n,".dirty=false;");E(a,b);l(e.framebuffer,".dirty=true;");E(a,l);Object.keys(w).forEach(function(e){var p=w[e],m=c.def(f,".",e),F=a.block();F("if(",m,"){",g,".enable(",p,")}else{",g,".disable(",p,")}",n,".",e,"=",m,";");l(F);b("if(",m,"!==",n,".",e,"){",F,"}")});Object.keys(qa).forEach(function(e){var p=qa[e],m=Z[e],w,F,k=a.block();k(g,".",p,
"(");C(m)?(p=m.length,w=a.global.def(f,".",e),F=a.global.def(n,".",e),k(u(p,function(a){return w+"["+a+"]"}),");",u(p,function(a){return F+"["+a+"]="+w+"["+a+"];"}).join("")),b("if(",u(p,function(a){return w+"["+a+"]!=="+F+"["+a+"]"}).join("||"),"){",k,"}")):(w=c.def(f,".",e),F=c.def(n,".",e),k(w,");",n,".",e,"=",w,";"),b("if(",w,"!==",F,"){",k,"}"));l(k)});return a.compile()}(),compile:function(a,b,l,c,e){var g=N();g.stats=g.link(e);e=ha(a);var f=ra(a,e),n=ia(a),p=sa(a),m=wa(a),w=f.viewport;w&&(p.viewport=
w);w=Y("scissor.box");(f=f[w])&&(p[w]=f);f=0<Object.keys(p).length;e={framebuffer:e,draw:n,shader:m,state:p,dirty:f};e.profile=Q(a);e.uniforms=ja(l);e.attributes=ba(b);e.context=ta(c);Ha(g,e);Ga(g,e);Fa(g,e);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(h,q,x){function k(a,e){this.id=z++;this.type=a;this.data=e}function a(f){if(0===f.length)return[];
var e=f.charAt(0),c=f.charAt(f.length-1);if(1<f.length&&e===c&&('"'===e||"'"===e))return['"'+f.substr(1,f.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(f))return a(f.substr(0,e.index)).concat(a(e[1])).concat(a(f.substr(e.index+e[0].length)));e=f.split(".");if(1===e.length)return['"'+f.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];f=[];for(c=0;c<e.length;++c)f=f.concat(a(e[c]));return f}function r(f){return"["+a(f).join("][")+"]"}var z=
0;q.exports={define:function(a,e){return new k(a,r(e+""))},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof k},unbox:function(a,e){return"function"===typeof a?new k(0,a):a},accessor:r}},{}],10:[function(h,q,x){var k=h("./util/is-typed-array"),a=h("./util/is-ndarray"),r=h("./util/values"),z=h("./constants/primitives.json"),f=h("./constants/usage.json");q.exports=function(e,c,h,A){function q(a){this.id=v++;K[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=
0}function C(e,g,f,m,b,r,t){(r=t)||k(g)&&(!a(g)||k(g.data))||(r=c.oes_element_index_uint?5125:5123);e.buffer.bind();h._initBuffer(e.buffer,g,f,r,3);g=t;if(!t){switch(e.buffer.dtype){case 5121:case 5120:g=5121;break;case 5123:case 5122:g=5123;break;case 5125:case 5124:g=5125}e.buffer.dtype=g}e.type=g;0>b&&(b=e.buffer.byteLength,5123===g?b>>=1:5125===g&&(b>>=2));e.vertCount=b;b=m;0>m&&(b=4,m=e.buffer.dimension,1===m&&(b=0),2===m&&(b=1),3===m&&(b=4));e.primType=b}function t(a){A.elementsCount--;delete K[a.id];
a.buffer.destroy();a.buffer=null}var K={},v=0,B={uint8:5121,uint16:5123};c.oes_element_index_uint&&(B.uint32=5125);q.prototype.bind=function(){this.buffer.bind()};var g=[];return{create:function(c){function g(b){if(b)if("number"===typeof b)r(b),m.primType=4,m.vertCount=b|0,m.type=5121;else{var c=null,p=35044,h=-1,t=-1,u=0,v=0;Array.isArray(b)||k(b)||a(b)?c=b:("data"in b&&(c=b.data),"usage"in b&&(p=f[b.usage]),"primitive"in b&&(h=z[b.primitive]),"count"in b&&(t=b.count|0),"length"in b&&(u=b.length|
0),"type"in b&&(v=B[b.type]));c?C(m,c,p,h,t,u,v):(b=m.buffer,b.bind(),e.bufferData(34963,u,p),b.dtype=v||5121,b.usage=p,b.dimension=3,b.byteLength=u,m.primType=0>h?4:h,m.vertCount=0>t?0:t,m.type=b.dtype)}else r(),m.primType=4,m.vertCount=0,m.type=5121;return g}var r=h.create(null,34963,!0),m=new q(r._buffer);A.elementsCount++;g(c);g._reglType="elements";g._elements=m;g.subdata=function(a,c){r.subdata(a,c);return g};g.destroy=function(){t(m)};return g},createStream:function(a){var c=g.pop();c||(c=
new q(h.create(null,34963,!0)._buffer));C(c,a,35040,-1,-1,0,0);return c},destroyStream:function(a){g.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof q?a._elements:null},clear:function(){r(K).forEach(t)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(h,q,x){q.exports=function(k,a){function r(a){a=a.toLowerCase();if(a in h)return!0;var e;try{e=h[a]=k.getExtension(a)}catch(f){}return!!e}
for(var h={},f=0;f<a.extensions.length;++f){var e=a.extensions[f];if(!r(e))return a.onDestroy(),a.onDone('"'+e+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}a.optionalExtensions.forEach(r);return{extensions:h,refresh:function(){a.extensions.forEach(r);a.optionalExtensions.forEach(r)}}}},{}],12:[function(h,q,x){var k=h("./util/values"),a=h("./util/extend"),r=[];r[6408]=4;var z=[];z[5121]=1;z[5126]=4;z[36193]=2;q.exports=function(f,
e,c,h,q,G){function C(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var e=a=0;b?(a=b.width,e=b.height):c&&(a=c.width,e=c.height);this.width=a;this.height=e}function t(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function K(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function v(a,b){b?b.texture?f.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):f.framebufferRenderbuffer(36160,
a,36161,b.renderbuffer._renderbuffer.renderbuffer):f.framebufferTexture2D(36160,a,3553,null,0)}function B(a){var b=3553,c=null,e=null,g=a;"object"===typeof a&&(g=a.data,"target"in a&&(b=a.target|0));a=g._reglType;"texture2d"===a?c=g:"textureCube"===a?c=g:"renderbuffer"===a&&(e=g,b=36161);return new C(b,c,e)}function g(a,b,c,e,g){if(c)return a=h.create2D({width:a,height:b,format:e,type:g}),a._texture.refCount=0,new C(3553,a,null);a=q.create({width:a,height:b,format:e});a._renderbuffer.refCount=0;return new C(36161,
null,a)}function p(a){return a&&(a.texture||a.renderbuffer)}function x(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function I(){this.id=da++;J[this.id]=this;this.framebuffer=f.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function m(a){a.colorAttachments.forEach(t);t(a.depthAttachment);t(a.stencilAttachment);t(a.depthStencilAttachment)}function b(a){f.deleteFramebuffer(a.framebuffer);
a.framebuffer=null;G.framebufferCount--;delete J[a.id]}function V(a){var b;f.bindFramebuffer(36160,a.framebuffer);var e=a.colorAttachments;for(b=0;b<e.length;++b)v(36064+b,e[b]);for(b=e.length;b<c.maxColorAttachments;++b)v(36064+b,null);v(36096,a.depthAttachment);v(36128,a.stencilAttachment);v(33306,a.depthStencilAttachment);f.checkFramebufferStatus(36160);f.bindFramebuffer(36160,na.next);na.current=na.next}function Ia(c,f){function k(a,b){var c,f=0,t=0,u=!0,v=!0;c=null;var q=!0,A="rgba",C="uint8",
G=1,x=null,I=null,H=null,L=!1;if("number"===typeof a)f=a|0,t=b|0||f;else if(a){"shape"in a?(t=a.shape,f=t[0],t=t[1]):("radius"in a&&(f=t=a.radius),"width"in a&&(f=a.width),"height"in a&&(t=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);c||("colorCount"in a&&(G=a.colorCount|0),"colorTexture"in a&&(q=!!a.colorTexture,A="rgba4"),"colorType"in a&&(C=a.colorType,q||("half float"===C?e.ext_color_buffer_half_float&&(A="rgba16f"):"float"===C&&e.webgl_color_buffer_float&&(A="rgba32f"))),
"colorFormat"in a&&(A=a.colorFormat,0<=oa.indexOf(A)?q=!0:0<=va.indexOf(A)&&(q=!1)));if("depthTexture"in a||"depthStencilTexture"in a)L=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?u=a.depth:(x=a.depth,v=!1));"stencil"in a&&("boolean"===typeof a.stencil?v=a.stencil:(I=a.stencil,u=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?u=v=a.depthStencil:(H=a.depthStencil,v=u=!1))}else f=t=1;var E=null,J=null,R=null,U=null;if(Array.isArray(c))E=c.map(B);else if(c)E=
[B(c)];else for(E=Array(G),c=0;c<G;++c)E[c]=g(f,t,q,A,C);f=f||E[0].width;t=t||E[0].height;x?J=B(x):u&&!v&&(J=g(f,t,L,"depth","uint32"));I?R=B(I):v&&!u&&(R=g(f,t,!1,"stencil","uint8"));H?U=B(H):!x&&!I&&v&&u&&(U=g(f,t,L,"depth stencil","depth stencil"));u=null;for(c=0;c<E.length;++c)K(E[c],f,t),E[c]&&E[c].texture&&(v=r[E[c].texture._texture.format]*z[E[c].texture._texture.type],null===u&&(u=v));K(J,f,t);K(R,f,t);K(U,f,t);m(h);h.width=f;h.height=t;h.colorAttachments=E;h.depthAttachment=J;h.stencilAttachment=
R;h.depthStencilAttachment=U;k.color=E.map(p);k.depth=p(J);k.stencil=p(R);k.depthStencil=p(U);k.width=h.width;k.height=h.height;V(h);return k}var h=new I;G.framebufferCount++;k(c,f);return a(k,{resize:function(a,b){var c=a|0,e=b|0||c;if(c===h.width&&e===h.height)return k;for(var g=h.colorAttachments,f=0;f<g.length;++f)x(g[f],c,e);x(h.depthAttachment,c,e);x(h.stencilAttachment,c,e);x(h.depthStencilAttachment,c,e);h.width=k.width=c;h.height=k.height=e;V(h);return k},_reglType:"framebuffer",_framebuffer:h,
destroy:function(){b(h);m(h)}})}var na={current:null,next:null,dirty:!1},oa=["rgba"],va=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&va.push("srgba");e.ext_color_buffer_half_float&&va.push("rgba16f","rgb16f");e.webgl_color_buffer_float&&va.push("rgba32f");var pa=["uint8"];e.oes_texture_half_float&&pa.push("half float");e.oes_texture_float&&pa.push("float");var da=0,J={};return a(na,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof I)?
a:null},create:Ia,createCube:function(b){function c(b){var g={color:null},f=0,m=null,p="rgba",k="uint8",t=1;if("number"===typeof b)f=b|0;else if(b){"shape"in b?f=b.shape[0]:("radius"in b&&(f=b.radius|0),"width"in b?f=b.width|0:"height"in b&&(f=b.height|0));if("color"in b||"colors"in b)m=b.color||b.colors,Array.isArray(m);m||("colorCount"in b&&(t=b.colorCount|0),"colorType"in b&&(k=b.colorType),"colorFormat"in b&&(p=b.colorFormat));"depth"in b&&(g.depth=b.depth);"stencil"in b&&(g.stencil=b.stencil);
"depthStencil"in b&&(g.depthStencil=b.depthStencil)}else f=1;var r;if(m)if(Array.isArray(m))for(b=0;b<m.length;++b);else r=[m];else for(r=Array(t),m={radius:f,format:p,type:k},b=0;b<t;++b)r[b]=h.createCube(m);g.color=Array(r.length);for(b=0;b<r.length;++b)t=r[b],f=f||t.width,g.color[b]={target:34069,data:r[b]};for(b=0;6>b;++b){for(t=0;t<r.length;++t)g.color[t].target=34069+b;0<b&&(g.depth=e[0].depth,g.stencil=e[0].stencil,g.depthStencil=e[0].depthStencil);if(e[b])e[b](g);else e[b]=Ia(g)}return a(c,
{width:f,height:f,color:r})}var e=Array(6);c(b);return a(c,{faces:e,resize:function(a){for(var b=0;6>b;++b)e[b].resize(a);return c},_reglType:"framebufferCube",destroy:function(){e.forEach(function(a){a.destroy()})}})},clear:function(){k(J).forEach(b)}})}},{"./util/extend":23,"./util/values":31}],13:[function(h,q,x){q.exports=function(k,a){var h=1;a.ext_texture_filter_anisotropic&&(h=k.getParameter(34047));var z=1,f=1;a.webgl_draw_buffers&&(z=k.getParameter(34852),f=k.getParameter(36063));return{colorBits:[k.getParameter(3410),
k.getParameter(3411),k.getParameter(3412),k.getParameter(3413)],depthBits:k.getParameter(3414),stencilBits:k.getParameter(3415),subpixelBits:k.getParameter(3408),extensions:Object.keys(a).filter(function(e){return!!a[e]}),maxAnisotropic:h,maxDrawbuffers:z,maxColorAttachments:f,pointSizeDims:k.getParameter(33901),lineWidthDims:k.getParameter(33902),maxViewportDims:k.getParameter(3386),maxCombinedTextureUnits:k.getParameter(35661),maxCubeMapSize:k.getParameter(34076),maxRenderbufferSize:k.getParameter(34024),
maxTextureUnits:k.getParameter(34930),maxTextureSize:k.getParameter(3379),maxAttributes:k.getParameter(34921),maxVertexUniforms:k.getParameter(36347),maxVertexTextureUnits:k.getParameter(35660),maxVaryingVectors:k.getParameter(36348),maxFragmentUniforms:k.getParameter(36349),glsl:k.getParameter(35724),renderer:k.getParameter(7937),vendor:k.getParameter(7936),version:k.getParameter(7938)}}},{}],14:[function(h,q,x){var k=h("./util/is-typed-array");q.exports=function(a,h,z,f,e,c){return function(c){var e;
e=null===h.next?5121:h.next.colorAttachments[0].texture._texture.type;var q=0,C=0,t=f.framebufferWidth,K=f.framebufferHeight,v=null;k(c)?v=c:c&&(q=c.x|0,C=c.y|0,t=(c.width||f.framebufferWidth-q)|0,K=(c.height||f.framebufferHeight-C)|0,v=c.data||null);z();c=t*K*4;v||(5121===e?v=new Uint8Array(c):5126===e&&(v=v||new Float32Array(c)));a.pixelStorei(3333,4);a.readPixels(q,C,t,K,6408,e,v);return v}}},{"./util/is-typed-array":26}],15:[function(h,q,x){var k=h("./util/values"),a=[];a[32854]=2;a[32855]=2;
a[36194]=2;a[33189]=2;a[36168]=1;a[34041]=4;a[35907]=4;a[34836]=16;a[34842]=8;a[34843]=6;q.exports=function(h,z,f,e,c){function u(a){this.id=C++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;c.profile&&(this.stats={size:0})}function q(a){var c=a.renderbuffer;h.bindRenderbuffer(36161,null);h.deleteRenderbuffer(c);a.renderbuffer=null;a.refCount=0;delete t[a.id];e.renderbufferCount--}var G={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};
z.ext_srgb&&(G.srgba=35907);z.ext_color_buffer_half_float&&(G.rgba16f=34842,G.rgb16f=34843);z.webgl_color_buffer_float&&(G.rgba32f=34836);var C=0,t={};u.prototype.decRef=function(){0>=--this.refCount&&q(this)};c.profile&&(e.getTotalRenderbufferSize=function(){var a=0;Object.keys(t).forEach(function(c){a+=t[c].stats.size});return a});return{create:function(f,k){function B(e,f){var k=0,m=0,b=32854;"object"===typeof e&&e?("shape"in e?(m=e.shape,k=m[0]|0,m=m[1]|0):("radius"in e&&(k=m=e.radius|0),"width"in
e&&(k=e.width|0),"height"in e&&(m=e.height|0)),"format"in e&&(b=G[e.format])):"number"===typeof e?(k=e|0,m="number"===typeof f?f|0:k):e||(k=m=1);if(k!==g.width||m!==g.height||b!==g.format)return B.width=g.width=k,B.height=g.height=m,g.format=b,h.bindRenderbuffer(36161,g.renderbuffer),h.renderbufferStorage(36161,b,k,m),c.profile&&(g.stats.size=a[g.format]*g.width*g.height),B}var g=new u(h.createRenderbuffer());t[g.id]=g;e.renderbufferCount++;B(f,k);B.resize=function(e,f){var k=e|0,m=f|0||k;if(k===
g.width&&m===g.height)return B;B.width=g.width=k;B.height=g.height=m;h.bindRenderbuffer(36161,g.renderbuffer);h.renderbufferStorage(36161,g.format,k,m);c.profile&&(g.stats.size=a[g.format]*g.width*g.height);return B};B._reglType="renderbuffer";B._renderbuffer=g;c.profile&&(B.stats=g.stats);B.destroy=function(){g.decRef()};return B},clear:function(){k(t).forEach(q)}}}},{"./util/values":31}],16:[function(h,q,x){var k=h("./util/values");q.exports=function(a,h,z,f){function e(a,c,e,f){this.name=a;this.id=
c;this.location=e;this.info=f}function c(a,c){for(var e=0;e<a.length;++e)if(a[e].id===c.id){a[e].location=c.location;return}a.push(c)}function u(c,e,f){f=35632===c?G:C;var k=f[e];if(!k){var t=h.str(e),k=a.createShader(c);a.shaderSource(k,t);a.compileShader(k);f[e]=k}return k}function q(a,c){this.id=v++;this.fragId=a;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[];f.profile&&(this.stats={uniformsCount:0,attributesCount:0})}var G={},C={},t={},K=[],v=0;f.profile&&(z.getMaxUniformsCount=
function(){var a=0;K.forEach(function(c){c.stats.uniformsCount>a&&(a=c.stats.uniformsCount)});return a},z.getMaxAttributesCount=function(){var a=0;K.forEach(function(c){c.stats.attributesCount>a&&(a=c.stats.attributesCount)});return a});return{clear:function(){var c=a.deleteShader.bind(a);k(G).forEach(c);G={};k(C).forEach(c);C={};K.forEach(function(c){a.deleteProgram(c.program)});K.length=0;t={};z.shaderCount=0},program:function(k,g,p){z.shaderCount++;(p=t[g])||(p=t[g]={});var v=p[k];if(!v){var C=
v=new q(g,k),m,b;m=u(35632,C.fragId);b=u(35633,C.vertId);g=C.program=a.createProgram();a.attachShader(g,m);a.attachShader(g,b);a.linkProgram(g);var G=a.getProgramParameter(g,35718);f.profile&&(C.stats.uniformsCount=G);var x=C.uniforms;for(m=0;m<G;++m)if(b=a.getActiveUniform(g,m))if(1<b.size)for(var na=0;na<b.size;++na){var oa=b.name.replace("[0]","["+na+"]");c(x,new e(oa,h.id(oa),a.getUniformLocation(g,oa),b))}else c(x,new e(b.name,h.id(b.name),a.getUniformLocation(g,b.name),b));G=a.getProgramParameter(g,
35721);f.profile&&(C.stats.attributesCount=G);C=C.attributes;for(m=0;m<G;++m)(b=a.getActiveAttrib(g,m))&&c(C,new e(b.name,h.id(b.name),a.getAttribLocation(g,b.name),b));p[k]=v;K.push(v)}return v},shader:u,frag:null,vert:null}}},{"./util/values":31}],17:[function(h,q,x){q.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(h,q,x){q.exports=function(){var k={"":0},a=[""];return{id:function(h){var q=
k[h];if(q)return q;q=k[h]=a.length;a.push(h);return q},str:function(k){return a[k]}}}},{}],19:[function(h,q,x){function k(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&K(a[0])?!0:!1}function r(a){return Object.prototype.toString.call(a)}function z(b){if(!b)return!1;var c=r(b);return 0<=L.indexOf(c)?!0:k(b)||a(b)||G(b)}function f(a,c){36193===a.type?(a.data=t(c),C.freeType(c)):a.data=c}function e(a,c,e,f,g,k){a="undefined"!==
typeof m[a]?m[a]:p[a]*I[c];k&&(a*=6);if(g){for(f=0;1<=e;)f+=a*e*e,e/=2;return f}return a*e*f}var c=h("./util/extend"),u=h("./util/values"),A=h("./util/is-typed-array"),G=h("./util/is-ndarray"),C=h("./util/pool"),t=h("./util/to-half-float"),K=h("./util/is-array-like");x=h("./constants/arraytypes.json");var v=h("./constants/arraytypes.json"),B=[9984,9986,9985,9987],g=[0,6409,6410,6407,6408],p={};p[6409]=p[6406]=p[6402]=1;p[34041]=p[6410]=2;p[6407]=p[35904]=3;p[6408]=p[35906]=4;var L=Object.keys(x).concat(["[object HTMLCanvasElement]",
"[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),I=[];I[5121]=1;I[5126]=4;I[36193]=2;I[5123]=2;I[5125]=4;var m=[];m[32854]=2;m[32855]=2;m[36194]=2;m[34041]=4;m[33776]=.5;m[33777]=.5;m[33778]=1;m[33779]=1;m[35986]=.5;m[35987]=1;m[34798]=1;m[35840]=.5;m[35841]=.25;m[35842]=.5;m[35843]=.25;m[36196]=.5;q.exports=function(b,m,h,q,x,I,L){function da(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=
1;this.height=this.width=this.colorSpace=0;this.channels=4}function J(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function H(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=
b.alignment);"colorSpace"in b&&(a.colorSpace=za[b.colorSpace]);"type"in b&&(a.type=ea[b.type]);var c=a.width,e=a.height,f=a.channels,m=!1;"shape"in b?(c=b.shape[0],e=b.shape[1],3===b.shape.length&&(f=b.shape[2],m=!0)):("radius"in b&&(c=e=b.radius),"width"in b&&(c=b.width),"height"in b&&(e=b.height),"channels"in b&&(f=b.channels,m=!0));a.width=c|0;a.height=e|0;a.channels=f|0;c=!1;"format"in b&&(c=b.format,e=a.internalformat=fa[c],a.format=Ba[e],c in ea&&!("type"in b)&&(a.type=ea[c]),c in ka&&(a.compressed=
!0),c=!0);!m&&c?a.channels=p[a.format]:m&&!c&&a.channels!==g[a.format]&&(a.format=a.internalformat=g[a.channels])}}function T(a){b.pixelStorei(37440,a.flipY);b.pixelStorei(37441,a.premultiplyAlpha);b.pixelStorei(37443,a.colorSpace);b.pixelStorei(3317,a.unpackAlignment)}function ga(){da.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function D(b,c){var e=null;z(c)?e=c:c&&(H(b,c),"x"in c&&(b.xOffset=c.x|0),"y"in c&&(b.yOffset=c.y|0),z(c.data)&&
(e=c.data));if(c.copy){var m=x.viewportWidth,h=x.viewportHeight;b.width=b.width||m-b.xOffset;b.height=b.height||h-b.yOffset;b.needsCopy=!0}else if(!e)b.width=b.width||1,b.height=b.height||1;else if(A(e))b.data=e,"type"in c||5121!==b.type||(b.type=v[Object.prototype.toString.call(e)]|0);else if(k(e)){m=e;h=b.width*b.height*b.channels;switch(b.type){case 5121:case 5123:case 5125:case 5126:h=C.allocType(b.type,h);h.set(m);b.data=h;break;case 36193:b.data=t(m)}b.alignment=1;b.needsFree=!0}else if(G(e)){m=
e.data;Array.isArray(m)||5121!==b.type||(b.type=v[Object.prototype.toString.call(m)]|0);var h=e.shape,p=e.stride,q,d,y,u;3===h.length?(y=h[2],u=p[2]):u=y=1;q=h[0];d=h[1];h=p[0];p=p[1];b.alignment=1;b.width=q;b.height=d;b.channels=y;b.format=b.internalformat=g[y];b.needsFree=!0;q=u;e=e.offset;y=b.width;u=b.height;d=b.channels;for(var B=C.allocType(36193===b.type?5126:b.type,y*u*d),D=0,E=0;E<u;++E)for(var R=0;R<y;++R)for(var n=0;n<d;++n)B[D++]=m[h*R+p*E+q*n+e];f(b,B)}else if("[object HTMLCanvasElement]"===
r(e)||"[object CanvasRenderingContext2D]"===r(e))"[object HTMLCanvasElement]"===r(e)?b.element=e:b.element=e.canvas,b.width=b.element.width,b.height=b.element.height;else if("[object HTMLImageElement]"===r(e))b.element=e,b.width=e.naturalWidth,b.height=e.naturalHeight;else if("[object HTMLVideoElement]"===r(e))b.element=e,b.width=e.videoWidth,b.height=e.videoHeight,b.needsPoll=!0;else if(a(e)){m=e[0].length;h=e.length;p=1;if(K(e[0][0])){q=p=e[0][0].length;y=C.allocType(36193===b.type?5126:b.type,
m*h*q);for(d=u=0;d<h;++d)for(B=e[d],D=0;D<m;++D)for(E=B[D],R=0;R<q;++R)y[u++]=E[R];f(b,y)}else{q=C.allocType(36193===b.type?5126:b.type,m*h);for(u=y=0;u<h;++u)for(d=e[u],B=0;B<m;++B)q[y++]=d[B];f(b,q)}b.alignment=1;b.width=m;b.height=h;b.channels=p;b.format=b.internalformat=g[p];b.needsFree=!0}}function W(a,c,e,f,g){var m=a.element,h=a.data,d=a.internalformat,k=a.format,p=a.type,t=a.width,r=a.height;T(a);m?b.texSubImage2D(c,g,e,f,k,p,m):a.compressed?b.compressedTexSubImage2D(c,g,e,f,d,t,r,h):a.needsCopy?
(q(),b.copyTexSubImage2D(c,g,e,f,a.xOffset,a.yOffset,t,r)):b.texSubImage2D(c,g,e,f,t,r,k,p,h)}function Y(){return Fa.pop()||new ga}function P(a){a.needsFree&&C.freeType(a.data);ga.call(a);Fa.push(a)}function M(){da.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function N(a,b,c){var e=a.images[0]=Y();a.mipmask=1;e.width=a.width=b;e.height=a.height=c}function Q(a,b){var c=null;if(z(b))c=a.images[0]=Y(),J(c,a),D(c,b),a.mipmask=1;else if(H(a,b),Array.isArray(b.mipmap))for(var e=
b.mipmap,f=0;f<e.length;++f)c=a.images[f]=Y(),J(c,a),c.width>>=f,c.height>>=f,D(c,e[f]),a.mipmask|=1<<f;else c=a.images[0]=Y(),J(c,a),D(c,b),a.mipmask=1;J(a,a.images[0])}function ha(a,c){for(var e=a.images,f=0;f<e.length&&e[f];++f){var g=e[f],m=c,h=f,d=g.element,k=g.data,p=g.internalformat,t=g.format,r=g.type,u=g.width,v=g.height;T(g);d?b.texImage2D(m,h,t,t,r,d):g.compressed?b.compressedTexImage2D(m,h,p,u,v,0,k):g.needsCopy?(q(),b.copyTexImage2D(m,h,t,g.xOffset,g.yOffset,u,v,0)):b.texImage2D(m,h,
t,u,v,0,t,r,k)}}function ra(){var a=Ga.pop()||new M;da.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function wa(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&P(b[c]),b[c]=null;Ga.push(a)}function ia(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function sa(a,b){"min"in b&&(a.minFilter=ya[b.min],0<=B.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=xa[b.mag]);var c=a.wrapS,e=a.wrapT;if("wrap"in
b){var f=b.wrap;"string"===typeof f?c=e=U[f]:Array.isArray(f)&&(c=U[f[0]],e=U[f[1]])}else"wrapS"in b&&(c=U[b.wrapS]),"wrapT"in b&&(e=U[b.wrapT]);a.wrapS=c;a.wrapT=e;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=R[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function ja(a,c){b.texParameteri(c,10241,a.minFilter);b.texParameteri(c,
10240,a.magFilter);b.texParameteri(c,10242,a.wrapS);b.texParameteri(c,10243,a.wrapT);m.ext_texture_filter_anisotropic&&b.texParameteri(c,34046,a.anisotropic);a.genMipmaps&&(b.hint(33170,a.mipmapHint),b.generateMipmap(c))}function ba(){var a=la.pop()||new ia;ia.call(a);return a}function ta(a){da.call(this);this.mipmask=0;this.internalformat=6408;this.id=ma++;this.refCount=1;this.target=a;this.texture=b.createTexture();this.unit=-1;this.bindCount=0;L.profile&&(this.stats={size:0})}function S(a){b.activeTexture(33984);
b.bindTexture(a.target,a.texture)}function E(){var a=Z[0];a?b.bindTexture(a.target,a.texture):b.bindTexture(3553,null)}function aa(a){var c=a.texture,e=a.unit,f=a.target;0<=e&&(b.activeTexture(33984+e),b.bindTexture(f,null),Z[e]=null);b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete ca[a.id];I.textureCount--}var R={"don't care":4352,"dont care":4352,nice:4354,fast:4353},U={repeat:10497,clamp:33071,mirror:33648},xa={nearest:9728,linear:9729},ya=c({"nearest mipmap nearest":9984,
"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},xa),za={none:0,browser:37444},ea={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},fa={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ka={};m.ext_srgb&&(fa.srgb=35904,fa.srgba=35906);m.oes_texture_float&&(ea["float"]=5126);m.oes_texture_half_float&&(ea.float16=ea["half float"]=36193);m.webgl_depth_texture&&(c(fa,{depth:6402,"depth stencil":34041}),
c(ea,{uint16:5123,uint32:5125,"depth stencil":34042}));m.webgl_compressed_texture_s3tc&&c(ka,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});m.webgl_compressed_texture_atc&&c(ka,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});m.webgl_compressed_texture_pvrtc&&c(ka,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});m.webgl_compressed_texture_etc1&&(ka["rgb etc1"]=
36196);var Ha=Array.prototype.slice.call(b.getParameter(34467));Object.keys(ka).forEach(function(a){var b=ka[a];0<=Ha.indexOf(b)&&(fa[a]=b)});var Ea=Object.keys(fa);h.textureFormats=Ea;var Ba=Ea.reduce(function(a,b){var c=fa[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Fa=[],Ga=[],la=[],ma=0,ca={},ua=h.maxTextureUnits,Z=Array(ua).map(function(){return null});c(ta.prototype,{bind:function(){this.bindCount+=1;
var a=this.unit;if(0>a){for(var c=0;c<ua;++c){var e=Z[c];if(e){if(0<e.bindCount)continue;e.unit=-1}Z[c]=this;a=c;break}L.profile&&I.maxTextureUnits<a+1&&(I.maxTextureUnits=a+1);this.unit=a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&aa(this)}});L.profile&&(I.getTotalTextureSize=function(){var a=0;Object.keys(ca).forEach(function(b){a+=ca[b].stats.size});return a});return{create2D:function(a,c){function f(a,
b){var c=ba(),d=ra();"number"===typeof a?"number"===typeof b?N(d,a|0,b|0):N(d,a|0,a|0):a?(sa(c,a),Q(d,a)):N(d,1,1);c.genMipmaps&&(d.mipmask=(d.width<<1)-1);g.mipmask=d.mipmask;J(g,d);g.internalformat=d.internalformat;f.width=d.width;f.height=d.height;S(g);ha(d,3553);ja(c,3553);E();la.push(c);wa(d);L.profile&&(g.stats.size=e(g.internalformat,g.type,d.width,d.height,c.genMipmaps,!1));return f}var g=new ta(3553);ca[g.id]=g;I.textureCount++;f(a,c);f.subimage=function(a,b,c,d){b|=0;c|=0;d|=0;var e=Y();
J(e,g);e.width>>=d;e.height>>=d;e.width-=b;e.height-=c;D(e,a);S(g);W(e,3553,b,c,d);E();P(e);return f};f.resize=function(a,c){var m=a|0,d=c|0||m;if(m===g.width&&d===g.height)return f;f.width=g.width=m;f.height=g.height=d;S(g);for(var l=0;g.mipmask>>l;++l)b.texImage2D(3553,l,g.format,m>>l,d>>l,0,g.format,g.type,null);E();L.profile&&(g.stats.size=e(g.internalformat,g.type,m,d,!1,!1));return f};f._reglType="texture2d";f._texture=g;L.profile&&(f.stats=g.stats);f.destroy=function(){g.decRef()};return f},
createCube:function(a,c,f,g,m,h){function k(a,b,c,f,g,m){var l,h=ba();for(l=0;6>l;++l)p[l]=ra();if("number"===typeof a||!a)for(a=a|0||1,l=0;6>l;++l)N(p[l],a,a);else if("object"===typeof a)if(b)Q(p[0],a),Q(p[1],b),Q(p[2],c),Q(p[3],f),Q(p[4],g),Q(p[5],m);else if(sa(h,a),H(d,a),"faces"in a)for(a=a.faces,l=0;6>l;++l)J(p[l],d),Q(p[l],a[l]);else for(l=0;6>l;++l)Q(p[l],a);J(d,p[0]);d.mipmask=h.genMipmaps?(p[0].width<<1)-1:p[0].mipmask;d.internalformat=p[0].internalformat;k.width=p[0].width;k.height=p[0].height;
S(d);for(l=0;6>l;++l)ha(p[l],34069+l);ja(h,34067);E();L.profile&&(d.stats.size=e(d.internalformat,d.type,k.width,k.height,h.genMipmaps,!0));la.push(h);for(l=0;6>l;++l)wa(p[l]);return k}var d=new ta(34067);ca[d.id]=d;I.cubeCount++;var p=Array(6);k(a,c,f,g,m,h);k.subimage=function(a,b,c,e,f){c|=0;e|=0;f|=0;var g=Y();J(g,d);g.width>>=f;g.height>>=f;g.width-=c;g.height-=e;D(g,b);S(d);W(g,34069+a,c,e,f);E();P(g);return k};k.resize=function(a){a|=0;if(a!==d.width){k.width=d.width=a;k.height=d.height=a;
S(d);for(var c=0;6>c;++c)for(var f=0;d.mipmask>>f;++f)b.texImage2D(34069+c,c,d.format,a>>c,a>>c,0,d.format,d.type,null);E();L.profile&&(d.stats.size=e(d.internalformat,d.type,k.width,k.height,!1,!0));return k}};k._reglType="textureCube";k._texture=d;L.profile&&(k.stats=d.stats);k.destroy=function(){d.decRef()};return k},clear:function(){for(var a=0;a<ua;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),Z[a]=null;u(ca).forEach(aa);I.cubeCount=0;I.textureCount=0},getTexture:function(a){return null}}}},
{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(h,q,x){q.exports=function(k,a){function h(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function q(a,c,e){var f=u.pop()||new h;f.startQueryIndex=a;f.endQueryIndex=c;f.sum=0;f.stats=e;A.push(f)}var f=a.ext_disjoint_timer_query;if(!f)return null;var e=[],c=[],u=[],A=[],G=
[],C=[];return{beginQuery:function(a){var k=e.pop()||f.createQueryEXT();f.beginQueryEXT(35007,k);c.push(k);q(c.length-1,c.length,a)},endQuery:function(){f.endQueryEXT(35007)},pushScopeStats:q,update:function(){var a,k;a=c.length;if(0!==a){C.length=Math.max(C.length,a+1);G.length=Math.max(G.length,a+1);G[0]=0;var h=C[0]=0;for(k=a=0;k<c.length;++k){var r=c[k];f.getQueryObjectEXT(r,34919)?(h+=f.getQueryObjectEXT(r,34918),e.push(r)):c[a++]=r;G[k+1]=h;C[k+1]=a}c.length=a;for(k=a=0;k<A.length;++k){var h=
A[k],g=h.startQueryIndex,r=h.endQueryIndex;h.sum+=G[r]-G[g];g=C[g];r=C[r];r===g?(h.stats.gpuTime+=h.sum/1E6,u.push(h)):(h.startQueryIndex=g,h.endQueryIndex=r,A[a++]=h)}A.length=a}},getNumPendingQueries:function(){return c.length},clear:function(){e.push.apply(e,c);for(var a=0;a<e.length;a++)f.deleteQueryEXT(e[a]);c.length=0;e.length=0}}}},{}],21:[function(h,q,x){q.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(h,
q,x){function k(a){return Array.prototype.slice.call(a)}function a(a){return k(a).join("")}var r=h("./extend");q.exports=function(){function h(){var c=[],f=[];return r(function(){c.push.apply(c,k(arguments))},{def:function(){var a="v"+e++;f.push(a);0<arguments.length&&(c.push(a,"="),c.push.apply(c,k(arguments)),c.push(";"));return a},toString:function(){return a([0<f.length?"var "+f+";":"",a(c)])}})}function f(){function a(f,k){e(f,k,"=",c.def(f,k),";")}var c=h(),e=h(),f=c.toString,q=e.toString;return r(function(){c.apply(c,
k(arguments))},{def:c.def,entry:c,exit:e,save:a,set:function(e,f,k){a(e,f);c(e,f,"=",k,";")},toString:function(){return f()+q()}})}var e=0,c=[],q=[],A=h(),G={};return{global:A,link:function(a){for(var f=0;f<q.length;++f)if(q[f]===a)return c[f];f="g"+e++;c.push(f);q.push(a);return f},block:h,proc:function(c,e){function k(){var a="a"+h.length;h.push(a);return a}var h=[];e=e||0;for(var q=0;q<e;++q)k();var q=f(),g=q.toString;return G[c]=r(q,{arg:k,toString:function(){return a(["function(",h.join(),"){",
g(),"}"])}})},scope:f,cond:function(){var c=a(arguments),e=f(),h=f(),q=e.toString,u=h.toString;return r(e,{then:function(){e.apply(e,k(arguments));return this},"else":function(){h.apply(h,k(arguments));return this},toString:function(){var e=u();e&&(e="else{"+e+"}");return a(["if(",c,"){",q(),"}",e])}})},compile:function(){var e=['"use strict";',A,"return {"];Object.keys(G).forEach(function(a){e.push('"',a,'":',G[a].toString(),",")});e.push("}");var f=a(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,
"{\n");return Function.apply(null,c.concat(f)).apply(null,q)}}}},{"./extend":23}],23:[function(h,q,x){q.exports=function(h,a){for(var r=Object.keys(a),q=0;q<r.length;++q)h[r[q]]=a[r[q]];return h}},{}],24:[function(h,q,x){var k=h("./is-typed-array");q.exports=function(a){return Array.isArray(a)||k(a)}},{"./is-typed-array":26}],25:[function(h,q,x){var k=h("./is-typed-array");q.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&
a.shape.length===a.stride.length&&(Array.isArray(a.data)||k(a.data))}},{"./is-typed-array":26}],26:[function(h,q,x){var k=h("../constants/arraytypes.json");q.exports=function(a){return Object.prototype.toString.call(a)in k}},{"../constants/arraytypes.json":4}],27:[function(h,q,x){q.exports=function(h,a){for(var q=Array(h),z=0;z<h;++z)q[z]=a(z);return q}},{}],28:[function(h,q,x){function k(a){var e,c;e=(65535<a)<<4;a>>>=e;c=(255<a)<<3;a>>>=c;e|=c;c=(15<a)<<2;a>>>=c;e|=c;c=(3<a)<<1;return e|c|a>>>c>>
1}function a(a){a:{for(var e=16;268435456>=e;e*=16)if(a<=e){a=e;break a}a=0}e=z[k(a)>>2];return 0<e.length?e.pop():new ArrayBuffer(a)}function r(a){z[k(a.byteLength)>>2].push(a)}var z=h("./loop")(8,function(){return[]});q.exports={alloc:a,free:r,allocType:function(f,e){var c=null;switch(f){case 5120:c=new Int8Array(a(e),0,e);break;case 5121:c=new Uint8Array(a(e),0,e);break;case 5122:c=new Int16Array(a(2*e),0,e);break;case 5123:c=new Uint16Array(a(2*e),0,e);break;case 5124:c=new Int32Array(a(4*e),
0,e);break;case 5125:c=new Uint32Array(a(4*e),0,e);break;case 5126:c=new Float32Array(a(4*e),0,e);break;default:return null}return c.length!==e?c.subarray(0,e):c},freeType:function(a){r(a.buffer)}}},{"./loop":27}],29:[function(h,q,x){q.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(h){return requestAnimationFrame(h)},cancel:function(h){return cancelAnimationFrame(h)}}:{next:function(h){return setTimeout(h,16)},cancel:clearTimeout}},{}],30:[function(h,
q,x){var k=h("./pool"),a=new Float32Array(1),r=new Uint32Array(a.buffer);q.exports=function(h){for(var f=k.allocType(5123,h.length),e=0;e<h.length;++e)if(isNaN(h[e]))f[e]=65535;else if(Infinity===h[e])f[e]=31744;else if(-Infinity===h[e])f[e]=64512;else{a[0]=h[e];var c=r[0],q=c>>>31<<15,A=(c<<1>>>24)-127,c=c>>13&1023;f[e]=-24>A?q:-14>A?q+(c+1024>>-14-A):15<A?q+31744:q+(A+15<<10)+c}return f}},{"./pool":28}],31:[function(h,q,x){q.exports=function(h){return Object.keys(h).map(function(a){return h[a]})}},
{}],32:[function(h,q,x){function k(a,c,h){function k(){var c=window.innerWidth,r=window.innerHeight;a!==document.body&&(r=a.getBoundingClientRect(),c=r.right-r.left,r=r.top-r.bottom);q.width=h*c;q.height=h*r;f(q.style,{width:c+"px",height:r+"px"})}var q=document.createElement("canvas");f(q.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(q);a===document.body&&(q.style.position="absolute",f(a.style,{margin:0,padding:0}));window.addEventListener("resize",k,!1);k();return{canvas:q,onDestroy:function(){window.removeEventListener("resize",
k);a.removeChild(q)}}}function a(a,c){function f(h){try{return a.getContext(h,c)}catch(k){return null}}return f("webgl")||f("experimental-webgl")||f("webgl-experimental")}function r(a){return"string"===typeof a?a.split():a}function z(a){return"string"===typeof a?document.querySelector(a):a}var f=h("./util/extend");q.exports=function(e){var c=e||{},f,h,q,C;e={};var t=[],x=[],v="undefined"===typeof window?1:window.devicePixelRatio,B=!1,g=function(a){},p=function(){};"string"===typeof c?f=document.querySelector(c):
"object"===typeof c&&("string"===typeof c.nodeName&&"function"===typeof c.appendChild&&"function"===typeof c.getBoundingClientRect?f=c:"function"===typeof c.drawArrays||"function"===typeof c.drawElements?(C=c,q=C.canvas):("gl"in c?C=c.gl:"canvas"in c?q=z(c.canvas):"container"in c&&(h=z(c.container)),"attributes"in c&&(e=c.attributes),"extensions"in c&&(t=r(c.extensions)),"optionalExtensions"in c&&(x=r(c.optionalExtensions)),"onDone"in c&&(g=c.onDone),"profile"in c&&(B=!!c.profile),"pixelRatio"in c&&
(v=+c.pixelRatio)));f&&("canvas"===f.nodeName.toLowerCase()?q=f:h=f);if(!C){if(!q){f=k(h||document.body,g,v);if(!f)return null;q=f.canvas;p=f.onDestroy}C=a(q,e)}return C?{gl:C,canvas:q,container:h,extensions:t,optionalExtensions:x,pixelRatio:v,profile:B,onDone:g,onDestroy:p}:(p(),g("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],33:[function(h,q,x){q.exports=function(a,h){function q(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==
p.alt,p.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==p.shift,p.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==p.control,p.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==p.meta,p.meta=!!a.metaKey);return b}function f(a,b){var c=k.x(b),e=k.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==v||c!==B||e!==g||q(b))v=a|0,B=c||0,g=e||0,h&&h(v,B,g,p)}function e(a){f(0,a)}function c(){if(v||B||g||p.shift||p.alt||p.meta||p.control)v=B=g=0,p.shift=p.alt=p.control=p.meta=!1,h&&h(0,0,0,p)}function u(a){q(a)&&
h&&h(v,B,g,p)}function A(a){0===k.buttons(a)?f(0,a):f(v,a)}function x(a){f(v|k.buttons(a),a)}function C(a){f(v&~k.buttons(a),a)}function t(){L||(L=!0,a.addEventListener("mousemove",A),a.addEventListener("mousedown",x),a.addEventListener("mouseup",C),a.addEventListener("mouseleave",e),a.addEventListener("mouseenter",e),a.addEventListener("mouseout",e),a.addEventListener("mouseover",e),a.addEventListener("blur",c),a.addEventListener("keyup",u),a.addEventListener("keydown",u),a.addEventListener("keypress",
u),a!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}function K(){L&&(L=!1,a.removeEventListener("mousemove",A),a.removeEventListener("mousedown",x),a.removeEventListener("mouseup",C),a.removeEventListener("mouseleave",e),a.removeEventListener("mouseenter",e),a.removeEventListener("mouseout",e),a.removeEventListener("mouseover",e),a.removeEventListener("blur",c),a.removeEventListener("keyup",
u),a.removeEventListener("keydown",u),a.removeEventListener("keypress",u),a!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))}h||(h=a,a=window);var v=0,B=0,g=0,p={shift:!1,alt:!1,control:!1,meta:!1},L=!1;t();var I={element:a};Object.defineProperties(I,{enabled:{get:function(){return L},set:function(a){a?t():K},enumerable:!0},buttons:{get:function(){return v},enumerable:!0},x:{get:function(){return B},
enumerable:!0},y:{get:function(){return g},enumerable:!0},mods:{get:function(){return p},enumerable:!0}});return I};var k=h("mouse-event")},{"mouse-event":34}],34:[function(h,q,x){function k(a){return a.target||a.srcElement||window}x.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};x.element=
k;x.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var h=k(a).getBoundingClientRect();return a.clientX-h.left}return 0};x.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var h=k(a).getBoundingClientRect();return a.clientY-h.top}return 0}},{}],35:[function(h,q,x){function k(a,c){for(var e=0;e<a.length;++e)if(a[e]===c)return e;return-1}var a=h("./lib/util/extend"),r=h("./lib/dynamic"),z=h("./lib/util/raf"),f=h("./lib/util/clock"),e=h("./lib/strings"),
c=h("./lib/webgl"),u=h("./lib/extension"),A=h("./lib/limits"),G=h("./lib/buffer"),C=h("./lib/elements"),t=h("./lib/texture"),K=h("./lib/renderbuffer"),v=h("./lib/framebuffer"),B=h("./lib/attribute"),g=h("./lib/shader"),p=h("./lib/read"),L=h("./lib/core"),I=h("./lib/stats"),m=h("./lib/timer");q.exports=function(b){function h(){if(0===E.length)W&&W.update(),aa=null;else{aa=z.next(h);pa();for(var a=E.length-1;0<=a;--a){var b=E[a];b&&b(N,null,0)}H.flush();W&&W.update()}}function q(a){}function x(a){}
function oa(b){function c(a){var b={},e={};Object.keys(a).forEach(function(c){var f=a[c];r.isDynamic(f)?e[c]=r.unbox(f,c):b[c]=f});return{dynamic:e,"static":b}}function e(a){for(;t.length<a;)t.push(null);return t}var f=c(b.context||{}),g=c(b.uniforms||{}),h=c(b.attributes||{}),k=c(function(b){function c(a){if(a in e){var b=e[a];delete e[a];Object.keys(b).forEach(function(c){e[a+"."+c]=b[c]})}}var e=a({},b);delete e.uniforms;delete e.attributes;delete e.context;c("blend");c("depth");c("cull");c("stencil");
c("polygonOffset");c("scissor");c("sample");return e}(b));b={gpuTime:0,cpuTime:0,count:0};var f=ba.compile(k,h,g,f,b),m=f.draw,p=f.batch,q=f.scope,t=[];return a(function(a,b){var c;if("function"===typeof a)return q.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)q.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)q.call(this,a[c],b,c);else return q.call(this,a,b,0);else if("number"===typeof a){if(0<a)return p.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return p.call(this,
a,a.length)}else return m.call(this,a)},{stats:b})}function va(){var a=ta.viewport,b=ta.scissor_box;a[0]=a[1]=b[0]=b[1]=0;N.viewportWidth=N.framebufferWidth=N.drawingBufferWidth=a[2]=b[2]=H.drawingBufferWidth;N.viewportHeight=N.framebufferHeight=N.drawingBufferHeight=a[3]=b[3]=H.drawingBufferHeight}function pa(){N.tick+=1;N.time=(f()-Y)/1E3;va();ba.procs.poll()}function da(){va();ba.procs.refresh();W&&W.update()}var J=c(b);if(!J)return null;var H=J.gl;b=H.getContextAttributes();var T=u(H,J);if(!T)return null;
var ga=e(),D=I(),T=T.extensions,W=m(H,T),Y=f(),P=H.drawingBufferWidth,M=H.drawingBufferHeight,N={tick:0,time:0,viewportWidth:P,viewportHeight:M,framebufferWidth:P,framebufferHeight:M,drawingBufferWidth:P,drawingBufferHeight:M,pixelRatio:J.pixelRatio},Q=A(H,T),ha=G(H,D,J),ra=C(H,T,ha,D),P=B(H,T,Q,ha,ga),wa=g(H,ga,D,J),ia=t(H,T,Q,function(){ba.procs.poll()},N,D,J),sa=K(H,T,Q,D,J),ja=v(H,T,Q,ia,sa,D),ba=L(H,ga,T,Q,ha,ra,ia,ja,{},P,wa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},N,W,J),
ga=p(H,ja,ba.procs.poll,N,b,T),ta=ba.next,S=H.canvas,E=[],aa=null;S&&(S.addEventListener("webglcontextlost",q,!1),S.addEventListener("webglcontextrestored",x,!1));da();b=a(oa,{clear:function(a){var b=0;ba.procs.poll();var c=a.color;c&&(H.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(H.clearDepth(+a.depth),b|=256);"stencil"in a&&(H.clearStencil(a.stencil|0),b|=1024);H.clear(b)},prop:r.define.bind(null,1),context:r.define.bind(null,2),"this":r.define.bind(null,3),draw:oa({}),
buffer:function(a){return ha.create(a,34962)},elements:ra.create,texture:ia.create2D,cube:ia.createCube,renderbuffer:sa.create,framebuffer:ja.create,framebufferCube:ja.createCube,attributes:b,frame:function(a){E.push(a);!aa&&0<E.length&&(aa=z.next(h));return{cancel:function(){function b(){var a=k(E,b);E[a]=E[E.length-1];--E.length;0>=E.length&&aa&&(z.cancel(h),aa=null)}var c=k(E,a);E[c]=b}}},limits:Q,hasExtension:function(a){return 0<=Q.extensions.indexOf(a.toLowerCase())},read:ga,destroy:function(){E.length=
0;aa&&(z.cancel(h),aa=null);S&&(S.removeEventListener("webglcontextlost",q),S.removeEventListener("webglcontextrestored",x));wa.clear();ja.clear();sa.clear();ia.clear();ra.clear();ha.clear();W&&W.clear();J.onDestroy()},_gl:H,_refresh:da,poll:function(){pa();W&&W.update()},stats:D});J.onDone(null,b);return b}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,
"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);
