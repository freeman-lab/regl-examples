(function e$$0(m,v,g){function a(d,e){if(!v[d]){if(!m[d]){var c="function"==typeof require&&require;if(!e&&c)return c(d,!0);if(r)return r(d,!0);c=Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c;}c=v[d]={exports:{}};m[d][0].call(c.exports,function(e){var g=m[d][1][e];return a(g?g:e)},c,c.exports,e$$0,m,v,g)}return v[d].exports}for(var r="function"==typeof require&&require,E=0;E<g.length;E++)a(g[E]);return a})({1:[function(h,m,v){var g=h("../regl")(),a=h("mouse-change")(),r=g.texture(),
E=g({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 mouse;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    float dist = length(gl_FragCoord.xy - mouse);\n    gl_FragColor = vec4(0.98 * texture2D(texture,\n      uv + cos(t) * vec2(0.5 - uv.y, uv.x - 0.5) - sin(2.0 * t) * (uv - 0.5)).rgb, 1) +\n      exp(-0.01 * dist) * vec4(\n        1.0 + cos(2.0 * t),\n        1.0 + cos(2.0 * t + 1.5),\n        1.0 + cos(2.0 * t + 3.0),\n        0.0);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:r,mouse:function(d){var e=d.pixelRatio;return[a.x*e,d.viewportHeight-a.y*e]},t:function(a){return.01*a.tick}},count:3});g.frame(function(){g.clear({color:[0,0,0,1]});E();r({copy:!0})})},{"../regl":35,"mouse-change":33}],2:[function(h,m,v){function g(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(a,r,E,d,e){a=E.maxAttributes;r=
Array(a);for(E=0;E<a;++E)r[E]=new g;return{Record:g,scope:{},state:r}}},{}],3:[function(h,m,v){function g(a){return y[Object.prototype.toString.call(a)]|0}function a(a,d){for(var e=0;e<d.length;++e)a[e]=d[e]}function r(a,d,e,g,c,k,b){for(var r=0,p=0;p<e;++p)for(var M=0;M<g;++M)a[r++]=d[c*p+k*M+b]}function E(a,d,e){for(var g=0,c=0;c<d.length;++c)for(var k=d[c],b=0;b<e;++b)a[g++]=k[b]}var d=h("./util/is-typed-array"),e=h("./util/is-ndarray"),c=h("./util/values"),t=h("./util/pool"),y=h("./constants/arraytypes.json"),
B=h("./constants/dtypes.json"),F=h("./constants/usage.json");m.exports=function(z,h){function n(a){this.id=b++;this.buffer=z.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function q(a,d,e){a.byteLength=d.byteLength;z.bufferData(a.type,d,e)}function C(b,c,p,k,n){b.usage=p;if(Array.isArray(c))b.dtype=k||5126,0<c.length&&(Array.isArray(c[0])?(b.dimension=c[0].length,k=t.allocType(b.dtype,c.length*b.dimension),E(k,c,b.dimension),q(b,k,p),t.freeType(k)):
"number"===typeof c[0]?(b.dimension=n,k=t.allocType(b.dtype,c.length),a(k,c),q(b,k,p),t.freeType(k)):d(c[0])&&(b.dimension=c[0].length,b.dtype=k||g(c[0])||5126,k=t.allocType(b.dtype,c.length*b.dimension),E(k,c,b.dimension),q(b,k,p),t.freeType(k)));else if(d(c))b.dtype=k||g(c),b.dimension=n,q(b,c,p);else if(e(c)){var h=c.shape,z=c.stride;n=c.offset;var C=0,A=0,m=0,F=0;1===h.length?(C=h[0],A=1,m=z[0],F=0):2===h.length&&(C=h[0],A=h[1],m=z[0],F=z[1]);b.dtype=k||g(c.data)||5126;b.dimension=A;k=t.allocType(b.dtype,
C*A);r(k,c.data,C,A,m,F,n);q(b,k,p);t.freeType(k)}}function k(a){h.bufferCount--;z.deleteBuffer(a.buffer);a.buffer=null;delete m[a.id]}var b=0,m={};n.prototype.bind=function(){z.bindBuffer(this.type,this.buffer)};n.prototype.destroy=function(){k(this)};var p=[];return{create:function(b,c,p){function q(a){var b=35044,c=null,g=0,k=0,p=1;Array.isArray(a)||d(a)||e(a)?c=a:"number"===typeof a?g=a|0:a&&("data"in a&&(c=a.data),"usage"in a&&(b=F[a.usage]),"type"in a&&(k=B[a.type]),"dimension"in a&&(p=a.dimension|
0),"length"in a&&(g=a.length|0));y.bind();c?C(y,c,b,k,p):(z.bufferData(y.type,g,b),y.dtype=k||5121,y.usage=b,y.dimension=p,y.byteLength=g);return q}h.bufferCount++;var y=new n(c);m[y.id]=y;p||q(b);q._reglType="buffer";q._buffer=y;q.subdata=function(b,c){var k=(c||0)|0;y.bind();if(Array.isArray(b)){if(0<b.length)if("number"===typeof b[0]){var p=t.allocType(y.dtype,b.length);a(p,b);z.bufferSubData(y.type,k,p);t.freeType(p)}else if(Array.isArray(b[0])||d(b[0])){var p=b[0].length,h=t.allocType(y.dtype,
b.length*p);E(h,b,p);z.bufferSubData(y.type,k,h);t.freeType(h)}}else if(d(b))z.bufferSubData(y.type,k,b);else if(e(b)){var n=b.shape,M=b.stride,C=h=p=0,m=0;1===n.length?(p=n[0],h=1,C=M[0],m=0):2===n.length&&(p=n[0],h=n[1],C=M[0],m=M[1]);n=Array.isArray(b.data)?y.dtype:g(b.data);n=t.allocType(n,p*h);r(n,b.data,p,h,C,m,b.offset);z.bufferSubData(y.type,k,n);t.freeType(n)}return q};q.destroy=function(){k(y)};return q},createStream:function(a,b){var d=p.pop();d||(d=new n(a),d.buffer=z.createBuffer());
d.bind();C(d,b,35040,0,1);return d},destroyStream:function(a){p.push(a)},clear:function(){c(m).forEach(k)},getBuffer:function(a){return a&&a._buffer instanceof n?a._buffer:null},_initBuffer:C}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(h,m,v){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,
"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(h,m,v){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(h,m,v){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(h,m,v){m.exports={"static":35044,
dynamic:35048,stream:35040}},{}],8:[function(h,m,v){function g(a){return Array.isArray(a)||y(a)||B(a)}function a(a){return a.sort(function(a,d){return"viewport"===a?-1:"viewport"===d?1:a<d?-1:1})}function r(a,d,b,e){this.thisDep=a;this.contextDep=d;this.propDep=b;this.append=e}function E(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function d(a){return new r(!1,!1,!1,a)}function e(a,d){var b=a.type;return 0===b?(b=a.data.length,new r(!0,1<=b,2<=b,d)):new r(3===b,2===b,1===b,d)}var c=h("./util/codegen"),
t=h("./util/loop"),y=h("./util/is-typed-array"),B=h("./util/is-ndarray"),F=h("./util/is-array-like"),z=h("./constants/primitives.json"),K=h("./constants/dtypes.json"),n=["x","y","z","w"],q={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},
C={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},k={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},b={cw:2304,ccw:2305},ba=new r(!1,!1,!1,function(){});m.exports=function(p,h,m,y,B,v,ca,ia,R,A,Q,S,T,ra,X){function N(a){return a.replace(".","_")}function J(a,f,b){var d=N(a);Da.push(a);wa[d]=ma[d]=!!b;na[d]=
f}function I(a,f,d){var b=N(a);Da.push(a);Array.isArray(d)?(ma[b]=d.slice(),wa[b]=d.slice()):ma[b]=wa[b]=d;oa[b]=f}function Y(){var a=c(),f=a.link,b=a.global;a.id=La++;a.batchId="0";var d=f(Ia),D=a.shared={props:"a0"};Object.keys(Ia).forEach(function(l){D[l]=b.def(d,".",l)});var e=a.next={},k=a.current={};Object.keys(oa).forEach(function(l){Array.isArray(ma[l])&&(e[l]=b.def(D.next,".",l),k[l]=b.def(D.current,".",l))});var l=a.constants={};Object.keys(Ea).forEach(function(a){l[a]=b.def(JSON.stringify(Ea[a]))});
a.invoke=function(l,b){switch(b.type){case 0:var d=["this",D.context,D.props,a.batchId];return l.def(f(b.data),".call(",d.slice(0,Math.max(b.data.length+1,4)),")");case 1:return l.def(D.props,b.data);case 2:return l.def(D.context,b.data);case 3:return l.def("this",b.data)}};a.attribCache={};var Ga={};a.scopeAttrib=function(l){l=h.id(l);if(l in Ga)return Ga[l];var a=A.scope[l];a||(a=A.scope[l]=new da);return Ga[l]=f(a)};return a}function pa(a){var f=a["static"];a=a.dynamic;var b;if("profile"in f){var c=
!!f.profile;b=d(function(a,f){return c});b.enable=c}else if("profile"in a){var D=a.profile;b=e(D,function(a,f){return a.invoke(f,D)})}return b}function sa(a){var f=a["static"];a=a.dynamic;if("framebuffer"in f){var b=f.framebuffer;return b?(b=ia.getFramebuffer(b),d(function(a,f){var w=a.link(b),l=a.shared;f.set(l.framebuffer,".next",w);l=l.context;f.set(l,".framebufferWidth",w+".width");f.set(l,".framebufferHeight",w+".height");return w})):d(function(a,f){var b=a.shared;f.set(b.framebuffer,".next",
"null");b=b.context;f.set(b,".framebufferWidth",b+".drawingBufferWidth");f.set(b,".framebufferHeight",b+".drawingBufferHeight");return"null"})}if("framebuffer"in a){var c=a.framebuffer;return e(c,function(a,f){var b=a.invoke(f,c),l=a.shared,w=l.framebuffer,b=f.def(w,".getFramebuffer(",b,")");f.set(w,".next",b);l=l.context;f.set(l,".framebufferWidth",b+"?"+b+".width:"+l+".drawingBufferWidth");f.set(l,".framebufferHeight",b+"?"+b+".height:"+l+".drawingBufferHeight");return b})}return null}function ja(a,
f){function b(l){if(l in d){var a=d[l];l=!0;var w=a.x|0,c=a.y|0,Ca,k;"width"in a?Ca=a.width|0:l=!1;"height"in a?k=a.height|0:l=!1;return new r(!l&&f&&f.thisDep,!l&&f&&f.contextDep,!l&&f&&f.propDep,function(l,f){var b=l.shared.context,d=Ca;"width"in a||(d=f.def(b,".","framebufferWidth","-",w));var G=k;"height"in a||(G=f.def(b,".","framebufferHeight","-",c));return[w,c,d,G]})}if(l in D){var Ja=D[l];l=e(Ja,function(a,l){var f=a.invoke(l,Ja),b=a.shared.context,w=l.def(f,".x|0"),d=l.def(f,".y|0"),G=l.def('"width" in ',
f,"?",f,".width|0:","(",b,".","framebufferWidth","-",w,")"),f=l.def('"height" in ',f,"?",f,".height|0:","(",b,".","framebufferHeight","-",d,")");return[w,d,G,f]});f&&(l.thisDep=l.thisDep||f.thisDep,l.contextDep=l.contextDep||f.contextDep,l.propDep=l.propDep||f.propDep);return l}return f?new r(f.thisDep,f.contextDep,f.propDep,function(a,l){var f=a.shared.context;return[0,0,l.def(f,".","framebufferWidth"),l.def(f,".","framebufferHeight")]}):null}var d=a["static"],D=a.dynamic,c=b("viewport");if(c)var k=
c,c=new r(c.thisDep,c.contextDep,c.propDep,function(a,f){var b=k.append(a,f),w=a.shared.context;f.set(w,".viewportWidth",b[2]);f.set(w,".viewportHeight",b[3]);return b});return{viewport:c,scissor_box:b("scissor.box")}}function qa(a){function f(a){if(a in b){var w=h.id(b[a]);a=d(function(){return w});a.id=w;return a}if(a in c){var G=c[a];return e(G,function(a,l){var f=a.invoke(l,G);return l.def(a.shared.strings,".id(",f,")")})}return null}var b=a["static"],c=a.dynamic,D=f("frag"),k=f("vert"),g=null;
E(D)&&E(k)?(g=Q.program(k.id,D.id),a=d(function(a,f){return a.link(g)})):a=new r(D&&D.thisDep||k&&k.thisDep,D&&D.contextDep||k&&k.contextDep,D&&D.propDep||k&&k.propDep,function(a,f){var b=a.shared.shader,w;w=D?D.append(a,f):f.def(b,".","frag");var d;d=k?k.append(a,f):f.def(b,".","vert");return f.def(b+".program("+d+","+w+")")});return{frag:D,vert:k,progVar:a,program:g}}function la(a){function f(a,l){if(a in b){var w=b[a]|0;return d(function(a,f){l&&(a.OFFSET=w);return w})}if(a in c){var G=c[a];return e(G,
function(a,f){var b=a.invoke(f,G);l&&(a.OFFSET=b);return b})}return l&&D?d(function(a,f){a.OFFSET="0";return 0}):null}var b=a["static"],c=a.dynamic,D=function(){if("elements"in b){var a=b.elements;g(a)?a=v.getElements(v.create(a)):a&&(a=v.getElements(a));var f=d(function(f,l){if(a){var b=f.link(a);return f.ELEMENTS=b}return f.ELEMENTS=null});f.value=a;return f}if("elements"in c){var w=c.elements;return e(w,function(a,f){var l=a.shared,b=l.isBufferArgs,l=l.elements,d=a.invoke(f,w),G=f.def("null"),
b=f.def(b,"(",d,")"),d=a.cond(b).then(G,"=",l,".createStream(",d,");")["else"](G,"=",l,".getElements(",d,");");f.entry(d);f.exit(a.cond(b).then(l,".destroyStream(",G,");"));return a.ELEMENTS=G})}return null}(),k=f("offset",!0);return{elements:D,primitive:function(){if("primitive"in b){var a=b.primitive;return d(function(f,l){return z[a]})}if("primitive"in c){var f=c.primitive;return e(f,function(a,b){var w=a.constants.primTypes,d=a.invoke(b,f);return b.def(w,"[",d,"]")})}return D?E(D)?D.value?d(function(a,
f){return f.def(a.ELEMENTS,".primType")}):d(function(){return 4}):new r(D.thisDep,D.contextDep,D.propDep,function(a,f){var l=a.ELEMENTS;return f.def(l,"?",l,".primType:",4)}):null}(),count:function(){if("count"in b){var a=b.count|0;return d(function(){return a})}if("count"in c){var f=c.count;return e(f,function(a,b){return a.invoke(b,f)})}return D?E(D)?D?k?new r(k.thisDep,k.contextDep,k.propDep,function(a,f){return f.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):d(function(a,f){return f.def(a.ELEMENTS,
".vertCount")}):d(function(){return-1}):new r(D.thisDep||k.thisDep,D.contextDep||k.contextDep,D.propDep||k.propDep,function(a,f){var l=a.ELEMENTS;return a.OFFSET?f.def(l,"?",l,".vertCount-",a.OFFSET,":-1"):f.def(l,"?",l,".vertCount:-1")}):null}(),instances:f("instances",!1),offset:k}}function U(a){var G=a["static"],c=a.dynamic,g={};Da.forEach(function(a){function w(f,b){if(a in G){var k=f(G[a]);g[u]=d(function(){return k})}else if(a in c){var Ka=c[a];g[u]=e(Ka,function(a,f){return b(a,f,a.invoke(f,
Ka))})}}var u=N(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return w(function(a){return a},function(a,f,b){return b});case "depth.func":return w(function(a){return C[a]},function(a,f,b){return f.def(a.constants.compareFuncs,"[",b,"]")});case "depth.range":return w(function(a){return a},function(a,f,b){a=f.def("+",b,"[0]");f=f.def("+",
b,"[1]");return[a,f]});case "blend.func":return w(function(a){return[q["srcRGB"in a?a.srcRGB:a.src],q["dstRGB"in a?a.dstRGB:a.dst],q["srcAlpha"in a?a.srcAlpha:a.src],q["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,f,b){function w(a,l){var G=f.def('"',a,l,'" in ',b,"?",b,".",a,l,":",b,".",a);return f.def(d,"[",G,"]")}var d=a.constants.blendFuncs;a=w("src","RGB");var G=w("src","Alpha"),c=w("dst","RGB"),e=w("dst","Alpha");return[a,c,G,e]});case "blend.equation":return w(function(a){if("string"===typeof a)return[f[a],
f[a]];if("object"===typeof a)return[f[a.rgb],f[a.alpha]]},function(a,f,b){var w=a.constants.blendEquations,d=f.def(),G=f.def();a=a.cond("typeof ",b,'==="string"');a.then(d,"=",G,"=",w,"[",b,"];");a["else"](d,"=",w,"[",b,".rgb];",G,"=",w,"[",b,".alpha];");f(a);return[d,G]});case "blend.color":return w(function(a){return t(4,function(f){return+a[f]})},function(a,f,b){return t(4,function(a){return f.def("+",b,"[",a,"]")})});case "stencil.mask":return w(function(a){return a|0},function(a,f,b){return f.def(b,
"|0")});case "stencil.func":return w(function(a){return[C[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,f,b){a=f.def('"cmp" in ',b,"?",a.constants.compareFuncs,"[",b,".cmp]",":",7680);var w=f.def(b,".ref|0");f=f.def('"mask" in ',b,"?",b,".mask|0:-1");return[a,w,f]});case "stencil.opFront":case "stencil.opBack":return w(function(f){return["stencil.opBack"===a?1029:1028,k[f.fail||"keep"],k[f.zfail||"keep"],k[f.pass||"keep"]]},function(f,b,w){function d(a){return b.def('"',a,'" in ',w,"?",
G,"[",w,".",a,"]:",7680)}var G=f.constants.stencilOps;return["stencil.opBack"===a?1029:1028,d("fail"),d("zfail"),d("pass")]});case "polygonOffset.offset":return w(function(a){return[a.factor|0,a.units|0]},function(a,f,b){a=f.def(b,".factor|0");f=f.def(b,".units|0");return[a,f]});case "cull.face":return w(function(a){var f=0;"front"===a?f=1028:"back"===a&&(f=1029);return f},function(a,f,b){return f.def(b,'==="front"?',1028,":",1029)});case "lineWidth":return w(function(a){return a},function(a,f,b){return b});
case "frontFace":return w(function(a){return b[a]},function(a,f,b){return f.def(b+'==="cw"?2304:2305')});case "colorMask":return w(function(a){return a.map(function(a){return!!a})},function(a,f,b){return t(4,function(a){return"!!"+b+"["+a+"]"})});case "sample.coverage":return w(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,f,b){a=f.def('"value" in ',b,"?+",b,".value:1");f=f.def("!!",b,".invert");return[a,f]})}});return g}function ea(a){var f=a["static"],b=a.dynamic,c={};Object.keys(f).forEach(function(a){var b=
f[a],w;"number"===typeof b||"boolean"===typeof b?w=d(function(){return b}):"function"!==typeof b||"texture2d"!==b._reglType&&"textureCube"!==b._reglType?F(b)&&(w=d(function(a){return a.global.def("[",t(b.length,function(a){return b[a]}),"]")})):w=d(function(a){return a.link(b)});w.value=b;c[a]=w});Object.keys(b).forEach(function(a){var f=b[a];c[a]=e(f,function(a,b){return a.invoke(b,f)})});return c}function fa(a){var f=a["static"],b=a.dynamic,c={};Object.keys(f).forEach(function(a){var b=f[a],w=h.id(a),
l=new da;if(g(b))l.state=1,l.buffer=B.getBuffer(B.create(b,34962,!1)),l.type=l.buffer.dtype;else{var e=B.getBuffer(b);if(e)l.state=1,l.buffer=e,l.type=e.dtype;else if(b.constant){var k=b.constant;l.state=2;"number"===typeof k?l.x=k:n.forEach(function(a,f){f<k.length&&(l[a]=k[f])})}else{var e=B.getBuffer(b.buffer),u=b.offset|0,Ca=b.stride|0,x=b.size|0,p=!!b.normalized,q=0;"type"in b&&(q=K[b.type]);b=b.divisor|0;l.buffer=e;l.state=1;l.size=x;l.normalized=p;l.type=q||e.dtype;l.offset=u;l.stride=Ca;l.divisor=
b}}c[a]=d(function(a,f){var b=a.attribCache;if(w in b)return b[w];var d={isStream:!1};Object.keys(l).forEach(function(a){d[a]=l[a]});l.buffer&&(d.buffer=a.link(l.buffer));return b[w]=d})});Object.keys(b).forEach(function(a){var f=b[a];c[a]=e(f,function(a,b){function w(a){b(k[a],"=",d,".",a,"|0;")}var d=a.invoke(b,f),G=a.shared,c=G.isBufferArgs,e=G.buffer,k={isStream:b.def(!1)},D=new da;D.state=1;Object.keys(D).forEach(function(a){k[a]=b.def(""+D[a])});var g=k.buffer,u=k.type;b("if(",c,"(",d,")){",
k.isStream,"=true;",g,"=",e,".createStream(",34962,",",d,");",u,"=",g,".dtype;","}else{",g,"=",e,".getBuffer(",d,");","if(",g,"){",u,"=",g,".dtype;","}else if(",d,".constant){",k.state,"=",2,";",n.map(function(a,f){return k[a]+"="+d+".length>="+f+"?"+d+"["+f+"]:0;"}).join(""),"}else{",g,"=",e,".getBuffer(",d,".buffer);",u,'="type" in ',d,"?",G.glTypes,"[",d,".type]:",g,".dtype;",k.normalized,"=!!",d,".normalized;");w("size");w("offset");w("stride");w("divisor");b("}}");return k})});return c}function ga(a){var f=
a["static"],b=a.dynamic,c={};Object.keys(f).forEach(function(a){var b=f[a];c[a]=d(function(a,f){return"number"===typeof b||"boolean"===typeof b?""+b:a.link(b)})});Object.keys(b).forEach(function(a){var f=b[a];c[a]=e(f,function(a,b){return a.invoke(b,f)})});return c}function H(a,f,b){var d=a.shared.context,c=a.scope();Object.keys(b).forEach(function(e){f.save(d,"."+e);c(d,".",e,"=",b[e].append(a,f),";")});f(c)}function L(a,f,b){var d=a.shared,c=d.gl,e=d.framebuffer,k;u&&(k=f.def(d.extensions,".webgl_draw_buffers"));
var l=a.constants,d=l.drawBuffer,l=l.backBuffer;a=b?b.append(a,f):f.def(e,".next");f("if(",e,".dirty||",a,"!==",e,".cur){","if(",a,"){",c,".bindFramebuffer(",36160,",",a,".framebuffer);");u&&f(k,".drawBuffersWEBGL(",d,"[",a,".colorAttachments.length]);");f("}else{",c,".bindFramebuffer(",36160,",null);");u&&f(k,".drawBuffersWEBGL(",l,");");f("}",e,".cur=",a,";",e,".dirty=false;","}")}function ka(a,f,b){var d=a.shared,c=d.gl,e=a.current,k=a.next,l=d.current,g=d.next,u=a.cond(l,".dirty");Da.forEach(function(f){f=
N(f);if(!(f in b.state)){var d,G;if(f in k){d=k[f];G=e[f];var x=t(ma[f].length,function(a){return u.def(d,"[",a,"]")});u(a.cond(x.map(function(a,f){return a+"!=="+G+"["+f+"]"}).join("||")).then(c,".",oa[f],"(",x,");",x.map(function(a,f){return G+"["+f+"]="+a}).join(";"),";"))}else d=u.def(g,".",f),x=a.cond(d,"!==",l,".",f),u(x),f in na?x(a.cond(d).then(c,".enable(",na[f],");")["else"](c,".disable(",na[f],");"),l,".",f,"=",d,";"):x(c,".",oa[f],"(",d,");",l,".",f,"=",d,";")}});0===Object.keys(b.state).length&&
u(l,".dirty=false;");f(u)}function ha(f,b,d,c){var e=f.shared,k=f.current,g=e.current,l=e.gl;a(Object.keys(d)).forEach(function(a){var e=d[a];if(!c||c(e)){var u=e.append(f,b);if(na[a]){var x=na[a];E(e)?u?b(l,".enable(",x,");"):b(l,".disable(",x,");"):b(f.cond(u).then(l,".enable(",x,");")["else"](l,".disable(",x,");"));b(g,".",a,"=",u,";")}else if(F(u)){var D=k[a];b(l,".",oa[a],"(",u,");",u.map(function(a,f){return D+"["+f+"]="+a}).join(";"),";")}else b(l,".",oa[a],"(",u,");",g,".",a,"=",u,";")}})}
function W(a,f){x&&!a.instancing&&(a.instancing=f.def(a.shared.extensions,".angle_instanced_arrays"))}function Z(a,f,b,d,c){function e(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function k(a){h=f.def();a(h,"=",e(),";");"string"===typeof c?a(x,".count+=",c,";"):a(x,".count++;");ra&&(d?(n=f.def(),a(n,"=",q,".getNumPendingQueries();")):a(q,".beginQuery(",x,");"))}function l(a){a(x,".cpuTime+=",e(),"-",h,";");ra&&(d?a(q,".pushScopeStats(",n,",",q,".getNumPendingQueries(),",
x,");"):a(q,".endQuery();"))}function g(a){var b=f.def(p,".profile");f(p,".profile=",a,";");f.exit(p,".profile=",b,";")}var u=a.shared,x=a.stats,p=u.current,q=u.timer;b=b.profile;var h,n;if(b){if(E(b)){b.enable?(k(f),l(f.exit),g("true")):g("false");return}b=b.append(a,f);g(b)}else b=f.def(p,".profile");u=a.block();k(u);f("if(",b,"){",u,"}");a=a.block();l(a);f.exit("if(",b,"){",a,"}")}function aa(a,f,b,d,c){function e(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;
case 35666:case 35669:case 35673:return 4;default:return 1}}function k(b,d,c){function e(){f("if(!",q,".pointer){",g,".enableVertexAttribArray(",D,");",q,".pointer=true;}");var b=c.type,l;l=c.size?f.def(c.size,"||",d):d;f("if(",q,".type!==",b,"||",q,".size!==",l,"||",A.map(function(a){return q+"."+a+"!=="+c[a]}).join("||"),"){",g,".bindBuffer(",34962,",",p,".buffer);",g,".vertexAttribPointer(",[D,l,b,c.normalized,c.stride,c.offset],");",q,".type=",b,";",q,".size=",l,";",A.map(function(a){return q+
"."+a+"="+c[a]+";"}).join(""),"}");x&&(b=c.divisor,f("if(",q,".divisor!==",b,"){",a.instancing,".vertexAttribDivisorANGLE(",[D,b],");",q,".divisor=",b,";}"))}function u(){f("if(",q,".pointer){",g,".disableVertexAttribArray(",D,");",q,".pointer=false;","}if(",n.map(function(a,f){return q+"."+a+"!=="+h[f]}).join("||"),"){",g,".vertexAttrib4f(",D,",",h,");",n.map(function(a,f){return q+"."+a+"="+h[f]+";"}).join(""),"}")}var g=l.gl,D=f.def(b,".location"),q=f.def(l.attributes,"[",D,"]");b=c.state;var p=
c.buffer,h=[c.x,c.y,c.z,c.w],A=["buffer","normalized","offset","stride"];1===b?e():2===b?u():(f("if(",b,"===",1,"){"),e(),f("}else{"),u(),f("}"))}var l=a.shared;d.forEach(function(d){var l=d.name,g=b.attributes[l],u;if(g){if(!c(g))return;u=g.append(a,f)}else{if(!c(ba))return;var x=a.scopeAttrib(l);u={};Object.keys(new da).forEach(function(a){u[a]=f.def(x,".",a)})}k(a.link(d),e(d.info.type),u)})}function ta(a,f,b,d,c){for(var e=a.shared,k=e.gl,l,g=0;g<d.length;++g){var u=d[g],x=u.name,q=u.info.type,
p=b.uniforms[x],u=a.link(u)+".location",n;if(p){if(!c(p))continue;if(E(p)){x=p.value;if(35678===q||35680===q)q=a.link(x._texture),f(k,".uniform1i(",u,",",q+".bind());"),f.exit(q,".unbind();");else if(35674===q||35675===q||35676===q)x=a.global.def("new Float32Array(["+Array.prototype.slice.call(x)+"])"),p=2,35675===q?p=3:35676===q&&(p=4),f(k,".uniformMatrix",p,"fv(",u,",false,",x,");");else{switch(q){case 5126:l="1f";break;case 35664:l="2f";break;case 35665:l="3f";break;case 35666:l="4f";break;case 35670:l=
"1i";break;case 5124:l="1i";break;case 35671:l="2i";break;case 35667:l="2i";break;case 35672:l="3i";break;case 35668:l="3i";break;case 35673:l="4i";break;case 35669:l="4i"}f(k,".uniform",l,"(",u,",",F(x)?Array.prototype.slice.call(x):x,");")}continue}else n=p.append(a,f)}else{if(!c(ba))continue;n=f.def(e.uniforms,"[",h.id(x),"]")}x=1;switch(q){case 35678:case 35680:q=f.def(n,"._texture");f(k,".uniform1i(",u,",",q,".bind());");f.exit(q,".unbind();");continue;case 5124:case 35670:l="1i";break;case 35667:case 35671:l=
"2i";x=2;break;case 35668:case 35672:l="3i";x=3;break;case 35669:case 35673:l="4i";x=4;break;case 5126:l="1f";break;case 35664:l="2f";x=2;break;case 35665:l="3f";x=3;break;case 35666:l="4f";x=4;break;case 35674:l="Matrix2fv";break;case 35675:l="Matrix3fv";break;case 35676:l="Matrix4fv"}f(k,".uniform",l,"(",u,",");if("M"===l.charAt(0)){var u=Math.pow(q-35674+2,2),A=a.global.def("new Float32Array(",u,")");f("false,(Array.isArray(",n,")||",n," instanceof Float32Array)?",n,":(",t(u,function(a){return A+
"["+a+"]="+n+"["+a+"]"}),",",A,")")}else 1<x?f(t(x,function(a){return n+"["+a+"]"})):f(n);f(");")}}function ua(a,f,b,d){function c(e){var l=q[e];return l?l.contextDep&&d.contextDynamic||l.propDep?l.append(a,b):l.append(a,f):f.def(g,".",e)}function e(){function a(){b(z,".drawElementsInstancedANGLE(",[n,A,t,h+"<<(("+t+"-5121)>>1)",r],");")}function f(){b(z,".drawArraysInstancedANGLE(",[n,h,A,r],");")}p?m?a():(b("if(",p,"){"),a(),b("}else{"),f(),b("}")):f()}function k(){function a(){b(u+".drawElements("+
[n,A,t,h+"<<(("+t+"-5121)>>1)"]+");")}function f(){b(u+".drawArrays("+[n,h,A]+");")}p?m?a():(b("if(",p,"){"),a(),b("}else{"),f(),b("}")):f()}var l=a.shared,u=l.gl,g=l.draw,q=d.draw,p=function(){var c=q.elements,e=f;if(c){if(c.contextDep&&d.contextDynamic||c.propDep)e=b;c=c.append(a,e)}else c=e.def(g,".","elements");c&&e("if("+c+")"+u+".bindBuffer(34963,"+c+".buffer.buffer);");return c}(),n=c("primitive"),h=c("offset"),A=function(){var c=q.count,e=f;if(c){if(c.contextDep&&d.contextDynamic||c.propDep)e=
b;c=c.append(a,e)}else c=e.def(g,".","count");return c}();if("number"===typeof A){if(0===A)return}else b("if(",A,"){"),b.exit("}");var r,z;x&&(r=c("instances"),z=a.instancing);var t=p+".type",m=q.elements&&E(q.elements);x&&("number"!==typeof r||0<=r)?"string"===typeof r?(b("if(",r,">0){"),e(),b("}else if(",r,"<0){"),k(),b("}")):e():k()}function xa(a,f,b,d,c){f=Y();c=f.proc("body",c);x&&(f.instancing=c.def(f.shared.extensions,".angle_instanced_arrays"));a(f,c,b,d);return f.compile().body}function ya(a,
f,b,d){W(a,f);aa(a,f,b,d.attributes,function(){return!0});ta(a,f,b,d.uniforms,function(){return!0});ua(a,f,f,b)}function Fa(a,f){var b=a.proc("draw",1);W(a,b);H(a,b,f.context);L(a,b,f.framebuffer);ka(a,b,f);ha(a,b,f.state);Z(a,b,f,!1,!0);var d=f.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",d,".program);");if(f.shader.program)ya(a,b,f,f.shader.program);else{var c=a.global.def("{}"),e=b.def(d,".id"),k=b.def(c,"[",e,"]");b(a.cond(k).then(k,".call(this,a0);")["else"](k,"=",c,"[",e,"]=",a.link(function(b){return xa(ya,
a,f,b,1)}),"(",d,");",k,".call(this,a0);"))}0<Object.keys(f.state).length&&b(a.shared.current,".dirty=true;")}function za(a,f,b,d){function c(){return!0}a.batchId="a1";W(a,f);aa(a,f,b,d.attributes,c);ta(a,f,b,d.uniforms,c);ua(a,f,f,b)}function Aa(a,f,b,d){function c(a){return a.contextDep&&k||a.propDep}function e(a){return!c(a)}W(a,f);var k=b.contextDep,l=f.def(),u=f.def();a.shared.props=u;a.batchId=l;var g=a.scope(),x=a.scope();f(g.entry,"for(",l,"=0;",l,"<","a1",";++",l,"){",u,"=","a0","[",l,"];",
x,"}",g.exit);b.needsContext&&H(a,x,b.context);b.needsFramebuffer&&L(a,x,b.framebuffer);ha(a,x,b.state,c);b.profile&&c(b.profile)&&Z(a,x,b,!1,!0);d?(aa(a,g,b,d.attributes,e),aa(a,x,b,d.attributes,c),ta(a,g,b,d.uniforms,e),ta(a,x,b,d.uniforms,c),ua(a,g,x,b)):(f=a.global.def("{}"),d=b.shader.progVar.append(a,x),u=x.def(d,".id"),g=x.def(f,"[",u,"]"),x(a.shared.gl,".useProgram(",d,".program);","if(!",g,"){",g,"=",f,"[",u,"]=",a.link(function(f){return xa(za,a,b,f,2)}),"(",d,");}",g,".call(this,a0[",l,
"],",l,");"))}function va(a,f){function b(a){return a.contextDep&&c||a.propDep}var d=a.proc("batch",2);a.batchId="0";W(a,d);var c=!1,e=!0;Object.keys(f.context).forEach(function(a){c=c||f.context[a].propDep});c||(H(a,d,f.context),e=!1);var k=f.framebuffer,l=!1;k?(k.propDep?c=l=!0:k.contextDep&&c&&(l=!0),l||L(a,d,k)):L(a,d,null);f.state.viewport&&f.state.viewport.propDep&&(c=!0);ka(a,d,f);ha(a,d,f.state,function(a){return!b(a)});f.profile&&b(f.profile)||Z(a,d,f,!1,"a1");f.contextDep=c;f.needsContext=
e;f.needsFramebuffer=l;e=f.shader.progVar;if(e.contextDep&&c||e.propDep)Aa(a,d,f,null);else if(e=e.append(a,d),d(a.shared.gl,".useProgram(",e,".program);"),f.shader.program)Aa(a,d,f,f.shader.program);else{var k=a.global.def("{}"),l=d.def(e,".id"),u=d.def(k,"[",l,"]");d(a.cond(u).then(u,".call(this,a0,a1);")["else"](u,"=",k,"[",l,"]=",a.link(function(b){return xa(Aa,a,f,b,2)}),"(",e,");",u,".call(this,a0,a1);"))}0<Object.keys(f.state).length&&d(a.shared.current,".dirty=true;")}function Ba(f,b){function d(a){var k=
b.shader[a];k&&c.set(e.shader,"."+a,k.append(f,c))}var c=f.proc("scope",3);f.batchId="a2";var e=f.shared,k=e.current;H(f,c,b.context);b.framebuffer&&b.framebuffer.append(f,c);a(Object.keys(b.state)).forEach(function(a){var d=b.state[a].append(f,c);F(d)?d.forEach(function(b,d){c.set(f.next[a],"["+d+"]",b)}):c.set(e.next,"."+a,d)});Z(f,c,b,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(a){var d=b.draw[a];d&&c.set(e.draw,"."+a,""+d.append(f,c))});Object.keys(b.uniforms).forEach(function(a){c.set(e.uniforms,
"["+h.id(a)+"]",b.uniforms[a].append(f,c))});Object.keys(b.attributes).forEach(function(a){var d=b.attributes[a].append(f,c),e=f.scopeAttrib(a);Object.keys(new da).forEach(function(a){c.set(e,"."+a,d[a])})});d("vert");d("frag");0<Object.keys(b.state).length&&(c(k,".dirty=true;"),c.exit(k,".dirty=true;"));c("a1(",f.shared.context,",a0,0);")}var da=A.Record,f={add:32774,subtract:32778,"reverse subtract":32779};m.ext_blend_minmax&&(f.min=32775,f.max=32776);var x=m.angle_instanced_arrays,u=m.webgl_draw_buffers,
ma={dirty:!0,profile:X.profile},wa={},Da=[],na={},oa={};J("dither",3024);J("blend.enable",3042);I("blend.color","blendColor",[0,0,0,0]);I("blend.equation","blendEquationSeparate",[32774,32774]);I("blend.func","blendFuncSeparate",[1,0,1,0]);J("depth.enable",2929,!0);I("depth.func","depthFunc",513);I("depth.range","depthRange",[0,1]);I("depth.mask","depthMask",!0);I("colorMask","colorMask",[!0,!0,!0,!0]);J("cull.enable",2884);I("cull.face","cullFace",1029);I("frontFace","frontFace",2305);I("lineWidth",
"lineWidth",1);J("polygonOffset.enable",32823);I("polygonOffset.offset","polygonOffset",[0,0]);J("sample.alpha",32926);J("sample.enable",32928);I("sample.coverage","sampleCoverage",[1,!1]);J("stencil.enable",2960);I("stencil.mask","stencilMask",-1);I("stencil.func","stencilFunc",[519,0,-1]);I("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);I("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);J("scissor.enable",3089);I("scissor.box","scissor",[0,0,p.drawingBufferWidth,p.drawingBufferHeight]);
I("viewport","viewport",[0,0,p.drawingBufferWidth,p.drawingBufferHeight]);var Ia={gl:p,context:T,strings:h,next:wa,current:ma,draw:S,elements:v,buffer:B,shader:Q,attributes:A.state,uniforms:R,framebuffer:ia,extensions:m,timer:ra,isBufferArgs:g},Ea={primTypes:z,compareFuncs:C,blendFuncs:q,blendEquations:f,stencilOps:k,glTypes:K,orientationType:b};u&&(Ea.backBuffer=[1029],Ea.drawBuffer=t(y.maxDrawbuffers,function(a){return 0===a?[0]:t(a,function(a){return 36064+a})}));var La=0;return{next:wa,current:ma,
procs:function(){var a=Y(),f=a.proc("poll"),b=a.proc("refresh"),d=a.block();f(d);b(d);var c=a.shared,e=c.gl,k=c.next,l=c.current;d(l,".dirty=false;");L(a,f);b(c.framebuffer,".dirty=true;");L(a,b);Object.keys(na).forEach(function(c){var u=na[c],g=d.def(k,".",c),x=a.block();x("if(",g,"){",e,".enable(",u,")}else{",e,".disable(",u,")}",l,".",c,"=",g,";");b(x);f("if(",g,"!==",l,".",c,"){",x,"}")});Object.keys(oa).forEach(function(c){var u=oa[c],g=ma[c],x,q,p=a.block();p(e,".",u,"(");F(g)?(u=g.length,x=
a.global.def(k,".",c),q=a.global.def(l,".",c),p(t(u,function(a){return x+"["+a+"]"}),");",t(u,function(a){return q+"["+a+"]="+x+"["+a+"];"}).join("")),f("if(",t(u,function(a){return x+"["+a+"]!=="+q+"["+a+"]"}).join("||"),"){",p,"}")):(x=d.def(k,".",c),q=d.def(l,".",c),p(x,");",l,".",c,"=",x,";"),f("if(",x,"!==",q,"){",p,"}"));b(p)});return a.compile()}(),compile:function(a,f,b,d,c){var e=Y();e.stats=e.link(c);c=sa(a);var k=ja(a,c),l=la(a),u=U(a),g=qa(a),x=k.viewport;x&&(u.viewport=x);x=N("scissor.box");
(k=k[x])&&(u[x]=k);k=0<Object.keys(u).length;c={framebuffer:c,draw:l,shader:g,state:u,dirty:k};c.profile=pa(a);c.uniforms=ea(b);c.attributes=fa(f);c.context=ga(d);Fa(e,c);Ba(e,c);va(e,c);return e.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(h,m,v){function g(a,e){this.id=E++;this.type=a;this.data=e}function a(d){if(0===d.length)return[];var e=
d.charAt(0),c=d.charAt(d.length-1);if(1<d.length&&e===c&&('"'===e||"'"===e))return['"'+d.substr(1,d.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(d))return a(d.substr(0,e.index)).concat(a(e[1])).concat(a(d.substr(e.index+e[0].length)));e=d.split(".");if(1===e.length)return['"'+d.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];d=[];for(c=0;c<e.length;++c)d=d.concat(a(e[c]));return d}function r(d){return"["+a(d).join("][")+"]"}var E=0;
m.exports={define:function(a,e){switch(typeof e){case "boolean":case "number":case "string":return new g(a,r(e+""));case "undefined":return new g(a|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof g},unbox:function(a,e){if(a instanceof g){if(a.type&128)return new g(a.type&-129,r(e))}else if("function"===typeof a)return new g(0,a);return a},accessor:r}},{}],10:[function(h,m,v){var g=h("./util/is-typed-array"),a=h("./util/is-ndarray"),r=h("./util/values"),E=
h("./constants/primitives.json"),d=h("./constants/usage.json");m.exports=function(e,c,h,m){function B(a){this.id=n++;K[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function F(d,b,e,q,n,r,z){(r=z)||g(b)&&(!a(b)||g(b.data))||(r=c.oes_element_index_uint?5125:5123);d.buffer.bind();h._initBuffer(d.buffer,b,e,r,3);b=z;if(!z){switch(d.buffer.dtype){case 5121:case 5120:b=5121;break;case 5123:case 5122:b=5123;break;case 5125:case 5124:b=5125}d.buffer.dtype=b}d.type=b;0>n&&(n=d.buffer.byteLength,
5123===b?n>>=1:5125===b&&(n>>=2));d.vertCount=n;n=q;0>q&&(n=4,q=d.buffer.dimension,1===q&&(n=0),2===q&&(n=1),3===q&&(n=4));d.primType=n}function z(a){m.elementsCount--;delete K[a.id];a.buffer.destroy();a.buffer=null}var K={},n=0,q={uint8:5121,uint16:5123};c.oes_element_index_uint&&(q.uint32=5125);B.prototype.bind=function(){this.buffer.bind()};var C=[];return{create:function(c){function b(c){if(c)if("number"===typeof c)n(c),p.primType=4,p.vertCount=c|0,p.type=5121;else{var k=null,h=35044,r=-1,z=-1,
t=0,m=0;Array.isArray(c)||g(c)||a(c)?k=c:("data"in c&&(k=c.data),"usage"in c&&(h=d[c.usage]),"primitive"in c&&(r=E[c.primitive]),"count"in c&&(z=c.count|0),"length"in c&&(t=c.length|0),"type"in c&&(m=q[c.type]));k?F(p,k,h,r,z,t,m):(c=p.buffer,c.bind(),e.bufferData(34963,t,h),c.dtype=m||5121,c.usage=h,c.dimension=3,c.byteLength=t,p.primType=0>r?4:r,p.vertCount=0>z?0:z,p.type=c.dtype)}else n(),p.primType=4,p.vertCount=0,p.type=5121;return b}var n=h.create(null,34963,!0),p=new B(n._buffer);m.elementsCount++;
b(c);b._reglType="elements";b._elements=p;b.subdata=function(a,c){n.subdata(a,c);return b};b.destroy=function(){z(p)};return b},createStream:function(a){var b=C.pop();b||(b=new B(h.create(null,34963,!0)._buffer));F(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){C.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof B?a._elements:null},clear:function(){r(K).forEach(z)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,
"./util/values":31}],11:[function(h,m,v){m.exports=function(g,a){function h(a){a=a.toLowerCase();if(a in m)return!0;var d;try{d=m[a]=g.getExtension(a)}catch(e){}return!!d}for(var m={},d=0;d<a.extensions.length;++d){var e=a.extensions[d];if(!h(e))return a.onDestroy(),a.onDone('"'+e+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}a.optionalExtensions.forEach(h);return{extensions:m,refresh:function(){a.extensions.forEach(h);a.optionalExtensions.forEach(h)}}}},
{}],12:[function(h,m,v){var g=h("./util/values"),a=h("./util/extend"),r=[];r[6406]=1;r[6409]=1;r[6410]=2;r[6407]=3;r[6408]=4;var E=[];E[5121]=1;E[5126]=4;E[36193]=2;m.exports=function(d,e,c,h,m,B){function F(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height);this.width=a;this.height=d}function z(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function K(a,b,c){a&&(a.texture?a.texture._texture.refCount+=
1:a.renderbuffer._renderbuffer.refCount+=1)}function n(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function q(a){var b=3553,c=null,d=null,e=a;"object"===typeof a&&(e=a.data);a=e._reglType;"texture2d"===a?c=e:"textureCube"===a?c=e:"renderbuffer"===a&&(d=e,b=36161);return new F(b,c,d)}function C(a,b,c,d,e){if(c)return a=h.create2D({width:a,
height:b,format:d,type:e}),a._texture.refCount=0,new F(3553,a,null);a=m.create({width:a,height:b,format:d});a._renderbuffer.refCount=0;return new F(36161,null,a)}function k(a){return a&&(a.texture||a.renderbuffer)}function b(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function v(){this.id=ia++;R[this.id]=this;this.framebuffer=d.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=
null}function p(a){a.colorAttachments.forEach(z);z(a.depthAttachment);z(a.stencilAttachment);z(a.depthStencilAttachment)}function M(a){d.deleteFramebuffer(a.framebuffer);a.framebuffer=null;B.framebufferCount--;delete R[a.id]}function Ha(a){var b;d.bindFramebuffer(36160,a.framebuffer);var e=a.colorAttachments;for(b=0;b<e.length;++b)n(36064+b,e[b]);for(b=e.length;b<c.maxColorAttachments;++b)n(36064+b,null);n(36096,a.depthAttachment);n(36128,a.stencilAttachment);n(33306,a.depthStencilAttachment);d.checkFramebufferStatus(36160);
d.bindFramebuffer(36160,O.next);O.current=O.next}var O={current:null,next:null,dirty:!1},V=["rgba"],P=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&P.push("srgba");e.ext_color_buffer_half_float&&P.push("rgba16f","rgb16f");e.webgl_color_buffer_float&&P.push("rgba32f");var ca=["uint8"];e.oes_texture_half_float&&ca.push("half float");e.oes_texture_float&&ca.push("float");var ia=0,R={};return a(O,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof
v)?a:null},create:function(a,c){function d(a,b){var c,n=0,h=0,z=!0,m=!0;c=null;var t=!0,F="rgba",B="uint8",y=1,A=null,v=null,ba=null,M=!1;if("number"===typeof a)n=a|0,h=b|0||n;else if(a){"shape"in a?(h=a.shape,n=h[0],h=h[1]):("radius"in a&&(n=h=a.radius),"width"in a&&(n=a.width),"height"in a&&(h=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);c||("colorCount"in a&&(y=a.colorCount|0),"colorTexture"in a&&(t=!!a.colorTexture,F="rgba4"),"colorType"in a&&(B=a.colorType,t||
("half float"===B?e.ext_color_buffer_half_float&&(F="rgba16f"):"float"===B&&e.webgl_color_buffer_float&&(F="rgba32f"))),"colorFormat"in a&&(F=a.colorFormat,0<=V.indexOf(F)?t=!0:0<=P.indexOf(F)&&(t=!1)));if("depthTexture"in a||"depthStencilTexture"in a)M=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?z=a.depth:(A=a.depth,m=!1));"stencil"in a&&("boolean"===typeof a.stencil?m=a.stencil:(v=a.stencil,z=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?z=m=
a.depthStencil:(ba=a.depthStencil,m=z=!1))}else n=h=1;var H=null,L=null,ka=null,ha=null;if(Array.isArray(c))H=c.map(q);else if(c)H=[q(c)];else for(H=Array(y),c=0;c<y;++c)H[c]=C(n,h,t,F,B);n=n||H[0].width;h=h||H[0].height;A?L=q(A):z&&!m&&(L=C(n,h,M,"depth","uint32"));v?ka=q(v):m&&!z&&(ka=C(n,h,!1,"stencil","uint8"));ba?ha=q(ba):!A&&!v&&m&&z&&(ha=C(n,h,M,"depth stencil","depth stencil"));z=null;for(c=0;c<H.length;++c)K(H[c],n,h),H[c]&&H[c].texture&&(m=r[H[c].texture._texture.format]*E[H[c].texture._texture.type],
null===z&&(z=m));K(L,n,h);K(ka,n,h);K(ha,n,h);p(g);g.width=n;g.height=h;g.colorAttachments=H;g.depthAttachment=L;g.stencilAttachment=ka;g.depthStencilAttachment=ha;d.color=H.map(k);d.depth=k(L);d.stencil=k(ka);d.depthStencil=k(ha);d.width=g.width;d.height=g.height;Ha(g);return d}var g=new v;B.framebufferCount++;d(a,c);d.resize=function(a,c){var e=a|0,k=c|0||e;if(e===g.width&&k===g.height)return d;for(var q=g.colorAttachments,n=0;n<q.length;++n)b(q[n],e,k);b(g.depthAttachment,e,k);b(g.stencilAttachment,
e,k);b(g.depthStencilAttachment,e,k);g.width=d.width=e;g.height=d.height=k;Ha(g);return d};d._reglType="framebuffer";d._framebuffer=g;d.destroy=function(){M(g);p(g)};return d},clear:function(){g(R).forEach(M)}})}},{"./util/extend":23,"./util/values":31}],13:[function(h,m,v){m.exports=function(g,a){var h=1;a.ext_texture_filter_anisotropic&&(h=g.getParameter(34047));var m=1,d=1;a.webgl_draw_buffers&&(m=g.getParameter(34852),d=g.getParameter(36063));return{colorBits:[g.getParameter(3410),g.getParameter(3411),
g.getParameter(3412),g.getParameter(3413)],depthBits:g.getParameter(3414),stencilBits:g.getParameter(3415),subpixelBits:g.getParameter(3408),extensions:Object.keys(a).filter(function(d){return!!a[d]}),maxAnisotropic:h,maxDrawbuffers:m,maxColorAttachments:d,pointSizeDims:g.getParameter(33901),lineWidthDims:g.getParameter(33902),maxViewportDims:g.getParameter(3386),maxCombinedTextureUnits:g.getParameter(35661),maxCubeMapSize:g.getParameter(34076),maxRenderbufferSize:g.getParameter(34024),maxTextureUnits:g.getParameter(34930),
maxTextureSize:g.getParameter(3379),maxAttributes:g.getParameter(34921),maxVertexUniforms:g.getParameter(36347),maxVertexTextureUnits:g.getParameter(35660),maxVaryingVectors:g.getParameter(36348),maxFragmentUniforms:g.getParameter(36349),glsl:g.getParameter(35724),renderer:g.getParameter(7937),vendor:g.getParameter(7936),version:g.getParameter(7938)}}},{}],14:[function(h,m,v){var g=h("./util/is-typed-array");m.exports=function(a,h,m){return function(d){var e=0,c=0,t=m.framebufferWidth,y=m.framebufferHeight,
B=null;g(d)?B=d:2===arguments.length?(t=arguments[0]|0,y=arguments[1]|0):d&&(e=d.x|0,c=d.y|0,t=d.width||m.framebufferWidth,y=d.height||m.framebufferHeight,B=d.data||null);h();B=B||new Uint8Array(t*y*4);a.pixelStorei(3333,4);a.readPixels(e,c,t,y,6408,5121,B);return B}}},{"./util/is-typed-array":26}],15:[function(h,m,v){var g=h("./util/values");m.exports=function(a,h,m,d){function e(a){this.id=y++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0}function c(c){var e=c.renderbuffer;
a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(e);c.renderbuffer=null;c.refCount=0;delete B[c.id];d.renderbufferCount--}var t={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};h.ext_srgb&&(t.srgba=35907);h.ext_color_buffer_half_float&&(t.rgba16f=34842,t.rgb16f=34843);h.webgl_color_buffer_float&&(t.rgba32f=34836);var y=0,B={};e.prototype.decRef=function(){0>=--this.refCount&&c(this)};return{create:function(c,g){function h(c,d){var e=0,b=0,g=32854;"object"===
typeof c&&c?("shape"in c?(b=c.shape,e=b[0]|0,b=b[1]|0):("radius"in c&&(e=b=c.radius|0),"width"in c&&(e=c.width|0),"height"in c&&(b=c.height|0)),"format"in c&&(g=t[c.format])):"number"===typeof c?(e=c|0,b="number"===typeof d?d|0:e):c||(e=b=1);if(e!==n.width||b!==n.height||g!==n.format)return h.width=n.width=e,h.height=n.height=b,n.format=g,a.bindRenderbuffer(36161,n.renderbuffer),a.renderbufferStorage(36161,g,e,b),h}var n=new e(a.createRenderbuffer());B[n.id]=n;d.renderbufferCount++;h(c,g);h.resize=
function(c,d){var e=c|0,b=d|0||e;if(e===n.width&&b===n.height)return h;h.width=n.width=e;h.height=n.height=b;a.bindRenderbuffer(36161,n.renderbuffer);a.renderbufferStorage(36161,n.format,e,b);return h};h._reglType="renderbuffer";h._renderbuffer=n;h.destroy=function(){n.decRef()};return h},clear:function(){g(B).forEach(c)}}}},{"./util/values":31}],16:[function(h,m,v){var g=h("./util/values");m.exports=function(a,h,m){function d(a,c,d,e){this.name=a;this.id=c;this.location=d;this.info=e}function e(a,
c){for(var d=0;d<a.length;++d)if(a[d].id===c.id){a[d].location=c.location;return}a.push(c)}function c(c,d,e){e=35632===c?y:B;var g=e[d];if(!g){var b=h.str(d),g=a.createShader(c);a.shaderSource(g,b);a.compileShader(g);e[d]=g}return g}function t(a,c){this.id=v++;this.fragId=a;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[]}var y={},B={},F={},z=[],v=0;return{clear:function(){var c=a.deleteShader.bind(a);g(y).forEach(c);y={};g(B).forEach(c);B={};z.forEach(function(c){a.deleteProgram(c.program)});
z.length=0;F={};m.shaderCount=0},program:function(g,q,B){m.shaderCount++;(B=F[q])||(B=F[q]={});var k=B[g];if(!k){var b=k=new t(q,g),y,p;y=c(35632,b.fragId);p=c(35633,b.vertId);q=b.program=a.createProgram();a.attachShader(q,y);a.attachShader(q,p);a.linkProgram(q);var v=a.getProgramParameter(q,35718),K=b.uniforms;for(y=0;y<v;++y)if(p=a.getActiveUniform(q,y))if(1<p.size)for(var O=0;O<p.size;++O){var V=p.name.replace("[0]","["+O+"]");e(K,new d(V,h.id(V),a.getUniformLocation(q,V),p))}else e(K,new d(p.name,
h.id(p.name),a.getUniformLocation(q,p.name),p));v=a.getProgramParameter(q,35721);b=b.attributes;for(y=0;y<v;++y)(p=a.getActiveAttrib(q,y))&&e(b,new d(p.name,h.id(p.name),a.getAttribLocation(q,p.name),p));B[g]=k;z.push(k)}return k},shader:c,frag:null,vert:null}}},{"./util/values":31}],17:[function(h,m,v){m.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(h,m,v){m.exports=function(){var g={"":0},
a=[""];return{id:function(h){var m=g[h];if(m)return m;m=g[h]=a.length;a.push(h);return m},str:function(g){return a[g]}}}},{}],19:[function(h,m,v){function g(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&z(a[0])?!0:!1}function r(a){return Object.prototype.toString.call(a)}function E(b){if(!b)return!1;var c=r(b);return 0<=k.indexOf(c)?!0:g(b)||a(b)||y(b)}function d(a,c){36193===a.type?(a.data=F(c),B.freeType(c)):a.data=c}var e=
h("./util/extend"),c=h("./util/values"),t=h("./util/is-typed-array"),y=h("./util/is-ndarray"),B=h("./util/pool"),F=h("./util/to-half-float"),z=h("./util/is-array-like");v=h("./constants/arraytypes.json");var K=h("./constants/arraytypes.json"),n=[9984,9986,9985,9987],q=[0,6409,6410,6407,6408],C={};C[6409]=C[6406]=C[6402]=1;C[34041]=C[6410]=2;C[6407]=3;C[6408]=4;var k=Object.keys(v).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);
m.exports=function(b,k,h,m,v,O){function V(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function P(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}
function ca(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=ha[b.colorSpace]);"type"in b&&(a.type=W[b.type]);var c=a.width,d=a.height,e=a.channels,g=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(e=b.shape[2],g=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(e=b.channels,
g=!0));a.width=c|0;a.height=d|0;a.channels=e|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=Z[c],a.format=xa[d],c in W&&!("type"in b)&&(a.type=W[c]),c in aa&&(a.compressed=!0),c=!0);!g&&c?a.channels=C[a.format]:g&&!c&&a.channels!==q[a.format]&&(a.format=a.internalformat=q[a.channels])}}function ia(a){b.pixelStorei(37440,a.flipY);b.pixelStorei(37441,a.premultiplyAlpha);b.pixelStorei(37443,a.colorSpace);b.pixelStorei(3317,a.unpackAlignment)}function R(){V.call(this);this.yOffset=this.xOffset=0;
this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function A(b,c){var e=null;E(c)?e=c:c&&(ca(b,c),"x"in c&&(b.xOffset=c.x|0),"y"in c&&(b.yOffset=c.y|0),E(c.data)&&(e=c.data));if(c.copy){var k=v.viewportWidth,h=v.viewportHeight;b.width=b.width||k-b.xOffset;b.height=b.height||h-b.yOffset;b.needsCopy=!0}else if(!e)b.width=b.width||1,b.height=b.height||1;else if(t(e))b.data=e,"type"in c||5121!==b.type||(b.type=K[Object.prototype.toString.call(e)]|0);else if(g(e)){k=e;h=b.width*b.height*
b.channels;switch(b.type){case 5121:case 5123:case 5125:case 5126:h=B.allocType(b.type,h);h.set(k);b.data=h;break;case 36193:b.data=F(k)}b.alignment=1;b.needsFree=!0}else if(y(e)){k=e.data;Array.isArray(k)||5121!==b.type||(b.type=K[Object.prototype.toString.call(k)]|0);var h=e.shape,n=e.stride,p,m,C,A;3===h.length?(C=h[2],A=n[2]):A=C=1;p=h[0];m=h[1];h=n[0];n=n[1];b.alignment=1;b.width=p;b.height=m;b.channels=C;b.format=b.internalformat=q[C];b.needsFree=!0;p=A;e=e.offset;C=b.width;A=b.height;m=b.channels;
for(var L=B.allocType(36193===b.type?5126:b.type,C*A*m),w=0,G=0;G<A;++G)for(var M=0;M<C;++M)for(var H=0;H<m;++H)L[w++]=k[h*M+n*G+p*H+e];d(b,L)}else if("[object HTMLCanvasElement]"===r(e)||"[object CanvasRenderingContext2D]"===r(e))"[object HTMLCanvasElement]"===r(e)?b.element=e:b.element=e.canvas,b.width=b.element.width,b.height=b.element.height;else if("[object HTMLImageElement]"===r(e))b.element=e,b.width=e.naturalWidth,b.height=e.naturalHeight;else if("[object HTMLVideoElement]"===r(e))b.element=
e,b.width=e.videoWidth,b.height=e.videoHeight,b.needsPoll=!0;else if(a(e)){k=e[0].length;h=e.length;n=1;if(z(e[0][0])){p=n=e[0][0].length;C=B.allocType(36193===b.type?5126:b.type,k*h*p);for(m=A=0;m<h;++m)for(L=e[m],w=0;w<k;++w)for(G=L[w],M=0;M<p;++M)C[A++]=G[M];d(b,C)}else{p=B.allocType(36193===b.type?5126:b.type,k*h);for(A=C=0;A<h;++A)for(m=e[A],L=0;L<k;++L)p[C++]=m[L];d(b,p)}b.alignment=1;b.width=k;b.height=h;b.channels=n;b.format=b.internalformat=q[n];b.needsFree=!0}}function Q(a,c,d,e,g){var k=
a.element,h=a.data,n=a.internalformat,p=a.format,q=a.type,z=a.width,t=a.height;ia(a);k?b.texSubImage2D(c,g,d,e,p,q,k):a.compressed?b.compressedTexSubImage2D(c,g,d,e,n,z,t,h):a.needsCopy?(m(),b.copyTexSubImage2D(c,g,d,e,a.xOffset,a.yOffset,z,t)):b.texSubImage2D(c,g,d,e,z,t,p,q,h)}function S(){return ya.pop()||new R}function T(a){a.needsFree&&B.freeType(a.data);R.call(a);ya.push(a)}function ra(){V.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function X(a,b,
c){var d=a.images[0]=S();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function N(a,b){var c=null;if(E(b))c=a.images[0]=S(),P(c,a),A(c,b),a.mipmask=1;else if(ca(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,e=0;e<d.length;++e)c=a.images[e]=S(),P(c,a),c.width>>=e,c.height>>=e,A(c,d[e]),a.mipmask|=1<<e;else c=a.images[0]=S(),P(c,a),A(c,b),a.mipmask=1;P(a,a.images[0])}function J(a,c){for(var d=a.images,e=0;e<d.length&&d[e];++e){var g=d[e],k=c,h=e,n=g.element,p=g.data,q=g.internalformat,z=g.format,
t=g.type,r=g.width,y=g.height;ia(g);n?b.texImage2D(k,h,z,z,t,n):g.compressed?b.compressedTexImage2D(k,h,q,r,y,0,p):g.needsCopy?(m(),b.copyTexImage2D(k,h,z,g.xOffset,g.yOffset,r,y,0)):b.texImage2D(k,h,z,r,y,0,z,t,p)}}function I(){var a=Fa.pop()||new ra;V.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function Y(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&T(b[c]),b[c]=null;Fa.push(a)}function pa(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;
this.genMipmaps=!1;this.mipmapHint=4352}function sa(a,b){"min"in b&&(a.minFilter=ka[b.min],0<=n.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=L[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var e=b.wrap;"string"===typeof e?c=d=H[e]:Array.isArray(e)&&(c=H[e[0]],d=H[e[1]])}else"wrapS"in b&&(c=H[b.wrapS]),"wrapT"in b&&(d=H[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=ga[b.mipmap];
c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function ja(a,c){b.texParameteri(c,10241,a.minFilter);b.texParameteri(c,10240,a.magFilter);b.texParameteri(c,10242,a.wrapS);b.texParameteri(c,10243,a.wrapT);k.ext_texture_filter_anisotropic&&b.texParameteri(c,34046,a.anisotropic);a.genMipmaps&&(b.hint(33170,a.mipmapHint),b.generateMipmap(c))}function qa(){var a=za.pop()||new pa;pa.call(a);return a}function la(a){V.call(this);
this.mipmask=0;this.internalformat=6408;this.id=Aa++;this.refCount=1;this.target=a;this.texture=b.createTexture();this.unit=-1;this.bindCount=0}function U(a){b.activeTexture(33984);b.bindTexture(a.target,a.texture)}function ea(){var a=da[0];a?b.bindTexture(a.target,a.texture):b.bindTexture(3553,null)}function fa(a){var c=a.texture,d=a.unit,e=a.target;0<=d&&(b.activeTexture(33984+d),b.bindTexture(e,null),da[d]=null);b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete va[a.id];
O.textureCount--}var ga={"don't care":4352,"dont care":4352,nice:4354,fast:4353},H={repeat:10497,clamp:33071,mirror:33648},L={nearest:9728,linear:9729},ka=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},L),ha={none:0,browser:37444},W={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Z={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},aa={};k.ext_srgb&&
(Z.srgb=35904,Z.srgba=35906);k.oes_texture_float&&(W["float"]=5126);k.oes_texture_half_float&&(W.float16=W["half float"]=36193);k.webgl_depth_texture&&(e(Z,{depth:6402,"depth stencil":34041}),e(W,{uint16:5123,uint32:5125,"depth stencil":34042}));k.webgl_compressed_texture_s3tc&&e(aa,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});k.webgl_compressed_texture_atc&&e(aa,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});
k.webgl_compressed_texture_pvrtc&&e(aa,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});k.webgl_compressed_texture_etc1&&(aa["rgb etc1"]=36196);var ta=Array.prototype.slice.call(b.getParameter(34467));Object.keys(aa).forEach(function(a){var b=aa[a];0<=ta.indexOf(b)&&(Z[a]=b)});var ua=Object.keys(Z);h.textureFormats=ua;var xa=ua.reduce(function(a,b){var c=Z[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?
a[c]=6408:a[c]=6407;return a},{}),ya=[],Fa=[],za=[],Aa=0,va={},Ba=h.maxTextureUnits,da=Array(Ba).map(function(){return null});e(la.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var c=0;c<Ba;++c){var d=da[c];if(d){if(0<d.bindCount)continue;d.unit=-1}da[c]=this;a=c;break}this.unit=a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&fa(this)}});return{create2D:function(a,c){function d(a,
b){var c=qa(),f=I();"number"===typeof a?"number"===typeof b?X(f,a|0,b|0):X(f,a|0,a|0):a?(sa(c,a),N(f,a)):X(f,1,1);c.genMipmaps&&(f.mipmask=(f.width<<1)-1);e.mipmask=f.mipmask;P(e,f);e.internalformat=f.internalformat;d.width=f.width;d.height=f.height;U(e);J(f,3553);ja(c,3553);ea();za.push(c);Y(f);return d}var e=new la(3553);va[e.id]=e;O.textureCount++;d(a,c);d.subimage=function(a,b,c,f){b|=0;c|=0;f|=0;var g=S();P(g,e);g.width>>=f;g.height>>=f;g.width-=b;g.height-=c;A(g,a);U(e);Q(g,3553,b,c,f);ea();
T(g);return d};d.resize=function(a,c){var f=a|0,g=c|0||f;if(f===e.width&&g===e.height)return d;d.width=e.width=f;d.height=e.height=g;U(e);b.texImage2D(3553,0,e.format,f,g,0,e.format,e.type,null);ea();return d};d._reglType="texture2d";d._texture=e;d.destroy=function(){e.decRef()};return d},createCube:function(a,c,d,e,g,k){function h(a,b,c,d,f,e){var g,k=qa();for(g=0;6>g;++g)p[g]=I();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)X(p[g],a,a);else if("object"===typeof a)if(b)N(p[0],a),N(p[1],b),
N(p[2],c),N(p[3],d),N(p[4],f),N(p[5],e);else if(sa(k,a),ca(n,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)P(p[g],n),N(p[g],a[g]);else for(g=0;6>g;++g)N(p[g],a);P(n,p[0]);n.mipmask=k.genMipmaps?(p[0].width<<1)-1:p[0].mipmask;n.internalformat=p[0].internalformat;h.width=p[0].width;h.height=p[0].height;U(n);for(g=0;6>g;++g)J(p[g],34069+g);ja(k,34067);ea();za.push(k);for(g=0;6>g;++g)Y(p[g]);return h}var n=new la(34067);va[n.id]=n;O.cubeCount++;var p=Array(6);h(a,c,d,e,g,k);h.subimage=function(a,b,c,d,f){c|=
0;d|=0;f|=0;var e=S();P(e,n);e.width>>=f;e.height>>=f;e.width-=c;e.height-=d;A(e,b);U(n);Q(e,34069+a,c,d,f);ea();T(e);return h};h.resize=function(a,c){var d=a|0,f=c|0||d;if(d===n.width&&f===n.height)return h;h.width=n.width=d;h.height=n.height=f;U(n);for(var e=0;6>e;++e)b.texImage2D(34069+e,0,n.format,d,f,0,n.format,n.type,null);ea();return h};h._reglType="textureCube";h._texture=n;h.destroy=function(){n.decRef()};return h},clear:function(){for(var a=0;a<Ba;++a)b.activeTexture(33984+a),b.bindTexture(3553,
null),da[a]=null;c(va).forEach(fa);O.cubeCount=0;O.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(h,m,v){m.exports=function(g,a){function h(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function m(a,c,d){var e=t.pop()||new h;e.startQueryIndex=a;e.endQueryIndex=c;
e.sum=0;e.stats=d;y.push(e)}var d=a.ext_disjoint_timer_query;if(!d)return null;var e=[],c=[],t=[],y=[],B=[],F=[];return{beginQuery:function(a){var g=e.pop()||d.createQueryEXT();d.beginQueryEXT(35007,g);c.push(g);m(c.length-1,c.length,a)},endQuery:function(){d.endQueryEXT(35007)},pushScopeStats:m,update:function(){var a,g;a=c.length;if(0!==a){F.length=Math.max(F.length,a+1);B.length=Math.max(B.length,a+1);B[0]=0;var h=F[0]=0;for(g=a=0;g<c.length;++g){var q=c[g];d.getQueryObjectEXT(q,34919)?(h+=d.getQueryObjectEXT(q,
34918),e.push(q)):c[a++]=q;B[g+1]=h;F[g+1]=a}c.length=a;for(g=a=0;g<y.length;++g){var h=y[g],m=h.startQueryIndex,q=h.endQueryIndex;h.sum+=B[q]-B[m];m=F[m];q=F[q];q===m?(h.stats.gpuTime+=h.sum/1E6,t.push(h)):(h.startQueryIndex=m,h.endQueryIndex=q,y[a++]=h)}y.length=a}},getNumPendingQueries:function(){return c.length},clear:function(){e.push.apply(e,c);for(var a=0;a<e.length;a++)d.deleteQueryEXT(e[a]);c.length=0;e.length=0}}}},{}],21:[function(h,m,v){m.exports="undefined"!==typeof performance&&performance.now?
function(){return performance.now()}:function(){return+new Date}},{}],22:[function(h,m,v){function g(a){return Array.prototype.slice.call(a)}function a(a){return g(a).join("")}var r=h("./extend");m.exports=function(){function h(){var c=[],d=[];return r(function(){c.push.apply(c,g(arguments))},{def:function(){var a="v"+e++;d.push(a);0<arguments.length&&(c.push(a,"="),c.push.apply(c,g(arguments)),c.push(";"));return a},toString:function(){return a([0<d.length?"var "+d+";":"",a(c)])}})}function d(){function a(e,
g){d(e,g,"=",c.def(e,g),";")}var c=h(),d=h(),e=c.toString,g=d.toString;return r(c,{entry:c,exit:d,save:a,set:function(d,e,b){a(d,e);c(d,e,"=",b,";")},toString:function(){return e()+g()}})}var e=0,c=[],m=[],y=h(),B={};return{global:y,link:function(a){for(var d=0;d<m.length;++d)if(m[d]===a)return c[d];d="g"+e++;c.push(d);m.push(a);return d},block:h,proc:function(c,e){function g(){var a="a"+h.length;h.push(a);return a}var h=[];e=e||0;for(var m=0;m<e;++m)g();var m=d(),t=m.toString;return B[c]=r(m,{arg:g,
toString:function(){return a(["function(",h.join(),"){",t(),"}"])}})},scope:d,cond:function(){var c=a(arguments),e=d(),h=d(),n=e.toString,m=h.toString;return r(e,{then:function(){e.apply(e,g(arguments));return this},"else":function(){h.apply(h,g(arguments));return this},toString:function(){var d=m();d&&(d="else{"+d+"}");return a(["if(",c,"){",n(),"}",d])}})},compile:function(){var d=['"use strict";',y,"return {"];Object.keys(B).forEach(function(a){d.push('"',a,'":',B[a].toString(),",")});d.push("}");
var e=a(d).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,c.concat(e)).apply(null,m)}}}},{"./extend":23}],23:[function(h,m,v){m.exports=function(g,a){for(var h=Object.keys(a),m=0;m<h.length;++m)g[h[m]]=a[h[m]];return g}},{}],24:[function(h,m,v){var g=h("./is-typed-array");m.exports=function(a){return Array.isArray(a)||g(a)}},{"./is-typed-array":26}],25:[function(h,m,v){var g=h("./is-typed-array");m.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&
Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||g(a.data))}},{"./is-typed-array":26}],26:[function(h,m,v){var g=h("../constants/arraytypes.json");m.exports=function(a){return Object.prototype.toString.call(a)in g}},{"../constants/arraytypes.json":4}],27:[function(h,m,v){m.exports=function(g,a){for(var h=Array(g),m=0;m<g;++m)h[m]=a(m);return h}},{}],28:[function(h,m,v){function g(a){var e,c;e=(65535<a)<<4;a>>>=e;c=(255<a)<<3;a>>>=c;e|=
c;c=(15<a)<<2;a>>>=c;e|=c;c=(3<a)<<1;return e|c|a>>>c>>1}function a(a){a:{for(var e=16;268435456>=e;e*=16)if(a<=e){a=e;break a}a=0}e=E[g(a)>>2];return 0<e.length?e.pop():new ArrayBuffer(a)}function r(a){E[g(a.byteLength)>>2].push(a)}var E=h("./loop")(8,function(){return[]});m.exports={alloc:a,free:r,allocType:function(d,e){var c=null;switch(d){case 5120:c=new Int8Array(a(e),0,e);break;case 5121:c=new Uint8Array(a(e),0,e);break;case 5122:c=new Int16Array(a(2*e),0,e);break;case 5123:c=new Uint16Array(a(2*
e),0,e);break;case 5124:c=new Int32Array(a(4*e),0,e);break;case 5125:c=new Uint32Array(a(4*e),0,e);break;case 5126:c=new Float32Array(a(4*e),0,e);break;default:return null}return c.length!==e?c.subarray(0,e):c},freeType:function(a){r(a.buffer)}}},{"./loop":27}],29:[function(h,m,v){m.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(g){return requestAnimationFrame(g)},cancel:function(g){return cancelAnimationFrame(g)}}:{next:function(g){setTimeout(g,
30)},cancel:clearTimeout}},{}],30:[function(h,m,v){var g=h("./pool"),a=new Float32Array(1),r=new Uint32Array(a.buffer);m.exports=function(h){for(var d=g.allocType(5123,h.length),e=0;e<h.length;++e)if(isNaN(h[e]))d[e]=65535;else if(Infinity===h[e])d[e]=31744;else if(-Infinity===h[e])d[e]=64512;else{a[0]=h[e];var c=r[0],m=c>>>31<<15,y=(c<<1>>>24)-127,c=c>>13&1023;d[e]=-24>y?m:-14>y?m+(c+1024>>-14-y):15<y?m+31744:m+(y+15<<10)+c}return d}},{"./pool":28}],31:[function(h,m,v){m.exports=function(g){return Object.keys(g).map(function(a){return g[a]})}},
{}],32:[function(h,m,v){function g(a,c,g){function h(){var c=window.innerWidth,r=window.innerHeight;a!==document.body&&(r=a.getBoundingClientRect(),c=r.right-r.left,r=r.top-r.bottom);m.width=g*c;m.height=g*r;d(m.style,{width:c+"px",height:r+"px"})}var m=document.createElement("canvas");d(m.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(m);a===document.body&&(m.style.position="absolute",d(a.style,{margin:0,padding:0}));window.addEventListener("resize",h,!1);h();return{canvas:m,onDestroy:function(){window.removeEventListener("resize",
h);a.removeChild(m)}}}function a(a,c){function d(g){try{return a.getContext(g,c)}catch(h){return null}}return d("webgl")||d("experimental-webgl")||d("webgl-experimental")}function r(a){return"string"===typeof a?a.split():a}function E(a){return"string"===typeof a?document.querySelector(a):a}var d=h("./util/extend");m.exports=function(d){var c=d||{},h,m,B,v;d={};var z=[],K=[],n="undefined"===typeof window?1:window.devicePixelRatio,q=!1,C=function(a){},k=function(){};"string"===typeof c?h=document.querySelector(c):
"object"===typeof c&&("string"===typeof c.nodeName&&"function"===typeof c.appendChild&&"function"===typeof c.getBoundingClientRect?h=c:"function"===typeof c.drawArrays||"function"===typeof c.drawElements?(v=c,B=v.canvas):("gl"in c?v=c.gl:"canvas"in c?B=E(c.canvas):"container"in c&&(m=E(c.container)),"attributes"in c&&(d=c.attributes),"extensions"in c&&(z=r(c.extensions)),"optionalExtensions"in c&&(K=r(c.optionalExtensions)),"onDone"in c&&(C=c.onDone),"profile"in c&&(q=!!c.profile),"pixelRatio"in c&&
(n=+c.pixelRatio)));h&&("canvas"===h.nodeName.toLowerCase()?B=h:m=h);if(!v){if(!B){h=g(m||document.body,C,n);if(!h)return null;B=h.canvas;k=h.onDestroy}v=a(B,d)}return v?{gl:v,canvas:B,container:m,extensions:z,optionalExtensions:K,pixelRatio:n,profile:q,onDone:C,onDestroy:k}:(k(),C("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],33:[function(h,m,v){m.exports=function(a,h){function m(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==
k.alt,k.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==k.shift,k.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==k.control,k.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==k.meta,k.meta=!!a.metaKey);return b}function d(a,b){var c=g.x(b),d=g.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==n||c!==q||d!==C||m(b))n=a|0,q=c||0,C=d||0,h&&h(n,q,C,k)}function e(a){d(0,a)}function c(){if(n||q||C||k.shift||k.alt||k.meta||k.control)n=q=C=0,k.shift=k.alt=k.control=k.meta=!1,h&&h(0,0,0,k)}function t(a){m(a)&&
h&&h(n,q,C,k)}function y(a){0===g.buttons(a)?d(0,a):d(n,a)}function v(a){d(n|g.buttons(a),a)}function F(a){d(n&~g.buttons(a),a)}function z(){b||(b=!0,a.addEventListener("mousemove",y),a.addEventListener("mousedown",v),a.addEventListener("mouseup",F),a.addEventListener("mouseleave",e),a.addEventListener("mouseenter",e),a.addEventListener("mouseout",e),a.addEventListener("mouseover",e),a.addEventListener("blur",c),a.addEventListener("keyup",t),a.addEventListener("keydown",t),a.addEventListener("keypress",
t),a!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",t),window.addEventListener("keydown",t),window.addEventListener("keypress",t)))}function K(){b&&(b=!1,a.removeEventListener("mousemove",y),a.removeEventListener("mousedown",v),a.removeEventListener("mouseup",F),a.removeEventListener("mouseleave",e),a.removeEventListener("mouseenter",e),a.removeEventListener("mouseout",e),a.removeEventListener("mouseover",e),a.removeEventListener("blur",c),a.removeEventListener("keyup",
t),a.removeEventListener("keydown",t),a.removeEventListener("keypress",t),a!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",t),window.removeEventListener("keydown",t),window.removeEventListener("keypress",t)))}h||(h=a,a=window);var n=0,q=0,C=0,k={shift:!1,alt:!1,control:!1,meta:!1},b=!1;z();var ba={element:a};Object.defineProperties(ba,{enabled:{get:function(){return b},set:function(a){a?z():K},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return q},
enumerable:!0},y:{get:function(){return C},enumerable:!0},mods:{get:function(){return k},enumerable:!0}});return ba};var g=h("mouse-event")},{"mouse-event":34}],34:[function(h,m,v){function g(a){return a.target||a.srcElement||window}v.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};v.element=
g;v.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var h=g(a).getBoundingClientRect();return a.clientX-h.left}return 0};v.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var h=g(a).getBoundingClientRect();return a.clientY-h.top}return 0}},{}],35:[function(h,m,v){var g=h("./lib/util/extend"),a=h("./lib/dynamic"),r=h("./lib/util/raf"),E=h("./lib/util/clock"),d=h("./lib/strings"),e=h("./lib/webgl"),c=h("./lib/extension"),t=h("./lib/limits"),y=h("./lib/buffer"),
B=h("./lib/elements"),F=h("./lib/texture"),z=h("./lib/renderbuffer"),K=h("./lib/framebuffer"),n=h("./lib/attribute"),q=h("./lib/shader"),C=h("./lib/read"),k=h("./lib/core"),b=h("./lib/stats"),ba=h("./lib/timer");m.exports=function(h){function m(){H=r.next(m);J.tick+=1;J.time=(E()-ra)/1E3;ca();for(var a=0;a<ga.length;++a)(0,ga[a])(J,null,0);A.flush();T&&T.update()}function v(a){}function O(a){}function V(b){function c(b){var d={},e={};Object.keys(b).forEach(function(c){var g=b[c];a.isDynamic(g)?e[c]=
a.unbox(g,c):d[c]=g});return{dynamic:e,"static":d}}function d(a){for(;r.length<a;)r.push(null);return r}var e=c(b.context||{}),h=c(b.uniforms||{}),k=c(b.attributes||{}),m=c(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=g({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(b));b={gpuTime:0,cpuTime:0,count:0};var e=U.compile(m,
k,h,e,b),n=e.draw,q=e.batch,p=e.scope,r=[];return g(function(a,b){var c;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return q.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return q.call(this,a,a.length)}else return n.call(this,a)},{stats:b})}function P(){var a=
ea.viewport,b=ea.scissor_box;a[0]=a[1]=b[0]=b[1]=0;J.viewportWidth=J.framebufferWidth=J.drawingBufferWidth=a[2]=b[2]=A.drawingBufferWidth;J.viewportHeight=J.framebufferHeight=J.drawingBufferHeight=a[3]=b[3]=A.drawingBufferHeight}function ca(){P();U.procs.poll()}function ia(){P();U.procs.refresh();T&&T.update()}var R=e(h);if(!R)return null;var A=R.gl,Q=c(A,R);if(!Q)return null;h=d();var S=b(),Q=Q.extensions,T=ba(A,Q),ra=E(),X=A.drawingBufferWidth,N=A.drawingBufferHeight,J={tick:0,time:0,viewportWidth:X,
viewportHeight:N,framebufferWidth:X,framebufferHeight:N,drawingBufferWidth:X,drawingBufferHeight:N,pixelRatio:R.pixelRatio},I=t(A,Q),Y=y(A,S),pa=B(A,Q,Y,S),X=n(A,Q,I,Y,h),sa=q(A,h,S),ja=F(A,Q,I,ca,J,S),qa=z(A,Q,I,S),la=K(A,Q,I,ja,qa,S),N=C(A,ca,J),U=k(A,h,Q,I,Y,pa,ja,la,{},X,sa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},J,T,R),ea=U.next,fa=A.canvas,ga=[],H=0;fa&&(fa.addEventListener("webglcontextlost",v,!1),fa.addEventListener("webglcontextrestored",O,!1));ia();h=g(V,{clear:function(a){var b=
0;U.procs.poll();var c=a.color;c&&(A.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(A.clearDepth(+a.depth),b|=256);"stencil"in a&&(A.clearStencil(a.stencil|0),b|=1024);A.clear(b)},prop:a.define.bind(null,1),context:a.define.bind(null,2),"this":a.define.bind(null,3),draw:V({}),buffer:function(a){return Y.create(a,34962)},elements:pa.create,texture:ja.create2D,cube:ja.createCube,renderbuffer:qa.create,framebuffer:la.create,framebufferCube:function(a){},attributes:A.getContextAttributes(),
frame:function(a){ga.push(a);!H&&0<ga.length&&m();return{cancel:function(){var b=ga.find(function(b){return b===a});0>b||(ga.splice(b,1),0>=ga.length&&H&&(r.cancel(m),H=0))}}},limits:I,hasExtension:function(a){return 0<=I.extensions.indexOf(a.toLowerCase())},read:N,destroy:function(){H&&(r.cancel(m),H=0);fa&&(fa.removeEventListener("webglcontextlost",v),fa.removeEventListener("webglcontextrestored",O));sa.clear();la.clear();qa.clear();ja.clear();pa.clear();Y.clear();T&&T.clear();R.onDestroy()},_gl:A,
_refresh:ia,poll:function(){U.procs.poll();T&&T.update()},stats:S});R.onDone(null,h);return h}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);
