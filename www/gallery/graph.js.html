<!DOCTYPE html>
      <html>
        <head>
          <title>example/graph.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(n,r,l){function a(c,m){if(!r[c]){if(!n[c]){var d="function"==typeof require&&require;if(!m&&d)return d(c,!0);if(g)return g(c,!0);d=Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d;}d=r[c]={exports:{}};n[c][0].call(d.exports,function(m){var g=n[c][1][m];return a(g?g:m)},d,d.exports,e$$0,n,r,l)}return r[c].exports}for(var g="function"==typeof require&&require,D=0;D<l.length;D++)a(l[D]);return a})({1:[function(h,n,r){function l(a){return[a%64,a/64|0]}function a(a){var c=
a.tick;G({framebuffer:J[0]},function(){g.clear({color:[0,0,0,1]});C();A({vertexState:d[(c+1)%2]})});for(a=0;4>a;++a)t({dest:J[(a+1)%2],src:J[a%2],axis:a%2});H({dest:J[1],src:J[0]});v({dest:d[(c+1)%2],src:d[c%2]});F({dest:d[c%2],src:d[(c+1)%2],field:J[1]})}var g=h("../regl")({extensions:["webgl_draw_buffers","oes_texture_float"]}),D=h("mouse-change")();h=.5/64;var c=new Float32Array(16384),m=new Float32Array(8192);(function(){for(var a=0;64>a;++a)for(var f=0;64>f;++f){var b=64*a+f;m[2*b]=a/64;m[2*
b+1]=f/64;c[4*b]=Math.random();c[4*b+1]=Math.random()}})();n=g.buffer(m);var d=[g.framebuffer({color:g.texture({radius:64,data:c,type:"float"}),depthStencil:!1}),g.framebuffer({radius:64,colorType:"float",depthStencil:!1})],w=[];(function(){for(var a=0;64>a;++a)for(var c=0;64>c;++c){if(63>a){var b=a+64*c,m=a+1+64*c;w.push([b,m],[m,b])}63>c&&(b=a+64*c,m=a+64*(c+1),w.push([b,m],[m,b]))}})();var J=[g.framebuffer({color:g.texture({type:"float",wrap:"repeat",radius:1024}),depthStencil:!1}),g.framebuffer({color:g.texture({type:"float",
wrap:"repeat",radius:1024}),depthStencil:!1})],G=g({framebuffer:g.prop("framebuffer")}),A=g({vert:"\n  precision highp float;\n  attribute vec2 id;\n  uniform sampler2D vertexState;\n  void main () {\n    vec4 state = texture2D(vertexState, id);\n    gl_Position = vec4(2.0 * fract(state.xy) - 1.0, 0, 1);\n  }",frag:"\n  precision highp float;\n  void main () {\n    gl_FragColor = vec4(1, 0, 0, 0);\n  }",attributes:{id:n},uniforms:{vertexState:g.prop("vertexState")},blend:{enable:!0,func:{src:1,dst:1},
equation:"add"},depth:{enable:!1,mask:!1},primitive:"points",count:4096,elements:null}),t=g({framebuffer:g.prop("dest"),vert:"\n  precision highp float;\n  attribute vec2 p;\n  varying vec2 uv;\n  void main () {\n    uv = 0.5 * (p + 1.0);\n    gl_Position = vec4(p, 0, 1);\n  }",frag:"\n  precision highp float;\n  uniform sampler2D src;\n  uniform vec2 axis;\n  varying vec2 uv;\n  void main () {\n    float f = 0.0;\n    for (int i = -16; i <= 16; ++i) {\n      f += (17.0 - abs(float(i))) / 33.0 *\n          texture2D(src, axis * float(i) + uv).r;\n    }\n    gl_FragColor = vec4(f, 0, 0, 1);\n  }",
attributes:{p:[-4,0,4,4,4,-4]},uniforms:{src:function(a,c){return c.src},axis:function(a,c){var b=[0,0];b[c.axis]=1/1024;return b}},depth:{enable:!1,mask:!1},count:3}),H=g({framebuffer:g.prop("dest"),vert:"\n  precision highp float;\n  attribute vec2 p;\n  varying vec2 uv;\n  void main () {\n    uv = 0.5 * (p + 1.0);\n    gl_Position = vec4(p, 0, 1);\n  }",frag:"\n  precision highp float;\n  uniform sampler2D src;\n  uniform vec2 deriv;\n  varying vec2 uv;\n  void main () {\n    float f01 = texture2D(src, uv - vec2(deriv.x, 0)).x;\n    float f21 = texture2D(src, uv + vec2(deriv.x, 0)).x;\n    float f10 = texture2D(src, uv - vec2(0, deriv.y)).x;\n    float f12 = texture2D(src, uv + vec2(0, deriv.y)).x;\n    gl_FragColor = vec4(f21 - f01, f12 - f10, 0, 1);\n  }",
attributes:{p:[-4,0,4,4,4,-4]},uniforms:{src:g.prop("src"),deriv:function(a,c){return[1/c.src.width,1/c.src.height]}},depth:{enable:!1,mask:!1},count:3}),v=g({framebuffer:g.prop("dest"),vert:"\n  precision highp float;\n  attribute vec4 edge;\n  varying vec2 force;\n  uniform sampler2D vertexState;\n  uniform float restLength, stiffness;\n  void main () {\n    vec4 s0 = texture2D(vertexState, edge.rg);\n    vec4 s1 = texture2D(vertexState, edge.ba);\n    vec2 d = s1.xy - s0.xy;\n    float l = max(length(d), 0.001);\n    force = stiffness * log(l / restLength) * d / l;\n    gl_Position = vec4(2.0 * edge.xy - 1.0 + 1.0 / 64.0, 0, 1);\n  }",
frag:"\n  precision highp float;\n  varying vec2 force;\n  void main () {\n    gl_FragColor = vec4(0, 0, force);\n  }",attributes:{edge:w.map(function(a){var c=l(a[0]);a=l(a[1]);return[c[0]/64,c[1]/64,a[0]/64,a[1]/64]})},uniforms:{vertexState:g.prop("src"),restLength:h,stiffness:.08},blend:{enable:!0,func:{src:1,dst:1},equation:"add"},depth:{enable:!1,mask:!1},count:w.length,primitive:"points"}),F=g({framebuffer:g.prop("dest"),vert:"\n  precision highp float;\n  attribute vec2 p;\n  varying vec2 id;\n  void main () {\n    id = 0.5 * (p + 1.0);\n    gl_Position = vec4(p, 0, 1);\n  }",
frag:"\n  precision highp float;\n  uniform sampler2D vertexState, field;\n  uniform float temperature, t;\n  varying vec2 id;\n\n  float rnd (vec2 co) {\n  \treturn fract(sin(t*0.1+dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n  }\n\n  void main () {\n    vec4 state = texture2D(vertexState, id);\n    vec2 p = state.rg;\n    vec2 v = state.ba;\n    vec2 force = texture2D(field, p).xy;\n    p += 1.0E-4 * v;\n    v = float(0.98) * (v - float(0.05) * force);\n    vec2 jitter = vec2(rnd(id), rnd(id + 1000.0)) - 0.5;\n    gl_FragColor = vec4(p + temperature * jitter, v);\n  }",
attributes:{p:[-4,0,4,-4,4,4]},uniforms:{vertexState:g.prop("src"),field:g.prop("field"),temperature:function(a){return 1/(.5*a.tick+20)},t:g.context("tick")},count:3}),k=g({vert:"\n  precision highp float;\n  attribute vec2 id;\n  uniform sampler2D vertexState;\n  void main () {\n    vec4 state = texture2D(vertexState, id);\n    gl_PointSize = 2.0;\n    gl_Position = vec4(2.0 * fract(state.xy) - 1.0, 0, 1);\n  }",frag:"\n  precision highp float;\n  void main () {\n    gl_FragColor = vec4(0, 0, 0, 1);\n  }",
attributes:{id:n},uniforms:{vertexState:function(a){return d[a.tick%2]}},depth:{enable:!1,mask:!1},primitive:"points",count:4096,elements:null});h=2;h>g.limits.lineWidthDims[1]&&(h=g.limits.lineWidthDims[1]);var f=g({vert:"\n  precision highp float;\n  attribute vec4 id;\n  attribute float arcDir;\n  uniform float dir;\n  uniform sampler2D vertexState;\n  void main () {\n    float side = arcDir + dir - 2.0 * dir * arcDir;\n    vec2 s0 = texture2D(vertexState, id.rg).xy;\n    vec2 s1 = texture2D(vertexState, id.ba).xy;\n    vec2 shift = mix(fract(s0) - s0, fract(s1) - s1, side);\n    gl_Position = vec4(2.0 * (s0.xy + shift) - 1.0, 0, 1);\n  }",
frag:"\n  void main () {\n    gl_FragColor = vec4(0.1, 0, 1, 1);\n  }",attributes:{id:w.map(function(a){var c=l(a[0]);a=l(a[1]);return[c[0]/64,c[1]/64,a[0]/64,a[1]/64]}),arcDir:w.map(function(a,c){return c%2})},uniforms:{vertexState:function(a){return d[a.tick%2]},dir:g.prop("dir")},depth:{enable:!1,mask:!1},count:w.length,primitive:"lines",lineWidth:h}),C=g({vert:"\n  uniform vec2 mouse;\n  attribute float p;\n  void main () {\n    gl_PointSize = 32.0;\n    gl_Position = vec4(mouse, p, 1);\n  }",
frag:"\n  precision highp float;\n  uniform float strength;\n  void main () {\n    float s = strength * exp(-16.0 * dot(gl_PointCoord.xy, gl_PointCoord.xy));\n    gl_FragColor = vec4(s, 0, 0, 1);\n  }",attributes:{p:[0]},uniforms:{mouse:function(a){var c=a.pixelRatio;return[2*c*D.x/a.drawingBufferWidth-1,1-2*c*D.y/a.drawingBufferHeight]},strength:function(){return D.buttons?5:1}},count:1,primitive:"points"});g.frame(function(c){a(c);g.clear({color:[1,1,1,1]});f([{dir:0},{dir:1}]);k()})},{"../regl":35,
"mouse-change":33}],2:[function(h,n,r){function l(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}n.exports=function(a,g,D,c,m){a=D.maxAttributes;g=Array(a);for(D=0;D<a;++D)g[D]=new l;return{Record:l,scope:{},state:g}}},{}],3:[function(h,n,r){function l(a){return J[Object.prototype.toString.call(a)]|0}function a(a,c){for(var m=0;m<c.length;++m)a[m]=c[m]}function g(a,c,m,g,f,d,l){for(var w=0,b=0;b<m;++b)for(var I=
0;I<g;++I)a[w++]=c[f*b+d*I+l]}function D(a,c,m){for(var g=0,f=0;f<c.length;++f)for(var d=c[f],l=0;l<m;++l)a[g++]=d[l]}var c=h("./util/is-typed-array"),m=h("./util/is-ndarray"),d=h("./util/values"),w=h("./util/pool"),J=h("./constants/arraytypes.json"),G=h("./constants/dtypes.json"),A=h("./constants/usage.json"),t=[];t[5120]=1;t[5122]=2;t[5124]=4;t[5121]=1;t[5123]=2;t[5125]=4;t[5126]=4;n.exports=function(h,v,n){function k(a){this.id=q++;this.buffer=h.createBuffer();this.type=a;this.usage=35044;this.byteLength=
0;this.dimension=1;this.dtype=5121;this.persistentData=null;n.profile&&(this.stats={size:0})}function f(a,c,b){a.byteLength=c.byteLength;h.bufferData(a.type,c,b)}function C(b,d,h,k,q,I){b.usage=h;if(Array.isArray(d))b.dtype=k||5126,0<d.length&&(Array.isArray(d[0])?(b.dimension=d[0].length,k=w.allocType(b.dtype,d.length*b.dimension),D(k,d,b.dimension),f(b,k,h),I?b.persistentData=k:w.freeType(k)):"number"===typeof d[0]?(b.dimension=q,k=w.allocType(b.dtype,d.length),a(k,d),f(b,k,h),I?b.persistentData=
k:w.freeType(k)):c(d[0])&&(b.dimension=d[0].length,b.dtype=k||l(d[0])||5126,k=w.allocType(b.dtype,d.length*b.dimension),D(k,d,b.dimension),f(b,k,h),I?b.persistentData=k:w.freeType(k)));else if(c(d))b.dtype=k||l(d),b.dimension=q,f(b,d,h),I&&(b.persistentData=new Uint8Array(new Uint8Array(d.buffer)));else if(m(d)){var t=d.shape,v=d.stride;q=d.offset;var C=0,A=0,p=0,W=0;1===t.length?(C=t[0],A=1,p=v[0],W=0):2===t.length&&(C=t[0],A=t[1],p=v[0],W=v[1]);b.dtype=k||l(d.data)||5126;b.dimension=A;k=w.allocType(b.dtype,
C*A);g(k,d.data,C,A,p,W,q);f(b,k,h);I?b.persistentData=k:w.freeType(k)}}function B(a){v.bufferCount--;h.deleteBuffer(a.buffer);a.buffer=null;delete b[a.id]}var q=0,b={};k.prototype.bind=function(){h.bindBuffer(this.type,this.buffer)};k.prototype.destroy=function(){B(this)};var I=[];n.profile&&(v.getTotalBufferSize=function(){var a=0;Object.keys(b).forEach(function(c){a+=b[c].stats.size});return a});return{create:function(d,f,I,q){function J(a){var b=35044,d=null,f=0,g=0,k=1;Array.isArray(a)||c(a)||
m(a)?d=a:"number"===typeof a?f=a|0:a&&("data"in a&&(d=a.data),"usage"in a&&(b=A[a.usage]),"type"in a&&(g=G[a.type]),"dimension"in a&&(k=a.dimension|0),"length"in a&&(f=a.length|0));r.bind();d?C(r,d,b,g,k,q):(h.bufferData(r.type,f,b),r.dtype=g||5121,r.usage=b,r.dimension=k,r.byteLength=f);n.profile&&(r.stats.size=r.byteLength*t[r.dtype]);return J}v.bufferCount++;var r=new k(f);b[r.id]=r;I||J(d);J._reglType="buffer";J._buffer=r;J.subdata=function(b,d){var f=(d||0)|0;r.bind();if(Array.isArray(b)){if(0<
b.length)if("number"===typeof b[0]){var k=w.allocType(r.dtype,b.length);a(k,b);h.bufferSubData(r.type,f,k);w.freeType(k)}else if(Array.isArray(b[0])||c(b[0])){var k=b[0].length,p=w.allocType(r.dtype,b.length*k);D(p,b,k);h.bufferSubData(r.type,f,p);w.freeType(p)}}else if(c(b))h.bufferSubData(r.type,f,b);else if(m(b)){var I=b.shape,q=b.stride,t=p=k=0,v=0;1===I.length?(k=I[0],p=1,t=q[0],v=0):2===I.length&&(k=I[0],p=I[1],t=q[0],v=q[1]);I=Array.isArray(b.data)?r.dtype:l(b.data);I=w.allocType(I,k*p);g(I,
b.data,k,p,t,v,b.offset);h.bufferSubData(r.type,f,I);w.freeType(I)}return J};n.profile&&(J.stats=r.stats);J.destroy=function(){B(r)};return J},createStream:function(a,b){var c=I.pop();c||(c=new k(a));c.bind();C(c,b,35040,0,1,!1);return c},destroyStream:function(a){I.push(a)},clear:function(){d(b).forEach(B);I.forEach(B)},getBuffer:function(a){return a&&a._buffer instanceof k?a._buffer:null},restore:function(){d(b).forEach(function(a){a.buffer=h.createBuffer();h.bindBuffer(a.type,a.buffer);h.bufferData(a.type,
a.persistentData||a.byteLength,a.usage)})},_initBuffer:C}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(h,n,r){n.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,
"[object ArrayBuffer]":5121}},{}],5:[function(h,n,r){n.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(h,n,r){n.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(h,n,r){n.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(h,n,r){function l(a){return Array.isArray(a)||J(a)||G(a)}function a(a){return a.sort(function(a,
b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function g(a,b,c,d){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=d}function D(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function c(a){return new g(!1,!1,!1,a)}function m(a,b){var c=a.type;return 0===c?(c=a.data.length,new g(!0,1<=c,2<=c,b)):4===c?(c=a.data,new g(c.thisDep,c.contextDep,c.propDep,b)):new g(3===c,2===c,1===c,b)}var d=h("./util/codegen"),w=h("./util/loop"),J=h("./util/is-typed-array"),G=h("./util/is-ndarray"),
A=h("./util/is-array-like"),t=h("./dynamic"),H=h("./constants/primitives.json"),v=h("./constants/dtypes.json"),F=["x","y","z","w"],k="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),f={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,
"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},C={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},B={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},q={cw:2304,ccw:2305},b=new g(!1,!1,!1,function(){});n.exports=function(h,n,r,J,G,ja,ka,N,ta,la,ua,p,W,X,fa){function T(a){return a.replace(".",
"_")}function L(a,e,b){var c=T(a);Ga.push(a);x[c]=y[c]=!!b;va[c]=e}function E(a,e,b){var c=T(a);Ga.push(a);Array.isArray(b)?(y[c]=b.slice(),x[c]=b.slice()):y[c]=x[c]=b;wa[c]=e}function xa(){var a=d(),e=a.link,b=a.global;a.id=Pa++;a.batchId="0";var c=e(Na),m=a.shared={props:"a0"};Object.keys(Na).forEach(function(a){m[a]=b.def(c,".",a)});var f=a.next={},M=a.current={};Object.keys(wa).forEach(function(a){Array.isArray(y[a])&&(f[a]=b.def(m.next,".",a),M[a]=b.def(m.current,".",a))});var Qa=a.constants=
{};Object.keys(Ha).forEach(function(a){Qa[a]=b.def(JSON.stringify(Ha[a]))});a.invoke=function(O,b){switch(b.type){case 0:var c=["this",m.context,m.props,a.batchId];return O.def(e(b.data),".call(",c.slice(0,Math.max(b.data.length+1,4)),")");case 1:return O.def(m.props,b.data);case 2:return O.def(m.context,b.data);case 3:return O.def("this",b.data);case 4:return b.data.append(a,O),b.data.ref}};a.attribCache={};var O={};a.scopeAttrib=function(a){a=n.id(a);if(a in O)return O[a];var b=la.scope[a];b||(b=
la.scope[a]=new Z);return O[a]=e(b)};return a}function ma(a){var e=a["static"];a=a.dynamic;var b;if("profile"in e){var d=!!e.profile;b=c(function(a,e){return d});b.enable=d}else if("profile"in a){var f=a.profile;b=m(f,function(a,e){return a.invoke(e,f)})}return b}function ya(a,e){var b=a["static"],d=a.dynamic;if("framebuffer"in b){var f=b.framebuffer;return f?(f=N.getFramebuffer(f),c(function(a,e){var b=a.link(f),u=a.shared;e.set(u.framebuffer,".next",b);u=u.context;e.set(u,".framebufferWidth",b+
".width");e.set(u,".framebufferHeight",b+".height");return b})):c(function(a,e){var b=a.shared;e.set(b.framebuffer,".next","null");b=b.context;e.set(b,".framebufferWidth",b+".drawingBufferWidth");e.set(b,".framebufferHeight",b+".drawingBufferHeight");return"null"})}if("framebuffer"in d){var Oa=d.framebuffer;return m(Oa,function(a,e){var b=a.invoke(e,Oa),u=a.shared,c=u.framebuffer,b=e.def(c,".getFramebuffer(",b,")");e.set(c,".next",b);u=u.context;e.set(u,".framebufferWidth",b+"?"+b+".width:"+u+".drawingBufferWidth");
e.set(u,".framebufferHeight",b+"?"+b+".height:"+u+".drawingBufferHeight");return b})}return null}function Q(a,e,b){function c(a){if(a in d){var b=d[a];a=!0;var u=b.x|0,Aa=b.y|0,M,Ma;"width"in b?M=b.width|0:a=!1;"height"in b?Ma=b.height|0:a=!1;return new g(!a&&e&&e.thisDep,!a&&e&&e.contextDep,!a&&e&&e.propDep,function(a,e){var c=a.shared.context,z=M;"width"in b||(z=e.def(c,".","framebufferWidth","-",u));var d=Ma;"height"in b||(d=e.def(c,".","framebufferHeight","-",Aa));return[u,Aa,z,d]})}if(a in f){var k=
f[a];a=m(k,function(a,e){var b=a.invoke(e,k),u=a.shared.context,c=e.def(b,".x|0"),O=e.def(b,".y|0"),Aa=e.def('"width" in ',b,"?",b,".width|0:","(",u,".","framebufferWidth","-",c,")"),b=e.def('"height" in ',b,"?",b,".height|0:","(",u,".","framebufferHeight","-",O,")");return[c,O,Aa,b]});e&&(a.thisDep=a.thisDep||e.thisDep,a.contextDep=a.contextDep||e.contextDep,a.propDep=a.propDep||e.propDep);return a}return e?new g(e.thisDep,e.contextDep,e.propDep,function(a,e){var b=a.shared.context;return[0,0,e.def(b,
".","framebufferWidth"),e.def(b,".","framebufferHeight")]}):null}var d=a["static"],f=a.dynamic;if(a=c("viewport")){var M=a;a=new g(a.thisDep,a.contextDep,a.propDep,function(a,e){var b=M.append(a,e),u=a.shared.context;e.set(u,".viewportWidth",b[2]);e.set(u,".viewportHeight",b[3]);return b})}return{viewport:a,scissor_box:c("scissor.box")}}function ca(a){function e(a){if(a in b){var u=n.id(b[a]);a=c(function(){return u});a.id=u;return a}if(a in d){var z=d[a];return m(z,function(a,e){var b=a.invoke(e,
z);return e.def(a.shared.strings,".id(",b,")")})}return null}var b=a["static"],d=a.dynamic,f=e("frag"),k=e("vert"),M=null;D(f)&&D(k)?(M=ua.program(k.id,f.id),a=c(function(a,e){return a.link(M)})):a=new g(f&&f.thisDep||k&&k.thisDep,f&&f.contextDep||k&&k.contextDep,f&&f.propDep||k&&k.propDep,function(a,e){var b=a.shared.shader,u;u=f?f.append(a,e):e.def(b,".","frag");var c;c=k?k.append(a,e):e.def(b,".","vert");return e.def(b+".program("+c+","+u+")")});return{frag:f,vert:k,progVar:a,program:M}}function da(a,
e){function b(a,e){if(a in d){var u=d[a]|0;return c(function(a,b){e&&(a.OFFSET=u);return u})}if(a in f){var Aa=f[a];return m(Aa,function(a,b){var u=a.invoke(b,Aa);e&&(a.OFFSET=u);return u})}return e&&k?c(function(a,e){a.OFFSET="0";return 0}):null}var d=a["static"],f=a.dynamic,k=function(){if("elements"in d){var a=d.elements;l(a)?a=ja.getElements(ja.create(a,!0)):a&&(a=ja.getElements(a));var e=c(function(e,b){if(a){var u=e.link(a);return e.ELEMENTS=u}return e.ELEMENTS=null});e.value=a;return e}if("elements"in
f){var b=f.elements;return m(b,function(a,e){var u=a.shared,c=u.isBufferArgs,u=u.elements,O=a.invoke(e,b),z=e.def("null"),c=e.def(c,"(",O,")"),O=a.cond(c).then(z,"=",u,".createStream(",O,");")["else"](z,"=",u,".getElements(",O,");");e.entry(O);e.exit(a.cond(c).then(u,".destroyStream(",z,");"));return a.ELEMENTS=z})}return null}(),M=b("offset",!0);return{elements:k,primitive:function(){if("primitive"in d){var a=d.primitive;return c(function(e,b){return H[a]})}if("primitive"in f){var e=f.primitive;
return m(e,function(a,b){var u=a.constants.primTypes,c=a.invoke(b,e);return b.def(u,"[",c,"]")})}return k?D(k)?k.value?c(function(a,e){return e.def(a.ELEMENTS,".primType")}):c(function(){return 4}):new g(k.thisDep,k.contextDep,k.propDep,function(a,e){var b=a.ELEMENTS;return e.def(b,"?",b,".primType:",4)}):null}(),count:function(){if("count"in d){var a=d.count|0;return c(function(){return a})}if("count"in f){var e=f.count;return m(e,function(a,b){return a.invoke(b,e)})}return k?D(k)?k?M?new g(M.thisDep,
M.contextDep,M.propDep,function(a,e){return e.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):c(function(a,e){return e.def(a.ELEMENTS,".vertCount")}):c(function(){return-1}):new g(k.thisDep||M.thisDep,k.contextDep||M.contextDep,k.propDep||M.propDep,function(a,e){var b=a.ELEMENTS;return a.OFFSET?e.def(b,"?",b,".vertCount-",a.OFFSET,":-1"):e.def(b,"?",b,".vertCount:-1")}):null}(),instances:b("instances",!1),offset:M}}function pa(a,e){var b=a["static"],d=a.dynamic,k={};Ga.forEach(function(a){function e(O,z){if(a in
b){var f=O(b[a]);k[u]=c(function(){return f})}else if(a in d){var M=d[a];k[u]=m(M,function(a,e){return z(a,e,a.invoke(e,M))})}}var u=T(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return e(function(a){return a},function(a,e,b){return b});case "depth.func":return e(function(a){return C[a]},function(a,e,b){return e.def(a.constants.compareFuncs,
"[",b,"]")});case "depth.range":return e(function(a){return a},function(a,e,b){a=e.def("+",b,"[0]");e=e.def("+",b,"[1]");return[a,e]});case "blend.func":return e(function(a){return[f["srcRGB"in a?a.srcRGB:a.src],f["dstRGB"in a?a.dstRGB:a.dst],f["srcAlpha"in a?a.srcAlpha:a.src],f["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,e,b){function u(a,c){return e.def('"',a,c,'" in ',b,"?",b,".",a,c,":",b,".",a)}a=a.constants.blendFuncs;var c=u("src","RGB"),z=u("dst","RGB"),c=e.def(a,"[",c,"]"),d=e.def(a,"[",
u("src","Alpha"),"]"),z=e.def(a,"[",z,"]");a=e.def(a,"[",u("dst","Alpha"),"]");return[c,z,d,a]});case "blend.equation":return e(function(a){if("string"===typeof a)return[ga[a],ga[a]];if("object"===typeof a)return[ga[a.rgb],ga[a.alpha]]},function(a,e,b){var u=a.constants.blendEquations,c=e.def(),z=e.def();a=a.cond("typeof ",b,'==="string"');a.then(c,"=",z,"=",u,"[",b,"];");a["else"](c,"=",u,"[",b,".rgb];",z,"=",u,"[",b,".alpha];");e(a);return[c,z]});case "blend.color":return e(function(a){return w(4,
function(e){return+a[e]})},function(a,e,b){return w(4,function(a){return e.def("+",b,"[",a,"]")})});case "stencil.mask":return e(function(a){return a|0},function(a,e,b){return e.def(b,"|0")});case "stencil.func":return e(function(a){return[C[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,e,b){a=e.def('"cmp" in ',b,"?",a.constants.compareFuncs,"[",b,".cmp]",":",7680);var u=e.def(b,".ref|0");e=e.def('"mask" in ',b,"?",b,".mask|0:-1");return[a,u,e]});case "stencil.opFront":case "stencil.opBack":return e(function(e){return["stencil.opBack"===
a?1029:1028,B[e.fail||"keep"],B[e.zfail||"keep"],B[e.zpass||"keep"]]},function(e,b,u){function c(a){return b.def('"',a,'" in ',u,"?",z,"[",u,".",a,"]:",7680)}var z=e.constants.stencilOps;return["stencil.opBack"===a?1029:1028,c("fail"),c("zfail"),c("zpass")]});case "polygonOffset.offset":return e(function(a){return[a.factor|0,a.units|0]},function(a,e,b){a=e.def(b,".factor|0");e=e.def(b,".units|0");return[a,e]});case "cull.face":return e(function(a){var e=0;"front"===a?e=1028:"back"===a&&(e=1029);return e},
function(a,e,b){return e.def(b,'==="front"?',1028,":",1029)});case "lineWidth":return e(function(a){return a},function(a,e,b){return b});case "frontFace":return e(function(a){return q[a]},function(a,e,b){return e.def(b+'==="cw"?2304:2305')});case "colorMask":return e(function(a){return a.map(function(a){return!!a})},function(a,e,b){return w(4,function(a){return"!!"+b+"["+a+"]"})});case "sample.coverage":return e(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,e,b){a=e.def('"value" in ',
b,"?+",b,".value:1");e=e.def("!!",b,".invert");return[a,e]})}});return k}function ea(a,e){var b=a["static"],d=a.dynamic,f={};Object.keys(b).forEach(function(a){var e=b[a],u;if("number"===typeof e||"boolean"===typeof e)u=c(function(){return e});else if("function"===typeof e){var z=e._reglType;if("texture2d"===z||"textureCube"===z)u=c(function(a){return a.link(e)});else if("framebuffer"===z||"framebufferCube"===z)u=c(function(a){return a.link(e.color[0])})}else A(e)&&(u=c(function(a){return a.global.def("[",
w(e.length,function(a){return e[a]}),"]")}));u.value=e;f[a]=u});Object.keys(d).forEach(function(a){var e=d[a];f[a]=m(e,function(a,b){return a.invoke(b,e)})});return f}function U(a,e){var b=a["static"],d=a.dynamic,f={};Object.keys(b).forEach(function(a){var e=b[a],u=n.id(a),z=new Z;if(l(e))z.state=1,z.buffer=G.getBuffer(G.create(e,34962,!1,!0)),z.type=0;else{var d=G.getBuffer(e);if(d)z.state=1,z.buffer=d,z.type=0;else if(e.constant){var k=e.constant;z.buffer="null";z.state=2;"number"===typeof k?z.x=
k:F.forEach(function(a,e){e<k.length&&(z[a]=k[e])})}else{var d=l(e.buffer)?G.getBuffer(G.create(e.buffer,34962,!1,!0)):G.getBuffer(e.buffer),m=e.offset|0,g=e.stride|0,x=e.size|0,y=!!e.normalized,p=0;"type"in e&&(p=v[e.type]);e=e.divisor|0;z.buffer=d;z.state=1;z.size=x;z.normalized=y;z.type=p||d.dtype;z.offset=m;z.stride=g;z.divisor=e}}f[a]=c(function(a,e){var b=a.attribCache;if(u in b)return b[u];var c={isStream:!1};Object.keys(z).forEach(function(a){c[a]=z[a]});z.buffer&&(c.buffer=a.link(z.buffer),
c.type=c.type||c.buffer+".dtype");return b[u]=c})});Object.keys(d).forEach(function(a){var e=d[a];f[a]=m(e,function(a,b){function u(a){b(k[a],"=",c,".",a,"|0;")}var c=a.invoke(b,e),z=a.shared,d=z.isBufferArgs,f=z.buffer,k={isStream:b.def(!1)},m=new Z;m.state=1;Object.keys(m).forEach(function(a){k[a]=b.def(""+m[a])});var g=k.buffer,x=k.type;b("if(",d,"(",c,")){",k.isStream,"=true;",g,"=",f,".createStream(",34962,",",c,");",x,"=",g,".dtype;","}else{",g,"=",f,".getBuffer(",c,");","if(",g,"){",x,"=",
g,".dtype;",'}else if("constant" in ',c,"){",k.state,"=",2,";","if(typeof "+c+'.constant === "number"){',k[F[0]],"=",c,".constant;",F.slice(1).map(function(a){return k[a]}).join("="),"=0;","}else{",F.map(function(a,e){return k[a]+"="+c+".constant.length>="+e+"?"+c+".constant["+e+"]:0;"}).join(""),"}}else{","if(",d,"(",c,".buffer)){",g,"=",f,".createStream(",34962,",",c,".buffer);","}else{",g,"=",f,".getBuffer(",c,".buffer);","}",x,'="type" in ',c,"?",z.glTypes,"[",c,".type]:",g,".dtype;",k.normalized,
"=!!",c,".normalized;");u("size");u("offset");u("stride");u("divisor");b("}}");b.exit("if(",k.isStream,"){",f,".destroyStream(",g,");","}");return k})});return f}function qa(a){var e=a["static"],b=a.dynamic,d={};Object.keys(e).forEach(function(a){var b=e[a];d[a]=c(function(a,e){return"number"===typeof b||"boolean"===typeof b?""+b:a.link(b)})});Object.keys(b).forEach(function(a){var e=b[a];d[a]=m(e,function(a,b){return a.invoke(b,e)})});return d}function na(a,e,b,c,d){var f=ya(a,d),k=Q(a,f,d),m=da(a,
d),g=pa(a,d),x=ca(a,d),y=k.viewport;y&&(g.viewport=y);y=T("scissor.box");(k=k[y])&&(g[y]=k);k=0<Object.keys(g).length;f={framebuffer:f,draw:m,shader:x,state:g,dirty:k};f.profile=ma(a,d);f.uniforms=ea(b,d);f.attributes=U(e,d);f.context=qa(c,d);return f}function K(a,e,b){var c=a.shared.context,d=a.scope();Object.keys(b).forEach(function(f){e.save(c,"."+f);d(c,".",f,"=",b[f].append(a,e),";")});e(d)}function Y(a,b,c,d){var f=a.shared,k=f.gl,m=f.framebuffer,g;e&&(g=b.def(f.extensions,".webgl_draw_buffers"));
var x=a.constants,f=x.drawBuffer,x=x.backBuffer;a=c?c.append(a,b):b.def(m,".next");d||b("if(",a,"!==",m,".cur){");b("if(",a,"){",k,".bindFramebuffer(",36160,",",a,".framebuffer);");e&&b(g,".drawBuffersWEBGL(",f,"[",a,".colorAttachments.length]);");b("}else{",k,".bindFramebuffer(",36160,",null);");e&&b(g,".drawBuffersWEBGL(",x,");");b("}",m,".cur=",a,";");d||b("}")}function aa(a,e,b){var c=a.shared,d=c.gl,f=a.current,k=a.next,m=c.current,g=c.next,x=a.cond(m,".dirty");Ga.forEach(function(e){e=T(e);
if(!(e in b.state)){var c,z;if(e in k){c=k[e];z=f[e];var p=w(y[e].length,function(a){return x.def(c,"[",a,"]")});x(a.cond(p.map(function(a,e){return a+"!=="+z+"["+e+"]"}).join("||")).then(d,".",wa[e],"(",p,");",p.map(function(a,e){return z+"["+e+"]="+a}).join(";"),";"))}else c=x.def(g,".",e),p=a.cond(c,"!==",m,".",e),x(p),e in va?p(a.cond(c).then(d,".enable(",va[e],");")["else"](d,".disable(",va[e],");"),m,".",e,"=",c,";"):p(d,".",wa[e],"(",c,");",m,".",e,"=",c,";")}});0===Object.keys(b.state).length&&
x(m,".dirty=false;");e(x)}function P(e,b,c,d){var f=e.shared,k=e.current,m=f.current,g=f.gl;a(Object.keys(c)).forEach(function(a){var f=c[a];if(!d||d(f)){var x=f.append(e,b);if(va[a]){var y=va[a];D(f)?x?b(g,".enable(",y,");"):b(g,".disable(",y,");"):b(e.cond(x).then(g,".enable(",y,");")["else"](g,".disable(",y,");"));b(m,".",a,"=",x,";")}else if(A(x)){var p=k[a];b(g,".",wa[a],"(",x,");",x.map(function(a,e){return p+"["+e+"]="+a}).join(";"),";")}else b(g,".",wa[a],"(",x,");",m,".",a,"=",x,";")}})}
function R(a,e){ha&&(a.instancing=e.def(a.shared.extensions,".angle_instanced_arrays"))}function S(a,e,b,c,d){function f(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function k(a){h=e.def();a(h,"=",f(),";");"string"===typeof d?a(y,".count+=",d,";"):a(y,".count++;");X&&(c?(q=e.def(),a(q,"=",l,".getNumPendingQueries();")):a(l,".beginQuery(",y,");"))}function m(a){a(y,".cpuTime+=",f(),"-",h,";");X&&(c?a(l,".pushScopeStats(",q,",",l,".getNumPendingQueries(),",y,");"):a(l,
".endQuery();"))}function g(a){var b=e.def(p,".profile");e(p,".profile=",a,";");e.exit(p,".profile=",b,";")}var x=a.shared,y=a.stats,p=x.current,l=x.timer;b=b.profile;var h,q;if(b){if(D(b)){b.enable?(k(e),m(e.exit),g("true")):g("false");return}b=b.append(a,e);g(b)}else b=e.def(p,".profile");x=a.block();k(x);e("if(",b,"){",x,"}");a=a.block();m(a);e.exit("if(",b,"){",a,"}")}function V(a,e,c,d,f){function k(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;
case 35666:case 35669:case 35673:return 4;default:return 1}}function m(b,c,d){function f(){e("if(!",p,".buffer){",x,".enableVertexAttribArray(",y,");}");var b=d.type,k;k=d.size?e.def(d.size,"||",c):c;e("if(",p,".type!==",b,"||",p,".size!==",k,"||",q.map(function(a){return p+"."+a+"!=="+d[a]}).join("||"),"){",x,".bindBuffer(",34962,",",l,".buffer);",x,".vertexAttribPointer(",[y,k,b,d.normalized,d.stride,d.offset],");",p,".type=",b,";",p,".size=",k,";",q.map(function(a){return p+"."+a+"="+d[a]+";"}).join(""),
"}");ha&&(b=d.divisor,e("if(",p,".divisor!==",b,"){",a.instancing,".vertexAttribDivisorANGLE(",[y,b],");",p,".divisor=",b,";}"))}function k(){e("if(",p,".buffer){",x,".disableVertexAttribArray(",y,");","}if(",F.map(function(a,e){return p+"."+a+"!=="+h[e]}).join("||"),"){",x,".vertexAttrib4f(",y,",",h,");",F.map(function(a,e){return p+"."+a+"="+h[e]+";"}).join(""),"}")}var x=g.gl,y=e.def(b,".location"),p=e.def(g.attributes,"[",y,"]");b=d.state;var l=d.buffer,h=[d.x,d.y,d.z,d.w],q=["buffer","normalized",
"offset","stride"];1===b?f():2===b?k():(e("if(",b,"===",1,"){"),f(),e("}else{"),k(),e("}"))}var g=a.shared;d.forEach(function(d){var g=d.name,x=c.attributes[g],y;if(x){if(!f(x))return;y=x.append(a,e)}else{if(!f(b))return;var p=a.scopeAttrib(g);y={};Object.keys(new Z).forEach(function(a){y[a]=e.def(p,".",a)})}m(a.link(d),k(d.info.type),y)})}function ba(a,e,c,d,f){for(var k=a.shared,m=k.gl,g,x=0;x<d.length;++x){var y=d[x],p=y.name,l=y.info.type,h=c.uniforms[p],y=a.link(y)+".location",q;if(h){if(!f(h))continue;
if(D(h)){p=h.value;if(35678===l||35680===l)l=a.link(p._texture||p.color[0]._texture),e(m,".uniform1i(",y,",",l+".bind());"),e.exit(l,".unbind();");else if(35674===l||35675===l||35676===l)p=a.global.def("new Float32Array(["+Array.prototype.slice.call(p)+"])"),h=2,35675===l?h=3:35676===l&&(h=4),e(m,".uniformMatrix",h,"fv(",y,",false,",p,");");else{switch(l){case 5126:g="1f";break;case 35664:g="2f";break;case 35665:g="3f";break;case 35666:g="4f";break;case 35670:g="1i";break;case 5124:g="1i";break;case 35671:g=
"2i";break;case 35667:g="2i";break;case 35672:g="3i";break;case 35668:g="3i";break;case 35673:g="4i";break;case 35669:g="4i"}e(m,".uniform",g,"(",y,",",A(p)?Array.prototype.slice.call(p):p,");")}continue}else q=h.append(a,e)}else{if(!f(b))continue;q=e.def(k.uniforms,"[",n.id(p),"]")}35678===l?e("if(",q,"&&",q,'._reglType==="framebuffer"){',q,"=",q,".color[0];","}"):35680===l&&e("if(",q,"&&",q,'._reglType==="framebufferCube"){',q,"=",q,".color[0];","}");p=1;switch(l){case 35678:case 35680:l=e.def(q,
"._texture");e(m,".uniform1i(",y,",",l,".bind());");e.exit(l,".unbind();");continue;case 5124:case 35670:g="1i";break;case 35667:case 35671:g="2i";p=2;break;case 35668:case 35672:g="3i";p=3;break;case 35669:case 35673:g="4i";p=4;break;case 5126:g="1f";break;case 35664:g="2f";p=2;break;case 35665:g="3f";p=3;break;case 35666:g="4f";p=4;break;case 35674:g="Matrix2fv";break;case 35675:g="Matrix3fv";break;case 35676:g="Matrix4fv"}e(m,".uniform",g,"(",y,",");if("M"===g.charAt(0)){var y=Math.pow(l-35674+
2,2),t=a.global.def("new Float32Array(",y,")");e("false,(Array.isArray(",q,")||",q," instanceof Float32Array)?",q,":(",w(y,function(a){return t+"["+a+"]="+q+"["+a+"]"}),",",t,")")}else 1<p?e(w(p,function(a){return q+"["+a+"]"})):e(q);e(");")}}function oa(a,e,b,c){function d(f){var k=y[f];return k?k.contextDep&&c.contextDynamic||k.propDep?k.append(a,b):k.append(a,e):e.def(x,".",f)}function f(){function a(){b(w,".drawElementsInstancedANGLE(",[l,q,v,h+"<<(("+v+"-5121)>>1)",t],");")}function e(){b(w,
".drawArraysInstancedANGLE(",[l,h,q,t],");")}p?I?a():(b("if(",p,"){"),a(),b("}else{"),e(),b("}")):e()}function k(){function a(){b(m+".drawElements("+[l,q,v,h+"<<(("+v+"-5121)>>1)"]+");")}function e(){b(m+".drawArrays("+[l,h,q]+");")}p?I?a():(b("if(",p,"){"),a(),b("}else{"),e(),b("}")):e()}var g=a.shared,m=g.gl,x=g.draw,y=c.draw,p=function(){var d=y.elements,f=e;if(d){if(d.contextDep&&c.contextDynamic||d.propDep)f=b;d=d.append(a,f)}else d=f.def(x,".","elements");d&&f("if("+d+")"+m+".bindBuffer(34963,"+
d+".buffer.buffer);");return d}(),l=d("primitive"),h=d("offset"),q=function(){var d=y.count,f=e;if(d){if(d.contextDep&&c.contextDynamic||d.propDep)f=b;d=d.append(a,f)}else d=f.def(x,".","count");return d}();if("number"===typeof q){if(0===q)return}else b("if(",q,"){"),b.exit("}");var t,w;ha&&(t=d("instances"),w=a.instancing);var v=p+".type",I=y.elements&&D(y.elements);ha&&("number"!==typeof t||0<=t)?"string"===typeof t?(b("if(",t,">0){"),f(),b("}else if(",t,"<0){"),k(),b("}")):f():k()}function Ba(a,
e,b,c,d){e=xa();d=e.proc("body",d);ha&&(e.instancing=d.def(e.shared.extensions,".angle_instanced_arrays"));a(e,d,b,c);return e.compile().body}function Ca(a,e,b,c){R(a,e);V(a,e,b,c.attributes,function(){return!0});ba(a,e,b,c.uniforms,function(){return!0});oa(a,e,e,b)}function Da(a,e){var b=a.proc("draw",1);R(a,b);K(a,b,e.context);Y(a,b,e.framebuffer);aa(a,b,e);P(a,b,e.state);S(a,b,e,!1,!0);var c=e.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",c,".program);");if(e.shader.program)Ca(a,b,e,
e.shader.program);else{var d=a.global.def("{}"),f=b.def(c,".id"),k=b.def(d,"[",f,"]");b(a.cond(k).then(k,".call(this,a0);")["else"](k,"=",d,"[",f,"]=",a.link(function(b){return Ba(Ca,a,e,b,1)}),"(",c,");",k,".call(this,a0);"))}0<Object.keys(e.state).length&&b(a.shared.current,".dirty=true;")}function Ea(a,e,b,c){function d(){return!0}a.batchId="a1";R(a,e);V(a,e,b,c.attributes,d);ba(a,e,b,c.uniforms,d);oa(a,e,e,b)}function ra(a,e,b,c){function d(a){return a.contextDep&&k||a.propDep}function f(a){return!d(a)}
R(a,e);var k=b.contextDep,g=e.def(),m=e.def();a.shared.props=m;a.batchId=g;var x=a.scope(),y=a.scope();e(x.entry,"for(",g,"=0;",g,"<","a1",";++",g,"){",m,"=","a0","[",g,"];",y,"}",x.exit);b.needsContext&&K(a,y,b.context);b.needsFramebuffer&&Y(a,y,b.framebuffer);P(a,y,b.state,d);b.profile&&d(b.profile)&&S(a,y,b,!1,!0);c?(V(a,x,b,c.attributes,f),V(a,y,b,c.attributes,d),ba(a,x,b,c.uniforms,f),ba(a,y,b,c.uniforms,d),oa(a,x,y,b)):(e=a.global.def("{}"),c=b.shader.progVar.append(a,y),m=y.def(c,".id"),x=
y.def(e,"[",m,"]"),y(a.shared.gl,".useProgram(",c,".program);","if(!",x,"){",x,"=",e,"[",m,"]=",a.link(function(e){return Ba(Ea,a,b,e,2)}),"(",c,");}",x,".call(this,a0[",g,"],",g,");"))}function La(a,e){function b(a){return a.contextDep&&d||a.propDep}var c=a.proc("batch",2);a.batchId="0";R(a,c);var d=!1,f=!0;Object.keys(e.context).forEach(function(a){d=d||e.context[a].propDep});d||(K(a,c,e.context),f=!1);var k=e.framebuffer,g=!1;k?(k.propDep?d=g=!0:k.contextDep&&d&&(g=!0),g||Y(a,c,k)):Y(a,c,null);
e.state.viewport&&e.state.viewport.propDep&&(d=!0);aa(a,c,e);P(a,c,e.state,function(a){return!b(a)});e.profile&&b(e.profile)||S(a,c,e,!1,"a1");e.contextDep=d;e.needsContext=f;e.needsFramebuffer=g;f=e.shader.progVar;if(f.contextDep&&d||f.propDep)ra(a,c,e,null);else if(f=f.append(a,c),c(a.shared.gl,".useProgram(",f,".program);"),e.shader.program)ra(a,c,e,e.shader.program);else{var k=a.global.def("{}"),g=c.def(f,".id"),m=c.def(k,"[",g,"]");c(a.cond(m).then(m,".call(this,a0,a1);")["else"](m,"=",k,"[",
g,"]=",a.link(function(b){return Ba(ra,a,e,b,2)}),"(",f,");",m,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&c(a.shared.current,".dirty=true;")}function Ia(e,b){function c(a){var k=b.shader[a];k&&d.set(f.shader,"."+a,k.append(e,d))}var d=e.proc("scope",3);e.batchId="a2";var f=e.shared,k=f.current;K(e,d,b.context);b.framebuffer&&b.framebuffer.append(e,d);a(Object.keys(b.state)).forEach(function(a){var c=b.state[a].append(e,d);A(c)?c.forEach(function(b,c){d.set(e.next[a],"["+c+"]",b)}):d.set(f.next,
"."+a,c)});S(e,d,b,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(a){var c=b.draw[a];c&&d.set(f.draw,"."+a,""+c.append(e,d))});Object.keys(b.uniforms).forEach(function(a){d.set(f.uniforms,"["+n.id(a)+"]",b.uniforms[a].append(e,d))});Object.keys(b.attributes).forEach(function(a){var c=b.attributes[a].append(e,d),f=e.scopeAttrib(a);Object.keys(new Z).forEach(function(a){d.set(f,"."+a,c[a])})});c("vert");c("frag");0<Object.keys(b.state).length&&(d(k,".dirty=true;"),d.exit(k,
".dirty=true;"));d("a1(",e.shared.context,",a0,",e.batchId,");")}function Ja(a){if("object"===typeof a&&!A(a)){for(var e=Object.keys(a),b=0;b<e.length;++b)if(t.isDynamic(a[e[b]]))return!0;return!1}}function Ka(a,e,b){function c(a,e){k.forEach(function(b){var c=d[b];t.isDynamic(c)&&(c=a.invoke(e,c),e(p,".",b,"=",c,";"))})}var d=e["static"][b];if(d&&Ja(d)){var f=a.global,k=Object.keys(d),g=!1,x=!1,y=!1,p=a.global.def("{}");k.forEach(function(e){var b=d[e];if(t.isDynamic(b))"function"===typeof b&&(b=
d[e]=t.unbox(b)),e=m(b,null),g=g||e.thisDep,y=y||e.propDep,x=x||e.contextDep;else{f(p,".",e,"=");switch(typeof b){case "number":f(b);break;case "string":f('"',b,'"');break;case "object":Array.isArray(b)&&f("[",b.join(),"]");break;default:f(a.link(b))}f(";")}});e.dynamic[b]=new t.DynamicVariable(4,{thisDep:g,contextDep:x,propDep:y,ref:p,append:c});delete e["static"][b]}}var Z=la.Record,ga={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(ga.min=32775,ga.max=32776);var ha=r.angle_instanced_arrays,
e=r.webgl_draw_buffers,y={dirty:!0,profile:fa.profile},x={},Ga=[],va={},wa={};L("dither",3024);L("blend.enable",3042);E("blend.color","blendColor",[0,0,0,0]);E("blend.equation","blendEquationSeparate",[32774,32774]);E("blend.func","blendFuncSeparate",[1,0,1,0]);L("depth.enable",2929,!0);E("depth.func","depthFunc",513);E("depth.range","depthRange",[0,1]);E("depth.mask","depthMask",!0);E("colorMask","colorMask",[!0,!0,!0,!0]);L("cull.enable",2884);E("cull.face","cullFace",1029);E("frontFace","frontFace",
2305);E("lineWidth","lineWidth",1);L("polygonOffset.enable",32823);E("polygonOffset.offset","polygonOffset",[0,0]);L("sample.alpha",32926);L("sample.enable",32928);E("sample.coverage","sampleCoverage",[1,!1]);L("stencil.enable",2960);E("stencil.mask","stencilMask",-1);E("stencil.func","stencilFunc",[519,0,-1]);E("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);E("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);L("scissor.enable",3089);E("scissor.box","scissor",[0,0,h.drawingBufferWidth,
h.drawingBufferHeight]);E("viewport","viewport",[0,0,h.drawingBufferWidth,h.drawingBufferHeight]);var Na={gl:h,context:W,strings:n,next:x,current:y,draw:p,elements:ja,buffer:G,shader:ua,attributes:la.state,uniforms:ta,framebuffer:N,extensions:r,timer:X,isBufferArgs:l},Ha={primTypes:H,compareFuncs:C,blendFuncs:f,blendEquations:ga,stencilOps:B,glTypes:v,orientationType:q};e&&(Ha.backBuffer=[1029],Ha.drawBuffer=w(J.maxDrawbuffers,function(a){return 0===a?[0]:w(a,function(a){return 36064+a})}));var Pa=
0;return{next:x,current:y,procs:function(){var a=xa(),e=a.proc("poll"),b=a.proc("refresh"),c=a.block();e(c);b(c);var d=a.shared,f=d.gl,k=d.next,g=d.current;c(g,".dirty=false;");Y(a,e);Y(a,b,null,!0);var m=h.getExtension("angle_instanced_arrays"),x;m&&(x=a.link(m));for(var p=0;p<J.maxAttributes;++p){var l=b.def(d.attributes,"[",p,"]"),q=a.cond(l,".buffer");q.then(f,".enableVertexAttribArray(",p,");",f,".bindBuffer(",34962,",",l,".buffer.buffer);",f,".vertexAttribPointer(",p,",",l,".size,",l,".type,",
l,".normalized,",l,".stride,",l,".offset);")["else"](f,".disableVertexAttribArray(",p,");",f,".vertexAttrib4f(",p,",",l,".x,",l,".y,",l,".z,",l,".w);",l,".buffer=null;");b(q);m&&b(x,".vertexAttribDivisorANGLE(",p,",",l,".divisor);")}Object.keys(va).forEach(function(d){var m=va[d],x=c.def(k,".",d),y=a.block();y("if(",x,"){",f,".enable(",m,")}else{",f,".disable(",m,")}",g,".",d,"=",x,";");b(y);e("if(",x,"!==",g,".",d,"){",y,"}")});Object.keys(wa).forEach(function(d){var m=wa[d],x=y[d],p,l,q=a.block();
q(f,".",m,"(");A(x)?(m=x.length,p=a.global.def(k,".",d),l=a.global.def(g,".",d),q(w(m,function(a){return p+"["+a+"]"}),");",w(m,function(a){return l+"["+a+"]="+p+"["+a+"];"}).join("")),e("if(",w(m,function(a){return p+"["+a+"]!=="+l+"["+a+"]"}).join("||"),"){",q,"}")):(p=c.def(k,".",d),l=c.def(g,".",d),q(p,");",g,".",d,"=",p,";"),e("if(",p,"!==",l,"){",q,"}"));b(q)});return a.compile()}(),compile:function(a,e,b,c,d){var f=xa();f.stats=f.link(d);Object.keys(e["static"]).forEach(function(a){Ka(f,e,
a)});k.forEach(function(e){Ka(f,a,e)});b=na(a,e,b,c,f);Da(f,b);Ia(f,b);La(f,b);return f.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(h,n,r){function l(a,g){this.id=D++;this.type=a;this.data=g}function a(c){if(0===c.length)return[];var g=c.charAt(0),d=c.charAt(c.length-1);if(1<c.length&&g===d&&('"'===g||"'"===g))return['"'+c.substr(1,
c.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(g=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(c))return a(c.substr(0,g.index)).concat(a(g[1])).concat(a(c.substr(g.index+g[0].length)));g=c.split(".");if(1===g.length)return['"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];c=[];for(d=0;d<g.length;++d)c=c.concat(a(g[d]));return c}function g(c){return"["+a(c).join("][")+"]"}var D=0;n.exports={DynamicVariable:l,define:function(a,m){return new l(a,g(m+""))},isDynamic:function(a){return"function"===
typeof a&&!a._reglType||a instanceof l},unbox:function(a,g){return"function"===typeof a?new l(0,a):a},accessor:g}},{}],10:[function(h,n,r){var l=h("./util/is-typed-array"),a=h("./util/is-ndarray"),g=h("./util/values"),D=h("./constants/primitives.json"),c=h("./constants/usage.json");n.exports=function(m,d,h,n){function r(a){this.id=v++;H[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function A(c,k,g,m,b,t,v){(t=v)||l(k)&&(!a(k)||l(k.data))||(t=d.oes_element_index_uint?5125:
5123);c.buffer.bind();h._initBuffer(c.buffer,k,g,t,3);k=v;if(!v){switch(c.buffer.dtype){case 5121:case 5120:k=5121;break;case 5123:case 5122:k=5123;break;case 5125:case 5124:k=5125}c.buffer.dtype=k}c.type=k;0>b&&(b=c.buffer.byteLength,5123===k?b>>=1:5125===k&&(b>>=2));c.vertCount=b;b=m;0>m&&(b=4,m=c.buffer.dimension,1===m&&(b=0),2===m&&(b=1),3===m&&(b=4));c.primType=b}function t(a){n.elementsCount--;delete H[a.id];a.buffer.destroy();a.buffer=null}var H={},v=0,F={uint8:5121,uint16:5123};d.oes_element_index_uint&&
(F.uint32=5125);r.prototype.bind=function(){this.buffer.bind()};var k=[];return{create:function(d,k){function g(d){if(d)if("number"===typeof d)q(d),b.primType=4,b.vertCount=d|0,b.type=5121;else{var f=null,k=35044,h=-1,t=-1,v=0,w=0;Array.isArray(d)||l(d)||a(d)?f=d:("data"in d&&(f=d.data),"usage"in d&&(k=c[d.usage]),"primitive"in d&&(h=D[d.primitive]),"count"in d&&(t=d.count|0),"length"in d&&(v=d.length|0),"type"in d&&(w=F[d.type]));f?A(b,f,k,h,t,v,w):(d=b.buffer,d.bind(),m.bufferData(34963,v,k),d.dtype=
w||5121,d.usage=k,d.dimension=3,d.byteLength=v,b.primType=0>h?4:h,b.vertCount=0>t?0:t,b.type=d.dtype)}else q(),b.primType=4,b.vertCount=0,b.type=5121;return g}var q=h.create(null,34963,!0),b=new r(q._buffer);n.elementsCount++;g(d);g._reglType="elements";g._elements=b;g.subdata=function(a,b){q.subdata(a,b);return g};g.destroy=function(){t(b)};return g},createStream:function(a){var c=k.pop();c||(c=new r(h.create(null,34963,!0,!1)._buffer));A(c,a,35040,-1,-1,0,0);return c},destroyStream:function(a){k.push(a)},
getElements:function(a){return"function"===typeof a&&a._elements instanceof r?a._elements:null},clear:function(){g(H).forEach(t)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(h,n,r){n.exports=function(l,a){function g(a){a=a.toLowerCase();var c;try{c=h[a]=l.getExtension(a)}catch(g){}return!!c}for(var h={},c=0;c<a.extensions.length;++c){var m=a.extensions[c];if(!g(m))return a.onDestroy(),a.onDone('"'+
m+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}a.optionalExtensions.forEach(g);return{extensions:h,restore:function(){Object.keys(h).forEach(function(a){if(!g(a))throw Error("(regl): error restoring extension "+a);})}}}},{}],12:[function(h,n,r){var l=h("./util/values"),a=h("./util/extend"),g=[];g[6408]=4;var D=[];D[5121]=1;D[5126]=4;D[36193]=2;n.exports=function(c,m,d,h,n,r){function A(a,b,c){this.target=a;this.texture=b;this.renderbuffer=
c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height);this.width=a;this.height=d}function t(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function H(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function v(a,b){b?b.texture?c.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):c.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):c.framebufferTexture2D(36160,
a,3553,null,0)}function F(a){var b=3553,c=null,d=null,f=a;"object"===typeof a&&(f=a.data,"target"in a&&(b=a.target|0));a=f._reglType;"texture2d"===a?c=f:"textureCube"===a?c=f:"renderbuffer"===a&&(d=f,b=36161);return new A(b,c,d)}function k(a,b,c,d,f){if(c)return a=h.create2D({width:a,height:b,format:d,type:f}),a._texture.refCount=0,new A(3553,a,null);a=n.create({width:a,height:b,format:d});a._renderbuffer.refCount=0;return new A(36161,null,a)}function f(a){return a&&(a.texture||a.renderbuffer)}function C(a,
b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function B(){this.id=ka++;N[this.id]=this;this.framebuffer=c.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function q(a){a.colorAttachments.forEach(t);t(a.depthAttachment);t(a.stencilAttachment);t(a.depthStencilAttachment)}function b(a){c.deleteFramebuffer(a.framebuffer);a.framebuffer=null;r.framebufferCount--;delete N[a.id]}
function I(a){var b;c.bindFramebuffer(36160,a.framebuffer);var f=a.colorAttachments;for(b=0;b<f.length;++b)v(36064+b,f[b]);for(b=f.length;b<d.maxColorAttachments;++b)v(36064+b,null);v(36096,a.depthAttachment);v(36128,a.stencilAttachment);v(33306,a.depthStencilAttachment);c.checkFramebufferStatus(36160);c.bindFramebuffer(36160,ia.next);ia.cur=ia.next;c.getError()}function sa(c,d){function m(a,b){var c,d=0,l=0,h=!0,t=!0;c=null;var v=!0,w="rgba",n="uint8",A=1,r=null,C=null,J=null,G=!1;if("number"===
typeof a)d=a|0,l=b|0||d;else if(a){"shape"in a?(l=a.shape,d=l[0],l=l[1]):("radius"in a&&(d=l=a.radius),"width"in a&&(d=a.width),"height"in a&&(l=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);if(!c){"colorCount"in a&&(A=a.colorCount|0);"colorTexture"in a&&(v=!!a.colorTexture,w="rgba4");if("colorType"in a&&(n=a.colorType,!v))if("half float"===n||"float16"===n)w="rgba16f";else if("float"===n||"float32"===n)w="rgba32f";"colorFormat"in a&&(w=a.colorFormat,0<=Fa.indexOf(w)?
v=!0:0<=za.indexOf(w)&&(v=!1))}if("depthTexture"in a||"depthStencilTexture"in a)G=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?h=a.depth:(r=a.depth,t=!1));"stencil"in a&&("boolean"===typeof a.stencil?t=a.stencil:(C=a.stencil,h=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?h=t=a.depthStencil:(J=a.depthStencil,t=h=!1))}else d=l=1;var B=null,sa=null,K=null,ia=null;if(Array.isArray(c))B=c.map(F);else if(c)B=[F(c)];else for(B=Array(A),c=0;c<A;++c)B[c]=
k(d,l,v,w,n);d=d||B[0].width;l=l||B[0].height;r?sa=F(r):h&&!t&&(sa=k(d,l,G,"depth","uint32"));C?K=F(C):t&&!h&&(K=k(d,l,!1,"stencil","uint8"));J?ia=F(J):!r&&!C&&t&&h&&(ia=k(d,l,G,"depth stencil","depth stencil"));h=null;for(c=0;c<B.length;++c)H(B[c],d,l),B[c]&&B[c].texture&&(t=g[B[c].texture._texture.format]*D[B[c].texture._texture.type],null===h&&(h=t));H(sa,d,l);H(K,d,l);H(ia,d,l);q(p);p.width=d;p.height=l;p.colorAttachments=B;p.depthAttachment=sa;p.stencilAttachment=K;p.depthStencilAttachment=ia;
m.color=B.map(f);m.depth=f(sa);m.stencil=f(K);m.depthStencil=f(ia);m.width=p.width;m.height=p.height;I(p);return m}var p=new B;r.framebufferCount++;m(c,d);return a(m,{resize:function(a,b){var c=a|0,d=b|0||c;if(c===p.width&&d===p.height)return m;for(var f=p.colorAttachments,k=0;k<f.length;++k)C(f[k],c,d);C(p.depthAttachment,c,d);C(p.stencilAttachment,c,d);C(p.depthStencilAttachment,c,d);p.width=m.width=c;p.height=m.height=d;I(p);return m},_reglType:"framebuffer",_framebuffer:p,destroy:function(){b(p);
q(p)}})}var ia={cur:null,next:null,dirty:!1},Fa=["rgba"],za=["rgba4","rgb565","rgb5 a1"];m.ext_srgb&&za.push("srgba");m.ext_color_buffer_half_float&&za.push("rgba16f","rgb16f");m.webgl_color_buffer_float&&za.push("rgba32f");var ja=["uint8"];m.oes_texture_half_float&&ja.push("half float","float16");m.oes_texture_float&&ja.push("float","float32");var ka=0,N={};return a(ia,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof B)?a:null},
create:sa,createCube:function(b){function c(b){var f,k={color:null},g=0,m=null;f="rgba";var l="uint8",q=1;if("number"===typeof b)g=b|0;else if(b){"shape"in b?g=b.shape[0]:("radius"in b&&(g=b.radius|0),"width"in b?g=b.width|0:"height"in b&&(g=b.height|0));if("color"in b||"colors"in b)m=b.color||b.colors,Array.isArray(m);m||("colorCount"in b&&(q=b.colorCount|0),"colorType"in b&&(l=b.colorType),"colorFormat"in b&&(f=b.colorFormat));"depth"in b&&(k.depth=b.depth);"stencil"in b&&(k.stencil=b.stencil);
"depthStencil"in b&&(k.depthStencil=b.depthStencil)}else g=1;if(m)if(Array.isArray(m))for(b=[],f=0;f<m.length;++f)b[f]=m[f];else b=[m];else for(b=Array(q),m={radius:g,format:f,type:l},f=0;f<q;++f)b[f]=h.createCube(m);k.color=Array(b.length);for(f=0;f<b.length;++f)q=b[f],g=g||q.width,k.color[f]={target:34069,data:b[f]};for(f=0;6>f;++f){for(q=0;q<b.length;++q)k.color[q].target=34069+f;0<f&&(k.depth=d[0].depth,k.stencil=d[0].stencil,k.depthStencil=d[0].depthStencil);if(d[f])d[f](k);else d[f]=sa(k)}return a(c,
{width:g,height:g,color:b})}var d=Array(6);c(b);return a(c,{faces:d,resize:function(a){var b=a|0;if(b===c.width)return c;var f=c.color;for(a=0;a<f.length;++a)f[a].resize(b);for(a=0;6>a;++a)d[a].resize(b);c.width=c.height=b;return c},_reglType:"framebufferCube",destroy:function(){d.forEach(function(a){a.destroy()})}})},clear:function(){l(N).forEach(b)},restore:function(){l(N).forEach(function(a){a.framebuffer=c.createFramebuffer();I(a)})}})}},{"./util/extend":23,"./util/values":31}],13:[function(h,
n,r){n.exports=function(l,a){var g=1;a.ext_texture_filter_anisotropic&&(g=l.getParameter(34047));var h=1,c=1;a.webgl_draw_buffers&&(h=l.getParameter(34852),c=l.getParameter(36063));return{colorBits:[l.getParameter(3410),l.getParameter(3411),l.getParameter(3412),l.getParameter(3413)],depthBits:l.getParameter(3414),stencilBits:l.getParameter(3415),subpixelBits:l.getParameter(3408),extensions:Object.keys(a).filter(function(c){return!!a[c]}),maxAnisotropic:g,maxDrawbuffers:h,maxColorAttachments:c,pointSizeDims:l.getParameter(33901),
lineWidthDims:l.getParameter(33902),maxViewportDims:l.getParameter(3386),maxCombinedTextureUnits:l.getParameter(35661),maxCubeMapSize:l.getParameter(34076),maxRenderbufferSize:l.getParameter(34024),maxTextureUnits:l.getParameter(34930),maxTextureSize:l.getParameter(3379),maxAttributes:l.getParameter(34921),maxVertexUniforms:l.getParameter(36347),maxVertexTextureUnits:l.getParameter(35660),maxVaryingVectors:l.getParameter(36348),maxFragmentUniforms:l.getParameter(36349),glsl:l.getParameter(35724),
renderer:l.getParameter(7937),vendor:l.getParameter(7936),version:l.getParameter(7938)}}},{}],14:[function(h,n,r){var l=h("./util/is-typed-array");n.exports=function(a,g,h,c,m,d){return function(d){var m;m=null===g.next?5121:g.next.colorAttachments[0].texture._texture.type;var n=0,A=0,t=c.framebufferWidth,r=c.framebufferHeight,v=null;l(d)?v=d:d&&(n=d.x|0,A=d.y|0,t=(d.width||c.framebufferWidth-n)|0,r=(d.height||c.framebufferHeight-A)|0,v=d.data||null);h();d=t*r*4;v||(5121===m?v=new Uint8Array(d):5126===
m&&(v=v||new Float32Array(d)));a.pixelStorei(3333,4);a.readPixels(n,A,t,r,6408,m,v);return v}}},{"./util/is-typed-array":26}],15:[function(h,n,r){var l=h("./util/values"),a=[];a[32854]=2;a[32855]=2;a[36194]=2;a[33189]=2;a[36168]=1;a[34041]=4;a[35907]=4;a[34836]=16;a[34842]=8;a[34843]=6;n.exports=function(g,h,c,m,d){function w(a){this.id=t++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;d.profile&&(this.stats={size:0})}function n(a){var c=a.renderbuffer;g.bindRenderbuffer(36161,
null);g.deleteRenderbuffer(c);a.renderbuffer=null;a.refCount=0;delete H[a.id];m.renderbufferCount--}var r={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};h.ext_srgb&&(r.srgba=35907);h.ext_color_buffer_half_float&&(r.rgba16f=34842,r.rgb16f=34843);h.webgl_color_buffer_float&&(r.rgba32f=34836);var A=[];Object.keys(r).forEach(function(a){A[r[a]]=a});var t=0,H={};w.prototype.decRef=function(){0>=--this.refCount&&n(this)};d.profile&&(m.getTotalRenderbufferSize=
function(){var a=0;Object.keys(H).forEach(function(c){a+=H[c].stats.size});return a});return{create:function(c,l){function k(c,m){var l=0,b=0,h=32854;"object"===typeof c&&c?("shape"in c?(b=c.shape,l=b[0]|0,b=b[1]|0):("radius"in c&&(l=b=c.radius|0),"width"in c&&(l=c.width|0),"height"in c&&(b=c.height|0)),"format"in c&&(h=r[c.format])):"number"===typeof c?(l=c|0,b="number"===typeof m?m|0:l):c||(l=b=1);if(l!==f.width||b!==f.height||h!==f.format)return k.width=f.width=l,k.height=f.height=b,f.format=h,
g.bindRenderbuffer(36161,f.renderbuffer),g.renderbufferStorage(36161,h,l,b),d.profile&&(f.stats.size=a[f.format]*f.width*f.height),k.format=A[f.format],k}var f=new w(g.createRenderbuffer());H[f.id]=f;m.renderbufferCount++;k(c,l);k.resize=function(c,m){var l=c|0,b=m|0||l;if(l===f.width&&b===f.height)return k;k.width=f.width=l;k.height=f.height=b;g.bindRenderbuffer(36161,f.renderbuffer);g.renderbufferStorage(36161,f.format,l,b);d.profile&&(f.stats.size=a[f.format]*f.width*f.height);return k};k._reglType=
"renderbuffer";k._renderbuffer=f;d.profile&&(k.stats=f.stats);k.destroy=function(){f.decRef()};return k},clear:function(){l(H).forEach(n)},restore:function(){l(H).forEach(function(a){a.renderbuffer=g.createRenderbuffer();g.bindRenderbuffer(36161,a.renderbuffer);g.renderbufferStorage(36161,a.format,a.width,a.height)});g.bindRenderbuffer(36161,null)}}}},{"./util/values":31}],16:[function(h,n,r){var l=h("./util/values");n.exports=function(a,g,h,c){function m(a,c,d,g){this.name=a;this.id=c;this.location=
d;this.info=g}function d(a,c){for(var d=0;d<a.length;++d)if(a[d].id===c.id){a[d].location=c.location;return}a.push(c)}function w(c,d,m){m=35632===c?A:t;var l=m[d];if(!l){var h=g.str(d),l=a.createShader(c);a.shaderSource(l,h);a.compileShader(l);m[d]=l}return l}function n(a,d){this.id=F++;this.fragId=a;this.vertId=d;this.program=null;this.uniforms=[];this.attributes=[];c.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function r(k,f){var l,h;l=w(35632,k.fragId);h=w(35633,k.vertId);var q=k.program=
a.createProgram();a.attachShader(q,l);a.attachShader(q,h);a.linkProgram(q);var b=a.getProgramParameter(q,35718);c.profile&&(k.stats.uniformsCount=b);var t=k.uniforms;for(l=0;l<b;++l)if(h=a.getActiveUniform(q,l))if(1<h.size)for(var n=0;n<h.size;++n){var v=h.name.replace("[0]","["+n+"]");d(t,new m(v,g.id(v),a.getUniformLocation(q,v),h))}else d(t,new m(h.name,g.id(h.name),a.getUniformLocation(q,h.name),h));b=a.getProgramParameter(q,35721);c.profile&&(k.stats.attributesCount=b);t=k.attributes;for(l=0;l<
b;++l)(h=a.getActiveAttrib(q,l))&&d(t,new m(h.name,g.id(h.name),a.getAttribLocation(q,h.name),h))}var A={},t={},H={},v=[],F=0;c.profile&&(h.getMaxUniformsCount=function(){var a=0;v.forEach(function(c){c.stats.uniformsCount>a&&(a=c.stats.uniformsCount)});return a},h.getMaxAttributesCount=function(){var a=0;v.forEach(function(c){c.stats.attributesCount>a&&(a=c.stats.attributesCount)});return a});return{clear:function(){var c=a.deleteShader.bind(a);l(A).forEach(c);A={};l(t).forEach(c);t={};v.forEach(function(c){a.deleteProgram(c.program)});
v.length=0;H={};h.shaderCount=0},program:function(a,c,d){h.shaderCount++;var g=H[c];g||(g=H[c]={});var m=g[a];m||(m=new n(c,a),r(m,d),g[a]=m,v.push(m));return m},restore:function(){A={};t={};for(var a=0;a<v.length;++a)r(v[a])},shader:w,frag:-1,vert:-1}}},{"./util/values":31}],17:[function(h,n,r){n.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(h,n,r){n.exports=function(){var l=
{"":0},a=[""];return{id:function(g){var h=l[g];if(h)return h;h=l[g]=a.length;a.push(g);return h},str:function(g){return a[g]}}}},{}],19:[function(h,n,r){function l(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&H(a[0])?!0:!1}function g(a){return Object.prototype.toString.call(a)}function D(b){if(!b)return!1;var c=g(b);return 0<=C.indexOf(c)?!0:l(b)||a(b)||G(b)}function c(a,c){36193===a.type?(a.data=t(c),A.freeType(c)):a.data=
c}function m(a,c,d,g,m,k){a="undefined"!==typeof q[a]?q[a]:f[a]*B[c];k&&(a*=6);if(m){for(g=0;1<=d;)g+=a*d*d,d/=2;return g}return a*d*g}var d=h("./util/extend"),w=h("./util/values"),J=h("./util/is-typed-array"),G=h("./util/is-ndarray"),A=h("./util/pool"),t=h("./util/to-half-float"),H=h("./util/is-array-like");r=h("./constants/arraytypes.json");var v=h("./constants/arraytypes.json"),F=[9984,9986,9985,9987],k=[0,6409,6410,6407,6408],f={};f[6409]=f[6406]=f[6402]=1;f[34041]=f[6410]=2;f[6407]=f[35904]=
3;f[6408]=f[35906]=4;var C=Object.keys(r).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),B=[];B[5121]=1;B[5126]=4;B[36193]=2;B[5123]=2;B[5125]=4;var q=[];q[32854]=2;q[32855]=2;q[36194]=2;q[34041]=4;q[33776]=.5;q[33777]=.5;q[33778]=1;q[33779]=1;q[35986]=.5;q[35987]=1;q[34798]=1;q[35840]=.5;q[35841]=.25;q[35842]=.5;q[35843]=.25;q[36196]=.5;n.exports=function(b,h,q,n,r,B,C){function ka(){this.format=this.internalformat=
6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function N(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function ta(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=
b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=P[b.colorSpace]);"type"in b&&(a.type=R[b.type]);var c=a.width,d=a.height,g=a.channels,m=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(g=b.shape[2],m=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(g=b.channels,m=!0));a.width=c|0;a.height=d|0;a.channels=g|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=
S[c],a.format=La[d],c in R&&!("type"in b)&&(a.type=R[c]),c in V&&(a.compressed=!0),c=!0);!m&&c?a.channels=f[a.format]:m&&!c&&a.channels!==k[a.format]&&(a.format=a.internalformat=k[a.channels])}}function la(a){b.pixelStorei(37440,a.flipY);b.pixelStorei(37441,a.premultiplyAlpha);b.pixelStorei(37443,a.colorSpace);b.pixelStorei(3317,a.unpackAlignment)}function ua(){ka.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function p(b,d){var f=null;
D(d)?f=d:d&&(ta(b,d),"x"in d&&(b.xOffset=d.x|0),"y"in d&&(b.yOffset=d.y|0),D(d.data)&&(f=d.data));if(d.copy){var m=r.viewportWidth,h=r.viewportHeight;b.width=b.width||m-b.xOffset;b.height=b.height||h-b.yOffset;b.needsCopy=!0}else if(!f)b.width=b.width||1,b.height=b.height||1;else if(J(f))b.data=f,"type"in d||5121!==b.type||(b.type=v[Object.prototype.toString.call(f)]|0);else if(l(f)){m=f;h=b.width*b.height*b.channels;switch(b.type){case 5121:case 5123:case 5125:case 5126:h=A.allocType(b.type,h);h.set(m);
b.data=h;break;case 36193:b.data=t(m)}b.alignment=1;b.needsFree=!0}else if(G(f)){m=f.data;Array.isArray(m)||5121!==b.type||(b.type=v[Object.prototype.toString.call(m)]|0);var h=f.shape,p=f.stride,q,n,w,u;3===h.length?(w=h[2],u=p[2]):u=w=1;q=h[0];n=h[1];h=p[0];p=p[1];b.alignment=1;b.width=q;b.height=n;b.channels=w;b.format=b.internalformat=k[w];b.needsFree=!0;q=u;f=f.offset;w=b.width;u=b.height;n=b.channels;for(var z=A.allocType(36193===b.type?5126:b.type,w*u*n),F=0,B=0;B<u;++B)for(var C=0;C<w;++C)for(var oa=
0;oa<n;++oa)z[F++]=m[h*C+p*B+q*oa+f];c(b,z)}else if("[object HTMLCanvasElement]"===g(f)||"[object CanvasRenderingContext2D]"===g(f))"[object HTMLCanvasElement]"===g(f)?b.element=f:b.element=f.canvas,b.width=b.element.width,b.height=b.element.height;else if("[object HTMLImageElement]"===g(f))b.element=f,b.width=f.naturalWidth,b.height=f.naturalHeight;else if("[object HTMLVideoElement]"===g(f))b.element=f,b.width=f.videoWidth,b.height=f.videoHeight;else if(a(f)){m=f[0].length;h=f.length;p=1;if(H(f[0][0])){q=
p=f[0][0].length;w=A.allocType(36193===b.type?5126:b.type,m*h*q);for(n=u=0;n<h;++n)for(z=f[n],F=0;F<m;++F)for(B=z[F],C=0;C<q;++C)w[u++]=B[C];c(b,w)}else{q=A.allocType(36193===b.type?5126:b.type,m*h);for(u=w=0;u<h;++u)for(n=f[u],z=0;z<m;++z)q[w++]=n[z];c(b,q)}b.alignment=1;b.width=m;b.height=h;b.channels=p;b.format=b.internalformat=k[p];b.needsFree=!0}}function W(a,c,d,f,g){var m=a.element,k=a.data,h=a.internalformat,l=a.format,p=a.type,q=a.width,t=a.height;la(a);m?b.texSubImage2D(c,g,d,f,l,p,m):a.compressed?
b.compressedTexSubImage2D(c,g,d,f,h,q,t,k):a.needsCopy?(n(),b.copyTexSubImage2D(c,g,d,f,a.xOffset,a.yOffset,q,t)):b.texSubImage2D(c,g,d,f,q,t,l,p,k)}function X(){return Ia.pop()||new ua}function fa(a){a.needsFree&&A.freeType(a.data);ua.call(a);Ia.push(a)}function T(){ka.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function L(a,b,c){var d=a.images[0]=X();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function E(a,b){var c=null;if(D(b))c=a.images[0]=X(),
N(c,a),p(c,b),a.mipmask=1;else if(ta(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,f=0;f<d.length;++f)c=a.images[f]=X(),N(c,a),c.width>>=f,c.height>>=f,p(c,d[f]),a.mipmask|=1<<f;else c=a.images[0]=X(),N(c,a),p(c,b),a.mipmask=1;N(a,a.images[0])}function xa(a,c){for(var d=a.images,f=0;f<d.length&&d[f];++f){var g=d[f],m=c,k=f,h=g.element,l=g.data,p=g.internalformat,q=g.format,t=g.type,w=g.width,v=g.height;la(g);h?b.texImage2D(m,k,q,q,t,h):g.compressed?b.compressedTexImage2D(m,k,p,w,v,0,l):g.needsCopy?
(n(),b.copyTexImage2D(m,k,q,g.xOffset,g.yOffset,w,v,0)):b.texImage2D(m,k,q,w,v,0,q,t,l)}}function ma(){var a=Ja.pop()||new T;ka.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ya(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&fa(b[c]),b[c]=null;Ja.push(a)}function Q(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ca(a,b){"min"in b&&(a.minFilter=aa[b.min],0<=F.indexOf(a.minFilter)&&(a.genMipmaps=
!0));"mag"in b&&(a.magFilter=Y[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var f=b.wrap;"string"===typeof f?c=d=K[f]:Array.isArray(f)&&(c=K[f[0]],d=K[f[1]])}else"wrapS"in b&&(c=K[b.wrapS]),"wrapT"in b&&(d=K[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=na[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=
9984)}}function da(a,c){b.texParameteri(c,10241,a.minFilter);b.texParameteri(c,10240,a.magFilter);b.texParameteri(c,10242,a.wrapS);b.texParameteri(c,10243,a.wrapT);h.ext_texture_filter_anisotropic&&b.texParameteri(c,34046,a.anisotropic);a.genMipmaps&&(b.hint(33170,a.mipmapHint),b.generateMipmap(c))}function pa(a){ka.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ka++;this.refCount=1;this.target=a;this.texture=b.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new Q;C.profile&&
(this.stats={size:0})}function ea(a){b.activeTexture(33984);b.bindTexture(a.target,a.texture)}function U(){var a=ha[0];a?b.bindTexture(a.target,a.texture):b.bindTexture(3553,null)}function qa(a){var c=a.texture,d=a.unit,f=a.target;0<=d&&(b.activeTexture(33984+d),b.bindTexture(f,null),ha[d]=null);b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete Z[a.id];B.textureCount--}var na={"don't care":4352,"dont care":4352,nice:4354,fast:4353},K={repeat:10497,clamp:33071,mirror:33648},
Y={nearest:9728,linear:9729},aa=d({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Y),P={none:0,browser:37444},R={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},S={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},V={};h.ext_srgb&&(S.srgb=35904,S.srgba=35906);h.oes_texture_float&&(R.float32=R["float"]=5126);h.oes_texture_half_float&&(R.float16=R["half float"]=
36193);h.webgl_depth_texture&&(d(S,{depth:6402,"depth stencil":34041}),d(R,{uint16:5123,uint32:5125,"depth stencil":34042}));h.webgl_compressed_texture_s3tc&&d(V,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});h.webgl_compressed_texture_atc&&d(V,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});h.webgl_compressed_texture_pvrtc&&d(V,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
h.webgl_compressed_texture_etc1&&(V["rgb etc1"]=36196);var ba=Array.prototype.slice.call(b.getParameter(34467));Object.keys(V).forEach(function(a){var b=V[a];0<=ba.indexOf(b)&&(S[a]=b)});var oa=Object.keys(S);q.textureFormats=oa;var Ba=[];Object.keys(S).forEach(function(a){Ba[S[a]]=a});var Ca=[];Object.keys(R).forEach(function(a){Ca[R[a]]=a});var Da=[];Object.keys(Y).forEach(function(a){Da[Y[a]]=a});var Ea=[];Object.keys(aa).forEach(function(a){Ea[aa[a]]=a});var ra=[];Object.keys(K).forEach(function(a){ra[K[a]]=
a});var La=oa.reduce(function(a,b){var c=S[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ia=[],Ja=[],Ka=0,Z={},ga=q.maxTextureUnits,ha=Array(ga).map(function(){return null});d(pa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var c=0;c<ga;++c){var d=ha[c];if(d){if(0<d.bindCount)continue;d.unit=-1}ha[c]=this;a=c;break}C.profile&&B.maxTextureUnits<a+1&&(B.maxTextureUnits=a+1);this.unit=
a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&qa(this)}});C.profile&&(B.getTotalTextureSize=function(){var a=0;Object.keys(Z).forEach(function(b){a+=Z[b].stats.size});return a});return{create2D:function(a,c){function d(a,b){var c=f.texInfo;Q.call(c);var e=ma();"number"===typeof a?"number"===typeof b?L(e,a|0,b|0):L(e,a|0,a|0):a?(ca(c,a),E(e,a)):L(e,1,1);c.genMipmaps&&(e.mipmask=(e.width<<1)-1);
f.mipmask=e.mipmask;N(f,e);f.internalformat=e.internalformat;d.width=e.width;d.height=e.height;ea(f);xa(e,3553);da(c,3553);U();ya(e);C.profile&&(f.stats.size=m(f.internalformat,f.type,e.width,e.height,c.genMipmaps,!1));d.format=Ba[f.internalformat];d.type=Ca[f.type];d.mag=Da[c.magFilter];d.min=Ea[c.minFilter];d.wrapS=ra[c.wrapS];d.wrapT=ra[c.wrapT];return d}var f=new pa(3553);Z[f.id]=f;B.textureCount++;d(a,c);d.subimage=function(a,b,c,e){b|=0;c|=0;e|=0;var g=X();N(g,f);g.width>>=e;g.height>>=e;g.width-=
b;g.height-=c;p(g,a);ea(f);W(g,3553,b,c,e);U();fa(g);return d};d.resize=function(a,c){var e=a|0,g=c|0||e;if(e===f.width&&g===f.height)return d;d.width=f.width=e;d.height=f.height=g;ea(f);for(var k=0;f.mipmask>>k;++k)b.texImage2D(3553,k,f.format,e>>k,g>>k,0,f.format,f.type,null);U();C.profile&&(f.stats.size=m(f.internalformat,f.type,e,g,!1,!1));return d};d._reglType="texture2d";d._texture=f;C.profile&&(d.stats=f.stats);d.destroy=function(){f.decRef()};return d},createCube:function(a,c,d,f,g,k){function h(a,
b,c,d,e,f){var g,k=l.texInfo;Q.call(k);for(g=0;6>g;++g)q[g]=ma();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)L(q[g],a,a);else if("object"===typeof a)if(b)E(q[0],a),E(q[1],b),E(q[2],c),E(q[3],d),E(q[4],e),E(q[5],f);else if(ca(k,a),ta(l,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)N(q[g],l),E(q[g],a[g]);else for(g=0;6>g;++g)E(q[g],a);N(l,q[0]);l.mipmask=k.genMipmaps?(q[0].width<<1)-1:q[0].mipmask;l.internalformat=q[0].internalformat;h.width=q[0].width;h.height=q[0].height;ea(l);for(g=0;6>g;++g)xa(q[g],
34069+g);da(k,34067);U();C.profile&&(l.stats.size=m(l.internalformat,l.type,h.width,h.height,k.genMipmaps,!0));h.format=Ba[l.internalformat];h.type=Ca[l.type];h.mag=Da[k.magFilter];h.min=Ea[k.minFilter];h.wrapS=ra[k.wrapS];h.wrapT=ra[k.wrapT];for(g=0;6>g;++g)ya(q[g]);return h}var l=new pa(34067);Z[l.id]=l;B.cubeCount++;var q=Array(6);h(a,c,d,f,g,k);h.subimage=function(a,b,c,d,e){c|=0;d|=0;e|=0;var f=X();N(f,l);f.width>>=e;f.height>>=e;f.width-=c;f.height-=d;p(f,b);ea(l);W(f,34069+a,c,d,e);U();fa(f);
return h};h.resize=function(a){a|=0;if(a!==l.width){h.width=l.width=a;h.height=l.height=a;ea(l);for(var c=0;6>c;++c)for(var d=0;l.mipmask>>d;++d)b.texImage2D(34069+c,d,l.format,a>>d,a>>d,0,l.format,l.type,null);U();C.profile&&(l.stats.size=m(l.internalformat,l.type,h.width,h.height,!1,!0));return h}};h._reglType="textureCube";h._texture=l;C.profile&&(h.stats=l.stats);h.destroy=function(){l.decRef()};return h},clear:function(){for(var a=0;a<ga;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),
ha[a]=null;w(Z).forEach(qa);B.cubeCount=0;B.textureCount=0},getTexture:function(a){return null},restore:function(){w(Z).forEach(function(a){a.texture=b.createTexture();b.bindTexture(a.target,a.texture);for(var c=0;32>c;++c)if(0!==(a.mipmask&1<<c))if(3553===a.target)b.texImage2D(3553,c,a.internalformat,a.width>>c,a.height>>c,0,a.internalformat,a.type,null);else for(var d=0;6>d;++d)b.texImage2D(34069+d,c,a.internalformat,a.width>>c,a.height>>c,0,a.internalformat,a.type,null);da(a.texInfo,a.target)})}}}},
{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(h,n,r){n.exports=function(h,a){function g(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function n(a,c,d){var m=w.pop()||new g;m.startQueryIndex=a;m.endQueryIndex=c;m.sum=0;m.stats=d;r.push(m)}var c=a.ext_disjoint_timer_query;if(!c)return null;var m=[],d=[],w=[],r=[],G=
[],A=[];return{beginQuery:function(a){var g=m.pop()||c.createQueryEXT();c.beginQueryEXT(35007,g);d.push(g);n(d.length-1,d.length,a)},endQuery:function(){c.endQueryEXT(35007)},pushScopeStats:n,update:function(){var a,g;a=d.length;if(0!==a){A.length=Math.max(A.length,a+1);G.length=Math.max(G.length,a+1);G[0]=0;var h=A[0]=0;for(g=a=0;g<d.length;++g){var l=d[g];c.getQueryObjectEXT(l,34919)?(h+=c.getQueryObjectEXT(l,34918),m.push(l)):d[a++]=l;G[g+1]=h;A[g+1]=a}d.length=a;for(g=a=0;g<r.length;++g){var h=
r[g],k=h.startQueryIndex,l=h.endQueryIndex;h.sum+=G[l]-G[k];k=A[k];l=A[l];l===k?(h.stats.gpuTime+=h.sum/1E6,w.push(h)):(h.startQueryIndex=k,h.endQueryIndex=l,r[a++]=h)}r.length=a}},getNumPendingQueries:function(){return d.length},clear:function(){m.push.apply(m,d);for(var a=0;a<m.length;a++)c.deleteQueryEXT(m[a]);d.length=0;m.length=0},restore:function(){d.length=0;m.length=0}}}},{}],21:[function(h,n,r){n.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:
function(){return+new Date}},{}],22:[function(h,n,r){function l(a){return Array.prototype.slice.call(a)}function a(a){return l(a).join("")}var g=h("./extend");n.exports=function(){function h(){var c=[],d=[];return g(function(){c.push.apply(c,l(arguments))},{def:function(){var a="v"+m++;d.push(a);0<arguments.length&&(c.push(a,"="),c.push.apply(c,l(arguments)),c.push(";"));return a},toString:function(){return a([0<d.length?"var "+d+";":"",a(c)])}})}function c(){function a(g,f){d(g,f,"=",c.def(g,f),
";")}var c=h(),d=h(),m=c.toString,n=d.toString;return g(function(){c.apply(c,l(arguments))},{def:c.def,entry:c,exit:d,save:a,set:function(d,f,g){a(d,f);c(d,f,"=",g,";")},toString:function(){return m()+n()}})}var m=0,d=[],n=[],r=h(),G={};return{global:r,link:function(a){for(var c=0;c<n.length;++c)if(n[c]===a)return d[c];c="g"+m++;d.push(c);n.push(a);return c},block:h,proc:function(d,m){function h(){var a="a"+l.length;l.push(a);return a}var l=[];m=m||0;for(var n=0;n<m;++n)h();var n=c(),k=n.toString;
return G[d]=g(n,{arg:h,toString:function(){return a(["function(",l.join(),"){",k(),"}"])}})},scope:c,cond:function(){var d=a(arguments),m=c(),h=c(),n=m.toString,w=h.toString;return g(m,{then:function(){m.apply(m,l(arguments));return this},"else":function(){h.apply(h,l(arguments));return this},toString:function(){var c=w();c&&(c="else{"+c+"}");return a(["if(",d,"){",n(),"}",c])}})},compile:function(){var c=['"use strict";',r,"return {"];Object.keys(G).forEach(function(a){c.push('"',a,'":',G[a].toString(),
",")});c.push("}");var g=a(c).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,d.concat(g)).apply(null,n)}}}},{"./extend":23}],23:[function(h,n,r){n.exports=function(h,a){for(var g=Object.keys(a),n=0;n<g.length;++n)h[g[n]]=a[g[n]];return h}},{}],24:[function(h,n,r){var l=h("./is-typed-array");n.exports=function(a){return Array.isArray(a)||l(a)}},{"./is-typed-array":26}],25:[function(h,n,r){var l=h("./is-typed-array");n.exports=function(a){return!!a&&"object"===
typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||l(a.data))}},{"./is-typed-array":26}],26:[function(h,n,r){var l=h("../constants/arraytypes.json");n.exports=function(a){return Object.prototype.toString.call(a)in l}},{"../constants/arraytypes.json":4}],27:[function(h,n,r){n.exports=function(h,a){for(var g=Array(h),n=0;n<h;++n)g[n]=a(n);return g}},{}],28:[function(h,n,r){function l(a){var g,d;g=(65535<a)<<
4;a>>>=g;d=(255<a)<<3;a>>>=d;g|=d;d=(15<a)<<2;a>>>=d;g|=d;d=(3<a)<<1;return g|d|a>>>d>>1}function a(a){a:{for(var g=16;268435456>=g;g*=16)if(a<=g){a=g;break a}a=0}g=D[l(a)>>2];return 0<g.length?g.pop():new ArrayBuffer(a)}function g(a){D[l(a.byteLength)>>2].push(a)}var D=h("./loop")(8,function(){return[]});n.exports={alloc:a,free:g,allocType:function(c,g){var d=null;switch(c){case 5120:d=new Int8Array(a(g),0,g);break;case 5121:d=new Uint8Array(a(g),0,g);break;case 5122:d=new Int16Array(a(2*g),0,g);
break;case 5123:d=new Uint16Array(a(2*g),0,g);break;case 5124:d=new Int32Array(a(4*g),0,g);break;case 5125:d=new Uint32Array(a(4*g),0,g);break;case 5126:d=new Float32Array(a(4*g),0,g);break;default:return null}return d.length!==g?d.subarray(0,g):d},freeType:function(a){g(a.buffer)}}},{"./loop":27}],29:[function(h,n,r){n.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(h){return requestAnimationFrame(h)},cancel:function(h){return cancelAnimationFrame(h)}}:
{next:function(h){return setTimeout(h,16)},cancel:clearTimeout}},{}],30:[function(h,n,r){var l=h("./pool"),a=new Float32Array(1),g=new Uint32Array(a.buffer);n.exports=function(h){for(var c=l.allocType(5123,h.length),m=0;m<h.length;++m)if(isNaN(h[m]))c[m]=65535;else if(Infinity===h[m])c[m]=31744;else if(-Infinity===h[m])c[m]=64512;else{a[0]=h[m];var d=g[0],n=d>>>31<<15,r=(d<<1>>>24)-127,d=d>>13&1023;c[m]=-24>r?n:-14>r?n+(d+1024>>-14-r):15<r?n+31744:n+(r+15<<10)+d}return c}},{"./pool":28}],31:[function(h,
n,r){n.exports=function(h){return Object.keys(h).map(function(a){return h[a]})}},{}],32:[function(h,n,r){function l(a,d,g){function h(){var d=window.innerWidth,n=window.innerHeight;a!==document.body&&(n=a.getBoundingClientRect(),d=n.right-n.left,n=n.top-n.bottom);l.width=g*d;l.height=g*n;c(l.style,{width:d+"px",height:n+"px"})}var l=document.createElement("canvas");c(l.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(l);a===document.body&&(l.style.position="absolute",c(a.style,{margin:0,
padding:0}));window.addEventListener("resize",h,!1);h();return{canvas:l,onDestroy:function(){window.removeEventListener("resize",h);a.removeChild(l)}}}function a(a,c){function g(h){try{return a.getContext(h,c)}catch(l){return null}}return g("webgl")||g("experimental-webgl")||g("webgl-experimental")}function g(a){return"string"===typeof a?a.split():a}function D(a){return"string"===typeof a?document.querySelector(a):a}var c=h("./util/extend");n.exports=function(c){var d=c||{},h,n,r,A;c={};var t=[],
H=[],v="undefined"===typeof window?1:window.devicePixelRatio,F=!1,k=function(a){},f=function(){};"string"===typeof d?h=document.querySelector(d):"object"===typeof d&&("string"===typeof d.nodeName&&"function"===typeof d.appendChild&&"function"===typeof d.getBoundingClientRect?h=d:"function"===typeof d.drawArrays||"function"===typeof d.drawElements?(A=d,r=A.canvas):("gl"in d?A=d.gl:"canvas"in d?r=D(d.canvas):"container"in d&&(n=D(d.container)),"attributes"in d&&(c=d.attributes),"extensions"in d&&(t=
g(d.extensions)),"optionalExtensions"in d&&(H=g(d.optionalExtensions)),"onDone"in d&&(k=d.onDone),"profile"in d&&(F=!!d.profile),"pixelRatio"in d&&(v=+d.pixelRatio)));h&&("canvas"===h.nodeName.toLowerCase()?r=h:n=h);if(!A){if(!r){h=l(n||document.body,k,v);if(!h)return null;r=h.canvas;f=h.onDestroy}A=a(r,c)}return A?{gl:A,canvas:r,container:n,extensions:t,optionalExtensions:H,pixelRatio:v,profile:F,onDone:k,onDestroy:f}:(f(),k("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),
null)}},{"./util/extend":23}],33:[function(h,n,r){n.exports=function(a,g){function h(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==f.alt,f.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==f.shift,f.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==f.control,f.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==f.meta,f.meta=!!a.metaKey);return b}function c(a,b){var c=l.x(b),d=l.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==v||c!==F||d!==k||h(b))v=a|0,F=c||0,k=d||0,g&&g(v,F,k,f)}function m(a){c(0,
a)}function d(){if(v||F||k||f.shift||f.alt||f.meta||f.control)v=F=k=0,f.shift=f.alt=f.control=f.meta=!1,g&&g(0,0,0,f)}function n(a){h(a)&&g&&g(v,F,k,f)}function r(a){0===l.buttons(a)?c(0,a):c(v,a)}function G(a){c(v|l.buttons(a),a)}function A(a){c(v&~l.buttons(a),a)}function t(){C||(C=!0,a.addEventListener("mousemove",r),a.addEventListener("mousedown",G),a.addEventListener("mouseup",A),a.addEventListener("mouseleave",m),a.addEventListener("mouseenter",m),a.addEventListener("mouseout",m),a.addEventListener("mouseover",
m),a.addEventListener("blur",d),a.addEventListener("keyup",n),a.addEventListener("keydown",n),a.addEventListener("keypress",n),a!==window&&(window.addEventListener("blur",d),window.addEventListener("keyup",n),window.addEventListener("keydown",n),window.addEventListener("keypress",n)))}function H(){C&&(C=!1,a.removeEventListener("mousemove",r),a.removeEventListener("mousedown",G),a.removeEventListener("mouseup",A),a.removeEventListener("mouseleave",m),a.removeEventListener("mouseenter",m),a.removeEventListener("mouseout",
m),a.removeEventListener("mouseover",m),a.removeEventListener("blur",d),a.removeEventListener("keyup",n),a.removeEventListener("keydown",n),a.removeEventListener("keypress",n),a!==window&&(window.removeEventListener("blur",d),window.removeEventListener("keyup",n),window.removeEventListener("keydown",n),window.removeEventListener("keypress",n)))}g||(g=a,a=window);var v=0,F=0,k=0,f={shift:!1,alt:!1,control:!1,meta:!1},C=!1;t();var B={element:a};Object.defineProperties(B,{enabled:{get:function(){return C},
set:function(a){a?t():H},enumerable:!0},buttons:{get:function(){return v},enumerable:!0},x:{get:function(){return F},enumerable:!0},y:{get:function(){return k},enumerable:!0},mods:{get:function(){return f},enumerable:!0}});return B};var l=h("mouse-event")},{"mouse-event":34}],34:[function(h,n,r){function l(a){return a.target||a.srcElement||window}r.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<
a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};r.element=l;r.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var g=l(a).getBoundingClientRect();return a.clientX-g.left}return 0};r.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var g=l(a).getBoundingClientRect();return a.clientY-g.top}return 0}},{}],35:[function(h,n,r){function l(a,c){for(var d=0;d<a.length;++d)if(a[d]===c)return d;return-1}var a=
h("./lib/util/extend"),g=h("./lib/dynamic"),D=h("./lib/util/raf"),c=h("./lib/util/clock"),m=h("./lib/strings"),d=h("./lib/webgl"),w=h("./lib/extension"),J=h("./lib/limits"),G=h("./lib/buffer"),A=h("./lib/elements"),t=h("./lib/texture"),H=h("./lib/renderbuffer"),v=h("./lib/framebuffer"),F=h("./lib/attribute"),k=h("./lib/shader"),f=h("./lib/read"),C=h("./lib/core"),B=h("./lib/stats"),q=h("./lib/timer");n.exports=function(b){function h(){if(0===P.length)E&&E.update(),ba=null;else{ba=D.next(h);ta();for(var a=
P.length-1;0<=a;--a){var b=P[a];b&&b(Q,null,0)}p.flush();E&&E.update()}}function n(){!ba&&0<P.length&&(ba=D.next(h))}function r(){ba&&(D.cancel(h),ba=null)}function Fa(a){a.preventDefault();r();R.forEach(function(a){a()})}function za(a){p.getError();X.restore();ea.restore();da.restore();U.restore();qa.restore();na.restore();E&&E.restore();K.procs.refresh();n();S.forEach(function(a){a()})}function ja(b){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var f=a[c];g.isDynamic(f)?d[c]=g.unbox(f,
c):b[c]=f});return{dynamic:d,"static":b}}function d(a){for(;q.length<a;)q.push(null);return q}var f=c(b.context||{}),h=c(b.uniforms||{}),k=c(b.attributes||{}),l=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;"stencil"in d&&d.stencil.op&&(d.stencil.opBack=d.stencil.opFront=d.stencil.op,delete d.stencil.op);c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");
c("scissor");c("sample");return d}(b));b={gpuTime:0,cpuTime:0,count:0};var f=K.compile(l,k,h,f,b),m=f.draw,n=f.batch,p=f.scope,q=[];return a(function(a,b){var c;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,
a,a.length)}else return m.call(this,a)},{stats:b})}function ka(a){P.push(a);n();return{cancel:function(){function b(){var a=l(P,b);P[a]=P[P.length-1];--P.length;0>=P.length&&r()}var c=l(P,a);P[c]=b}}}function N(){var a=Y.viewport,b=Y.scissor_box;a[0]=a[1]=b[0]=b[1]=0;Q.viewportWidth=Q.framebufferWidth=Q.drawingBufferWidth=a[2]=b[2]=p.drawingBufferWidth;Q.viewportHeight=Q.framebufferHeight=Q.drawingBufferHeight=a[3]=b[3]=p.drawingBufferHeight}function ta(){Q.tick+=1;Q.time=ua();N();K.procs.poll()}
function la(){N();K.procs.refresh();E&&E.update()}function ua(){return(c()-xa)/1E3}b=d(b);if(!b)return null;var p=b.gl,W=p.getContextAttributes();p.isContextLost();var X=w(p,b);if(!X)return null;var fa=m(),T=B(),L=X.extensions,E=q(p,L),xa=c(),ma=p.drawingBufferWidth,ya=p.drawingBufferHeight,Q={tick:0,time:0,viewportWidth:ma,viewportHeight:ya,framebufferWidth:ma,framebufferHeight:ya,drawingBufferWidth:ma,drawingBufferHeight:ya,pixelRatio:b.pixelRatio},ca=J(p,L),da=G(p,T,b),pa=A(p,L,da,T),ma=F(p,L,
ca,da,fa),ea=k(p,fa,T,b),U=t(p,L,ca,function(){K.procs.poll()},Q,T,b),qa=H(p,L,ca,T,b),na=v(p,L,ca,U,qa,T),K=C(p,fa,L,ca,da,pa,U,na,{},ma,ea,{elements:null,primitive:4,count:-1,offset:0,instances:-1},Q,E,b),fa=f(p,na,K.procs.poll,Q,W,L),Y=K.next,aa=p.canvas,P=[],R=[],S=[],V=[b.onDestroy],ba=null;aa&&(aa.addEventListener("webglcontextlost",Fa,!1),aa.addEventListener("webglcontextrestored",za,!1));la();W=a(ja,{clear:function(a){var b=0;K.procs.poll();var c=a.color;c&&(p.clearColor(+c[0]||0,+c[1]||0,
+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(p.clearDepth(+a.depth),b|=256);"stencil"in a&&(p.clearStencil(a.stencil|0),b|=1024);p.clear(b)},prop:g.define.bind(null,1),context:g.define.bind(null,2),"this":g.define.bind(null,3),draw:ja({}),buffer:function(a){return da.create(a,34962,!1,!1)},elements:function(a){return pa.create(a,!1)},texture:U.create2D,cube:U.createCube,renderbuffer:qa.create,framebuffer:na.create,framebufferCube:na.createCube,attributes:W,frame:ka,on:function(a,b){var c;switch(a){case "frame":return ka(b);
case "lost":c=R;break;case "restore":c=S;break;case "destroy":c=V}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ca,hasExtension:function(a){return 0<=ca.extensions.indexOf(a.toLowerCase())},read:fa,destroy:function(){P.length=0;r();aa&&(aa.removeEventListener("webglcontextlost",Fa),aa.removeEventListener("webglcontextrestored",za));ea.clear();na.clear();qa.clear();U.clear();pa.clear();da.clear();E&&E.clear();V.forEach(function(a){a()})},
_gl:p,_refresh:la,poll:function(){ta();E&&E.update()},now:ua,stats:T});b.onDone(null,W);return W}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>