<!DOCTYPE html>
      <html>
        <head>
          <title>example/graph.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(n,r,k){function a(b,d){if(!r[b]){if(!n[b]){var c="function"==typeof require&&require;if(!d&&c)return c(b,!0);if(e)return e(b,!0);c=Error("Cannot find module '"+b+"'");throw c.code="MODULE_NOT_FOUND",c;}c=r[b]={exports:{}};n[b][0].call(c.exports,function(d){var e=n[b][1][d];return a(e?e:d)},c,c.exports,e$$0,n,r,k)}return r[b].exports}for(var e="function"==typeof require&&require,D=0;D<k.length;D++)a(k[D]);return a})({1:[function(g,n,r){function k(a){return[a%64,a/64|0]}function a(a){var b=
a.tick;v({framebuffer:E[0]},function(){e.clear({color:[0,0,0,1]});f();B({vertexState:c[(b+1)%2].color[0]})});for(a=0;4>a;++a)w({dest:E[(a+1)%2],src:E[a%2],axis:a%2});J({dest:E[1],src:E[0].color[0]});p({dest:c[(b+1)%2],src:c[b%2].color[0]});q({dest:c[b%2],src:c[(b+1)%2].color[0],field:E[1].color[0]})}var e=g("../regl")({extensions:["webgl_draw_buffers","oes_texture_float"]}),D=g("mouse-change")();g=.5/64;var b=new Float32Array(16384),d=new Float32Array(8192);(function(){for(var a=0;64>a;++a)for(var m=
0;64>m;++m){var K=64*a+m;d[2*K]=a/64;d[2*K+1]=m/64;b[4*K]=Math.random();b[4*K+1]=Math.random()}})();n=e.buffer(d);var c=[e.framebuffer({color:e.texture({radius:64,data:b,type:"float"}),depthStencil:!1}),e.framebuffer({radius:64,colorType:"float",depthStencil:!1})],t=[];(function(){for(var a=0;64>a;++a)for(var b=0;64>b;++b){if(63>a){var d=a+64*b,e=a+1+64*b;t.push([d,e],[e,d])}63>b&&(d=a+64*b,e=a+64*(b+1),t.push([d,e],[e,d]))}})();var E=[e.framebuffer({color:e.texture({type:"float",wrap:"repeat",radius:1024}),
depthStencil:!1}),e.framebuffer({color:e.texture({type:"float",wrap:"repeat",radius:1024}),depthStencil:!1})],v=e({framebuffer:e.prop("framebuffer")}),B=e({vert:"\n  precision highp float;\n  attribute vec2 id;\n  uniform sampler2D vertexState;\n  void main () {\n    vec4 state = texture2D(vertexState, id);\n    gl_Position = vec4(2.0 * fract(state.xy) - 1.0, 0, 1);\n  }",frag:"\n  precision highp float;\n  void main () {\n    gl_FragColor = vec4(1, 0, 0, 0);\n  }",attributes:{id:n},uniforms:{vertexState:e.prop("vertexState")},
blend:{enable:!0,func:{src:1,dst:1},equation:"add"},depth:{enable:!1,mask:!1},primitive:"points",count:4096,elements:null}),w=e({framebuffer:e.prop("dest"),vert:"\n  precision highp float;\n  attribute vec2 p;\n  varying vec2 uv;\n  void main () {\n    uv = 0.5 * (p + 1.0);\n    gl_Position = vec4(p, 0, 1);\n  }",frag:"\n  precision highp float;\n  uniform sampler2D src;\n  uniform vec2 axis;\n  varying vec2 uv;\n  void main () {\n    float f = 0.0;\n    for (int i = -16; i <= 16; ++i) {\n      f += (17.0 - abs(float(i))) / 33.0 *\n          texture2D(src, axis * float(i) + uv).r;\n    }\n    gl_FragColor = vec4(f, 0, 0, 1);\n  }",
attributes:{p:[-4,0,4,4,4,-4]},uniforms:{src:function(a,b){return b.src.color[0]},axis:function(a,b){var d=[0,0];d[b.axis]=1/1024;return d}},depth:{enable:!1,mask:!1},count:3}),J=e({framebuffer:e.prop("dest"),vert:"\n  precision highp float;\n  attribute vec2 p;\n  varying vec2 uv;\n  void main () {\n    uv = 0.5 * (p + 1.0);\n    gl_Position = vec4(p, 0, 1);\n  }",frag:"\n  precision highp float;\n  uniform sampler2D src;\n  uniform vec2 deriv;\n  varying vec2 uv;\n  void main () {\n    float f01 = texture2D(src, uv - vec2(deriv.x, 0)).x;\n    float f21 = texture2D(src, uv + vec2(deriv.x, 0)).x;\n    float f10 = texture2D(src, uv - vec2(0, deriv.y)).x;\n    float f12 = texture2D(src, uv + vec2(0, deriv.y)).x;\n    gl_FragColor = vec4(f21 - f01, f12 - f10, 0, 1);\n  }",
attributes:{p:[-4,0,4,4,4,-4]},uniforms:{src:e.prop("src"),deriv:function(a,b){return[1/b.src.width,1/b.src.height]}},depth:{enable:!1,mask:!1},count:3}),p=e({framebuffer:e.prop("dest"),vert:"\n  precision highp float;\n  attribute vec4 edge;\n  varying vec2 force;\n  uniform sampler2D vertexState;\n  uniform float restLength, stiffness;\n  void main () {\n    vec4 s0 = texture2D(vertexState, edge.rg);\n    vec4 s1 = texture2D(vertexState, edge.ba);\n    vec2 d = s1.xy - s0.xy;\n    float l = max(length(d), 0.001);\n    force = stiffness * log(l / restLength) * d / l;\n    gl_Position = vec4(2.0 * edge.xy - 1.0 + 1.0 / 64.0, 0, 1);\n  }",
frag:"\n  precision highp float;\n  varying vec2 force;\n  void main () {\n    gl_FragColor = vec4(0, 0, force);\n  }",attributes:{edge:t.map(function(a){var b=k(a[0]);a=k(a[1]);return[b[0]/64,b[1]/64,a[0]/64,a[1]/64]})},uniforms:{vertexState:e.prop("src"),restLength:g,stiffness:.08},blend:{enable:!0,func:{src:1,dst:1},equation:"add"},depth:{enable:!1,mask:!1},count:t.length,primitive:"points"}),q=e({framebuffer:e.prop("dest"),vert:"\n  precision highp float;\n  attribute vec2 p;\n  varying vec2 id;\n  void main () {\n    id = 0.5 * (p + 1.0);\n    gl_Position = vec4(p, 0, 1);\n  }",
frag:"\n  precision highp float;\n  uniform sampler2D vertexState, field;\n  uniform float temperature, t;\n  varying vec2 id;\n\n  float rnd (vec2 co) {\n  \treturn fract(sin(t*0.1+dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n  }\n\n  void main () {\n    vec4 state = texture2D(vertexState, id);\n    vec2 p = state.rg;\n    vec2 v = state.ba;\n    vec2 force = texture2D(field, p).xy;\n    p += 1.0E-4 * v;\n    v = float(0.98) * (v - float(0.05) * force);\n    vec2 jitter = vec2(rnd(id), rnd(id + 1000.0)) - 0.5;\n    gl_FragColor = vec4(p + temperature * jitter, v);\n  }",
attributes:{p:[-4,0,4,-4,4,4]},uniforms:{vertexState:e.prop("src"),field:e.prop("field"),temperature:function(a){return 1/(.5*a.tick+20)},t:e.context("tick")},count:3}),y=e({vert:"\n  precision highp float;\n  attribute vec2 id;\n  uniform sampler2D vertexState;\n  void main () {\n    vec4 state = texture2D(vertexState, id);\n    gl_PointSize = 2.0;\n    gl_Position = vec4(2.0 * fract(state.xy) - 1.0, 0, 1);\n  }",frag:"\n  precision highp float;\n  void main () {\n    gl_FragColor = vec4(0, 0, 0, 1);\n  }",
attributes:{id:n},uniforms:{vertexState:function(a){return c[a.tick%2].color[0]}},depth:{enable:!1,mask:!1},primitive:"points",count:4096,elements:null}),l=e({vert:"\n  precision highp float;\n  attribute vec4 id;\n  attribute float arcDir;\n  uniform float dir;\n  uniform sampler2D vertexState;\n  void main () {\n    float side = arcDir + dir - 2.0 * dir * arcDir;\n    vec2 s0 = texture2D(vertexState, id.rg).xy;\n    vec2 s1 = texture2D(vertexState, id.ba).xy;\n    vec2 shift = mix(fract(s0) - s0, fract(s1) - s1, side);\n    gl_Position = vec4(2.0 * (s0.xy + shift) - 1.0, 0, 1);\n  }",
frag:"\n  void main () {\n    gl_FragColor = vec4(0.1, 0, 1, 1);\n  }",attributes:{id:t.map(function(a){var b=k(a[0]);a=k(a[1]);return[b[0]/64,b[1]/64,a[0]/64,a[1]/64]}),arcDir:t.map(function(a,b){return b%2})},uniforms:{vertexState:function(a){return c[a.tick%2].color[0]},dir:e.prop("dir")},depth:{enable:!1,mask:!1},count:t.length,primitive:"lines",lineWidth:2}),f=e({vert:"\n  uniform vec2 mouse;\n  attribute float p;\n  void main () {\n    gl_PointSize = 32.0;\n    gl_Position = vec4(mouse, p, 1);\n  }",
frag:"\n  precision highp float;\n  uniform float strength;\n  void main () {\n    float s = strength * exp(-16.0 * dot(gl_PointCoord.xy, gl_PointCoord.xy));\n    gl_FragColor = vec4(s, 0, 0, 1);\n  }",attributes:{p:[0]},uniforms:{mouse:function(a){var b=a.pixelRatio;return[2*b*D.x/a.drawingBufferWidth-1,1-2*b*D.y/a.drawingBufferHeight]},strength:function(){return D.buttons?5:1}},count:1,primitive:"points"});e.frame(function(b){a(b);e.clear({color:[1,1,1,1]});l([{dir:0},{dir:1}]);y()})},{"../regl":35,
"mouse-change":33}],2:[function(g,n,r){function k(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}n.exports=function(a,e,D,b,d){a=D.maxAttributes;e=Array(a);for(D=0;D<a;++D)e[D]=new k;return{Record:k,scope:{},state:e}}},{}],3:[function(g,n,r){function k(a){return E[Object.prototype.toString.call(a)]|0}function a(a,b){for(var d=0;d<b.length;++d)a[d]=b[d]}function e(a,b,d,e,c,k,f){for(var t=0,m=0;m<d;++m)for(var K=
0;K<e;++K)a[t++]=b[c*m+k*K+f]}function D(a,b,d){for(var e=0,c=0;c<b.length;++c)for(var k=b[c],f=0;f<d;++f)a[e++]=k[f]}var b=g("./util/is-typed-array"),d=g("./util/is-ndarray"),c=g("./util/values"),t=g("./util/pool"),E=g("./constants/arraytypes.json"),v=g("./constants/dtypes.json"),B=g("./constants/usage.json");n.exports=function(w,g){function p(a){this.id=f++;this.buffer=w.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function q(a,b,d){a.byteLength=
b.byteLength;w.bufferData(a.type,b,d)}function y(c,f,m,l,p){c.usage=m;if(Array.isArray(f))c.dtype=l||5126,0<f.length&&(Array.isArray(f[0])?(c.dimension=f[0].length,l=t.allocType(c.dtype,f.length*c.dimension),D(l,f,c.dimension),q(c,l,m),t.freeType(l)):"number"===typeof f[0]?(c.dimension=p,l=t.allocType(c.dtype,f.length),a(l,f),q(c,l,m),t.freeType(l)):b(f[0])&&(c.dimension=f[0].length,c.dtype=l||k(f[0])||5126,l=t.allocType(c.dtype,f.length*c.dimension),D(l,f,c.dimension),q(c,l,m),t.freeType(l)));else if(b(f))c.dtype=
l||k(f),c.dimension=p,q(c,f,m);else if(d(f)){var g=f.shape,w=f.stride;p=f.offset;var y=0,x=0,n=0,B=0;1===g.length?(y=g[0],x=1,n=w[0],B=0):2===g.length&&(y=g[0],x=g[1],n=w[0],B=w[1]);c.dtype=l||k(f.data)||5126;c.dimension=x;l=t.allocType(c.dtype,y*x);e(l,f.data,y,x,n,B,p);q(c,l,m);t.freeType(l)}}function l(a){g.bufferCount--;w.deleteBuffer(a.buffer);a.buffer=null;delete n[a.id]}var f=0,n={};p.prototype.bind=function(){w.bindBuffer(this.type,this.buffer)};p.prototype.destroy=function(){l(this)};var m=
[];return{create:function(c,f,m){function q(a){var c=35044,f=null,e=0,m=0,l=1;Array.isArray(a)||b(a)||d(a)?f=a:"number"===typeof a?e=a|0:a&&("data"in a&&(f=a.data),"usage"in a&&(c=B[a.usage]),"type"in a&&(m=v[a.type]),"dimension"in a&&(l=a.dimension|0),"length"in a&&(e=a.length|0));E.bind();f?y(E,f,c,m,l):(w.bufferData(E.type,e,c),E.dtype=m||5121,E.usage=c,E.dimension=l,E.byteLength=e);return q}g.bufferCount++;var E=new p(f);n[E.id]=E;m||q(c);q._reglType="buffer";q._buffer=E;q.subdata=function(c,
f){var m=(f||0)|0;E.bind();if(Array.isArray(c)){if(0<c.length)if("number"===typeof c[0]){var l=t.allocType(E.dtype,c.length);a(l,c);w.bufferSubData(E.type,m,l);t.freeType(l)}else if(Array.isArray(c[0])||b(c[0])){var l=c[0].length,g=t.allocType(E.dtype,c.length*l);D(g,c,l);w.bufferSubData(E.type,m,g);t.freeType(g)}}else if(b(c))w.bufferSubData(E.type,m,c);else if(d(c)){var p=c.shape,K=c.stride,y=g=l=0,n=0;1===p.length?(l=p[0],g=1,y=K[0],n=0):2===p.length&&(l=p[0],g=p[1],y=K[0],n=K[1]);p=Array.isArray(c.data)?
E.dtype:k(c.data);p=t.allocType(p,l*g);e(p,c.data,l,g,y,n,c.offset);w.bufferSubData(E.type,m,p);t.freeType(p)}return q};q.destroy=function(){l(E)};return q},createStream:function(a,b){var c=m.pop();c||(c=new p(a),c.buffer=w.createBuffer());c.bind();y(c,b,35040,0,1);return c},destroyStream:function(a){m.push(a)},clear:function(){c(n).forEach(l)},getBuffer:function(a){return a&&a._buffer instanceof p?a._buffer:null},_initBuffer:y}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,
"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(g,n,r){n.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(g,n,r){n.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,
"float":5126,float32:5126}},{}],6:[function(g,n,r){n.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(g,n,r){n.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(g,n,r){function k(a){return Array.isArray(a)||E(a)||v(a)}function a(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function e(a,b,c,d){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=
d}function D(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function b(a){return new e(!1,!1,!1,a)}function d(a,b){var c=a.type;return 0===c?(c=a.data.length,new e(!0,1<=c,2<=c,b)):new e(3===c,2===c,1===c,b)}var c=g("./util/codegen"),t=g("./util/loop"),E=g("./util/is-typed-array"),v=g("./util/is-ndarray"),B=g("./util/is-array-like"),w=g("./constants/primitives.json"),J=g("./constants/dtypes.json"),p=["x","y","z","w"],q={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,
"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},y={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},l={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,
"decrement wrap":34056,invert:5386},f={cw:2304,ccw:2305},aa=new e(!1,!1,!1,function(){});n.exports=function(m,g,n,E,v,r,ba,ha,Q,x,P,R,S,sa,W){function N(a){return a.replace(".","_")}function L(a,h,b){var c=N(a);Fa.push(a);xa[c]=ma[c]=!!b;na[c]=h}function I(a,h,b){var c=N(a);Fa.push(a);Array.isArray(b)?(ma[c]=b.slice(),xa[c]=b.slice()):ma[c]=xa[c]=b;oa[c]=h}function X(){var a=c(),h=a.link,b=a.global;a.id=Ma++;a.batchId="0";var d=h(Ka),A=a.shared={props:"a0"};Object.keys(Ka).forEach(function(a){A[a]=
b.def(d,".",a)});var f=a.next={},e=a.current={};Object.keys(oa).forEach(function(a){Array.isArray(ma[a])&&(f[a]=b.def(A.next,".",a),e[a]=b.def(A.current,".",a))});var C=a.constants={};Object.keys(Ga).forEach(function(a){C[a]=b.def(JSON.stringify(Ga[a]))});a.invoke=function(C,b){switch(b.type){case 0:var c=["this",A.context,A.props,a.batchId];return C.def(h(b.data),".call(",c.slice(0,Math.max(b.data.length+1,4)),")");case 1:return C.def(A.props,b.data);case 2:return C.def(A.context,b.data);case 3:return C.def("this",
b.data)}};a.attribCache={};var Ia={};a.scopeAttrib=function(a){a=g.id(a);if(a in Ia)return Ia[a];var C=x.scope[a];C||(C=x.scope[a]=new ca);return Ia[a]=h(C)};return a}function pa(a){var h=a["static"];a=a.dynamic;var c;if("profile"in h){var f=!!h.profile;c=b(function(a,b){return f});c.enable=f}else if("profile"in a){var A=a.profile;c=d(A,function(a,b){return a.invoke(b,A)})}return c}function ta(a){var h=a["static"];a=a.dynamic;if("framebuffer"in h){var c=h.framebuffer;return c?(c=ha.getFramebuffer(c),
b(function(a,b){var h=a.link(c),C=a.shared;b.set(C.framebuffer,".next",h);C=C.context;b.set(C,".framebufferWidth",h+".width");b.set(C,".framebufferHeight",h+".height");return h})):b(function(a,h){var b=a.shared;h.set(b.framebuffer,".next","null");b=b.context;h.set(b,".framebufferWidth",b+".drawingBufferWidth");h.set(b,".framebufferHeight",b+".drawingBufferHeight");return"null"})}if("framebuffer"in a){var f=a.framebuffer;return d(f,function(a,b){var h=a.invoke(b,f),C=a.shared,c=C.framebuffer,h=b.def(c,
".getFramebuffer(",h,")");b.set(c,".next",h);C=C.context;b.set(C,".framebufferWidth",h+"?"+h+".width:"+C+".drawingBufferWidth");b.set(C,".framebufferHeight",h+"?"+h+".height:"+C+".drawingBufferHeight");return h})}return null}function ja(a,b){function h(a){if(a in c){var u=c[a];a=!0;var La=u.x|0,ya=u.y|0,Ea,l;"width"in u?Ea=u.width|0:a=!1;"height"in u?l=u.height|0:a=!1;return new e(!a&&b&&b.thisDep,!a&&b&&b.contextDep,!a&&b&&b.propDep,function(a,b){var C=a.shared.context,h=Ea;"width"in u||(h=b.def(C,
".","framebufferWidth","-",La));var c=l;"height"in u||(c=b.def(C,".","framebufferHeight","-",ya));return[La,ya,h,c]})}if(a in f){var ia=f[a];a=d(ia,function(a,b){var C=a.invoke(b,ia),h=a.shared.context,c=b.def(C,".x|0"),u=b.def(C,".y|0"),G=b.def('"width" in ',C,"?",C,".width|0:","(",h,".","framebufferWidth","-",c,")"),C=b.def('"height" in ',C,"?",C,".height|0:","(",h,".","framebufferHeight","-",u,")");return[c,u,G,C]});b&&(a.thisDep=a.thisDep||b.thisDep,a.contextDep=a.contextDep||b.contextDep,a.propDep=
a.propDep||b.propDep);return a}return b?new e(b.thisDep,b.contextDep,b.propDep,function(a,C){var b=a.shared.context;return[0,0,C.def(b,".","framebufferWidth"),C.def(b,".","framebufferHeight")]}):null}var c=a["static"],f=a.dynamic,ia=h("viewport");if(ia)var l=ia,ia=new e(ia.thisDep,ia.contextDep,ia.propDep,function(a,b){var h=l.append(a,b),c=a.shared.context;b.set(c,".viewportWidth",h[2]);b.set(c,".viewportHeight",h[3]);return h});return{viewport:ia,scissor_box:h("scissor.box")}}function qa(a){function h(a){if(a in
c){var u=g.id(c[a]);a=b(function(){return u});a.id=u;return a}if(a in f){var G=f[a];return d(G,function(a,b){var C=a.invoke(b,G);return b.def(a.shared.strings,".id(",C,")")})}return null}var c=a["static"],f=a.dynamic,A=h("frag"),l=h("vert"),z=null;D(A)&&D(l)?(z=P.program(l.id,A.id),a=b(function(a,b){return a.link(z)})):a=new e(A&&A.thisDep||l&&l.thisDep,A&&A.contextDep||l&&l.contextDep,A&&A.propDep||l&&l.propDep,function(a,b){var h=a.shared.shader,c;c=A?A.append(a,b):b.def(h,".","frag");var u;u=l?
l.append(a,b):b.def(h,".","vert");return b.def(h+".program("+u+","+c+")")});return{frag:A,vert:l,progVar:a,program:z}}function la(a){function h(a,C){if(a in c){var u=c[a]|0;return b(function(a,b){C&&(a.OFFSET=u);return u})}if(a in f){var G=f[a];return d(G,function(a,b){var h=a.invoke(b,G);C&&(a.OFFSET=h);return h})}return C&&A?b(function(a,b){a.OFFSET="0";return 0}):null}var c=a["static"],f=a.dynamic,A=function(){if("elements"in c){var a=c.elements;k(a)?a=r.getElements(r.create(a)):a&&(a=r.getElements(a));
var h=b(function(b,h){if(a){var C=b.link(a);return b.ELEMENTS=C}return b.ELEMENTS=null});h.value=a;return h}if("elements"in f){var u=f.elements;return d(u,function(a,b){var h=a.shared,C=h.isBufferArgs,h=h.elements,c=a.invoke(b,u),G=b.def("null"),C=b.def(C,"(",c,")"),c=a.cond(C).then(G,"=",h,".createStream(",c,");")["else"](G,"=",h,".getElements(",c,");");b.entry(c);b.exit(a.cond(C).then(h,".destroyStream(",G,");"));return a.ELEMENTS=G})}return null}(),l=h("offset",!0);return{elements:A,primitive:function(){if("primitive"in
c){var a=c.primitive;return b(function(b,h){return w[a]})}if("primitive"in f){var h=f.primitive;return d(h,function(a,b){var c=a.constants.primTypes,u=a.invoke(b,h);return b.def(c,"[",u,"]")})}return A?D(A)?A.value?b(function(a,b){return b.def(a.ELEMENTS,".primType")}):b(function(){return 4}):new e(A.thisDep,A.contextDep,A.propDep,function(a,b){var h=a.ELEMENTS;return b.def(h,"?",h,".primType:",4)}):null}(),count:function(){if("count"in c){var a=c.count|0;return b(function(){return a})}if("count"in
f){var h=f.count;return d(h,function(a,b){return a.invoke(b,h)})}return A?D(A)?A?l?new e(l.thisDep,l.contextDep,l.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):b(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):b(function(){return-1}):new e(A.thisDep||l.thisDep,A.contextDep||l.contextDep,A.propDep||l.propDep,function(a,b){var h=a.ELEMENTS;return a.OFFSET?b.def(h,"?",h,".vertCount-",a.OFFSET,":-1"):b.def(h,"?",h,".vertCount:-1")}):null}(),instances:h("instances",!1),
offset:l}}function T(a){var c=a["static"],e=a.dynamic,z={};Fa.forEach(function(a){function u(h,f){if(a in c){var l=h(c[a]);z[k]=b(function(){return l})}else if(a in e){var ya=e[a];z[k]=d(ya,function(a,b){return f(a,b,a.invoke(b,ya))})}}var k=N(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return u(function(a){return a},function(a,
b,h){return h});case "depth.func":return u(function(a){return y[a]},function(a,b,h){return b.def(a.constants.compareFuncs,"[",h,"]")});case "depth.range":return u(function(a){return a},function(a,b,h){a=b.def("+",h,"[0]");b=b.def("+",h,"[1]");return[a,b]});case "blend.func":return u(function(a){return[q["srcRGB"in a?a.srcRGB:a.src],q["dstRGB"in a?a.dstRGB:a.dst],q["srcAlpha"in a?a.srcAlpha:a.src],q["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,h){function c(a,C){var G=b.def('"',a,C,'" in ',h,"?",
h,".",a,C,":",h,".",a);return b.def(u,"[",G,"]")}var u=a.constants.blendFuncs;a=c("src","RGB");var G=c("src","Alpha"),f=c("dst","RGB"),d=c("dst","Alpha");return[a,f,G,d]});case "blend.equation":return u(function(a){if("string"===typeof a)return[h[a],h[a]];if("object"===typeof a)return[h[a.rgb],h[a.alpha]]},function(a,b,h){var c=a.constants.blendEquations,u=b.def(),G=b.def();a=a.cond("typeof ",h,'==="string"');a.then(u,"=",G,"=",c,"[",h,"];");a["else"](u,"=",c,"[",h,".rgb];",G,"=",c,"[",h,".alpha];");
b(a);return[u,G]});case "blend.color":return u(function(a){return t(4,function(b){return+a[b]})},function(a,b,h){return t(4,function(a){return b.def("+",h,"[",a,"]")})});case "stencil.mask":return u(function(a){return a|0},function(a,b,h){return b.def(h,"|0")});case "stencil.func":return u(function(a){return[y[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,h){a=b.def('"cmp" in ',h,"?",a.constants.compareFuncs,"[",h,".cmp]",":",7680);var c=b.def(h,".ref|0");b=b.def('"mask" in ',h,"?",
h,".mask|0:-1");return[a,c,b]});case "stencil.opFront":case "stencil.opBack":return u(function(b){return["stencil.opBack"===a?1029:1028,l[b.fail||"keep"],l[b.zfail||"keep"],l[b.pass||"keep"]]},function(b,h,c){function u(a){return h.def('"',a,'" in ',c,"?",G,"[",c,".",a,"]:",7680)}var G=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,u("fail"),u("zfail"),u("pass")]});case "polygonOffset.offset":return u(function(a){return[a.factor|0,a.units|0]},function(a,b,h){a=b.def(h,".factor|0");b=
b.def(h,".units|0");return[a,b]});case "cull.face":return u(function(a){var b=0;"front"===a?b=1028:"back"===a&&(b=1029);return b},function(a,b,h){return b.def(h,'==="front"?',1028,":",1029)});case "lineWidth":return u(function(a){return a},function(a,b,h){return h});case "frontFace":return u(function(a){return f[a]},function(a,b,h){return b.def(h+'==="cw"?2304:2305')});case "colorMask":return u(function(a){return a.map(function(a){return!!a})},function(a,b,h){return t(4,function(a){return"!!"+h+"["+
a+"]"})});case "sample.coverage":return u(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,b,h){a=b.def('"value" in ',h,"?+",h,".value:1");b=b.def("!!",h,".invert");return[a,b]})}});return z}function da(a){var h=a["static"],c=a.dynamic,f={};Object.keys(h).forEach(function(a){var c=h[a],u;"number"===typeof c||"boolean"===typeof c?u=b(function(){return c}):"function"!==typeof c||"texture2d"!==c._reglType&&"textureCube"!==c._reglType?B(c)&&(u=b(function(a){return a.global.def("[",t(c.length,
function(a){return c[a]}),"]")})):u=b(function(a){return a.link(c)});u.value=c;f[a]=u});Object.keys(c).forEach(function(a){var b=c[a];f[a]=d(b,function(a,h){return a.invoke(h,b)})});return f}function ea(a){var h=a["static"],c=a.dynamic,f={};Object.keys(h).forEach(function(a){var c=h[a],u=g.id(a),d=new ca;if(k(c))d.state=1,d.buffer=v.getBuffer(v.create(c,34962,!1)),d.type=d.buffer.dtype;else{var l=v.getBuffer(c);if(l)d.state=1,d.buffer=l,d.type=l.dtype;else if(c.constant){var e=c.constant;d.state=
2;"number"===typeof e?d.x=e:p.forEach(function(a,b){b<e.length&&(d[a]=e[b])})}else{var l=v.getBuffer(c.buffer),z=c.offset|0,Ea=c.stride|0,F=c.size|0,q=!!c.normalized,m=0;"type"in c&&(m=J[c.type]);c=c.divisor|0;d.buffer=l;d.state=1;d.size=F;d.normalized=q;d.type=m||l.dtype;d.offset=z;d.stride=Ea;d.divisor=c}}f[a]=b(function(a,b){var h=a.attribCache;if(u in h)return h[u];var c={isStream:!1};Object.keys(d).forEach(function(a){c[a]=d[a]});d.buffer&&(c.buffer=a.link(d.buffer));return h[u]=c})});Object.keys(c).forEach(function(a){var b=
c[a];f[a]=d(b,function(a,h){function c(a){h(l[a],"=",u,".",a,"|0;")}var u=a.invoke(h,b),d=a.shared,f=d.isBufferArgs,G=d.buffer,l={isStream:h.def(!1)},e=new ca;e.state=1;Object.keys(e).forEach(function(a){l[a]=h.def(""+e[a])});var A=l.buffer,z=l.type;h("if(",f,"(",u,")){",l.isStream,"=true;",A,"=",G,".createStream(",34962,",",u,");",z,"=",A,".dtype;","}else{",A,"=",G,".getBuffer(",u,");","if(",A,"){",z,"=",A,".dtype;","}else if(",u,".constant){",l.state,"=",2,";",p.map(function(a,b){return l[a]+"="+
u+".length>="+b+"?"+u+"["+b+"]:0;"}).join(""),"}else{",A,"=",G,".getBuffer(",u,".buffer);",z,'="type" in ',u,"?",d.glTypes,"[",u,".type]:",A,".dtype;",l.normalized,"=!!",u,".normalized;");c("size");c("offset");c("stride");c("divisor");h("}}");return l})});return f}function fa(a){var h=a["static"],c=a.dynamic,f={};Object.keys(h).forEach(function(a){var c=h[a];f[a]=b(function(a,b){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var b=c[a];f[a]=d(b,
function(a,h){return a.invoke(h,b)})});return f}function H(a,b,h){var c=a.shared.context,d=a.scope();Object.keys(h).forEach(function(f){b.save(c,"."+f);d(c,".",f,"=",h[f].append(a,b),";")});b(d)}function M(a,b,h){var c=a.shared,d=c.gl,f=c.framebuffer,l;z&&(l=b.def(c.extensions,".webgl_draw_buffers"));var e=a.constants,c=e.drawBuffer,e=e.backBuffer;a=h?h.append(a,b):b.def(f,".next");b("if(",f,".dirty||",a,"!==",f,".cur){","if(",a,"){",d,".bindFramebuffer(",36160,",",a,".framebuffer);");z&&b(l,".drawBuffersWEBGL(",
c,"[",a,".colorAttachments.length]);");b("}else{",d,".bindFramebuffer(",36160,",null);");z&&b(l,".drawBuffersWEBGL(",e,");");b("}",f,".cur=",a,";",f,".dirty=false;","}")}function ka(a,b,h){var c=a.shared,d=c.gl,f=a.current,l=a.next,e=c.current,z=c.next,k=a.cond(e,".dirty");Fa.forEach(function(b){b=N(b);if(!(b in h.state)){var c,G;if(b in l){c=l[b];G=f[b];var F=t(ma[b].length,function(a){return k.def(c,"[",a,"]")});k(a.cond(F.map(function(a,b){return a+"!=="+G+"["+b+"]"}).join("||")).then(d,".",oa[b],
"(",F,");",F.map(function(a,b){return G+"["+b+"]="+a}).join(";"),";"))}else c=k.def(z,".",b),F=a.cond(c,"!==",e,".",b),k(F),b in na?F(a.cond(c).then(d,".enable(",na[b],");")["else"](d,".disable(",na[b],");"),e,".",b,"=",c,";"):F(d,".",oa[b],"(",c,");",e,".",b,"=",c,";")}});0===Object.keys(h.state).length&&k(e,".dirty=false;");b(k)}function ga(b,h,c,d){var f=b.shared,l=b.current,e=f.current,z=f.gl;a(Object.keys(c)).forEach(function(a){var f=c[a];if(!d||d(f)){var k=f.append(b,h);if(na[a]){var A=na[a];
D(f)?k?h(z,".enable(",A,");"):h(z,".disable(",A,");"):h(b.cond(k).then(z,".enable(",A,");")["else"](z,".disable(",A,");"));h(e,".",a,"=",k,";")}else if(B(k)){var F=l[a];h(z,".",oa[a],"(",k,");",k.map(function(a,b){return F+"["+b+"]="+a}).join(";"),";")}else h(z,".",oa[a],"(",k,");",e,".",a,"=",k,";")}})}function V(a,b){F&&!a.instancing&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function Y(a,b,h,c,d){function f(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}
function l(a){g=b.def();a(g,"=",f(),";");"string"===typeof d?a(F,".count+=",d,";"):a(F,".count++;");sa&&(c?(p=b.def(),a(p,"=",m,".getNumPendingQueries();")):a(m,".beginQuery(",F,");"))}function e(a){a(F,".cpuTime+=",f(),"-",g,";");sa&&(c?a(m,".pushScopeStats(",p,",",m,".getNumPendingQueries(),",F,");"):a(m,".endQuery();"))}function z(a){var h=b.def(q,".profile");b(q,".profile=",a,";");b.exit(q,".profile=",h,";")}var k=a.shared,F=a.stats,q=k.current,m=k.timer;h=h.profile;var g,p;if(h){if(D(h)){h.enable?
(l(b),e(b.exit),z("true")):z("false");return}h=h.append(a,b);z(h)}else h=b.def(q,".profile");k=a.block();l(k);b("if(",h,"){",k,"}");a=a.block();e(a);b.exit("if(",h,"){",a,"}")}function Z(a,b,h,c,d){function f(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function l(h,c,d){function f(){b("if(!",m,".pointer){",k,".enableVertexAttribArray(",A,");",m,".pointer=true;}");var h=d.type,l;l=d.size?
b.def(d.size,"||",c):c;b("if(",m,".type!==",h,"||",m,".size!==",l,"||",x.map(function(a){return m+"."+a+"!=="+d[a]}).join("||"),"){",k,".bindBuffer(",34962,",",q,".buffer);",k,".vertexAttribPointer(",[A,l,h,d.normalized,d.stride,d.offset],");",m,".type=",h,";",m,".size=",l,";",x.map(function(a){return m+"."+a+"="+d[a]+";"}).join(""),"}");F&&(h=d.divisor,b("if(",m,".divisor!==",h,"){",a.instancing,".vertexAttribDivisorANGLE(",[A,h],");",m,".divisor=",h,";}"))}function z(){b("if(",m,".pointer){",k,
".disableVertexAttribArray(",A,");",m,".pointer=false;","}if(",p.map(function(a,b){return m+"."+a+"!=="+g[b]}).join("||"),"){",k,".vertexAttrib4f(",A,",",g,");",p.map(function(a,b){return m+"."+a+"="+g[b]+";"}).join(""),"}")}var k=e.gl,A=b.def(h,".location"),m=b.def(e.attributes,"[",A,"]");h=d.state;var q=d.buffer,g=[d.x,d.y,d.z,d.w],x=["buffer","normalized","offset","stride"];1===h?f():2===h?z():(b("if(",h,"===",1,"){"),f(),b("}else{"),z(),b("}"))}var e=a.shared;c.forEach(function(c){var e=c.name,
z=h.attributes[e],k;if(z){if(!d(z))return;k=z.append(a,b)}else{if(!d(aa))return;var m=a.scopeAttrib(e);k={};Object.keys(new ca).forEach(function(a){k[a]=b.def(m,".",a)})}l(a.link(c),f(c.info.type),k)})}function ua(a,b,h,c,d){for(var f=a.shared,l=f.gl,e,z=0;z<c.length;++z){var k=c[z],m=k.name,F=k.info.type,q=h.uniforms[m],k=a.link(k)+".location",p;if(q){if(!d(q))continue;if(D(q)){m=q.value;if(35678===F||35680===F)F=a.link(m._texture),b(l,".uniform1i(",k,",",F+".bind());"),b.exit(F,".unbind();");else if(35674===
F||35675===F||35676===F)m=a.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),q=2,35675===F?q=3:35676===F&&(q=4),b(l,".uniformMatrix",q,"fv(",k,",false,",m,");");else{switch(F){case 5126:e="1f";break;case 35664:e="2f";break;case 35665:e="3f";break;case 35666:e="4f";break;case 35670:e="1i";break;case 5124:e="1i";break;case 35671:e="2i";break;case 35667:e="2i";break;case 35672:e="3i";break;case 35668:e="3i";break;case 35673:e="4i";break;case 35669:e="4i"}b(l,".uniform",e,"(",k,",",
B(m)?Array.prototype.slice.call(m):m,");")}continue}else p=q.append(a,b)}else{if(!d(aa))continue;p=b.def(f.uniforms,"[",g.id(m),"]")}m=1;switch(F){case 35678:case 35680:F=b.def(p,"._texture");b(l,".uniform1i(",k,",",F,".bind());");b.exit(F,".unbind();");continue;case 5124:case 35670:e="1i";break;case 35667:case 35671:e="2i";m=2;break;case 35668:case 35672:e="3i";m=3;break;case 35669:case 35673:e="4i";m=4;break;case 5126:e="1f";break;case 35664:e="2f";m=2;break;case 35665:e="3f";m=3;break;case 35666:e=
"4f";m=4;break;case 35674:e="Matrix2fv";break;case 35675:e="Matrix3fv";break;case 35676:e="Matrix4fv"}b(l,".uniform",e,"(",k,",");if("M"===e.charAt(0)){var k=Math.pow(F-35674+2,2),x=a.global.def("new Float32Array(",k,")");b("false,(Array.isArray(",p,")||",p," instanceof Float32Array)?",p,":(",t(k,function(a){return x+"["+a+"]="+p+"["+a+"]"}),",",x,")")}else 1<m?b(t(m,function(a){return p+"["+a+"]"})):b(p);b(");")}}function va(a,b,h,c){function d(f){var e=m[f];return e?e.contextDep&&c.contextDynamic||
e.propDep?e.append(a,h):e.append(a,b):b.def(z,".",f)}function f(){function a(){h(w,".drawElementsInstancedANGLE(",[p,x,n,g+"<<(("+n+"-5121)>>1)",t],");")}function b(){h(w,".drawArraysInstancedANGLE(",[p,g,x,t],");")}q?y?a():(h("if(",q,"){"),a(),h("}else{"),b(),h("}")):b()}function e(){function a(){h(k+".drawElements("+[p,x,n,g+"<<(("+n+"-5121)>>1)"]+");")}function b(){h(k+".drawArrays("+[p,g,x]+");")}q?y?a():(h("if(",q,"){"),a(),h("}else{"),b(),h("}")):b()}var l=a.shared,k=l.gl,z=l.draw,m=c.draw,
q=function(){var d=m.elements,f=b;if(d){if(d.contextDep&&c.contextDynamic||d.propDep)f=h;d=d.append(a,f)}else d=f.def(z,".","elements");d&&f("if("+d+")"+k+".bindBuffer(34963,"+d+".buffer.buffer);");return d}(),p=d("primitive"),g=d("offset"),x=function(){var d=m.count,f=b;if(d){if(d.contextDep&&c.contextDynamic||d.propDep)f=h;d=d.append(a,f)}else d=f.def(z,".","count");return d}();if("number"===typeof x){if(0===x)return}else h("if(",x,"){"),h.exit("}");var t,w;F&&(t=d("instances"),w=a.instancing);
var n=q+".type",y=m.elements&&D(m.elements);F&&("number"!==typeof t||0<=t)?"string"===typeof t?(h("if(",t,">0){"),f(),h("}else if(",t,"<0){"),e(),h("}")):f():e()}function za(a,b,h,c,d){b=X();d=b.proc("body",d);F&&(b.instancing=d.def(b.shared.extensions,".angle_instanced_arrays"));a(b,d,h,c);return b.compile().body}function Aa(a,b,h,c){V(a,b);Z(a,b,h,c.attributes,function(){return!0});ua(a,b,h,c.uniforms,function(){return!0});va(a,b,b,h)}function Ha(a,b){var h=a.proc("draw",1);V(a,h);H(a,h,b.context);
M(a,h,b.framebuffer);ka(a,h,b);ga(a,h,b.state);Y(a,h,b,!1,!0);var c=b.shader.progVar.append(a,h);h(a.shared.gl,".useProgram(",c,".program);");if(b.shader.program)Aa(a,h,b,b.shader.program);else{var d=a.global.def("{}"),f=h.def(c,".id"),e=h.def(d,"[",f,"]");h(a.cond(e).then(e,".call(this,a0);")["else"](e,"=",d,"[",f,"]=",a.link(function(h){return za(Aa,a,b,h,1)}),"(",c,");",e,".call(this,a0);"))}0<Object.keys(b.state).length&&h(a.shared.current,".dirty=true;")}function Ba(a,b,h,c){function d(){return!0}
a.batchId="a1";V(a,b);Z(a,b,h,c.attributes,d);ua(a,b,h,c.uniforms,d);va(a,b,b,h)}function Ca(a,b,h,c){function d(a){return a.contextDep&&e||a.propDep}function f(a){return!d(a)}V(a,b);var e=h.contextDep,l=b.def(),k=b.def();a.shared.props=k;a.batchId=l;var z=a.scope(),m=a.scope();b(z.entry,"for(",l,"=0;",l,"<","a1",";++",l,"){",k,"=","a0","[",l,"];",m,"}",z.exit);h.needsContext&&H(a,m,h.context);h.needsFramebuffer&&M(a,m,h.framebuffer);ga(a,m,h.state,d);h.profile&&d(h.profile)&&Y(a,m,h,!1,!0);c?(Z(a,
z,h,c.attributes,f),Z(a,m,h,c.attributes,d),ua(a,z,h,c.uniforms,f),ua(a,m,h,c.uniforms,d),va(a,z,m,h)):(b=a.global.def("{}"),c=h.shader.progVar.append(a,m),k=m.def(c,".id"),z=m.def(b,"[",k,"]"),m(a.shared.gl,".useProgram(",c,".program);","if(!",z,"){",z,"=",b,"[",k,"]=",a.link(function(b){return za(Ba,a,h,b,2)}),"(",c,");}",z,".call(this,a0[",l,"],",l,");"))}function wa(a,b){function h(a){return a.contextDep&&d||a.propDep}var c=a.proc("batch",2);a.batchId="0";V(a,c);var d=!1,f=!0;Object.keys(b.context).forEach(function(a){d=
d||b.context[a].propDep});d||(H(a,c,b.context),f=!1);var e=b.framebuffer,l=!1;e?(e.propDep?d=l=!0:e.contextDep&&d&&(l=!0),l||M(a,c,e)):M(a,c,null);b.state.viewport&&b.state.viewport.propDep&&(d=!0);ka(a,c,b);ga(a,c,b.state,function(a){return!h(a)});b.profile&&h(b.profile)||Y(a,c,b,!1,"a1");b.contextDep=d;b.needsContext=f;b.needsFramebuffer=l;f=b.shader.progVar;if(f.contextDep&&d||f.propDep)Ca(a,c,b,null);else if(f=f.append(a,c),c(a.shared.gl,".useProgram(",f,".program);"),b.shader.program)Ca(a,c,
b,b.shader.program);else{var e=a.global.def("{}"),l=c.def(f,".id"),k=c.def(e,"[",l,"]");c(a.cond(k).then(k,".call(this,a0,a1);")["else"](k,"=",e,"[",l,"]=",a.link(function(h){return za(Ca,a,b,h,2)}),"(",f,");",k,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function Da(b,h){function c(a){var e=h.shader[a];e&&d.set(f.shader,"."+a,e.append(b,d))}var d=b.proc("scope",3);b.batchId="a2";var f=b.shared,e=f.current;H(b,d,h.context);h.framebuffer&&h.framebuffer.append(b,
d);a(Object.keys(h.state)).forEach(function(a){var c=h.state[a].append(b,d);B(c)?c.forEach(function(h,c){d.set(b.next[a],"["+c+"]",h)}):d.set(f.next,"."+a,c)});Y(b,d,h,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(a){var c=h.draw[a];c&&d.set(f.draw,"."+a,""+c.append(b,d))});Object.keys(h.uniforms).forEach(function(a){d.set(f.uniforms,"["+g.id(a)+"]",h.uniforms[a].append(b,d))});Object.keys(h.attributes).forEach(function(a){var c=h.attributes[a].append(b,d),f=b.scopeAttrib(a);
Object.keys(new ca).forEach(function(a){d.set(f,"."+a,c[a])})});c("vert");c("frag");0<Object.keys(h.state).length&&(d(e,".dirty=true;"),d.exit(e,".dirty=true;"));d("a1(",b.shared.context,",a0,0);")}var ca=x.Record,h={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(h.min=32775,h.max=32776);var F=n.angle_instanced_arrays,z=n.webgl_draw_buffers,ma={dirty:!0,profile:W.profile},xa={},Fa=[],na={},oa={};L("dither",3024);L("blend.enable",3042);I("blend.color","blendColor",[0,0,0,0]);
I("blend.equation","blendEquationSeparate",[32774,32774]);I("blend.func","blendFuncSeparate",[1,0,1,0]);L("depth.enable",2929,!0);I("depth.func","depthFunc",513);I("depth.range","depthRange",[0,1]);I("depth.mask","depthMask",!0);I("colorMask","colorMask",[!0,!0,!0,!0]);L("cull.enable",2884);I("cull.face","cullFace",1029);I("frontFace","frontFace",2305);I("lineWidth","lineWidth",1);L("polygonOffset.enable",32823);I("polygonOffset.offset","polygonOffset",[0,0]);L("sample.alpha",32926);L("sample.enable",
32928);I("sample.coverage","sampleCoverage",[1,!1]);L("stencil.enable",2960);I("stencil.mask","stencilMask",-1);I("stencil.func","stencilFunc",[519,0,-1]);I("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);I("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);L("scissor.enable",3089);I("scissor.box","scissor",[0,0,m.drawingBufferWidth,m.drawingBufferHeight]);I("viewport","viewport",[0,0,m.drawingBufferWidth,m.drawingBufferHeight]);var Ka={gl:m,context:S,strings:g,next:xa,current:ma,
draw:R,elements:r,buffer:v,shader:P,attributes:x.state,uniforms:Q,framebuffer:ha,extensions:n,timer:sa,isBufferArgs:k},Ga={primTypes:w,compareFuncs:y,blendFuncs:q,blendEquations:h,stencilOps:l,glTypes:J,orientationType:f};z&&(Ga.backBuffer=[1029],Ga.drawBuffer=t(E.maxDrawbuffers,function(a){return 0===a?[0]:t(a,function(a){return 36064+a})}));var Ma=0;return{next:xa,current:ma,procs:function(){var a=X(),b=a.proc("poll"),h=a.proc("refresh"),c=a.block();b(c);h(c);var d=a.shared,f=d.gl,e=d.next,l=d.current;
c(l,".dirty=false;");M(a,b);h(d.framebuffer,".dirty=true;");M(a,h);Object.keys(na).forEach(function(d){var k=na[d],m=c.def(e,".",d),z=a.block();z("if(",m,"){",f,".enable(",k,")}else{",f,".disable(",k,")}",l,".",d,"=",m,";");h(z);b("if(",m,"!==",l,".",d,"){",z,"}")});Object.keys(oa).forEach(function(d){var k=oa[d],m=ma[d],z,F,q=a.block();q(f,".",k,"(");B(m)?(k=m.length,z=a.global.def(e,".",d),F=a.global.def(l,".",d),q(t(k,function(a){return z+"["+a+"]"}),");",t(k,function(a){return F+"["+a+"]="+z+
"["+a+"];"}).join("")),b("if(",t(k,function(a){return z+"["+a+"]!=="+F+"["+a+"]"}).join("||"),"){",q,"}")):(z=c.def(e,".",d),F=c.def(l,".",d),q(z,");",l,".",d,"=",z,";"),b("if(",z,"!==",F,"){",q,"}"));h(q)});return a.compile()}(),compile:function(a,b,h,c,d){var f=X();f.stats=f.link(d);d=ta(a);var e=ja(a,d),l=la(a),k=T(a),z=qa(a),m=e.viewport;m&&(k.viewport=m);m=N("scissor.box");(e=e[m])&&(k[m]=e);e=0<Object.keys(k).length;d={framebuffer:d,draw:l,shader:z,state:k,dirty:e};d.profile=pa(a);d.uniforms=
da(h);d.attributes=ea(b);d.context=fa(c);Ha(f,d);Da(f,d);wa(f,d);return f.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(g,n,r){function k(a,d){this.id=D++;this.type=a;this.data=d}function a(b){if(0===b.length)return[];var d=b.charAt(0),c=b.charAt(b.length-1);if(1<b.length&&d===c&&('"'===d||"'"===d))return['"'+b.substr(1,b.length-2).replace(/\\/g,
"\\\\").replace(/"/g,'\\"')+'"'];if(d=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return a(b.substr(0,d.index)).concat(a(d[1])).concat(a(b.substr(d.index+d[0].length)));d=b.split(".");if(1===d.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(c=0;c<d.length;++c)b=b.concat(a(d[c]));return b}function e(b){return"["+a(b).join("][")+"]"}var D=0;n.exports={define:function(a,d){switch(typeof d){case "boolean":case "number":case "string":return new k(a,e(d+""));case "undefined":return new k(a|
128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof k},unbox:function(a,d){if(a instanceof k){if(a.type&128)return new k(a.type&-129,e(d))}else if("function"===typeof a)return new k(0,a);return a},accessor:e}},{}],10:[function(g,n,r){var k=g("./util/is-typed-array"),a=g("./util/is-ndarray"),e=g("./util/values"),D=g("./constants/primitives.json"),b=g("./constants/usage.json");n.exports=function(d,c,g,n){function v(a){this.id=p++;J[this.id]=this;this.buffer=a;this.primType=
4;this.type=this.vertCount=0}function B(b,d,e,m,q,p,w){(p=w)||k(d)&&(!a(d)||k(d.data))||(p=c.oes_element_index_uint?5125:5123);b.buffer.bind();g._initBuffer(b.buffer,d,e,p,3);d=w;if(!w){switch(b.buffer.dtype){case 5121:case 5120:d=5121;break;case 5123:case 5122:d=5123;break;case 5125:case 5124:d=5125}b.buffer.dtype=d}b.type=d;0>q&&(q=b.buffer.byteLength,5123===d?q>>=1:5125===d&&(q>>=2));b.vertCount=q;q=m;0>m&&(q=4,m=b.buffer.dimension,1===m&&(q=0),2===m&&(q=1),3===m&&(q=4));b.primType=q}function w(a){n.elementsCount--;
delete J[a.id];a.buffer.destroy();a.buffer=null}var J={},p=0,q={uint8:5121,uint16:5123};c.oes_element_index_uint&&(q.uint32=5125);v.prototype.bind=function(){this.buffer.bind()};var y=[];return{create:function(c){function f(c){if(c)if("number"===typeof c)e(c),m.primType=4,m.vertCount=c|0,m.type=5121;else{var l=null,p=35044,g=-1,t=-1,w=0,n=0;Array.isArray(c)||k(c)||a(c)?l=c:("data"in c&&(l=c.data),"usage"in c&&(p=b[c.usage]),"primitive"in c&&(g=D[c.primitive]),"count"in c&&(t=c.count|0),"length"in
c&&(w=c.length|0),"type"in c&&(n=q[c.type]));l?B(m,l,p,g,t,w,n):(c=m.buffer,c.bind(),d.bufferData(34963,w,p),c.dtype=n||5121,c.usage=p,c.dimension=3,c.byteLength=w,m.primType=0>g?4:g,m.vertCount=0>t?0:t,m.type=c.dtype)}else e(),m.primType=4,m.vertCount=0,m.type=5121;return f}var e=g.create(null,34963,!0),m=new v(e._buffer);n.elementsCount++;f(c);f._reglType="elements";f._elements=m;f.subdata=function(a,b){e.subdata(a,b);return f};f.destroy=function(){w(m)};return f},createStream:function(a){var b=
y.pop();b||(b=new v(g.create(null,34963,!0)._buffer));B(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){y.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof v?a._elements:null},clear:function(){e(J).forEach(w)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(g,n,r){n.exports=function(k,a){function e(a){a=a.toLowerCase();if(a in g)return!0;var b;try{b=g[a]=k.getExtension(a)}catch(d){}return!!b}
for(var g={},b=0;b<a.extensions.length;++b){var d=a.extensions[b];if(!e(d))return a.onDestroy(),a.onDone('"'+d+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}a.optionalExtensions.forEach(e);return{extensions:g,refresh:function(){a.extensions.forEach(e);a.optionalExtensions.forEach(e)}}}},{}],12:[function(g,n,r){var k=g("./util/values"),a=g("./util/extend"),e=[];e[6406]=1;e[6409]=1;e[6410]=2;e[6407]=3;e[6408]=4;var D=[];D[5121]=1;
D[5126]=4;D[36193]=2;n.exports=function(b,d,c,g,n,v){function B(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height);this.width=a;this.height=d}function w(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function J(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function p(a,c){c?c.texture?b.framebufferTexture2D(36160,a,c.target,c.texture._texture.texture,
0):b.framebufferRenderbuffer(36160,a,36161,c.renderbuffer._renderbuffer.renderbuffer):b.framebufferTexture2D(36160,a,3553,null,0)}function q(a){var b=3553,c=null,d=null,f=a;"object"===typeof a&&(f=a.data);a=f._reglType;"texture2d"===a?c=f:"textureCube"===a?c=f:"renderbuffer"===a&&(d=f,b=36161);return new B(b,c,d)}function y(a,b,c,d,f){if(c)return a=g.create2D({width:a,height:b,format:d,type:f}),a._texture.refCount=0,new B(3553,a,null);a=n.create({width:a,height:b,format:d});a._renderbuffer.refCount=
0;return new B(36161,null,a)}function l(a){return a&&(a.texture||a.renderbuffer)}function f(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function r(){this.id=ha++;Q[this.id]=this;this.framebuffer=b.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function m(a){a.colorAttachments.forEach(w);w(a.depthAttachment);w(a.stencilAttachment);w(a.depthStencilAttachment)}
function K(a){b.deleteFramebuffer(a.framebuffer);a.framebuffer=null;v.framebufferCount--;delete Q[a.id]}function Ja(a){var d;b.bindFramebuffer(36160,a.framebuffer);var f=a.colorAttachments;for(d=0;d<f.length;++d)p(36064+d,f[d]);for(d=f.length;d<c.maxColorAttachments;++d)p(36064+d,null);p(36096,a.depthAttachment);p(36128,a.stencilAttachment);p(33306,a.depthStencilAttachment);b.checkFramebufferStatus(36160);b.bindFramebuffer(36160,ra.next);ra.current=ra.next}var ra={current:null,next:null,dirty:!1},
U=["rgba"],O=["rgba4","rgb565","rgb5 a1"];d.ext_srgb&&O.push("srgba");d.ext_color_buffer_half_float&&O.push("rgba16f","rgb16f");d.webgl_color_buffer_float&&O.push("rgba32f");var ba=["uint8"];d.oes_texture_half_float&&ba.push("half float");d.oes_texture_float&&ba.push("float");var ha=0,Q={};return a(ra,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof r)?a:null},create:function(a,b){function c(a,b){var f,g=0,p=0,w=!0,t=!0;f=null;var n=
!0,B="rgba",E="uint8",v=1,x=null,r=null,K=null,aa=!1;if("number"===typeof a)g=a|0,p=b|0||g;else if(a){"shape"in a?(p=a.shape,g=p[0],p=p[1]):("radius"in a&&(g=p=a.radius),"width"in a&&(g=a.width),"height"in a&&(p=a.height));if("color"in a||"colors"in a)f=a.color||a.colors,Array.isArray(f);f||("colorCount"in a&&(v=a.colorCount|0),"colorTexture"in a&&(n=!!a.colorTexture,B="rgba4"),"colorType"in a&&(E=a.colorType,n||("half float"===E?d.ext_color_buffer_half_float&&(B="rgba16f"):"float"===E&&d.webgl_color_buffer_float&&
(B="rgba32f"))),"colorFormat"in a&&(B=a.colorFormat,0<=U.indexOf(B)?n=!0:0<=O.indexOf(B)&&(n=!1)));if("depthTexture"in a||"depthStencilTexture"in a)aa=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?w=a.depth:(x=a.depth,t=!1));"stencil"in a&&("boolean"===typeof a.stencil?t=a.stencil:(r=a.stencil,w=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?w=t=a.depthStencil:(K=a.depthStencil,t=w=!1))}else g=p=1;var H=null,M=null,ka=null,ga=null;if(Array.isArray(f))H=
f.map(q);else if(f)H=[q(f)];else for(H=Array(v),f=0;f<v;++f)H[f]=y(g,p,n,B,E);g=g||H[0].width;p=p||H[0].height;x?M=q(x):w&&!t&&(M=y(g,p,aa,"depth","uint32"));r?ka=q(r):t&&!w&&(ka=y(g,p,!1,"stencil","uint8"));K?ga=q(K):!x&&!r&&t&&w&&(ga=y(g,p,aa,"depth stencil","depth stencil"));w=null;for(f=0;f<H.length;++f)J(H[f],g,p),H[f]&&H[f].texture&&(t=e[H[f].texture._texture.format]*D[H[f].texture._texture.type],null===w&&(w=t));J(M,g,p);J(ka,g,p);J(ga,g,p);m(k);k.width=g;k.height=p;k.colorAttachments=H;k.depthAttachment=
M;k.stencilAttachment=ka;k.depthStencilAttachment=ga;c.color=H.map(l);c.depth=l(M);c.stencil=l(ka);c.depthStencil=l(ga);c.width=k.width;c.height=k.height;Ja(k);return c}var k=new r;v.framebufferCount++;c(a,b);c.resize=function(a,b){var d=a|0,e=b|0||d;if(d===k.width&&e===k.height)return c;for(var l=k.colorAttachments,m=0;m<l.length;++m)f(l[m],d,e);f(k.depthAttachment,d,e);f(k.stencilAttachment,d,e);f(k.depthStencilAttachment,d,e);k.width=c.width=d;k.height=c.height=e;Ja(k);return c};c._reglType="framebuffer";
c._framebuffer=k;c.destroy=function(){K(k);m(k)};return c},clear:function(){k(Q).forEach(K)}})}},{"./util/extend":23,"./util/values":31}],13:[function(g,n,r){n.exports=function(k,a){var e=1;a.ext_texture_filter_anisotropic&&(e=k.getParameter(34047));var g=1,b=1;a.webgl_draw_buffers&&(g=k.getParameter(34852),b=k.getParameter(36063));return{colorBits:[k.getParameter(3410),k.getParameter(3411),k.getParameter(3412),k.getParameter(3413)],depthBits:k.getParameter(3414),stencilBits:k.getParameter(3415),
subpixelBits:k.getParameter(3408),extensions:Object.keys(a).filter(function(b){return!!a[b]}),maxAnisotropic:e,maxDrawbuffers:g,maxColorAttachments:b,pointSizeDims:k.getParameter(33901),lineWidthDims:k.getParameter(33902),maxViewportDims:k.getParameter(3386),maxCombinedTextureUnits:k.getParameter(35661),maxCubeMapSize:k.getParameter(34076),maxRenderbufferSize:k.getParameter(34024),maxTextureUnits:k.getParameter(34930),maxTextureSize:k.getParameter(3379),maxAttributes:k.getParameter(34921),maxVertexUniforms:k.getParameter(36347),
maxVertexTextureUnits:k.getParameter(35660),maxVaryingVectors:k.getParameter(36348),maxFragmentUniforms:k.getParameter(36349),glsl:k.getParameter(35724),renderer:k.getParameter(7937),vendor:k.getParameter(7936),version:k.getParameter(7938)}}},{}],14:[function(g,n,r){var k=g("./util/is-typed-array");n.exports=function(a,e,g){return function(b){var d=0,c=0,t=g.framebufferWidth,n=g.framebufferHeight,v=null;k(b)?v=b:2===arguments.length?(t=arguments[0]|0,n=arguments[1]|0):b&&(d=b.x|0,c=b.y|0,t=b.width||
g.framebufferWidth,n=b.height||g.framebufferHeight,v=b.data||null);e();v=v||new Uint8Array(t*n*4);a.pixelStorei(3333,4);a.readPixels(d,c,t,n,6408,5121,v);return v}}},{"./util/is-typed-array":26}],15:[function(g,n,r){var k=g("./util/values");n.exports=function(a,e,g,b){function d(a){this.id=n++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0}function c(c){var d=c.renderbuffer;a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(d);c.renderbuffer=null;c.refCount=0;delete v[c.id];
b.renderbufferCount--}var t={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(t.srgba=35907);e.ext_color_buffer_half_float&&(t.rgba16f=34842,t.rgb16f=34843);e.webgl_color_buffer_float&&(t.rgba32f=34836);var n=0,v={};d.prototype.decRef=function(){0>=--this.refCount&&c(this)};return{create:function(c,e){function k(b,c){var d=0,f=0,e=32854;"object"===typeof b&&b?("shape"in b?(f=b.shape,d=f[0]|0,f=f[1]|0):("radius"in b&&(d=f=b.radius|0),"width"in b&&
(d=b.width|0),"height"in b&&(f=b.height|0)),"format"in b&&(e=t[b.format])):"number"===typeof b?(d=b|0,f="number"===typeof c?c|0:d):b||(d=f=1);if(d!==g.width||f!==g.height||e!==g.format)return k.width=g.width=d,k.height=g.height=f,g.format=e,a.bindRenderbuffer(36161,g.renderbuffer),a.renderbufferStorage(36161,e,d,f),k}var g=new d(a.createRenderbuffer());v[g.id]=g;b.renderbufferCount++;k(c,e);k.resize=function(b,c){var d=b|0,f=c|0||d;if(d===g.width&&f===g.height)return k;k.width=g.width=d;k.height=
g.height=f;a.bindRenderbuffer(36161,g.renderbuffer);a.renderbufferStorage(36161,g.format,d,f);return k};k._reglType="renderbuffer";k._renderbuffer=g;k.destroy=function(){g.decRef()};return k},clear:function(){k(v).forEach(c)}}}},{"./util/values":31}],16:[function(g,n,r){var k=g("./util/values");n.exports=function(a,e,g){function b(a,b,c,d){this.name=a;this.id=b;this.location=c;this.info=d}function d(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function c(b,
c,d){d=35632===b?n:v;var k=d[c];if(!k){var f=e.str(c),k=a.createShader(b);a.shaderSource(k,f);a.compileShader(k);d[c]=k}return k}function t(a,b){this.id=J++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}var n={},v={},B={},w=[],J=0;return{clear:function(){var b=a.deleteShader.bind(a);k(n).forEach(b);n={};k(v).forEach(b);v={};w.forEach(function(b){a.deleteProgram(b.program)});w.length=0;B={};g.shaderCount=0},program:function(k,q,n){g.shaderCount++;(n=B[q])||(n=B[q]=
{});var l=n[k];if(!l){var f=l=new t(q,k),v,m;v=c(35632,f.fragId);m=c(35633,f.vertId);q=f.program=a.createProgram();a.attachShader(q,v);a.attachShader(q,m);a.linkProgram(q);var E=a.getProgramParameter(q,35718),J=f.uniforms;for(v=0;v<E;++v)if(m=a.getActiveUniform(q,v))if(1<m.size)for(var r=0;r<m.size;++r){var U=m.name.replace("[0]","["+r+"]");d(J,new b(U,e.id(U),a.getUniformLocation(q,U),m))}else d(J,new b(m.name,e.id(m.name),a.getUniformLocation(q,m.name),m));E=a.getProgramParameter(q,35721);f=f.attributes;
for(v=0;v<E;++v)(m=a.getActiveAttrib(q,v))&&d(f,new b(m.name,e.id(m.name),a.getAttribLocation(q,m.name),m));n[k]=l;w.push(l)}return l},shader:c,frag:null,vert:null}}},{"./util/values":31}],17:[function(g,n,r){n.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(g,n,r){n.exports=function(){var k={"":0},a=[""];return{id:function(e){var g=k[e];if(g)return g;g=k[e]=a.length;a.push(e);return g},str:function(e){return a[e]}}}},
{}],19:[function(g,n,r){function k(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&w(a[0])?!0:!1}function e(a){return Object.prototype.toString.call(a)}function D(b){if(!b)return!1;var c=e(b);return 0<=l.indexOf(c)?!0:k(b)||a(b)||E(b)}function b(a,b){36193===a.type?(a.data=B(b),v.freeType(b)):a.data=b}var d=g("./util/extend"),c=g("./util/values"),t=g("./util/is-typed-array"),E=g("./util/is-ndarray"),v=g("./util/pool"),B=g("./util/to-half-float"),
w=g("./util/is-array-like");r=g("./constants/arraytypes.json");var J=g("./constants/arraytypes.json"),p=[9984,9986,9985,9987],q=[0,6409,6410,6407,6408],y={};y[6409]=y[6406]=y[6402]=1;y[34041]=y[6410]=2;y[6407]=3;y[6408]=4;var l=Object.keys(r).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);n.exports=function(f,g,m,l,n,r){function U(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=
this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function O(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function ba(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=
b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=ga[b.colorSpace]);"type"in b&&(a.type=V[b.type]);var c=a.width,d=a.height,f=a.channels,e=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(f=b.shape[2],e=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(f=b.channels,e=!0));a.width=c|0;a.height=d|0;a.channels=f|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=Y[c],a.format=za[d],c in V&&!("type"in
b)&&(a.type=V[c]),c in Z&&(a.compressed=!0),c=!0);!e&&c?a.channels=y[a.format]:e&&!c&&a.channels!==q[a.format]&&(a.format=a.internalformat=q[a.channels])}}function ha(a){f.pixelStorei(37440,a.flipY);f.pixelStorei(37441,a.premultiplyAlpha);f.pixelStorei(37443,a.colorSpace);f.pixelStorei(3317,a.unpackAlignment)}function Q(){U.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function x(c,d){var f=null;D(d)?f=d:d&&(ba(c,d),"x"in d&&(c.xOffset=
d.x|0),"y"in d&&(c.yOffset=d.y|0),D(d.data)&&(f=d.data));if(d.copy){var g=n.viewportWidth,l=n.viewportHeight;c.width=c.width||g-c.xOffset;c.height=c.height||l-c.yOffset;c.needsCopy=!0}else if(!f)c.width=c.width||1,c.height=c.height||1;else if(t(f))c.data=f,"type"in d||5121!==c.type||(c.type=J[Object.prototype.toString.call(f)]|0);else if(k(f)){g=f;l=c.width*c.height*c.channels;switch(c.type){case 5121:case 5123:case 5125:case 5126:l=v.allocType(c.type,l);l.set(g);c.data=l;break;case 36193:c.data=
B(g)}c.alignment=1;c.needsFree=!0}else if(E(f)){g=f.data;Array.isArray(g)||5121!==c.type||(c.type=J[Object.prototype.toString.call(g)]|0);var l=f.shape,m=f.stride,p,y,r,x;3===l.length?(r=l[2],x=m[2]):x=r=1;p=l[0];y=l[1];l=m[0];m=m[1];c.alignment=1;c.width=p;c.height=y;c.channels=r;c.format=c.internalformat=q[r];c.needsFree=!0;p=x;f=f.offset;r=c.width;x=c.height;y=c.channels;for(var M=v.allocType(36193===c.type?5126:c.type,r*x*y),u=0,G=0;G<x;++G)for(var K=0;K<r;++K)for(var H=0;H<y;++H)M[u++]=g[l*K+
m*G+p*H+f];b(c,M)}else if("[object HTMLCanvasElement]"===e(f)||"[object CanvasRenderingContext2D]"===e(f))"[object HTMLCanvasElement]"===e(f)?c.element=f:c.element=f.canvas,c.width=c.element.width,c.height=c.element.height;else if("[object HTMLImageElement]"===e(f))c.element=f,c.width=f.naturalWidth,c.height=f.naturalHeight;else if("[object HTMLVideoElement]"===e(f))c.element=f,c.width=f.videoWidth,c.height=f.videoHeight,c.needsPoll=!0;else if(a(f)){g=f[0].length;l=f.length;m=1;if(w(f[0][0])){p=m=
f[0][0].length;r=v.allocType(36193===c.type?5126:c.type,g*l*p);for(y=x=0;y<l;++y)for(M=f[y],u=0;u<g;++u)for(G=M[u],K=0;K<p;++K)r[x++]=G[K];b(c,r)}else{p=v.allocType(36193===c.type?5126:c.type,g*l);for(x=r=0;x<l;++x)for(y=f[x],M=0;M<g;++M)p[r++]=y[M];b(c,p)}c.alignment=1;c.width=g;c.height=l;c.channels=m;c.format=c.internalformat=q[m];c.needsFree=!0}}function P(a,b,c,d,e){var k=a.element,g=a.data,m=a.internalformat,p=a.format,q=a.type,n=a.width,w=a.height;ha(a);k?f.texSubImage2D(b,e,c,d,p,q,k):a.compressed?
f.compressedTexSubImage2D(b,e,c,d,m,n,w,g):a.needsCopy?(l(),f.copyTexSubImage2D(b,e,c,d,a.xOffset,a.yOffset,n,w)):f.texSubImage2D(b,e,c,d,n,w,p,q,g)}function R(){return Aa.pop()||new Q}function S(a){a.needsFree&&v.freeType(a.data);Q.call(a);Aa.push(a)}function sa(){U.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function W(a,b,c){var d=a.images[0]=R();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function N(a,b){var c=null;if(D(b))c=a.images[0]=R(),O(c,
a),x(c,b),a.mipmask=1;else if(ba(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,f=0;f<d.length;++f)c=a.images[f]=R(),O(c,a),c.width>>=f,c.height>>=f,x(c,d[f]),a.mipmask|=1<<f;else c=a.images[0]=R(),O(c,a),x(c,b),a.mipmask=1;O(a,a.images[0])}function L(a,b){for(var c=a.images,d=0;d<c.length&&c[d];++d){var e=c[d],k=b,g=d,m=e.element,p=e.data,q=e.internalformat,n=e.format,w=e.type,t=e.width,v=e.height;ha(e);m?f.texImage2D(k,g,n,n,w,m):e.compressed?f.compressedTexImage2D(k,g,q,t,v,0,p):e.needsCopy?(l(),
f.copyTexImage2D(k,g,n,e.xOffset,e.yOffset,t,v,0)):f.texImage2D(k,g,n,t,v,0,n,w,p)}}function I(){var a=Ha.pop()||new sa;U.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function X(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&S(b[c]),b[c]=null;Ha.push(a)}function pa(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ta(a,b){"min"in b&&(a.minFilter=ka[b.min],0<=p.indexOf(a.minFilter)&&(a.genMipmaps=
!0));"mag"in b&&(a.magFilter=M[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var f=b.wrap;"string"===typeof f?c=d=H[f]:Array.isArray(f)&&(c=H[f[0]],d=H[f[1]])}else"wrapS"in b&&(c=H[b.wrapS]),"wrapT"in b&&(d=H[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=fa[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=
9984)}}function ja(a,b){f.texParameteri(b,10241,a.minFilter);f.texParameteri(b,10240,a.magFilter);f.texParameteri(b,10242,a.wrapS);f.texParameteri(b,10243,a.wrapT);g.ext_texture_filter_anisotropic&&f.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(f.hint(33170,a.mipmapHint),f.generateMipmap(b))}function qa(){var a=Ba.pop()||new pa;pa.call(a);return a}function la(a){U.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ca++;this.refCount=1;this.target=a;this.texture=f.createTexture();this.unit=
-1;this.bindCount=0}function T(a){f.activeTexture(33984);f.bindTexture(a.target,a.texture)}function da(){var a=ca[0];a?f.bindTexture(a.target,a.texture):f.bindTexture(3553,null)}function ea(a){var b=a.texture,c=a.unit,d=a.target;0<=c&&(f.activeTexture(33984+c),f.bindTexture(d,null),ca[c]=null);f.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete wa[a.id];r.textureCount--}var fa={"don't care":4352,"dont care":4352,nice:4354,fast:4353},H={repeat:10497,clamp:33071,mirror:33648},
M={nearest:9728,linear:9729},ka=d({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},M),ga={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Z={};g.ext_srgb&&(Y.srgb=35904,Y.srgba=35906);g.oes_texture_float&&(V["float"]=5126);g.oes_texture_half_float&&(V.float16=V["half float"]=36193);
g.webgl_depth_texture&&(d(Y,{depth:6402,"depth stencil":34041}),d(V,{uint16:5123,uint32:5125,"depth stencil":34042}));g.webgl_compressed_texture_s3tc&&d(Z,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});g.webgl_compressed_texture_atc&&d(Z,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});g.webgl_compressed_texture_pvrtc&&d(Z,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
g.webgl_compressed_texture_etc1&&(Z["rgb etc1"]=36196);var ua=Array.prototype.slice.call(f.getParameter(34467));Object.keys(Z).forEach(function(a){var b=Z[a];0<=ua.indexOf(b)&&(Y[a]=b)});var va=Object.keys(Y);m.textureFormats=va;var za=va.reduce(function(a,b){var c=Y[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Aa=[],Ha=[],Ba=[],Ca=0,wa={},Da=m.maxTextureUnits,ca=Array(Da).map(function(){return null});d(la.prototype,
{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<Da;++b){var c=ca[b];if(c){if(0<c.bindCount)continue;c.unit=-1}ca[b]=this;a=b;break}this.unit=a;f.activeTexture(33984+a);f.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&ea(this)}});return{create2D:function(a,b){function c(a,b){var f=qa(),h=I();"number"===typeof a?"number"===typeof b?W(h,a|0,b|0):W(h,a|0,a|0):a?(ta(f,a),N(h,a)):W(h,1,1);f.genMipmaps&&(h.mipmask=
(h.width<<1)-1);d.mipmask=h.mipmask;O(d,h);d.internalformat=h.internalformat;c.width=h.width;c.height=h.height;T(d);L(h,3553);ja(f,3553);da();Ba.push(f);X(h);return c}var d=new la(3553);wa[d.id]=d;r.textureCount++;c(a,b);c.subimage=function(a,b,f,h){b|=0;f|=0;h|=0;var e=R();O(e,d);e.width>>=h;e.height>>=h;e.width-=b;e.height-=f;x(e,a);T(d);P(e,3553,b,f,h);da();S(e);return c};c.resize=function(a,b){var h=a|0,e=b|0||h;if(h===d.width&&e===d.height)return c;c.width=d.width=h;c.height=d.height=e;T(d);
f.texImage2D(3553,0,d.format,h,e,0,d.format,d.type,null);da();return c};c._reglType="texture2d";c._texture=d;c.destroy=function(){d.decRef()};return c},createCube:function(a,b,c,d,e,k){function g(a,b,c,d,f,h){var e,k=qa();for(e=0;6>e;++e)m[e]=I();if("number"===typeof a||!a)for(a=a|0||1,e=0;6>e;++e)W(m[e],a,a);else if("object"===typeof a)if(b)N(m[0],a),N(m[1],b),N(m[2],c),N(m[3],d),N(m[4],f),N(m[5],h);else if(ta(k,a),ba(l,a),"faces"in a)for(a=a.faces,e=0;6>e;++e)O(m[e],l),N(m[e],a[e]);else for(e=0;6>
e;++e)N(m[e],a);O(l,m[0]);l.mipmask=k.genMipmaps?(m[0].width<<1)-1:m[0].mipmask;l.internalformat=m[0].internalformat;g.width=m[0].width;g.height=m[0].height;T(l);for(e=0;6>e;++e)L(m[e],34069+e);ja(k,34067);da();Ba.push(k);for(e=0;6>e;++e)X(m[e]);return g}var l=new la(34067);wa[l.id]=l;r.cubeCount++;var m=Array(6);g(a,b,c,d,e,k);g.subimage=function(a,b,c,d,e){c|=0;d|=0;e|=0;var f=R();O(f,l);f.width>>=e;f.height>>=e;f.width-=c;f.height-=d;x(f,b);T(l);P(f,34069+a,c,d,e);da();S(f);return g};g.resize=
function(a,b){var c=a|0,d=b|0||c;if(c===l.width&&d===l.height)return g;g.width=l.width=c;g.height=l.height=d;T(l);for(var e=0;6>e;++e)f.texImage2D(34069+e,0,l.format,c,d,0,l.format,l.type,null);da();return g};g._reglType="textureCube";g._texture=l;g.destroy=function(){l.decRef()};return g},clear:function(){for(var a=0;a<Da;++a)f.activeTexture(33984+a),f.bindTexture(3553,null),ca[a]=null;c(wa).forEach(ea);r.cubeCount=0;r.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,
"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(g,n,r){n.exports=function(k,a){function e(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function g(a,b,c){var d=n.pop()||new e;d.startQueryIndex=a;d.endQueryIndex=b;d.sum=0;d.stats=c;r.push(d)}var b=a.ext_disjoint_timer_query;if(!b)return null;var d=[],c=[],n=[],r=[],v=[],B=[];return{beginQuery:function(a){var e=
d.pop()||b.createQueryEXT();b.beginQueryEXT(35007,e);c.push(e);g(c.length-1,c.length,a)},endQuery:function(){b.endQueryEXT(35007)},pushScopeStats:g,update:function(){var a,e;a=c.length;if(0!==a){B.length=Math.max(B.length,a+1);v.length=Math.max(v.length,a+1);v[0]=0;var k=B[0]=0;for(e=a=0;e<c.length;++e){var g=c[e];b.getQueryObjectEXT(g,34919)?(k+=b.getQueryObjectEXT(g,34918),d.push(g)):c[a++]=g;v[e+1]=k;B[e+1]=a}c.length=a;for(e=a=0;e<r.length;++e){var k=r[e],y=k.startQueryIndex,g=k.endQueryIndex;
k.sum+=v[g]-v[y];y=B[y];g=B[g];g===y?(k.stats.gpuTime+=k.sum/1E6,n.push(k)):(k.startQueryIndex=y,k.endQueryIndex=g,r[a++]=k)}r.length=a}},getNumPendingQueries:function(){return c.length},clear:function(){d.push.apply(d,c);for(var a=0;a<d.length;a++)b.deleteQueryEXT(d[a]);c.length=0;d.length=0}}}},{}],21:[function(g,n,r){n.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(g,n,r){function k(a){return Array.prototype.slice.call(a)}
function a(a){return k(a).join("")}var e=g("./extend");n.exports=function(){function g(){var b=[],c=[];return e(function(){b.push.apply(b,k(arguments))},{def:function(){var a="v"+d++;c.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,k(arguments)),b.push(";"));return a},toString:function(){return a([0<c.length?"var "+c+";":"",a(b)])}})}function b(){function a(d,e){c(d,e,"=",b.def(d,e),";")}var b=g(),c=g(),d=b.toString,k=c.toString;return e(b,{entry:b,exit:c,save:a,set:function(c,d,e){a(c,
d);b(c,d,"=",e,";")},toString:function(){return d()+k()}})}var d=0,c=[],n=[],r=g(),v={};return{global:r,link:function(a){for(var b=0;b<n.length;++b)if(n[b]===a)return c[b];b="g"+d++;c.push(b);n.push(a);return b},block:g,proc:function(c,d){function k(){var a="a"+g.length;g.push(a);return a}var g=[];d=d||0;for(var n=0;n<d;++n)k();var n=b(),t=n.toString;return v[c]=e(n,{arg:k,toString:function(){return a(["function(",g.join(),"){",t(),"}"])}})},scope:b,cond:function(){var c=a(arguments),d=b(),g=b(),
n=d.toString,t=g.toString;return e(d,{then:function(){d.apply(d,k(arguments));return this},"else":function(){g.apply(g,k(arguments));return this},toString:function(){var b=t();b&&(b="else{"+b+"}");return a(["if(",c,"){",n(),"}",b])}})},compile:function(){var b=['"use strict";',r,"return {"];Object.keys(v).forEach(function(a){b.push('"',a,'":',v[a].toString(),",")});b.push("}");var d=a(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,c.concat(d)).apply(null,
n)}}}},{"./extend":23}],23:[function(g,n,r){n.exports=function(k,a){for(var e=Object.keys(a),g=0;g<e.length;++g)k[e[g]]=a[e[g]];return k}},{}],24:[function(g,n,r){var k=g("./is-typed-array");n.exports=function(a){return Array.isArray(a)||k(a)}},{"./is-typed-array":26}],25:[function(g,n,r){var k=g("./is-typed-array");n.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||
k(a.data))}},{"./is-typed-array":26}],26:[function(g,n,r){var k=g("../constants/arraytypes.json");n.exports=function(a){return Object.prototype.toString.call(a)in k}},{"../constants/arraytypes.json":4}],27:[function(g,n,r){n.exports=function(k,a){for(var e=Array(k),g=0;g<k;++g)e[g]=a(g);return e}},{}],28:[function(g,n,r){function k(a){var d,c;d=(65535<a)<<4;a>>>=d;c=(255<a)<<3;a>>>=c;d|=c;c=(15<a)<<2;a>>>=c;d|=c;c=(3<a)<<1;return d|c|a>>>c>>1}function a(a){a:{for(var d=16;268435456>=d;d*=16)if(a<=
d){a=d;break a}a=0}d=D[k(a)>>2];return 0<d.length?d.pop():new ArrayBuffer(a)}function e(a){D[k(a.byteLength)>>2].push(a)}var D=g("./loop")(8,function(){return[]});n.exports={alloc:a,free:e,allocType:function(b,d){var c=null;switch(b){case 5120:c=new Int8Array(a(d),0,d);break;case 5121:c=new Uint8Array(a(d),0,d);break;case 5122:c=new Int16Array(a(2*d),0,d);break;case 5123:c=new Uint16Array(a(2*d),0,d);break;case 5124:c=new Int32Array(a(4*d),0,d);break;case 5125:c=new Uint32Array(a(4*d),0,d);break;
case 5126:c=new Float32Array(a(4*d),0,d);break;default:return null}return c.length!==d?c.subarray(0,d):c},freeType:function(a){e(a.buffer)}}},{"./loop":27}],29:[function(g,n,r){n.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(k){return requestAnimationFrame(k)},cancel:function(k){return cancelAnimationFrame(k)}}:{next:function(k){setTimeout(k,30)},cancel:clearTimeout}},{}],30:[function(g,n,r){var k=g("./pool"),a=new Float32Array(1),e=new Uint32Array(a.buffer);
n.exports=function(g){for(var b=k.allocType(5123,g.length),d=0;d<g.length;++d)if(isNaN(g[d]))b[d]=65535;else if(Infinity===g[d])b[d]=31744;else if(-Infinity===g[d])b[d]=64512;else{a[0]=g[d];var c=e[0],n=c>>>31<<15,r=(c<<1>>>24)-127,c=c>>13&1023;b[d]=-24>r?n:-14>r?n+(c+1024>>-14-r):15<r?n+31744:n+(r+15<<10)+c}return b}},{"./pool":28}],31:[function(g,n,r){n.exports=function(g){return Object.keys(g).map(function(a){return g[a]})}},{}],32:[function(g,n,r){function k(a,c,e){function g(){var c=window.innerWidth,
n=window.innerHeight;a!==document.body&&(n=a.getBoundingClientRect(),c=n.right-n.left,n=n.top-n.bottom);k.width=e*c;k.height=e*n;b(k.style,{width:c+"px",height:n+"px"})}var k=document.createElement("canvas");b(k.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(k);a===document.body&&(k.style.position="absolute",b(a.style,{margin:0,padding:0}));window.addEventListener("resize",g,!1);g();return{canvas:k,onDestroy:function(){window.removeEventListener("resize",g);a.removeChild(k)}}}function a(a,
b){function e(g){try{return a.getContext(g,b)}catch(k){return null}}return e("webgl")||e("experimental-webgl")||e("webgl-experimental")}function e(a){return"string"===typeof a?a.split():a}function D(a){return"string"===typeof a?document.querySelector(a):a}var b=g("./util/extend");n.exports=function(b){var c=b||{},g,n,r,B;b={};var w=[],J=[],p="undefined"===typeof window?1:window.devicePixelRatio,q=!1,y=function(a){},l=function(){};"string"===typeof c?g=document.querySelector(c):"object"===typeof c&&
("string"===typeof c.nodeName&&"function"===typeof c.appendChild&&"function"===typeof c.getBoundingClientRect?g=c:"function"===typeof c.drawArrays||"function"===typeof c.drawElements?(B=c,r=B.canvas):("gl"in c?B=c.gl:"canvas"in c?r=D(c.canvas):"container"in c&&(n=D(c.container)),"attributes"in c&&(b=c.attributes),"extensions"in c&&(w=e(c.extensions)),"optionalExtensions"in c&&(J=e(c.optionalExtensions)),"onDone"in c&&(y=c.onDone),"profile"in c&&(q=!!c.profile),"pixelRatio"in c&&(p=+c.pixelRatio)));
g&&("canvas"===g.nodeName.toLowerCase()?r=g:n=g);if(!B){if(!r){g=k(n||document.body,y,p);if(!g)return null;r=g.canvas;l=g.onDestroy}B=a(r,b)}return B?{gl:B,canvas:r,container:n,extensions:w,optionalExtensions:J,pixelRatio:p,profile:q,onDone:y,onDestroy:l}:(l(),y("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],33:[function(g,n,r){n.exports=function(a,e){function g(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==l.alt,l.alt=!!a.altKey);
"shiftKey"in a&&(b=b||a.shiftKey!==l.shift,l.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==l.control,l.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==l.meta,l.meta=!!a.metaKey);return b}function b(a,b){var c=k.x(b),d=k.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==p||c!==q||d!==y||g(b))p=a|0,q=c||0,y=d||0,e&&e(p,q,y,l)}function d(a){b(0,a)}function c(){if(p||q||y||l.shift||l.alt||l.meta||l.control)p=q=y=0,l.shift=l.alt=l.control=l.meta=!1,e&&e(0,0,0,l)}function n(a){g(a)&&e&&e(p,q,y,l)}
function r(a){0===k.buttons(a)?b(0,a):b(p,a)}function v(a){b(p|k.buttons(a),a)}function B(a){b(p&~k.buttons(a),a)}function w(){f||(f=!0,a.addEventListener("mousemove",r),a.addEventListener("mousedown",v),a.addEventListener("mouseup",B),a.addEventListener("mouseleave",d),a.addEventListener("mouseenter",d),a.addEventListener("mouseout",d),a.addEventListener("mouseover",d),a.addEventListener("blur",c),a.addEventListener("keyup",n),a.addEventListener("keydown",n),a.addEventListener("keypress",n),a!==
window&&(window.addEventListener("blur",c),window.addEventListener("keyup",n),window.addEventListener("keydown",n),window.addEventListener("keypress",n)))}function J(){f&&(f=!1,a.removeEventListener("mousemove",r),a.removeEventListener("mousedown",v),a.removeEventListener("mouseup",B),a.removeEventListener("mouseleave",d),a.removeEventListener("mouseenter",d),a.removeEventListener("mouseout",d),a.removeEventListener("mouseover",d),a.removeEventListener("blur",c),a.removeEventListener("keyup",n),a.removeEventListener("keydown",
n),a.removeEventListener("keypress",n),a!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",n),window.removeEventListener("keydown",n),window.removeEventListener("keypress",n)))}e||(e=a,a=window);var p=0,q=0,y=0,l={shift:!1,alt:!1,control:!1,meta:!1},f=!1;w();var aa={element:a};Object.defineProperties(aa,{enabled:{get:function(){return f},set:function(a){a?w():J},enumerable:!0},buttons:{get:function(){return p},enumerable:!0},x:{get:function(){return q},enumerable:!0},
y:{get:function(){return y},enumerable:!0},mods:{get:function(){return l},enumerable:!0}});return aa};var k=g("mouse-event")},{"mouse-event":34}],34:[function(g,n,r){function k(a){return a.target||a.srcElement||window}r.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};r.element=k;r.x=function(a){if("object"===
typeof a){if("offsetX"in a)return a.offsetX;var e=k(a).getBoundingClientRect();return a.clientX-e.left}return 0};r.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var e=k(a).getBoundingClientRect();return a.clientY-e.top}return 0}},{}],35:[function(g,n,r){var k=g("./lib/util/extend"),a=g("./lib/dynamic"),e=g("./lib/util/raf"),D=g("./lib/util/clock"),b=g("./lib/strings"),d=g("./lib/webgl"),c=g("./lib/extension"),t=g("./lib/limits"),E=g("./lib/buffer"),v=g("./lib/elements"),
B=g("./lib/texture"),w=g("./lib/renderbuffer"),J=g("./lib/framebuffer"),p=g("./lib/attribute"),q=g("./lib/shader"),y=g("./lib/read"),l=g("./lib/core"),f=g("./lib/stats"),aa=g("./lib/timer");n.exports=function(g){function n(){H=e.next(n);L.tick+=1;L.time=(D()-sa)/1E3;ba();for(var a=0;a<fa.length;++a)(0,fa[a])(L,null,0);x.flush();S&&S.update()}function r(a){}function ra(a){}function U(b){function c(b){var d={},e={};Object.keys(b).forEach(function(c){var f=b[c];a.isDynamic(f)?e[c]=a.unbox(f,c):d[c]=
f});return{dynamic:e,"static":d}}function d(a){for(;q.length<a;)q.push(null);return q}var e=c(b.context||{}),f=c(b.uniforms||{}),g=c(b.attributes||{}),l=c(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=k({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(b));b={gpuTime:0,cpuTime:0,count:0};var e=T.compile(l,g,f,e,b),m=
e.draw,n=e.batch,p=e.scope,q=[];return k(function(a,b){var c;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)p.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)p.call(this,a[c],b,c);else return p.call(this,a,b,0);else if("number"===typeof a){if(0<a)return n.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return n.call(this,a,a.length)}else return m.call(this,a)},{stats:b})}function O(){var a=da.viewport,
b=da.scissor_box;a[0]=a[1]=b[0]=b[1]=0;L.viewportWidth=L.framebufferWidth=L.drawingBufferWidth=a[2]=b[2]=x.drawingBufferWidth;L.viewportHeight=L.framebufferHeight=L.drawingBufferHeight=a[3]=b[3]=x.drawingBufferHeight}function ba(){O();T.procs.poll()}function ha(){O();T.procs.refresh();S&&S.update()}var Q=d(g);if(!Q)return null;var x=Q.gl,P=c(x,Q);if(!P)return null;g=b();var R=f(),P=P.extensions,S=aa(x,P),sa=D(),W=x.drawingBufferWidth,N=x.drawingBufferHeight,L={tick:0,time:0,viewportWidth:W,viewportHeight:N,
framebufferWidth:W,framebufferHeight:N,drawingBufferWidth:W,drawingBufferHeight:N,pixelRatio:Q.pixelRatio},I=t(x,P),X=E(x,R),pa=v(x,P,X,R),W=p(x,P,I,X,g),ta=q(x,g,R),ja=B(x,P,I,ba,L,R),qa=w(x,P,I,R),la=J(x,P,I,ja,qa,R),N=y(x,ba,L),T=l(x,g,P,I,X,pa,ja,la,{},W,ta,{elements:null,primitive:4,count:-1,offset:0,instances:-1},L,S,Q),da=T.next,ea=x.canvas,fa=[],H=0;ea&&(ea.addEventListener("webglcontextlost",r,!1),ea.addEventListener("webglcontextrestored",ra,!1));ha();g=k(U,{clear:function(a){var b=0;T.procs.poll();
var c=a.color;c&&(x.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(x.clearDepth(+a.depth),b|=256);"stencil"in a&&(x.clearStencil(a.stencil|0),b|=1024);x.clear(b)},prop:a.define.bind(null,1),context:a.define.bind(null,2),"this":a.define.bind(null,3),draw:U({}),buffer:function(a){return X.create(a,34962)},elements:pa.create,texture:ja.create2D,cube:ja.createCube,renderbuffer:qa.create,framebuffer:la.create,framebufferCube:function(a){},attributes:x.getContextAttributes(),frame:function(a){fa.push(a);
!H&&0<fa.length&&n();return{cancel:function(){var b=fa.find(function(b){return b===a});0>b||(fa.splice(b,1),0>=fa.length&&H&&(e.cancel(n),H=0))}}},limits:I,hasExtension:function(a){return 0<=I.extensions.indexOf(a.toLowerCase())},read:N,destroy:function(){H&&(e.cancel(n),H=0);ea&&(ea.removeEventListener("webglcontextlost",r),ea.removeEventListener("webglcontextrestored",ra));ta.clear();la.clear();qa.clear();ja.clear();pa.clear();X.clear();S&&S.clear();Q.onDestroy()},_gl:x,_refresh:ha,poll:function(){T.procs.poll();
S&&S.update()},stats:R});Q.onDone(null,g);return g}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>