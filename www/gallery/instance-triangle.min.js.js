(function e$$0(m,w,h){function e(c,b){if(!w[c]){if(!m[c]){var d="function"==typeof require&&require;if(!b&&d)return d(c,!0);if(y)return y(c,!0);d=Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d;}d=w[c]={exports:{}};m[c][0].call(d.exports,function(b){var d=m[c][1][b];return e(d?d:b)},d,d.exports,e$$0,m,w,h)}return w[c].exports}for(var y="function"==typeof require&&require,q=0;q<h.length;q++)e(h[q]);return e})({1:[function(g,m,w){var h=g("../regl")({extensions:["angle_instanced_arrays"]}),
e=[];for(g=0;100>g;g++)e[g]=2*Math.random()*Math.PI;var y=h.buffer({length:4*e.length,type:"float",usage:"dynamic"}),q=h({frag:"\n  precision mediump float;\n\n  varying vec3 vColor;\n  void main() {\n    gl_FragColor = vec4(vColor, 1.0);\n  }",vert:"\n  precision mediump float;\n\n  attribute vec2 position;\n\n  // These three are instanced attributes.\n  attribute vec3 color;\n  attribute vec2 offset;\n  attribute float angle;\n\n  varying vec3 vColor;\n\n  void main() {\n    gl_Position = vec4(\n      cos(angle) * position.x + sin(angle) * position.y + offset.x,\n        -sin(angle) * position.x + cos(angle) * position.y + offset.y, 0, 1);\n    vColor = color;\n  }",
attributes:{position:[[0,-.05],[-.05,0],[.05,.05]],offset:{buffer:h.buffer(Array(100).fill().map(function(c,b){return[2*Math.floor(b/10)/10+-.9,b%10*2/10+-.9]})),divisor:1},color:{buffer:h.buffer(Array(100).fill().map(function(c,b){var e=Math.floor(b/10)/10,h=b%10/10;return[e,h,e*h+.2]})),divisor:1},angle:{buffer:y,divisor:1}},depth:{enable:!1},count:3,instances:100});h.frame(function(){h.clear({color:[0,0,0,1]});for(var c=0;100>c;c++)e[c]+=.01;y.subdata(e);q()})},{"../regl":33}],2:[function(g,m,
w){function h(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(e,y,q,c,b){e=q.maxAttributes;y=Array(e);for(q=0;q<e;++q)y[q]=new h;return{Record:h,scope:{},state:y}}},{}],3:[function(g,m,w){function h(c){return A[Object.prototype.toString.call(c)]|0}function e(c,b){for(var e=0;e<b.length;++e)c[e]=b[e]}function y(c,b,e,d,h,k,q){for(var y=0,a=0;a<e;++a)for(var g=0;g<d;++g)c[y++]=b[h*a+k*
g+q]}function q(c,b,e){for(var d=0,h=0;h<b.length;++h)for(var k=b[h],q=0;q<e;++q)c[d++]=k[q]}var c=g("./util/is-typed-array"),b=g("./util/is-ndarray"),d=g("./util/values"),x=g("./util/pool"),A=g("./constants/arraytypes.json"),F=g("./constants/dtypes.json"),B=g("./constants/usage.json"),k=[];k[5120]=1;k[5122]=2;k[5124]=4;k[5121]=1;k[5123]=2;k[5125]=4;k[5126]=4;m.exports=function(g,m,t){function l(c){this.id=u++;this.buffer=g.createBuffer();this.type=c;this.usage=35044;this.byteLength=0;this.dimension=
1;this.dtype=5121;t.profile&&(this.stats={size:0})}function r(c,b,a){c.byteLength=b.byteLength;g.bufferData(c.type,b,a)}function T(a,d,g,l,k){a.usage=g;if(Array.isArray(d))a.dtype=l||5126,0<d.length&&(Array.isArray(d[0])?(a.dimension=d[0].length,l=x.allocType(a.dtype,d.length*a.dimension),q(l,d,a.dimension),r(a,l,g),x.freeType(l)):"number"===typeof d[0]?(a.dimension=k,l=x.allocType(a.dtype,d.length),e(l,d),r(a,l,g),x.freeType(l)):c(d[0])&&(a.dimension=d[0].length,a.dtype=l||h(d[0])||5126,l=x.allocType(a.dtype,
d.length*a.dimension),q(l,d,a.dimension),r(a,l,g),x.freeType(l)));else if(c(d))a.dtype=l||h(d),a.dimension=k,r(a,d,g);else if(b(d)){var t=d.shape,M=d.stride;k=d.offset;var D=0,N=0,u=0,z=0;1===t.length?(D=t[0],N=1,u=M[0],z=0):2===t.length&&(D=t[0],N=t[1],u=M[0],z=M[1]);a.dtype=l||h(d.data)||5126;a.dimension=N;l=x.allocType(a.dtype,D*N);y(l,d.data,D,N,u,z,k);r(a,l,g);x.freeType(l)}}function L(c){m.bufferCount--;g.deleteBuffer(c.buffer);c.buffer=null;delete a[c.id]}var u=0,a={};l.prototype.bind=function(){g.bindBuffer(this.type,
this.buffer)};l.prototype.destroy=function(){L(this)};var V=[];t.profile&&(m.getTotalBufferSize=function(){var c=0;Object.keys(a).forEach(function(b){c+=a[b].stats.size});return c});return{create:function(d,r,u){function V(a){var d=35044,e=null,l=0,h=0,z=1;Array.isArray(a)||c(a)||b(a)?e=a:"number"===typeof a?l=a|0:a&&("data"in a&&(e=a.data),"usage"in a&&(d=B[a.usage]),"type"in a&&(h=F[a.type]),"dimension"in a&&(z=a.dimension|0),"length"in a&&(l=a.length|0));A.bind();e?T(A,e,d,h,z):(g.bufferData(A.type,
l,d),A.dtype=h||5121,A.usage=d,A.dimension=z,A.byteLength=l);t.profile&&(A.stats.size=A.byteLength*k[A.dtype]);return V}m.bufferCount++;var A=new l(r);a[A.id]=A;u||V(d);V._reglType="buffer";V._buffer=A;V.subdata=function(a,d){var l=(d||0)|0;A.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var k=x.allocType(A.dtype,a.length);e(k,a);g.bufferSubData(A.type,l,k);x.freeType(k)}else if(Array.isArray(a[0])||c(a[0])){var k=a[0].length,r=x.allocType(A.dtype,a.length*k);q(r,a,k);g.bufferSubData(A.type,
l,r);x.freeType(r)}}else if(c(a))g.bufferSubData(A.type,l,a);else if(b(a)){var z=a.shape,t=a.stride,u=r=k=0,B=0;1===z.length?(k=z[0],r=1,u=t[0],B=0):2===z.length&&(k=z[0],r=z[1],u=t[0],B=t[1]);z=Array.isArray(a.data)?A.dtype:h(a.data);z=x.allocType(z,k*r);y(z,a.data,k,r,u,B,a.offset);g.bufferSubData(A.type,l,z);x.freeType(z)}return V};t.profile&&(V.stats=A.stats);V.destroy=function(){L(A)};return V},createStream:function(a,c){var b=V.pop();b||(b=new l(a));b.bind();T(b,c,35040,0,1);return b},destroyStream:function(a){V.push(a)},
clear:function(){d(a).forEach(L);V.forEach(L)},getBuffer:function(a){return a&&a._buffer instanceof l?a._buffer:null},_initBuffer:T}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(g,m,w){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,
"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(g,m,w){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(g,m,w){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(g,m,w){m.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(g,m,w){function h(a){return Array.isArray(a)||
A(a)||F(a)}function e(a){return a.sort(function(a,c){return"viewport"===a?-1:"viewport"===c?1:a<c?-1:1})}function y(a,c,b,d){this.thisDep=a;this.contextDep=c;this.propDep=b;this.append=d}function q(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function c(a){return new y(!1,!1,!1,a)}function b(a,c){var b=a.type;return 0===b?(b=a.data.length,new y(!0,1<=b,2<=b,c)):4===b?(b=a.data,new y(b.thisDep,b.contextDep,b.propDep,c)):new y(3===b,2===b,1===b,c)}var d=g("./util/codegen"),x=g("./util/loop"),
A=g("./util/is-typed-array"),F=g("./util/is-ndarray"),B=g("./util/is-array-like"),k=g("./dynamic"),M=g("./constants/primitives.json"),H=g("./constants/dtypes.json"),t=["x","y","z","w"],l="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),r={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,
"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},T={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},L={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},u={cw:2304,ccw:2305},a=new y(!1,!1,!1,function(){});m.exports=function(g,
m,A,F,w,U,za,P,D,N,fa,z,W,Z,ga){function ha(p){return p.replace(".","_")}function Q(p,a,f){var c=ha(p);Fa.push(p);Aa[c]=ma[c]=!!f;na[c]=a}function J(a,f,c){var b=ha(a);Fa.push(a);Array.isArray(c)?(ma[b]=c.slice(),Aa[b]=c.slice()):ma[b]=Aa[b]=c;oa[b]=f}function aa(){var a=d(),C=a.link,c=a.global;a.id=Ra++;a.batchId="0";var b=C(Pa),G=a.shared={props:"a0"};Object.keys(Pa).forEach(function(n){G[n]=c.def(b,".",n)});var K=a.next={},e=a.current={};Object.keys(oa).forEach(function(n){Array.isArray(ma[n])&&
(K[n]=c.def(G.next,".",n),e[n]=c.def(G.current,".",n))});var n=a.constants={};Object.keys(Ga).forEach(function(a){n[a]=c.def(JSON.stringify(Ga[a]))});a.invoke=function(n,f){switch(f.type){case 0:var c=["this",G.context,G.props,a.batchId];return n.def(C(f.data),".call(",c.slice(0,Math.max(f.data.length+1,4)),")");case 1:return n.def(G.props,f.data);case 2:return n.def(G.context,f.data);case 3:return n.def("this",f.data);case 4:return f.data.append(a,n),f.data.ref}};a.attribCache={};var La={};a.scopeAttrib=
function(n){n=m.id(n);if(n in La)return La[n];var a=N.scope[n];a||(a=N.scope[n]=new f);return La[n]=C(a)};return a}function pa(a){var f=a["static"];a=a.dynamic;var O;if("profile"in f){var d=!!f.profile;O=c(function(a,f){return d});O.enable=d}else if("profile"in a){var G=a.profile;O=b(G,function(a,f){return a.invoke(f,G)})}return O}function va(a){var f=a["static"];a=a.dynamic;if("framebuffer"in f){var d=f.framebuffer;return d?(d=P.getFramebuffer(d),c(function(a,f){var p=a.link(d),n=a.shared;f.set(n.framebuffer,
".next",p);n=n.context;f.set(n,".framebufferWidth",p+".width");f.set(n,".framebufferHeight",p+".height");return p})):c(function(a,f){var p=a.shared;f.set(p.framebuffer,".next","null");p=p.context;f.set(p,".framebufferWidth",p+".drawingBufferWidth");f.set(p,".framebufferHeight",p+".drawingBufferHeight");return"null"})}if("framebuffer"in a){var Oa=a.framebuffer;return b(Oa,function(a,f){var p=a.invoke(f,Oa),n=a.shared,C=n.framebuffer,p=f.def(C,".getFramebuffer(",p,")");f.set(C,".next",p);n=n.context;
f.set(n,".framebufferWidth",p+"?"+p+".width:"+n+".drawingBufferWidth");f.set(n,".framebufferHeight",p+"?"+p+".height:"+n+".drawingBufferHeight");return p})}return null}function ia(a,f){function c(n){if(n in d){var a=d[n];n=!0;var p=a.x|0,Qa=a.y|0,O,K;"width"in a?O=a.width|0:n=!1;"height"in a?K=a.height|0:n=!1;return new y(!n&&f&&f.thisDep,!n&&f&&f.contextDep,!n&&f&&f.propDep,function(n,f){var c=n.shared.context,C=O;"width"in a||(C=f.def(c,".","framebufferWidth","-",p));var b=K;"height"in a||(b=f.def(c,
".","framebufferHeight","-",Qa));return[p,Qa,C,b]})}if(n in G){var e=G[n];n=b(e,function(n,a){var f=n.invoke(a,e),p=n.shared.context,c=a.def(f,".x|0"),C=a.def(f,".y|0"),b=a.def('"width" in ',f,"?",f,".width|0:","(",p,".","framebufferWidth","-",c,")"),f=a.def('"height" in ',f,"?",f,".height|0:","(",p,".","framebufferHeight","-",C,")");return[c,C,b,f]});f&&(n.thisDep=n.thisDep||f.thisDep,n.contextDep=n.contextDep||f.contextDep,n.propDep=n.propDep||f.propDep);return n}return f?new y(f.thisDep,f.contextDep,
f.propDep,function(n,a){var f=n.shared.context;return[0,0,a.def(f,".","framebufferWidth"),a.def(f,".","framebufferHeight")]}):null}var d=a["static"],G=a.dynamic,K=c("viewport");if(K)var e=K,K=new y(K.thisDep,K.contextDep,K.propDep,function(n,a){var f=e.append(n,a),p=n.shared.context;a.set(p,".viewportWidth",f[2]);a.set(p,".viewportHeight",f[3]);return f});return{viewport:K,scissor_box:c("scissor.box")}}function qa(a){function f(a){if(a in d){var p=m.id(d[a]);a=c(function(){return p});a.id=p;return a}if(a in
e){var C=e[a];return b(C,function(a,n){var f=a.invoke(n,C);return n.def(a.shared.strings,".id(",f,")")})}return null}var d=a["static"],e=a.dynamic,G=f("frag"),K=f("vert"),l=null;q(G)&&q(K)?(l=fa.program(K.id,G.id),a=c(function(a,f){return a.link(l)})):a=new y(G&&G.thisDep||K&&K.thisDep,G&&G.contextDep||K&&K.contextDep,G&&G.propDep||K&&K.propDep,function(a,f){var p=a.shared.shader,c;c=G?G.append(a,f):f.def(p,".","frag");var C;C=K?K.append(a,f):f.def(p,".","vert");return f.def(p+".program("+C+","+c+
")")});return{frag:G,vert:K,progVar:a,program:l}}function ja(a){function f(a,n){if(a in d){var p=d[a]|0;return c(function(a,f){n&&(a.OFFSET=p);return p})}if(a in e){var C=e[a];return b(C,function(a,f){var p=a.invoke(f,C);n&&(a.OFFSET=p);return p})}return n&&G?c(function(a,f){a.OFFSET="0";return 0}):null}var d=a["static"],e=a.dynamic,G=function(){if("elements"in d){var a=d.elements;h(a)?a=U.getElements(U.create(a)):a&&(a=U.getElements(a));var f=c(function(f,n){if(a){var p=f.link(a);return f.ELEMENTS=
p}return f.ELEMENTS=null});f.value=a;return f}if("elements"in e){var p=e.elements;return b(p,function(a,f){var n=a.shared,c=n.isBufferArgs,n=n.elements,C=a.invoke(f,p),b=f.def("null"),c=f.def(c,"(",C,")"),C=a.cond(c).then(b,"=",n,".createStream(",C,");")["else"](b,"=",n,".getElements(",C,");");f.entry(C);f.exit(a.cond(c).then(n,".destroyStream(",b,");"));return a.ELEMENTS=b})}return null}(),K=f("offset",!0);return{elements:G,primitive:function(){if("primitive"in d){var a=d.primitive;return c(function(f,
n){return M[a]})}if("primitive"in e){var f=e.primitive;return b(f,function(a,p){var C=a.constants.primTypes,c=a.invoke(p,f);return p.def(C,"[",c,"]")})}return G?q(G)?G.value?c(function(a,f){return f.def(a.ELEMENTS,".primType")}):c(function(){return 4}):new y(G.thisDep,G.contextDep,G.propDep,function(a,f){var n=a.ELEMENTS;return f.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in d){var a=d.count|0;return c(function(){return a})}if("count"in e){var f=e.count;return b(f,function(a,
p){return a.invoke(p,f)})}return G?q(G)?G?K?new y(K.thisDep,K.contextDep,K.propDep,function(a,f){return f.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):c(function(a,f){return f.def(a.ELEMENTS,".vertCount")}):c(function(){return-1}):new y(G.thisDep||K.thisDep,G.contextDep||K.contextDep,G.propDep||K.propDep,function(a,f){var n=a.ELEMENTS;return a.OFFSET?f.def(n,"?",n,".vertCount-",a.OFFSET,":-1"):f.def(n,"?",n,".vertCount:-1")}):null}(),instances:f("instances",!1),offset:K}}function ba(a){var f=a["static"],
d=a.dynamic,e={};Fa.forEach(function(a){function p(n,K){if(a in f){var Sa=n(f[a]);e[l]=c(function(){return Sa})}else if(a in d){var E=d[a];e[l]=b(E,function(a,f){return K(a,f,a.invoke(f,E))})}}var l=ha(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return p(function(a){return a},function(a,f,p){return p});case "depth.func":return p(function(a){return T[a]},
function(a,f,p){return f.def(a.constants.compareFuncs,"[",p,"]")});case "depth.range":return p(function(a){return a},function(a,f,p){a=f.def("+",p,"[0]");f=f.def("+",p,"[1]");return[a,f]});case "blend.func":return p(function(a){return[r["srcRGB"in a?a.srcRGB:a.src],r["dstRGB"in a?a.dstRGB:a.dst],r["srcAlpha"in a?a.srcAlpha:a.src],r["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,f,p){function c(a,n){var b=f.def('"',a,n,'" in ',p,"?",p,".",a,n,":",p,".",a);return f.def(C,"[",b,"]")}var C=a.constants.blendFuncs;
a=c("src","RGB");var b=c("src","Alpha"),d=c("dst","RGB"),e=c("dst","Alpha");return[a,d,b,e]});case "blend.equation":return p(function(a){if("string"===typeof a)return[v[a],v[a]];if("object"===typeof a)return[v[a.rgb],v[a.alpha]]},function(a,f,p){var c=a.constants.blendEquations,C=f.def(),b=f.def();a=a.cond("typeof ",p,'==="string"');a.then(C,"=",b,"=",c,"[",p,"];");a["else"](C,"=",c,"[",p,".rgb];",b,"=",c,"[",p,".alpha];");f(a);return[C,b]});case "blend.color":return p(function(a){return x(4,function(f){return+a[f]})},
function(a,f,p){return x(4,function(a){return f.def("+",p,"[",a,"]")})});case "stencil.mask":return p(function(a){return a|0},function(a,f,p){return f.def(p,"|0")});case "stencil.func":return p(function(a){return[T[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,f,p){a=f.def('"cmp" in ',p,"?",a.constants.compareFuncs,"[",p,".cmp]",":",7680);var c=f.def(p,".ref|0");f=f.def('"mask" in ',p,"?",p,".mask|0:-1");return[a,c,f]});case "stencil.opFront":case "stencil.opBack":return p(function(f){return["stencil.opBack"===
a?1029:1028,L[f.fail||"keep"],L[f.zfail||"keep"],L[f.pass||"keep"]]},function(f,p,c){function C(a){return p.def('"',a,'" in ',c,"?",b,"[",c,".",a,"]:",7680)}var b=f.constants.stencilOps;return["stencil.opBack"===a?1029:1028,C("fail"),C("zfail"),C("pass")]});case "polygonOffset.offset":return p(function(a){return[a.factor|0,a.units|0]},function(a,f,p){a=f.def(p,".factor|0");f=f.def(p,".units|0");return[a,f]});case "cull.face":return p(function(a){var f=0;"front"===a?f=1028:"back"===a&&(f=1029);return f},
function(a,f,p){return f.def(p,'==="front"?',1028,":",1029)});case "lineWidth":return p(function(a){return a},function(a,f,p){return p});case "frontFace":return p(function(a){return u[a]},function(a,f,p){return f.def(p+'==="cw"?2304:2305')});case "colorMask":return p(function(a){return a.map(function(a){return!!a})},function(a,f,p){return x(4,function(a){return"!!"+p+"["+a+"]"})});case "sample.coverage":return p(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,f,p){a=f.def('"value" in ',
p,"?+",p,".value:1");f=f.def("!!",p,".invert");return[a,f]})}});return e}function ra(a){var f=a["static"],d=a.dynamic,e={};Object.keys(f).forEach(function(a){var p=f[a],b;"number"===typeof p||"boolean"===typeof p?b=c(function(){return p}):"function"!==typeof p||"texture2d"!==p._reglType&&"textureCube"!==p._reglType?B(p)&&(b=c(function(a){return a.global.def("[",x(p.length,function(a){return p[a]}),"]")})):b=c(function(a){return a.link(p)});b.value=p;e[a]=b});Object.keys(d).forEach(function(a){var f=
d[a];e[a]=b(f,function(a,p){return a.invoke(p,f)})});return e}function X(a){var C=a["static"],d=a.dynamic,e={};Object.keys(C).forEach(function(a){var p=C[a],b=m.id(a),n=new f;if(h(p))n.state=1,n.buffer=w.getBuffer(w.create(p,34962,!1)),n.type=n.buffer.dtype;else{var d=w.getBuffer(p);if(d)n.state=1,n.buffer=d,n.type=d.dtype;else if(p.constant){var l=p.constant;n.buffer="null";n.state=2;"number"===typeof l?n.x=l:t.forEach(function(a,f){f<l.length&&(n[a]=l[f])})}else{var d=w.getBuffer(p.buffer),O=p.offset|
0,E=p.stride|0,v=p.size|0,g=!!p.normalized,k=0;"type"in p&&(k=H[p.type]);p=p.divisor|0;n.buffer=d;n.state=1;n.size=v;n.normalized=g;n.type=k||d.dtype;n.offset=O;n.stride=E;n.divisor=p}}e[a]=c(function(a,f){var p=a.attribCache;if(b in p)return p[b];var c={isStream:!1};Object.keys(n).forEach(function(a){c[a]=n[a]});n.buffer&&(c.buffer=a.link(n.buffer));return p[b]=c})});Object.keys(d).forEach(function(a){var p=d[a];e[a]=b(p,function(a,c){function C(a){c(O[a],"=",b,".",a,"|0;")}var b=a.invoke(c,p),d=
a.shared,e=d.isBufferArgs,l=d.buffer,O={isStream:c.def(!1)},E=new f;E.state=1;Object.keys(E).forEach(function(a){O[a]=c.def(""+E[a])});var G=O.buffer,v=O.type;c("if(",e,"(",b,")){",O.isStream,"=true;",G,"=",l,".createStream(",34962,",",b,");",v,"=",G,".dtype;","}else{",G,"=",l,".getBuffer(",b,");","if(",G,"){",v,"=",G,".dtype;",'}else if("constant" in ',b,"){",O.state,"=",2,";","if(typeof "+b+'.constant === "number"){',O[t[0]],"=",b,".constant;",t.slice(1).map(function(a){return O[a]}).join("="),
"=0;","}else{",t.map(function(a,f){return O[a]+"="+b+".constant.length>="+f+"?"+b+".constant["+f+"]:0;"}).join(""),"}}else{",G,"=",l,".getBuffer(",b,".buffer);",v,'="type" in ',b,"?",d.glTypes,"[",b,".type]:",G,".dtype;",O.normalized,"=!!",b,".normalized;");C("size");C("offset");C("stride");C("divisor");c("}}");c.exit("if(",O.isStream,"){",l,".destroyStream(",G,");","}");return O})});return e}function I(a){var f=a["static"],d=a.dynamic,e={};Object.keys(f).forEach(function(a){var p=f[a];e[a]=c(function(a,
f){return"number"===typeof p||"boolean"===typeof p?""+p:a.link(p)})});Object.keys(d).forEach(function(a){var f=d[a];e[a]=b(f,function(a,p){return a.invoke(p,f)})});return e}function Y(a,f,c,b){var d;d=va(a);var e=ia(a,d),l=ja(a),n=ba(a),E=qa(a),v=e.viewport;v&&(n.viewport=v);v=ha("scissor.box");(e=e[v])&&(n[v]=e);e=0<Object.keys(n).length;d={framebuffer:d,draw:l,shader:E,state:n,dirty:e};d.profile=pa(a);d.uniforms=ra(c);d.attributes=X(f);d.context=I(b);return d}function S(a,f,c){var b=a.shared.context,
d=a.scope();Object.keys(c).forEach(function(e){f.save(b,"."+e);d(b,".",e,"=",c[e].append(a,f),";")});f(d)}function R(a,f,c){var b=a.shared,d=b.gl,e=b.framebuffer,l;Ha&&(l=f.def(b.extensions,".webgl_draw_buffers"));var n=a.constants,b=n.drawBuffer,n=n.backBuffer;a=c?c.append(a,f):f.def(e,".next");f("if(",e,".dirty||",a,"!==",e,".cur){","if(",a,"){",d,".bindFramebuffer(",36160,",",a,".framebuffer);");Ha&&f(l,".drawBuffersWEBGL(",b,"[",a,".colorAttachments.length]);");f("}else{",d,".bindFramebuffer(",
36160,",null);");Ha&&f(l,".drawBuffersWEBGL(",n,");");f("}",e,".cur=",a,";",e,".dirty=false;","}")}function Ba(a,f,c){var b=a.shared,d=b.gl,e=a.current,l=a.next,n=b.current,E=b.next,v=a.cond(n,".dirty");Fa.forEach(function(f){f=ha(f);if(!(f in c.state)){var b,C;if(f in l){b=l[f];C=e[f];var h=x(ma[f].length,function(a){return v.def(b,"[",a,"]")});v(a.cond(h.map(function(a,f){return a+"!=="+C+"["+f+"]"}).join("||")).then(d,".",oa[f],"(",h,");",h.map(function(a,f){return C+"["+f+"]="+a}).join(";"),";"))}else b=
v.def(E,".",f),h=a.cond(b,"!==",n,".",f),v(h),f in na?h(a.cond(b).then(d,".enable(",na[f],");")["else"](d,".disable(",na[f],");"),n,".",f,"=",b,";"):h(d,".",oa[f],"(",b,");",n,".",f,"=",b,";")}});0===Object.keys(c.state).length&&v(n,".dirty=false;");f(v)}function Ca(a,f,b,c){var d=a.shared,l=a.current,v=d.current,n=d.gl;e(Object.keys(b)).forEach(function(d){var e=b[d];if(!c||c(e)){var E=e.append(a,f);if(na[d]){var h=na[d];q(e)?E?f(n,".enable(",h,");"):f(n,".disable(",h,");"):f(a.cond(E).then(n,".enable(",
h,");")["else"](n,".disable(",h,");"));f(v,".",d,"=",E,";")}else if(B(E)){var k=l[d];f(n,".",oa[d],"(",E,");",E.map(function(a,f){return k+"["+f+"]="+a}).join(";"),";")}else f(n,".",oa[d],"(",E,");",v,".",d,"=",E,";")}})}function wa(a,f){E&&!a.instancing&&(a.instancing=f.def(a.shared.extensions,".angle_instanced_arrays"))}function ca(a,f,b,c,d){function e(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function l(a){z=f.def();a(z,"=",e(),";");"string"===typeof d?a(h,".count+=",
d,";"):a(h,".count++;");Z&&(c?(r=f.def(),a(r,"=",g,".getNumPendingQueries();")):a(g,".beginQuery(",h,");"))}function n(a){a(h,".cpuTime+=",e(),"-",z,";");Z&&(c?a(g,".pushScopeStats(",r,",",g,".getNumPendingQueries(),",h,");"):a(g,".endQuery();"))}function E(a){var p=f.def(k,".profile");f(k,".profile=",a,";");f.exit(k,".profile=",p,";")}var v=a.shared,h=a.stats,k=v.current,g=v.timer;b=b.profile;var z,r;if(b){if(q(b)){b.enable?(l(f),n(f.exit),E("true")):E("false");return}b=b.append(a,f);E(b)}else b=
f.def(k,".profile");v=a.block();l(v);f("if(",b,"){",v,"}");a=a.block();n(a);f.exit("if(",b,"){",a,"}")}function da(p,b,c,d,e){function l(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function v(a,f,c){function d(){b("if(!",k,".buffer){",l,".enableVertexAttribArray(",h,");}");var a=c.type,e;e=c.size?b.def(c.size,"||",f):f;b("if(",k,".type!==",a,"||",k,".size!==",e,"||",z.map(function(a){return k+
"."+a+"!=="+c[a]}).join("||"),"){",l,".bindBuffer(",34962,",",g,".buffer);",l,".vertexAttribPointer(",[h,e,a,c.normalized,c.stride,c.offset],");",k,".type=",a,";",k,".size=",e,";",z.map(function(a){return k+"."+a+"="+c[a]+";"}).join(""),"}");E&&(a=c.divisor,b("if(",k,".divisor!==",a,"){",p.instancing,".vertexAttribDivisorANGLE(",[h,a],");",k,".divisor=",a,";}"))}function e(){b("if(",k,".buffer){",l,".disableVertexAttribArray(",h,");","}if(",t.map(function(a,f){return k+"."+a+"!=="+O[f]}).join("||"),
"){",l,".vertexAttrib4f(",h,",",O,");",t.map(function(a,f){return k+"."+a+"="+O[f]+";"}).join(""),"}")}var l=n.gl,h=b.def(a,".location"),k=b.def(n.attributes,"[",h,"]");a=c.state;var g=c.buffer,O=[c.x,c.y,c.z,c.w],z=["buffer","normalized","offset","stride"];1===a?d():2===a?e():(b("if(",a,"===",1,"){"),d(),b("}else{"),e(),b("}"))}var n=p.shared;d.forEach(function(d){var n=d.name,E=c.attributes[n],h;if(E){if(!e(E))return;h=E.append(p,b)}else{if(!e(a))return;var k=p.scopeAttrib(n);h={};Object.keys(new f).forEach(function(a){h[a]=
b.def(k,".",a)})}v(p.link(d),l(d.info.type),h)})}function ea(f,b,c,d,e){for(var l=f.shared,E=l.gl,n,v=0;v<d.length;++v){var h=d[v],k=h.name,g=h.info.type,z=c.uniforms[k],h=f.link(h)+".location",r;if(z){if(!e(z))continue;if(q(z)){k=z.value;if(35678===g||35680===g)g=f.link(k._texture),b(E,".uniform1i(",h,",",g+".bind());"),b.exit(g,".unbind();");else if(35674===g||35675===g||35676===g)k=f.global.def("new Float32Array(["+Array.prototype.slice.call(k)+"])"),z=2,35675===g?z=3:35676===g&&(z=4),b(E,".uniformMatrix",
z,"fv(",h,",false,",k,");");else{switch(g){case 5126:n="1f";break;case 35664:n="2f";break;case 35665:n="3f";break;case 35666:n="4f";break;case 35670:n="1i";break;case 5124:n="1i";break;case 35671:n="2i";break;case 35667:n="2i";break;case 35672:n="3i";break;case 35668:n="3i";break;case 35673:n="4i";break;case 35669:n="4i"}b(E,".uniform",n,"(",h,",",B(k)?Array.prototype.slice.call(k):k,");")}continue}else r=z.append(f,b)}else{if(!e(a))continue;r=b.def(l.uniforms,"[",m.id(k),"]")}k=1;switch(g){case 35678:case 35680:g=
b.def(r,"._texture");b(E,".uniform1i(",h,",",g,".bind());");b.exit(g,".unbind();");continue;case 5124:case 35670:n="1i";break;case 35667:case 35671:n="2i";k=2;break;case 35668:case 35672:n="3i";k=3;break;case 35669:case 35673:n="4i";k=4;break;case 5126:n="1f";break;case 35664:n="2f";k=2;break;case 35665:n="3f";k=3;break;case 35666:n="4f";k=4;break;case 35674:n="Matrix2fv";break;case 35675:n="Matrix3fv";break;case 35676:n="Matrix4fv"}b(E,".uniform",n,"(",h,",");if("M"===n.charAt(0)){var h=Math.pow(g-
35674+2,2),D=f.global.def("new Float32Array(",h,")");b("false,(Array.isArray(",r,")||",r," instanceof Float32Array)?",r,":(",x(h,function(a){return D+"["+a+"]="+r+"["+a+"]"}),",",D,")")}else 1<k?b(x(k,function(a){return r+"["+a+"]"})):b(r);b(");")}}function Da(a,f,b,c){function d(e){var n=v[e];return n?n.contextDep&&c.contextDynamic||n.propDep?n.append(a,b):n.append(a,f):f.def(k,".",e)}function e(){function a(){b(y,".drawElementsInstancedANGLE(",[z,D,x,r+"<<(("+x+"-5121)>>1)",t],");")}function f(){b(y,
".drawArraysInstancedANGLE(",[z,r,D,t],");")}g?u?a():(b("if(",g,"){"),a(),b("}else{"),f(),b("}")):f()}function l(){function a(){b(h+".drawElements("+[z,D,x,r+"<<(("+x+"-5121)>>1)"]+");")}function f(){b(h+".drawArrays("+[z,r,D]+");")}g?u?a():(b("if(",g,"){"),a(),b("}else{"),f(),b("}")):f()}var n=a.shared,h=n.gl,k=n.draw,v=c.draw,g=function(){var d=v.elements,e=f;if(d){if(d.contextDep&&c.contextDynamic||d.propDep)e=b;d=d.append(a,e)}else d=e.def(k,".","elements");d&&e("if("+d+")"+h+".bindBuffer(34963,"+
d+".buffer.buffer);");return d}(),z=d("primitive"),r=d("offset"),D=function(){var d=v.count,e=f;if(d){if(d.contextDep&&c.contextDynamic||d.propDep)e=b;d=d.append(a,e)}else d=e.def(k,".","count");return d}();if("number"===typeof D){if(0===D)return}else b("if(",D,"){"),b.exit("}");var t,y;E&&(t=d("instances"),y=a.instancing);var x=g+".type",u=v.elements&&q(v.elements);E&&("number"!==typeof t||0<=t)?"string"===typeof t?(b("if(",t,">0){"),e(),b("}else if(",t,"<0){"),l(),b("}")):e():l()}function ya(a,
f,b,c,d){f=aa();d=f.proc("body",d);E&&(f.instancing=d.def(f.shared.extensions,".angle_instanced_arrays"));a(f,d,b,c);return f.compile().body}function Ia(a,f,b,c){wa(a,f);da(a,f,b,c.attributes,function(){return!0});ea(a,f,b,c.uniforms,function(){return!0});Da(a,f,f,b)}function Ja(a,f){var b=a.proc("draw",1);wa(a,b);S(a,b,f.context);R(a,b,f.framebuffer);Ba(a,b,f);Ca(a,b,f.state);ca(a,b,f,!1,!0);var c=f.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",c,".program);");if(f.shader.program)Ia(a,
b,f,f.shader.program);else{var d=a.global.def("{}"),e=b.def(c,".id"),l=b.def(d,"[",e,"]");b(a.cond(l).then(l,".call(this,a0);")["else"](l,"=",d,"[",e,"]=",a.link(function(b){return ya(Ia,a,f,b,1)}),"(",c,");",l,".call(this,a0);"))}0<Object.keys(f.state).length&&b(a.shared.current,".dirty=true;")}function Ka(a,f,b,c){function d(){return!0}a.batchId="a1";wa(a,f);da(a,f,b,c.attributes,d);ea(a,f,b,c.uniforms,d);Da(a,f,f,b)}function xa(a,f,b,c){function d(a){return a.contextDep&&l||a.propDep}function e(a){return!d(a)}
wa(a,f);var l=b.contextDep,n=f.def(),h=f.def();a.shared.props=h;a.batchId=n;var k=a.scope(),v=a.scope();f(k.entry,"for(",n,"=0;",n,"<","a1",";++",n,"){",h,"=","a0","[",n,"];",v,"}",k.exit);b.needsContext&&S(a,v,b.context);b.needsFramebuffer&&R(a,v,b.framebuffer);Ca(a,v,b.state,d);b.profile&&d(b.profile)&&ca(a,v,b,!1,!0);c?(da(a,k,b,c.attributes,e),da(a,v,b,c.attributes,d),ea(a,k,b,c.uniforms,e),ea(a,v,b,c.uniforms,d),Da(a,k,v,b)):(f=a.global.def("{}"),c=b.shader.progVar.append(a,v),h=v.def(c,".id"),
k=v.def(f,"[",h,"]"),v(a.shared.gl,".useProgram(",c,".program);","if(!",k,"){",k,"=",f,"[",h,"]=",a.link(function(f){return ya(Ka,a,b,f,2)}),"(",c,");}",k,".call(this,a0[",n,"],",n,");"))}function Ma(a,f){function b(a){return a.contextDep&&d||a.propDep}var c=a.proc("batch",2);a.batchId="0";wa(a,c);var d=!1,e=!0;Object.keys(f.context).forEach(function(a){d=d||f.context[a].propDep});d||(S(a,c,f.context),e=!1);var l=f.framebuffer,n=!1;l?(l.propDep?d=n=!0:l.contextDep&&d&&(n=!0),n||R(a,c,l)):R(a,c,null);
f.state.viewport&&f.state.viewport.propDep&&(d=!0);Ba(a,c,f);Ca(a,c,f.state,function(a){return!b(a)});f.profile&&b(f.profile)||ca(a,c,f,!1,"a1");f.contextDep=d;f.needsContext=e;f.needsFramebuffer=n;e=f.shader.progVar;if(e.contextDep&&d||e.propDep)xa(a,c,f,null);else if(e=e.append(a,c),c(a.shared.gl,".useProgram(",e,".program);"),f.shader.program)xa(a,c,f,f.shader.program);else{var l=a.global.def("{}"),n=c.def(e,".id"),v=c.def(l,"[",n,"]");c(a.cond(v).then(v,".call(this,a0,a1);")["else"](v,"=",l,"[",
n,"]=",a.link(function(b){return ya(xa,a,f,b,2)}),"(",e,");",v,".call(this,a0,a1);"))}0<Object.keys(f.state).length&&c(a.shared.current,".dirty=true;")}function sa(a,b){function c(f){var e=b.shader[f];e&&d.set(l.shader,"."+f,e.append(a,d))}var d=a.proc("scope",3);a.batchId="a2";var l=a.shared,v=l.current;S(a,d,b.context);b.framebuffer&&b.framebuffer.append(a,d);e(Object.keys(b.state)).forEach(function(f){var c=b.state[f].append(a,d);B(c)?c.forEach(function(b,c){d.set(a.next[f],"["+c+"]",b)}):d.set(l.next,
"."+f,c)});ca(a,d,b,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(f){var c=b.draw[f];c&&d.set(l.draw,"."+f,""+c.append(a,d))});Object.keys(b.uniforms).forEach(function(f){d.set(l.uniforms,"["+m.id(f)+"]",b.uniforms[f].append(a,d))});Object.keys(b.attributes).forEach(function(c){var e=b.attributes[c].append(a,d),l=a.scopeAttrib(c);Object.keys(new f).forEach(function(a){d.set(l,"."+a,e[a])})});c("vert");c("frag");0<Object.keys(b.state).length&&(d(v,".dirty=true;"),d.exit(v,
".dirty=true;"));d("a1(",a.shared.context,",a0,",a.batchId,");")}function Ea(a){if("object"===typeof a){for(var f=Object.keys(a),b=0;b<f.length;++b)if(k.isDynamic(a[f[b]]))return!0;return!1}}function ta(a,f,c){function d(a,f){v.forEach(function(b){var c=e[b];k.isDynamic(c)&&(c=a.invoke(f,c),f(g,".",b,"=",c,";"))})}var e=f["static"][c];if(e&&Ea(e)){var l=a.global,v=Object.keys(e),n=!1,h=!1,E=!1,g=a.global.def("{}");v.forEach(function(f){var c=e[f];if(k.isDynamic(c))f=b(c,null),n=n||f.thisDep,E=E||
f.propDep,h=h||f.contextDep;else{l(g,".",f,"=");switch(typeof c){case "number":l(c);break;case "string":l('"',c,'"');break;case "object":Array.isArray(c)&&l("[",c.join(),"]");break;default:l(a.link(c))}l(";")}});f.dynamic[c]=new k.DynamicVariable(4,{thisDep:n,contextDep:h,propDep:E,ref:g,append:d});delete f["static"][c]}}var f=N.Record,v={add:32774,subtract:32778,"reverse subtract":32779};A.ext_blend_minmax&&(v.min=32775,v.max=32776);var E=A.angle_instanced_arrays,Ha=A.webgl_draw_buffers,ma={dirty:!0,
profile:ga.profile},Aa={},Fa=[],na={},oa={};Q("dither",3024);Q("blend.enable",3042);J("blend.color","blendColor",[0,0,0,0]);J("blend.equation","blendEquationSeparate",[32774,32774]);J("blend.func","blendFuncSeparate",[1,0,1,0]);Q("depth.enable",2929,!0);J("depth.func","depthFunc",513);J("depth.range","depthRange",[0,1]);J("depth.mask","depthMask",!0);J("colorMask","colorMask",[!0,!0,!0,!0]);Q("cull.enable",2884);J("cull.face","cullFace",1029);J("frontFace","frontFace",2305);J("lineWidth","lineWidth",
1);Q("polygonOffset.enable",32823);J("polygonOffset.offset","polygonOffset",[0,0]);Q("sample.alpha",32926);Q("sample.enable",32928);J("sample.coverage","sampleCoverage",[1,!1]);Q("stencil.enable",2960);J("stencil.mask","stencilMask",-1);J("stencil.func","stencilFunc",[519,0,-1]);J("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);J("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);Q("scissor.enable",3089);J("scissor.box","scissor",[0,0,g.drawingBufferWidth,g.drawingBufferHeight]);
J("viewport","viewport",[0,0,g.drawingBufferWidth,g.drawingBufferHeight]);var Pa={gl:g,context:W,strings:m,next:Aa,current:ma,draw:z,elements:U,buffer:w,shader:fa,attributes:N.state,uniforms:D,framebuffer:P,extensions:A,timer:Z,isBufferArgs:h},Ga={primTypes:M,compareFuncs:T,blendFuncs:r,blendEquations:v,stencilOps:L,glTypes:H,orientationType:u};Ha&&(Ga.backBuffer=[1029],Ga.drawBuffer=x(F.maxDrawbuffers,function(a){return 0===a?[0]:x(a,function(a){return 36064+a})}));var Ra=0;return{next:Aa,current:ma,
procs:function(){var a=aa(),f=a.proc("poll"),b=a.proc("refresh"),c=a.block();f(c);b(c);var d=a.shared,e=d.gl,l=d.next,n=d.current;c(n,".dirty=false;");R(a,f);b(d.framebuffer,".dirty=true;");R(a,b);Object.keys(na).forEach(function(d){var v=na[d],h=c.def(l,".",d),k=a.block();k("if(",h,"){",e,".enable(",v,")}else{",e,".disable(",v,")}",n,".",d,"=",h,";");b(k);f("if(",h,"!==",n,".",d,"){",k,"}")});Object.keys(oa).forEach(function(d){var v=oa[d],h=ma[d],k,E,g=a.block();g(e,".",v,"(");B(h)?(v=h.length,
k=a.global.def(l,".",d),E=a.global.def(n,".",d),g(x(v,function(a){return k+"["+a+"]"}),");",x(v,function(a){return E+"["+a+"]="+k+"["+a+"];"}).join("")),f("if(",x(v,function(a){return k+"["+a+"]!=="+E+"["+a+"]"}).join("||"),"){",g,"}")):(k=c.def(l,".",d),E=c.def(n,".",d),g(k,");",n,".",d,"=",k,";"),f("if(",k,"!==",E,"){",g,"}"));b(g)});return a.compile()}(),compile:function(a,f,b,c,d){var e=aa();e.stats=e.link(d);Object.keys(f["static"]).forEach(function(a){ta(e,f,a)});l.forEach(function(f){ta(e,
a,f)});b=Y(a,f,b,c);Ja(e,b);sa(e,b);Ma(e,b);return e.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(g,m,w){function h(c,b){this.id=q++;this.type=c;this.data=b}function e(c){if(0===c.length)return[];var b=c.charAt(0),d=c.charAt(c.length-1);if(1<c.length&&b===d&&('"'===b||"'"===b))return['"'+c.substr(1,c.length-2).replace(/\\/g,"\\\\").replace(/"/g,
'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(c))return e(c.substr(0,b.index)).concat(e(b[1])).concat(e(c.substr(b.index+b[0].length)));b=c.split(".");if(1===b.length)return['"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];c=[];for(d=0;d<b.length;++d)c=c.concat(e(b[d]));return c}function y(c){return"["+e(c).join("][")+"]"}var q=0;m.exports={DynamicVariable:h,define:function(c,b){return new h(c,y(b+""))},isDynamic:function(c){return"function"===typeof c&&!c._reglType||c instanceof
h},unbox:function(c,b){return"function"===typeof c?new h(0,c):c},accessor:y}},{}],10:[function(g,m,w){var h=g("./util/is-typed-array"),e=g("./util/is-ndarray"),y=g("./util/values"),q=g("./constants/primitives.json"),c=g("./constants/usage.json");m.exports=function(b,d,g,m){function F(b){this.id=H++;M[this.id]=this;this.buffer=b;this.primType=4;this.type=this.vertCount=0}function B(b,c,l,k,a,t,q){(t=q)||h(c)&&(!e(c)||h(c.data))||(t=d.oes_element_index_uint?5125:5123);b.buffer.bind();g._initBuffer(b.buffer,
c,l,t,3);c=q;if(!q){switch(b.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=5125}b.buffer.dtype=c}b.type=c;0>a&&(a=b.buffer.byteLength,5123===c?a>>=1:5125===c&&(a>>=2));b.vertCount=a;a=k;0>k&&(a=4,k=b.buffer.dimension,1===k&&(a=0),2===k&&(a=1),3===k&&(a=4));b.primType=a}function k(b){m.elementsCount--;delete M[b.id];b.buffer.destroy();b.buffer=null}var M={},H=0,t={uint8:5121,uint16:5123};d.oes_element_index_uint&&(t.uint32=5125);F.prototype.bind=
function(){this.buffer.bind()};var l=[];return{create:function(d){function l(a){if(a)if("number"===typeof a)y(a),u.primType=4,u.vertCount=a|0,u.type=5121;else{var d=null,k=35044,g=-1,r=-1,x=0,m=0;Array.isArray(a)||h(a)||e(a)?d=a:("data"in a&&(d=a.data),"usage"in a&&(k=c[a.usage]),"primitive"in a&&(g=q[a.primitive]),"count"in a&&(r=a.count|0),"length"in a&&(x=a.length|0),"type"in a&&(m=t[a.type]));d?B(u,d,k,g,r,x,m):(a=u.buffer,a.bind(),b.bufferData(34963,x,k),a.dtype=m||5121,a.usage=k,a.dimension=
3,a.byteLength=x,u.primType=0>g?4:g,u.vertCount=0>r?0:r,u.type=a.dtype)}else y(),u.primType=4,u.vertCount=0,u.type=5121;return l}var y=g.create(null,34963,!0),u=new F(y._buffer);m.elementsCount++;l(d);l._reglType="elements";l._elements=u;l.subdata=function(a,b){y.subdata(a,b);return l};l.destroy=function(){k(u)};return l},createStream:function(b){var c=l.pop();c||(c=new F(g.create(null,34963,!0)._buffer));B(c,b,35040,-1,-1,0,0);return c},destroyStream:function(b){l.push(b)},getElements:function(b){return"function"===
typeof b&&b._elements instanceof F?b._elements:null},clear:function(){y(M).forEach(k)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(g,m,w){m.exports=function(h,e){function g(b){b=b.toLowerCase();if(b in q)return!0;var c;try{c=q[b]=h.getExtension(b)}catch(e){}return!!c}for(var q={},c=0;c<e.extensions.length;++c){var b=e.extensions[c];if(!g(b))return e.onDestroy(),e.onDone('"'+b+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),
null}e.optionalExtensions.forEach(g);return{extensions:q,refresh:function(){e.extensions.forEach(g);e.optionalExtensions.forEach(g)}}}},{}],12:[function(g,m,w){var h=g("./util/values"),e=g("./util/extend"),y=[];y[6408]=4;var q=[];q[5121]=1;q[5126]=4;q[36193]=2;m.exports=function(c,b,d,g,m,F){function B(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height);this.width=a;this.height=d}function k(a){a&&(a.texture&&a.texture._texture.decRef(),
a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function M(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function H(a,b){b?b.texture?c.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):c.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):c.framebufferTexture2D(36160,a,3553,null,0)}function t(a){var b=3553,c=null,d=null,e=a;"object"===typeof a&&(e=a.data,"target"in a&&(b=a.target|0));a=e._reglType;
"texture2d"===a?c=e:"textureCube"===a?c=e:"renderbuffer"===a&&(d=e,b=36161);return new B(b,c,d)}function l(a,b,c,d,e){if(c)return a=g.create2D({width:a,height:b,format:d,type:e}),a._texture.refCount=0,new B(3553,a,null);a=m.create({width:a,height:b,format:d});a._renderbuffer.refCount=0;return new B(36161,null,a)}function r(a){return a&&(a.texture||a.renderbuffer)}function w(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function L(){this.id=za++;P[this.id]=
this;this.framebuffer=c.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function u(a){a.colorAttachments.forEach(k);k(a.depthAttachment);k(a.stencilAttachment);k(a.depthStencilAttachment)}function a(a){c.deleteFramebuffer(a.framebuffer);a.framebuffer=null;F.framebufferCount--;delete P[a.id]}function V(a){var b;c.bindFramebuffer(36160,a.framebuffer);var e=a.colorAttachments;for(b=0;b<e.length;++b)H(36064+
b,e[b]);for(b=e.length;b<d.maxColorAttachments;++b)H(36064+b,null);H(36096,a.depthAttachment);H(36128,a.stencilAttachment);H(33306,a.depthStencilAttachment);c.checkFramebufferStatus(36160);c.bindFramebuffer(36160,ka.next);ka.current=ka.next}function Na(c,d){function k(a,c){var d,e=0,g=0,x=!0,m=!0;d=null;var B=!0,A="rgba",H="uint8",F=1,D=null,w=null,L=null,T=!1;if("number"===typeof a)e=a|0,g=c|0||e;else if(a){"shape"in a?(g=a.shape,e=g[0],g=g[1]):("radius"in a&&(e=g=a.radius),"width"in a&&(e=a.width),
"height"in a&&(g=a.height));if("color"in a||"colors"in a)d=a.color||a.colors,Array.isArray(d);d||("colorCount"in a&&(F=a.colorCount|0),"colorTexture"in a&&(B=!!a.colorTexture,A="rgba4"),"colorType"in a&&(H=a.colorType,B||("half float"===H?b.ext_color_buffer_half_float&&(A="rgba16f"):"float"===H&&b.webgl_color_buffer_float&&(A="rgba32f"))),"colorFormat"in a&&(A=a.colorFormat,0<=la.indexOf(A)?B=!0:0<=ua.indexOf(A)&&(B=!1)));if("depthTexture"in a||"depthStencilTexture"in a)T=!(!a.depthTexture&&!a.depthStencilTexture);
"depth"in a&&("boolean"===typeof a.depth?x=a.depth:(D=a.depth,m=!1));"stencil"in a&&("boolean"===typeof a.stencil?m=a.stencil:(w=a.stencil,x=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?x=m=a.depthStencil:(L=a.depthStencil,m=x=!1))}else e=g=1;var I=null,N=null,S=null,R=null;if(Array.isArray(d))I=d.map(t);else if(d)I=[t(d)];else for(I=Array(F),d=0;d<F;++d)I[d]=l(e,g,B,A,H);e=e||I[0].width;g=g||I[0].height;D?N=t(D):x&&!m&&(N=l(e,g,T,"depth","uint32"));w?S=t(w):m&&!x&&(S=l(e,g,!1,"stencil",
"uint8"));L?R=t(L):!D&&!w&&m&&x&&(R=l(e,g,T,"depth stencil","depth stencil"));x=null;for(d=0;d<I.length;++d)M(I[d],e,g),I[d]&&I[d].texture&&(m=y[I[d].texture._texture.format]*q[I[d].texture._texture.type],null===x&&(x=m));M(N,e,g);M(S,e,g);M(R,e,g);u(h);h.width=e;h.height=g;h.colorAttachments=I;h.depthAttachment=N;h.stencilAttachment=S;h.depthStencilAttachment=R;k.color=I.map(r);k.depth=r(N);k.stencil=r(S);k.depthStencil=r(R);k.width=h.width;k.height=h.height;V(h);return k}var h=new L;F.framebufferCount++;
k(c,d);return e(k,{resize:function(a,b){var c=a|0,d=b|0||c;if(c===h.width&&d===h.height)return k;for(var e=h.colorAttachments,l=0;l<e.length;++l)w(e[l],c,d);w(h.depthAttachment,c,d);w(h.stencilAttachment,c,d);w(h.depthStencilAttachment,c,d);h.width=k.width=c;h.height=k.height=d;V(h);return k},_reglType:"framebuffer",_framebuffer:h,destroy:function(){a(h);u(h)}})}var ka={current:null,next:null,dirty:!1},la=["rgba"],ua=["rgba4","rgb565","rgb5 a1"];b.ext_srgb&&ua.push("srgba");b.ext_color_buffer_half_float&&
ua.push("rgba16f","rgb16f");b.webgl_color_buffer_float&&ua.push("rgba32f");var U=["uint8"];b.oes_texture_half_float&&U.push("half float");b.oes_texture_float&&U.push("float");var za=0,P={};return e(ka,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof L)?a:null},create:Na,createCube:function(a){function b(a){var d={color:null},l=0,k=null,h="rgba",t="uint8",r=1;if("number"===typeof a)l=a|0;else if(a){"shape"in a?l=a.shape[0]:("radius"in
a&&(l=a.radius|0),"width"in a?l=a.width|0:"height"in a&&(l=a.height|0));if("color"in a||"colors"in a)k=a.color||a.colors,Array.isArray(k);k||("colorCount"in a&&(r=a.colorCount|0),"colorType"in a&&(t=a.colorType),"colorFormat"in a&&(h=a.colorFormat));"depth"in a&&(d.depth=a.depth);"stencil"in a&&(d.stencil=a.stencil);"depthStencil"in a&&(d.depthStencil=a.depthStencil)}else l=1;var q;if(k)if(Array.isArray(k))for(a=0;a<k.length;++a);else q=[k];else for(q=Array(r),k={radius:l,format:h,type:t},a=0;a<r;++a)q[a]=
g.createCube(k);d.color=Array(q.length);for(a=0;a<q.length;++a)r=q[a],l=l||r.width,d.color[a]={target:34069,data:q[a]};for(a=0;6>a;++a){for(r=0;r<q.length;++r)d.color[r].target=34069+a;0<a&&(d.depth=c[0].depth,d.stencil=c[0].stencil,d.depthStencil=c[0].depthStencil);if(c[a])c[a](d);else c[a]=Na(d)}return e(b,{width:l,height:l,color:q})}var c=Array(6);b(a);return e(b,{faces:c,resize:function(a){for(var d=0;6>d;++d)c[d].resize(a);return b},_reglType:"framebufferCube",destroy:function(){c.forEach(function(a){a.destroy()})}})},
clear:function(){h(P).forEach(a)}})}},{"./util/extend":23,"./util/values":31}],13:[function(g,m,w){m.exports=function(h,e){var g=1;e.ext_texture_filter_anisotropic&&(g=h.getParameter(34047));var q=1,c=1;e.webgl_draw_buffers&&(q=h.getParameter(34852),c=h.getParameter(36063));return{colorBits:[h.getParameter(3410),h.getParameter(3411),h.getParameter(3412),h.getParameter(3413)],depthBits:h.getParameter(3414),stencilBits:h.getParameter(3415),subpixelBits:h.getParameter(3408),extensions:Object.keys(e).filter(function(b){return!!e[b]}),
maxAnisotropic:g,maxDrawbuffers:q,maxColorAttachments:c,pointSizeDims:h.getParameter(33901),lineWidthDims:h.getParameter(33902),maxViewportDims:h.getParameter(3386),maxCombinedTextureUnits:h.getParameter(35661),maxCubeMapSize:h.getParameter(34076),maxRenderbufferSize:h.getParameter(34024),maxTextureUnits:h.getParameter(34930),maxTextureSize:h.getParameter(3379),maxAttributes:h.getParameter(34921),maxVertexUniforms:h.getParameter(36347),maxVertexTextureUnits:h.getParameter(35660),maxVaryingVectors:h.getParameter(36348),
maxFragmentUniforms:h.getParameter(36349),glsl:h.getParameter(35724),renderer:h.getParameter(7937),vendor:h.getParameter(7936),version:h.getParameter(7938)}}},{}],14:[function(g,m,w){var h=g("./util/is-typed-array");m.exports=function(e,g,q,c,b,d){return function(b){var d;d=null===g.next?5121:g.next.colorAttachments[0].texture._texture.type;var m=0,B=0,k=c.framebufferWidth,M=c.framebufferHeight,H=null;h(b)?H=b:b&&(m=b.x|0,B=b.y|0,k=(b.width||c.framebufferWidth-m)|0,M=(b.height||c.framebufferHeight-
B)|0,H=b.data||null);q();b=k*M*4;H||(5121===d?H=new Uint8Array(b):5126===d&&(H=H||new Float32Array(b)));e.pixelStorei(3333,4);e.readPixels(m,B,k,M,6408,d,H);return H}}},{"./util/is-typed-array":26}],15:[function(g,m,w){var h=g("./util/values"),e=[];e[32854]=2;e[32855]=2;e[36194]=2;e[33189]=2;e[36168]=1;e[34041]=4;e[35907]=4;e[34836]=16;e[34842]=8;e[34843]=6;m.exports=function(g,q,c,b,d){function m(b){this.id=B++;this.refCount=1;this.renderbuffer=b;this.format=32854;this.height=this.width=0;d.profile&&
(this.stats={size:0})}function A(c){var d=c.renderbuffer;g.bindRenderbuffer(36161,null);g.deleteRenderbuffer(d);c.renderbuffer=null;c.refCount=0;delete k[c.id];b.renderbufferCount--}var F={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};q.ext_srgb&&(F.srgba=35907);q.ext_color_buffer_half_float&&(F.rgba16f=34842,F.rgb16f=34843);q.webgl_color_buffer_float&&(F.rgba32f=34836);var B=0,k={};m.prototype.decRef=function(){0>=--this.refCount&&A(this)};d.profile&&(b.getTotalRenderbufferSize=
function(){var b=0;Object.keys(k).forEach(function(c){b+=k[c].stats.size});return b});return{create:function(c,h){function t(b,c){var k=0,h=0,a=32854;"object"===typeof b&&b?("shape"in b?(h=b.shape,k=h[0]|0,h=h[1]|0):("radius"in b&&(k=h=b.radius|0),"width"in b&&(k=b.width|0),"height"in b&&(h=b.height|0)),"format"in b&&(a=F[b.format])):"number"===typeof b?(k=b|0,h="number"===typeof c?c|0:k):b||(k=h=1);if(k!==l.width||h!==l.height||a!==l.format)return t.width=l.width=k,t.height=l.height=h,l.format=a,
g.bindRenderbuffer(36161,l.renderbuffer),g.renderbufferStorage(36161,a,k,h),d.profile&&(l.stats.size=e[l.format]*l.width*l.height),t}var l=new m(g.createRenderbuffer());k[l.id]=l;b.renderbufferCount++;t(c,h);t.resize=function(b,c){var k=b|0,h=c|0||k;if(k===l.width&&h===l.height)return t;t.width=l.width=k;t.height=l.height=h;g.bindRenderbuffer(36161,l.renderbuffer);g.renderbufferStorage(36161,l.format,k,h);d.profile&&(l.stats.size=e[l.format]*l.width*l.height);return t};t._reglType="renderbuffer";
t._renderbuffer=l;d.profile&&(t.stats=l.stats);t.destroy=function(){l.decRef()};return t},clear:function(){h(k).forEach(A)}}}},{"./util/values":31}],16:[function(g,m,w){var h=g("./util/values");m.exports=function(e,g,q,c){function b(b,c,d,e){this.name=b;this.id=c;this.location=d;this.info=e}function d(b,c){for(var d=0;d<b.length;++d)if(b[d].id===c.id){b[d].location=c.location;return}b.push(c)}function m(b,c,d){d=35632===b?F:B;var k=d[c];if(!k){var h=g.str(c),k=e.createShader(b);e.shaderSource(k,h);
e.compileShader(k);d[c]=k}return k}function A(b,d){this.id=H++;this.fragId=b;this.vertId=d;this.program=null;this.uniforms=[];this.attributes=[];c.profile&&(this.stats={uniformsCount:0,attributesCount:0})}var F={},B={},k={},M=[],H=0;c.profile&&(q.getMaxUniformsCount=function(){var b=0;M.forEach(function(c){c.stats.uniformsCount>b&&(b=c.stats.uniformsCount)});return b},q.getMaxAttributesCount=function(){var b=0;M.forEach(function(c){c.stats.attributesCount>b&&(b=c.stats.attributesCount)});return b});
return{clear:function(){var b=e.deleteShader.bind(e);h(F).forEach(b);F={};h(B).forEach(b);B={};M.forEach(function(b){e.deleteProgram(b.program)});M.length=0;k={};q.shaderCount=0},program:function(h,l,r){q.shaderCount++;(r=k[l])||(r=k[l]={});var B=r[h];if(!B){var H=B=new A(l,h),u,a;u=m(35632,H.fragId);a=m(35633,H.vertId);l=H.program=e.createProgram();e.attachShader(l,u);e.attachShader(l,a);e.linkProgram(l);var F=e.getProgramParameter(l,35718);c.profile&&(H.stats.uniformsCount=F);var w=H.uniforms;for(u=
0;u<F;++u)if(a=e.getActiveUniform(l,u))if(1<a.size)for(var ka=0;ka<a.size;++ka){var la=a.name.replace("[0]","["+ka+"]");d(w,new b(la,g.id(la),e.getUniformLocation(l,la),a))}else d(w,new b(a.name,g.id(a.name),e.getUniformLocation(l,a.name),a));F=e.getProgramParameter(l,35721);c.profile&&(H.stats.attributesCount=F);H=H.attributes;for(u=0;u<F;++u)(a=e.getActiveAttrib(l,u))&&d(H,new b(a.name,g.id(a.name),e.getAttribLocation(l,a.name),a));r[h]=B;M.push(B)}return B},shader:m,frag:null,vert:null}}},{"./util/values":31}],
17:[function(g,m,w){m.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(g,m,w){m.exports=function(){var h={"":0},e=[""];return{id:function(g){var q=h[g];if(q)return q;q=h[g]=e.length;e.push(g);return q},str:function(h){return e[h]}}}},{}],19:[function(g,m,w){function h(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function e(a){return Array.isArray(a)&&0!==
a.length&&M(a[0])?!0:!1}function y(a){return Object.prototype.toString.call(a)}function q(a){if(!a)return!1;var b=y(a);return 0<=T.indexOf(b)?!0:h(a)||e(a)||F(a)}function c(a,b){36193===a.type?(a.data=k(b),B.freeType(b)):a.data=b}function b(a,b,c,d,e,k){a="undefined"!==typeof u[a]?u[a]:r[a]*L[b];k&&(a*=6);if(e){for(d=0;1<=c;)d+=a*c*c,c/=2;return d}return a*c*d}var d=g("./util/extend"),x=g("./util/values"),A=g("./util/is-typed-array"),F=g("./util/is-ndarray"),B=g("./util/pool"),k=g("./util/to-half-float"),
M=g("./util/is-array-like");w=g("./constants/arraytypes.json");var H=g("./constants/arraytypes.json"),t=[9984,9986,9985,9987],l=[0,6409,6410,6407,6408],r={};r[6409]=r[6406]=r[6402]=1;r[34041]=r[6410]=2;r[6407]=r[35904]=3;r[6408]=r[35906]=4;var T=Object.keys(w).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),L=[];L[5121]=1;L[5126]=4;L[36193]=2;L[5123]=2;L[5125]=4;var u=[];u[32854]=2;u[32855]=2;u[36194]=2;u[34041]=4;
u[33776]=.5;u[33777]=.5;u[33778]=1;u[33779]=1;u[35986]=.5;u[35987]=1;u[34798]=1;u[35840]=.5;u[35841]=.25;u[35842]=.5;u[35843]=.25;u[36196]=.5;m.exports=function(a,g,m,u,w,L,U){function T(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function P(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;
a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function D(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=wa[b.colorSpace]);"type"in b&&(a.type=ca[b.type]);var c=a.width,d=a.height,e=a.channels,k=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&
(e=b.shape[2],k=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(e=b.channels,k=!0));a.width=c|0;a.height=d|0;a.channels=e|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=da[c],a.format=Ia[d],c in ca&&!("type"in b)&&(a.type=ca[c]),c in ea&&(a.compressed=!0),c=!0);!k&&c?a.channels=r[a.format]:k&&!c&&a.channels!==l[a.format]&&(a.format=a.internalformat=l[a.channels])}}function N(b){a.pixelStorei(37440,b.flipY);a.pixelStorei(37441,b.premultiplyAlpha);
a.pixelStorei(37443,b.colorSpace);a.pixelStorei(3317,b.unpackAlignment)}function fa(){T.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function z(a,b){var d=null;q(b)?d=b:b&&(D(a,b),"x"in b&&(a.xOffset=b.x|0),"y"in b&&(a.yOffset=b.y|0),q(b.data)&&(d=b.data));if(b.copy){var g=w.viewportWidth,m=w.viewportHeight;a.width=a.width||g-a.xOffset;a.height=a.height||m-a.yOffset;a.needsCopy=!0}else if(!d)a.width=a.width||1,a.height=a.height||1;else if(A(d))a.data=
d,"type"in b||5121!==a.type||(a.type=H[Object.prototype.toString.call(d)]|0);else if(h(d)){g=d;m=a.width*a.height*a.channels;switch(a.type){case 5121:case 5123:case 5125:case 5126:m=B.allocType(a.type,m);m.set(g);a.data=m;break;case 36193:a.data=k(g)}a.alignment=1;a.needsFree=!0}else if(F(d)){g=d.data;Array.isArray(g)||5121!==a.type||(a.type=H[Object.prototype.toString.call(g)]|0);var m=d.shape,t=d.stride,r,x,u,z;3===m.length?(u=m[2],z=t[2]):z=u=1;r=m[0];x=m[1];m=t[0];t=t[1];a.alignment=1;a.width=
r;a.height=x;a.channels=u;a.format=a.internalformat=l[u];a.needsFree=!0;r=z;d=d.offset;u=a.width;z=a.height;x=a.channels;for(var S=B.allocType(36193===a.type?5126:a.type,u*z*x),R=0,p=0;p<z;++p)for(var C=0;C<u;++C)for(var O=0;O<x;++O)S[R++]=g[m*C+t*p+r*O+d];c(a,S)}else if("[object HTMLCanvasElement]"===y(d)||"[object CanvasRenderingContext2D]"===y(d))"[object HTMLCanvasElement]"===y(d)?a.element=d:a.element=d.canvas,a.width=a.element.width,a.height=a.element.height;else if("[object HTMLImageElement]"===
y(d))a.element=d,a.width=d.naturalWidth,a.height=d.naturalHeight;else if("[object HTMLVideoElement]"===y(d))a.element=d,a.width=d.videoWidth,a.height=d.videoHeight,a.needsPoll=!0;else if(e(d)){g=d[0].length;m=d.length;t=1;if(M(d[0][0])){r=t=d[0][0].length;u=B.allocType(36193===a.type?5126:a.type,g*m*r);for(x=z=0;x<m;++x)for(S=d[x],R=0;R<g;++R)for(p=S[R],C=0;C<r;++C)u[z++]=p[C];c(a,u)}else{r=B.allocType(36193===a.type?5126:a.type,g*m);for(z=u=0;z<m;++z)for(x=d[z],S=0;S<g;++S)r[u++]=x[S];c(a,r)}a.alignment=
1;a.width=g;a.height=m;a.channels=t;a.format=a.internalformat=l[t];a.needsFree=!0}}function W(b,c,d,e,k){var g=b.element,h=b.data,l=b.internalformat,m=b.format,q=b.type,t=b.width,r=b.height;N(b);g?a.texSubImage2D(c,k,d,e,m,q,g):b.compressed?a.compressedTexSubImage2D(c,k,d,e,l,t,r,h):b.needsCopy?(u(),a.copyTexSubImage2D(c,k,d,e,b.xOffset,b.yOffset,t,r)):a.texSubImage2D(c,k,d,e,t,r,m,q,h)}function Z(){return Ja.pop()||new fa}function ga(a){a.needsFree&&B.freeType(a.data);fa.call(a);Ja.push(a)}function ha(){T.call(this);
this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function Q(a,b,c){var d=a.images[0]=Z();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function J(a,b){var c=null;if(q(b))c=a.images[0]=Z(),P(c,a),z(c,b),a.mipmask=1;else if(D(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,e=0;e<d.length;++e)c=a.images[e]=Z(),P(c,a),c.width>>=e,c.height>>=e,z(c,d[e]),a.mipmask|=1<<e;else c=a.images[0]=Z(),P(c,a),z(c,b),a.mipmask=1;P(a,a.images[0])}function aa(b,c){for(var d=b.images,
e=0;e<d.length&&d[e];++e){var k=d[e],g=c,h=e,l=k.element,m=k.data,q=k.internalformat,t=k.format,r=k.type,p=k.width,x=k.height;N(k);l?a.texImage2D(g,h,t,t,r,l):k.compressed?a.compressedTexImage2D(g,h,q,p,x,0,m):k.needsCopy?(u(),a.copyTexImage2D(g,h,t,k.xOffset,k.yOffset,p,x,0)):a.texImage2D(g,h,t,p,x,0,t,r,m)}}function pa(){var a=Ka.pop()||new ha;T.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function va(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&ga(b[c]),b[c]=null;Ka.push(a)}
function ia(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function qa(a,b){"min"in b&&(a.minFilter=Ca[b.min],0<=t.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=Ba[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var e=b.wrap;"string"===typeof e?c=d=R[e]:Array.isArray(e)&&(c=R[e[0]],d=R[e[1]])}else"wrapS"in b&&(c=R[b.wrapS]),"wrapT"in b&&(d=R[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=
b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=S[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function ja(b,c){a.texParameteri(c,10241,b.minFilter);a.texParameteri(c,10240,b.magFilter);a.texParameteri(c,10242,b.wrapS);a.texParameteri(c,10243,b.wrapT);g.ext_texture_filter_anisotropic&&a.texParameteri(c,34046,b.anisotropic);b.genMipmaps&&(a.hint(33170,b.mipmapHint),
a.generateMipmap(c))}function ba(){var a=xa.pop()||new ia;ia.call(a);return a}function ra(b){T.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ma++;this.refCount=1;this.target=b;this.texture=a.createTexture();this.unit=-1;this.bindCount=0;U.profile&&(this.stats={size:0})}function X(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function I(){var b=ta[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function Y(b){var c=b.texture,d=b.unit,e=b.target;0<=d&&(a.activeTexture(33984+
d),a.bindTexture(e,null),ta[d]=null);a.deleteTexture(c);b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete sa[b.id];L.textureCount--}var S={"don't care":4352,"dont care":4352,nice:4354,fast:4353},R={repeat:10497,clamp:33071,mirror:33648},Ba={nearest:9728,linear:9729},Ca=d({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},Ba),wa={none:0,browser:37444},ca={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},
da={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ea={};g.ext_srgb&&(da.srgb=35904,da.srgba=35906);g.oes_texture_float&&(ca["float"]=5126);g.oes_texture_half_float&&(ca.float16=ca["half float"]=36193);g.webgl_depth_texture&&(d(da,{depth:6402,"depth stencil":34041}),d(ca,{uint16:5123,uint32:5125,"depth stencil":34042}));g.webgl_compressed_texture_s3tc&&d(ea,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});
g.webgl_compressed_texture_atc&&d(ea,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});g.webgl_compressed_texture_pvrtc&&d(ea,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});g.webgl_compressed_texture_etc1&&(ea["rgb etc1"]=36196);var Da=Array.prototype.slice.call(a.getParameter(34467));Object.keys(ea).forEach(function(a){var b=ea[a];0<=Da.indexOf(b)&&(da[a]=b)});var ya=Object.keys(da);m.textureFormats=ya;
var Ia=ya.reduce(function(a,b){var c=da[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ja=[],Ka=[],xa=[],Ma=0,sa={},Ea=m.maxTextureUnits,ta=Array(Ea).map(function(){return null});d(ra.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<Ea;++c){var d=ta[c];if(d){if(0<d.bindCount)continue;d.unit=-1}ta[c]=this;b=c;break}U.profile&&L.maxTextureUnits<b+1&&(L.maxTextureUnits=b+1);this.unit=
b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Y(this)}});U.profile&&(L.getTotalTextureSize=function(){var a=0;Object.keys(sa).forEach(function(b){a+=sa[b].stats.size});return a});return{create2D:function(c,d){function e(a,c){var d=ba(),f=pa();"number"===typeof a?"number"===typeof c?Q(f,a|0,c|0):Q(f,a|0,a|0):a?(qa(d,a),J(f,a)):Q(f,1,1);d.genMipmaps&&(f.mipmask=(f.width<<1)-1);k.mipmask=f.mipmask;
P(k,f);k.internalformat=f.internalformat;e.width=f.width;e.height=f.height;X(k);aa(f,3553);ja(d,3553);I();xa.push(d);va(f);U.profile&&(k.stats.size=b(k.internalformat,k.type,f.width,f.height,d.genMipmaps,!1));return e}var k=new ra(3553);sa[k.id]=k;L.textureCount++;e(c,d);e.subimage=function(a,b,c,d){b|=0;c|=0;d|=0;var f=Z();P(f,k);f.width>>=d;f.height>>=d;f.width-=b;f.height-=c;z(f,a);X(k);W(f,3553,b,c,d);I();ga(f);return e};e.resize=function(c,d){var f=c|0,g=d|0||f;if(f===k.width&&g===k.height)return e;
e.width=k.width=f;e.height=k.height=g;X(k);for(var h=0;k.mipmask>>h;++h)a.texImage2D(3553,h,k.format,f>>h,g>>h,0,k.format,k.type,null);I();U.profile&&(k.stats.size=b(k.internalformat,k.type,f,g,!1,!1));return e};e._reglType="texture2d";e._texture=k;U.profile&&(e.stats=k.stats);e.destroy=function(){k.decRef()};return e},createCube:function(c,d,e,k,g,h){function l(a,c,d,f,e,k){var g,h=ba();for(g=0;6>g;++g)q[g]=pa();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)Q(q[g],a,a);else if("object"===typeof a)if(c)J(q[0],
a),J(q[1],c),J(q[2],d),J(q[3],f),J(q[4],e),J(q[5],k);else if(qa(h,a),D(m,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)P(q[g],m),J(q[g],a[g]);else for(g=0;6>g;++g)J(q[g],a);P(m,q[0]);m.mipmask=h.genMipmaps?(q[0].width<<1)-1:q[0].mipmask;m.internalformat=q[0].internalformat;l.width=q[0].width;l.height=q[0].height;X(m);for(g=0;6>g;++g)aa(q[g],34069+g);ja(h,34067);I();U.profile&&(m.stats.size=b(m.internalformat,m.type,l.width,l.height,h.genMipmaps,!0));xa.push(h);for(g=0;6>g;++g)va(q[g]);return l}var m=new ra(34067);
sa[m.id]=m;L.cubeCount++;var q=Array(6);l(c,d,e,k,g,h);l.subimage=function(a,b,c,d,f){c|=0;d|=0;f|=0;var e=Z();P(e,m);e.width>>=f;e.height>>=f;e.width-=c;e.height-=d;z(e,b);X(m);W(e,34069+a,c,d,f);I();ga(e);return l};l.resize=function(c){c|=0;if(c!==m.width){l.width=m.width=c;l.height=m.height=c;X(m);for(var d=0;6>d;++d)for(var f=0;m.mipmask>>f;++f)a.texImage2D(34069+d,d,m.format,c>>d,c>>d,0,m.format,m.type,null);I();U.profile&&(m.stats.size=b(m.internalformat,m.type,l.width,l.height,!1,!0));return l}};
l._reglType="textureCube";l._texture=m;U.profile&&(l.stats=m.stats);l.destroy=function(){m.decRef()};return l},clear:function(){for(var b=0;b<Ea;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ta[b]=null;x(sa).forEach(Y);L.cubeCount=0;L.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(g,
m,w){m.exports=function(g,e){function m(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function q(b,c,d){var e=x.pop()||new m;e.startQueryIndex=b;e.endQueryIndex=c;e.sum=0;e.stats=d;A.push(e)}var c=e.ext_disjoint_timer_query;if(!c)return null;var b=[],d=[],x=[],A=[],F=[],B=[];return{beginQuery:function(e){var g=b.pop()||c.createQueryEXT();c.beginQueryEXT(35007,g);d.push(g);q(d.length-1,d.length,e)},endQuery:function(){c.endQueryEXT(35007)},pushScopeStats:q,update:function(){var e,
g;e=d.length;if(0!==e){B.length=Math.max(B.length,e+1);F.length=Math.max(F.length,e+1);F[0]=0;var h=B[0]=0;for(g=e=0;g<d.length;++g){var m=d[g];c.getQueryObjectEXT(m,34919)?(h+=c.getQueryObjectEXT(m,34918),b.push(m)):d[e++]=m;F[g+1]=h;B[g+1]=e}d.length=e;for(g=e=0;g<A.length;++g){var h=A[g],l=h.startQueryIndex,m=h.endQueryIndex;h.sum+=F[m]-F[l];l=B[l];m=B[m];m===l?(h.stats.gpuTime+=h.sum/1E6,x.push(h)):(h.startQueryIndex=l,h.endQueryIndex=m,A[e++]=h)}A.length=e}},getNumPendingQueries:function(){return d.length},
clear:function(){b.push.apply(b,d);for(var e=0;e<b.length;e++)c.deleteQueryEXT(b[e]);d.length=0;b.length=0}}}},{}],21:[function(g,m,w){m.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(g,m,w){function h(e){return Array.prototype.slice.call(e)}function e(e){return h(e).join("")}var y=g("./extend");m.exports=function(){function g(){var c=[],d=[];return y(function(){c.push.apply(c,h(arguments))},{def:function(){var e=
"v"+b++;d.push(e);0<arguments.length&&(c.push(e,"="),c.push.apply(c,h(arguments)),c.push(";"));return e},toString:function(){return e([0<d.length?"var "+d+";":"",e(c)])}})}function c(){function b(e,g){d(e,g,"=",c.def(e,g),";")}var c=g(),d=g(),e=c.toString,m=d.toString;return y(function(){c.apply(c,h(arguments))},{def:c.def,entry:c,exit:d,save:b,set:function(d,e,g){b(d,e);c(d,e,"=",g,";")},toString:function(){return e()+m()}})}var b=0,d=[],m=[],A=g(),F={};return{global:A,link:function(c){for(var e=
0;e<m.length;++e)if(m[e]===c)return d[e];e="g"+b++;d.push(e);m.push(c);return e},block:g,proc:function(b,d){function g(){var b="a"+h.length;h.push(b);return b}var h=[];d=d||0;for(var m=0;m<d;++m)g();var m=c(),l=m.toString;return F[b]=y(m,{arg:g,toString:function(){return e(["function(",h.join(),"){",l(),"}"])}})},scope:c,cond:function(){var b=e(arguments),d=c(),g=c(),m=d.toString,q=g.toString;return y(d,{then:function(){d.apply(d,h(arguments));return this},"else":function(){g.apply(g,h(arguments));
return this},toString:function(){var c=q();c&&(c="else{"+c+"}");return e(["if(",b,"){",m(),"}",c])}})},compile:function(){var b=['"use strict";',A,"return {"];Object.keys(F).forEach(function(c){b.push('"',c,'":',F[c].toString(),",")});b.push("}");var c=e(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,d.concat(c)).apply(null,m)}}}},{"./extend":23}],23:[function(g,m,w){m.exports=function(g,e){for(var m=Object.keys(e),q=0;q<m.length;++q)g[m[q]]=e[m[q]];return g}},
{}],24:[function(g,m,w){var h=g("./is-typed-array");m.exports=function(e){return Array.isArray(e)||h(e)}},{"./is-typed-array":26}],25:[function(g,m,w){var h=g("./is-typed-array");m.exports=function(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||h(e.data))}},{"./is-typed-array":26}],26:[function(g,m,w){var h=g("../constants/arraytypes.json");m.exports=function(e){return Object.prototype.toString.call(e)in
h}},{"../constants/arraytypes.json":4}],27:[function(g,m,w){m.exports=function(g,e){for(var m=Array(g),q=0;q<g;++q)m[q]=e(q);return m}},{}],28:[function(g,m,w){function h(c){var b,d;b=(65535<c)<<4;c>>>=b;d=(255<c)<<3;c>>>=d;b|=d;d=(15<c)<<2;c>>>=d;b|=d;d=(3<c)<<1;return b|d|c>>>d>>1}function e(c){a:{for(var b=16;268435456>=b;b*=16)if(c<=b){c=b;break a}c=0}b=q[h(c)>>2];return 0<b.length?b.pop():new ArrayBuffer(c)}function y(c){q[h(c.byteLength)>>2].push(c)}var q=g("./loop")(8,function(){return[]});
m.exports={alloc:e,free:y,allocType:function(c,b){var d=null;switch(c){case 5120:d=new Int8Array(e(b),0,b);break;case 5121:d=new Uint8Array(e(b),0,b);break;case 5122:d=new Int16Array(e(2*b),0,b);break;case 5123:d=new Uint16Array(e(2*b),0,b);break;case 5124:d=new Int32Array(e(4*b),0,b);break;case 5125:d=new Uint32Array(e(4*b),0,b);break;case 5126:d=new Float32Array(e(4*b),0,b);break;default:return null}return d.length!==b?d.subarray(0,b):d},freeType:function(c){y(c.buffer)}}},{"./loop":27}],29:[function(g,
m,w){m.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(g){return requestAnimationFrame(g)},cancel:function(g){return cancelAnimationFrame(g)}}:{next:function(g){return setTimeout(g,16)},cancel:clearTimeout}},{}],30:[function(g,m,w){var h=g("./pool"),e=new Float32Array(1),y=new Uint32Array(e.buffer);m.exports=function(g){for(var c=h.allocType(5123,g.length),b=0;b<g.length;++b)if(isNaN(g[b]))c[b]=65535;else if(Infinity===g[b])c[b]=31744;else if(-Infinity===
g[b])c[b]=64512;else{e[0]=g[b];var d=y[0],m=d>>>31<<15,A=(d<<1>>>24)-127,d=d>>13&1023;c[b]=-24>A?m:-14>A?m+(d+1024>>-14-A):15<A?m+31744:m+(A+15<<10)+d}return c}},{"./pool":28}],31:[function(g,m,w){m.exports=function(g){return Object.keys(g).map(function(e){return g[e]})}},{}],32:[function(g,m,w){function h(b,d,e){function g(){var d=window.innerWidth,k=window.innerHeight;b!==document.body&&(k=b.getBoundingClientRect(),d=k.right-k.left,k=k.top-k.bottom);h.width=e*d;h.height=e*k;c(h.style,{width:d+"px",
height:k+"px"})}var h=document.createElement("canvas");c(h.style,{border:0,margin:0,padding:0,top:0,left:0});b.appendChild(h);b===document.body&&(h.style.position="absolute",c(b.style,{margin:0,padding:0}));window.addEventListener("resize",g,!1);g();return{canvas:h,onDestroy:function(){window.removeEventListener("resize",g);b.removeChild(h)}}}function e(b,c){function e(g){try{return b.getContext(g,c)}catch(h){return null}}return e("webgl")||e("experimental-webgl")||e("webgl-experimental")}function y(b){return"string"===
typeof b?b.split():b}function q(b){return"string"===typeof b?document.querySelector(b):b}var c=g("./util/extend");m.exports=function(b){var c=b||{},g,m,w,B;b={};var k=[],M=[],H="undefined"===typeof window?1:window.devicePixelRatio,t=!1,l=function(b){},r=function(){};"string"===typeof c?g=document.querySelector(c):"object"===typeof c&&("string"===typeof c.nodeName&&"function"===typeof c.appendChild&&"function"===typeof c.getBoundingClientRect?g=c:"function"===typeof c.drawArrays||"function"===typeof c.drawElements?
(B=c,w=B.canvas):("gl"in c?B=c.gl:"canvas"in c?w=q(c.canvas):"container"in c&&(m=q(c.container)),"attributes"in c&&(b=c.attributes),"extensions"in c&&(k=y(c.extensions)),"optionalExtensions"in c&&(M=y(c.optionalExtensions)),"onDone"in c&&(l=c.onDone),"profile"in c&&(t=!!c.profile),"pixelRatio"in c&&(H=+c.pixelRatio)));g&&("canvas"===g.nodeName.toLowerCase()?w=g:m=g);if(!B){if(!w){g=h(m||document.body,l,H);if(!g)return null;w=g.canvas;r=g.onDestroy}B=e(w,b)}return B?{gl:B,canvas:w,container:m,extensions:k,
optionalExtensions:M,pixelRatio:H,profile:t,onDone:l,onDestroy:r}:(r(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],33:[function(g,m,w){function h(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var e=g("./lib/util/extend"),y=g("./lib/dynamic"),q=g("./lib/util/raf"),c=g("./lib/util/clock"),b=g("./lib/strings"),d=g("./lib/webgl"),x=g("./lib/extension"),A=g("./lib/limits"),F=g("./lib/buffer"),B=g("./lib/elements"),
k=g("./lib/texture"),M=g("./lib/renderbuffer"),H=g("./lib/framebuffer"),t=g("./lib/attribute"),l=g("./lib/shader"),r=g("./lib/read"),T=g("./lib/core"),L=g("./lib/stats"),u=g("./lib/timer");m.exports=function(a){function g(){if(0===I.length)W&&W.update(),Y=null;else{Y=q.next(g);U();for(var a=I.length-1;0<=a;--a){var b=I[a];b&&b(Q,null,0)}D.flush();W&&W.update()}}function m(a){}function w(a){}function la(a){function b(a){var c={},d={};Object.keys(a).forEach(function(b){var e=a[b];y.isDynamic(e)?d[b]=
y.unbox(e,b):c[b]=e});return{dynamic:d,"static":c}}function c(a){for(;r.length<a;)r.push(null);return r}var d=b(a.context||{}),g=b(a.uniforms||{}),h=b(a.attributes||{}),k=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=e({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));a={gpuTime:0,cpuTime:0,count:0};var d=ba.compile(k,
h,g,d,a),l=d.draw,m=d.batch,q=d.scope,r=[];return e(function(a,b){var d;if("function"===typeof a)return q.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(d=0;d<a;++d)q.call(this,null,b,d);else if(Array.isArray(a))for(d=0;d<a.length;++d)q.call(this,a[d],b,d);else return q.call(this,a,b,0);else if("number"===typeof a){if(0<a)return m.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return m.call(this,a,a.length)}else return l.call(this,a)},{stats:a})}function ua(){var a=
ra.viewport,b=ra.scissor_box;a[0]=a[1]=b[0]=b[1]=0;Q.viewportWidth=Q.framebufferWidth=Q.drawingBufferWidth=a[2]=b[2]=D.drawingBufferWidth;Q.viewportHeight=Q.framebufferHeight=Q.drawingBufferHeight=a[3]=b[3]=D.drawingBufferHeight}function U(){Q.tick+=1;Q.time=(c()-Z)/1E3;ua();ba.procs.poll()}function za(){ua();ba.procs.refresh();W&&W.update()}var P=d(a);if(!P)return null;var D=P.gl;a=D.getContextAttributes();var N=x(D,P);if(!N)return null;var fa=b(),z=L(),N=N.extensions,W=u(D,N),Z=c(),ga=D.drawingBufferWidth,
ha=D.drawingBufferHeight,Q={tick:0,time:0,viewportWidth:ga,viewportHeight:ha,framebufferWidth:ga,framebufferHeight:ha,drawingBufferWidth:ga,drawingBufferHeight:ha,pixelRatio:P.pixelRatio},J=A(D,N),aa=F(D,z,P),pa=B(D,N,aa,z),ga=t(D,N,J,aa,fa),va=l(D,fa,z,P),ia=k(D,N,J,function(){ba.procs.poll()},Q,z,P),qa=M(D,N,J,z,P),ja=H(D,N,J,ia,qa,z),ba=T(D,fa,N,J,aa,pa,ia,ja,{},ga,va,{elements:null,primitive:4,count:-1,offset:0,instances:-1},Q,W,P),fa=r(D,ja,ba.procs.poll,Q,a,N),ra=ba.next,X=D.canvas,I=[],Y=null;
X&&(X.addEventListener("webglcontextlost",m,!1),X.addEventListener("webglcontextrestored",w,!1));za();a=e(la,{clear:function(a){var b=0;ba.procs.poll();var c=a.color;c&&(D.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(D.clearDepth(+a.depth),b|=256);"stencil"in a&&(D.clearStencil(a.stencil|0),b|=1024);D.clear(b)},prop:y.define.bind(null,1),context:y.define.bind(null,2),"this":y.define.bind(null,3),draw:la({}),buffer:function(a){return aa.create(a,34962)},elements:pa.create,
texture:ia.create2D,cube:ia.createCube,renderbuffer:qa.create,framebuffer:ja.create,framebufferCube:ja.createCube,attributes:a,frame:function(a){I.push(a);!Y&&0<I.length&&(Y=q.next(g));return{cancel:function(){function b(){var a=h(I,b);I[a]=I[I.length-1];--I.length;0>=I.length&&Y&&(q.cancel(g),Y=null)}var c=h(I,a);I[c]=b}}},limits:J,hasExtension:function(a){return 0<=J.extensions.indexOf(a.toLowerCase())},read:fa,destroy:function(){I.length=0;Y&&(q.cancel(g),Y=null);X&&(X.removeEventListener("webglcontextlost",
m),X.removeEventListener("webglcontextrestored",w));va.clear();ja.clear();qa.clear();ia.clear();pa.clear();aa.clear();W&&W.clear();P.onDestroy()},_gl:D,_refresh:za,poll:function(){U();W&&W.update()},stats:z});P.onDone(null,a);return a}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,
"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);
