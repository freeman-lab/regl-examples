<!DOCTYPE html>
      <html>
        <head>
          <title>example/life.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(k,z,l){function n(b,f){if(!z[b]){if(!k[b]){var c="function"==typeof require&&require;if(!f&&c)return c(b,!0);if(g)return g(b,!0);c=Error("Cannot find module '"+b+"'");throw c.code="MODULE_NOT_FOUND",c;}c=z[b]={exports:{}};k[b][0].call(c.exports,function(f){var c=k[b][1][f];return n(c?c:f)},c,c.exports,e$$0,k,z,l)}return z[b].exports}for(var g="function"==typeof require&&require,c=0;c<l.length;c++)n(l[c]);return n})({1:[function(d,k,z){var l=d("../regl")(),n=Array(1048576).fill(0).map(function(){return.9<
Math.random()?255:0}),g=Array(2).fill().map(function(){return l.framebuffer({color:l.texture({radius:512,data:n,wrap:"repeat"}),depthStencil:!1})}),c=l({frag:"\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float n = 0.0;\n    for(int dx=-1; dx<=1; ++dx)\n    for(int dy=-1; dy<=1; ++dy) {\n      n += texture2D(prevState, uv+vec2(dx,dy)/float(512)).r;\n    }\n    float s = texture2D(prevState, uv).r;\n    if(n > 3.0+s || n < 3.0) {\n      gl_FragColor = vec4(0,0,0,1);\n    } else {\n      gl_FragColor = vec4(1,1,1,1);\n    }\n  }",
framebuffer:function(b){return g[(b.tick+1)%2]}}),b=l({frag:"\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float state = texture2D(prevState, uv).r;\n    gl_FragColor = vec4(vec3(state), 1);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main() {\n    uv = 0.5 * (position + 1.0);\n    gl_Position = vec4(position, 0, 1);\n  }",attributes:{position:[-4,-4,4,-4,0,4]},uniforms:{prevState:function(b){return g[b.tick%
2].color[0]}},depth:{enable:!1},count:3});l.frame(function(){l.updateTimer();b(function(){l.draw();c()})})},{"../regl":33}],2:[function(d,k,z){function l(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}k.exports=function(n,g,c,b,f){n=c.maxAttributes;g=Array(n);for(c=0;c<n;++c)g[c]=new l;return{Record:l,scope:{},state:g}}},{}],3:[function(d,k,z){function l(b){return x[Object.prototype.toString.call(b)]|
0}function n(b,c){for(var f=0;f<c.length;++f)b[f]=c[f]}function g(b,f,c,n,l,g,a){for(var d=0,v=0;v<c;++v)for(var N=0;N<n;++N)b[d++]=f[l*v+g*N+a]}function c(b,f,c){for(var n=0,l=0;l<f.length;++l)for(var g=f[l],a=0;a<c;++a)b[n++]=g[a]}var b=d("./util/is-typed-array"),f=d("./util/is-ndarray"),r=d("./util/values"),t=d("./util/pool"),x=d("./constants/arraytypes.json"),B=d("./constants/dtypes.json"),E=d("./constants/usage.json");k.exports=function(d,k){function A(b){this.id=a++;this.buffer=d.createBuffer();
this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function q(b,f,c){b.byteLength=f.byteLength;d.bufferData(b.type,f,c)}function M(a,d,u,v,A){a.usage=u;if(Array.isArray(d))a.dtype=v||5126,0<d.length&&(Array.isArray(d[0])?(a.dimension=d[0].length,v=t.allocType(a.dtype,d.length*a.dimension),c(v,d,a.dimension),q(a,v,u),t.freeType(v)):"number"===typeof d[0]?(a.dimension=A,v=t.allocType(a.dtype,d.length),n(v,d),q(a,v,u),t.freeType(v)):b(d[0])&&(a.dimension=d[0].length,a.dtype=
v||l(d[0])||5126,v=t.allocType(a.dtype,d.length*a.dimension),c(v,d,a.dimension),q(a,v,u),t.freeType(v)));else if(b(d))a.dtype=v||l(d),a.dimension=A,q(a,d,u);else if(f(d)){var E=d.shape,D=d.stride;A=d.offset;var I=0,F=0,r=0,J=0;1===E.length?(I=E[0],F=1,r=D[0],J=0):2===E.length&&(I=E[0],F=E[1],r=D[0],J=D[1]);a.dtype=v||l(d.data)||5126;a.dimension=F;v=t.allocType(a.dtype,I*F);g(v,d.data,I,F,r,J,A);q(a,v,u);t.freeType(v)}}function u(b){k.bufferCount--;d.deleteBuffer(b.buffer);b.buffer=null;delete U[b.id]}
var a=0,U={};A.prototype.bind=function(){d.bindBuffer(this.type,this.buffer)};A.prototype.destroy=function(){u(this)};var v=[];return{create:function(a,v,q){function r(a){var c=35044,n=null,l=0,g=0,v=1;Array.isArray(a)||b(a)||f(a)?n=a:"number"===typeof a?l=a|0:a&&("data"in a&&(n=a.data),"usage"in a&&(c=E[a.usage]),"type"in a&&(g=B[a.type]),"dimension"in a&&(v=a.dimension|0),"length"in a&&(l=a.length|0));y.bind();n?M(y,n,c,g,v):(d.bufferData(y.type,l,c),y.dtype=g||5121,y.usage=c,y.dimension=v,y.byteLength=
l);return r}k.bufferCount++;var y=new A(v);U[y.id]=y;q||r(a);r._reglType="buffer";r._buffer=y;r.subdata=function(a,v){var u=(v||0)|0;y.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var q=t.allocType(y.dtype,a.length);n(q,a);d.bufferSubData(y.type,u,q);t.freeType(q)}else if(Array.isArray(a[0])||b(a[0])){var q=a[0].length,N=t.allocType(y.dtype,a.length*q);c(N,a,q);d.bufferSubData(y.type,u,N);t.freeType(N)}}else if(b(a))d.bufferSubData(y.type,u,a);else if(f(a)){var J=a.shape,A=
a.stride,E=N=q=0,k=0;1===J.length?(q=J[0],N=1,E=A[0],k=0):2===J.length&&(q=J[0],N=J[1],E=A[0],k=A[1]);J=Array.isArray(a.data)?y.dtype:l(a.data);J=t.allocType(J,q*N);g(J,a.data,q,N,E,k,a.offset);d.bufferSubData(y.type,u,J);t.freeType(J)}return r};r.destroy=function(){u(y)};return r},createStream:function(a,b){var c=v.pop();c||(c=new A(a),c.buffer=d.createBuffer());c.bind();M(c,b,35040,0,1);return c},destroyStream:function(a){v.push(a)},clear:function(){r(U).forEach(u)},getBuffer:function(a){return a&&
a._buffer instanceof A?a._buffer:null},_initBuffer:M}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(d,k,z){k.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,
"[object ArrayBuffer]":5121}},{}],5:[function(d,k,z){k.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(d,k,z){k.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(d,k,z){k.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(d,k,z){function l(a){return Array.isArray(a)||x(a)||B(a)}function n(a){return a.sort(function(a,
b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function g(a,b,c,f){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=f}function c(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function b(a){return new g(!1,!1,!1,a)}function f(a,b){var c=a.type;return 0===c?(c=a.data.length,new g(!0,1<=c,2<=c,b)):new g(3===c,2===c,1===c,b)}var r=d("./util/codegen"),t=d("./util/loop"),x=d("./util/is-typed-array"),B=d("./util/is-ndarray"),E=d("./util/is-array-like"),F=d("./constants/primitives.json"),
P=d("./constants/dtypes.json"),A=["x","y","z","w"],q={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},M={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,
"!=":517,"!==":517,gequal:518,">=":518,always:519},u={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},a={cw:2304,ccw:2305},U=new g(!1,!1,!1,function(){});k.exports=function(d,N,k,B,x,y,z,D,I,X,ba,J,ga,ma){function S(m){return m.replace(".","_")}function O(m,e,a){var b=S(m);Aa.push(m);ya[b]=p[b]=!!a;pa[b]=e}function K(m,e,a){var b=S(m);Aa.push(m);Array.isArray(a)?(p[b]=a.slice(),ya[b]=a.slice()):p[b]=ya[b]=a;qa[b]=e}function Y(){var m=
r(),e=m.link,a=m.global;m.id=Ka++;m.batchId="0";var b=e(Ia),w=m.shared={props:"a0"};Object.keys(Ia).forEach(function(h){w[h]=a.def(b,".",h)});var H=m.next={},c=m.current={};Object.keys(qa).forEach(function(h){Array.isArray(p[h])&&(H[h]=a.def(w.next,".",h),c[h]=a.def(w.current,".",h))});var h=m.constants={};Object.keys(R).forEach(function(m){h[m]=a.def(JSON.stringify(R[m]))});m.invoke=function(h,a){switch(a.type){case 0:var b=["this",w.context,w.props,m.batchId];return h.def(e(a.data),".call(",b.slice(0,
Math.max(a.data.length+1,4)),")");case 1:return h.def(w.props,a.data);case 2:return h.def(w.context,a.data);case 3:return h.def("this",a.data)}};m.attribCache={};var Ga={};m.scopeAttrib=function(h){h=N.id(h);if(h in Ga)return Ga[h];var m=X.scope[h];m||(m=X.scope[h]=new na);return Ga[h]=e(m)};return m}function ja(m){var e=m["static"];m=m.dynamic;if("framebuffer"in e){var a=e.framebuffer;return a?(a=D.getFramebuffer(a),b(function(m,e){var b=m.link(a),h=m.shared;e.set(h.framebuffer,".next",b);h=h.context;
e.set(h,".framebufferWidth",b+".width");e.set(h,".framebufferHeight",b+".height");return b})):b(function(m,e){var a=m.shared;e.set(a.framebuffer,".next","null");a=a.context;e.set(a,".framebufferWidth",a+".drawingBufferWidth");e.set(a,".framebufferHeight",a+".drawingBufferHeight");return"null"})}if("framebuffer"in m){var c=m.framebuffer;return f(c,function(m,a){var e=m.invoke(a,c),h=m.shared,b=h.framebuffer,e=a.def(b,".getFramebuffer(",e,")");a.set(b,".next",e);h=h.context;a.set(h,".framebufferWidth",
e+"?"+e+".width:"+h+".drawingBufferWidth");a.set(h,".framebufferHeight",e+"?"+e+".height:"+h+".drawingBufferHeight");return e})}return null}function ra(e,a){function b(h){if(h in c){var e=c[h];h=!0;var m=e.x|0,H=e.y|0,L,p;"width"in e?L=e.width|0:h=!1;"height"in e?p=e.height|0:h=!1;return new g(!h&&a&&a.thisDep,!h&&a&&a.contextDep,!h&&a&&a.propDep,function(h,a){var b=h.shared.context,G=L;"width"in e||(G=a.def(b,".","framebufferWidth","-",m));var c=p;"height"in e||(c=a.def(b,".","framebufferHeight",
"-",H));return[m,H,G,c]})}if(h in w){var d=w[h];h=f(d,function(h,a){var e=h.invoke(a,d),m=h.shared.context,b=a.def(e,".x|0"),G=a.def(e,".y|0"),Fa=a.def('"width" in ',e,"?",e,".width|0:","(",m,".","framebufferWidth","-",b,")"),e=a.def('"height" in ',e,"?",e,".height|0:","(",m,".","framebufferHeight","-",G,")");return[b,G,Fa,e]});a&&(h.thisDep=h.thisDep||a.thisDep,h.contextDep=h.contextDep||a.contextDep,h.propDep=h.propDep||a.propDep);return h}return a?new g(a.thisDep,a.contextDep,a.propDep,function(h,
a){var e=h.shared.context;return[0,0,a.def(e,".","framebufferWidth"),a.def(e,".","framebufferHeight")]}):null}var c=e["static"],w=e.dynamic,H=b("viewport");if(H)var p=H,H=new g(H.thisDep,H.contextDep,H.propDep,function(h,a){var e=p.append(h,a),m=h.shared.context;a.set(m,".viewportWidth",e[2]);a.set(m,".viewportHeight",e[3]);return e});return{viewport:H,scissor_box:b("scissor.box")}}function ta(a){function e(h){if(h in L){var a=N.id(L[h]);h=b(function(){return a});h.id=a;return h}if(h in p){var m=
p[h];return f(m,function(h,a){var e=h.invoke(a,m);return a.def(h.shared.strings,".id(",e,")")})}return null}var L=a["static"],p=a.dynamic,w=e("frag"),H=e("vert"),d=null;c(w)&&c(H)?(d=ba.program(H.id,w.id),a=b(function(h,a){return h.link(d)})):a=new g(w&&w.thisDep||H&&H.thisDep,w&&w.contextDep||H&&H.contextDep,w&&w.propDep||H&&H.propDep,function(h,a){var e=h.shared.shader,m;m=w?w.append(h,a):a.def(e,".","frag");var b;b=H?H.append(h,a):a.def(e,".","vert");return a.def(e+".program("+b+","+m+")")});return{frag:w,
vert:H,progVar:a,program:d}}function ka(a){function e(a,h){if(a in L){var m=L[a]|0;return b(function(a,e){h&&(a.OFFSET=m);return m})}if(a in p){var G=p[a];return f(G,function(a,e){var m=a.invoke(e,G);h&&(a.OFFSET=m);return m})}return h&&w?b(function(a,h){a.OFFSET="0";return 0}):null}var L=a["static"],p=a.dynamic,w=function(){if("elements"in L){var a=L.elements;l(a)?a=y.getElements(y.create(a)):a&&(a=y.getElements(a));var h=b(function(h,e){if(a){var m=h.link(a);return h.ELEMENTS=m}return h.ELEMENTS=
null});h.value=a;return h}if("elements"in p){var e=p.elements;return f(e,function(a,h){var m=a.shared,b=m.isBufferArgs,m=m.elements,G=a.invoke(h,e),c=h.def("null"),b=h.def(b,"(",G,")"),G=a.cond(b).then(c,"=",m,".createStream(",G,");")["else"](c,"=",m,".getElements(",G,");");h.entry(G);h.exit(a.cond(b).then(m,".destroyStream(",c,");"));return a.ELEMENTS=c})}return null}(),H=e("offset",!0);return{elements:w,primitive:function(){if("primitive"in L){var a=L.primitive;return b(function(h,e){return F[a]})}if("primitive"in
p){var h=p.primitive;return f(h,function(a,e){var m=a.constants.primTypes,b=a.invoke(e,h);return e.def(m,"[",b,"]")})}return w?c(w)?w.value?b(function(a,h){return h.def(a.ELEMENTS,".primType")}):b(function(){return 4}):new g(w.thisDep,w.contextDep,w.propDep,function(a,h){var e=a.ELEMENTS;return h.def(e,"?",e,".primType:",4)}):null}(),count:function(){if("count"in L){var a=L.count|0;return b(function(){return a})}if("count"in p){var h=p.count;return f(h,function(a,e){return a.invoke(e,h)})}return w?
c(w)?w?H?new g(H.thisDep,H.contextDep,H.propDep,function(a,h){return h.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):b(function(a,h){return h.def(a.ELEMENTS,".vertCount")}):b(function(){return-1}):new g(w.thisDep||H.thisDep,w.contextDep||H.contextDep,w.propDep||H.propDep,function(a,h){var e=a.ELEMENTS;return a.OFFSET?h.def(e,"?",e,".vertCount-",a.OFFSET,":-1"):h.def(e,"?",e,".vertCount:-1")}):null}(),instances:e("instances",!1),offset:H}}function sa(e){var G=e["static"],c=e.dynamic,p={};Aa.forEach(function(e){function m(a,
H){if(e in G){var Fa=a(G[e]);p[d]=b(function(){return Fa})}else if(e in c){var n=c[e];p[d]=f(n,function(a,e){return H(a,e,a.invoke(e,n))})}}var d=S(e);switch(e){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return m(function(a){return a},function(a,e,m){return m});case "depth.func":return m(function(a){return M[a]},function(a,e,m){return e.def(a.constants.compareFuncs,
"[",m,"]")});case "depth.range":return m(function(a){return a},function(a,e,m){a=e.def("+",m,"[0]");e=e.def("+",m,"[1]");return[a,e]});case "blend.func":return m(function(a){return[q["srcRGB"in a?a.srcRGB:a.src],q["dstRGB"in a?a.dstRGB:a.dst],q["srcAlpha"in a?a.srcAlpha:a.src],q["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,e,m){function b(a,h){var c=e.def('"',a,h,'" in ',m,"?",m,".",a,h,":",m,".",a);return e.def(G,"[",c,"]")}var G=a.constants.blendFuncs;a=b("src","RGB");var c=b("src","Alpha"),p=
b("dst","RGB"),H=b("dst","Alpha");return[a,p,c,H]});case "blend.equation":return m(function(a){if("string"===typeof a)return[ca[a],ca[a]];if("object"===typeof a)return[ca[a.rgb],ca[a.alpha]]},function(a,e,m){var b=a.constants.blendEquations,G=e.def(),c=e.def();a=a.cond("typeof ",m,'==="string"');a.then(G,"=",c,"=",b,"[",m,"];");a["else"](G,"=",b,"[",m,".rgb];",c,"=",b,"[",m,".alpha];");e(a);return[G,c]});case "blend.color":return m(function(a){return t(4,function(e){return+a[e]})},function(a,e,m){return t(4,
function(a){return e.def("+",m,"[",a,"]")})});case "stencil.mask":return m(function(a){return a|0},function(a,e,m){return e.def(m,"|0")});case "stencil.func":return m(function(a){return[M[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,e,m){a=e.def('"cmp" in ',m,"?",a.constants.compareFuncs,"[",m,".cmp]",":",7680);var b=e.def(m,".ref|0");e=e.def('"mask" in ',m,"?",m,".mask|0:-1");return[a,b,e]});case "stencil.opFront":case "stencil.opBack":return m(function(a){return["stencil.opBack"===
e?1029:1028,u[a.fail||"keep"],u[a.zfail||"keep"],u[a.pass||"keep"]]},function(a,m,b){function G(a){return m.def('"',a,'" in ',b,"?",c,"[",b,".",a,"]:",7680)}var c=a.constants.stencilOps;return["stencil.opBack"===e?1029:1028,G("fail"),G("zfail"),G("pass")]});case "polygonOffset.offset":return m(function(a){return[a.factor|0,a.units|0]},function(a,e,m){a=e.def(m,".factor|0");e=e.def(m,".units|0");return[a,e]});case "cull.face":return m(function(a){var e=0;"front"===a?e=1028:"back"===a&&(e=1029);return e},
function(a,e,m){return e.def(m,'==="front"?',1028,":",1029)});case "lineWidth":return m(function(a){return a},function(a,e,m){return m});case "frontFace":return m(function(e){return a[e]},function(a,e,m){return e.def(m+'==="cw"?2304:2305')});case "colorMask":return m(function(a){return a.map(function(a){return!!a})},function(a,e,m){return t(4,function(a){return"!!"+m+"["+a+"]"})});case "sample.coverage":return m(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,e,m){a=e.def('"value" in ',
m,"?+",m,".value:1");e=e.def("!!",m,".invert");return[a,e]})}});return p}function oa(a){var e=a["static"],c=a.dynamic,p={};Object.keys(e).forEach(function(a){var m=e[a],c;"number"===typeof m||"boolean"===typeof m?c=b(function(){return m}):"function"!==typeof m||"texture2d"!==m._reglType&&"textureCube"!==m._reglType?E(m)&&(c=b(function(a){return a.global.def("[",t(m.length,function(a){return m[a]}),"]")})):c=b(function(a){return a.link(m)});c.value=m;p[a]=c});Object.keys(c).forEach(function(a){var e=
c[a];p[a]=f(e,function(a,m){return a.invoke(m,e)})});return p}function Z(a){var e=a["static"],c=a.dynamic,p={};Object.keys(e).forEach(function(a){var m=e[a],c=N.id(a),h=new na;if(l(m))h.state=1,h.buffer=x.getBuffer(x.create(m,34962,!1)),h.type=h.buffer.dtype;else{var f=x.getBuffer(m);if(f)h.state=1,h.buffer=f,h.type=f.dtype;else if(m.constant){var d=m.constant;h.state=2;"number"===typeof d?h.x=d:A.forEach(function(a,e){e<d.length&&(h[a]=d[e])})}else{var f=x.getBuffer(m.buffer),L=m.offset|0,n=m.stride|
0,C=m.size|0,g=!!m.normalized,q=0;"type"in m&&(q=P[m.type]);m=m.divisor|0;h.buffer=f;h.state=1;h.size=C;h.normalized=g;h.type=q||f.dtype;h.offset=L;h.stride=n;h.divisor=m}}p[a]=b(function(a,e){var m=a.attribCache;if(c in m)return m[c];var b={isStream:!1};Object.keys(h).forEach(function(a){b[a]=h[a]});h.buffer&&(b.buffer=a.link(h.buffer));return m[c]=b})});Object.keys(c).forEach(function(a){var e=c[a];p[a]=f(e,function(a,m){function b(a){m(d[a],"=",c,".",a,"|0;")}var c=a.invoke(m,e),G=a.shared,p=G.isBufferArgs,
f=G.buffer,d={isStream:m.def(!1)},L=new na;L.state=1;Object.keys(L).forEach(function(a){d[a]=m.def(""+L[a])});var w=d.buffer,n=d.type;m("if(",p,"(",c,")){",d.isStream,"=true;",w,"=",f,".createStream(",34962,",",c,");",n,"=",w,".dtype;","}else{",w,"=",f,".getBuffer(",c,");","if(",w,"){",n,"=",w,".dtype;","}else if(",c,".constant){",d.state,"=",2,";",A.map(function(a,e){return d[a]+"="+c+".length>="+e+"?"+c+"["+e+"]:0;"}).join(""),"}else{",w,"=",f,".getBuffer(",c,".buffer);",n,'="type" in ',c,"?",G.glTypes,
"[",c,".type]:",w,".dtype;",d.normalized,"=!!",c,".normalized;");b("size");b("offset");b("stride");b("divisor");m("}}");return d})});return p}function ha(a){var e=a["static"],c=a.dynamic,p={};Object.keys(e).forEach(function(a){var m=e[a];p[a]=b(function(a,e){return"number"===typeof m||"boolean"===typeof m?""+m:a.link(m)})});Object.keys(c).forEach(function(a){var e=c[a];p[a]=f(e,function(a,m){return a.invoke(m,e)})});return p}function aa(a,e,b){var c=a.shared.context,p=a.scope();Object.keys(b).forEach(function(f){e.save(c,
"."+f);p(c,".",f,"=",b[f].append(a,e),";")});e(p)}function T(a,e,b){var c=a.shared,p=c.gl,f=c.framebuffer,d;C&&(d=e.def(c.extensions,".webgl_draw_buffers"));var h=a.constants,c=h.drawBuffer,h=h.backBuffer;a=b?b.append(a,e):e.def(f,".next");e("if(",f,".dirty||",a,"!==",f,".cur){","if(",a,"){",p,".bindFramebuffer(",36160,",",a,".framebuffer);");C&&e(d,".drawBuffersWEBGL(",c,"[",a,".colorAttachments.length]);");e("}else{",p,".bindFramebuffer(",36160,",null);");C&&e(d,".drawBuffersWEBGL(",h,");");e("}",
f,".cur=",a,";",f,".dirty=false;","}")}function V(a,e,b){var c=a.shared,f=c.gl,d=a.current,n=a.next,h=c.current,l=c.next,C=a.cond(h,".dirty");Aa.forEach(function(e){e=S(e);if(!(e in b.state)){var c,G;if(e in n){c=n[e];G=d[e];var g=t(p[e].length,function(a){return C.def(c,"[",a,"]")});C(a.cond(g.map(function(a,e){return a+"!=="+G+"["+e+"]"}).join("||")).then(f,".",qa[e],"(",g,");",g.map(function(a,e){return G+"["+e+"]="+a}).join(";"),";"))}else c=C.def(l,".",e),g=a.cond(c,"!==",h,".",e),C(g),e in pa?
g(a.cond(c).then(f,".enable(",pa[e],");")["else"](f,".disable(",pa[e],");"),h,".",e,"=",c,";"):g(f,".",qa[e],"(",c,");",h,".",e,"=",c,";")}});0===Object.keys(b.state).length&&C(h,".dirty=false;");e(C)}function da(a,e,b,p){var f=a.shared,d=a.current,C=f.current,h=f.gl;n(Object.keys(b)).forEach(function(f){var n=b[f];if(!p||p(n)){var l=n.append(a,e);if(pa[f]){var w=pa[f];c(n)?l?e(h,".enable(",w,");"):e(h,".disable(",w,");"):e(a.cond(l).then(h,".enable(",w,");")["else"](h,".disable(",w,");"));e(C,".",
f,"=",l,";")}else if(E(l)){var g=d[f];e(h,".",qa[f],"(",l,");",l.map(function(a,e){return g+"["+e+"]="+a}).join(";"),";")}else e(h,".",qa[f],"(",l,");",C,".",f,"=",l,";")}})}function ua(a,b){e&&!a.instancing&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function Ba(a,e,b){b=a.stats;a=a.shared;ma&&e(a.timer,".beginQuery(",b,");")}function la(a,e,b){a=a.shared;ma&&e(a.timer,".endQuery();")}function ea(a,b,c,f,p){function d(a){switch(a){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function n(c,f,p){function d(){b("if(!",w,".pointer){",C,".enableVertexAttribArray(",L,");",w,".pointer=true;}");var c=p.type,h;h=p.size?b.def(p.size,"||",f):f;b("if(",w,".type!==",c,"||",w,".size!==",h,"||",q.map(function(a){return w+"."+a+"!=="+p[a]}).join("||"),"){",C,".bindBuffer(",34962,",",g,".buffer);",C,".vertexAttribPointer(",[L,h,c,p.normalized,p.stride,p.offset],");",w,".type=",c,";",w,
".size=",h,";",q.map(function(a){return w+"."+a+"="+p[a]+";"}).join(""),"}");e&&(c=p.divisor,b("if(",w,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[L,c],");",w,".divisor=",c,";}"))}function l(){b("if(",w,".pointer){",C,".disableVertexAttribArray(",L,");",w,".pointer=false;","}if(",A.map(function(a,e){return w+"."+a+"!=="+H[e]}).join("||"),"){",C,".vertexAttrib4f(",L,",",H,");",A.map(function(a,e){return w+"."+a+"="+H[e]+";"}).join(""),"}")}var C=h.gl,L=b.def(c,".location"),w=b.def(h.attributes,
"[",L,"]");c=p.state;var g=p.buffer,H=[p.x,p.y,p.z,p.w],q=["buffer","normalized","offset","stride"];1===c?d():2===c?l():(b("if(",c,"===",1,"){"),d(),b("}else{"),l(),b("}"))}var h=a.shared;f.forEach(function(e){var h=e.name,f=c.attributes[h],C;if(f){if(!p(f))return;C=f.append(a,b)}else{if(!p(U))return;var l=a.scopeAttrib(h);C={};Object.keys(new na).forEach(function(a){C[a]=b.def(l,".",a)})}n(a.link(e),d(e.info.type),C)})}function fa(a,e,b,p,f){for(var d=a.shared,n=d.gl,h,C=0;C<p.length;++C){var l=
p[C],g=l.name,q=l.info.type,D=b.uniforms[g],l=a.link(l)+".location",u;if(D){if(!f(D))continue;if(c(D)){g=D.value;if(35678===q||35680===q)q=a.link(g._texture),e(n,".uniform1i(",l,",",q+".bind());"),e.exit(q,".unbind();");else if(35674===q||35675===q||35676===q)g=a.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),D=2,35675===q?D=3:35676===q&&(D=4),e(n,".uniformMatrix",D,"fv(",l,",false,",g,");");else{switch(q){case 5126:h="1f";break;case 35664:h="2f";break;case 35665:h="3f";break;
case 35666:h="4f";break;case 35670:h="1i";break;case 5124:h="1i";break;case 35671:h="2i";break;case 35667:h="2i";break;case 35672:h="3i";break;case 35668:h="3i";break;case 35673:h="4i";break;case 35669:h="4i"}e(n,".uniform",h,"(",l,",",E(g)?Array.prototype.slice.call(g):g,");")}continue}else u=D.append(a,e)}else{if(!f(U))continue;u=e.def(d.uniforms,"[",N.id(g),"]")}g=1;switch(q){case 35678:case 35680:q=e.def(u,"._texture");e(n,".uniform1i(",l,",",q,".bind());");e.exit(q,".unbind();");continue;case 5124:case 35670:h=
"1i";break;case 35667:case 35671:h="2i";g=2;break;case 35668:case 35672:h="3i";g=3;break;case 35669:case 35673:h="4i";g=4;break;case 5126:h="1f";break;case 35664:h="2f";g=2;break;case 35665:h="3f";g=3;break;case 35666:h="4f";g=4;break;case 35674:h="Matrix2fv";break;case 35675:h="Matrix3fv";break;case 35676:h="Matrix4fv"}e(n,".uniform",h,"(",l,",");if("M"===h.charAt(0)){var l=Math.pow(q-35674+2,2),r=a.global.def("new Float32Array(",l,")");e("false,(Array.isArray(",u,")||",u," instanceof Float32Array)?",
u,":(",t(l,function(a){return r+"["+a+"]="+u+"["+a+"]"}),",",r,")")}else 1<g?e(t(g,function(a){return u+"["+a+"]"})):e(u);e(");")}}function za(a,b,p,f){function d(e){var c=q[e];return c?c.contextDep&&f.contextDynamic||c.propDep?c.append(a,p):c.append(a,b):b.def(g,".",e)}function l(){function a(){p(v,".drawElementsInstancedANGLE(",[u,A,J,r+"<<(("+J+"-5121)>>1)",E],");")}function e(){p(v,".drawArraysInstancedANGLE(",[u,r,A,E],");")}D?k?a():(p("if(",D,"){"),a(),p("}else{"),e(),p("}")):e()}function n(){function a(){p(C+
".drawElements("+[u,A,J,r+"<<(("+J+"-5121)>>1)"]+");")}function e(){p(C+".drawArrays("+[u,r,A]+");")}D?k?a():(p("if(",D,"){"),a(),p("}else{"),e(),p("}")):e()}var h=a.shared,C=h.gl,g=h.draw,q=f.draw,D=function(){var e=q.elements,c=b;if(e){if(e.contextDep&&f.contextDynamic||e.propDep)c=p;e=e.append(a,c)}else e=c.def(g,".","elements");e&&c("if("+e+")"+C+".bindBuffer(34963,"+e+".buffer.buffer);");return e}(),u=d("primitive"),r=d("offset"),A=function(){var e=q.count,c=b;if(e){if(e.contextDep&&f.contextDynamic||
e.propDep)c=p;e=e.append(a,c)}else e=c.def(g,".","count");return e}();if("number"===typeof A){if(0===A)return}else p("if(",A,"){"),p.exit("}");var E,v;e&&(E=d("instances"),v=a.instancing);var J=D+".type",k=q.elements&&c(q.elements);e&&("number"!==typeof E||0<=E)?"string"===typeof E?(p("if(",E,">0){"),l(),p("}else if(",E,"<0){"),n(),p("}")):l():n()}function wa(a,b,c,p,f){b=Y();f=b.proc("body",f);e&&(b.instancing=f.def(b.shared.extensions,".angle_instanced_arrays"));a(b,f,c,p);return b.compile().body}
function Ca(a,e,b,c){ua(a,e);ea(a,e,b,c.attributes,function(){return!0});fa(a,e,b,c.uniforms,function(){return!0});za(a,e,e,b)}function Da(a,e){var b=a.proc("draw",1);ua(a,b);aa(a,b,e.context);T(a,b,e.framebuffer);V(a,b,e);da(a,b,e.state);Ba(a,b,e);var c=e.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",c,".program);");if(e.shader.program)Ca(a,b,e,e.shader.program);else{var p=a.global.def("{}"),f=b.def(c,".id"),d=b.def(p,"[",f,"]");b(a.cond(d).then(d,".call(this,a0);")["else"](d,"=",p,"[",
f,"]=",a.link(function(b){return wa(Ca,a,e,b,1)}),"(",c,");",d,".call(this,a0);"))}0<Object.keys(e.state).length&&b(a.shared.current,".dirty=true;");la(a,b,e)}function Ea(a,e,b,c){function p(){return!0}a.batchId="a1";ua(a,e);ea(a,e,b,c.attributes,p);fa(a,e,b,c.uniforms,p);za(a,e,e,b)}function va(a,e,b,c){function p(a){return a.contextDep&&d||a.propDep}function f(a){return!p(a)}ua(a,e);var d=b.contextDep,h=e.def(),l=e.def();a.shared.props=l;a.batchId=h;var n=a.scope(),C=a.scope();e(n.entry,"for(",
h,"=0;",h,"<","a1",";++",h,"){",l,"=","a0","[",h,"];",C,"}",n.exit);b.needsContext&&aa(a,C,b.context);b.needsFramebuffer&&T(a,C,b.framebuffer);da(a,C,b.state,p);c?(ea(a,n,b,c.attributes,f),ea(a,C,b,c.attributes,p),fa(a,n,b,c.uniforms,f),fa(a,C,b,c.uniforms,p),za(a,n,C,b)):(e=a.global.def("{}"),c=b.shader.progVar.append(a,C),l=C.def(c,".id"),n=C.def(e,"[",l,"]"),C(a.shared.gl,".useProgram(",c,".program);","if(!",n,"){",n,"=",e,"[",l,"]=",a.link(function(e){return wa(Ea,a,b,e,2)}),"(",c,");}",n,".call(this,a0[",
h,"],",h,");"))}function Ha(a,e){var b=a.proc("batch",2);a.batchId="0";ua(a,b);var c=!1,p=!0;Object.keys(e.context).forEach(function(a){c=c||e.context[a].propDep});c||(aa(a,b,e.context),p=!1);var f=e.framebuffer,d=!1;f?(f.propDep?c=d=!0:f.contextDep&&c&&(d=!0),d||T(a,b,f)):T(a,b,null);e.state.viewport&&e.state.viewport.propDep&&(c=!0);V(a,b,e);da(a,b,e.state,function(a){return!(a.contextDep&&c||a.propDep)});Ba(a,b,e);e.contextDep=c;e.needsContext=p;e.needsFramebuffer=d;p=e.shader.progVar;if(p.contextDep&&
c||p.propDep)va(a,b,e,null);else if(p=p.append(a,b),b(a.shared.gl,".useProgram(",p,".program);"),e.shader.program)va(a,b,e,e.shader.program);else{var f=a.global.def("{}"),d=b.def(p,".id"),h=b.def(f,"[",d,"]");b(a.cond(h).then(h,".call(this,a0,a1);")["else"](h,"=",f,"[",d,"]=",a.link(function(b){return wa(va,a,e,b,2)}),"(",p,");",h,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&b(a.shared.current,".dirty=true;");la(a,b,e)}function xa(a,e){function b(h){var f=e.shader[h];f&&c.set(p.shader,"."+
h,f.append(a,c))}var c=a.proc("scope",3);a.batchId="a2";var p=a.shared,f=p.current,d=p.timer,h;ma&&(h=c.def(d,".getNumPendingQueries()"));aa(a,c,e.context);e.framebuffer&&e.framebuffer.append(a,c);n(Object.keys(e.state)).forEach(function(b){var h=e.state[b].append(a,c);E(h)?h.forEach(function(e,p){c.set(a.next[b],"["+p+"]",e)}):c.set(p.next,"."+b,h)});["elements","offset","count","instances","primitive"].forEach(function(b){var h=e.draw[b];h&&c.set(p.draw,"."+b,""+h.append(a,c))});Object.keys(e.uniforms).forEach(function(b){c.set(p.uniforms,
"["+N.id(b)+"]",e.uniforms[b].append(a,c))});Object.keys(e.attributes).forEach(function(b){var p=e.attributes[b].append(a,c),h=a.scopeAttrib(b);Object.keys(new na).forEach(function(a){c.set(h,"."+a,p[a])})});b("vert");b("frag");0<Object.keys(e.state).length&&(c(f,".dirty=true;"),c.exit(f,".dirty=true;"));c("a1(",a.shared.context,",a0,0);");if(ma){var C=a.stats,f=c.def(d,".getNumPendingQueries()-1");c(d,".pushScopeStats(",h,",",f,",",C,");")}}var na=X.Record,ca={add:32774,subtract:32778,"reverse subtract":32779};
k.ext_blend_minmax&&(ca.min=32775,ca.max=32776);var e=k.angle_instanced_arrays,C=k.webgl_draw_buffers,p={dirty:!0},ya={},Aa=[],pa={},qa={};O("dither",3024);O("blend.enable",3042);K("blend.color","blendColor",[0,0,0,0]);K("blend.equation","blendEquationSeparate",[32774,32774]);K("blend.func","blendFuncSeparate",[1,0,1,0]);O("depth.enable",2929,!0);K("depth.func","depthFunc",513);K("depth.range","depthRange",[0,1]);K("depth.mask","depthMask",!0);K("colorMask","colorMask",[!0,!0,!0,!0]);O("cull.enable",
2884);K("cull.face","cullFace",1029);K("frontFace","frontFace",2305);K("lineWidth","lineWidth",1);O("polygonOffset.enable",32823);K("polygonOffset.offset","polygonOffset",[0,0]);O("sample.alpha",32926);O("sample.enable",32928);K("sample.coverage","sampleCoverage",[1,!1]);O("stencil.enable",2960);K("stencil.mask","stencilMask",-1);K("stencil.func","stencilFunc",[519,0,-1]);K("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);K("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);O("scissor.enable",
3089);K("scissor.box","scissor",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);K("viewport","viewport",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);var Ia={gl:d,context:ga,strings:N,next:ya,current:p,draw:J,elements:y,buffer:x,shader:ba,attributes:X.state,uniforms:I,framebuffer:D,extensions:k,timer:ma,isBufferArgs:l},R={primTypes:F,compareFuncs:M,blendFuncs:q,blendEquations:ca,stencilOps:u,glTypes:P,orientationType:a};C&&(R.backBuffer=[1029],R.drawBuffer=t(B.maxDrawbuffers,function(a){return 0===
a?[0]:t(a,function(a){return 36064+a})}));var Ka=0;return{next:ya,current:p,procs:function(){var a=Y(),e=a.proc("poll"),b=a.proc("refresh"),c=a.block();e(c);b(c);var f=a.shared,d=f.gl,C=f.next,h=f.current;c(h,".dirty=false;");T(a,e);b(f.framebuffer,".dirty=true;");T(a,b);Object.keys(pa).forEach(function(p){var f=pa[p],n=c.def(C,".",p),l=a.block();l("if(",n,"){",d,".enable(",f,")}else{",d,".disable(",f,")}",h,".",p,"=",n,";");b(l);e("if(",n,"!==",h,".",p,"){",l,"}")});Object.keys(qa).forEach(function(f){var n=
qa[f],l=p[f],g,q,D=a.block();D(d,".",n,"(");E(l)?(n=l.length,g=a.global.def(C,".",f),q=a.global.def(h,".",f),D(t(n,function(a){return g+"["+a+"]"}),");",t(n,function(a){return q+"["+a+"]="+g+"["+a+"];"}).join("")),e("if(",t(n,function(a){return g+"["+a+"]!=="+q+"["+a+"]"}).join("||"),"){",D,"}")):(g=c.def(C,".",f),q=c.def(h,".",f),D(g,");",h,".",f,"=",g,";"),e("if(",g,"!==",q,"){",D,"}"));b(D)});return a.compile()}(),compile:function(a,e,b,c,p){var f=Y();f.stats=f.link(p);p=ja(a);var d=ra(a,p),h=
ka(a),n=sa(a);a=ta(a);var C=d.viewport;C&&(n.viewport=C);C=S("scissor.box");(d=d[C])&&(n[C]=d);d=0<Object.keys(n).length;p={framebuffer:p,draw:h,shader:a,state:n,dirty:d};p.uniforms=oa(b);p.attributes=Z(e);p.context=ha(c);Da(f,p);xa(f,p);Ha(f,p);return f.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(d,k,z){function l(b,f){this.id=c++;this.type=
b;this.data=f}function n(b){if(0===b.length)return[];var c=b.charAt(0),d=b.charAt(b.length-1);if(1<b.length&&c===d&&('"'===c||"'"===c))return['"'+b.substr(1,b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(c=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return n(b.substr(0,c.index)).concat(n(c[1])).concat(n(b.substr(c.index+c[0].length)));c=b.split(".");if(1===c.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(d=0;d<c.length;++d)b=b.concat(n(c[d]));return b}
function g(b){return"["+n(b).join("][")+"]"}var c=0;k.exports={define:function(b,c){switch(typeof c){case "boolean":case "number":case "string":return new l(b,g(c+""));case "undefined":return new l(b|128,null)}},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof l},unbox:function(b,c){if(b instanceof l){if(b.type&128)return new l(b.type&-129,g(c))}else if("function"===typeof b)return new l(0,b);return b},accessor:g}},{}],10:[function(d,k,z){var l=d("./util/is-typed-array"),
n=d("./util/is-ndarray"),g=d("./util/values"),c=d("./constants/primitives.json"),b=d("./constants/usage.json");k.exports=function(f,d,k,x){function B(b){this.id=A++;P[this.id]=this;this.buffer=b;this.primType=4;this.type=this.vertCount=0}function E(b,a,c,f,g,q,E){(q=E)||l(a)&&(!n(a)||l(a.data))||(q=d.oes_element_index_uint?5125:5123);b.buffer.bind();k._initBuffer(b.buffer,a,c,q,3);a=E;if(!E){switch(b.buffer.dtype){case 5121:case 5120:a=5121;break;case 5123:case 5122:a=5123;break;case 5125:case 5124:a=
5125}b.buffer.dtype=a}b.type=a;0>g&&(g=b.buffer.byteLength,5123===a?g>>=1:5125===a&&(g>>=2));b.vertCount=g;g=f;0>f&&(g=4,f=b.buffer.dimension,1===f&&(g=0),2===f&&(g=1),3===f&&(g=4));b.primType=g}function F(b){x.elementsCount--;delete P[b.id];b.buffer.destroy();b.buffer=null}var P={},A=0,q={uint8:5121,uint16:5123};d.oes_element_index_uint&&(q.uint32=5125);B.prototype.bind=function(){this.buffer.bind()};var M=[];return{create:function(d){function a(d){if(d)if("number"===typeof d)g(d),A.primType=4,A.vertCount=
d|0,A.type=5121;else{var u=null,k=35044,r=-1,F=-1,t=0,D=0;Array.isArray(d)||l(d)||n(d)?u=d:("data"in d&&(u=d.data),"usage"in d&&(k=b[d.usage]),"primitive"in d&&(r=c[d.primitive]),"count"in d&&(F=d.count|0),"length"in d&&(t=d.length|0),"type"in d&&(D=q[d.type]));u?E(A,u,k,r,F,t,D):(d=A.buffer,d.bind(),f.bufferData(34963,t,k),d.dtype=D||5121,d.usage=k,d.dimension=3,d.byteLength=t,A.primType=0>r?4:r,A.vertCount=0>F?0:F,A.type=d.dtype)}else g(),A.primType=4,A.vertCount=0,A.type=5121;return a}var g=k.create(null,
34963,!0),A=new B(g._buffer);x.elementsCount++;a(d);a._reglType="elements";a._elements=A;a.subdata=function(b,c){g.subdata(b,c);return a};a.destroy=function(){F(A)};return a},createStream:function(b){var a=M.pop();a||(a=new B(k.create(null,34963,!0)._buffer));E(a,b,35040,-1,-1,0,0);return a},destroyStream:function(b){M.push(b)},getElements:function(b){return"function"===typeof b&&b._elements instanceof B?b._elements:null},clear:function(){g(P).forEach(F)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,
"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(d,k,z){k.exports=function(d){function n(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb ext_disjoint_timer_query angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(c){try{g[c]=
d.getExtension(c)}catch(b){}})}var g={};n();return{extensions:g,refresh:n}}},{}],12:[function(d,k,z){var l=d("./util/values"),n=d("./util/extend");k.exports=function(d,c,b,f,k,t){function x(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height);this.width=a;this.height=d}function B(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function E(a,b,c){a&&(a.texture?a.texture._texture.refCount+=
1:a.renderbuffer._renderbuffer.refCount+=1)}function F(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function P(a){var b=3553,c=null,d=null,f=a;"object"===typeof a&&(f=a.data);a=f._reglType;"texture2d"===a?c=f:"textureCube"===a?c=f:"renderbuffer"===a&&(d=f,b=36161);return new x(b,c,d)}function A(a,b,c,d,n){if(c)return a=f.create2D({width:a,
height:b,format:d,type:n}),a._texture.refCount=0,new x(3553,a,null);a=k.create({width:a,height:b,format:d});a._renderbuffer.refCount=0;return new x(36161,null,a)}function q(a){return a&&(a.texture||a.renderbuffer)}function M(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function u(){this.id=y++;ia[this.id]=this;this.framebuffer=d.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=
null}function a(a){a.colorAttachments.forEach(B);B(a.depthAttachment);B(a.stencilAttachment);B(a.depthStencilAttachment)}function U(a){d.deleteFramebuffer(a.framebuffer);a.framebuffer=null;t.framebufferCount--;delete ia[a.id]}function v(a){var c;d.bindFramebuffer(36160,a.framebuffer);var f=a.colorAttachments;for(c=0;c<f.length;++c)F(36064+c,f[c]);for(c=f.length;c<b.maxColorAttachments;++c)F(36064+c,null);F(36096,a.depthAttachment);F(36128,a.stencilAttachment);F(33306,a.depthStencilAttachment);d.checkFramebufferStatus(36160);
d.bindFramebuffer(36160,z.next);z.current=z.next}var z={current:null,next:null,dirty:!1},Ja=["rgba"],Q=["rgba4","rgb565","rgb5 a1"];c.ext_srgb&&Q.push("srgba");c.ext_color_buffer_half_float&&Q.push("rgba16f","rgb16f");c.webgl_color_buffer_float&&Q.push("rgba32f");var W=["uint8"];c.oes_texture_half_float&&W.push("half float");c.oes_texture_float&&W.push("float");var y=0,ia={};return n(z,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof
u)?a:null},create:function(b,d){function f(b,d){var l,g=0,k=0,r=!0,F=!0;l=null;var u=!0,t="rgba",M="uint8",x=1,B=null,z=null,U=null,D=!1;if("number"===typeof b)g=b|0,k=d|0||g;else if(b){"shape"in b?(k=b.shape,g=k[0],k=k[1]):("radius"in b&&(g=k=b.radius),"width"in b&&(g=b.width),"height"in b&&(k=b.height));if("color"in b||"colors"in b)l=b.color||b.colors,Array.isArray(l);l||("colorCount"in b&&(x=b.colorCount|0),"colorTexture"in b&&(u=!!b.colorTexture,t="rgba4"),"colorType"in b&&(M=b.colorType,u||("half float"===
M?c.ext_color_buffer_half_float&&(t="rgba16f"):"float"===M&&c.webgl_color_buffer_float&&(t="rgba32f"))),"colorFormat"in b&&(t=b.colorFormat,0<=Ja.indexOf(t)?u=!0:0<=Q.indexOf(t)&&(u=!1)));if("depthTexture"in b||"depthStencilTexture"in b)D=!(!b.depthTexture&&!b.depthStencilTexture);"depth"in b&&("boolean"===typeof b.depth?r=b.depth:(B=b.depth,F=!1));"stencil"in b&&("boolean"===typeof b.stencil?F=b.stencil:(z=b.stencil,r=!1));"depthStencil"in b&&("boolean"===typeof b.depthStencil?r=F=b.depthStencil:
(U=b.depthStencil,F=r=!1))}else g=k=1;var y=null,I=null,N=null,da=null;if(Array.isArray(l))y=l.map(P);else if(l)y=[P(l)];else for(y=Array(x),l=0;l<x;++l)y[l]=A(g,k,u,t,M);g=g||y[0].width;k=k||y[0].height;B?I=P(B):r&&!F&&(I=A(g,k,D,"depth","uint32"));z?N=P(z):F&&!r&&(N=A(g,k,!1,"stencil","uint8"));U?da=P(U):!B&&!z&&F&&r&&(da=A(g,k,D,"depth stencil","depth stencil"));for(l=0;l<y.length;++l)E(y[l],g,k);E(I,g,k);E(N,g,k);E(da,g,k);a(n);n.width=g;n.height=k;n.colorAttachments=y;n.depthAttachment=I;n.stencilAttachment=
N;n.depthStencilAttachment=da;f.color=y.map(q);f.depth=q(I);f.stencil=q(N);f.depthStencil=q(da);f.width=n.width;f.height=n.height;v(n);return f}var n=new u;t.framebufferCount++;f(b,d);f.resize=function(a,b){var c=a|0,d=b|0||c;if(c===n.width&&d===n.height)return f;for(var l=n.colorAttachments,g=0;g<l.length;++g)M(l[g],c,d);M(n.depthAttachment,c,d);M(n.stencilAttachment,c,d);M(n.depthStencilAttachment,c,d);n.width=f.width=c;n.height=f.height=d;v(n);return f};f._reglType="framebuffer";f._framebuffer=
n;f.destroy=function(){U(n);a(n)};return f},clear:function(){l(ia).forEach(U)}})}},{"./util/extend":23,"./util/values":31}],13:[function(d,k,z){k.exports=function(d,n){var g=1;n.ext_texture_filter_anisotropic&&(g=d.getParameter(34047));var c=1,b=1;n.webgl_draw_buffers&&(c=d.getParameter(34852),b=d.getParameter(36063));return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),subpixelBits:d.getParameter(3408),
extensions:Object.keys(n).filter(function(b){return!!n[b]}),maxAnisotropic:g,maxDrawbuffers:c,maxColorAttachments:b,pointSizeDims:d.getParameter(33901),lineWidthDims:d.getParameter(33902),maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),maxVertexTextureUnits:d.getParameter(35660),
maxVaryingVectors:d.getParameter(36348),maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),renderer:d.getParameter(7937),vendor:d.getParameter(7936),version:d.getParameter(7938)}}},{}],14:[function(d,k,z){var l=d("./util/is-typed-array");k.exports=function(d,g,c){return function(b){var f=0,k=0,t=c.framebufferWidth,x=c.framebufferHeight,B=null;l(b)?B=b:2===arguments.length?(t=arguments[0]|0,x=arguments[1]|0):b&&(f=b.x|0,k=b.y|0,t=b.width||c.framebufferWidth,x=b.height||c.framebufferHeight,
B=b.data||null);g();B=B||new Uint8Array(t*x*4);d.pixelStorei(3333,4);d.readPixels(f,k,t,x,6408,5121,B);return B}}},{"./util/is-typed-array":26}],15:[function(d,k,z){var l=d("./util/values");k.exports=function(d,g,c,b){function f(b){this.id=x++;this.refCount=1;this.renderbuffer=b;this.format=32854;this.height=this.width=0}function k(c){var f=c.renderbuffer;d.bindRenderbuffer(36161,null);d.deleteRenderbuffer(f);c.renderbuffer=null;c.refCount=0;delete B[c.id];b.renderbufferCount--}var t={rgba4:32854,
rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};g.ext_srgb&&(t.srgba=35907);g.ext_color_buffer_half_float&&(t.rgba16f=34842,t.rgb16f=34843);g.webgl_color_buffer_float&&(t.rgba32f=34836);var x=0,B={};f.prototype.decRef=function(){0>=--this.refCount&&k(this)};return{create:function(c,g){function l(b,c){var f=0,a=0,g=32854;"object"===typeof b&&b?("shape"in b?(a=b.shape,f=a[0]|0,a=a[1]|0):("radius"in b&&(f=a=b.radius|0),"width"in b&&(f=b.width|0),"height"in b&&(a=b.height|
0)),"format"in b&&(g=t[b.format])):"number"===typeof b?(f=b|0,a="number"===typeof c?c|0:f):b||(f=a=1);if(f!==k.width||a!==k.height||g!==k.format)return l.width=k.width=f,l.height=k.height=a,k.format=g,d.bindRenderbuffer(36161,k.renderbuffer),d.renderbufferStorage(36161,g,f,a),l}var k=new f(d.createRenderbuffer());B[k.id]=k;b.renderbufferCount++;l(c,g);l.resize=function(b,c){var f=b|0,a=c|0||f;if(f===k.width&&a===k.height)return l;l.width=k.width=f;l.height=k.height=a;d.bindRenderbuffer(36161,k.renderbuffer);
d.renderbufferStorage(36161,k.format,f,a);return l};l._reglType="renderbuffer";l._renderbuffer=k;l.destroy=function(){k.decRef()};return l},clear:function(){l(B).forEach(k)}}}},{"./util/values":31}],16:[function(d,k,z){var l=d("./util/values");k.exports=function(d,g,c){function b(b,c,d,f){this.name=b;this.id=c;this.location=d;this.info=f}function f(b,c){for(var d=0;d<b.length;++d)if(b[d].id===c.id){b[d].location=c.location;return}b.push(c)}function k(b,c,f){f=35632===b?x:B;var l=f[c];if(!l){var a=
g.str(c),l=d.createShader(b);d.shaderSource(l,a);d.compileShader(l);f[c]=l}return l}function t(b,c){this.id=z++;this.fragId=b;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[]}var x={},B={},E={},F=[],z=0;return{clear:function(){var b=d.deleteShader.bind(d);l(x).forEach(b);x={};l(B).forEach(b);B={};F.forEach(function(b){d.deleteProgram(b.program)});F.length=0;E={};c.shaderCount=0},program:function(l,q,B){c.shaderCount++;(B=E[q])||(B=E[q]={});var u=B[l];if(!u){var a=u=new t(q,l),x,
v;x=k(35632,a.fragId);v=k(35633,a.vertId);q=a.program=d.createProgram();d.attachShader(q,x);d.attachShader(q,v);d.linkProgram(q);var z=d.getProgramParameter(q,35718),P=a.uniforms;for(x=0;x<z;++x)if(v=d.getActiveUniform(q,x))if(1<v.size)for(var Q=0;Q<v.size;++Q){var W=v.name.replace("[0]","["+Q+"]");f(P,new b(W,g.id(W),d.getUniformLocation(q,W),v))}else f(P,new b(v.name,g.id(v.name),d.getUniformLocation(q,v.name),v));z=d.getProgramParameter(q,35721);a=a.attributes;for(x=0;x<z;++x)(v=d.getActiveAttrib(q,
x))&&f(a,new b(v.name,g.id(v.name),d.getAttribLocation(q,v.name),v));B[l]=u;F.push(u)}return u},shader:k,frag:null,vert:null}}},{"./util/values":31}],17:[function(d,k,z){k.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(d,k,z){k.exports=function(){var d={"":0},n=[""];return{id:function(g){var c=d[g];if(c)return c;c=d[g]=n.length;n.push(g);return c},str:function(d){return n[d]}}}},{}],19:[function(d,
k,z){function l(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function n(a){return Array.isArray(a)&&0!==a.length&&F(a[0])?!0:!1}function g(a){return Object.prototype.toString.call(a)}function c(a){if(!a)return!1;var b=g(a);return 0<=u.indexOf(b)?!0:l(a)||n(a)||x(a)}function b(a,b){36193===a.type?(a.data=E(b),B.freeType(b)):a.data=b}var f=d("./util/extend"),r=d("./util/values"),t=d("./util/is-typed-array"),x=d("./util/is-ndarray"),B=d("./util/pool"),E=d("./util/to-half-float"),
F=d("./util/is-array-like");z=d("./constants/arraytypes.json");var P=d("./constants/arraytypes.json"),A=[9984,9986,9985,9987],q=[0,6409,6410,6407,6408],M={};M[6409]=M[6406]=M[6402]=1;M[34041]=M[6410]=2;M[6407]=3;M[6408]=4;var u=Object.keys(z).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);k.exports=function(a,d,k,u,z,Q){function W(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=
this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function y(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function ia(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=
b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=Ba[b.colorSpace]);"type"in b&&(a.type=la[b.type]);var c=a.width,d=a.height,f=a.channels,g=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(f=b.shape[2],g=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(f=b.channels,g=!0));a.width=c|0;a.height=d|0;a.channels=f|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=ea[c],a.format=Ca[d],c in la&&
!("type"in b)&&(a.type=la[c]),c in fa&&(a.compressed=!0),c=!0);!g&&c?a.channels=M[a.format]:g&&!c&&a.channels!==q[a.format]&&(a.format=a.internalformat=q[a.channels])}}function D(b){a.pixelStorei(37440,b.flipY);a.pixelStorei(37441,b.premultiplyAlpha);a.pixelStorei(37443,b.colorSpace);a.pixelStorei(3317,b.unpackAlignment)}function I(){W.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function X(a,d){var f=null;c(d)?f=d:d&&(ia(a,d),"x"in d&&
(a.xOffset=d.x|0),"y"in d&&(a.yOffset=d.y|0),c(d.data)&&(f=d.data));if(d.copy){var k=z.viewportWidth,r=z.viewportHeight;a.width=a.width||k-a.xOffset;a.height=a.height||r-a.yOffset;a.needsCopy=!0}else if(!f)a.width=a.width||1,a.height=a.height||1;else if(t(f))a.data=f,"type"in d||5121!==a.type||(a.type=P[Object.prototype.toString.call(f)]|0);else if(l(f)){k=f;r=a.width*a.height*a.channels;switch(a.type){case 5121:case 5123:case 5125:case 5126:r=B.allocType(a.type,r);r.set(k);a.data=r;break;case 36193:a.data=
E(k)}a.alignment=1;a.needsFree=!0}else if(x(f)){k=f.data;Array.isArray(k)||5121!==a.type||(a.type=P[Object.prototype.toString.call(k)]|0);var r=f.shape,A=f.stride,u,v,R,y;3===r.length?(R=r[2],y=A[2]):y=R=1;u=r[0];v=r[1];r=A[0];A=A[1];a.alignment=1;a.width=u;a.height=v;a.channels=R;a.format=a.internalformat=q[R];a.needsFree=!0;u=y;f=f.offset;R=a.width;y=a.height;v=a.channels;for(var m=B.allocType(36193===a.type?5126:a.type,R*y*v),G=0,L=0;L<y;++L)for(var D=0;D<R;++D)for(var w=0;w<v;++w)m[G++]=k[r*D+
A*L+u*w+f];b(a,m)}else if("[object HTMLCanvasElement]"===g(f)||"[object CanvasRenderingContext2D]"===g(f))"[object HTMLCanvasElement]"===g(f)?a.element=f:a.element=f.canvas,a.width=a.element.width,a.height=a.element.height;else if("[object HTMLImageElement]"===g(f))a.element=f,a.width=f.naturalWidth,a.height=f.naturalHeight;else if("[object HTMLVideoElement]"===g(f))a.element=f,a.width=f.videoWidth,a.height=f.videoHeight,a.needsPoll=!0;else if(n(f)){k=f[0].length;r=f.length;A=1;if(F(f[0][0])){u=A=
f[0][0].length;R=B.allocType(36193===a.type?5126:a.type,k*r*u);for(v=y=0;v<r;++v)for(m=f[v],G=0;G<k;++G)for(L=m[G],D=0;D<u;++D)R[y++]=L[D];b(a,R)}else{u=B.allocType(36193===a.type?5126:a.type,k*r);for(y=R=0;y<r;++y)for(v=f[y],m=0;m<k;++m)u[R++]=v[m];b(a,u)}a.alignment=1;a.width=k;a.height=r;a.channels=A;a.format=a.internalformat=q[A];a.needsFree=!0}}function ba(b,c,d,f,g){var l=b.element,n=b.data,k=b.internalformat,r=b.format,q=b.type,m=b.width,F=b.height;D(b);l?a.texSubImage2D(c,g,d,f,r,q,l):b.compressed?
a.compressedTexSubImage2D(c,g,d,f,k,m,F,n):b.needsCopy?(u(),a.copyTexSubImage2D(c,g,d,f,b.xOffset,b.yOffset,m,F)):a.texSubImage2D(c,g,d,f,m,F,r,q,n)}function J(){return Da.pop()||new I}function ga(a){a.needsFree&&B.freeType(a.data);I.call(a);Da.push(a)}function ma(){W.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function S(a,b,c){var d=a.images[0]=J();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function O(a,b){var d=null;if(c(b))d=a.images[0]=J(),y(d,
a),X(d,b),a.mipmask=1;else if(ia(a,b),Array.isArray(b.mipmap))for(var f=b.mipmap,g=0;g<f.length;++g)d=a.images[g]=J(),y(d,a),d.width>>=g,d.height>>=g,X(d,f[g]),a.mipmask|=1<<g;else d=a.images[0]=J(),y(d,a),X(d,b),a.mipmask=1;y(a,a.images[0])}function K(b,c){for(var d=b.images,f=0;f<d.length&&d[f];++f){var g=d[f],l=c,n=f,k=g.element,r=g.data,q=g.internalformat,m=g.format,F=g.type,E=g.width,t=g.height;D(g);k?a.texImage2D(l,n,m,m,F,k):g.compressed?a.compressedTexImage2D(l,n,q,E,t,0,r):g.needsCopy?(u(),
a.copyTexImage2D(l,n,m,g.xOffset,g.yOffset,E,t,0)):a.texImage2D(l,n,m,E,t,0,m,F,r)}}function Y(){var a=Ea.pop()||new ma;W.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ja(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&ga(b[c]),b[c]=null;Ea.push(a)}function ra(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ta(a,b){"min"in b&&(a.minFilter=ua[b.min],0<=A.indexOf(a.minFilter)&&(a.genMipmaps=
!0));"mag"in b&&(a.magFilter=da[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var f=b.wrap;"string"===typeof f?c=d=V[f]:Array.isArray(f)&&(c=V[f[0]],d=V[f[1]])}else"wrapS"in b&&(c=V[b.wrapS]),"wrapT"in b&&(d=V[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=T[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=
9984)}}function ka(b,c){a.texParameteri(c,10241,b.minFilter);a.texParameteri(c,10240,b.magFilter);a.texParameteri(c,10242,b.wrapS);a.texParameteri(c,10243,b.wrapT);d.ext_texture_filter_anisotropic&&a.texParameteri(c,34046,b.anisotropic);b.genMipmaps&&(a.hint(33170,b.mipmapHint),a.generateMipmap(c))}function sa(){var a=va.pop()||new ra;ra.call(a);return a}function oa(b){W.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ha++;this.refCount=1;this.target=b;this.texture=a.createTexture();this.unit=
-1;this.bindCount=0}function Z(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function ha(){var b=ca[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function aa(b){var c=b.texture,d=b.unit,f=b.target;0<=d&&(a.activeTexture(33984+d),a.bindTexture(f,null),ca[d]=null);a.deleteTexture(c);b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete xa[b.id];Q.textureCount--}var T={"don't care":4352,"dont care":4352,nice:4354,fast:4353},V={repeat:10497,clamp:33071,mirror:33648},
da={nearest:9728,linear:9729},ua=f({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},da),Ba={none:0,browser:37444},la={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ea={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},fa={};d.ext_srgb&&(ea.srgb=35904,ea.srgba=35906);d.oes_texture_float&&(la["float"]=5126);d.oes_texture_half_float&&(la.float16=la["half float"]=
36193);d.webgl_depth_texture&&(f(ea,{depth:6402,"depth stencil":34041}),f(la,{uint16:5123,uint32:5125,"depth stencil":34042}));d.webgl_compressed_texture_s3tc&&f(fa,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});d.webgl_compressed_texture_atc&&f(fa,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});d.webgl_compressed_texture_pvrtc&&f(fa,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
d.webgl_compressed_texture_etc1&&(fa["rgb etc1"]=36196);var za=Array.prototype.slice.call(a.getParameter(34467));Object.keys(fa).forEach(function(a){var b=fa[a];0<=za.indexOf(b)&&(ea[a]=b)});var wa=Object.keys(ea);k.textureFormats=wa;var Ca=wa.reduce(function(a,b){var c=ea[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Da=[],Ea=[],va=[],Ha=0,xa={},na=k.maxTextureUnits,ca=Array(na).map(function(){return null});
f(oa.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<na;++c){var d=ca[c];if(d){if(0<d.bindCount)continue;d.unit=-1}ca[c]=this;b=c;break}this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&aa(this)}});return{create2D:function(b,c){function d(a,b){var c=sa(),e=Y();"number"===typeof a?"number"===typeof b?S(e,a|0,b|0):S(e,a|0,a|0):a?(ta(c,a),O(e,a)):S(e,1,1);
c.genMipmaps&&(e.mipmask=(e.width<<1)-1);f.mipmask=e.mipmask;y(f,e);f.internalformat=e.internalformat;d.width=e.width;d.height=e.height;Z(f);K(e,3553);ka(c,3553);ha();va.push(c);ja(e);return d}var f=new oa(3553);xa[f.id]=f;Q.textureCount++;d(b,c);d.subimage=function(a,b,c,e){b|=0;c|=0;e|=0;var g=J();y(g,f);g.width>>=e;g.height>>=e;g.width-=b;g.height-=c;X(g,a);Z(f);ba(g,3553,b,c,e);ha();ga(g);return d};d.resize=function(b,c){var e=b|0,g=c|0||e;if(e===f.width&&g===f.height)return d;d.width=f.width=
e;d.height=f.height=g;Z(f);a.texImage2D(3553,0,f.format,e,g,0,f.format,f.type,null);ha();return d};d._reglType="texture2d";d._texture=f;d.destroy=function(){f.decRef()};return d},createCube:function(b,c,d,f,g,l){function n(a,b,c,d,e,f){var g,l=sa();for(g=0;6>g;++g)r[g]=Y();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)S(r[g],a,a);else if("object"===typeof a)if(b)O(r[0],a),O(r[1],b),O(r[2],c),O(r[3],d),O(r[4],e),O(r[5],f);else if(ta(l,a),ia(k,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)y(r[g],k),
O(r[g],a[g]);else for(g=0;6>g;++g)O(r[g],a);y(k,r[0]);k.mipmask=l.genMipmaps?(r[0].width<<1)-1:r[0].mipmask;k.internalformat=r[0].internalformat;n.width=r[0].width;n.height=r[0].height;Z(k);for(g=0;6>g;++g)K(r[g],34069+g);ka(l,34067);ha();va.push(l);for(g=0;6>g;++g)ja(r[g]);return n}var k=new oa(34067);xa[k.id]=k;Q.cubeCount++;var r=Array(6);n(b,c,d,f,g,l);n.subimage=function(a,b,c,d,e){c|=0;d|=0;e|=0;var f=J();y(f,k);f.width>>=e;f.height>>=e;f.width-=c;f.height-=d;X(f,b);Z(k);ba(f,34069+a,c,d,e);
ha();ga(f);return n};n.resize=function(b,c){var d=b|0,e=c|0||d;if(d===k.width&&e===k.height)return n;n.width=k.width=d;n.height=k.height=e;Z(k);for(var f=0;6>f;++f)a.texImage2D(34069+f,0,k.format,d,e,0,k.format,k.type,null);ha();return n};n._reglType="textureCube";n._texture=k;n.destroy=function(){k.decRef()};return n},clear:function(){for(var b=0;b<na;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ca[b]=null;r(xa).forEach(aa);Q.cubeCount=0;Q.textureCount=0},getTexture:function(a){return null}}}},
{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(d,k,z){k.exports=function(d,n){function g(){this.endQueryIndex=this.startQueryIndex=-1;this.stats=null}var c=n.ext_disjoint_timer_query;if(!c)return null;var b=[],f=[],k,t,x=[],B=[];return{beginQuery:function(b){k=b;t=x.pop()||c.createQueryEXT();c.beginQueryEXT(c.TIME_ELAPSED_EXT,t)},endQuery:function(){c.endQueryEXT(c.TIME_ELAPSED_EXT);
var d=B.pop()||new g;d.startQueryIndex=b.length;d.endQueryIndex=d.startQueryIndex;d.stats=k;f.push(d);b.push(t)},update:function(){if(0!==b.length){var d=[],g,n;for(g=0;g<b.length;g++)d[g]=1E-6*c.getQueryObjectEXT(b[g],c.QUERY_RESULT_EXT),x.push(b[g]);b=[];for(g=0;g<f.length;g++){var l=f[g];for(n=l.startQueryIndex;n<=l.endQueryIndex;n++)l.stats.gpuTime+=d[n];B.push(l)}f=[]}},getNumPendingQueries:function(){return b.length},pushScopeStats:function(b,c,d){var n=B.pop()||new g;n.startQueryIndex=b;n.endQueryIndex=
c;n.stats=d;f.push(n)},clear:function(){for(var b=0;b<x.length;b++)c.deleteQueryEXT(x[b])}}}},{}],21:[function(d,k,z){k.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(d,k,z){function l(c){return Array.prototype.slice.call(c)}function n(c){return l(c).join("")}var g=d("./extend");k.exports=function(){function c(){var b=[],c=[];return g(function(){b.push.apply(b,l(arguments))},{def:function(){var g="v"+d++;
c.push(g);0<arguments.length&&(b.push(g,"="),b.push.apply(b,l(arguments)),b.push(";"));return g},toString:function(){return n([0<c.length?"var "+c+";":"",n(b)])}})}function b(){function b(c,g){f(c,g,"=",d.def(c,g),";")}var d=c(),f=c(),n=d.toString,l=f.toString;return g(d,{entry:d,exit:f,save:b,set:function(c,f,a){b(c,f);d(c,f,"=",a,";")},toString:function(){return n()+l()}})}var d=0,k=[],t=[],x=c(),B={};return{global:x,link:function(b){for(var c=0;c<t.length;++c)if(t[c]===b)return k[c];c="g"+d++;
k.push(c);t.push(b);return c},block:c,proc:function(c,d){function f(){var b="a"+l.length;l.push(b);return b}var l=[];d=d||0;for(var k=0;k<d;++k)f();var k=b(),r=k.toString;return B[c]=g(k,{arg:f,toString:function(){return n(["function(",l.join(),"){",r(),"}"])}})},scope:b,cond:function(){var c=n(arguments),d=b(),f=b(),k=d.toString,r=f.toString;return g(d,{then:function(){d.apply(d,l(arguments));return this},"else":function(){f.apply(f,l(arguments));return this},toString:function(){var b=r();b&&(b=
"else{"+b+"}");return n(["if(",c,"){",k(),"}",b])}})},compile:function(){var b=['"use strict";',x,"return {"];Object.keys(B).forEach(function(c){b.push('"',c,'":',B[c].toString(),",")});b.push("}");var c=n(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,k.concat(c)).apply(null,t)}}}},{"./extend":23}],23:[function(d,k,z){k.exports=function(d,n){for(var g=Object.keys(n),c=0;c<g.length;++c)d[g[c]]=n[g[c]];return d}},{}],24:[function(d,k,z){var l=d("./is-typed-array");
k.exports=function(d){return Array.isArray(d)||l(d)}},{"./is-typed-array":26}],25:[function(d,k,z){var l=d("./is-typed-array");k.exports=function(d){return!!d&&"object"===typeof d&&Array.isArray(d.shape)&&Array.isArray(d.stride)&&"number"===typeof d.offset&&d.shape.length===d.stride.length&&(Array.isArray(d.data)||l(d.data))}},{"./is-typed-array":26}],26:[function(d,k,z){var l=d("../constants/arraytypes.json");k.exports=function(d){return Object.prototype.toString.call(d)in l}},{"../constants/arraytypes.json":4}],
27:[function(d,k,z){k.exports=function(d,k){for(var g=Array(d),c=0;c<d;++c)g[c]=k(c);return g}},{}],28:[function(d,k,z){function l(b){var c,d;c=(65535<b)<<4;b>>>=c;d=(255<b)<<3;b>>>=d;c|=d;d=(15<b)<<2;b>>>=d;c|=d;d=(3<b)<<1;return c|d|b>>>d>>1}function n(b){a:{for(var d=16;268435456>=d;d*=16)if(b<=d){b=d;break a}b=0}d=c[l(b)>>2];return 0<d.length?d.pop():new ArrayBuffer(b)}function g(b){c[l(b.byteLength)>>2].push(b)}var c=d("./loop")(8,function(){return[]});k.exports={alloc:n,free:g,allocType:function(b,
c){var d=null;switch(b){case 5120:d=new Int8Array(n(c),0,c);break;case 5121:d=new Uint8Array(n(c),0,c);break;case 5122:d=new Int16Array(n(2*c),0,c);break;case 5123:d=new Uint16Array(n(2*c),0,c);break;case 5124:d=new Int32Array(n(4*c),0,c);break;case 5125:d=new Uint32Array(n(4*c),0,c);break;case 5126:d=new Float32Array(n(4*c),0,c);break;default:return null}return d.length!==c?d.subarray(0,c):d},freeType:function(b){g(b.buffer)}}},{"./loop":27}],29:[function(d,k,z){k.exports="function"===typeof requestAnimationFrame&&
"function"===typeof cancelAnimationFrame?{next:function(d){return requestAnimationFrame(d)},cancel:function(d){return cancelAnimationFrame(d)}}:{next:function(d){setTimeout(d,30)},cancel:clearTimeout}},{}],30:[function(d,k,z){var l=d("./pool"),n=new Float32Array(1),g=new Uint32Array(n.buffer);k.exports=function(c){for(var b=l.allocType(5123,c.length),d=0;d<c.length;++d)if(isNaN(c[d]))b[d]=65535;else if(Infinity===c[d])b[d]=31744;else if(-Infinity===c[d])b[d]=64512;else{n[0]=c[d];var k=g[0],t=k>>>
31<<15,x=(k<<1>>>24)-127,k=k>>13&1023;b[d]=-24>x?t:-14>x?t+(k+1024>>-14-x):15<x?t+31744:t+(x+15<<10)+k}return b}},{"./pool":28}],31:[function(d,k,z){k.exports=function(d){return Object.keys(d).map(function(k){return d[k]})}},{}],32:[function(d,k,z){function l(c,b){function d(){var b=window.innerWidth,f=window.innerHeight;c!==document.body&&(f=c.getBoundingClientRect(),b=f.right-f.left,f=f.top-f.bottom);k.width=x*b;k.height=x*f;g(k.style,{width:b+"px",height:f+"px"})}var k=document.createElement("canvas"),
l=n(k,b);g(k.style,{border:0,margin:0,padding:0,top:0,left:0});c.appendChild(k);c===document.body&&(k.style.position="absolute",g(c.style,{margin:0,padding:0}));var x=+l.options.pixelRatio;window.addEventListener("resize",d,!1);var B=l.options.onDestroy;l.options=g(g({},l.options),{onDestroy:function(){window.removeEventListener("resize",d);c.removeChild(k);B&&B()}});d();return l}function n(c,b){function d(b){try{return c.getContext(b,k)}catch(f){return null}}var k=b.glOptions||{};return{gl:d("webgl")||
d("experimental-webgl")||d("webgl-experimental"),options:g({pixelRatio:window.devicePixelRatio},b)}}var g=d("./util/extend");k.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],options:c[1]||{}};var b=document.body,d=c[1]||{};if("string"===typeof c[0])b=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)b=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],options:g({pixelRatio:1},
d)};d=c[0]}return b.nodeName&&"CANVAS"===b.nodeName.toUpperCase()?n(b,d):l(b,d)}},{"./util/extend":23}],33:[function(d,k,z){var l=d("./lib/util/extend"),n=d("./lib/dynamic"),g=d("./lib/util/raf"),c=d("./lib/util/clock"),b=d("./lib/strings"),f=d("./lib/webgl"),r=d("./lib/extension"),t=d("./lib/limits"),x=d("./lib/buffer"),B=d("./lib/elements"),E=d("./lib/texture"),F=d("./lib/renderbuffer"),P=d("./lib/framebuffer"),A=d("./lib/attribute"),q=d("./lib/shader"),M=d("./lib/read"),u=d("./lib/core"),a=d("./lib/stats"),
U=d("./lib/timer");k.exports=function(){function d(){V=g.next(d);K.tick+=1;K.time=(c()-ma)/1E3;y();for(var a=0;a<T.length;++a)(0,T[a])(K,null,0);I.flush()}function k(a){}function z(a){}function Q(a){function b(a){var c={},d={};Object.keys(a).forEach(function(b){var f=a[b];n.isDynamic(f)?d[b]=n.unbox(f,b):c[b]=f});return{dynamic:d,"static":c}}function d(a){for(;u.length<a;)u.push(null);return u}var c=b(a.context||{}),f=b(a.uniforms||{}),g=b(a.attributes||{}),k=b(function(a){function b(a){if(a in c){var d=
c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=l({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));a={gpuTime:0};var c=Z.compile(k,g,f,c,a),q=c.draw,r=c.batch,t=c.scope,u=[];return l(function(a,b){var c;if("function"===typeof a)return t.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)t.call(this,null,b,c);else if(Array.isArray(a))for(c=
0;c<a.length;++c)t.call(this,a[c],b,c);else return t.call(this,a,b,0);else if("number"===typeof a){if(0<a)return r.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return r.call(this,a,a.length)}else return q.call(this,a)},{stats:a})}function W(){var a=ha.viewport,b=ha.scissor_box;a[0]=a[1]=b[0]=b[1]=0;K.viewportWidth=K.framebufferWidth=K.drawingBufferWidth=a[2]=b[2]=I.drawingBufferWidth;K.viewportHeight=K.framebufferHeight=K.drawingBufferHeight=a[3]=b[3]=I.drawingBufferHeight}function y(){W();
Z.procs.poll()}function ia(){W();Z.procs.refresh()}var D=f(Array.prototype.slice.call(arguments)),I=D.gl,X=D.options,D=b(),ba=a(),J=r(I).extensions,ga=U(I,J),ma=c(),S=I.drawingBufferWidth,O=I.drawingBufferHeight,K={tick:0,time:0,viewportWidth:S,viewportHeight:O,framebufferWidth:S,framebufferHeight:O,drawingBufferWidth:S,drawingBufferHeight:O,pixelRatio:X.pixelRatio},Y=t(I,J),ja=x(I,ba),ra=B(I,J,ja,ba),S=A(I,J,Y,ja,D),ta=q(I,D,ba),ka=E(I,J,Y,y,K,ba),sa=F(I,J,Y,ba),oa=P(I,J,Y,ka,sa,ba),O=M(I,y,K),Z=
u(I,D,J,Y,ja,ra,ka,oa,{},S,ta,{elements:null,primitive:4,count:-1,offset:0,instances:-1},K,ga),ha=Z.next,aa=I.canvas,T=[],V=0;aa&&(aa.addEventListener("webglcontextlost",k,!1),aa.addEventListener("webglcontextrestored",z,!1));ia();return l(Q,{clear:function(a){var b=0;Z.procs.poll();var c=a.color;c&&(I.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(I.clearDepth(+a.depth),b|=256);"stencil"in a&&(I.clearStencil(a.stencil|0),b|=1024);I.clear(b)},prop:n.define.bind(null,1),context:n.define.bind(null,
2),"this":n.define.bind(null,3),draw:Q({}),buffer:function(a){return ja.create(a,34962)},elements:ra.create,texture:ka.create2D,cube:ka.createCube,renderbuffer:sa.create,framebuffer:oa.create,framebufferCube:function(a){},attributes:I.getContextAttributes(),frame:function(a){T.push(a);!V&&0<T.length&&d();return{cancel:function(){var b=T.find(function(b){return b===a});0>b||(T.splice(b,1),0>=T.length&&V&&(g.cancel(d),V=0))}}},limits:Y,hasExtension:function(a){return 0<=Y.extensions.indexOf(a.toLowerCase())},
read:O,destroy:function(){V&&(g.cancel(d),V=0);aa&&(aa.removeEventListener("webglcontextlost",k),aa.removeEventListener("webglcontextrestored",z));ta.clear();oa.clear();sa.clear();ka.clear();ra.clear();ja.clear();ga&&ga.clear();if(X.onDestroy)X.onDestroy()},_gl:I,_refresh:ia,stats:ba,updateTimer:function(){ga&&ga.update()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,
"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>