(function e$$0(g,k,b){function p(a,f){if(!k[a]){if(!g[a]){var t="function"==typeof require&&require;if(!f&&t)return t(a,!0);if(d)return d(a,!0);t=Error("Cannot find module '"+a+"'");throw t.code="MODULE_NOT_FOUND",t;}t=k[a]={exports:{}};g[a][0].call(t.exports,function(d){var b=g[a][1][d];return p(b?b:d)},t,t.exports,e$$0,g,k,b)}return k[a].exports}for(var d="function"==typeof require&&require,a=0;a<b.length;a++)p(b[a]);return p})({1:[function(e,g,k){var b=e("../regl")(),p=Array(1048576).fill(0).map(function(){return.9<
Math.random()?255:0}),d=Array(2).fill().map(function(){return b.framebuffer({colorBuffer:b.texture({radius:512,data:p,wrap:"repeat"}),depth:!1})}),a=b({frag:"\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float n = 0.0;\n    for(int dx=-1; dx<=1; ++dx)\n    for(int dy=-1; dy<=1; ++dy) {\n      n += texture2D(prevState, uv+vec2(dx,dy)/float(512)).r;\n    }\n    float s = texture2D(prevState, uv).r;\n    if(n > 3.0+s || n < 3.0) {\n      gl_FragColor = vec4(0,0,0,1);\n    } else {\n      gl_FragColor = vec4(1,1,1,1);\n    }\n  }",
framebuffer:function(a,b,l){return d[(l.count+1)%2]}}),H=b({frag:"\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float state = texture2D(prevState, uv).r;\n    gl_FragColor = vec4(vec3(state), 1);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main() {\n    uv = 0.5 * (position + 1.0);\n    gl_Position = vec4(position, 0, 1);\n  }",attributes:{position:b.buffer([-4,-4,4,-4,0,4])},uniforms:{prevState:function(a,
b,l){return d[l.count%2].color[0]}},depth:{enable:!1},count:3});b.frame(function(){H(function(){b.draw();a()})})},{"../regl":33}],2:[function(e,g,k){var b=e("./constants/dtypes.json");g.exports=function(p,d,a,e,f){function t(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function l(a){this.records=[];this.name=a}function g(a,c,b,h){h=b.size||h;var l;l=c.pointer?b.pointer&&c.buffer===b.buffer&&c.size===
h&&c.normalized===b.normalized&&c.type===b.type&&c.offset===b.offset&&c.stride===b.stride&&c.divisor===b.divisor:!b.pointer&&c.x===b.x&&c.y===b.y&&c.z===b.z&&c.w===b.w;l||(b.pointer?(c.pointer||p.enableVertexAttribArray(a),c.buffer!==b.buffer&&b.buffer.bind(),p.vertexAttribPointer(a,h,b.type,b.normalized,b.stride,b.offset),(l=d.angle_instanced_arrays)&&l.vertexAttribDivisorANGLE(a,b.divisor)):(c.pointer&&p.disableVertexAttribArray(a),p.vertexAttrib4f(a,b.x,b.y,b.z,b.w)),(c.pointer=b.pointer)?(c.buffer=
b.buffer,c.size=h,c.normalized=b.normalized,c.type=b.type,c.offset=b.offset,c.stride=b.stride,c.divisor=b.divisor):(c.x=b.x,c.y=b.y,c.z=b.z,c.w=b.w))}var y={};a=a.maxAttributes;for(var u=Array(a),h=0;h<a;++h)u[h]=new t;return{bindings:u,bind:function(b,c,a,d){a=a.records;g(b,c,a[a.length-1],d)},bindRecord:g,def:function(b){var c=f.id(b),a=y[c];a||(a=y[c]=new l(b));return a},box:function(a){var c=[new t];return{alloc:function(a){var d;d=0>=c.length?new t:c.pop();if("number"===typeof a)d.pointer=!1,
d.x=a,d.y=0,d.z=0,d.w=0;else if(Array.isArray(a))d.pointer=!1,d.x=a[0],d.y=a[1],d.z=a[2],d.w=a[3];else{var h=e.getBuffer(a),l=0,p=0,f=0,g=0,v=!1,I=5126;h?I=h.dtype:(h=e.getBuffer(a.buffer),l=a.size||0,p=a.stride||0,f=a.offset||0,g=a.divisor||0,v=a.normalized||!1,I=h.dtype,"type"in a&&(I=b[a.type]));d.pointer=!0;d.buffer=h;d.size=l;d.offset=f;d.stride=p;d.divisor=g;d.normalized=v;d.type=I}return d},free:function(a){c.push(a)}}},state:y}}},{"./constants/dtypes.json":6}],3:[function(e,g,k){function b(a,
b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);case 5122:return new Int16Array(b);case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var p=e("./util/is-typed-array"),d=e("./util/is-ndarray"),a=e("./constants/arraytypes.json"),H=e("./constants/dtypes.json"),f=e("./util/values"),t={"static":35044,dynamic:35048,stream:35040};g.exports=function(l){function e(a,
b){this.id=h++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function g(a){l.isBuffer(a.buffer)||(a.buffer=l.createBuffer());a.bind();l.bufferData(a.type,a.data||a.byteLength,a.usage)}function u(a){var b=a.buffer;l.isBuffer(b)&&l.deleteBuffer(b);a.buffer=null;delete v[a.id]}var h=0,v={};e.prototype.bind=function(){l.bindBuffer(this.type,this.buffer)};return{create:function(c,h,f){function D(c){var h=c||{};if(Array.isArray(h)||p(h)||d(h))h=
{data:h};else if("number"===typeof h)h={length:h|0};else if(null===h||void 0===h)h={};k.usage="usage"in h?t[h.usage]:35044;c=0;"type"in h&&(c=H[h.type]);var l=h.dimension|0||1,f=0,e=null;if("data"in h)if(e=h.data,null===e)f=h.length|0;else{if(d(e)){var l=e.shape,f=e.stride,h=e.offset,M=0,v=0,u=0,n=0;1===l.length?(M=l[0],v=1,u=f[0],n=0):2===l.length&&(M=l[0],v=l[1],u=f[0],n=f[1]);c=c||a[Object.prototype.toString.call(e)]|0||5126;for(var l=v,f=b(c,M*v),e=e.data,R=0,ga=0;ga<M;++ga)for(var N=0;N<v;++N)f[R++]=
e[u*ga+n*N+h];e=f}else if(Array.isArray(e))if(0<e.length&&Array.isArray(e[0])){l=e[0].length;c=c||5126;h=b(c,e.length*l);f=e;e=l;for(M=n=0;M<f.length;++M)for(u=f[M],v=0;v<e;++v)h[n++]=u[v];e=h}else c=c||5126,e=b(c,e);else c=c||a[Object.prototype.toString.call(e)]|0;f=e.byteLength}else"length"in h&&(f=h.length|0);k.data=e;k.dtype=c||5121;k.byteLength=f;k.dimension=l;g(k);return D}var B=l.createBuffer(),k=new e(B,h);v[k.id]=k;f||D(c);D._reglType="buffer";D._buffer=k;D.destroy=function(){u(k)};return D},
clear:function(){f(v).forEach(u)},refresh:function(){f(v).forEach(g)},getBuffer:function(a){return a&&a._buffer instanceof e?a._buffer:null}}}},{"./constants/arraytypes.json":5,"./constants/dtypes.json":6,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":32}],4:[function(e,g,k){function b(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function p(a,b,d,l){var c,e=",";switch(b){case 5126:c=
"1f";break;case 35664:c="2fv";break;case 35665:c="3fv";break;case 35666:c="4fv";break;case 35670:case 5124:c="1i";break;case 35671:case 35667:c="2iv";break;case 35672:case 35668:c="3iv";break;case 35673:case 35669:c="4iv";break;case 35674:c="Matrix2fv";e=",false,";break;case 35675:c="Matrix3fv";e=",false,";break;case 35676:c="Matrix4fv",e=",false,"}return a+".uniform"+c+"("+d+e+l+");"}function d(a){return a+"["+a+".length-1]"}function a(a,b){return"framebuffer"===a||a<b?-1:a>b?1:0}var H=e("./util/codegen"),
f=e("./constants/primitives.json"),t={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},l={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,
gequal:518,">=":518,always:519},I={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};g.exports=function(e,g,h,v,c,M,q,D,k,Q,w,U,P,ka,X){function ja(c,n,g,v,S){function q(a){var b=J[a];return b?b:b=J[a]=r(V[a])}function u(a){var b=a.id,c=U[b];if(c)return c;c=a.func?m.def(r(a.data),"(",W,",",Z,",",ba,")"):m.def(W,".",a.data);return U[b]=c}function ha(a,b){for(var c=0;c<a.length;++c)if(a[c].name===b)return a[c];return null}function k(a){return la&&
!(a in n||a in S)}var ia=H(),r=ia.link,m=ia.proc("batch"),ca=ia.block(),z=m.def,L=m.arg,x=r(e),A=r(c.program),O=r(w.bind),F=r(w.bindRecord),ba=r(ka),pa=r(D),da=r(P.count),fa=r(P.offset),ma=r(P.instances),C=r(P.primitive),J={},E=r(M.elements),da=z(d(da)),fa=z(d(fa)),C=z(d(C)),E=z(d(E)),K,B,ea=h.angle_instanced_arrays;ea&&(K=z(d(ma)),B=r(ea));var la="elements"in n,ma=L(),L=L(),W=z(),Z=z(),U={};m(x,".useProgram(",A,");");c.uniforms.forEach(function(a){if(!(a.name in g)){var b=r(a.location),c=r(Q.def(a.name)),
c=c+"["+c+".length-1]";a=a.info.type;35678===a||35680===a?(a=z(c+"._texture"),m(p(x,5124,b,a+".bind()")),ca(a,".unbind();")):m(p(x,a,b,c))}});c.attributes.forEach(function(a){if(!(a.name in v)){var c=r(w.def(a.name));m(O,"(",a.location,",",r(w.bindings[a.location]),",",c,",",b(a.info.type),");")}});la||m("if(",E,")",x,".bindBuffer(",34963,",",E,".buffer.buffer);");m("for(",Z,"=0;",Z,"<",ma,";++",Z,"){",W,"=",L,"[",Z,"];");Object.keys(n).sort(a).forEach(function(a){function b(a){m("if(",c,"){",x,".enable(",
a,");}else{",x,".disable(",a,");}")}var c=u(n[a]);switch(a){case "framebuffer":a=q("viewport");var A=q("scissor.box");m("if(",pa,".push(",c,"&&",c,"._framebuffer)){",pa,".poll();",a,".setDirty();",A,".setDirty();","}");break;case "cull.enable":b(2884);break;case "blend.enable":b(3042);break;case "dither":b(3024);break;case "stencil.enable":b(2960);break;case "depth.enable":b(2929);break;case "scissor.enable":b(3089);break;case "polygonOffset.enable":b(32823);break;case "sample.alpha":b(32926);break;
case "sample.enable":b(32928);break;case "depth.mask":m(x,".depthMask(",c,");");break;case "depth.func":a=r(l);m(x,".depthFunc(",a,"[",c,"]);");break;case "depth.range":m(x,".depthRange(",c,"[0],",c,"[1]);");break;case "blend.color":m(x,".blendColor(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "blend.equation":a=r(G);m("if(typeof ",c,'==="string"){',x,".blendEquation(",a,"[",c,"]);","}else{",x,".blendEquationSeparate(",a,"[",c,".rgb],",a,"[",c,".alpha]);","}");break;case "blend.func":a=r(t);
m(x,".blendFuncSeparate(",a,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",a,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",a,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",a,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");break;case "stencil.mask":m(x,".stencilMask(",c,");");break;case "stencil.func":a=r(l);m(x,".stencilFunc(",a,"[",c,'.cmp||"always"],',c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":A=r(I);m(x,".stencilOpSeparate(","stencil.opFront"===
a?1028:1029,",",A,"[",c,'.fail||"keep"],',A,"[",c,'.zfail||"keep"],',A,"[",c,'.pass||"keep"]);');break;case "polygonOffset.offset":m(x,".polygonOffset(",c,".factor||0,",c,".units||0);");break;case "cull.face":m(x,".cullFace(",c,'==="front"?',1028,":",1029,");");break;case "lineWidth":m(x,".lineWidth(",c,");");break;case "frontFace":m(x,".frontFace(",c,'==="cw"?',2304,":",2305,");");break;case "colorMask":m(x,".colorMask(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "sample.coverage":m(x,".sampleCoverage(",
c,".value,",c,".invert);");break;case "scissor.box":case "viewport":a=q(a),m(a,".push(",c,".x||0,",c,".y||0,",c,".w||-1,",c,".h||-1);")}});("viewport"in n||"framebuffer"in n)&&m(q("viewport"),".poll();");("scissor.box"in n||"framebuffer"in n)&&m(q("scissor.box"),".poll();");"framebuffer"in n&&m(pa,".pop();");var X=c.uniforms,ra=[];Object.keys(g).forEach(function(a){var c=ha(X,a);if(c){var b=c.info.type,A=r(c.location);a=u(g[a]);35678===c.info.type||35680===c.info.type?(c=z(a+"._texture"),ra.push(c),
m(p(x,5124,A,c+".bind()"))):m(p(x,b,A,a))}});ra.forEach(function(a){m(a,".unbind();")});var ta=c.attributes;Object.keys(v).forEach(function(a){var c=ha(ta,a);if(c){var A=r(w.box(a));a=u(v[a]);a=z(A+".alloc("+a+")");m(F,"(",c.location,",",r(w.bindings[c.location]),",",a,",",b(c.info.type),");");ca(A,".free(",a,");")}});n.count&&m(da,"=",u(n.count),";");n.offset&&m(fa,"=",u(n.offset),";");n.primitive&&m(C,"=",r(f),"[",u(n.primitive),"];");ea&&n.instances&&m(K,"=",u(n.instances),";");la&&(c=u(n.elements),
m(E,"=",c,"?",c,"._elements:null;"));k("offset")&&m(fa,"=0;");m("if(",E,"){");k("count")&&m(da,"=",E,".vertCount;");m("if(",da,">0){");k("primitive")&&m(C,"=",E,".primType;");la&&m(x,".bindBuffer(",34963,",",E,".buffer.buffer);");ea&&m("if(",K,">0){",B,".drawElementsInstancedANGLE(",C,",",da,",",E,".type,",fa,",",K,");}else ");m(x,".drawElements(",C,",",da,",",E,".type,",fa,");");m("}}else if(",da,">0){");k("count")||(k("primitive")&&m(C,"=",4,";"),ea&&m("if(",K,">0){",B,".drawArraysInstancedANGLE(",
C,",",fa,",",da,",",K,");}else{"),m(x,".drawArrays(",C,",",fa,",",da,");"),ea&&m("}"));m("}}",ca);return ia.compile().batch}var V=k.contextState,G={add:32774,subtract:32778,"reverse subtract":32779};h.ext_blend_minmax&&(G.min=32775,G.max=32776);var n=0;return{draw:function(a){var c=H(),l=c.link,n=c.proc("draw"),f=n.def,t=l(e),g=l(a.program),v=l(w.bind),u=l(P.count),q=l(P.offset),r=l(P.instances),m=l(P.primitive),D=l(M.elements),I=[];n(t,".useProgram(",g,");");a.attributes.forEach(function(a){var c=
l(w.def(a.name));n(v,"(",a.location,",",l(w.bindings[a.location]),",",c,",",b(a.info.type),");")});a.uniforms.forEach(function(a){var c=l(a.location),b=l(Q.def(a.name)),b=b+"["+b+".length-1]";a=a.info.type;35678===a||35680===a?(a=f(b+"._texture"),I.push(a),n(p(t,5124,c,a+".bind()"))):n(p(t,a,c,b))});I.forEach(function(a){n(a,".unbind();")});a=f(d(m));u=f(d(u));q=f(d(q));D=f(d(D));n("if(",u,"){");(g=h.angle_instanced_arrays)?(r=f(d(r)),g=l(g),n("if(",D,"){",D,".bind();","if(",r,">0){",g,".drawElementsInstancedANGLE(",
a,",",u,",",D,".type,",q,",",r,");}else{",t,".drawElements(",a,",",u,",",D,".type,",q,");}","}else if(",r,">0){",g,".drawArraysInstancedANGLE(",a,",",q,",",u,",",r,");}else{",t,".drawArrays(",a,",",q,",",u,");}}")):n("if(",D,"){",D,".bind();",t,".drawElements(",a,",",u,",",D,".type,",q,");","}else{",t,".drawArrays(",a,",",q,",",u,");}}");return c.compile().draw},command:function(c,b,d,h,e,p,v){function q(a){var c=ma[a];return c?c:c=ma[a]=m(V[a])}function k(a,c){var b=q(a);C(b,".push(",c,");");J(b,
".pop();")}function y(a){var c=a.id,b=la[c];if(b)return b;b=a.func?E.def(m(a.data),"(",ea,",0,",qa,")"):E.def(ea,".",a.data);return la[c]=b}var r=H(),m=r.link,B=r.block,z=r.proc,L=n++,x=m(X),A=m(U),O=m(D),F={count:m(P.count),offset:m(P.offset),instances:m(P.instances),primitive:m(P.primitive)},ba=m(M.elements),pa=m(f),da=m(l),fa=m(I),ma={},C=B(),J=B();Object.keys(c).sort(a).forEach(function(a){var b=c[a];switch(a){case "frag":case "vert":b=g.id(b);U.shader("frag"===a?35632:35633,b);C(A,".",a,".push(",
b,");");J(A,".",a,".pop();");break;case "framebuffer":D.getFramebuffer(b);a=q("viewport");var d=q("scissor.box");C("if(",O,".push(",m(b&&b._framebuffer),")){",a,".setDirty();",d,".setDirty();","}");J("if(",O,".pop()){",a,".setDirty();",d,".setDirty();","}");break;case "count":case "offset":case "instances":C(F[a],".push(",b,");");J(F[a],".pop();");break;case "primitive":C(F.primitive,".push(",f[b],");");J(F.primitive,".pop();");break;case "elements":d=M.getElements(b);b=!("primitive"in c);a=!("count"in
c);d?(d=m(d),C(ba,".push(",d,");"),b&&C(F.primitive,".push(",d,".primType);"),a&&C(F.count,".push(",d,".vertCount);")):(C(ba,".push(null);"),b&&C(F.primitive,".push(",4,");"),a&&C(F.count,".push(0);"));b&&J(F.primitive,".pop();");a&&J(F.count,".pop();");"offset"in c||(C(F.offset,".push(0);"),J(F.offset,".pop();"));J(ba,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":k(a,
b);break;case "depth.func":k(a,l[b]);break;case "depth.range":a=q(a);C(a,".push(",b[0],",",b[1],");");J(a,".pop();");break;case "blend.func":a=q(a);C(a,".push(",t["srcRGB"in b?b.srcRGB:b.src],",",t["dstRGB"in b?b.dstRGB:b.dst],",",t["srcAlpha"in b?b.srcAlpha:b.src],",",t["dstAlpha"in b?b.dstAlpha:b.dst],");");J(a,".pop();");break;case "blend.equation":a=q(a);"string"===typeof b?C(a,".push(",G[b],",",G[b],");"):"object"===typeof b&&C(a,".push(",G[b.rgb],",",G[b.alpha],");");J(a,".pop();");break;case "blend.color":a=
q(a);C(a,".push(",b[0],",",b[1],",",b[2],",",b[3],");");J(a,".pop();");break;case "stencil.mask":a=q(a);C(a,".push(",b,");");J(a,".pop();");break;case "stencil.func":var d=b.cmp||"keep",h=b.ref||0,b="mask"in b?b.mask:-1;a=q(a);C(a,".push(",l[d],",",h,",",b,");");J(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":d=b.fail||"keep";h=b.zfail||"keep";b=b.pass||"keep";a=q(a);C(a,".push(",I[d],",",I[h],",",I[b],");");J(a,".pop();");break;case "polygonOffset.offset":d=b.factor||0;b=b.units||
0;a=q(a);C(a,".push(",d,",",b,");");J(a,".pop();");break;case "cull.face":d=0;"front"===b?d=1028:"back"===b&&(d=1029);b=q(a);C(b,".push(",d,");");J(b,".pop();");break;case "lineWidth":k(a,b);break;case "frontFace":d=0;"cw"===b?d=2304:"ccw"===b&&(d=2305);b=q(a);C(b,".push(",d,");");J(b,".pop();");break;case "colorMask":a=q(a);C(a,".push(",b.map(function(a){return!!a}).join(),");");J(a,".pop();");break;case "sample.coverage":d="value"in b?b.value:1;b=!!b.invert;a=q(a);C(a,".push(",d,",",b,");");J(a,
".pop();");break;case "viewport":case "scissor.box":var d=b.x||0,h=b.y||0,n=-1,e=-1;"w"in b&&(n=b.w);"h"in b&&(e=b.h);b=q(a);C(b,".push(",d,",",h,",",n,",",e,");");J(b,".pop();")}});Object.keys(b).forEach(function(a){var c=m(Q.def(a));a=b[a];a="function"===typeof a&&a._reglType?m(a):Array.isArray(a)?m(a.slice()):+a;C(c,".push(",a,");");J(c,".pop();")});Object.keys(d).forEach(function(a){var b=d[a],c=m(w.def(a));a=m(w.box(a).alloc(b));C(c,".records.push(",a,");");J(c,".records.pop();")});var E=r.block(),
K=r.block(),qa,ea;v&&(qa=m(ka),ea=C.def());var la={};Object.keys(h).sort(a).forEach(function(a){var b=y(h[a]);switch(a){case "framebuffer":a=q("viewport");var d=q("scissor.box");E("if(",O,".push(",b,"&&",b,"._framebuffer)){",a,".setDirty();",d,".setDirty();","}");K("if(",O,".pop()){",a,".setDirty();",d,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":a=
q(a);E(a,".push(",b,");");K(a,".pop();");break;case "count":case "offset":case "instances":a=F[a];E(a,".push(",b,");");K(a,".pop();");break;case "primitive":a=F.primitive;E(a,".push(",pa,"[",b,"]);");K(a,".pop();");break;case "depth.func":a=q(a);E(a,".push(",da,"[",b,"]);");K(a,".pop();");break;case "blend.func":a=q(a);d=m(t);E(a,".push(",d,'["srcRGB" in ',b,"?",b,".srcRGB:",b,".src],",d,'["dstRGB" in ',b,"?",b,".dstRGB:",b,".dst],",d,'["srcAlpha" in ',b,"?",b,".srcAlpha:",b,".src],",d,'["dstAlpha" in ',
b,"?",b,".dstAlpha:",b,".dst]);");K(a,".pop();");break;case "blend.equation":a=q(a);d=m(G);E("if(typeof ",b,'==="string"){',a,".push(",d,"[",b,"],",d,"[",b,"]);","}else{",a,".push(",d,"[",b,".rgb],",d,"[",b,".alpha]);","}");K(a,".pop();");break;case "blend.color":a=q(a);E(a,".push(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");K(a,".pop();");break;case "stencil.mask":a=q(a);E(a,".push(",b,");");K(a,".pop();");break;case "stencil.func":a=q(a);E(a,".push(",da,"[",b,".cmp],",b,".ref|0,",'"mask" in ',b,"?",
b,".mask:-1);");K(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":a=q(a);E(a,".push(",fa,"[",b,'.fail||"keep"],',fa,"[",b,'.zfail||"keep"],',fa,"[",b,'.pass||"keep"]);');K(a,".pop();");break;case "polygonOffset.offset":a=q(a);E(a,".push(",b,".factor||0,",b,".units||0);");K(a,".pop();");break;case "cull.face":a=q(a);E(a,".push(",b,'==="front"?',1028,":",1029,");");K(a,".pop();");break;case "frontFace":a=q(a);E(a,".push(",b,'==="cw"?',2304,":",2305,");");K(a,".pop();");break;case "colorMask":a=
q(a);E(a,".push(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");K(a,".pop();");break;case "sample.coverage":a=q(a);E(a,".push(",b,".value,",b,".invert);");K(a,".pop();");break;case "scissor.box":case "viewport":a=q(a);E(a,".push(",b,".x||0,",b,".y||0,",'"w" in ',b,"?",b,".w:-1,",'"h" in ',b,"?",b,".h:-1);");K(a,".pop();");break;case "elements":a=!("primitive"in h)&&!("primitive"in c);var d=!("count"in h)&&!("count"in c),A=!("offset"in h)&&!("offset"in c),l=E.def();E("if(",b,"){",l,"=",b,"._elements;",ba,
".push(",l,");",a?F.primitive+".push("+l+".primType);":"",d?F.count+".push("+l+".vertCount);":"",A?F.offset+".push("+l+".offset);":"","}else{",ba,".push(null);","}");K(ba,".pop();","if(",b,"){",a?F.primitive+".pop();":"",d?F.count+".pop();":"",A?F.offset+".pop();":"","}")}});Object.keys(e).forEach(function(a){var b=m(Q.def(a));a=y(e[a]);E(b,".push(",a,");");K(b,".pop();")});Object.keys(p).forEach(function(a){var b=m(w.def(a)),c=y(p[a]);a=m(w.box(a));E(b,".records.push(",a,".alloc(",c,"));");K(a,".free(",
b,".records.pop());")});var W=z("scope"),Z=W.arg(),sa=W.arg();W(C);v&&W(ea,"=",Z,";",E);W(sa,"();",v?K:"",J);W=B();B=W.def();c.frag&&c.vert?(Z=c.frag,W(B,"=",m(U.program(g.id(c.vert),g.id(Z))),";")):W(B,"=",A,".program","(",A,".vert[",A,".vert.length-1]",",",A,".frag[",A,".frag.length-1]",");");Z=z("draw");Z(C,W);v&&Z(ea,"=",Z.arg(),";",E);Z(x,"();","if(",B,")",B,".draw(",v?ea:"",");",v?K:"",J);var na=z("batch");na(C,W);v=m(function(a,b,d){var A=a.batchCache[L];A||(A=a.batchCache[L]=ja(a,h,e,p,c));
return A(b,d)});na("if(",B,"){",x,"();",v,"(",B,",",na.arg(),",",na.arg(),");");Object.keys(h).forEach(function(a){(a=ma[a])&&na(a,".setDirty();")});na("}",J);return r.compile()}}}},{"./constants/primitives.json":7,"./util/codegen":23}],5:[function(e,g,k){g.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,
"[object ArrayBuffer]":5121}},{}],6:[function(e,g,k){g.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],7:[function(e,g,k){g.exports={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],8:[function(e,g,k){function b(a,b){function e(){var b=window.innerWidth,h=window.innerHeight;a!==document.body&&(h=a.getBoundingClientRect(),b=h.right-h.left,h=h.top-h.bottom);t.width=g*b;t.height=g*h;d(t.style,{width:b+"px",
height:h+"px"})}var t=document.createElement("canvas"),l=p(t,b);d(t.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(t);a===document.body&&(t.style.position="absolute",d(a.style,{margin:0,padding:0}));var g=+l.options.pixelRatio;window.addEventListener("resize",e,!1);var k=l.options.onDestroy;l.options=d(d({},l.options),{onDestroy:function(){window.removeEventListener("resize",e);a.removeChild(t);k&&k()}});e();return l}function p(a,b){function e(b){try{return a.getContext(b,p)}catch(d){return null}}
var p=b.glOptions||{};return{gl:e("webgl")||e("experimental-webgl")||e("webgl-experimental"),options:d({pixelRatio:window.devicePixelRatio},b)}}var d=e("./util/extend");g.exports=function(a){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:a[0],options:a[1]||{}};var e=document.body,f=a[1]||{};if("string"===typeof a[0])e=document.querySelector(a[0])||document.body;else if("object"===typeof a[0])if(a[0]instanceof HTMLElement)e=a[0];else{if(a[0]instanceof WebGLRenderingContext)return{gl:a[0],
options:d({pixelRatio:1},f)};f=a[0]}return e.nodeName&&"CANVAS"===e.nodeName.toUpperCase()?p(e,f):b(e,f)}},{"./util/extend":24}],9:[function(e,g,k){g.exports=function(b){return{primitive:[4],count:[-1],offset:[0],instances:[0]}}},{}],10:[function(e,g,k){function b(a,b){this.id=d++;this.func=a;this.data=b}function p(a,d){switch(typeof a){case "boolean":case "number":case "string":return new b(!1,a);case "function":return new b(!0,a);default:return p}}var d=0;g.exports={define:p,isDynamic:function(a){return"function"===
typeof a&&!a._reglType||a instanceof b},unbox:function(a,d){return a instanceof b?a:"function"===typeof a&&a!==p?new b(!0,a):new b(!1,d)}}},{}],11:[function(e,g,k){var b=e("./util/is-typed-array"),p=e("./util/is-ndarray"),d=e("./constants/primitives.json");g.exports=function(a,e,f){function g(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}g.prototype.bind=function(){this.buffer.bind()};return{create:function(a){function k(a){var l=e.oes_element_index_uint;if(a)if("number"===typeof a)u(a);
else{var c=null,f="static",q=0;Array.isArray(a)||b(a)||p(a)?c=a:("data"in a&&(c=a.data),"usage"in a&&(f=a.usage),"length"in a&&(q=a.length));Array.isArray(c)||p(c)&&"array"===c.dtype||"type"in a?u({type:a.type||(l?"uint32":"uint16"),usage:f,data:c,length:q}):u({usage:f,data:c,length:q});if(Array.isArray(c)||b(c))u.dimension=3}else u();l=y.buffer.byteLength;c=0;switch(y.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;l>>=1;break;case 5125:case 5124:c=5125,l>>=2}f=4;q=y.buffer.dimension;
1===q&&(f=0);2===q&&(f=1);3===q&&(f=4);"object"===typeof a&&("primitive"in a&&(f=d[a.primitive]),"count"in a&&(l=a.vertCount|0));y.primType=f;y.vertCount=l;y.type=c;return k}var y=new g,u=f.create(null,34963,!0);y.buffer=u._buffer;k(a);k._reglType="elements";k._elements=y;k.destroy=function(){u.destroy();y.buffer=null};return k},elements:[null],getElements:function(a){return a&&a._elements instanceof g?a._elements:null}}}},{"./constants/primitives.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26}],
12:[function(e,g,k){g.exports=function(b){function e(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{d[a]=
b.getExtension(a)}catch(e){}})}var d={};e();return{extensions:d,refresh:e}}},{}],13:[function(e,g,k){var b=e("./util/values"),p=e("./util/extend"),d=[1029];g.exports=function(a,e,f,g,l){function k(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function y(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function u(a,b){var c=b.width,d=b.height;if(a.texture)var e=a.texture._texture,h=Math.max(1,e.params.width>>a.level),l=Math.max(1,
e.params.height>>a.level),c=c||h,d=d||l;else e=a.renderbuffer._renderbuffer,c=c||e.width,d=d||e.height;e.refCount+=1;b.width=c;b.height=d}function h(b,c){c?c.texture?a.framebufferTexture2D(36160,b,c.target,c.texture._texture.texture,c.level):a.framebufferRenderbuffer(36160,b,36161,c.renderbuffer._renderbuffer.renderbuffer):a.framebufferTexture2D(36160,b,3553,null,0)}function v(a){var b=3553,c=0,d=null,e=null;"object"===typeof a&&("level"in a&&(c=a.level|0),"target"in a&&(b=a.target|0));var h=a._reglType;
"texture"===h?d=a:"renderbuffer"===h&&(e=a,b=36161,c=0);return new k(b,c,d,e)}function c(a){return a&&(a.texture||a.renderbuffer)}function M(){this.id=X++;ja[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function q(b){a.isFramebuffer(b.framebuffer)||(b.framebuffer=a.createFramebuffer());G=!0;a.bindFramebuffer(36160,b.framebuffer);for(var c=b.colorAttachments,
d=0;d<c.length;++d)h(36064+d,c[d]);for(d=c.length;d<f.maxColorAttachments;++d)h(36064+d,null);h(36096,b.depthAttachment);h(36128,b.stencilAttachment);h(33306,b.depthStencilAttachment);e.webgl_draw_buffers&&e.webgl_draw_buffers.drawBuffersWEBGL(ka[c.length]);a.checkFramebufferStatus(36160)}function D(b){b=b.framebuffer;a.isFramebuffer(b)&&a.deleteFramebuffer(b)}function B(){return V[V.length-1]}var Q={rgba:6408},w={rgba4:32854,rgb565:36194,"rgb5 a1":32855};e.ext_srgb&&(w.srgba=35907);e.ext_color_buffer_half_float&&
(w.rgba16f=34842,w.rgb16f=34843);e.webgl_color_buffer_float&&(w.rgba32f=34836);var U=[],P=[];e.webgl_depth_texture&&(U.push(6402),P.push(34041));p(p({},Q),w);b(Q);b(w);w=5121;U={uint8:5121};e.oes_texture_half_float&&(w=U["half float"]=36193);e.oes_texture_float&&(w=U["float"]=5126);U.best=w;var ka=function(){for(var a=Array(f.maxDrawbuffers),b=0;b<=f.maxDrawbuffers;++b)for(var c=a[b]=Array(b),d=0;d<b;++d)c[d]=36064+d;return a}(),X=0,ja={},V=[null],G=!0;return{top:B,dirty:function(){return G},push:function(a){a=
a||null;G=G||a!==B();V.push(a);return G},pop:function(){var a=B();V.pop();return G=G||a!==B()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof M)?a:null},poll:function(){if(G){var b=V[V.length-1],c=e.webgl_draw_buffers;b?(a.bindFramebuffer(36160,b.framebuffer),c&&c.drawBuffersWEBGL(ka[b.colorAttachments.length])):(a.bindFramebuffer(36160,null),c&&c.drawBuffersWEBGL(d));G=!1}},create:function(b){function d(b){var h,f=b||{},p=b=0;if("shape"in
f){var M=f.shape;b=M[0];p=M[1]}else"radius"in f&&(b=p=f.radius),"width"in f&&(b=f.width),"height"in f&&(p=f.height);var n=null,M=!1;if("colorBuffers"in f||"colorBuffer"in f){n=f.colorBuffers||f.colorBuffer;Array.isArray(n)||(n=[n]);e.width=b;e.height=p;n=n.map(v);for(h=0;h<n.length;++h)u(n[h],e);b=e.width;p=e.height}else{var D=!0,B="rgba",r="uint8",m=1,M=!0;e.width=b=b||a.drawingBufferWidth;e.height=p=p||a.drawingBufferHeight;"format"in f&&(B=f.format,D=B in Q);"type"in f&&(r=f.type);"colorCount"in
f&&(m=f.colorCount|0);if(e.ownsColor)for(n=e.colorAttachments;n.length>m;)y(n.pop());else n=[];for(h=0;h<n.length;++h){var H;a:{H=n[h];var z=D,w=B,x=b,A=p;if(H.texture){var O=H.texture;if(z){O({format:w,type:r,width:x,height:A});O._texture.refCount+=1;H=!0;break a}}else if(O=H.renderbuffer,!z){O({format:w,width:x,height:A});O._renderbuffer.refCount+=1;H=!0;break a}y(H);H=!1}H||(n[h--]=n[n.length-1],n.pop())}for(;n.length<m;)D?n.push(new k(3553,0,g.create({format:B,type:r,width:b,height:p},3553),null)):
n.push(new k(36161,0,null,l.create({format:B,width:b,height:p})))}e.width=b;e.height=p;B=D=h=null;r=!1;"depthBuffer"in f&&(h=v(f.depthBuffer));"stencilBuffer"in f&&(D=v(f.stencilBuffer));"depthStencilBuffer"in f&&(B=v(f.depthStencilBuffer));if(h||D||B)u(h||D||B,e);else if(m=!0,z=H=!1,"depth"in f&&(m=!!f.depth),"stencil"in f&&(H=!!f.stencil),"depthTexture"in f&&(z=!!f.depthTexture),f=e.depthAttachment||e.stencilAttachment||e.depthStencilAttachment,w=null,m||H)r=!0,z?(z=H?"depth stencil":"depth",e.ownsDepthStencil&&
f.texture?(f.texture({format:z,width:b,height:p}),f.texture._texture.refCount+=1,w=f):w=new k(3553,0,g.create({format:z,width:b,height:p},3553),null)):(z=m?H?"depth stencil":"depth":"stencil",e.ownsDepthStencil&&f.renderbuffer?(f.renderbuffer({format:z,width:b,height:p}),f.renderbuffer._renderbuffer.refCount+=1,w=f):w=new k(36161,0,null,l.create({format:z,width:b,height:p}))),m?H?B=w:h=w:D=w;b=e;b.colorAttachments.forEach(y);y(b.depthAttachment);y(b.stencilAttachment);y(b.depthStencilAttachment);
e.colorAttachments=n;e.depthAttachment=h;e.stencilAttachment=D;e.depthStencilAttachment=B;e.ownsColor=M;e.ownsDepthStencil=r;d.color=n.map(c);d.depth=c(h);d.stencil=c(D);d.depthStencil=c(B);q(e);d.width=e.width;d.height=e.height;return d}var e=new M;d(b);d._reglType="framebuffer";d._framebuffer=e;d._destroy=function(){D(e)};return d},clear:function(){b(ja).forEach(D)},refresh:function(){b(ja).forEach(q)}}}},{"./util/extend":24,"./util/values":32}],14:[function(e,g,k){g.exports=function(b,e){var d=
1;e.ext_texture_filter_anisotropic&&(d=b.getParameter(34047));var a=1,g=1;e.webgl_draw_buffers&&(a=b.getParameter(34852),g=b.getParameter(36063));return{colorBits:[b.getParameter(3410),b.getParameter(3411),b.getParameter(3412),b.getParameter(3413)],depthBits:b.getParameter(3414),stencilBits:b.getParameter(3415),subpixelBits:b.getParameter(3408),extensions:Object.keys(e).filter(function(a){return!!e[a]}),maxAnisotropic:d,maxDrawbuffers:a,maxColorAttachments:g,pointSizeDims:b.getParameter(33901),lineWidthDims:b.getParameter(33902),
maxViewportDims:b.getParameter(3386),maxCombinedTextureUnits:b.getParameter(35661),maxCubeMapSize:b.getParameter(34076),maxRenderbufferSize:b.getParameter(34024),maxTextureUnits:b.getParameter(34930),maxTextureSize:b.getParameter(3379),maxAttributes:b.getParameter(34921),maxVertexUniforms:b.getParameter(36347),maxVertexTextureUnits:b.getParameter(35660),maxVaryingVectors:b.getParameter(36348),maxFragmentUniforms:b.getParameter(36349),glsl:b.getParameter(35724),renderer:b.getParameter(7937),vendor:b.getParameter(7936),
version:b.getParameter(7938)}}},{}],15:[function(e,g,k){var b=e("./util/is-typed-array");g.exports=function(e,d,a){return function(g){var f=g||{};b(g)?f={data:f}:2===arguments.length?f={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof g&&(f={});d();var t=f.x||0,l=f.y||0,k=f.width||a.width,y=f.height||a.height,f=f.data||new Uint8Array(k*y*4);e.pixelStorei(3333,4);e.readPixels(t,l,k,y,6408,5121,f);return f}}},{"./util/is-typed-array":26}],16:[function(e,g,k){var b=e("./util/values");g.exports=
function(e,d,a){function g(){this.id=k++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function f(a){e.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=e.createRenderbuffer());e.bindRenderbuffer(36161,a.renderbuffer);e.renderbufferStorage(36161,a.format,a.width,a.height)}function t(a){var b=a.renderbuffer;e.bindRenderbuffer(36161,null);e.isRenderbuffer(b)&&e.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete y[a.id]}var l={rgba4:32854,rgb565:36194,"rgb5 a1":32855,
depth:33189,stencil:36168,"depth stencil":34041};d.ext_srgb&&(l.srgba=35907);d.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);d.webgl_color_buffer_float&&(l.rgba32f=34836);var k=0,y={};g.prototype.decRef=function(){0===--this.refCount&&t(this)};return{create:function(a){function b(a){a=a||{};var e=0,g=0;"shape"in a?(g=a.shape,e=g[0]|0,g=g[1]|0):("radius"in a&&(e=g=a.radius|0),"width"in a&&(e=a.width|0),"height"in a&&(g=a.height|0));b.width=d.width=Math.max(e,1);b.height=d.height=Math.max(g,
1);d.format=32854;"format"in a&&(d.format=l[a.format]);f(d);return b}var d=new g;y[d.id]=d;b(a);b._reglType="renderbuffer";b._renderbuffer=d;b.destroy=function(){d.decRef()};return b},refresh:function(){b(y).forEach(f)},clear:function(){b(y).forEach(t)}}}},{"./util/values":32}],17:[function(e,g,k){function b(b,a,e,f){this.name=b;this.id=a;this.location=e;this.info=f}var p=e("./util/values");g.exports=function(d,a,e,f,g){function l(a,b){var c=35632===a?u:h,e=c[b];if(!e){var f=g.str(b),e=d.createShader(a);
d.shaderSource(e,f);d.compileShader(e);c[b]=e}return e}function k(a,b){this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function y(c){var h,p;h=l(35632,c.fragId);p=l(35633,c.vertId);var k=c.program=d.createProgram();d.attachShader(k,h);d.attachShader(k,p);d.linkProgram(k);var v=d.getProgramParameter(k,35718),u=c.uniforms=[];for(h=0;h<v;++h)if(p=d.getActiveUniform(k,h))if(1<p.size)for(var y=0;y<p.size;++y){var I=p.name.replace("[0]",
"["+y+"]");e.def(I);u.push(new b(I,g.id(I),d.getUniformLocation(k,I),p))}else e.def(p.name),u.push(new b(p.name,g.id(p.name),d.getUniformLocation(k,p.name),p));v=d.getProgramParameter(k,35721);u=c.attributes=[];for(h=0;h<v;++h)if(p=d.getActiveAttrib(k,h))a.def(p.name),u.push(new b(p.name,g.id(p.name),d.getAttribLocation(k,p.name),p));c.draw=f(c);c.batchCache={}}var u={},h={},v={},c=[];return{clear:function(){var a=d.deleteShader.bind(d);p(u).forEach(a);u={};p(h).forEach(a);h={};c.forEach(function(a){d.deleteProgram(a.program)});
c.length=0;v={}},refresh:function(){u={};h={};c.forEach(y)},program:function(a,b){var d=v[b];d||(d=v[b]={});var e=d[a];e||(e=new k(b,a),y(e),d[a]=e,c.push(e));return e},shader:l,frag:[-1],vert:[-1]}}},{"./util/values":32}],18:[function(e,g,k){var b=e("./util/stack"),p=e("./util/codegen");g.exports=function(d,a,e){function f(a,e){var c=b([!!e],function(b){b?d.enable(a):d.disable(a)});c.flag=a;return c}var g={dither:f(3024),"blend.enable":f(3042),"blend.color":b([0,0,0,0],function(a,b,c,e){d.blendColor(a,
b,c,e)}),"blend.equation":b([32774,32774],function(a,b){d.blendEquationSeparate(a,b)}),"blend.func":b([1,0,1,0],function(a,b,c,e){d.blendFuncSeparate(a,b,c,e)}),"depth.enable":f(2929,!0),"depth.func":b([513],function(a){d.depthFunc(a)}),"depth.range":b([0,1],function(a,b){d.depthRange(a,b)}),"depth.mask":b([!0],function(a){d.depthMask(a)}),"cull.enable":f(2884),"cull.face":b([1029],function(a){d.cullFace(a)}),frontFace:b([2305],function(a){d.frontFace(a)}),colorMask:b([!0,!0,!0,!0],function(a,b,c,
e){d.colorMask(a,b,c,e)}),lineWidth:b([1],function(a){d.lineWidth(a)}),"polygonOffset.enable":f(32823),"polygonOffset.offset":b([0,0],function(a,b){d.polygonOffset(a,b)}),"sample.alpha":f(32926),"sample.enable":f(32928),"sample.coverage":b([1,!1],function(a,b){d.sampleCoverage(a,b)}),"stencil.enable":f(2960),"stencil.mask":b([-1],function(a){d.stencilMask(a)}),"stencil.func":b([519,0,-1],function(a,b,c){d.stencilFunc(a,b,c)}),"stencil.opFront":b([7680,7680,7680],function(a,b,c){d.stencilOpSeparate(1028,
a,b,c)}),"stencil.opBack":b([7680,7680,7680],function(a,b,c){d.stencilOpSeparate(1029,a,b,c)}),"scissor.enable":f(3089),"scissor.box":b([0,0,-1,-1],function(b,e,c,f){var l=c,g=a.top();0>c&&(l=g?g.width-b:d.drawingBufferWidth-b);c=f;0>f&&(c=g?g.height-e:d.drawingBufferHeight-e);d.scissor(b,e,l,c)}),viewport:b([0,0,-1,-1],function(b,f,c,l){var g=c,p=a.top();0>c&&(g=p?p.width-b:d.drawingBufferWidth-b);c=l;0>l&&(c=p?p.height-f:d.drawingBufferHeight-f);d.viewport(b,f,g,c);e.width=g;e.height=c})},l=p(),
k=l.proc("poll"),y=l.proc("refresh");Object.keys(g).forEach(function(a){a=l.link(g[a]);k(a,".poll();");y(a,".setDirty();")});var u=l.compile();return{contextState:g,viewport:e,poll:u.poll,refresh:u.refresh,notifyViewportChanged:function(){g.viewport.setDirty();g["scissor.box"].setDirty()}}}},{"./util/codegen":23,"./util/stack":30}],19:[function(e,g,k){g.exports=function(){var b={"":0},e=[""];return{id:function(d){var a=b[d];if(a)return a;a=b[d]=e.length;e.push(d);return a},str:function(b){return e[b]}}}},
{}],20:[function(e,g,k){function b(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function p(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var d=a[0].length,e=1;e<b;++e)if(!Array.isArray(a[e])||a[e].length!==d)return!1;return!0}function d(a){return Object.prototype.toString.call(a)}function a(a){return"[object HTMLCanvasElement]"===d(a)}function H(a){return"[object CanvasRenderingContext2D]"===d(a)}var f=e("./util/extend"),t=e("./util/values"),
l=e("./util/is-typed-array"),I=e("./util/is-ndarray"),y=e("./util/load-texture"),u=e("./util/to-half-float"),h=e("./util/parse-dds"),v=[9984,9986,9985,9987];g.exports=function(c,e,g,k,B){function Q(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=
this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function w(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function U(a,b){var c,d,e=0,f=0,l=0,g=0,p=0,h=0,m=!1,k=!1,n=!1;for(c=0;c<b.length;++c)d=b[c],g=g||d.width<<d.miplevel,p=p||d.height<<d.miplevel,e=e||d.type,f=f||d.format,l=l||d.internalformat,
h=h||d.channels,m=m||d.needsPoll,k=k||d.needsListeners,d=d.miplevel,n=n||0<d;a.needsPoll=m;a.needsListeners=k;a.width=g;a.height=p;a.format=f;a.internalformat=l;a.type=e;if(3553!==a.target)for(c=0;6>c;++c);c=0<=v.indexOf(a.minFilter);a.genMipmaps=!n&&(a.genMipmaps||c);n=n||a.genMipmaps;a.minFilter||(a.minFilter=n?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=h),d.format||(d.format=f),d.internalformat||(d.internalformat=l),d.type||(d.type=
e)}function P(a){this.id=m++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new w(a);this.pixels=[]}function ka(a,b){function c(a,d){var e=d.mipmap,A;if(Array.isArray(e))for(var l=0;l<e.length;++l)A=new Q(a),A.parseFlags(b),A.parseFlags(d),A.parse(e[l],l),f.push(A);else A=new Q(a),A.parseFlags(b),A.parse(d,0),f.push(A)}var d;V(a);var e=a.params;w.call(e,a.target);var f=a.pixels;f.length=0;e.parse(b);if(3553===a.target)c(3553,
b);else{var l=b.faces||b;if(Array.isArray(l))for(d=0;6>d;++d)c(34069+d,l[d]);else if("string"!==typeof l)for(d=0;6>d;++d)c(34069+d,{})}U(e,f);e.needsListeners&&ja(a);e.needsPoll&&(a.pollId=z.length,z.push(a));X(a)}function X(a){c.isTexture(a.texture)||(a.texture=c.createTexture());var b=a.target,d=a.unit;0<=d?(c.activeTexture(33984+d),r=d):c.bindTexture(b,a.texture);for(var b=a.pixels,e=a.params,f=0;f<b.length;++f)b[f].upload(e);e.upload();0>d&&((d=x[r])?c.bindTexture(d.target,d.texture):(a.unit=
r,x[r]=a))}function ja(a){function b(a,c,d){var f=h(d);f.pixels.forEach(function(b){var d=new Q(f.cube?b.target:a);d.channels=f.channels;d.compressed=f.compressed;d.type=f.type;d.internalformat=f.format;d.format=ia[f.format];d.width=b.width;d.height=b.height;d.miplevel=b.miplevel||c;d.data=b.data;e.push(d)})}function c(){for(var f=0;f<e.length;++f){var l=e[f],g=l.image,p=l.video,F=l.xhr;g&&g.complete?(l.width=g.naturalWidth,l.height=g.naturalHeight):p&&2<p.readyState?(l.width=p.width,l.height=p.height):
F&&4===F.readyState&&(e[f]=e[e.length-1],e.pop(),F.removeEventListener("readystatechange",X),b(l.target,l.miplevel,F.response))}U(d,e);X(a)}var d=a.params,e=a.pixels;e.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){e.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",
c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function V(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((z[b]=z[z.length-1]).id=b,z.pop(),a.pollId=-1)}function G(a){var b=a.texture,d=a.unit,e=a.target;0<=d&&(c.activeTexture(33984+d),r=d,c.bindTexture(e,null),x[d]=null);V(a);c.isTexture(b)&&c.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete ca[a.id]}var n={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
R={repeat:10497,clamp:33071,mirror:33648},ga={nearest:9728,linear:9729},N=f({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ga),aa={none:0,browser:37444},S={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},T={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Y={};e.ext_srgb&&(T.srgb=35904,T.srgba=35906);e.oes_texture_float&&(S["float"]=5126);e.oes_texture_half_float&&
(S["half float"]=36193);e.webgl_depth_texture&&(f(T,{depth:6402,"depth stencil":34041}),f(S,{uint16:5123,uint32:5125,"depth stencil":34042}));e.webgl_compressed_texture_s3tc&&f(Y,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});e.webgl_compressed_texture_atc&&f(Y,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});e.webgl_compressed_texture_pvrtc&&f(Y,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});e.webgl_compressed_texture_etc1&&(Y["rgb etc1"]=36196);var ha=Array.prototype.slice.call(c.getParameter(34467));Object.keys(Y).forEach(function(a){var b=Y[a];0<=ha.indexOf(b)&&(T[a]=b)});var oa=Object.keys(T);g.textureFormats=oa;var ia=oa.reduce(function(a,b){var c=T[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});f(Q.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=aa[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=T[b];b in S&&(this.type=S[b]);b in Y&&(this.compressed=!0)}"type"in a&&(this.type=S[a.type]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=a.width),
"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(c,e){this.miplevel=e;this.width>>=e;this.height>>=e;var f=c;switch(typeof c){case "object":if(!c)return;
this.parseFlags(c);var g=c.data;if("string"===typeof g||g&&(l(g)||b(g)||I(g)||a(g)||H(g)||"[object HTMLImageElement]"===d(g)||"[object HTMLVideoElement]"===d(g)||p(g)))f=c.data;break;case "undefined":return}"string"===typeof f&&(f=y(f,this.crossOrigin));var g=null,h=!1;if(null!==f)if(l(f))this.data=f;else if(b(f))g=f,h=!0;else if(I(f)){Array.isArray(f.data)?(g=f.data,h=!0):this.data=f.data;var m=f.shape;this.width=m[0];this.height=m[1];this.channels=3===m.length?m[2]:1;m=f.stride;this.strideX=f.stride[0];
this.strideY=f.stride[1];this.strideC=3===m.length?f.stride[2]:1;this.offset=f.offset;this.needsTranspose=!0}else if(a(f)||H(f))a(f)?this.canvas=f:this.canvas=f.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===d(f))this.image=f,f.complete?(this.width=f.naturalWidth,this.height=f.naturalHeight):(this.width=this.width||f.naturalWidth,this.height=this.height||f.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===d(f))this.video=f,1<f.readyState?(this.width=f.width,this.height=f.height):(this.width=this.width||f.width,this.height=this.height||f.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===d(f))this.xhr=f,this.needsListeners=!0;else if(p(f)){var h=f[0].length,m=f.length,n=1,k,t,r,q;if(Array.isArray(f[0][0]))for(n=f[0][0].length,g=Array(h*m*n),t=q=0;t<m;++t)for(k=0;k<h;++k)for(r=0;r<n;++r)g[q++]=f[t][k][r];
else for(g=Array(h*m),t=q=0;t<m;++t)for(k=0;k<h;++k)g[q++]=f[t][k];this.width=h;this.height=m;this.channels=n;h=!0}else c.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||B.width)|0,this.height=(this.height||B.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,
6410,6407,6408][(this.channels=this.channels||4)-1]);f=this.internalformat;m=this.format=ia[f];if(!this.channels)switch(m){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}m=this.type;5126!==m&&36193!==m&&(m||(m=6402===f?5125:5121));this.type=m;if(h)switch(m){case 5121:this.data=new Uint8Array(g);break;case 5123:this.data=new Uint16Array(g);break;case 5125:this.data=new Uint32Array(g);break;case 5126:this.data=
new Float32Array(g);break;case 36193:this.data=u(g)}if(this.data&&this.needsTranspose){g=this.data;f=this.width;h=this.height;m=this.channels;n=this.strideX;k=this.strideY;t=this.strideC;r=this.offset;q=new g.constructor(f*h*m);for(var v=0,w=0;w<h;++w)for(var x=0;x<f;++x)for(var z=0;z<m;++z)q[v++]=g[k*w+n*x+t*z+r];this.data=q}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){c.pixelStorei(37440,
this.flipY);c.pixelStorei(37441,this.premultiplyAlpha);c.pixelStorei(37443,this.colorSpace);c.pixelStorei(3317,this.unpackAlignment);var b=this.target,d=this.miplevel,e=this.image,f=this.canvas,l=this.video,g=this.data,p=this.internalformat,h=this.format,m=this.type,n=this.width||Math.max(1,a.width>>d);a=this.height||Math.max(1,a.height>>d);l&&2<l.readyState?c.texImage2D(b,d,h,h,m,l):e&&e.complete?c.texImage2D(b,d,h,h,m,e):f?c.texImage2D(b,d,h,h,m,f):this.compressed?c.compressedTexImage2D(b,d,p,n,
a,0,g):this.copy?(k(),c.copyTexImage2D(b,d,h,this.x,this.y,n,a,0)):g?c.texImage2D(b,d,h,n,a,0,h,m,g):c.texImage2D(b,d,h,n||1,a||1,0,h,m,null)}});f(w.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=N[a.min]);"mag"in a&&(this.magFilter=ga[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=R[d]:Array.isArray(d)&&(b=R[d[0]],c=R[d[1]])}else"wrapS"in a&&(b=R[a.wrapS]),"wrapT"in a&&(c=R[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=n[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;c.texParameteri(a,10241,this.minFilter);c.texParameteri(a,10240,this.magFilter);c.texParameteri(a,10242,this.wrapS);c.texParameteri(a,10243,this.wrapT);e.ext_texture_filter_anisotropic&&c.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(c.hint(33170,this.mipmapHint),c.generateMipmap(a))}});
var r=0,m=0,ca={},z=[],L=g.maxTextureUnits,x=Array(L).map(function(){return null});f(P.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<L;++b){var d=x[b];if(d){if(0<d.bindCount)continue;d.unit=-1}x[b]=this;a=b;break}this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture);r=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&G(this)}});return{create:function(a,b){function c(a,e,f,l,g,h){var p=a||{};34067===b&&
6===arguments.length&&(p=[a,e,f,l,g,h]);ka(d,p);c.width=d.params.width;c.height=d.params.height;return c}var d=new P(b);ca[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){t(ca).forEach(X);for(var a=0;a<L;++a)x[a]=null;r=0;c.activeTexture(33984)},clear:function(){for(var a=0;a<L;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),x[a]=null;c.activeTexture(33984);r=0;t(ca).forEach(G)},poll:function(){z.forEach(X)},getTexture:function(a){return null}}}},
{"./util/extend":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/load-texture":27,"./util/parse-dds":28,"./util/to-half-float":31,"./util/values":32}],21:[function(e,g,k){g.exports=function(b){var e={};return{def:function(d){d=b.id(d);var a=e[d];a||(a=e[d]=[]);return a},uniforms:e}}},{}],22:[function(e,g,k){g.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],23:[function(e,g,k){var b=e("./extend");g.exports=
function(){function e(){var a=[],f=[];return b(function(){a.push.apply(a,Array.prototype.slice.call(arguments))},{def:function(){var b="v"+d++;f.push(b);0<arguments.length&&(a.push(b,"="),a.push.apply(a,Array.prototype.slice.call(arguments)),a.push(";"));return b},toString:function(){return[0<f.length?"var "+f+";":"",a.join("")].join("")}})}var d=0,a=[],g=[],f={};return{link:function(b){var e="g"+d++;a.push(e);g.push(b);return e},block:e,proc:function(a){var g=[],k=e(),y=k.toString;return f[a]=b(k,
{arg:function(){var a="a"+d++;g.push(a);return a},toString:function(){return["function(",g.join(),"){",y(),"}"].join("")}})},compile:function(){var b=['"use strict";return {'];Object.keys(f).forEach(function(a){b.push('"',a,'":',f[a].toString(),",")});b.push("}");return Function.apply(null,a.concat([b.join("")])).apply(null,g)}}}},{"./extend":24}],24:[function(e,g,k){g.exports=function(b,e){for(var d=Object.keys(e),a=0;a<d.length;++a)b[d[a]]=e[d[a]];return b}},{}],25:[function(e,g,k){var b=e("./is-typed-array");
g.exports=function(e){return"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||b(e.data))}},{"./is-typed-array":26}],26:[function(e,g,k){var b=e("../constants/arraytypes.json");g.exports=function(e){return Object.prototype.toString.call(e)in b}},{"../constants/arraytypes.json":5}],27:[function(e,g,k){g.exports=function(b,e){if("undefined"!==typeof document){var d;d=(d=/\.(\w+)(\?.*)?$/.exec(b))&&
d[1]?d[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(d))return d=document.createElement("video"),d.autoplay=!0,d.loop=!0,e&&(d.crossOrigin=e),d.src=b,d;if(0<=["dds"].indexOf(d))return d=new XMLHttpRequest,d.responseType="arraybuffer",d.open("GET",b,!0),d.send(),d;d=new Image;e&&(d.crossOrigin=e);d.src=b;return d}return null}},{}],28:[function(e,g,k){g.exports=function(e){function g(a){for(var b=n,c=R,d=0;d<T;++d){var f=Math.max(1,
b+3>>2)*Math.max(1,c+3>>2)*aa;ha.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(e,Y,f)});Y+=f;b>>=1;c>>=1}}var k=new Int32Array(e),G=k[D],n=k[Q],R=k[B],ga=l,N=0,aa=0,S=4;switch(k[P]){case h:aa=8;G&u?(S=3,N=d):N=a;break;case v:aa=16;N=H;break;case c:aa=16;N=f;break;case M:aa=8,N=t}var T=1;k[U]&I&&(T=Math.max(1,k[w]));var Y=k[q]+4,ha={width:n,height:R,channels:S,format:N,type:ga,compressed:!0,cube:!1,pixels:[]};if(k[ka]&y)for(ha.cube=!0,k=0;6>k;++k)g(p+k);else g(b);return ha};
var b=3553,p=34069,d=33776,a=33777,H=33778,f=33779,t=36196,l=5121,I=131072,y=512,u=64,h=827611204,v=861165636,c=894720068,M=826496069,q=1,D=2,B=3,Q=4,w=7,U=20,P=21,ka=28},{}],29:[function(e,g,k){g.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(b){return requestAnimationFrame(b)},cancel:function(b){return cancelAnimationFrame(b)}}:{next:function(b){setTimeout(b,30)},cancel:clearTimeout}},{}],30:[function(e,g,k){g.exports=function(b,e){var d=
b.length,a=b.slice(),g=b.slice(),f=!1,k=!0;return{push:function(){f=!1;for(var b=0;b<d;++b){var e=arguments[b];f=f||e!==g[b];a.push(e)}},pop:function(){f=!1;a.length-=d;for(var b=0;b<d;++b)f=f||a[a.length-d+b]!==g[b]},poll:function(){var b=a.length-d;if(f||k){switch(d){case 1:e(a[b]);break;case 2:e(a[b],a[b+1]);break;case 3:e(a[b],a[b+1],a[b+2]);break;case 4:e(a[b],a[b+1],a[b+2],a[b+3]);break;case 5:e(a[b],a[b+1],a[b+2],a[b+3],a[b+4]);break;case 6:e(a[b],a[b+1],a[b+2],a[b+3],a[b+4],a[b+5]);break;
default:e.apply(null,a.slice(b,a.length))}for(var I=0;I<d;++I)g[I]=a[b+I];k=f=!1}},setDirty:function(){k=!0}}}},{}],31:[function(e,g,k){g.exports=function(b){for(var e=new Float32Array(b),e=new Uint32Array(e.buffer),d=new Uint16Array(b.length),a=0;a<b.length;++a)if(isNaN(b[a]))d[a]=65535;else if(Infinity===b[a])d[a]=31744;else if(-Infinity===b[a])d[a]=64512;else{var g=e[a],f=g>>>31<<15,k=(g<<1>>>24)-127,g=g>>13&1023;d[a]=-24>k?f:-14>k?f+(g+1024>>-14-k):15<k?f+31744:f+(k+15<<10)+g}return d}},{}],32:[function(e,
g,k){g.exports=function(b){return Object.keys(b).map(function(e){return b[e]})}},{}],33:[function(e,g,k){var b=e("./lib/util/extend"),p=e("./lib/context"),d=e("./lib/strings"),a=e("./lib/extension"),H=e("./lib/limits"),f=e("./lib/buffer"),t=e("./lib/elements"),l=e("./lib/texture"),I=e("./lib/renderbuffer"),y=e("./lib/framebuffer"),u=e("./lib/uniform"),h=e("./lib/attribute"),v=e("./lib/shader"),c=e("./lib/draw"),M=e("./lib/state"),q=e("./lib/compile"),D=e("./lib/read"),B=e("./lib/dynamic"),Q=e("./lib/util/raf"),
w=e("./lib/util/clock");g.exports=function(){function e(){ba=Q.next(e);L.count+=1;if(L.width!==n.drawingBufferWidth||L.height!==n.drawingBufferHeight)L.width=n.drawingBufferWidth,L.height=n.drawingBufferHeight,x.notifyViewportChanged();var a=w();L.dt=a-L.t;L.t=a;m.poll();for(var b=0;b<F.length;++b)(0,F[b])(L.count,L.t,L.dt);L.renderTime=w()-a}function g(){ba&&(Q.cancel(e),ba=0)}function k(a){g();a.preventDefault();if(R.onContextLost)R.onContextLost()}function X(a){n.getError();ga.refresh();T.refresh();
m.refresh();ca.refresh();z.refresh();ia.refresh();x.refresh();if(R.onContextRestored)R.onContextRestored();e()}function ja(a){function c(a){var b={},e={};Object.keys(a).forEach(function(c){var f=a[c];B.isDynamic(f)?(d=!0,e[c]=B.unbox(f,c)):b[c]=f});return{dynamic:e,"static":b}}var d=!1,e=c(a.uniforms||{}),f=c(a.attributes||{});a=c(function(a){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=b({},a);delete d.uniforms;delete d.attributes;c("blend");
c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(a));var e=A.command(a["static"],e["static"],f["static"],a.dynamic,e.dynamic,f.dynamic,d),g=e.draw,h=e.batch,k=e.scope,l=[];return function(a,b){if("function"===typeof a)return k(null,a);if("function"===typeof b)return k(a,b);if("number"===typeof a){for(var c=a|0;l.length<c;)l.push(null);return h(a|0,l)}return Array.isArray(a)?h(a.length,a):g(a)}}function V(){z.poll();x.poll()}var G=p(Array.prototype.slice.call(arguments)),
n=G.gl,R=G.options,G=d(),ga=a(n),N=ga.extensions,aa={width:n.drawingBufferWidth,height:n.drawingBufferHeight},S=H(n,N),T=f(n),Y=t(n,N,T),ha=u(G),oa=h(n,N,S,T,G),ia=v(n,oa,ha,function(a){return A.draw(a)},G),r=c(n,N,T),m=l(n,N,S,V,aa),ca=I(n,N,S),z=y(n,N,S,m,ca),L={count:0,start:w(),dt:0,t:w(),renderTime:0,width:n.drawingBufferWidth,height:n.drawingBufferHeight,pixelRatio:R.pixelRatio},x=M(n,z,aa),aa=D(n,V,aa),A=q(n,G,N,S,T,Y,m,z,x,ha,oa,ia,r,L,V),O=n.canvas,F=[],ba=0;O&&(O.addEventListener("webglcontextlost",
k,!1),O.addEventListener("webglcontextrestored",X,!1));return b(ja,{clear:function(a){var b=0;V();var c=a.color;c&&(n.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(n.clearDepth(+a.depth),b|=256);"stencil"in a&&(n.clearStencil(a.stencil|0),b|=1024);n.clear(b)},prop:B.define,draw:ja({}),elements:function(a){return Y.create(a)},buffer:function(a){return T.create(a,34962)},texture:function(a){return m.create(a,3553)},cube:function(a){return 6===arguments.length?m.create(Array.prototype.slice.call(arguments),
34067):m.create(a,34067)},renderbuffer:function(a){return ca.create(a)},framebuffer:function(a){return z.create(a)},framebufferCube:function(a){},frame:function(a){F.push(a);!ba&&0<F.length&&e();return{cancel:function(){var b=F.find(function(b){return b===a});0>b||(F.splice(b,1),0>=F.length&&g())}}},stats:L,limits:S,read:aa,destroy:function(){g();O&&(O.removeEventListener("webglcontextlost",k),O.removeEventListener("webglcontextrestored",X));ia.clear();z.clear();ca.clear();m.clear();T.clear();if(R.onDestroy)R.onDestroy()}})}},
{"./lib/attribute":2,"./lib/buffer":3,"./lib/compile":4,"./lib/context":8,"./lib/draw":9,"./lib/dynamic":10,"./lib/elements":11,"./lib/extension":12,"./lib/framebuffer":13,"./lib/limits":14,"./lib/read":15,"./lib/renderbuffer":16,"./lib/shader":17,"./lib/state":18,"./lib/strings":19,"./lib/texture":20,"./lib/uniform":21,"./lib/util/clock":22,"./lib/util/extend":24,"./lib/util/raf":29}]},{},[1]);
