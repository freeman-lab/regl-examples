(function e$$0(k,m,d){function p(a,e){if(!m[a]){if(!k[a]){var q="function"==typeof require&&require;if(!e&&q)return q(a,!0);if(b)return b(a,!0);q=Error("Cannot find module '"+a+"'");throw q.code="MODULE_NOT_FOUND",q;}q=m[a]={exports:{}};k[a][0].call(q.exports,function(b){var d=k[a][1][b];return p(d?d:b)},q,q.exports,e$$0,k,m,d)}return m[a].exports}for(var b="function"==typeof require&&require,a=0;a<d.length;a++)p(d[a]);return p})({1:[function(c,k,m){var d=c("../regl")(),p=Array(1048576).fill(0).map(function(){return.9<
Math.random()?255:0}),b=Array(2).fill().map(function(){return d.framebuffer({colorBuffer:d.texture({radius:512,data:p,wrap:"repeat"}),depth:!1})}),a=d({frag:"\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float n = 0.0;\n    for(int dx=-1; dx<=1; ++dx)\n    for(int dy=-1; dy<=1; ++dy) {\n      n += texture2D(prevState, uv+vec2(dx,dy)/float(512)).r;\n    }\n    float s = texture2D(prevState, uv).r;\n    if(n > 3.0+s || n < 3.0) {\n      gl_FragColor = vec4(0,0,0,1);\n    } else {\n      gl_FragColor = vec4(1,1,1,1);\n    }\n  }",
framebuffer:function(a,d,n){return b[(n.count+1)%2]}}),I=d({frag:"\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float state = texture2D(prevState, uv).r;\n    gl_FragColor = vec4(vec3(state), 1);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main() {\n    uv = 0.5 * (position + 1.0);\n    gl_Position = vec4(position, 0, 1);\n  }",attributes:{position:d.buffer([-4,-4,4,-4,0,4])},uniforms:{prevState:function(a,
d,n){return b[n.count%2].color[0]}},depth:{enable:!1},count:3});d.frame(function(){I(function(){d.draw();a()})})},{"../regl":33}],2:[function(c,k,m){function d(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}var p=c("./constants/dtypes.json"),b=c("./util/extend");b(d.prototype,{equals:function(a,b){return this.pointer?a.pointer&&this.buffer===a.buffer&&this.size===b&&this.normalized===a.normalized&&
this.type===a.type&&this.offset===a.offset&&this.stride===a.stride&&this.divisor===a.divisor:!a.pointer&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w},set:function(a,b){(this.pointer=a.pointer)?(this.buffer=a.buffer,this.size=b,this.normalized=a.normalized,this.type=a.type,this.offset=a.offset,this.stride=a.stride,this.divisor=a.divisor):(this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w)}});k.exports=function(a,c,e,q,n){function k(a){for(var b=Array(16),g=0;16>g;++g)b[g]=new d;this.records=b;
this.top=-1;this.name=a}function F(a){for(var b=a.records,g=a.top;b.length-1<=g;)b.push(new d);return b[++a.top]}var C={};e=e.maxAttributes;for(var g=Array(e),w=0;w<e;++w)g[w]=new d;b(k.prototype,{pushVec:function(a,b,d,g){var n=F(this);n.pointer=!1;n.x=a;n.y=b;n.z=d;n.w=g},pushPtr:function(a,b,d,g,n,p,e){var c=F(this);c.pointer=!0;c.buffer=a;c.size=b;c.offset=d;c.stride=g;c.divisor=n;c.normalized=p;c.type=e},pushDyn:function(a){if("number"===typeof a)this.pushVec(a,0,0,0);else if(Array.isArray(a))this.pushVec(a[0],
a[1],a[2],a[3]);else{var b=q.getBuffer(a),d=0,g=0,n=0,e=0,c=!1,w=5126;b?w=b.dtype:(b=q.getBuffer(a.buffer),d=a.size||0,g=a.stride||0,n=a.offset||0,e=a.divisor||0,c=a.normalized||!1,w=b.dtype,"type"in a&&(w=p[a.type]));this.pushPtr(b,d,n,g,e,c,w)}},pop:function(){--this.top}});return{bindings:g,bind:function(b,d,g,n){g=g.records[g.top];n=g.size||n;if(!d.equals(g,n)){if(g.pointer){d.pointer||a.enableVertexAttribArray(b);d.buffer!==g.buffer&&g.buffer.bind();a.vertexAttribPointer(b,n,g.type,g.normalized,
g.stride,g.offset);var p=c.angle_instanced_arrays;p&&p.vertexAttribDivisorANGLE(b,g.divisor)}else d.pointer&&a.disableVertexAttribArray(b),a.vertexAttrib4f(b,g.x,g.y,g.z,g.w);d.set(g,n)}},def:function(a){var b=n.id(a),d=C[b];d||(d=C[b]=new k(a));return d}}}},{"./constants/dtypes.json":6,"./util/extend":24}],3:[function(c,k,m){function d(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);case 5122:return new Int16Array(b);
case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var p=c("./util/is-typed-array"),b=c("./util/is-ndarray"),a=c("./constants/arraytypes.json"),I=c("./constants/dtypes.json"),e=c("./util/values"),q={"static":35044,dynamic:35048,stream:35040};k.exports=function(n){function c(a,b){this.id=g++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function k(a){n.isBuffer(a.buffer)||(a.buffer=n.createBuffer());
a.bind();n.bufferData(a.type,a.data||a.byteLength,a.usage)}function C(a){var b=a.buffer;n.isBuffer(b)&&n.deleteBuffer(b);a.buffer=null;delete w[a.id]}var g=0,w={};c.prototype.bind=function(){n.bindBuffer(this.type,this.buffer)};return{create:function(g,e,aa){function v(g){var f=g||{};if(Array.isArray(f)||p(f)||b(f))f={data:f};else if("number"===typeof f)f={length:f|0};else if(null===f||void 0===f)f={};m.usage="usage"in f?q[f.usage]:35044;g=0;"type"in f&&(g=I[f.type]);var n=f.dimension|0||1,e=0,c=
null;if("data"in f)if(c=f.data,null===c)e=f.length|0;else{if(b(c)){var n=c.shape,e=c.stride,f=c.offset,x=0,w=0,aa=0,r=0;1===n.length?(x=n[0],w=1,aa=e[0],r=0):2===n.length&&(x=n[0],w=n[1],aa=e[0],r=e[1]);g=g||a[Object.prototype.toString.call(c)]|0||5126;for(var n=w,e=d(g,x*w),c=c.data,E=0,ja=0;ja<x;++ja)for(var R=0;R<w;++R)e[E++]=c[aa*ja+r*R+f];c=e}else if(Array.isArray(c))if(0<c.length&&Array.isArray(c[0])){n=c[0].length;g=g||5126;f=d(g,c.length*n);e=c;c=n;for(x=r=0;x<e.length;++x)for(aa=e[x],w=0;w<
c;++w)f[r++]=aa[w];c=f}else g=g||5126,c=d(g,c);else g=g||a[Object.prototype.toString.call(c)]|0;e=c.byteLength}else"length"in f&&(e=f.length|0);m.data=c;m.dtype=g||5121;m.byteLength=e;m.dimension=n;k(m);return v}var P=n.createBuffer(),m=new c(P,e);w[m.id]=m;aa||v(g);v._reglType="buffer";v._buffer=m;v.destroy=function(){C(m)};return v},clear:function(){e(w).forEach(C)},refresh:function(){e(w).forEach(k)},getBuffer:function(a){return a&&a._buffer instanceof c?a._buffer:null}}}},{"./constants/arraytypes.json":5,
"./constants/dtypes.json":6,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":32}],4:[function(c,k,m){function d(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function p(a,b,d,f){var n,c=",";switch(b){case 5126:n="1f";break;case 35664:n="2fv";break;case 35665:n="3fv";break;case 35666:n="4fv";break;case 35670:case 5124:n="1i";break;case 35671:case 35667:n="2iv";break;case 35672:case 35668:n=
"3iv";break;case 35673:case 35669:n="4iv";break;case 35674:n="Matrix2fv";c=",false,";break;case 35675:n="Matrix3fv";c=",false,";break;case 35676:n="Matrix4fv",c=",false,"}return a+".uniform"+n+"("+d+c+f+");"}function b(a){return a+"["+a+".length-1]"}function a(a,b){return"framebuffer"===a||a<b?-1:a>b?1:0}var I=c("./util/codegen"),e=c("./constants/primitives.json"),q=c("./constants/dtypes.json"),n={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,
"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},H={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},F={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,
invert:5386};k.exports=function(c,g,w,f,x,k,v,m,Q,K,T,da,U,ea,ha){function L(g,f,q,S,x){function E(a){var h=D[a];return h?h:h=D[a]=u(N[a])}function v(a){var h=a.id,b=da[h];if(b)return b;b=a.func?l.def(u(a.data),"(",Q,",",Y,",",J,")"):l.def(Q,".",a.data);return da[h]=b}function A(a,h){return a.find(function(a){return a.name===h})}function ca(a){return ka&&!(a in f||a in x)}var V=I(),u=V.link,l=V.proc("batch"),B=V.block(),y=l.def,Z=l.arg,h=u(c),O=u(g.program),X=u(T.bind),J=u(ea),ma=u(m),ia=u(U.count),
la=u(U.offset),qa=u(U.instances),ga=u(U.primitive),D={},z=u(k.elements),ia=y(b(ia)),la=y(b(la)),ga=y(b(ga)),z=y(b(z)),G,M,L=w.angle_instanced_arrays;L&&(G=y(b(qa)),M=u(L));var ka="elements"in f,qa=Z(),Z=Z(),Q=y(),Y=y(),da={};l(h,".useProgram(",O,");");g.uniforms.forEach(function(a){if(!(a.name in q)){var b=u(a.location),t=u(K.def(a.name)),t=t+"["+t+".length-1]";a=a.info.type;35678===a||35680===a?(a=y(t+"._texture"),l(p(h,5124,b,a+".bind()")),B(a,".unbind();")):l(p(h,a,b,t))}});g.attributes.forEach(function(a){if(!(S.name in
S)){var h=u(T.def(a.name));l(X,"(",a.location,",",u(T.bindings[a.location]),",",h,",",d(a.info.type),");")}});ka||l("if(",z,"){",h,".bindBuffer(",34963,",",z,".buffer.buffer);","}else{",h,".bindBuffer(",34963,",null);","}");l("for(",Y,"=0;",Y,"<",qa,";++",Y,"){",Q,"=",Z,"[",Y,"];");Object.keys(f).sort(a).forEach(function(a){function b(a){l("if(",t,"){",h,".enable(",a,");}else{",h,".disable(",a,");}")}var t=v(f[a]);switch(a){case "framebuffer":a=E("viewport");var g=E("scissor.box");l("if(",ma,".push(",
t,"&&",t,"._framebuffer)){",ma,".poll();",a,".setDirty();",g,".setDirty();","}");break;case "cull.enable":b(2884);break;case "blend.enable":b(3042);break;case "dither":b(3024);break;case "stencil.enable":b(2960);break;case "depth.enable":b(2929);break;case "scissor.enable":b(3089);break;case "polygonOffset.enable":b(32823);break;case "sample.alpha":b(32926);break;case "sample.enable":b(32928);break;case "depth.mask":l(h,".depthMask(",t,");");break;case "depth.func":a=u(H);l(h,".depthFunc(",a,"[",
t,"]);");break;case "depth.range":l(h,".depthRange(",t,"[0],",t,"[1]);");break;case "blend.color":l(h,".blendColor(",t,"[0],",t,"[1],",t,"[2],",t,"[3]);");break;case "blend.equation":a=u(r);l("if(typeof ",t,'==="string"){',h,".blendEquation(",a,"[",t,"]);","}else{",h,".blendEquationSeparate(",a,"[",t,".rgb],",a,"[",t,".alpha]);","}");break;case "blend.func":a=u(n);l(h,".blendFuncSeparate(",a,'["srcRGB" in ',t,"?",t,".srcRGB:",t,".src],",a,'["dstRGB" in ',t,"?",t,".dstRGB:",t,".dst],",a,'["srcAlpha" in ',
t,"?",t,".srcAlpha:",t,".src],",a,'["dstAlpha" in ',t,"?",t,".dstAlpha:",t,".dst]);");break;case "stencil.mask":l(h,".stencilMask(",t,");");break;case "stencil.func":a=u(H);l(h,".stencilFunc(",a,"[",t,'.cmp||"always"],',t,".ref|0,",'"mask" in ',t,"?",t,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":g=u(F);l(h,".stencilOpSeparate(","stencil.opFront"===a?1028:1029,",",g,"[",t,'.fail||"keep"],',g,"[",t,'.zfail||"keep"],',g,"[",t,'.pass||"keep"]);');break;case "polygonOffset.offset":l(h,
".polygonOffset(",t,".factor||0,",t,".units||0);");break;case "cull.face":l(h,".cullFace(",t,'==="front"?',1028,":",1029,");");break;case "lineWidth":l(h,".lineWidth(",t,");");break;case "frontFace":l(h,".frontFace(",t,'==="cw"?',2304,":",2305,");");break;case "colorMask":l(h,".colorMask(",t,"[0],",t,"[1],",t,"[2],",t,"[3]);");break;case "sample.coverage":l(h,".sampleCoverage(",t,".value,",t,".invert);");break;case "scissor.box":case "viewport":a=E(a),l(a,".push(",t,".x||0,",t,".y||0,",t,".w||-1,",
t,".h||-1);")}});("viewport"in f||"framebuffer"in f)&&l(E("viewport"),".poll();");("scissor.box"in f||"framebuffer"in f)&&l(E("scissor.box"),".poll();");"framebuffer"in f&&l(ma,".pop();");var ha=g.uniforms,na=[];Object.keys(q).forEach(function(a){var t=A(ha,a);if(t){var b=t.info.type,g=u(t.location);a=v(q[a]);35678===t.info.type||35680===t.info.type?(t=y(a+"._texture"),na.push(t),l(p(h,5124,g,t+".bind()"))):l(p(h,b,g,a))}});na.forEach(function(a){l(a,".unbind();")});var t=g.attributes;Object.keys(S).forEach(function(a){var b=
A(t,a);b&&l(X,"(",b.location,",",u(a.bindings[b.location]),",",v(S[a]),",",d(b.info.type),");")});f.count?l(ia,"=",v(f.count),";"):ca("count")||l("if(",ia,"){");f.offset&&l(la,"=",v(f.offset),";");f.primitive&&(g=u(e),l(ga,"=",g,"[",v(f.primitive),"];"));ka&&(g=v(f.elements),l(z,"=",g,"?",g,"._elements:null;"));ca("offset")&&l(la,"=0;");l("if(",z,"){");ca("count")&&l(ia,"=",z,".vertCount;","if(",ia,">0){");ca("primitive")&&l(ga,"=",z,".primType;");ka&&l(h,".bindBuffer(",34963,",",z,".buffer.buffer);");
L&&(f.instances&&l(G,"=",v(f.instances),";"),l("if(",G,">0){",M,".drawElementsInstancedANGLE(",ga,",",ia,",",z,".type,",la,",",G,");}else{"));l(h,".drawElements(",ga,",",ia,",",z,".type,",la,");");L&&l("}");ca("count")&&l("}");l("}else{");ca("count")||(ca("primitive")&&l(ga,"=",4,";"),L&&l("if(",G,">0){",M,".drawArraysInstancedANGLE(",ga,",",la,",",ia,",",G,");}else{"),l(h,".drawArrays(",ga,",",la,",",ia,");}"),L&&l("}"));l("}}",B);return V.compile().batch}var N=Q.contextState,r={add:32774,subtract:32778,
"reverse subtract":32779};w.ext_blend_minmax&&(r.min=32775,r.max=32776);var E=0;return{draw:function(a){var g=I(),f=g.link,n=g.proc("draw"),e=n.def,r=f(c),q=f(a.program),x=f(T.bind),E=f(U.count),v=f(U.offset),u=f(U.instances),l=f(U.primitive),H=f(k.elements),m=[];n(r,".useProgram(",q,");");a.attributes.forEach(function(a){var b=f(T.def(a.name));n(x,"(",a.location,",",f(T.bindings[a.location]),",",b,",",d(a.info.type),");")});a.uniforms.forEach(function(a){var b=f(a.location),g=f(K.def(a.name)),g=
g+"["+g+".length-1]";a=a.info.type;35678===a||35680===a?(a=e(g+"._texture"),m.push(a),n(p(r,5124,b,a+".bind()"))):n(p(r,a,b,g))});m.forEach(function(a){n(a,".unbind();")});a=e(b(l));E=e(b(E));v=e(b(v));H=e(b(H));n("if(",E,"){");(q=w.angle_instanced_arrays)?(u=e(b(u)),q=f(q),n("if(",H,"){",H,".bind();","if(",u,">0){",q,".drawElementsInstancedANGLE(",a,",",E,",",H,".type,",v,",",u,");}else{",r,".drawElements(",a,",",E,",",H,".type,",v,");}","}else if(",u,">0){",q,".drawArraysInstancedANGLE(",a,",",
v,",",E,",",u,");}else{",r,".drawArrays(",a,",",v,",",E,");}}")):n("if(",H,"){",r,".drawElements(",a,",",E,",",H,".type,",v,");}","}else{",r,".drawArrays(",a,",",v,",",E,");}");return g.compile().draw},command:function(b,f,d,c,p,w,v){function A(a){var b=ga[a];return b?b:b=ga[a]=l(N[a])}function C(a,b){var h=A(a);D(h,".push(",b,");");z(h,".pop();")}function V(a){var b=a.id,h=ra[b];if(h)return h;h=a.func?G.def(l(a.data),"(",ka,",0,",sa,")"):G.def(ka,".",a.data);return ra[b]=h}var u=I(),l=u.link,B=u.block,
y=u.proc,Q=E++,h=l(ha);l(g);var O=l(da),X=l(m),J={count:l(U.count),offset:l(U.offset),instances:l(U.instances),primitive:l(U.primitive)},ma=l(k.elements),ia=l(e),la=l(H),qa=l(F),ga={},D=B(),z=B();Object.keys(b).sort(a).forEach(function(a){var h=b[a];switch(a){case "frag":case "vert":h=g.id(h);da.shader("frag"===a?35632:35633,h);D(O,".",a,".push(",h,");");z(O,".",a,".pop();");break;case "framebuffer":m.getFramebuffer(h);a=A("viewport");var f=A("scissor.box");D("if(",X,".push(",l(h&&h._framebuffer),
")){",a,".setDirty();",f,".setDirty();","}");z("if(",X,".pop()){",a,".setDirty();",f,".setDirty();","}");break;case "count":case "offset":case "instances":D(J[a],".push(",h,");");z(J[a],".pop();");break;case "primitive":D(J.primitive,".push(",e[h],");");z(J.primitive,".pop();");break;case "elements":f=k.getElements(h);h=!("primitive"in b);a=!("count"in b);f?(f=l(f),D(ma,".push(",f,");"),h&&D(J.primitive,".push(",f,".primType);"),a&&D(J.count,".push(",f,".vertCount);")):(D(ma,".push(null);"),h&&D(J.primitive,
".push(",4,");"),a&&D(J.count,".push(0);"));h&&z(J.primitive,".pop();");a&&z(J.count,".pop();");"offset"in b||(D(J.offset,".push(0);"),z(J.offset,".pop();"));z(ma,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":C(a,h);break;case "depth.func":C(a,H[h]);break;case "depth.range":a=A(a);D(a,".push(",h[0],",",h[1],");");z(a,".pop();");
break;case "blend.func":a=A(a);D(a,".push(",n["srcRGB"in h?h.srcRGB:h.src],",",n["dstRGB"in h?h.dstRGB:h.dst],",",n["srcAlpha"in h?h.srcAlpha:h.src],",",n["dstAlpha"in h?h.dstAlpha:h.dst],");");z(a,".pop();");break;case "blend.equation":a=A(a);"string"===typeof h?D(a,".push(",r[h],",",r[h],");"):"object"===typeof h&&D(a,".push(",r[h.rgb],",",r[h.alpha],");");z(a,".pop();");break;case "blend.color":a=A(a);D(a,".push(",h[0],",",h[1],",",h[2],",",h[3],");");z(a,".pop();");break;case "stencil.mask":a=
A(a);D(a,".push(",h,");");z(a,".pop();");break;case "stencil.func":var f=h.cmp||"keep",d=h.ref||0,h="mask"in h?h.mask:-1;a=A(a);D(a,".push(",H[f],",",d,",",h,");");z(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":f=h.fail||"keep";d=h.zfail||"keep";h=h.pass||"keep";a=A(a);D(a,".push(",F[f],",",F[d],",",F[h],");");z(a,".pop();");break;case "polygonOffset.offset":f=h.factor||0;h=h.units||0;a=A(a);D(a,".push(",f,",",h,");");z(a,".pop();");break;case "cull.face":f=0;"front"===h?f=1028:
"back"===h&&(f=1029);h=A(a);D(h,".push(",f,");");z(h,".pop();");break;case "lineWidth":C(a,h);break;case "frontFace":f=0;"cw"===h?f=2304:"ccw"===h&&(f=2305);h=A(a);D(h,".push(",f,");");z(h,".pop();");break;case "colorMask":a=A(a);D(a,".push(",h.map(function(a){return!!a}).join(),");");z(a,".pop();");break;case "sample.coverage":f="value"in h?h.value:1;h=!!h.invert;a=A(a);D(a,".push(",f,",",h,");");z(a,".pop();");break;case "viewport":case "scissor.box":var f=h.x||0,d=h.y||0,c=-1,p=-1;"w"in h&&(c=
h.w);"h"in h&&(p=h.h);h=A(a);D(h,".push(",f,",",d,",",c,",",p,");");z(h,".pop();")}});Object.keys(f).forEach(function(a){var h=l(K.def(a));a=f[a];a="function"===typeof a&&a._reglType?l(a):Array.isArray(a)?l(a.slice()):+a;D(h,".push(",a,");");z(h,".pop();")});Object.keys(d).forEach(function(a){var h=l(T.def(a));a=d[a];if("number"===typeof a)D(h,".pushVec(",+a,",0,0,0);");else if(Array.isArray(a))D(h,".pushVec(",[a[0]||0,a[1]||0,a[2]||0,a[3]||0],");");else{var b=x.getBuffer(a),f=0,g=0,n=0,X=0,c=!1,
e=5126;b?e=b.dtype:(b=x.getBuffer(a.buffer),f=a.size||0,g=a.stride||0,n=a.offset||0,X=a.divisor||0,c=a.normalized||!1,e=b.dtype,"type"in a&&(e=q[a.type]));D(h,".pushPtr(",[l(b),f,n,g,X,c,e].join(),");")}z(h,".pop();")});var G=u.block(),M=u.block(),sa,ka;v&&(sa=l(ea),ka=D.def());var ra={};Object.keys(c).sort(a).forEach(function(a){var h=V(c[a]);switch(a){case "framebuffer":a=A("viewport");var f=A("scissor.box");G("if(",X,".push(",h,"&&",h,"._framebuffer)){",a,".setDirty();",f,".setDirty();","}");M("if(",
X,".pop()){",a,".setDirty();",f,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":a=A(a);G(a,".push(",h,");");M(a,".pop();");break;case "count":case "offset":case "instances":a=J[a];G(a,".push(",h,");");M(a,".pop();");break;case "primitive":a=J.primitive;G(a,".push(",ia,"[",h,"]);");M(a,".pop();");break;
case "depth.func":a=A(a);G(a,".push(",la,"[",h,"]);");M(a,".pop();");break;case "blend.func":a=A(a);f=l(n);G(a,".push(",f,'["srcRGB" in ',h,"?",h,".srcRGB:",h,".src],",f,'["dstRGB" in ',h,"?",h,".dstRGB:",h,".dst],",f,'["srcAlpha" in ',h,"?",h,".srcAlpha:",h,".src],",f,'["dstAlpha" in ',h,"?",h,".dstAlpha:",h,".dst]);");M(a,".pop();");break;case "blend.equation":a=A(a);f=l(r);G("if(typeof ",h,'==="string"){',a,".push(",f,"[",h,"],",f,"[",h,"]);","}else{",a,".push(",f,"[",h,".rgb],",f,"[",h,".alpha]);",
"}");M(a,".pop();");break;case "blend.color":a=A(a);G(a,".push(",h,"[0],",h,"[1],",h,"[2],",h,"[3]);");M(a,".pop();");break;case "stencil.mask":a=A(a);G(a,".push(",h,");");M(a,".pop();");break;case "stencil.func":a=A(a);G(a,".push(",la,"[",h,".cmp],",h,".ref|0,",'"mask" in ',h,"?",h,".mask:-1);");M(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":a=A(a);G(a,".push(",qa,"[",h,'.fail||"keep"],',qa,"[",h,'.zfail||"keep"],',qa,"[",h,'.pass||"keep"]);');M(a,".pop();");break;case "polygonOffset.offset":a=
A(a);G(a,".push(",h,".factor||0,",h,".units||0);");M(a,".pop();");break;case "cull.face":a=A(a);G(a,".push(",h,'==="front"?',1028,":",1029,");");M(a,".pop();");break;case "frontFace":a=A(a);G(a,".push(",h,'==="cw"?',2304,":",2305,");");M(a,".pop();");break;case "colorMask":a=A(a);G(a,".push(",h,"[0],",h,"[1],",h,"[2],",h,"[3]);");M(a,".pop();");break;case "sample.coverage":a=A(a);G(a,".push(",h,".value,",h,".invert);");M(a,".pop();");break;case "scissor.box":case "viewport":a=A(a);G(a,".push(",h,
".x||0,",h,".y||0,",'"w" in ',h,"?",h,".w:-1,",'"h" in ',h,"?",h,".h:-1);");M(a,".pop();");break;case "elements":a=!("primitive"in c)&&!("primitive"in b);var f=!("count"in c)&&!("count"in b),g=!("offset"in c)&&!("offset"in b),d=G.def();G("if(",h,"){",d,"=",h,"._elements;",ma,".push(",d,");",a?J.primitive+".push("+d+".primType);":"",f?J.count+".push("+d+".vertCount);":"",g?J.offset+".push("+d+".offset);":"","}else{",ma,".push(null);","}");M(ma,".pop();","if(",h,"){",a?J.primitive+".pop();":"",f?J.count+
".pop();":"",g?J.offset+".pop();":"","}")}});Object.keys(p).forEach(function(a){var h=l(K.def(a));a=V(p[a]);G(h,".push(",a,");");M(h,".pop();")});Object.keys(w).forEach(function(a){var h=l(T.def(a));a=V(w[a]);G(h,".pushDyn(",a,");");M(h,".pop();")});var Y=y("scope"),pa=Y.arg(),ta=Y.arg();Y(D);v&&Y(ka,"=",pa,";",G);Y(ta,"();",v?M:"",z);Y=B();B=Y.def();b.frag&&b.vert?(pa=b.frag,Y(B,"=",l(da.program(g.id(b.vert),g.id(pa))),";")):Y(B,"=",O,".program","(",O,".vert[",O,".vert.length-1]",",",O,".frag[",
O,".frag.length-1]",");");pa=y("draw");pa(D,Y);v&&pa(ka,"=",pa.arg(),";",G);pa(h,"();","if(",B,")",B,".draw(",v?ka:"",");",v?M:"",z);var na=y("batch");na(D,Y);v=l(function(a,h,f){var g=a.batchCache[Q];g||(g=a.batchCache[Q]=L(a,c,p,w,b));return g(h,f)});na("if(",B,"){",h,"();",v,"(",B,",",na.arg(),",",na.arg(),");");Object.keys(c).forEach(function(a){(a=ga[a])&&na(a,".setDirty();")});na("}",z);return u.compile()}}}},{"./constants/dtypes.json":6,"./constants/primitives.json":7,"./util/codegen":23}],
5:[function(c,k,m){k.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],6:[function(c,k,m){k.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],7:[function(c,k,m){k.exports={points:0,lines:1,"line loop":2,"line strip":3,
triangles:4,"triangle strip":5,"triangle fan":6}},{}],8:[function(c,k,m){function d(a,d){function c(){var d=window.innerWidth,g=window.innerHeight;a!==document.body&&(g=a.getBoundingClientRect(),d=g.right-g.left,g=g.top-g.bottom);q.width=k*d;q.height=k*g;b(q.style,{width:d+"px",height:g+"px"})}var q=document.createElement("canvas"),n=p(q,d);b(q.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(q);a===document.body&&(q.style.position="absolute",b(a.style,{margin:0,padding:0}));var k=
+n.options.pixelRatio;window.addEventListener("resize",c,!1);var m=n.options.onDestroy;n.options=b(b({},n.options),{onDestroy:function(){window.removeEventListener("resize",c);a.removeChild(q);m&&m()}});c();return n}function p(a,d){function c(b){try{return a.getContext(b,p)}catch(d){return null}}var p=d.glOptions||{};return{gl:c("webgl")||c("experimental-webgl")||c("webgl-experimental"),options:b({pixelRatio:window.devicePixelRatio},d)}}var b=c("./util/extend");k.exports=function(a){if("undefined"===
typeof document||"undefined"===typeof HTMLElement)return{gl:a[0],options:a[1]||{}};var c=document.body,e=a[1]||{};if("string"===typeof a[0])c=document.querySelector(a[0])||document.body;else if("object"===typeof a[0])if(a[0]instanceof HTMLElement)c=a[0];else{if(a[0]instanceof WebGLRenderingContext)return{gl:a[0],options:b({pixelRatio:1},e)};e=a[0]}return c.nodeName&&"CANVAS"===c.nodeName.toUpperCase()?p(c,e):d(c,e)}},{"./util/extend":24}],9:[function(c,k,m){k.exports=function(d){return{primitive:[4],
count:[0],offset:[0],instances:[0]}}},{}],10:[function(c,k,m){function d(a,d){this.id=b++;this.func=a;this.data=d}function p(a,b){switch(typeof a){case "boolean":case "number":case "string":return new d(!1,a);case "function":return new d(!0,a);default:return p}}var b=0;k.exports={define:p,isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof d},unbox:function(a,b){return a instanceof d?a:"function"===typeof a&&a!==p?new d(!0,a):new d(!1,b)}}},{}],11:[function(c,k,m){var d=
c("./util/is-typed-array"),p=c("./util/is-ndarray"),b=c("./constants/primitives.json");k.exports=function(a,c,e){function q(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}q.prototype.bind=function(){this.buffer.bind()};return{create:function(a){function k(a){var n=c.oes_element_index_uint;if(a)if("number"===typeof a)C(a);else{var f=null,e="static",q=0;Array.isArray(a)||d(a)||p(a)?f=a:("data"in a&&(f=a.data),"usage"in a&&(e=a.usage),"length"in a&&(q=a.length));Array.isArray(f)||p(f)&&
"array"===f.dtype||"type"in a?C({type:a.type||(n?"uint32":"uint16"),usage:e,data:f,length:q}):C({usage:e,data:f,length:q});if(Array.isArray(f)||d(f))C.dimension=3}else C();n=m.buffer.byteLength;f=0;switch(m.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;n>>=1;break;case 5125:case 5124:f=5125,n>>=2}e=4;q=m.buffer.dimension;1===q&&(e=0);2===q&&(e=1);3===q&&(e=4);"object"===typeof a&&("primitive"in a&&(e=b[a.primitive]),"count"in a&&(n=a.vertCount|0));m.primType=e;m.vertCount=
n;m.type=f;return k}var m=new q,C=e.create(null,34963,!0);m.buffer=C._buffer;k(a);k._reglType="elements";k._elements=m;k.destroy=function(){C.destroy();m.buffer=null};return k},elements:[null],getElements:function(a){return a&&a._elements instanceof q?a._elements:null}}}},{"./constants/primitives.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26}],12:[function(c,k,m){k.exports=function(d){function c(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{b[a]=
d.getExtension(a)}catch(c){}})}var b={};c();return{extensions:b,refresh:c}}},{}],13:[function(c,k,m){var d=c("./util/values"),p=c("./util/extend"),b=[1029];k.exports=function(a,c,e,q,n){function k(a,b,f,d){this.target=a;this.level=b;this.texture=f;this.renderbuffer=d}function m(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function C(a,b){var f=b.width,d=b.height;if(a.texture)var g=a.texture._texture,c=Math.max(1,g.params.width>>a.level),n=Math.max(1,
g.params.height>>a.level),f=f||c,d=d||n;else g=a.renderbuffer._renderbuffer,f=f||g.width,d=d||g.height;g.refCount+=1;b.width=f;b.height=d}function g(b,f){f?f.texture?a.framebufferTexture2D(36160,b,f.target,f.texture._texture.texture,f.level):a.framebufferRenderbuffer(36160,b,36161,f.renderbuffer._renderbuffer.renderbuffer):a.framebufferTexture2D(36160,b,3553,null,0)}function w(a){var b=3553,f=0,d=null,g=null;"object"===typeof a&&("level"in a&&(f=a.level|0),"target"in a&&(b=a.target|0));var c=a._reglType;
"texture"===c?d=a:"renderbuffer"===c&&(g=a,b=36161,f=0);return new k(b,f,d,g)}function f(a){return a&&(a.texture||a.renderbuffer)}function x(){this.id=ea++;ha[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function aa(b){a.isFramebuffer(b.framebuffer)||(b.framebuffer=a.createFramebuffer());N=!0;a.bindFramebuffer(36160,b.framebuffer);for(var f=
b.colorAttachments,d=0;d<f.length;++d)g(36064+d,f[d]);for(d=f.length;d<e.maxColorAttachments;++d)g(36064+d,null);g(36096,b.depthAttachment);g(36128,b.stencilAttachment);g(33306,b.depthStencilAttachment);c.webgl_draw_buffers&&c.webgl_draw_buffers.drawBuffersWEBGL(U[f.length]);a.checkFramebufferStatus(36160)}function v(b){b=b.framebuffer;a.isFramebuffer(b)&&a.deleteFramebuffer(b)}function P(){return L[L.length-1]}var Q={rgba:6408},K={rgba4:32854,rgb565:36194,"rgb5 a1":32855};c.ext_srgb&&(K.srgba=35907);
c.ext_color_buffer_half_float&&(K.rgba16f=34842,K.rgb16f=34843);c.webgl_color_buffer_float&&(K.rgba32f=34836);var T=[],da=[];c.webgl_depth_texture&&(T.push(6402),da.push(34041));p(p({},Q),K);d(Q);d(K);K=5121;T={uint8:5121};c.oes_texture_half_float&&(K=T["half float"]=36193);c.oes_texture_float&&(K=T["float"]=5126);T.best=K;var U=function(){for(var a=Array(e.maxDrawbuffers),b=0;b<=e.maxDrawbuffers;++b)for(var f=a[b]=Array(b),d=0;d<b;++d)f[d]=36064+d;return a}(),ea=0,ha={},L=[null],N=!0;return{top:P,
dirty:function(){return N},push:function(a){a=a||null;N=N||a!==P();L.push(a);return N},pop:function(){var a=P();L.pop();return N=N||a!==P()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof x)?a:null},poll:function(){if(N){var f=L[L.length-1],d=c.webgl_draw_buffers;f?(a.bindFramebuffer(36160,f.framebuffer),d&&d.drawBuffersWEBGL(U[f.colorAttachments.length])):(a.bindFramebuffer(36160,null),d&&d.drawBuffersWEBGL(b));N=!1}},create:function(b){function d(b){var c,
e=b||{},p=b=0;if("shape"in e){var v=e.shape;b=v[0];p=v[1]}else"radius"in e&&(b=p=e.radius),"width"in e&&(b=e.width),"height"in e&&(p=e.height);var x=null,v=!1;if("colorBuffers"in e||"colorBuffer"in e){x=e.colorBuffers||e.colorBuffer;Array.isArray(x)||(x=[x]);g.width=b;g.height=p;x=x.map(w);for(c=0;c<x.length;++c)C(x[c],g);b=g.width;p=g.height}else{var r=!0,I="rgba",P="uint8",u=1,v=!0;g.width=b=b||a.drawingBufferWidth;g.height=p=p||a.drawingBufferHeight;"format"in e&&(I=e.format,r=I in Q);"type"in
e&&(P=e.type);"colorCount"in e&&(u=e.colorCount|0);if(g.ownsColor)for(x=g.colorAttachments;x.length>u;)m(x.pop());else x=[];for(c=0;c<x.length;++c){var l;a:{l=x[c];var B=r,y=I,L=b,h=p;if(l.texture){var O=l.texture;if(B){O({format:y,type:P,width:L,height:h});O._texture.refCount+=1;l=!0;break a}}else if(O=l.renderbuffer,!B){O({format:y,width:L,height:h});O._renderbuffer.refCount+=1;l=!0;break a}m(l);l=!1}l||(x[c--]=x[x.length-1],x.pop())}for(;x.length<u;)r?x.push(new k(3553,0,q.create({format:I,type:P,
width:b,height:p},3553),null)):x.push(new k(36161,0,null,n.create({format:I,width:b,height:p})))}g.width=b;g.height=p;I=r=c=null;P=!1;"depthBuffer"in e&&(c=w(e.depthBuffer));"stencilBuffer"in e&&(r=w(e.stencilBuffer));"depthStencilBuffer"in e&&(I=w(e.depthStencilBuffer));if(c||r||I)C(c||r||I,g);else if(u=!0,B=l=!1,"depth"in e&&(u=!!e.depth),"stencil"in e&&(l=!!e.stencil),"depthTexture"in e&&(B=!!e.depthTexture),e=g.depthAttachment||g.stencilAttachment||g.depthStencilAttachment,y=null,u||l)P=!0,B?
(B=l?"depth stencil":"depth",g.ownsDepthStencil&&e.texture?(e.texture({format:B,width:b,height:p}),e.texture._texture.refCount+=1,y=e):y=new k(3553,0,q.create({format:B,width:b,height:p},3553),null)):(B=u?l?"depth stencil":"depth":"stencil",g.ownsDepthStencil&&e.renderbuffer?(e.renderbuffer({format:B,width:b,height:p}),e.renderbuffer._renderbuffer.refCount+=1,y=e):y=new k(36161,0,null,n.create({format:B,width:b,height:p}))),u?l?I=y:c=y:r=y;b=g;b.colorAttachments.forEach(m);m(b.depthAttachment);m(b.stencilAttachment);
m(b.depthStencilAttachment);g.colorAttachments=x;g.depthAttachment=c;g.stencilAttachment=r;g.depthStencilAttachment=I;g.ownsColor=v;g.ownsDepthStencil=P;d.color=x.map(f);d.depth=f(c);d.stencil=f(r);d.depthStencil=f(I);aa(g);d.width=g.width;d.height=g.height;return d}var g=new x;d(b);d._reglType="framebuffer";d._framebuffer=g;d._destroy=function(){v(g)};return d},clear:function(){d(ha).forEach(v)},refresh:function(){d(ha).forEach(aa)}}}},{"./util/extend":24,"./util/values":32}],14:[function(c,k,m){k.exports=
function(d,c){var b=1;c.ext_texture_filter_anisotropic&&(b=d.getParameter(34047));var a=1,k=1;c.webgl_draw_buffers&&(a=d.getParameter(34852),k=d.getParameter(36063));return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),subpixelBits:d.getParameter(3408),extensions:Object.keys(c).filter(function(a){return!!c[a]}),maxAnisotropic:b,maxDrawbuffers:a,maxColorAttachments:k,pointSizeDims:d.getParameter(33901),
lineWidthDims:d.getParameter(33902),maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),maxVertexTextureUnits:d.getParameter(35660),maxVaryingVectors:d.getParameter(36348),maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),
renderer:d.getParameter(7937),vendor:d.getParameter(7936),version:d.getParameter(7938)}}},{}],15:[function(c,k,m){var d=c("./util/is-typed-array");k.exports=function(c,b,a){return function(k){var e=k||{};d(k)?e={data:e}:2===arguments.length?e={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof k&&(e={});b();var q=e.x||0,n=e.y||0,m=e.width||a.width,F=e.height||a.height,e=e.data||new Uint8Array(m*F*4);c.pixelStorei(3333,4);c.readPixels(q,n,m,F,6408,5121,e);return e}}},{"./util/is-typed-array":26}],
16:[function(c,k,m){var d=c("./util/values");k.exports=function(c,b,a){function k(){this.id=m++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function e(a){c.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=c.createRenderbuffer());c.bindRenderbuffer(36161,a.renderbuffer);c.renderbufferStorage(36161,a.format,a.width,a.height)}function q(a){var b=a.renderbuffer;c.bindRenderbuffer(36161,null);c.isRenderbuffer(b)&&c.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=
0;delete F[a.id]}var n={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(n.srgba=35907);b.ext_color_buffer_half_float&&(n.rgba16f=34842,n.rgb16f=34843);b.webgl_color_buffer_float&&(n.rgba32f=34836);var m=0,F={};k.prototype.decRef=function(){0===--this.refCount&&q(this)};return{create:function(a){function b(a){a=a||{};var c=0,p=0;"shape"in a?(p=a.shape,c=p[0]|0,p=p[1]|0):("radius"in a&&(c=p=a.radius|0),"width"in a&&(c=a.width|0),"height"in a&&(p=
a.height|0));b.width=d.width=Math.max(c,1);b.height=d.height=Math.max(p,1);d.format=32854;"format"in a&&(d.format=n[a.format]);e(d);return b}var d=new k;F[d.id]=d;b(a);b._reglType="renderbuffer";b._renderbuffer=d;b.destroy=function(){d.decRef()};return b},refresh:function(){d(F).forEach(e)},clear:function(){d(F).forEach(q)}}}},{"./util/values":32}],17:[function(c,k,m){function d(b,a,d,c){this.name=b;this.id=a;this.location=d;this.info=c}var p=c("./util/values");k.exports=function(b,a,c,e,k){function n(a,
d){var f=35632===a?C:g,c=f[d];if(!c){var e=k.str(d),c=b.createShader(a);b.shaderSource(c,e);b.compileShader(c);f[d]=c}return c}function m(a,b){this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function F(f){var g,p;g=n(35632,f.fragId);p=n(35633,f.vertId);var m=f.program=b.createProgram();b.attachShader(m,g);b.attachShader(m,p);b.linkProgram(m);var w=b.getProgramParameter(m,35718),H=f.uniforms=[];for(g=0;g<w;++g)if(p=b.getActiveUniform(m,
g))if(1<p.size)for(var C=0;C<p.size;++C){var F=p.name.replace("[0]","["+C+"]");c.def(F);H.push(new d(F,k.id(F),b.getUniformLocation(m,F),p))}else c.def(p.name),H.push(new d(p.name,k.id(p.name),b.getUniformLocation(m,p.name),p));w=b.getProgramParameter(m,35721);H=f.attributes=[];for(g=0;g<w;++g)if(p=b.getActiveAttrib(m,g))a.def(p.name),H.push(new d(p.name,k.id(p.name),b.getAttribLocation(m,p.name),p));f.draw=e(f);f.batchCache={}}var C={},g={},w={},f=[];return{clear:function(){var a=b.deleteShader.bind(b);
p(C).forEach(a);C={};p(g).forEach(a);g={};f.forEach(function(a){b.deleteProgram(a.program)});f.length=0;w={}},refresh:function(){C={};g={};f.forEach(F)},program:function(a,b){var d=w[b];d||(d=w[b]={});var c=d[a];c||(c=new m(b,a),F(c),d[a]=c,f.push(c));return c},shader:n,frag:[-1],vert:[-1]}}},{"./util/values":32}],18:[function(c,k,m){var d=c("./util/stack"),p=c("./util/codegen");k.exports=function(b,a,c){function e(a,c){var f=d([!!c],function(f){f?b.enable(a):b.disable(a)});f.flag=a;return f}var k=
{dither:e(3024),"blend.enable":e(3042),"blend.color":d([0,0,0,0],function(a,d,f,c){b.blendColor(a,d,f,c)}),"blend.equation":d([32774,32774],function(a,d){b.blendEquationSeparate(a,d)}),"blend.func":d([1,0,1,0],function(a,d,f,c){b.blendFuncSeparate(a,d,f,c)}),"depth.enable":e(2929,!0),"depth.func":d([513],function(a){b.depthFunc(a)}),"depth.range":d([0,1],function(a,d){b.depthRange(a,d)}),"depth.mask":d([!0],function(a){b.depthMask(a)}),"cull.enable":e(2884),"cull.face":d([1029],function(a){b.cullFace(a)}),
frontFace:d([2305],function(a){b.frontFace(a)}),colorMask:d([!0,!0,!0,!0],function(a,d,f,c){b.colorMask(a,d,f,c)}),lineWidth:d([1],function(a){b.lineWidth(a)}),"polygonOffset.enable":e(32823),"polygonOffset.offset":d([0,0],function(a,d){b.polygonOffset(a,d)}),"sample.alpha":e(32926),"sample.enable":e(32928),"sample.coverage":d([1,!1],function(a,d){b.sampleCoverage(a,d)}),"stencil.enable":e(2960),"stencil.mask":d([-1],function(a){b.stencilMask(a)}),"stencil.func":d([519,0,-1],function(a,d,f){b.stencilFunc(a,
d,f)}),"stencil.opFront":d([7680,7680,7680],function(a,d,f){b.stencilOpSeparate(1028,a,d,f)}),"stencil.opBack":d([7680,7680,7680],function(a,d,f){b.stencilOpSeparate(1029,a,d,f)}),"scissor.enable":e(3089),"scissor.box":d([0,0,-1,-1],function(d,c,f,e){var n=f,p=a.top();0>f&&(n=p?p.width-d:b.drawingBufferWidth-d);f=e;0>e&&(f=p?p.height-c:b.drawingBufferHeight-c);b.scissor(d,c,n,f)}),viewport:d([0,0,-1,-1],function(d,e,f,n){var p=f,k=a.top();0>f&&(p=k?k.width-d:b.drawingBufferWidth-d);f=n;0>n&&(f=k?
k.height-e:b.drawingBufferHeight-e);b.viewport(d,e,p,f);c.width=p;c.height=f})},n=p(),m=n.proc("poll"),F=n.proc("refresh");Object.keys(k).forEach(function(a){a=n.link(k[a]);m(a,".poll();");F(a,".setDirty();")});var C=n.compile();return{contextState:k,viewport:c,poll:C.poll,refresh:C.refresh,notifyViewportChanged:function(){k.viewport.setDirty();k["scissor.box"].setDirty()}}}},{"./util/codegen":23,"./util/stack":30}],19:[function(c,k,m){k.exports=function(){var d={"":0},c=[""];return{id:function(b){var a=
d[b];if(a)return a;a=d[b]=c.length;c.push(b);return a},str:function(b){return c[b]}}}},{}],20:[function(c,k,m){function d(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function p(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var d=a[0].length,c=1;c<b;++c)if(!Array.isArray(a[c])||a[c].length!==d)return!1;return!0}function b(a){return Object.prototype.toString.call(a)}function a(a){return"[object HTMLCanvasElement]"===b(a)}function I(a){return"[object CanvasRenderingContext2D]"===
b(a)}var e=c("./util/extend"),q=c("./util/values"),n=c("./util/is-typed-array"),H=c("./util/is-ndarray"),F=c("./util/load-texture"),C=c("./util/to-half-float"),g=c("./util/parse-dds"),w=[9984,9986,9985,9987];k.exports=function(c,k,m,v,P){function Q(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=
this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function K(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function T(a,b){var c,d,f=0,e=0,g=0,n=0,p=0,k=0,l=!1,m=!1,q=!1;for(c=0;c<b.length;++c)d=b[c],n=n||d.width<<d.miplevel,p=p||d.height<<d.miplevel,
f=f||d.type,e=e||d.format,g=g||d.internalformat,k=k||d.channels,l=l||d.needsPoll,m=m||d.needsListeners,d=d.miplevel,q=q||0<d;a.needsPoll=l;a.needsListeners=m;a.width=n;a.height=p;a.format=e;a.internalformat=g;a.type=f;if(3553!==a.target)for(c=0;6>c;++c);c=0<=w.indexOf(a.minFilter);a.genMipmaps=!q&&(a.genMipmaps||c);q=q||a.genMipmaps;a.minFilter||(a.minFilter=q?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=k),d.format||(d.format=e),d.internalformat||
(d.internalformat=g),d.type||(d.type=f)}function da(a){this.id=u++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new K(a);this.pixels=[]}function U(a,b){function d(a,h){var c=h.mipmap,f;if(Array.isArray(c))for(var g=0;g<c.length;++g)f=new Q(a),f.parseFlags(b),f.parseFlags(h),f.parse(c[g],g),e.push(f);else f=new Q(a),f.parseFlags(b),f.parse(h,0),e.push(f)}var c;L(a);var f=a.params;K.call(f,a.target);var e=a.pixels;e.length=
0;f.parse(b);if(3553===a.target)d(3553,b);else{var g=b.faces||b;if(Array.isArray(g))for(c=0;6>c;++c)d(34069+c,g[c]);else if("string"!==typeof g)for(c=0;6>c;++c)d(34069+c,{})}T(f,e);f.needsListeners&&ha(a);f.needsPoll&&(a.pollId=B.length,B.push(a));ea(a)}function ea(a){c.isTexture(a.texture)||(a.texture=c.createTexture());var b=a.target,d=a.unit;0<=d?(c.activeTexture(33984+d),V=d):c.bindTexture(b,a.texture);for(var b=a.pixels,g=a.params,e=0;e<b.length;++e)b[e].upload(g);g.upload();0>d&&((d=Z[V])?c.bindTexture(d.target,
d.texture):(a.unit=V,Z[V]=a))}function ha(a){function b(a,c,h){var d=g(h);d.pixels.forEach(function(b){var h=new Q(d.cube?b.target:a);h.channels=d.channels;h.compressed=d.compressed;h.type=d.type;h.internalformat=d.format;h.format=ca[d.format];h.width=b.width;h.height=b.height;h.miplevel=b.miplevel||c;h.data=b.data;f.push(h)})}function c(){for(var g=0;g<f.length;++g){var e=f[g],n=e.image,p=e.video,k=e.xhr;n&&n.complete?(e.width=n.naturalWidth,e.height=n.naturalHeight):p&&2<p.readyState?(e.width=p.width,
e.height=p.height):k&&4===k.readyState&&(f[g]=f[f.length-1],f.pop(),k.removeEventListener("readystatechange",ea),b(e.target,e.miplevel,k.response))}T(d,f);ea(a)}var d=a.params,f=a.pixels;f.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){f.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",
c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function L(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((B[b]=B[B.length-1]).id=b,B.pop(),a.pollId=-1)}function N(a){var b=a.texture,d=a.unit,e=a.target;0<=d&&(c.activeTexture(33984+d),V=d,c.bindTexture(e,null),Z[d]=null);L(a);c.isTexture(b)&&c.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete l[a.id]}var r={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
E={repeat:10497,clamp:33071,mirror:33648},ja={nearest:9728,linear:9729},R=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ja),fa={none:0,browser:37444},S={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},W={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ba={};k.ext_srgb&&(W.srgb=35904,W.srgba=35906);k.oes_texture_float&&(S["float"]=5126);k.oes_texture_half_float&&
(S["half float"]=36193);k.webgl_depth_texture&&(e(W,{depth:6402,"depth stencil":34041}),e(S,{uint16:5123,uint32:5125,"depth stencil":34042}));k.webgl_compressed_texture_s3tc&&e(ba,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});k.webgl_compressed_texture_atc&&e(ba,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});k.webgl_compressed_texture_pvrtc&&e(ba,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});k.webgl_compressed_texture_etc1&&(ba["rgb etc1"]=36196);var oa=Array.prototype.slice.call(c.getParameter(34467));Object.keys(ba).forEach(function(a){var b=ba[a];0<=oa.indexOf(b)&&(W[a]=b)});var A=Object.keys(W);m.textureFormats=A;var ca=A.reduce(function(a,b){var d=W[b];6409===d||6406===d||6409===d||6410===d||6402===d||34041===d?a[d]=d:32855===d||0<=b.indexOf("rgba")?a[d]=6408:a[d]=6407;return a},{});e(Q.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=fa[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=W[b];b in S&&(this.type=S[b]);b in ba&&(this.compressed=!0)}"type"in a&&(this.type=S[a.type]);var b=this.width,d=this.height,c=this.channels;"shape"in a?(b=a.shape[0],d=a.shape[1],3===a.shape.length&&(c=a.shape[2])):("radius"in a&&(b=d=a.radius),"width"in a&&(b=a.width),
"height"in a&&(d=a.height),"channels"in a&&(c=a.channels));this.width=b|0;this.height=d|0;this.channels=c|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*c,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(c,f){this.miplevel=f;this.width>>=f;this.height>>=f;var e=c;switch(typeof c){case "object":if(!c)return;
this.parseFlags(c);var g=c.data;if("string"===typeof g||g&&(n(g)||d(g)||H(g)||a(g)||I(g)||"[object HTMLImageElement]"===b(g)||"[object HTMLVideoElement]"===b(g)||p(g)))e=c.data;break;case "undefined":return}"string"===typeof e&&(e=F(e,this.crossOrigin));var g=null,k=!1;if(null!==e)if(n(e))this.data=e;else if(d(e))g=e,k=!0;else if(H(e)){Array.isArray(e.data)?(g=e.data,k=!0):this.data=e.data;var l=e.shape;this.width=l[0];this.height=l[1];this.channels=3===l.length?l[2]:1;l=e.stride;this.strideX=e.stride[0];
this.strideY=e.stride[1];this.strideC=3===l.length?e.stride[2]:1;this.offset=e.offset;this.needsTranspose=!0}else if(a(e)||I(e))a(e)?this.canvas=e:this.canvas=e.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===b(e))this.image=e,e.complete?(this.width=e.naturalWidth,this.height=e.naturalHeight):(this.width=this.width||e.naturalWidth,this.height=this.height||e.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===b(e))this.video=e,1<e.readyState?(this.width=e.width,this.height=e.height):(this.width=this.width||e.width,this.height=this.height||e.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===b(e))this.xhr=e,this.needsListeners=!0;else if(p(e)){var k=e[0].length,l=e.length,m=1,q,r,u,z;if(Array.isArray(e[0][0]))for(m=e[0][0].length,g=Array(k*l*m),r=z=0;r<l;++r)for(q=0;q<k;++q)for(u=0;u<m;++u)g[z++]=e[r][q][u];
else for(g=Array(k*l),r=z=0;r<l;++r)for(q=0;q<k;++q)g[z++]=e[r][q];this.width=k;this.height=l;this.channels=m;k=!0}else c.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||P.width)|0,this.height=(this.height||P.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,
6410,6407,6408][(this.channels=this.channels||4)-1]);e=this.internalformat;l=this.format=ca[e];if(!this.channels)switch(l){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}l=this.type;5126!==l&&36193!==l&&(l||(l=6402===e?5125:5121));this.type=l;if(k)switch(l){case 5121:this.data=new Uint8Array(g);break;case 5123:this.data=new Uint16Array(g);break;case 5125:this.data=new Uint32Array(g);break;case 5126:this.data=
new Float32Array(g);break;case 36193:this.data=C(g)}if(this.data&&this.needsTranspose){g=this.data;e=this.width;k=this.height;l=this.channels;m=this.strideX;q=this.strideY;r=this.strideC;u=this.offset;z=new g.constructor(e*k*l);for(var w=0,v=0;v<k;++v)for(var x=0;x<e;++x)for(var y=0;y<l;++y)z[w++]=g[q*v+m*x+r*y+u];this.data=z}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){c.pixelStorei(37440,
this.flipY);c.pixelStorei(37441,this.premultiplyAlpha);c.pixelStorei(37443,this.colorSpace);c.pixelStorei(3317,this.unpackAlignment);var b=this.target,d=this.miplevel,e=this.image,g=this.canvas,n=this.video,p=this.data,k=this.internalformat,l=this.format,m=this.type,q=this.width||Math.max(1,a.width>>d);a=this.height||Math.max(1,a.height>>d);n&&2<n.readyState?c.texImage2D(b,d,l,l,m,n):e&&e.complete?c.texImage2D(b,d,l,l,m,e):g?c.texImage2D(b,d,l,l,m,g):this.compressed?c.compressedTexImage2D(b,d,k,q,
a,0,p):this.copy?(v(),c.copyTexImage2D(b,d,l,this.x,this.y,q,a,0)):p?c.texImage2D(b,d,l,q,a,0,l,m,p):c.texImage2D(b,d,l,q||1,a||1,0,l,m,null)}});e(K.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=R[a.min]);"mag"in a&&(this.magFilter=ja[a.mag]);var b=this.wrapS,d=this.wrapT;if("wrap"in a){var c=a.wrap;"string"===typeof c?b=d=E[c]:Array.isArray(c)&&(b=E[c[0]],d=E[c[1]])}else"wrapS"in a&&(b=E[a.wrapS]),"wrapT"in a&&(d=E[a.wrapT]);this.wrapS=b;this.wrapT=d;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=r[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;c.texParameteri(a,10241,this.minFilter);c.texParameteri(a,10240,this.magFilter);c.texParameteri(a,10242,this.wrapS);c.texParameteri(a,10243,this.wrapT);k.ext_texture_filter_anisotropic&&c.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(c.hint(33170,this.mipmapHint),c.generateMipmap(a))}});
var V=0,u=0,l={},B=[],y=m.maxTextureUnits,Z=Array(y).map(function(){return null});e(da.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<y;++b){var d=Z[b];if(d){if(0<d.bindCount)continue;d.unit=-1}Z[b]=this;a=b;break}this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture);V=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&N(this)}});return{create:function(a,b){function d(a,e,f,h,g,n){var p=a||{};34067===b&&
6===arguments.length&&(p=[a,e,f,h,g,n]);U(c,p);d.width=c.params.width;d.height=c.params.height;return d}var c=new da(b);l[c.id]=c;d(a);d._reglType="texture";d._texture=c;d.destroy=function(){c.decRef()};return d},refresh:function(){q(l).forEach(ea);for(var a=0;a<y;++a)Z[a]=null;V=0;c.activeTexture(33984)},clear:function(){for(var a=0;a<y;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),Z[a]=null;c.activeTexture(33984);V=0;q(l).forEach(N)},poll:function(){B.forEach(ea)},getTexture:function(a){return null}}}},
{"./util/extend":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/load-texture":27,"./util/parse-dds":28,"./util/to-half-float":31,"./util/values":32}],21:[function(c,k,m){k.exports=function(d){var c={};return{def:function(b){b=d.id(b);var a=c[b];a||(a=c[b]=[]);return a},uniforms:c}}},{}],22:[function(c,k,m){k.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],23:[function(c,k,m){var d=c("./extend");k.exports=
function(){function c(){var a=[],e=[];return d(function(){a.push.apply(a,Array.prototype.slice.call(arguments))},{def:function(){var d="v"+b++;e.push(d);0<arguments.length&&(a.push(d,"="),a.push.apply(a,Array.prototype.slice.call(arguments)),a.push(";"));return d},toString:function(){return[0<e.length?"var "+e+";":"",a.join("")].join("")}})}var b=0,a=[],k=[],e={};return{link:function(d){var c="g"+b++;a.push(c);k.push(d);return c},block:c,proc:function(a){var n=[],k=c(),m=k.toString;return e[a]=d(k,
{arg:function(){var a="a"+b++;n.push(a);return a},toString:function(){return["function(",n.join(),"){",m(),"}"].join("")}})},compile:function(){var b=['"use strict";return {'];Object.keys(e).forEach(function(a){b.push('"',a,'":',e[a].toString(),",")});b.push("}");return Function.apply(null,a.concat([b.join("")])).apply(null,k)}}}},{"./extend":24}],24:[function(c,k,m){k.exports=function(d,c){for(var b=Object.keys(c),a=0;a<b.length;++a)d[b[a]]=c[b[a]];return d}},{}],25:[function(c,k,m){var d=c("./is-typed-array");
k.exports=function(c){return"object"===typeof c&&Array.isArray(c.shape)&&Array.isArray(c.stride)&&"number"===typeof c.offset&&c.shape.length===c.stride.length&&(Array.isArray(c.data)||d(c.data))}},{"./is-typed-array":26}],26:[function(c,k,m){var d=c("../constants/arraytypes.json");k.exports=function(c){return Object.prototype.toString.call(c)in d}},{"../constants/arraytypes.json":5}],27:[function(c,k,m){k.exports=function(d,c){if("undefined"!==typeof document){var b;b=(b=/\.(\w+)(\?.*)?$/.exec(d))&&
b[1]?b[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(b))return b=document.createElement("video"),b.autoplay=!0,b.loop=!0,c&&(b.crossOrigin=c),b.src=d,b;if(0<=["dds"].indexOf(b))return b=new XMLHttpRequest,b.responseType="arraybuffer",b.open("GET",d,!0),b.send(),b;b=new Image;c&&(b.crossOrigin=c);b.src=d;return b}return null}},{}],28:[function(c,k,m){k.exports=function(c){function k(a){for(var b=r,d=E,e=0;e<W;++e){var f=Math.max(1,
b+3>>2)*Math.max(1,d+3>>2)*fa;oa.pixels.push({target:a,miplevel:e,width:b,height:d,data:new Uint8Array(c,ba,f)});ba+=f;b>>=1;d>>=1}}var m=new Int32Array(c),N=m[v],r=m[Q],E=m[P],ja=n,R=0,fa=0,S=4;switch(m[da]){case g:fa=8;N&C?(S=3,R=b):R=a;break;case w:fa=16;R=I;break;case f:fa=16;R=e;break;case x:fa=8,R=q}var W=1;m[T]&H&&(W=Math.max(1,m[K]));var ba=m[aa]+4,oa={width:r,height:E,channels:S,format:R,type:ja,compressed:!0,cube:!1,pixels:[]};if(m[U]&F)for(oa.cube=!0,m=0;6>m;++m)k(p+m);else k(d);return oa};
var d=3553,p=34069,b=33776,a=33777,I=33778,e=33779,q=36196,n=5121,H=131072,F=512,C=64,g=827611204,w=861165636,f=894720068,x=826496069,aa=1,v=2,P=3,Q=4,K=7,T=20,da=21,U=28},{}],29:[function(c,k,m){k.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(d){return requestAnimationFrame(d)},cancel:function(d){return cancelAnimationFrame(d)}}:{next:function(d){setTimeout(d,30)},cancel:clearTimeout}},{}],30:[function(c,k,m){k.exports=function(d,c){var b=
d.length,a=d.slice(),k=d.slice(),e=!1,m=!0;return{push:function(){e=!1;for(var c=0;c<b;++c){var d=arguments[c];e=e||d!==k[c];a.push(d)}},pop:function(){e=!1;a.length-=b;for(var c=0;c<b;++c)e=e||a[a.length-b+c]!==k[c]},poll:function(){var d=a.length-b;if(e||m){switch(b){case 1:c(a[d]);break;case 2:c(a[d],a[d+1]);break;case 3:c(a[d],a[d+1],a[d+2]);break;case 4:c(a[d],a[d+1],a[d+2],a[d+3]);break;case 5:c(a[d],a[d+1],a[d+2],a[d+3],a[d+4]);break;case 6:c(a[d],a[d+1],a[d+2],a[d+3],a[d+4],a[d+5]);break;
default:c.apply(null,a.slice(d,a.length))}for(var H=0;H<b;++H)k[H]=a[d+H];m=e=!1}},setDirty:function(){m=!0}}}},{}],31:[function(c,k,m){k.exports=function(d){for(var c=new Float32Array(d),c=new Uint32Array(c.buffer),b=new Uint16Array(d.length),a=0;a<d.length;++a)if(isNaN(d[a]))b[a]=65535;else if(Infinity===d[a])b[a]=31744;else if(-Infinity===d[a])b[a]=64512;else{var k=c[a],e=k>>>31<<15,m=(k<<1>>>24)-127,k=k>>13&1023;b[a]=-24>m?e:-14>m?e+(k+1024>>-14-m):15<m?e+31744:e+(m+15<<10)+k}return b}},{}],32:[function(c,
k,m){k.exports=function(d){return Object.keys(d).map(function(c){return d[c]})}},{}],33:[function(c,k,m){var d=c("./lib/util/extend"),p=c("./lib/context"),b=c("./lib/strings"),a=c("./lib/extension"),I=c("./lib/limits"),e=c("./lib/buffer"),q=c("./lib/elements"),n=c("./lib/texture"),H=c("./lib/renderbuffer"),F=c("./lib/framebuffer"),C=c("./lib/uniform"),g=c("./lib/attribute"),w=c("./lib/shader"),f=c("./lib/draw"),x=c("./lib/state"),aa=c("./lib/compile"),v=c("./lib/read"),P=c("./lib/dynamic"),Q=c("./lib/util/raf"),
K=c("./lib/util/clock");k.exports=function(){function c(){J=Q.next(c);y.count+=1;if(y.width!==r.drawingBufferWidth||y.height!==r.drawingBufferHeight)y.width=r.drawingBufferWidth,y.height=r.drawingBufferHeight,Z.notifyViewportChanged();var a=K();y.dt=a-y.t;y.t=a;u.poll();for(var b=0;b<X.length;++b)(0,X[b])(y.count,y.t,y.dt);y.renderTime=K()-a}function k(){J&&(Q.cancel(c),J=0)}function m(a){k();a.preventDefault();if(E.onContextLost)E.onContextLost()}function ea(a){r.getError();ja.refresh();W.refresh();
u.refresh();l.refresh();B.refresh();ca.refresh();Z.refresh();if(E.onContextRestored)E.onContextRestored();c()}function ha(a){function b(a){var d={},e={};Object.keys(a).forEach(function(b){var f=a[b];P.isDynamic(f)?(c=!0,e[b]=P.unbox(f,b)):d[b]=f});return{dynamic:e,"static":d}}var c=!1,e=b(a.uniforms||{}),f=b(a.attributes||{});a=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=d({},a);delete c.uniforms;delete c.attributes;b("blend");
b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));var e=h.command(a["static"],e["static"],f["static"],a.dynamic,e.dynamic,f.dynamic,c),g=e.draw,k=e.batch,l=e.scope,m=[];return function(a,b){if("function"===typeof a)return l(null,a);if("function"===typeof b)return l(a,b);if("number"===typeof a){for(var c=a|0;m.length<c;)m.push(null);return k(a|0,m)}return Array.isArray(a)?k(a.length,a):g(a)}}function L(){B.poll();Z.poll()}var N=p(Array.prototype.slice.call(arguments)),
r=N.gl,E=N.options,N=b(),ja=a(r),R=ja.extensions,fa={width:r.drawingBufferWidth,height:r.drawingBufferHeight},S=I(r,R),W=e(r),ba=q(r,R,W),oa=C(N),A=g(r,R,S,W,N),ca=w(r,A,oa,function(a){return h.draw(a)},N),V=f(r,R,W),u=n(r,R,S,L,fa),l=H(r,R,S),B=F(r,R,S,u,l),y={count:0,start:K(),dt:0,t:K(),renderTime:0,width:r.drawingBufferWidth,height:r.drawingBufferHeight,pixelRatio:E.pixelRatio},Z=x(r,B,fa),fa=v(r,L,fa),h=aa(r,N,R,S,W,ba,u,B,Z,oa,A,ca,V,y,L),O=r.canvas,X=[],J=0;O&&(O.addEventListener("webglcontextlost",
m,!1),O.addEventListener("webglcontextrestored",ea,!1));return d(ha,{clear:function(a){var b=0;L();var c=a.color;c&&(r.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(r.clearDepth(+a.depth),b|=256);"stencil"in a&&(r.clearStencil(a.stencil|0),b|=1024);r.clear(b)},prop:P.define,draw:ha({}),elements:function(a){return ba.create(a)},buffer:function(a){return W.create(a,34962)},texture:function(a){return u.create(a,3553)},cube:function(a){return 6===arguments.length?u.create(Array.prototype.slice.call(arguments),
34067):u.create(a,34067)},renderbuffer:function(a){return l.create(a)},framebuffer:function(a){return B.create(a)},framebufferCube:function(a){},frame:function(a){X.push(a);!J&&0<X.length&&c();return{cancel:function(){var b=X.find(function(b){return b===a});0>b||(X.splice(b,1),0>=X.length&&k())}}},stats:y,limits:S,read:fa,destroy:function(){k();O&&(O.removeEventListener("webglcontextlost",m),O.removeEventListener("webglcontextrestored",ea));ca.clear();B.clear();l.clear();u.clear();W.clear();if(E.onDestroy)E.onDestroy()}})}},
{"./lib/attribute":2,"./lib/buffer":3,"./lib/compile":4,"./lib/context":8,"./lib/draw":9,"./lib/dynamic":10,"./lib/elements":11,"./lib/extension":12,"./lib/framebuffer":13,"./lib/limits":14,"./lib/read":15,"./lib/renderbuffer":16,"./lib/shader":17,"./lib/state":18,"./lib/strings":19,"./lib/texture":20,"./lib/uniform":21,"./lib/util/clock":22,"./lib/util/extend":24,"./lib/util/raf":29}]},{},[1]);
