<!DOCTYPE html>
      <html>
        <head>
          <title>example/mipmap.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(m,q,n){function l(b,e){if(!q[b]){if(!m[b]){var k="function"==typeof require&&require;if(!e&&k)return k(b,!0);if(r)return r(b,!0);k=Error("Cannot find module '"+b+"'");throw k.code="MODULE_NOT_FOUND",k;}k=q[b]={exports:{}};m[b][0].call(k.exports,function(e){var k=m[b][1][e];return l(k?k:e)},k,k.exports,e$$0,m,q,n)}return q[b].exports}for(var r="function"==typeof require&&require,k=0;k<n.length;k++)l(n[k]);return l})({1:[function(d,m,q){d=d("../regl")();var n=d({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform float tick;\n  varying vec2 uv;\n  void main () {\n    mat3 m = mat3(\n      cos(tick), sin(tick), -1.1 + cos(tick),\n      -sin(tick), cos(tick), 0,\n      0, 0, 1);\n    vec3 p = m * vec3(uv, 1);\n    gl_FragColor = texture2D(texture, p.xy / p.z);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n  }",attributes:{position:[-2,0,0,-2,2,2]},uniforms:{tick:function(l){return.005*l.count},texture:d.texture({min:"nearest mipmap linear",mag:"nearest",wrap:"repeat",data:[[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[0,0,0,0,255,255,255,255],[0,0,0,0,255,255,255,255],
[0,0,0,0,255,255,255,255],[0,0,0,0,255,255,255,255]]})},count:3});d.frame(function(){n()})},{"../regl":30}],2:[function(d,m,q){function n(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(l,r,k,b,e){l=k.maxAttributes;r=Array(l);for(k=0;k<l;++k)r[k]=new n;return{Record:n,scope:{},state:r}}},{}],3:[function(d,m,q){function n(b){return J[Object.prototype.toString.call(b)]|0}function l(b,
e){for(var k=0;k<e.length;++k)b[k]=e[k]}function r(b,e,k,l,n,a,r){for(var d=0,U=0;U<k;++U)for(var la=0;la<l;++la)b[d++]=e[n*U+a*la+r]}function k(b,e,k){for(var l=0,n=0;n<e.length;++n)for(var a=e[n],r=0;r<k;++r)b[l++]=a[r]}var b=d("./util/is-typed-array"),e=d("./util/is-ndarray"),u=d("./util/values"),z=d("./util/pool"),J=d("./constants/arraytypes.json"),E=d("./constants/dtypes.json"),v=d("./constants/usage.json");m.exports=function(A){function d(b){this.id=a++;this.buffer=A.createBuffer();this.type=
b;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function C(b,e,k){b.byteLength=e.byteLength;A.bufferData(b.type,e,k)}function p(a,g,A,d,p){a.usage=A;if(Array.isArray(g))a.dtype=d||5126,0<g.length&&(Array.isArray(g[0])?(a.dimension=g[0].length,d=z.allocType(a.dtype,g.length*a.dimension),k(d,g,a.dimension),C(a,d,A),z.freeType(d)):"number"===typeof g[0]?(a.dimension=p,d=z.allocType(a.dtype,g.length),l(d,g),C(a,d,A),z.freeType(d)):b(g[0])&&(a.dimension=g[0].length,a.dtype=d||n(g[0])||
5126,d=z.allocType(a.dtype,g.length*a.dimension),k(d,g,a.dimension),C(a,d,A),z.freeType(d)));else if(b(g))a.dtype=d||n(g),a.dimension=p,C(a,g,A);else if(e(g)){var D=g.shape,u=g.stride;p=g.offset;var P=0,R=0,M=0,S=0;1===D.length?(P=D[0],R=1,M=u[0],S=0):2===D.length&&(P=D[0],R=D[1],M=u[0],S=u[1]);a.dtype=d||n(g.data)||5126;a.dimension=R;d=z.allocType(a.dtype,P*R);r(d,g.data,P,R,M,S,p);C(a,d,A);z.freeType(d)}}function g(b){var e=b.buffer;A.isBuffer(e)&&A.deleteBuffer(e);b.buffer=null;delete V[b.id]}
var a=0,V={};d.prototype.bind=function(){A.bindBuffer(this.type,this.buffer)};var m=[];return{create:function(a,C,u){function m(a){var k=35044,g=null,l=0,n=0,d=1;Array.isArray(a)||b(a)||e(a)?g=a:"number"===typeof a?l=a|0:a&&("data"in a&&(g=a.data),"usage"in a&&(k=v[a.usage]),"type"in a&&(n=E[a.type]),"dimension"in a&&(d=a.dimension|0),"length"in a&&(l=a.length|0));B.bind();g?p(B,g,k,n,d):(A.bufferData(B.type,l,k),B.dtype=n||5121,B.usage=k,B.dimension=d,B.byteLength=l);return m}var B=new d(C);V[B.id]=
B;u||m(a);m._reglType="buffer";m._buffer=B;m.subdata=function(a,g){var d=(g||0)|0;B.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var p=z.allocType(B.dtype,a.length);l(p,a);A.bufferSubData(B.type,d,p);z.freeType(p)}else if(Array.isArray(a[0])||b(a[0])){var p=a[0].length,C=z.allocType(B.dtype,a.length*p);k(C,a,p);A.bufferSubData(B.type,d,C);z.freeType(C)}}else if(b(a))A.bufferSubData(B.type,d,a);else if(e(a)){var u=a.shape,M=a.stride,V=C=p=0,v=0;1===u.length?(p=u[0],C=1,V=M[0],
v=0):2===u.length&&(p=u[0],C=u[1],V=M[0],v=M[1]);u=Array.isArray(a.data)?B.dtype:n(a.data);u=z.allocType(u,p*C);r(u,a.data,p,C,V,v,a.offset);A.bufferSubData(B.type,d,u);z.freeType(u)}return m};m.destroy=function(){g(B)};return m},createStream:function(a,b){var e=m.pop();e||(e=new d(a),e.buffer=A.createBuffer());e.bind();p(e,b,35040,0,1);return e},destroyStream:function(a){m.push(a)},clear:function(){u(V).forEach(g)},getBuffer:function(a){return a&&a._buffer instanceof d?a._buffer:null},_initBuffer:p}}},
{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/pool":25,"./util/values":28}],4:[function(d,m,q){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(d,
m,q){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(d,m,q){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(d,m,q){m.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(d,m,q){function n(a){return Array.isArray(a)||J(a)||E(a)}function l(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:
a<b?-1:1})}function r(a,b,e,k){this.thisDep=a;this.contextDep=b;this.propDep=e;this.append=k}function k(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function b(a){return new r(!1,!1,!1,a)}function e(a,b){var e=a.type;return 0===e?(e=a.data.length,new r(!0,1<=e,2<=e,b)):new r(3===e,2===e,1===e,b)}var u=d("./util/codegen"),z=d("./util/loop"),J=d("./util/is-typed-array"),E=d("./util/is-ndarray"),v=d("./constants/primitives.json"),A=d("./constants/dtypes.json"),M=["x","y","z","w"],C={0:0,1:1,zero:0,
one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},p={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},g={0:0,zero:0,keep:7680,
replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},a={cw:2304,ccw:2305},V=new r(!1,!1,!1,function(){});m.exports=function(d,m,E,q,G,N,D,ha,P,R,Y,S,ia){function K(c){return c.replace(".","_")}function H(c,a,b){var e=K(c);t.push(c);y[e]=f[e]=!!b;ma[e]=a}function I(c,a,b){var e=K(c);t.push(c);Array.isArray(b)?(f[e]=b.slice(),y[e]=b.slice()):f[e]=y[e]=b;na[e]=a}function ja(){var c=u(),a=c.link,e=c.global;c.id=X++;c.batchId="0";var b=a(Fa),F=c.shared=
{props:"a0"};Object.keys(Fa).forEach(function(h){F[h]=e.def(b,".",h)});var w=c.next={},Ha=c.current={};Object.keys(na).forEach(function(h){Array.isArray(f[h])&&(w[h]=e.def(F.next,".",h),Ha[h]=e.def(F.current,".",h))});var h=c.constants={};Object.keys(Aa).forEach(function(c){h[c]=e.def(JSON.stringify(Aa[c]))});c.invoke=function(h,f){switch(f.type){case 0:var ya=["this",F.context,F.props,c.batchId];return h.def(a(f.data),".call(",ya.slice(0,Math.max(f.data.length+1,4)),")");case 1:return h.def(F.props,
f.data);case 2:return h.def(F.context,f.data);case 3:return h.def("this",f.data)}};c.attribCache={};var ya={};c.scopeAttrib=function(h){h=m.id(h);if(h in ya)return ya[h];var c=R.scope[h];c||(c=R.scope[h]=new sa);return ya[h]=a(c)};return c}function fa(c){var f=c["static"];c=c.dynamic;if("framebuffer"in f){var a=f.framebuffer;return a?(a=ha.getFramebuffer(a),b(function(c,f){var x=c.link(a),h=c.shared;f.set(h.framebuffer,".next",x);h=h.context;f.set(h,".framebufferWidth",x+".width");f.set(h,".framebufferHeight",
x+".height");return x})):b(function(c,f){var a=c.shared;f.set(a.framebuffer,".next","null");a=a.context;f.set(a,".framebufferWidth",a+".drawingBufferWidth");f.set(a,".framebufferHeight",a+".drawingBufferHeight");return null})}if("framebuffer"in c){var k=c.framebuffer;return e(k,function(c,f){var a=c.invoke(f,k),h=c.shared,x=h.framebuffer,a=f.def(x,".getFramebuffer(",a,")");f.set(x,".next",a);h=h.context;f.set(h,".framebufferWidth",a+"?"+a+".width:"+h+".drawingBufferWidth");f.set(h,".framebufferHeight",
a+"?"+a+".height:"+h+".drawingBufferHeight");return a})}return null}function oa(c,f){function a(h){if(h in b){var c=b[h];h=!0;var Ga=c.x|0,w=c.y|0,k,ra;"w"in c?k=c.w|0:h=!1;"h"in c?ra=c.h|0:h=!1;return new r(h&&f&&f.thisDep,h&&f&&f.contextDep,h&&f&&f.propDep,function(h,f){var a=h.shared.context,x=k;"w"in c||(x=f.def(a,".","framebufferWidth","-",Ga));var e=ra;"h"in c||(e=f.def(a,".","framebufferHeight","-",w));return[Ga,w,x,e]})}if(h in F){var g=F[h];h=e(g,function(h,c){var f=h.invoke(c,g),a=h.shared.context,
x=c.def(f,".x|0"),e=c.def(f,".y|0"),b=c.def('"w" in ',f,"?",f,".w|0:","(",a,".","framebufferWidth","-",x,")"),f=c.def('"h" in ',f,"?",f,".h|0:","(",a,".","framebufferHeight","-",e,")");return[x,e,b,f]});f&&(h.thisDep=h.thisDep||f.thisDep,h.contextDep=h.contextDep||f.contextDep,h.propDep=h.propDep||f.prpoDep);return h}return f?new r(f.thisDep,f.contextDep,f.propDep,function(h,c){var f=h.shared.context;return[0,0,c.def(f,".","framebufferWidth"),c.def(f,".","framebufferHeight")]}):null}var b=c["static"],
F=c.dynamic,w=a("viewport");if(w)var k=w,w=new r(w.thisDep,w.contextDep,w.propDep,function(h,c){var f=k.append(h,c),a=h.shared.context;c.set(a,".viewportWidth",f[2]);c.set(a,".viewportHeight",f[3]);return f});return{viewport:w,scissor_box:a("scissor.box")}}function L(c){function f(h){if(h in a){var c=m.id(a[h]);h=b(function(){return c});h.id=c;return h}if(h in g){var x=g[h];return e(x,function(h,c){var f=h.invoke(c,x);return c.def(h.shared.strings,".id(",f,")")})}return null}var a=c["static"],g=c.dynamic,
F=f("frag"),w=f("vert"),d=null;k(F)&&k(w)?(d=Y.program(w.id,F.id),c=b(function(h,c){return h.link(d)})):c=new r(F&&F.thisDep||w&&w.thisDep,F&&F.contextDep||w&&w.contextDep,F&&F.propDep||w&&w.propDep,function(h,c){var f=h.shared.shader,a;a=F?F.append(h,c):c.def(f,".","frag");var x;x=w?w.append(h,c):c.def(f,".","vert");return c.def(f+".program("+x+","+a+")")});return{frag:F,vert:w,progVar:c,program:d}}function ua(c){function f(c,h){if(c in a){var x=a[c]|0;return b(function(c,f){h&&(c.OFFSET=x);return x})}if(c in
g){var w=g[c];return e(w,function(c,f){var a=c.invoke(f,w);h&&(c.OFFSET=a);return a})}return h&&F?b(function(h,c){h.OFFSET="0";return 0}):null}var a=c["static"],g=c.dynamic,F=function(){if("elements"in a){var c=a.elements;n(c)?c=N.getElements(N.create(c)):c&&(c=N.getElements(c));var h=b(function(h,f){if(c){var a=h.link(c);return h.ELEMENTS=a}return h.ELEMENTS=null});h.value=c;return h}if("elements"in g){var f=g.elements;return e(f,function(h,c){var a=h.shared,x=a.isBufferArgs,a=a.elements,e=h.invoke(c,
f),b=c.def("null"),x=c.def(x,"(",e,")"),e=h.cond(x).then(b,"=",a,".createStream(",e,");")["else"](b,"=",a,".getElements(",e,");");c.entry(e);c.exit(h.cond(x).then(a,".destroyStream(",b,");"));return h.ELEMENTS=b})}return null}(),w=f("offset",!0);return{elements:F,primitive:function(){if("primitive"in a){var c=a.primitive;return b(function(h,f){return v[c]})}if("primitive"in g){var h=g.primitive;return e(h,function(c,f){var a=c.constants.primTypes,x=c.invoke(f,h);return f.def(a,"[",x,"]")})}return F?
k(F)?F.value?b(function(h,c){return c.def(h.ELEMENTS,".primType")}):b(function(){return 4}):new r(F.thisDep,F.contextDep,F.propDep,function(h,c){var f=h.ELEMENTS;return c.def(f,"?",f,".primType:",4)}):null}(),count:function(){if("count"in a){var c=a.count|0;return b(function(){return c})}if("count"in g){var h=g.count;return e(h,function(c,f){return c.invoke(f,h)})}return F?k(F)?F?w?new r(w.thisDep,w.contextDep,w.propDep,function(h,c){return c.def(h.ELEMENTS,".vertCount-",h.OFFSET)}):b(function(h,
c){return c.def(h.ELEMENTS,".vertCount")}):b(function(){return-1}):new r(F.thisDep||w.thisDep,F.contextDep||w.contextDep,F.propDep||w.propDep,function(h,c){var f=h.ELEMENTS;return h.OFFSET?c.def(f,"?",f,".vertCount-",h.OFFSET,":-1"):c.def(f,"?",f,".vertCount:-1")}):null}(),instances:f("instances",!1),offset:w}}function Q(c){var f=c["static"],k=c.dynamic,d={};t.forEach(function(c){function w(h,a){if(c in f){var w=h(f[c]);d[l]=b(function(){return w})}else if(c in k){var g=k[c];d[l]=e(g,function(h,c){return a(h,
c,h.invoke(c,g))})}}var l=K(c);switch(c){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return w(function(h){return h},function(h,c,f){return f});case "depth.func":return w(function(h){return p[h]},function(h,c,f){return c.def(h.constants.compareFuncs,"[",f,"]")});case "depth.range":return w(function(h){return h},function(h,c,f){h=c.def("+",f,
"[0]");c=c.def("+",f,"[1]");return[h,c]});case "blend.func":return w(function(c){return[C["srcRGB"in c?c.srcRGB:c.src],C["dstRGB"in c?c.dstRGB:c.dst],C["srcAlpha"in c?c.srcAlpha:c.src],C["dstAlpha"in c?c.dstAlpha:c.dst]]},function(c,f,a){function x(c,h){var b=f.def('"',c,h,'" in ',a,"?",a,".",c,h,":",a,".",c);return f.def(e,"[",b,"]")}var e=c.constants.blendFuncs;c=x("src","RGB");var b=x("src","Alpha"),w=x("dst","RGB"),g=x("dst","Alpha");return[c,w,b,g]});case "blend.equation":return w(function(c){if("string"===
typeof c)return[Z[c],Z[c]];if("object"===typeof c)return[Z[c.rgb],Z[c.alpha]]},function(c,f,a){var x=c.constants.blendEquations,e=f.def(),b=f.def();c=c.cond("typeof ",a,'==="string"');c.then(e,"=",b,"=",x,"[",a,"];");c["else"](e,"=",x,"[",a,".rgb];",b,"=",x,"[",a,".alpha];");f(c);return[e,b]});case "blend.color":return w(function(c){return z(4,function(f){return+c[f]})},function(c,f,a){return z(4,function(c){return f.def("+",a,"[",c,"]")})});case "stencil.mask":return w(function(c){return c|0},function(c,
f,a){return f.def(a,"|0")});case "stencil.func":return w(function(c){return[p[c.cmp||"keep"],c.ref||0,"mask"in c?c.mask:-1]},function(c,f,a){c=f.def('"cmp" in ',a,"?",c.constants.compareFuncs,"[",a,".cmp]",":",7680);var x=f.def(a,".ref|0");f=f.def('"mask" in ',a,"?",a,".mask|0:-1");return[c,x,f]});case "stencil.opFront":case "stencil.opBack":return w(function(f){return["stencil.opBack"===c?1029:1028,g[f.fail||"keep"],g[f.zfail||"keep"],g[f.pass||"keep"]]},function(f,a,x){function e(c){return a.def('"',
c,'" in ',x,"?",b,"[",x,".",c,"]:",7680)}var b=f.constants.stencilOps;return["stencil.opBack"===c?1029:1028,e("fail"),e("zfail"),e("pass")]});case "polygonOffset.offset":return w(function(c){return[c.factor|0,c.units|0]},function(c,f,a){c=f.def(a,".factor|0");f=f.def(a,".units|0");return[c,f]});case "cull.face":return w(function(c){var f=0;"front"===c?f=1028:"back"===c&&(f=1029);return f},function(c,f,a){return f.def(a,'==="front"?',1028,":",1029)});case "lineWidth":return w(function(c){return c},
function(c,f,a){return a});case "frontFace":return w(function(c){return a[c]},function(c,f,a){return f.def(a+'==="cw"?2304:2305')});case "colorMask":return w(function(c){return c.map(function(c){return!!c})},function(c,f,a){return z(4,function(c){return"!!"+a+"["+c+"]"})});case "sample.coverage":return w(function(c){return["value"in c?c.value:1,!!c.invert]},function(c,f,a){c=f.def('"value" in ',a,"?+",a,".value:1");f=f.def("!!",a,".invert");return[c,f]})}});return d}function pa(c){var f=c["static"],
a=c.dynamic,g={};Object.keys(f).forEach(function(c){var a=f[c],e;if("number"===typeof a||"boolean"===typeof a)e=b(function(){return a});else if("function"===typeof a&&("texture2d"===a._reglType||"textureCube"===a._reglTYpe))e=b(function(c){return c.link(a)});else if(Array.isArray(a)||J(a))e=b(function(c){return c.global.def("[",z(a.length,function(c){return a[c]}),"]")});e.value=a;g[c]=e});Object.keys(a).forEach(function(c){var f=a[c];g[c]=e(f,function(c,a){return c.invoke(a,f)})});return g}function T(c){var f=
c["static"],a=c.dynamic,g={};Object.keys(f).forEach(function(c){var a=f[c],e=m.id(c),h=new sa;if(n(a))h.state=1,h.buffer=G.getBuffer(G.create(a,34962,!1)),h.type=h.buffer.dtype;else{var k=G.getBuffer(a);if(k)h.state=1,h.buffer=k,h.type=k.dtype;else if(a.constant){var d=a.constant;h.state=2;"number"===typeof d?h.x=d:M.forEach(function(c,f){f<d.length&&(h[c]=d[f])})}else{var k=G.getBuffer(a.buffer),l=a.offset|0,t=a.stride|0,y=a.size|0,ra=!!a.normalized,r=0;"type"in a&&(r=A[a.type]);a=a.divisor|0;h.buffer=
k;h.state=1;h.size=y;h.normalized=ra;h.type=r||k.dtype;h.offset=l;h.stride=t;h.divisor=a}}g[c]=b(function(c,f){var a=c.attribCache;if(e in a)return a[e];var x={isStream:!1};Object.keys(h).forEach(function(c){x[c]=h[c]});h.buffer&&(x.buffer=c.link(h.buffer));return a[e]=x})});Object.keys(a).forEach(function(c){var f=a[c];g[c]=e(f,function(c,a){function x(c){a(d[c],"=",e,".",c,"|0;")}var e=c.invoke(a,f),b=c.shared,g=b.isBufferArgs,k=b.buffer,d={isStream:a.def(!1)},l=new sa;l.state=1;Object.keys(l).forEach(function(c){d[c]=
a.def(""+l[c])});var t=d.buffer,y=d.type;a("if(",g,"(",e,")){",d.isStream,"=true;",t,"=",k,".createStream(",34962,",",e,");",y,"=",t,".dtype;","}else{",t,"=",k,".getBuffer(",e,");","if(",t,"){",y,"=",t,".dtype;","}else if(",e,".constant){",d.state,"=",2,";",M.map(function(c,f){return d[c]+"="+e+".length>="+f+"?"+e+"["+f+"]:0;"}).join(""),"}else{",t,"=",k,".getBuffer(",e,".buffer);",y,'="type" in ',e,"?",b.glTypes,"[",e,".type]:",t,".dtype;",d.normalized,"=!!",e,".normalized;");x("size");x("offset");
x("stride");x("divisor");a("}}");return d})});return g}function O(c){var f=c["static"],a=c.dynamic,g={};Object.keys(f).forEach(function(c){var a=f[c];g[c]=b(function(c,f){return"number"===typeof a||"boolean"===typeof a?""+a:c.link(a)})});Object.keys(a).forEach(function(c){var f=a[c];g[c]=e(f,function(c,a){return c.invoke(a,f)})});return g}function W(c,f,a){var e=c.shared.context,b=c.scope();Object.keys(a).forEach(function(g){f.save(e,"."+g);b(e,".",g,"=",a[g].append(c,f),";")});f(b)}function ba(c,
f,a){var e=c.shared,b=e.gl,g=e.framebuffer,k;ga&&(k=f.def(e.extensions,".webgl_draw_buffers"));var h=c.constants,e=h.drawBuffer,h=h.backBuffer;c=a?a.append(c,f):f.def(g,".next");f("if(",g,".dirty||",c,"!==",g,".cur){","if(",c,"){",b,".bindFramebuffer(",36160,",",c,".framebuffer);");ga&&f(k,".drawBuffersWEBGL(",e,"[",c,".colorAttachments.length]);");f("}else{",b,".bindFramebuffer(",36160,",null);");ga&&f(k,".drawBuffersWEBGL(",h,");");f("}",g,".cur=",c,";",g,".dirty=false;","}")}function qa(c,a,e){var b=
c.shared,g=b.gl,k=c.current,d=c.next,h=b.current,l=b.next,y=c.cond(h,".dirty");t.forEach(function(a){a=K(a);if(!(a in e.state)){var b,x;if(a in d){b=d[a];x=k[a];var t=z(f[a].length,function(c){return y.def(b,"[",c,"]")});y(c.cond(t.map(function(c,f){return c+"==="+x+"["+f+"]"}).join("&&")).then(g,".",na[a],"(",t,");",t.map(function(c,f){return x+"["+f+"]="+c}).join(";"),";"))}else b=y.def(l,".",a),t=c.cond(b,"!==",h,".",a),y(t),a in ma?t(c.cond(b).then(g,".enable(",ma[a],");")["else"](g,".disable(",
ma[a],");"),h,".",a,"=",b,";"):t(g,".",na[a],"(",b,");",h,".",a,"=",b,";")}});0===Object.keys(e.state).length&&y(h,".dirty=false;");a(y)}function va(c,f,a,e){var b=c.shared,g=c.current,d=b.current,h=b.gl;l(Object.keys(a)).forEach(function(b){var t=a[b];if(!e||e(t)){var y=t.append(c,f);if(ma[b]){var l=ma[b];k(t)?y?f(h,".enable(",l,");"):f(h,".disable(",l,");"):f(c.cond(y).then(h,".enable(",l,");")["else"](h,".disable(",l,");"));f(d,".",b,"=",y,";")}else if(Array.isArray(y)){var n=g[b];f(h,".",na[b],
"(",y,");",y.map(function(c,f){return n+"["+f+"]="+c}).join(";"),";")}else f(h,".",na[b],"(",y,");",d,".",b,"=",y,";")}})}function ta(c,f){ka&&!c.instancing&&(c.instancing=f.def(c.shared.extensions,".angle_instanced_arrays"))}function wa(c,f,a,e,b){function g(c){switch(c){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function k(a,e,b){function g(){f("if(!",l,".pointer){",t,".enableVertexAttribArray(",
y,");",l,".pointer=true;}");var a=b.type,h;h=b.size?f.def(b.size,"||",e):e;f("if(",l,".type!==",a,"||",l,".size!==",h,"||",ra.map(function(c){return l+"."+c+"!=="+b[c]}).join("||"),"){",t,".bindBuffer(",34962,",",n,".buffer);",t,".vertexAttribPointer(",[y,h,a,b.normalized,b.stride,b.offset],");",l,".type=",a,";",l,".size=",h,";",ra.map(function(c){return l+"."+c+"="+b[c]+";"}).join(""),"}");ka&&(a=b.divisor,f("if(",l,".divisor!==",a,"){",c.instancing,".vertexAttribDivisorANGLE(",[y,a],");",l,".divisor=",
a,";}"))}function d(){f("if(",l,".pointer){",t,".disableVertexAttribArray(",y,");",l,".pointer=false;","}if(",M.map(function(c,f){return l+"."+c+"!=="+w[f]}).join("||"),"){",t,".vertexAttrib4f(",y,",",w,");",M.map(function(c,f){return l+"."+c+"="+w[f]+";"}).join(""),"}")}var t=h.gl,y=f.def(a,".location"),l=f.def(h.attributes,"[",y,"]");a=b.state;var n=b.buffer,w=[b.x,b.y,b.z,b.w],ra=["buffer","normalized","offset","stride"];1===a?g():2===a?d():(f("if(",a,"===",1,"){"),g(),f("}else{"),d(),f("}"))}
var h=c.shared;e.forEach(function(h){var e=h.name,d=a.attributes[e],l;if(d){if(!b(d))return;l=d.append(c,f)}else{if(!b(V))return;var y=c.scopeAttrib(e);l={};Object.keys(new sa).forEach(function(c){l[c]=f.def(y,".",c)})}k(c.link(h),g(h.info.type),l)})}function aa(c,f,a,b,e){for(var g=c.shared,k=g.gl,h,d=0;d<b.length;++d){var l=b[d],y=l.name,t=l.info.type,n=a.uniforms[y],l=c.link(l)+".location";if(n){if(!e(n))continue;if(n["static"]){y=n.value;if(35678===t||35680===t)t=c.link(y._texture),f(k,".uniform1i(",
l,t+".bind());"),f.exit(t,".unbind()");else if(35674===t||35675===t||35676===t)y=c.global.def("["+y+"]"),n=2,35675===t?n=3:35676===t&&(n=4),f(k,".uniformMatrix",n,"fv(",l,",false,",y,");");else{switch(t){case 5126:h="1f";break;case 35664:h="2f";break;case 35665:h="3f";break;case 35666:h="4f";break;case 35670:h="1i";break;case 5124:h="1i";break;case 35671:h="2i";break;case 35667:h="2i";break;case 35672:h="3i";break;case 35668:h="3i";break;case 35673:h="4i";break;case 35669:h="4i"}f(k,".uniform",h,
"(",l,",",y,");")}continue}else y=n.append(c,f)}else{if(!e(V))continue;y=f.def(g.uniforms,"[",m.id(y),"]")}n=",";switch(t){case 35678:case 35680:t=f.def(y,"._texture");f(k,".uniform1i(",l,",",t,".bind());");f.exit(t,".unbind();");continue;case 5124:case 35670:h="1i";break;case 35667:case 35671:h="2iv";break;case 35668:case 35672:h="3iv";break;case 35669:case 35673:h="4iv";break;case 5126:h="1f";break;case 35664:h="2fv";break;case 35665:h="3fv";break;case 35666:h="4fv";break;case 35674:h="Matrix2fv";
n=",false,";break;case 35675:h="Matrix3fv";n=",false,";break;case 35676:h="Matrix4fv",n=",false,"}f(k,".uniform",h,"(",l,n,y,");")}}function ca(c,f,a,b){function e(h){var b=d[h];return b?b.batchStatic?b.append(c,f):b.append(c,a):f.def(y,".",h)}function g(){function c(){a(D,".drawElementsInstancedANGLE(",[A,p,C,r+"<<(("+C+"-5121)>>1)",u],");")}function f(){a(D,".drawArraysInstancedANGLE(",[A,r,p,u],");")}n?m?c():(a("if(",n,"){"),c(),a("}else{"),f(),a("}")):f()}function l(){function c(){a(t+".drawElements("+
[A,p,C,r+"<<(("+C+"-5121)>>1)"]+");")}function f(){a(t+".drawArrays("+[A,r,p]+");")}n?m?c():(a("if(",n,"){"),c(),a("}else{"),f(),a("}")):f()}var h=c.shared,t=h.gl,y=h.draw,d=b.draw,n=function(){var h=d.elements,b=f;h?(h.batchStatic||(b=a),h=h.append(c,b)):h=b.def(y,".","elements");h&&b("if("+h+")"+t+".bindBuffer(34963,"+h+".buffer.buffer);");return h}(),A=e("primitive"),r=e("offset"),p=function(){var h=d.count,b=f;h?(h.batchStatic||(b=a),h=h.append(c,b)):h=b.def(y,".","count");return h}();if("number"===
typeof p){if(0===p)return}else a("if(",p,"){"),a.exit("}");var u,D;ka&&(u=e("instances"),D=c.instancing);var C=n+".type",m=d.elements&&k(d.elements);ka&&("number"!==typeof u||0<=u)?"string"===typeof u?(a("if(",u,">0){"),g(),a("}else if(",u,"<0){"),l(),a("}")):g():l()}function da(c,f,a,b,e){f=ja();e=f.proc("body",e);ka&&(f.instancing=e.def(f.shared.extensions,".angle_instanced_arrays"));c(f,e,a,b);return f.compile().body}function Ba(c,f,a,b){ta(c,f);wa(c,f,a,b.attributes,function(){return!0});aa(c,
f,a,b.uniforms,function(){return!0});ca(c,f,f,a)}function Ca(c,f){var a=c.proc("draw",1);ta(c,a);W(c,a,f.context);ba(c,a,f.framebuffer);qa(c,a,f);va(c,a,f.state);var b=f.shader.progVar.append(c,a);a(c.shared.gl,".useProgram(",b,".program);");if(f.shader.program)Ba(c,a,f,f.shader.program);else{var e=c.global.def("{}"),g=a.def(b,".id"),l=a.def(e,"[",g,"]");a(c.cond(l).then(l,".call(this,a0);")["else"](l,"=",e,"[",g,"]=",c.link(function(a){return da(Ba,c,f,a,1)}),"(",b,");",l,".call(this,a0);"))}0<Object.keys(f.state).length&&
a(c.shared.current,".dirty=true;")}function Ea(c,f,a,b){function e(){return!0}c.batchId="a1";ta(c,f);wa(c,f,a,b.attributes,e);aa(c,f,a,b.uniforms,e);ca(c,f,f,a)}function xa(c,f,a,b){function e(c){return c.contextDep&&l||c.propDep}function g(c){return!e(c)}ta(c,f);var l=a.contextDynamic,h=f.def(),k=f.def();c.shared.props=k;c.batchId=h;var d=c.scope(),t=c.scope();f(d.entry,"for(",h,"=0;",h,"<","a1",";++",h,"){",k,"=","a0","[",h,"];",t,"}",d.exit);a.needsContext&&W(c,t,a.context);a.needsFramebuffer&&
ba(c,t,a.framebuffer);va(c,t,a.state,e);b?(wa(c,d,a,b.attributes,g),wa(c,t,a,b.attributes,e),aa(c,d,a,b.uniforms,g),aa(c,t,a,b.uniforms,e),ca(c,d,t,a)):(f=c.global.def("{}"),b=a.shader.progVar.append(c,t),k=t.def(b,".id"),d=t.def(f,"[",k,"]"),t(c.shared.gl,".useProgram(",b,".program);","if(!",d,"){",d,"=",f,"[",k,"]=",c.link(function(f){return da(Ea,c,a,f,2)}),"(",b,");}",d,".call(this,a0[",h,"],",h,");"))}function Da(c,f){var a=c.proc("batch",2);c.batchId="0";ta(c,a);var b=!1,e=!0;Object.keys(f.context).forEach(function(c){b=
b||f.context[c].propDep});b||(W(c,a,f.context),e=!1);var g=f.framebuffer,t=!1;g&&(g.propDep?b=t=!0:g.contextDep&&b&&(t=!0),t||ba(c,a,g));f.state.viewport&&f.state.viewport.propDynamic&&(b=!0);qa(c,a,f);va(c,a,f.state,function(c){return!(c.contextDep&&b||c.propDep)});f.contextDep=b;f.needsContext=e;f.needsFramebuffer=t;e=f.shader.progVar;if(e.contextDep&&b||e.propDep)xa(c,a,f,null);else if(e=e.append(c,a),a(c.shared.gl,".useProgram(",e,".program);"),f.shader.program)xa(c,a,f,f.shader.program);else{var g=
c.global.def("{}"),t=a.def(e,".id"),h=a.def(g,"[",t,"]");a(c.cond(h).then(h,".call(this,a0,a1);")["else"](h,"=",g,"[",t,"]=",c.link(function(a){return da(xa,c,f,a,2)}),"(",e,");",h,".call(this,a0,a1);"))}0<Object.keys(f.state).length&&a(c.shared.current,".dirty=true;")}function za(c,f){function a(g){var h=f.shader[g];h&&b.set(e.shader,"."+g,h.append(c,b))}var b=c.proc("scope",3);c.batchId="a2";var e=c.shared,g=e.current;W(c,b,f.context);f.framebuffer&&f.framebuffer.append(c,b);l(Object.keys(f.state)).forEach(function(a){var h=
f.state[a].append(c,b);Array.isArray(h)?h.forEach(function(f,h){b.set(c.next[a],"["+h+"]",f)}):b.set(e.next,"."+a,h)});["elements","offset","count","instances","primitive"].forEach(function(a){var h=f.draw[a];h&&b.set(e.draw,"."+a,""+h.append(c,b))});Object.keys(f.uniforms).forEach(function(a){b.set(e.uniforms,"["+m.id(a)+"]",f.uniforms[a].append(c,b))});Object.keys(f.attributes).forEach(function(a){var h=f.attributes[a].append(c,b),e=c.scopeAttrib(a);Object.keys(new sa).forEach(function(c){b.set(e,
"."+c,h[c])})});a("vert");a("frag");0<Object.keys(f.state).length&&(b(g,".dirty=true;"),b.exit(g,".dirty=true;"));b("a1(",c.shared.context,",a0,0);")}var sa=R.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};E.ext_blend_minmax&&(Z.min=32775,Z.max=32776);var ka=E.angle_instanced_arrays,ga=E.webgl_draw_buffers,f={dirty:!0},y={},t=[],ma={},na={};H("dither",3024);H("blend.enable",3042);I("blend.color","blendColor",[0,0,0,0]);I("blend.equation","blendEquationSeparate",[32774,32774]);I("blend.func",
"blendFuncSeparate",[1,0,1,0]);H("depth.enable",2929,!0);I("depth.func","depthFunc",513);I("depth.range","depthRange",[0,1]);I("depth.mask","depthMask",!0);I("colorMask","colorMask",[!0,!0,!0,!0]);H("cull.enable",2884);I("cull.face","cullFace",1029);I("frontFace","frontFace",2305);I("lineWidth","lineWidth",1);H("polygonOffset.enable",32823);I("polygonOffset.offset","polygonOffset",[0,0]);H("sample.alpha",32926);H("sample.enable",32928);I("sample.coverage","sampleCoverage",[1,!1]);H("stencil.enable",
2960);I("stencil.mask","stencilMask",-1);I("stencil.func","stencilFunc",[519,0,-1]);I("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);I("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);H("scissor.enable",3089);I("scissor.box","scissor",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);I("viewport","viewport",[0,0,d.drawingBufferWidth,d.drawingBufferHeight]);var Fa={gl:d,context:ia,strings:m,next:y,current:f,draw:S,elements:N,buffer:G,shader:Y,attributes:R.state,uniforms:P,
framebuffer:ha,extensions:E,isBufferArgs:n},Aa={primTypes:v,compareFuncs:p,blendFuncs:C,blendEquations:Z,stencilOps:g,glTypes:A,orientationType:a};ga&&(Aa.backBuffer=[1029],Aa.drawBuffer=z(q.maxDrawbuffers,function(c){return 0===c?[0]:z(c,function(c){return 36064+c})}));var X=0;return{next:y,current:f,procs:function(){var c=ja(),a=c.proc("poll"),b=c.proc("refresh"),e=c.block();a(e);b(e);var g=c.shared,t=g.gl,d=g.next,h=g.current;e(h,".dirty=false;");ba(c,a);b(g.framebuffer,".dirty=true;");ba(c,b);
Object.keys(ma).forEach(function(f){var g=ma[f],l=e.def(d,".",f),k=c.block();k("if(",l,"){",t,".enable(",g,")}else{",t,".disable(",g,")}",h,".",f,"=",l,";");b(k);a("if(",l,"!==",h,".",f,"){",k,"}")});Object.keys(na).forEach(function(g){var l=na[g],k=f[g],y,n,A=c.block();A(t,".",l,"(");Array.isArray(k)?(l=k.length,y=c.global.def(d,".",g),n=c.global.def(h,".",g),A(z(l,function(c){return y+"["+c+"]"}),");",z(l,function(c){return n+"["+c+"]="+y+"["+c+"];"}).join("")),a("if(",z(l,function(c){return y+
"["+c+"]!=="+n+"["+c+"]"}).join("||"),"){",A,"}")):(y=e.def(d,".",g),n=e.def(h,".",g),A(y,");",h,".",g,"=",y,";"),a("if(",y,"!==",n,"){",A,"}"));b(A)});return c.compile()}(),compile:function(c,f,a,b){var e=ja(),g;g=fa(c);var t=oa(c,g),h=ua(c),l=Q(c);c=L(c);var d=t.viewport;d&&(l.viewport=d);d=K("scissor.box");(t=t[d])&&(l[d]=t);t=0<Object.keys(l).length;g={framebuffer:g,draw:h,shader:c,state:l,dirty:t};g.uniforms=pa(a);g.attributes=T(f);g.context=O(b);Ca(e,g);za(e,g);Da(e,g);return e.compile()}}}},
{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":20,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/loop":24}],9:[function(d,m,q){function n(b,e){this.id=k++;this.type=b;this.data=e}function l(b){if(0===b.length)return[];var e=b.charAt(0),d=b.charAt(b.length-1);if(1<b.length&&e===d&&('"'===e||"'"===e))return['"'+b.substr(1,b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return l(b.substr(0,e.index)).concat(l(e[1])).concat(l(b.substr(e.index+
e[0].length)));e=b.split(".");if(1===e.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(d=0;d<e.length;++d)b=b.concat(l(e[d]));return b}function r(b){return"["+l(b).join("][")+"]"}var k=0;m.exports={define:function(b,e){switch(typeof e){case "boolean":case "number":case "string":return new n(b,r(e+""));case "undefined":return new n(b|128,null)}},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof n},unbox:function(b,e){if(b instanceof n){if(b.type&
128)return new n(b.type&-129,r(e))}else if("function"===typeof b)return new n(0,b);return b},accessor:r}},{}],10:[function(d,m,q){var n=d("./util/is-typed-array"),l=d("./util/is-ndarray"),r=d("./constants/primitives.json"),k=d("./constants/usage.json");m.exports=function(b,e,d){function m(b){this.buffer=b;this.primType=4;this.type=this.vertCount=0}function J(b,k,r,p,g,a,m){(a=m)||n(k)&&(!l(k)||n(k.data))||(a=e.oes_element_index_uint?5125:5123);b.buffer.bind();d._initBuffer(b.buffer,k,r,a,3);k=m;if(!m){switch(b.buffer.dtype){case 5121:case 5120:k=
5121;break;case 5123:case 5122:k=5123;break;case 5125:case 5124:k=5125}b.buffer.dtype=k}b.type=k;0>g&&(g=b.buffer.byteLength,5123===k?g>>=1:5125===k&&(g>>=2));b.vertCount=g;g=p;0>p&&(g=4,p=b.buffer.dimension,1===p&&(g=0),2===p&&(g=1),3===p&&(g=4));b.primType=g}var E={uint8:5121,uint16:5123};e.oes_element_index_uint&&(E.uint32=5125);m.prototype.bind=function(){this.buffer.bind()};var v=[];return{create:function(e){function v(e){if(e)if("number"===typeof e)C(e),p.primType=4,p.vertCount=e|0,p.type=5121;
else{var a=null,d=35044,A=-1,m=-1,u=0,z=0;Array.isArray(e)||n(e)||l(e)?a=e:("data"in e&&(a=e.data),"usage"in e&&(d=k[e.usage]),"primitive"in e&&(A=r[e.primitive]),"count"in e&&(m=e.count|0),"length"in e&&(u=e.length|0),"type"in e&&(z=E[e.type]));a?J(p,a,d,A,m,u,z):(e=p.buffer,e.bind(),b.bufferData(34963,u,d),e.dtype=z||5121,e.usage=d,e.dimension=3,e.byteLength=u,p.primType=0>A?4:A,p.vertCount=0>m?0:m,p.type=e.dtype)}else C(),p.primType=4,p.vertCount=0,p.type=5121;return v}var C=d.create(null,34963,
!0),p=new m(C._buffer);v(e);v._reglType="elements";v._elements=p;v.subdata=function(b,a){C.subdata(b,a);return v};v.destroy=function(){C.destroy();p.buffer=null};return v},createStream:function(b){var e=v.pop();e||(e=new m(d.create(null,34963,!0)._buffer));J(e,b,35040,-1,-1,0,0);return e},destroyStream:function(b){v.push(b)},getElements:function(b){return"function"===typeof b&&b._elements instanceof m?b._elements:null}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":22,
"./util/is-typed-array":23}],11:[function(d,m,q){m.exports=function(d){function l(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(k){try{r[k]=
d.getExtension(k)}catch(b){}})}var r={};l();return{extensions:r,refresh:l}}},{}],12:[function(d,m,q){var n=d("./util/values"),l=d("./util/extend");m.exports=function(d,k,b,e,m){function z(a,b,e,d){this.target=a;this.level=b;this.texture=e;this.renderbuffer=d}function J(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function E(a,b){var e=b.width,d=b.height;if(a.texture)var g=a.texture._texture,k=Math.max(1,g.params.width>>a.level),l=Math.max(1,
g.params.height>>a.level),e=e||k,d=d||l;else g=a.renderbuffer._renderbuffer,e=e||g.width,d=d||g.height;g.refCount+=1;b.width=e;b.height=d}function v(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function A(a){var b=3553,e=0,d=null,g=null;"object"===typeof a&&("level"in a&&(e=a.level|0),"target"in a&&(b=a.target|0));var k=a._reglType;
"texture"===k?d=a:"renderbuffer"===k&&(g=a,b=36161,e=0);return new z(b,e,d,g)}function M(a){return a&&(a.texture||a.renderbuffer)}function C(){this.id=G++;N[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function p(e){d.isFramebuffer(e.framebuffer)||(e.framebuffer=d.createFramebuffer());a.dirty=!0;d.bindFramebuffer(36160,e.framebuffer);for(var g=
e.colorAttachments,l=0;l<g.length;++l)v(36064+l,g[l]);for(l=g.length;l<b.maxColorAttachments;++l)v(36064+l,null);v(36096,e.depthAttachment);v(36128,e.stencilAttachment);v(33306,e.depthStencilAttachment);k.webgl_draw_buffers&&k.webgl_draw_buffers.drawBuffersWEBGL(ea[g.length]);d.checkFramebufferStatus(36160)}function g(a){a=a.framebuffer;d.isFramebuffer(a)&&d.deleteFramebuffer(a)}var a={current:null,next:null,dirty:!1},V={rgba:6408},B={rgba4:32854,rgb565:36194,"rgb5 a1":32855};k.ext_srgb&&(B.srgba=
35907);k.ext_color_buffer_half_float&&(B.rgba16f=34842,B.rgb16f=34843);k.webgl_color_buffer_float&&(B.rgba32f=34836);var q=[],la=[];k.webgl_depth_texture&&(q.push(6402),la.push(34041));l(l({},V),B);n(V);n(B);B=5121;q={uint8:5121};k.oes_texture_half_float&&(B=q["half float"]=36193);k.oes_texture_float&&(B=q["float"]=5126);q.best=B;var ea=function(){for(var a=Array(b.maxDrawbuffers),e=0;e<=b.maxDrawbuffers;++e)for(var d=a[e]=Array(e),g=0;g<e;++g)d[g]=36064+g;return a}(),G=0,N={};return l(a,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof C)?a:null},create:function(a){function b(a){var g,k=a||{},n=a=0;if("shape"in k){var C=k.shape;a=C[0];n=C[1]}else"radius"in k&&(a=n=k.radius),"width"in k&&(a=k.width),"height"in k&&(n=k.height);var v=null,C=!1;if("colorBuffers"in k||"colorBuffer"in k){v=k.colorBuffers||k.colorBuffer;Array.isArray(v)||(v=[v]);l.width=a;l.height=n;v=v.map(A);for(g=0;g<v.length;++g)E(v[g],l);a=l.width;n=l.height}else{var q=!0,B="rgba",D="uint8",G=1,
C=!0;l.width=a=a||d.drawingBufferWidth;l.height=n=n||d.drawingBufferHeight;"format"in k&&(B=k.format,q=B in V);"type"in k&&(D=k.type);"colorCount"in k&&(G=k.colorCount|0);if(l.ownsColor)for(v=l.colorAttachments;v.length>G;)J(v.pop());else v=[];for(g=0;g<v.length;++g){var L;a:{L=v[g];var U=q,Q=B,N=a,T=n;if(L.texture){var O=L.texture;if(U){O({format:Q,type:D,width:N,height:T});O._texture.refCount+=1;L=!0;break a}}else if(O=L.renderbuffer,!U){O({format:Q,width:N,height:T});O._renderbuffer.refCount+=
1;L=!0;break a}J(L);L=!1}L||(v[g--]=v[v.length-1],v.pop())}for(;v.length<G;)q?v.push(new z(3553,0,e.create2D({format:B,type:D,width:a,height:n},3553),null)):v.push(new z(36161,0,null,m.create({format:B,width:a,height:n})))}l.width=a;l.height=n;B=q=g=null;D=!1;"depthBuffer"in k&&(g=A(k.depthBuffer));"stencilBuffer"in k&&(q=A(k.stencilBuffer));"depthStencilBuffer"in k&&(B=A(k.depthStencilBuffer));if(g||q||B)E(g||q||B,l);else if(G=!0,U=L=!1,"depth"in k&&(G=!!k.depth),"stencil"in k&&(L=!!k.stencil),"depthTexture"in
k&&(U=!!k.depthTexture),k=l.depthAttachment||l.stencilAttachment||l.depthStencilAttachment,Q=null,G||L)D=!0,U?(U=L?"depth stencil":"depth",l.ownsDepthStencil&&k.texture?(k.texture({format:U,width:a,height:n}),k.texture._texture.refCount+=1,Q=k):Q=new z(3553,0,e.create({format:U,width:a,height:n},3553),null)):(U=G?L?"depth stencil":"depth":"stencil",l.ownsDepthStencil&&k.renderbuffer?(k.renderbuffer({format:U,width:a,height:n}),k.renderbuffer._renderbuffer.refCount+=1,Q=k):Q=new z(36161,0,null,m.create({format:U,
width:a,height:n}))),G?L?B=Q:g=Q:q=Q;a=l;a.colorAttachments.forEach(J);J(a.depthAttachment);J(a.stencilAttachment);J(a.depthStencilAttachment);l.colorAttachments=v;l.depthAttachment=g;l.stencilAttachment=q;l.depthStencilAttachment=B;l.ownsColor=C;l.ownsDepthStencil=D;b.color=v.map(M);b.depth=M(g);b.stencil=M(q);b.depthStencil=M(B);p(l);b.width=l.width;b.height=l.height;return b}var l=new C;b(a);b._reglType="framebuffer";b._framebuffer=l;b._destroy=function(){g(l)};return b},clear:function(){n(N).forEach(g)},
refresh:function(){n(N).forEach(p)}})}},{"./util/extend":21,"./util/values":28}],13:[function(d,m,q){m.exports=function(d,l){var m=1;l.ext_texture_filter_anisotropic&&(m=d.getParameter(34047));var k=1,b=1;l.webgl_draw_buffers&&(k=d.getParameter(34852),b=d.getParameter(36063));return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),subpixelBits:d.getParameter(3408),extensions:Object.keys(l).filter(function(b){return!!l[b]}),
maxAnisotropic:m,maxDrawbuffers:k,maxColorAttachments:b,pointSizeDims:d.getParameter(33901),lineWidthDims:d.getParameter(33902),maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),maxVertexTextureUnits:d.getParameter(35660),maxVaryingVectors:d.getParameter(36348),
maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),renderer:d.getParameter(7937),vendor:d.getParameter(7936),version:d.getParameter(7938)}}},{}],14:[function(d,m,q){var n=d("./util/is-typed-array");m.exports=function(d,m,k){return function(b){var e=b||{};n(b)?e={data:e}:2===arguments.length?e={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof b&&(e={});m();var u=e.x||0,z=e.y||0,q=e.width||k.viewportWidth,E=e.height||k.viewportHeight,e=e.data||new Uint8Array(q*E*4);d.pixelStorei(3333,
4);d.readPixels(u,z,q,E,6408,5121,e);return e}}},{"./util/is-typed-array":23}],15:[function(d,m,q){var n=d("./util/values");m.exports=function(d,m,k){function b(){this.id=q++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function e(b){d.isRenderbuffer(b.renderbuffer)||(b.renderbuffer=d.createRenderbuffer());d.bindRenderbuffer(36161,b.renderbuffer);d.renderbufferStorage(36161,b.format,b.width,b.height)}function u(b){var e=b.renderbuffer;d.bindRenderbuffer(36161,
null);d.isRenderbuffer(e)&&d.deleteRenderbuffer(e);b.renderbuffer=null;b.refCount=0;delete E[b.id]}var z={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};m.ext_srgb&&(z.srgba=35907);m.ext_color_buffer_half_float&&(z.rgba16f=34842,z.rgb16f=34843);m.webgl_color_buffer_float&&(z.rgba32f=34836);var q=0,E={};b.prototype.decRef=function(){0===--this.refCount&&u(this)};return{create:function(d){function k(b){b=b||{};var d=0,g=0;"shape"in b?(g=b.shape,d=g[0]|0,g=
g[1]|0):("radius"in b&&(d=g=b.radius|0),"width"in b&&(d=b.width|0),"height"in b&&(g=b.height|0));k.width=l.width=Math.max(d,1);k.height=l.height=Math.max(g,1);l.format=32854;"format"in b&&(l.format=z[b.format]);e(l);return k}var l=new b;E[l.id]=l;k(d);k._reglType="renderbuffer";k._renderbuffer=l;k.destroy=function(){l.decRef()};return k},refresh:function(){n(E).forEach(e)},clear:function(){n(E).forEach(u)}}}},{"./util/values":28}],16:[function(d,m,q){var n=d("./util/values");m.exports=function(d,
m){function k(b,e,d,a){this.name=b;this.id=e;this.location=d;this.info=a}function b(b,e){for(var d=0;d<b.length;++d)if(b[d].id===e.id){b[d].location=e.location;return}b.push(e)}function e(b,e,k){k=35632===b?q:E;var a=k[e];if(!a){var n=m.str(e),a=d.createShader(b);d.shaderSource(a,n);d.compileShader(a);k[e]=a}return a}function u(b,e){this.id=M++;this.fragId=b;this.vertId=e;this.program=null;this.uniforms=[];this.attributes=[]}function z(n,A){var g,a;g=e(35632,n.fragId);a=e(35633,n.vertId);var u=n.program=
d.createProgram();d.attachShader(u,g);d.attachShader(u,a);d.linkProgram(u);var v=d.getProgramParameter(u,35718),z=n.uniforms;for(g=0;g<v;++g)if(a=d.getActiveUniform(u,g))if(1<a.size)for(var q=0;q<a.size;++q){var E=a.name.replace("[0]","["+q+"]");b(z,new k(E,m.id(E),d.getUniformLocation(u,E),a))}else b(z,new k(a.name,m.id(a.name),d.getUniformLocation(u,a.name),a));v=d.getProgramParameter(u,35721);z=n.attributes;for(g=0;g<v;++g)(a=d.getActiveAttrib(u,g))&&b(z,new k(a.name,m.id(a.name),d.getAttribLocation(u,
a.name),a))}var q={},E={},v={},A=[],M=0;return{clear:function(){var b=d.deleteShader.bind(d);n(q).forEach(b);q={};n(E).forEach(b);E={};A.forEach(function(b){d.deleteProgram(b.program)});A.length=0;v={}},refresh:function(){q={};E={};A.forEach(z)},program:function(b,e,d){var a=v[e];a||(a=v[e]={});var k=a[b];k||(k=new u(e,b),z(k,d),a[b]=k,A.push(k));return k},shader:e,frag:null,vert:null}}},{"./util/values":28}],17:[function(d,m,q){m.exports=function(){var d={"":0},l=[""];return{id:function(m){var k=
d[m];if(k)return k;k=d[m]=l.length;l.push(m);return k},str:function(d){return l[d]}}}},{}],18:[function(d,m,q){function n(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function l(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var e=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==e)return!1;return!0}function r(a){return Object.prototype.toString.call(a)}function k(a){if(!a)return!1;var b=r(a);return 0<=g.indexOf(b)?!0:
n(a)||l(a)||J(a)}function b(a,b){36193===a.type?(a.data=v(b),E.freeType(b)):a.data=b}var e=d("./util/extend"),u=d("./util/values"),z=d("./util/is-typed-array"),J=d("./util/is-ndarray"),E=d("./util/pool"),v=d("./util/to-half-float");q=d("./constants/arraytypes.json");var A=d("./constants/arraytypes.json"),M=[9984,9986,9985,9987],C=[0,6409,6410,6407,6408],p={};p[6409]=p[6406]=p[6402]=1;p[34041]=p[6410]=2;p[6407]=3;p[6408]=4;var g=Object.keys(q).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]",
"[object HTMLImageElement]","[object HTMLVideoElement]"]);m.exports=function(a,d,g,m,q){function ea(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function G(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;
a.width=b.width;a.height=b.height;a.channels=b.channels}function N(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=wa[b.colorSpace]);"type"in b&&(a.type=aa[b.type]);var e=a.width,d=a.height,k=a.channels,g=!1;"shape"in b?(e=b.shape[0],d=b.shape[1],3===b.shape.length&&(k=b.shape[2],g=!0)):("radius"in b&&(e=d=b.radius),"width"in b&&(e=b.width),
"height"in b&&(d=b.height),"channels"in b&&(k=b.channels,g=!0));a.width=e|0;a.height=d|0;a.channels=k|0;e=!1;"format"in b&&(e=b.format,d=a.internalformat=ca[e],a.format=Ea[d],e in aa&&!("type"in b)&&(a.type=aa[e]),e in da&&(a.compressed=!0),e=!0);!g&&e?a.channels=p[a.format]:g&&!e&&a.channels!==C[a.format]&&(a.format=a.internalformat=C[a.channels])}}function D(f){a.pixelStorei(37440,f.flipY);a.pixelStorei(37441,f.premultiplyAlpha);a.pixelStorei(37443,f.colorSpace);a.pixelStorei(3317,f.unpackAlignment)}
function ha(){ea.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function P(a,e){var d=null;k(e)?d=e:e&&(N(a,e),"x"in e&&(a.xOffset=e.x|0),"y"in e&&(a.yOffset=e.y|0),k(e.data)&&(d=e.data));if(e.copy){var g=q.viewportWidth,m=q.viewportHeight;a.width=a.width||g-a.xOffset;a.height=a.height||m-a.yOffset;a.needsCopy=!0}else if(!d)a.width=a.width||1,a.height=a.height||1;else if(z(d))a.data=d,"type"in e||5121!==a.type||(a.type=A[Object.prototype.toString.call(d)]|
0);else if(n(d)){g=d;m=a.width*a.height*a.channels;switch(a.type){case 5121:case 5123:case 5125:case 5126:m=E.allocType(a.type,m);m.set(g);a.data=m;break;case 36193:a.data=v(g)}a.alignment=1;a.needsFree=!0}else if(J(d)){g=d.data;Array.isArray(g)||5121!==a.type||(a.type=A[Object.prototype.toString.call(g)]|0);var m=d.shape,u=d.stride,p,X,c,x;3===m.length?(c=m[2],x=u[2]):x=c=1;p=m[0];X=m[1];m=u[0];u=u[1];a.alignment=1;a.width=p;a.height=X;a.channels=c;a.format=a.internalformat=C[c];a.needsFree=!0;p=
x;d=d.offset;c=a.width;x=a.height;X=a.channels;for(var B=E.allocType(36193===a.type?5126:a.type,c*x*X),D=0,F=0;F<x;++F)for(var w=0;w<c;++w)for(var ba=0;ba<X;++ba)B[D++]=g[m*w+u*F+p*ba+d];b(a,B)}else if("[object HTMLCanvasElement]"===r(d)||"[object CanvasRenderingContext2D]"===r(d))"[object HTMLCanvasElement]"===r(d)?a.element=d:a.element=d.canvas,a.width=a.element.width,a.height=a.element.height;else if("[object HTMLImageElement]"===r(d))a.element=d,a.width=d.naturalWidth,a.height=d.naturalHeight;
else if("[object HTMLVideoElement]"===r(d))a.element=d,a.width=d.videoWidth,a.height=d.videoHeight,a.needsPoll=!0;else if(l(d)){g=d[0].length;m=d.length;u=1;if(Array.isArray(d[0][0])){p=u=d[0][0].length;c=E.allocType(36193===a.type?5126:a.type,g*m*p);for(X=x=0;X<m;++X)for(B=d[X],D=0;D<g;++D)for(F=B[D],w=0;w<p;++w)c[x++]=F[w];b(a,c)}else{p=E.allocType(36193===a.type?5126:a.type,g*m);for(x=c=0;x<m;++x)for(X=d[x],B=0;B<g;++B)p[c++]=X[B];b(a,p)}a.alignment=1;a.width=g;a.height=m;a.channels=u;a.format=
a.internalformat=C[u];a.needsFree=!0}}function R(b,e,d,k,g){var l=b.element,n=b.data,u=b.internalformat,c=b.format,A=b.type,v=b.width,p=b.height;D(b);l?a.texSubImage2D(e,g,d,k,c,A,l):b.compressed?a.compressedTexSubImage2D(e,g,d,k,u,v,p,n):b.needsCopy?(m(),a.copyTexSubImage2D(e,g,d,k,b.xOffset,b.yOffset,v,p)):a.texSubImage2D(e,g,d,k,v,p,c,A,n)}function Y(){return xa.pop()||new ha}function S(a){a.needsFree&&E.freeType(a.data);ha.call(a);xa.push(a)}function ia(){ea.call(this);this.genMipmaps=!1;this.mipmapHint=
4352;this.mipmask=0;this.images=Array(16)}function K(a,b,e){var d=a.images[0]=Y();a.mipmask=1;d.width=a.width=b;d.height=a.height=e}function H(a,b){var e=null;if(k(b))e=a.images[0]=Y(),P(e,b),a.mipmask=1;else if(N(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,g=0;g<d.length;++g)e=a.images[g]=Y(),G(e,a),e.width>>=g,e.height>>=g,P(e,d[g]),a.mipmask|=1<<g;else e=a.images[0]=Y(),G(e,a),P(e,b),a.mipmask=1;G(a,a.images[0])}function I(b,e){for(var d=b.images,k=0;k<d.length&&d[k];++k){var g=d[k],l=e,n=
k,u=g.element,c=g.data,A=g.internalformat,v=g.format,p=g.type,r=g.width,w=g.height;D(g);u?a.texImage2D(l,n,v,v,p,u):g.compressed?a.compressedTexImage2D(l,n,A,r,w,0,c):g.needsCopy?(m(),a.copyTexImage2D(l,n,v,g.xOffset,g.yOffset,r,w,0)):a.texImage2D(l,n,v,r,w,0,v,p,c)}}function ja(){var a=Da.pop()||new ia;ea.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function fa(a){for(var b=a.images,e=0;e<b.length;++e)b[e]&&S(b[e]),b[e]=null;Da.push(a)}function oa(){this.magFilter=this.minFilter=
9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function L(a,b){"min"in b&&(a.minFilter=ta[b.min],0<=M.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=va[b.mag]);var e=a.wrapS,d=a.wrapT;if("wrap"in b){var g=b.wrap;"string"===typeof g?e=d=qa[g]:Array.isArray(g)&&(e=qa[g[0]],d=qa[g[1]])}else"wrapS"in b&&(e=qa[b.wrapS]),"wrapT"in b&&(d=qa[b.wrapT]);a.wrapS=e;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){e=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=
ba[b.mipmap];e=a.genMipmaps=!0;break;case "boolean":e=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,e=!0}!e||"min"in b||(a.minFilter=9984)}}function ua(b,e){a.texParameteri(e,10241,b.minFilter);a.texParameteri(e,10240,b.magFilter);a.texParameteri(e,10242,b.wrapS);a.texParameteri(e,10243,b.wrapT);d.ext_texture_filter_anisotropic&&a.texParameteri(e,34046,b.anisotropic);b.genMipmaps&&(a.hint(33170,b.mipmapHint),a.generateMipmap(e))}function Q(){var a=za.pop()||new oa;oa.call(a);return a}
function pa(b){ea.call(this);this.mipmask=0;this.id=sa++;this.refCount=1;this.target=b;this.texture=a.createTexture();this.unit=-1;this.bindCount=0}function T(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function O(){var b=ga[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function W(b){var e=b.texture,d=b.unit,g=b.target;0<=d&&(a.activeTexture(33984+d),a.bindTexture(g,null),ga[d]=null);a.deleteTexture(e);b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete Z[b.id]}
var ba={"don't care":4352,"dont care":4352,nice:4354,fast:4353},qa={repeat:10497,clamp:33071,mirror:33648},va={nearest:9728,linear:9729},ta=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},va),wa={none:0,browser:37444},aa={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ca={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},da={};d.ext_srgb&&(ca.srgb=35904,
ca.srgba=35906);d.oes_texture_float&&(aa["float"]=5126);d.oes_texture_half_float&&(aa.float16=aa["half float"]=36193);d.webgl_depth_texture&&(e(ca,{depth:6402,"depth stencil":34041}),e(aa,{uint16:5123,uint32:5125,"depth stencil":34042}));d.webgl_compressed_texture_s3tc&&e(da,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});d.webgl_compressed_texture_atc&&e(da,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});d.webgl_compressed_texture_pvrtc&&
e(da,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});d.webgl_compressed_texture_etc1&&(da["rgb etc1"]=36196);var Ba=Array.prototype.slice.call(a.getParameter(34467));Object.keys(da).forEach(function(a){var b=da[a];0<=Ba.indexOf(b)&&(ca[a]=b)});var Ca=Object.keys(ca);g.textureFormats=Ca;var Ea=Ca.reduce(function(a,b){var e=ca[b];6409===e||6406===e||6409===e||6410===e||6402===e||34041===e?a[e]=e:32855===e||0<=b.indexOf("rgba")?a[e]=6408:a[e]=
6407;return a},{}),xa=[],Da=[],za=[],sa=0,Z={},ka=g.maxTextureUnits,ga=Array(ka).map(function(){return null});e(pa.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var e=0;e<ka;++e){var d=ga[e];if(d){if(0<d.bindCount)continue;d.unit=-1}ga[e]=this;b=e;break}this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&W(this)}});return{create2D:function(a,b){function e(a,b){var f=
Q(),g=ja();"number"===typeof a?"number"===typeof b?K(g,a|0,b|0):K(g,a|0,a|0):a?(L(f,a),H(g,a)):K(g,1,1);f.genMipmaps&&(g.mipmask=(g.width<<1)-1);d.mipmask=g.mipmask;G(d,g);e.width=g.width;e.height=g.height;T(d);I(g,3553);ua(f,3553);O();za.push(f);fa(g);return e}var d=new pa(3553);Z[d.id]=d;e(a,b);e.subimage=function(a,b,f,g){b|=0;f|=0;g|=0;var c=Y();G(c,d);c.width>>=g;c.height>>=g;c.width-=b;c.height-=f;P(c,a);T(d);R(c,3553,b,f,g);O();S(c);return e};e._reglType="texture2d";e._texture=d;e.destroy=
function(){d.decRef()};return e},createCube:function(a,b,e,d,g,k){function l(a,b,e,d,f,g){var h,k=Q();for(h=0;6>h;++h)c[h]=ja();if("number"===typeof a||!a)for(a=a|0||1,h=0;6>h;++h)K(c[h],a,a);else if("object"===typeof a)if(b)H(c[0],a),H(c[1],b),H(c[2],e),H(c[3],d),H(c[4],f),H(c[5],g);else if(L(k,a),N(n,a),"faces"in a)for(a=a.faces,h=0;6>h;++h)G(c[h],n),H(c[h],a[h]);else for(h=0;6>h;++h)H(c[h],a);G(n,c[0]);n.mipmask=k.genMipmaps?(c[0].width<<1)-1:c[0].mipmask;l.width=c[0].width;l.height=c[0].height;
T(n);for(h=0;6>h;++h)I(c[h],34069+h);ua(k,34067);O();za.push(k);for(h=0;6>h;++h)fa(c[h]);return l}var n=new pa(34067);Z[n.id]=n;var c=Array(6);l(a,b,e,d,g,k);l.subimage=function(a,b,c,e,d){c|=0;e|=0;d|=0;var f=Y();G(f,n);f.width>>=d;f.height>>=d;f.width-=c;f.height-=e;P(f,b);T(n);R(f,34069+a,c,e,d);O();S(f);return l};l._reglType="textureCube";l._texture=n;l.destroy=function(){n.decRef()};return l},clear:function(){for(var b=0;b<ka;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ga[b]=null;u(Z).forEach(W)},
getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":21,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/pool":25,"./util/to-half-float":27,"./util/values":28}],19:[function(d,m,q){m.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],20:[function(d,m,q){function n(d){return Array.prototype.slice.call(d)}function l(d){return n(d).join("")}var r=d("./extend");m.exports=function(){function d(){var b=
[],k=[];return r(function(){b.push.apply(b,n(arguments))},{def:function(){var d="v"+e++;k.push(d);0<arguments.length&&(b.push(d,"="),b.push.apply(b,n(arguments)),b.push(";"));return d},toString:function(){return l([0<k.length?"var "+k+";":"",l(b)])}})}function b(){function b(d,a){l(d,a,"=",e.def(d,a),";")}var e=d(),l=d(),n=e.toString,m=l.toString;return r(e,{entry:e,exit:l,save:b,set:function(d,a,k){b(d,a);e(d,a,"=",k,";")},toString:function(){return n()+m()}})}var e=0,m=[],z=[],q=d(),E={};return{global:q,
link:function(b){for(var d=0;d<z.length;++d)if(z[d]===b)return m[d];d="g"+e++;m.push(d);z.push(b);return d},block:d,proc:function(e,d){function k(){var a="a"+n.length;n.push(a);return a}var n=[];d=d||0;for(var m=0;m<d;++m)k();var m=b(),g=m.toString;return E[e]=r(m,{arg:k,toString:function(){return l(["function(",n.join(),"){",g(),"}"])}})},scope:b,cond:function(){var e=l(arguments),d=b(),k=b(),m=d.toString,u=k.toString;return r(d,{then:function(){d.apply(d,n(arguments));return this},"else":function(){k.apply(k,
n(arguments));return this},toString:function(){var b=u();b&&(b="else{"+b+"}");return l(["if(",e,"){",m(),"}",b])}})},compile:function(){var b=['"use strict";',q,"return {"];Object.keys(E).forEach(function(e){b.push('"',e,'":',E[e].toString(),",")});b.push("}");var e=l(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,m.concat(e)).apply(null,z)}}}},{"./extend":21}],21:[function(d,m,q){m.exports=function(d,l){for(var m=Object.keys(l),k=0;k<m.length;++k)d[m[k]]=
l[m[k]];return d}},{}],22:[function(d,m,q){var n=d("./is-typed-array");m.exports=function(d){return!!d&&"object"===typeof d&&Array.isArray(d.shape)&&Array.isArray(d.stride)&&"number"===typeof d.offset&&d.shape.length===d.stride.length&&(Array.isArray(d.data)||n(d.data))}},{"./is-typed-array":23}],23:[function(d,m,q){var n=d("../constants/arraytypes.json");m.exports=function(d){return Object.prototype.toString.call(d)in n}},{"../constants/arraytypes.json":4}],24:[function(d,m,q){m.exports=function(d,
l){for(var m=Array(d),k=0;k<d;++k)m[k]=l(k);return m}},{}],25:[function(d,m,q){function n(b){var e,d;e=(65535<b)<<4;b>>>=e;d=(255<b)<<3;b>>>=d;e|=d;d=(15<b)<<2;b>>>=d;e|=d;d=(3<b)<<1;return e|d|b>>>d>>1}function l(b){a:{for(var e=16;268435456>=e;e*=16)if(b<=e){b=e;break a}b=0}e=k[n(b)>>2];return 0<e.length?e.pop():new ArrayBuffer(b)}function r(b){k[n(b.byteLength)>>2].push(b)}var k=d("./loop")(8,function(){return[]});m.exports={alloc:l,free:r,allocType:function(b,e){var d=null;switch(b){case 5120:d=
new Int8Array(l(e),0,e);break;case 5121:d=new Uint8Array(l(e),0,e);break;case 5122:d=new Int16Array(l(2*e),0,e);break;case 5123:d=new Uint16Array(l(2*e),0,e);break;case 5124:d=new Int32Array(l(4*e),0,e);break;case 5125:d=new Uint32Array(l(4*e),0,e);break;case 5126:d=new Float32Array(l(4*e),0,e);break;default:return null}return d.length!==e?d.subarray(0,e):d},freeType:function(b){r(b.buffer)}}},{"./loop":24}],26:[function(d,m,q){m.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?
{next:function(d){return requestAnimationFrame(d)},cancel:function(d){return cancelAnimationFrame(d)}}:{next:function(d){setTimeout(d,30)},cancel:clearTimeout}},{}],27:[function(d,m,q){var n=d("./pool"),l=new Float32Array(1),r=new Uint32Array(l.buffer);m.exports=function(d){for(var b=n.allocType(5123,d.length),e=0;e<d.length;++e)if(isNaN(d[e]))b[e]=65535;else if(Infinity===d[e])b[e]=31744;else if(-Infinity===d[e])b[e]=64512;else{l[0]=d[e];var m=r[0],q=m>>>31<<15,J=(m<<1>>>24)-127,m=m>>13&1023;b[e]=
-24>J?q:-14>J?q+(m+1024>>-14-J):15<J?q+31744:q+(J+15<<10)+m}return b}},{"./pool":25}],28:[function(d,m,q){m.exports=function(d){return Object.keys(d).map(function(l){return d[l]})}},{}],29:[function(d,m,q){function n(d,b){function e(){var b=window.innerWidth,e=window.innerHeight;d!==document.body&&(e=d.getBoundingClientRect(),b=e.right-e.left,e=e.top-e.bottom);m.width=q*b;m.height=q*e;r(m.style,{width:b+"px",height:e+"px"})}var m=document.createElement("canvas"),n=l(m,b);r(m.style,{border:0,margin:0,
padding:0,top:0,left:0});d.appendChild(m);d===document.body&&(m.style.position="absolute",r(d.style,{margin:0,padding:0}));var q=+n.options.pixelRatio;window.addEventListener("resize",e,!1);var E=n.options.onDestroy;n.options=r(r({},n.options),{onDestroy:function(){window.removeEventListener("resize",e);d.removeChild(m);E&&E()}});e();return n}function l(d,b){function e(b){try{return d.getContext(b,l)}catch(e){return null}}var l=b.glOptions||{};return{gl:e("webgl")||e("experimental-webgl")||e("webgl-experimental"),
options:r({pixelRatio:window.devicePixelRatio},b)}}var r=d("./util/extend");m.exports=function(d){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:d[0],options:d[1]||{}};var b=document.body,e=d[1]||{};if("string"===typeof d[0])b=document.querySelector(d[0])||document.body;else if("object"===typeof d[0])if(d[0]instanceof HTMLElement)b=d[0];else{if(d[0]instanceof WebGLRenderingContext)return{gl:d[0],options:r({pixelRatio:1},e)};e=d[0]}return b.nodeName&&"CANVAS"===b.nodeName.toUpperCase()?
l(b,e):n(b,e)}},{"./util/extend":21}],30:[function(d,m,q){var n=d("./lib/util/extend"),l=d("./lib/dynamic"),r=d("./lib/util/raf"),k=d("./lib/util/clock"),b=d("./lib/strings"),e=d("./lib/webgl"),u=d("./lib/extension"),z=d("./lib/limits"),J=d("./lib/buffer"),E=d("./lib/elements"),v=d("./lib/texture"),A=d("./lib/renderbuffer"),M=d("./lib/framebuffer"),C=d("./lib/attribute"),p=d("./lib/shader"),g=d("./lib/read"),a=d("./lib/core");m.exports=function(){function d(){W=r.next(d);K.count+=1;var a=k();K.deltaTime=
(a-Y)/1E3;K.time=(a-R)/1E3;Y=a;G();for(a=0;a<O.length;++a)(0,O[a])(K,null,0)}function m(a){}function q(a){}function la(a){function b(a){var d={},e={};Object.keys(a).forEach(function(b){var g=a[b];l.isDynamic(g)?e[b]=l.unbox(g,b):d[b]=g});return{dynamic:e,"static":d}}function d(a){for(;r.length<a;)r.push(null);return r}var e=b(a.context||{}),g=b(a.uniforms||{}),k=b(a.attributes||{});a=b(function(a){function b(a){if(a in d){var e=d[a];delete d[a];Object.keys(e).forEach(function(b){d[a+"."+b]=e[b]})}}
var d=n({},a);delete d.uniforms;delete d.attributes;delete d.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return d}(a));var e=Q.compile(a,k,g,e),m=e.draw,q=e.batch,p=e.scope,r=[];return function(a,b){var e;if("function"===typeof a)return p.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(e=0;e<a;++e)p.call(this,null,b,e);else if(Array.isArray(a))for(e=0;e<a.length;++e)p.call(this,a[e],b,e);else return p.call(this,a,b,0);else if("number"===
typeof a){if(0<a)return q.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return q.call(this,a,a.length)}else return m.call(this,a)}}function ea(){Q.procs.poll()}function G(){var a=pa.viewport,b=pa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;K.viewportWidth=K.frameBufferWidth=K.drawingBufferWidth=a[2]=b[2]=D.drawingBufferWidth;K.viewportHeight=K.frameBufferWidth=K.drawingBufferHeight=a[3]=b[3]=D.drawingBufferHeight;Q.procs.refresh()}var N=e(Array.prototype.slice.call(arguments)),D=N.gl,ha=N.options,
N=b(),P=u(D).extensions,R=k(),Y=R,S=D.drawingBufferWidth,ia=D.drawingBufferHeight,K={count:0,deltaTime:0,time:0,viewportWidth:S,viewportHeight:ia,framebufferWidth:S,framebufferHeight:ia,drawingBufferWidth:S,drawingBufferHeight:ia,pixelRatio:ha.pixelRatio},H=z(D,P),I=J(D),S=E(D,P,I),ia=C(D,P,H,I,N),ja=p(D,N),fa=v(D,P,H,ea,K),oa=A(D,P,H),L=M(D,P,H,fa,oa),ua=g(D,ea,K),Q=a(D,N,P,H,I,S,fa,L,{},ia,ja,{elements:null,primitive:4,count:-1,offset:0,instances:-1},K),pa=Q.next,T=D.canvas,O=[],W=0;T&&(T.addEventListener("webglcontextlost",
m,!1),T.addEventListener("webglcontextrestored",q,!1));G();return n(la,{clear:function(a){var b=0;ea();var d=a.color;d&&(D.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),b|=16384);"depth"in a&&(D.clearDepth(+a.depth),b|=256);"stencil"in a&&(D.clearStencil(a.stencil|0),b|=1024);D.clear(b)},prop:l.define.bind(null,1),context:l.define.bind(null,2),"this":l.define.bind(null,3),draw:la({}),buffer:function(a){return I.create(a,34962)},elements:S.create,texture:fa.create2D,cube:fa.createCube,renderbuffer:oa.create,
framebuffer:L.create,framebufferCube:function(a){},attributes:D.getContextAttributes(),frame:function(a){O.push(a);!W&&0<O.length&&d();return{cancel:function(){var b=O.find(function(b){return b===a});0>b||(O.splice(b,1),0>=O.length&&W&&(r.cancel(d),W=0))}}},limits:H,hasExtension:function(a){return 0<=H.extensions.indexOf(a.toLowerCase())},read:ua,destroy:function(){W&&(r.cancel(d),W=0);T&&(T.removeEventListener("webglcontextlost",m),T.removeEventListener("webglcontextrestored",q));ja.clear();L.clear();
oa.clear();fa.clear();I.clear();if(ha.onDestroy)ha.onDestroy()},_gl:D,_refresh:G})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/strings":17,"./lib/texture":18,"./lib/util/clock":19,"./lib/util/extend":21,"./lib/util/raf":26,"./lib/webgl":29}]},{},[1]);

        </script>
        </body>
      </html>