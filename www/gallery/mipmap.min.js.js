(function e$$0(p,t,a){function m(n,k){if(!t[n]){if(!p[n]){var K="function"==typeof require&&require;if(!k&&K)return K(n,!0);if(d)return d(n,!0);K=Error("Cannot find module '"+n+"'");throw K.code="MODULE_NOT_FOUND",K;}K=t[n]={exports:{}};p[n][0].call(K.exports,function(d){var a=p[n][1][d];return m(a?a:d)},K,K.exports,e$$0,p,t,a)}return t[n].exports}for(var d="function"==typeof require&&require,k=0;k<a.length;k++)m(a[k]);return m})({1:[function(b,p,t){b=b("../regl")();var a=b({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform float tick;\n  varying vec2 uv;\n  void main () {\n    mat3 m = mat3(\n      cos(tick), sin(tick), -1.1 + cos(tick),\n      -sin(tick), cos(tick), 0,\n      0, 0, 1);\n    vec3 p = m * vec3(uv, 1);\n    gl_FragColor = texture2D(texture, p.xy / p.z);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n  }",attributes:{position:[-2,0,0,-2,2,2]},uniforms:{tick:function(a){return.005*a.count},texture:b.texture({min:"nearest mipmap linear",mag:"nearest",wrap:"repeat",data:[[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[0,0,0,0,255,255,255,255],[0,0,0,0,255,255,255,255],
[0,0,0,0,255,255,255,255],[0,0,0,0,255,255,255,255]]})},count:3});b.frame(function(){a()})},{"../regl":30}],2:[function(b,p,t){function a(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}p.exports=function(m,d,k,n,g){m=k.maxAttributes;d=Array(m);for(k=0;k<m;++k)d[k]=new a;return{Record:a,scope:{},state:d}}},{}],3:[function(b,p,t){function a(d,a){switch(d){case 5121:return new Uint8Array(a);case 5123:return new Uint16Array(a);
case 5125:return new Uint32Array(a);case 5120:return new Int8Array(a);case 5122:return new Int16Array(a);case 5124:return new Int32Array(a);case 5126:return new Float32Array(a);default:return null}}var m=b("./util/is-typed-array"),d=b("./util/is-ndarray"),k=b("./constants/arraytypes.json"),n=b("./constants/dtypes.json"),g=b("./util/values"),K={"static":35044,dynamic:35048,stream:35040};p.exports=function(b){function p(a){this.id=A++;this.buffer=null;this.type=a;this.usage=35044;this.byteLength=0;
this.dimension=1;this.data=null;this.dtype=5121}function z(a){b.isBuffer(a.buffer)||(a.buffer=b.createBuffer());a.bind();b.bufferData(a.type,a.data||a.byteLength,a.usage)}function u(a){var d=a.buffer;b.isBuffer(d)&&b.deleteBuffer(d);a.buffer=null;delete c[a.id]}function r(g,b,r){function A(c){var g=c||{};if(Array.isArray(g)||m(g)||d(g))g={data:g};else if("number"===typeof g)g={length:g|0};else if(null===g||void 0===g)g={};B.usage="usage"in g?K[g.usage]:35044;c=0;"type"in g&&(c=n[g.type]);var b=g.dimension|
0||1,r=0,v=null;if("data"in g)if(v=g.data,null===v)r=g.length|0;else{if(d(v)){var b=v.shape,r=v.stride,g=v.offset,w=0,H=0,u=0,x=0;1===b.length?(w=b[0],H=1,u=r[0],x=0):2===b.length&&(w=b[0],H=b[1],u=r[0],x=r[1]);c=c||k[Object.prototype.toString.call(v.data)]|0||5126;for(var b=H,r=a(c,w*H),v=v.data,p=0,G=0;G<w;++G)for(var y=0;y<H;++y)r[p++]=v[u*G+x*y+g];v=r}else if(Array.isArray(v))if(0<v.length&&Array.isArray(v[0])){b=v[0].length;c=c||5126;g=a(c,v.length*b);r=v;v=b;for(w=x=0;w<r.length;++w)for(u=r[w],
H=0;H<v;++H)g[x++]=u[H];v=g}else c=c||5126,v=a(c,v);else c=c||k[Object.prototype.toString.call(v)]|0;r=v.byteLength}else"length"in g&&(r=g.length|0);B.data=v;B.dtype=c||5121;B.byteLength=r;B.dimension=b;z(B);return A}var B=new p(b);c[B.id]=B;r||A(g);A._reglType="buffer";A._buffer=B;A.destroy=function(){u(B)};return A}var A=0,c={};p.prototype.bind=function(){b.bindBuffer(this.type,this.buffer)};return{create:r,createStream:function(a){return r({data:a,usage:"stream"},34962,!1)._buffer},destroyStream:function(a){u(a)},
clear:function(){g(c).forEach(u)},refresh:function(){g(c).forEach(z)},getBuffer:function(a){return a&&a._buffer instanceof p?a._buffer:null}}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/values":28}],4:[function(b,p,t){p.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,
"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(b,p,t){p.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],6:[function(b,p,t){p.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(b,p,t){function a(a){return Array.isArray(a)||U(a)||z(a)}function m(a){return a.sort(function(a,c){return"viewport"===a?-1:"viewport"===
c?1:a<c?-1:1})}function d(a,c,d,g){this.thisDep=a;this.contextDep=c;this.propDep=d;this.append=g}function k(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function n(a){return new d(!1,!1,!1,a)}function g(a,c){var g=a.type;return 0===g?(g=a.data.length,new d(!0,1<=g,2<=g,c)):new d(3===g,2===g,1===g,c)}var K=b("./util/codegen"),y=b("./util/loop"),U=b("./util/is-typed-array"),z=b("./util/is-ndarray"),u=b("./constants/primitives.json"),r=b("./constants/dtypes.json"),A=["x","y","z","w"],c={0:0,1:1,
zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},v={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},x={0:0,zero:0,
keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},G={cw:2304,ccw:2305},aa=new d(!1,!1,!1,function(){});p.exports=function(b,p,z,t,V,I,w,H,fa,R,X,ga,M){function P(l){return l.replace(".","_")}function F(l,h,a){var f=P(l);ra.push(l);oa[f]=ja[f]=!!a;ka[f]=h}function D(l,h,a){var f=P(l);ra.push(l);Array.isArray(a)?(ja[f]=a.slice(),oa[f]=a.slice()):ja[f]=oa[f]=a;la[f]=h}function Q(){var l=K(),h=l.link,a=l.global;l.id=Ca++;l.batchId="0";var f=
h(za),c=l.shared={props:"a0"};Object.keys(za).forEach(function(e){c[e]=a.def(f,".",e)});var E=l.next={},g=l.current={};Object.keys(la).forEach(function(e){Array.isArray(ja[e])&&(E[e]=a.def(c.next,".",e),g[e]=a.def(c.current,".",e))});var e=l.constants={};Object.keys(sa).forEach(function(l){e[l]=a.def(JSON.stringify(sa[l]))});l.invoke=function(e,a){switch(a.type){case 0:var ba=["this",c.context,c.props,l.batchId];return e.def(h(a.data),".call(",ba.slice(0,Math.max(a.data.length+1,4)),")");case 1:return e.def(c.props,
a.data);case 2:return e.def(c.context,a.data);case 3:return e.def("this",a.data)}};l.attribCache={};var ba={};l.scopeAttrib=function(e){e=p.id(e);if(e in ba)return ba[e];var l=R.scope[e];l||(l=R.scope[e]=new pa);return ba[e]=h(l)};return l}function ca(l){var a=l["static"];l=l.dynamic;if("framebuffer"in a){var h=a.framebuffer;return h?(h=H.getFramebuffer(h),n(function(l,a){var f=l.link(h),e=l.shared;a.set(e.framebuffer,".next",f);e=e.context;a.set(e,".framebufferWidth",f+".width");a.set(e,".framebufferHeight",
f+".height");return f})):n(function(l,a){var h=l.shared;a.set(h.framebuffer,".next","null");h=h.context;a.set(h,".framebufferWidth",h+".drawingBufferWidth");a.set(h,".framebufferHeight",h+".drawingBufferHeight");return null})}if("framebuffer"in l){var f=l.framebuffer;return g(f,function(l,a){var h=l.invoke(a,f),e=l.shared,ba=e.framebuffer,h=a.def(ba,".getFramebuffer(",h,")");a.set(ba,".next",h);e=e.context;a.set(e,".framebufferWidth",h+"?"+h+".width:"+e+".drawingBufferWidth");a.set(e,".framebufferHeight",
h+"?"+h+".height:"+e+".drawingBufferHeight");return h})}return null}function Y(l,a){function h(e){if(e in f){var l=f[e];e=!0;var ia=l.x|0,Aa=l.y|0,E,q;"w"in l?E=l.w|0:e=!1;"h"in l?q=l.h|0:e=!1;return new d(e&&a&&a.thisDep,e&&a&&a.contextDep,e&&a&&a.propDep,function(e,a){var h=e.shared.context,f=E;"w"in l||(f=a.def(h,".","framebufferWidth","-",ia));var c=q;"h"in l||(c=a.def(h,".","framebufferHeight","-",Aa));return[ia,Aa,f,c]})}if(e in c){var na=c[e];e=g(na,function(e,a){var l=e.invoke(a,na),h=e.shared.context,
f=a.def(l,".x|0"),ba=a.def(l,".y|0"),ia=a.def('"w" in ',l,"?",l,".w|0:","(",h,".","framebufferWidth","-",f,")"),l=a.def('"h" in ',l,"?",l,".h|0:","(",h,".","framebufferHeight","-",ba,")");return[f,ba,ia,l]});a&&(e.thisDep=e.thisDep||a.thisDep,e.contextDep=e.contextDep||a.contextDep,e.propDep=e.propDep||a.prpoDep);return e}return a?new d(a.thisDep,a.contextDep,a.propDep,function(e,a){var l=e.shared.context;return[0,0,a.def(l,".","framebufferWidth"),a.def(l,".","framebufferHeight")]}):null}var f=l["static"],
c=l.dynamic,E=h("viewport");if(E)var q=E,E=new d(E.thisDep,E.contextDep,E.propDep,function(e,a){var l=q.append(e,a),h=e.shared.context;a.set(h,".viewportWidth",l[2]);a.set(h,".viewportHeight",l[3]);return l});return{viewport:E,scissor_box:h("scissor.box")}}function L(a){function h(e){if(e in f){var a=p.id(f[e]);e=n(function(){return a});e.id=a;return e}if(e in c){var l=c[e];return g(l,function(e,a){var h=e.invoke(a,l);return a.def(e.shared.strings,".id(",h,")")})}return null}var f=a["static"],c=a.dynamic,
q=h("frag"),E=h("vert"),m=null;k(q)&&k(E)?(m=X.program(E.id,q.id),a=n(function(e,a){return e.link(m)})):a=new d(q&&q.thisDep||E&&E.thisDep,q&&q.contextDep||E&&E.contextDep,q&&q.propDep||E&&E.propDep,function(e,a){var l=e.shared.shader,h;h=q?q.append(e,a):a.def(l,".","frag");var f;f=E?E.append(e,a):a.def(l,".","vert");return a.def(l+".program("+f+","+h+")")});return{frag:q,vert:E,progVar:a,program:m}}function J(l){function h(a,e){if(a in f){var l=f[a]|0;return n(function(a,h){e&&(a.OFFSET=l);return l})}if(a in
c){var ia=c[a];return g(ia,function(a,l){var h=a.invoke(l,ia);e&&(a.OFFSET=h);return h})}return e&&q?n(function(e,a){e.OFFSET="0";return 0}):null}var f=l["static"],c=l.dynamic,q=function(){if("elements"in f){var l=f.elements;a(l)?l=I.getElements(I.create(l)):l&&(l=I.getElements(l));var e=n(function(e,a){if(l){var h=e.link(l);return e.ELEMENTS=h}return e.ELEMENTS=null});e.value=l;return e}if("elements"in c){var h=c.elements;return g(h,function(e,a){var l=e.shared,f=l.isBufferArgs,l=l.elements,c=e.invoke(a,
h),q=a.def("null"),f=a.def(f,"(",c,")"),c=e.cond(f).then(q,"=",l,".createStream(",c,");")["else"](q,"=",l,".getElements(",c,");");a.entry(c);a.exit(e.cond(f).then(l,".destroyStream(",q,");"));return e.ELEMENTS=q})}return null}(),E=h("offset",!0);return{elements:q,primitive:function(){if("primitive"in f){var a=f.primitive;return n(function(e,l){return u[a]})}if("primitive"in c){var e=c.primitive;return g(e,function(a,l){var h=a.constants.primTypes,f=a.invoke(l,e);return l.def(h,"[",f,"]")})}return q?
k(q)?q.value?n(function(e,a){return a.def(e.ELEMENTS,".primType")}):n(function(){return 4}):new d(q.thisDep,q.contextDep,q.propDep,function(e,a){var l=e.ELEMENTS;return a.def(l,"?",l,".primType:",4)}):null}(),count:function(){if("count"in f){var a=f.count|0;return n(function(){return a})}if("count"in c){var e=c.count;return g(e,function(a,l){return a.invoke(l,e)})}return q?k(q)?q?E?new d(E.thisDep,E.contextDep,E.propDep,function(e,a){return a.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):n(function(e,
a){return a.def(e.ELEMENTS,".vertCount")}):n(function(){return-1}):new d(q.thisDep||E.thisDep,q.contextDep||E.contextDep,q.propDep||E.propDep,function(e,a){var l=e.ELEMENTS;return e.OFFSET?a.def(l,"?",l,".vertCount-",e.OFFSET,":-1"):a.def(l,"?",l,".vertCount:-1")}):null}(),instances:h("instances",!1),offset:E}}function T(a){var h=a["static"],f=a.dynamic,q={};ra.forEach(function(a){function l(e,c){if(a in h){var ia=e(h[a]);q[d]=n(function(){return ia})}else if(a in f){var E=f[a];q[d]=g(E,function(e,
a){return c(e,a,e.invoke(a,E))})}}var d=P(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return l(function(e){return e},function(e,a,l){return l});case "depth.func":return l(function(e){return v[e]},function(e,a,l){return a.def(e.constants.compareFuncs,"[",l,"]")});case "depth.range":return l(function(e){return e},function(e,a,l){e=
a.def("+",l,"[0]");a=a.def("+",l,"[1]");return[e,a]});case "blend.func":return l(function(e){return[c["srcRGB"in e?e.srcRGB:e.src],c["dstRGB"in e?e.dstRGB:e.dst],c["srcAlpha"in e?e.srcAlpha:e.src],c["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,a,l){function h(e,c){var q=a.def('"',e,c,'" in ',l,"?",l,".",e,c,":",l,".",e);return a.def(f,"[",q,"]")}var f=e.constants.blendFuncs;e=h("src","RGB");var c=h("src","Alpha"),q=h("dst","RGB"),ha=h("dst","Alpha");return[e,q,c,ha]});case "blend.equation":return l(function(e){if("string"===
typeof e)return[ma[e],ma[e]];if("object"===typeof e)return[ma[e.rgb],ma[e.alpha]]},function(e,a,l){var h=e.constants.blendEquations,f=a.def(),c=a.def();e=e.cond("typeof ",l,'==="string"');e.then(f,"=",c,"=",h,"[",l,"];");e["else"](f,"=",h,"[",l,".rgb];",c,"=",h,"[",l,".alpha];");a(e);return[f,c]});case "blend.color":return l(function(e){return y(4,function(a){return+e[a]})},function(e,a,l){return y(4,function(e){return a.def("+",l,"[",e,"]")})});case "stencil.mask":return l(function(e){return e|0},
function(e,a,l){return a.def(l,"|0")});case "stencil.func":return l(function(e){return[v[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,a,l){e=a.def('"cmp" in ',l,"?",e.constants.compareFuncs,"[",l,".cmp]",":",7680);var h=a.def(l,".ref|0");a=a.def('"mask" in ',l,"?",l,".mask|0:-1");return[e,h,a]});case "stencil.opFront":case "stencil.opBack":return l(function(e){return["stencil.opBack"===a?1029:1028,x[e.fail||"keep"],x[e.zfail||"keep"],x[e.pass||"keep"]]},function(e,l,h){function f(e){return l.def('"',
e,'" in ',h,"?",c,"[",h,".",e,"]:",7680)}var c=e.constants.stencilOps;return["stencil.opBack"===a?1029:1028,f("fail"),f("zfail"),f("pass")]});case "polygonOffset.offset":return l(function(e){return[e.factor|0,e.units|0]},function(e,a,l){e=a.def(l,".factor|0");a=a.def(l,".units|0");return[e,a]});case "cull.face":return l(function(e){var a=0;"front"===e?a=1028:"back"===e&&(a=1029);return a},function(e,a,l){return a.def(l,'==="front"?',1028,":",1029)});case "lineWidth":return l(function(a){return a},
function(a,l,h){return h});case "frontFace":return l(function(a){return G[a]},function(a,l,h){return l.def(h+'==="cw"?2304:2305')});case "colorMask":return l(function(a){return a.map(function(a){return!!a})},function(a,l,h){return y(4,function(a){return"!!"+h+"["+a+"]"})});case "sample.coverage":return l(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,l,h){a=l.def('"value" in ',h,"?+",h,".value:1");l=l.def("!!",h,".invert");return[a,l]})}});return q}function S(a){var h=a["static"],
f=a.dynamic,c={};Object.keys(h).forEach(function(a){var l=h[a],f;if("number"===typeof l||"boolean"===typeof l)f=n(function(){return l});else if("function"===typeof l&&"texture"===l._reglType)f=n(function(a){return a.link(l)});else if(Array.isArray(l)||U(l))f=n(function(a){return a.global.def("[",y(l.length,function(a){return l[a]}),"]")});f.value=l;c[a]=f});Object.keys(f).forEach(function(a){var l=f[a];c[a]=g(l,function(a,e){return a.invoke(e,l)})});return c}function Z(l){var h=l["static"],f=l.dynamic,
c={};Object.keys(h).forEach(function(l){var f=h[l],q=p.id(l),e=new pa;if(a(f))e.state=1,e.buffer=V.getBuffer(V.create(f,34962,!1)),e.type=e.buffer.dtype;else{var g=V.getBuffer(f);if(g)e.state=1,e.buffer=g,e.type=g.dtype;else if(f.constant){var d=f.constant;e.state=2;"number"===typeof d?e.x=d:A.forEach(function(a,l){l<d.length&&(e[a]=d[l])})}else{var g=V.getBuffer(f.buffer),m=f.offset|0,k=f.stride|0,b=f.size|0,C=!!f.normalized,na=0;"type"in f&&(na=r[f.type]);f=f.divisor|0;e.buffer=g;e.state=1;e.size=
b;e.normalized=C;e.type=na||g.dtype;e.offset=m;e.stride=k;e.divisor=f}}c[l]=n(function(a,l){var h=a.attribCache;if(q in h)return h[q];var f={isStream:!1};Object.keys(e).forEach(function(a){f[a]=e[a]});e.buffer&&(f.buffer=a.link(e.buffer));return h[q]=f})});Object.keys(f).forEach(function(a){var l=f[a];c[a]=g(l,function(a,e){function h(a){e(d[a],"=",f,".",a,"|0;")}var f=a.invoke(e,l),c=a.shared,q=c.isBufferArgs,g=c.buffer,d={isStream:e.def(!1)},ha=new pa;ha.state=1;Object.keys(ha).forEach(function(a){d[a]=
e.def(""+ha[a])});var m=d.buffer,n=d.type;e("if(",q,"(",f,")){",d.isStream,"=true;",m,"=",g,".createStream(",f,");",n,"=",m,".dtype;","}else{",m,"=",g,".getBuffer(",f,");","if(",m,"){",n,"=",m,".dtype;","}else if(",f,".constant){",d.state,"=",2,";",A.map(function(a,l){return d[a]+"="+f+".length>="+l+"?"+f+"["+l+"]:0;"}).join(""),"}else{",m,"=",g,".getBuffer(",f,".buffer);",n,'="type" in ',f,"?",c.glTypes,"[",f,".type]:",m,".dtype;",d.normalized,"=!!",f,".normalized;");h("size");h("offset");h("stride");
h("divisor");e("}}");return d})});return c}function N(a){var h=a["static"],f=a.dynamic,c={};Object.keys(h).forEach(function(a){var l=h[a];c[a]=n(function(a,e){return"number"===typeof l||"boolean"===typeof l?""+l:a.link(l)})});Object.keys(f).forEach(function(a){var l=f[a];c[a]=g(l,function(a,e){return a.invoke(e,l)})});return c}function O(a,h,f){var c=a.shared.context,q=a.scope();Object.keys(f).forEach(function(d){h.save(c,"."+d);q(c,".",d,"=",f[d].append(a,h),";")});h(q)}function h(a,h,f){var c=a.shared,
q=c.gl,d=c.framebuffer,g;ta&&(g=h.def(c.extensions,".webgl_draw_buffers"));var e=a.constants,c=e.drawBuffers,e=e.backBuffer;a=f?f.append(a,h):h.def(d,".next");h("if(",d,".dirty||",a,"!==",d,".cur){","if(",a,"){",q,".bindFramebuffer(",36160,",",a,".framebuffer);");ta&&h(g,".drawBuffersWEBGL(",c,"[",a,".colorAttachments.length]);");h("}else{",q,".bindFramebuffer(",36160,",null);");ta&&h(g,".drawBuffersWEBGL(",e,");");h("}",d,".cur=",a,";",d,".dirty=false;","}")}function q(a,h,f){var c=a.shared,q=c.gl,
d=a.current,g=a.next,e=c.current,m=c.next,n=a.cond(e,".dirty");ra.forEach(function(h){h=P(h);if(!(h in f.state)){var c,ha;if(h in g){c=g[h];ha=d[h];var k=y(ja[h].length,function(a){return n.def(c,"[",a,"]")});n(a.cond(k.map(function(a,l){return a+"==="+ha+"["+l+"]"}).join("&&")).then(q,".",la[h],"(",k,");",k.map(function(a,l){return ha+"["+l+"]="+a}).join(";"),";"))}else c=n.def(m,".",h),k=a.cond(c,"!==",e,".",h),n(k),h in ka?k(a.cond(c).then(q,".enable(",ka[h],");")["else"](q,".disable(",ka[h],");"),
e,".",h,"=",c,";"):k(q,".",la[h],"(",c,");",e,".",h,"=",c,";")}});0===Object.keys(f.state).length&&n(e,".dirty=false;");h(n)}function f(a,h,f,c){var q=a.shared,d=a.current,g=q.current,e=q.gl;m(Object.keys(f)).forEach(function(q){var m=f[q];if(!c||c(m)){var n=m.append(a,h);if(ka[q]){var b=ka[q];k(m)?n?h(e,".enable(",b,");"):h(e,".disable(",b,");"):h(a.cond(n).then(e,".enable(",b,");")["else"](e,".disable(",b,");"));h(g,".",q,"=",n,";")}else if(Array.isArray(n)){var C=d[q];h(e,".",la[q],"(",n,");",
n.map(function(a,l){return C+"["+l+"]="+a}).join(";"),";")}else h(e,".",la[q],"(",n,");",g,".",q,"=",n,";")}})}function C(a,h){qa&&!a.instancing&&(a.instancing=h.def(a.shared.extensions,".angle_instanced_arrays"))}function ua(a,h,f,c,q){function d(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function g(f,c,q){function d(){h("if(!",b,".pointer){",m,".enableVertexAttribArray(",k,");",b,".pointer=true;}");
var e=q.type,f;f=q.size?h.def(q.size,"||",c):c;h("if(",b,".type!==",e,"||",b,".size!==",f,"||",r.map(function(a){return b+"."+a+"!=="+q[a]}).join("||"),"){",m,".bindBuffer(",34962,",",C,".buffer);",m,".vertexAttribPointer(",[k,f,e,q.normalized,q.stride,q.offset],");",b,".type=",e,";",b,".size=",f,";",r.map(function(a){return b+"."+a+"="+q[a]+";"}).join(""),"}");qa&&(e=q.divisor,h("if(",b,".divisor!==",e,"){",a.instancing,".vertexAttribDivisorANGLE(",[k,e],");",b,".divisor=",e,";}"))}function n(){h("if(",
b,".pointer){",m,".disableVertexAttribArray(",k,");",b,".pointer=false;","}if(",A.map(function(a,h){return b+"."+a+"!=="+v[h]}).join("||"),"){",m,".vertexAttrib4f(",k,",",v,");",A.map(function(a,h){return b+"."+a+"="+v[h]+";"}).join(""),"}")}var m=e.gl,k=h.def(f,".location"),b=h.def(e.attributes,"[",k,"]");f=q.state;var C=q.buffer,v=[q.x,q.y,q.z,q.w],r=["buffer","normalized","offset","stride"];1===f?d():2===f?n():(h("if(",f,"===",1,"){"),d(),h("}else{"),n(),h("}"))}var e=a.shared;c.forEach(function(e){var c=
e.name,n=f.attributes[c],m;if(n){if(!q(n))return;m=n.append(a,h)}else{if(!q(aa))return;var b=a.scopeAttrib(c);m={};Object.keys(new pa).forEach(function(a){m[a]=h.def(b,".",a)})}g(a.link(e),d(e.info.type),m)})}function va(a,h,f,c,q){for(var d=a.shared,g=d.gl,e,m=0;m<c.length;++m){var n=c[m],b=n.name,k=n.info.type,C=f.uniforms[b],n=a.link(n)+".location";if(C){if(!q(C))continue;if(C["static"]){b=C.value;if(35678===k||35680===k)k=a.link(b._texture),h(g,".uniform1i(",n,k+".bind());"),h.exit(k,".unbind()");
else if(35674===k||35675===k||35676===k)b=a.global.def("["+b+"]"),C=2,35675===k?C=3:35676===k&&(C=4),h(g,".uniformMatrix",C,"fv(",n,",false,",b,");");else{switch(k){case 5126:e="1f";break;case 35664:e="2f";break;case 35665:e="3f";break;case 35666:e="4f";break;case 35670:e="1i";break;case 5124:e="1i";break;case 35671:e="2i";break;case 35667:e="2i";break;case 35672:e="3i";break;case 35668:e="3i";break;case 35673:e="4i";break;case 35669:e="4i"}h(g,".uniform",e,"(",n,",",b,");")}continue}else b=C.append(a,
h)}else{if(!q(aa))continue;b=h.def(d.uniforms,"[",p.id(b),"]")}C=",";switch(k){case 35678:case 35680:k=h.def(b,"._texture");h(g,".uniform1i(",n,",",k,".bind());");h.exit(k,".unbind();");continue;case 5124:case 35670:e="1i";break;case 35667:case 35671:e="2iv";break;case 35668:case 35672:e="3iv";break;case 35669:case 35673:e="4iv";break;case 5126:e="1f";break;case 35664:e="2fv";break;case 35665:e="3fv";break;case 35666:e="4fv";break;case 35674:e="Matrix2fv";C=",false,";break;case 35675:e="Matrix3fv";
C=",false,";break;case 35676:e="Matrix4fv",C=",false,"}h(g,".uniform",e,"(",n,C,b,");")}}function wa(a,h,f,c){function q(e){var c=b[e];return c?c.batchStatic?c.append(a,h):c.append(a,f):h.def(m,".",e)}function d(){function a(){f(H,".drawElementsInstancedANGLE(",[v,w,x,r+"<<(("+x+"-5121)>>1)",u],");")}function h(){f(H,".drawArraysInstancedANGLE(",[v,r,w,u],");")}C?p?a():(f("if(",C,"){"),a(),f("}else{"),h(),f("}")):h()}function g(){function a(){f(n+".drawElements("+[v,w,x,r+"<<(("+x+"-5121)>>1)"]+");")}
function h(){f(n+".drawArrays("+[v,r,w]+");")}C?p?a():(f("if(",C,"){"),a(),f("}else{"),h(),f("}")):h()}var e=a.shared,n=e.gl,m=e.draw,b=c.draw,C=function(){var e=b.elements,c=h;e?(e.batchStatic||(c=f),e=e.append(a,c)):e=c.def(m,".","elements");e&&c("if("+e+")"+n+".bindBuffer(34963,"+e+".buffer.buffer);");return e}(),v=q("primitive"),r=q("offset"),w=function(){var e=b.count,c=h;e?(e.batchStatic||(c=f),e=e.append(a,c)):e=c.def(m,".","count");return e}();if("number"===typeof w){if(0===w)return}else f("if(",
w,"){"),f.exit("}");var u,H;qa&&(u=q("instances"),H=a.instancing);var x=C+".type",p=b.elements&&k(b.elements);qa&&("number"!==typeof u||0<=u)?"string"===typeof u?(f("if(",u,">0){"),d(),f("}else if(",u,"<0){"),g(),f("}")):d():g()}function xa(a,h,f,c,q){h=Q();q=h.proc("body",q);qa&&(h.instancing=q.def(h.shared.extensions,".angle_instanced_arrays"));a(h,q,f,c);return h.compile().body}function Ba(a,h,f,c){C(a,h);ua(a,h,f,c.attributes,function(){return!0});va(a,h,f,c.uniforms,function(){return!0});wa(a,
h,h,f)}function Da(a,c){var d=a.proc("draw",1);C(a,d);O(a,d,c.context);h(a,d,c.framebuffer);q(a,d,c);f(a,d,c.state);var g=c.shader.progVar.append(a,d);d(a.shared.gl,".useProgram(",g,".program);");if(c.shader.program)Ba(a,d,c,c.shader.program);else{var n=a.global.def("{}"),m=d.def(g,".id"),b=d.def(n,"[",m,"]");d(a.cond(b).then(b,".call(this,a0);")["else"](b,"=",n,"[",m,"]=",a.link(function(h){return xa(Ba,a,c,h,1)}),"(",g,");",b,".call(this,a0);"))}0<Object.keys(c.state).length&&d(a.shared.current,
".dirty=true;")}function Ea(a,h,f,c){function q(){return!0}a.batchId="a1";C(a,h);ua(a,h,f,c.attributes,q);va(a,h,f,c.uniforms,q);wa(a,h,h,f)}function ya(a,c,q,d){function g(a){return a.contextDep&&m||a.propDep}function n(a){return!g(a)}C(a,c);var m=q.contextDynamic,e=c.def(),b=c.def();a.shared.props=b;a.batchId=e;var k=a.scope(),v=a.scope();c(k.entry,"for(",e,"=0;",e,"<","a1",";++",e,"){",b,"=","a0","[",e,"];",v,"}",k.exit);q.needsContext&&O(a,v,q.context);q.needsFramebuffer&&h(a,v,q.framebuffer);
f(a,v,q.state,g);d?(ua(a,k,q,d.attributes,n),ua(a,v,q,d.attributes,g),va(a,k,q,d.uniforms,n),va(a,v,q,d.uniforms,g),wa(a,k,v,q)):(c=a.global.def("{}"),d=q.shader.progVar.append(a,v),b=v.def(d,".id"),k=v.def(c,"[",b,"]"),v(a.shared.gl,".useProgram(",d,".program);","if(!",k,"){",k,"=",c,"[",b,"]=",a.link(function(h){return xa(Ea,a,q,h,2)}),"(",d,");}",k,".call(this,a0[",e,"],",e,");"))}function Fa(a,c){var d=a.proc("batch",2);a.batchId="0";C(a,d);var g=!1,n=!0;Object.keys(c.context).forEach(function(a){g=
g||c.context[a].propDep});g||(O(a,d,c.context),n=!1);var b=c.framebuffer,m=!1;b&&(b.propDep?g=m=!0:b.contextDep&&g&&(m=!0),m||h(a,d,b));c.state.viewport&&c.state.viewport.propDynamic&&(g=!0);q(a,d,c);f(a,d,c.state,function(a){return!(a.contextDep&&g||a.propDep)});c.contextDep=g;c.needsContext=n;c.needsFramebuffer=m;n=c.shader.progVar;if(n.contextDep&&g||n.propDep)ya(a,d,c,null);else if(n=n.append(a,d),d(a.shared.gl,".useProgram(",n,".program);"),c.shader.program)ya(a,d,c,c.shader.program);else{var b=
a.global.def("{}"),m=d.def(n,".id"),e=d.def(b,"[",m,"]");d(a.cond(e).then(e,".call(this,a0,a1);")["else"](e,"=",b,"[",m,"]=",a.link(function(h){return xa(ya,a,c,h,2)}),"(",n,");",e,".call(this,a0,a1);"))}0<Object.keys(c.state).length&&d(a.shared.current,".dirty=true;")}function Ga(a,h){function f(d){var e=h.shader[d];e&&c.set(q.shader,"."+d,e.append(a,c))}var c=a.proc("scope",3);a.batchId="a2";var q=a.shared,d=q.current;O(a,c,h.context);h.framebuffer&&h.framebuffer.append(a,c);m(Object.keys(h.state)).forEach(function(f){var e=
h.state[f].append(a,c);Array.isArray(e)?e.forEach(function(h,e){c.set(a.next[f],"["+e+"]",h)}):c.set(q.next,"."+f,e)});["elements","offset","count","instances","primitive"].forEach(function(f){var e=h.draw[f];e&&c.set(q.draw,"."+f,""+e.append(a,c))});Object.keys(h.uniforms).forEach(function(f){c.set(q.uniforms,"["+p.id(f)+"]",h.uniforms[f].append(a,c))});Object.keys(h.attributes).forEach(function(f){var e=h.attributes[f].append(a,c),q=a.scopeAttrib(f);Object.keys(new pa).forEach(function(a){c.set(q,
"."+a,e[a])})});f("vert");f("frag");0<Object.keys(h.state).length&&(c(d,".dirty=true;"),c.exit(d,".dirty=true;"));c("a1(",a.shared.context,",a0,0);")}var pa=R.Record,ma={add:32774,subtract:32778,"reverse subtract":32779};z.ext_blend_minmax&&(ma.min=32775,ma.max=32776);var qa=z.angle_instanced_arrays,ta=z.webgl_draw_buffers,ja={dirty:!0},oa={},ra=[],ka={},la={};F("dither",3024);F("blend.enable",3042);D("blend.color","blendColor",[0,0,0,0]);D("blend.equation","blendEquationSeparate",[32774,32774]);
D("blend.func","blendFuncSeparate",[1,0,1,0]);F("depth.enable",2929,!0);D("depth.func","depthFunc",513);D("depth.range","depthRange",[0,1]);D("depth.mask","depthMask",!0);D("colorMask","colorMask",[!0,!0,!0,!0]);F("cull.enable",2884);D("cull.face","cullFace",1029);D("frontFace","frontFace",2305);D("lineWidth","lineWidth",1);F("polygonOffset.enable",32823);D("polygonOffset.offset","polygonOffset",[0,0]);F("sample.alpha",32926);F("sample.enable",32928);D("sample.coverage","sampleCoverage",[1,!1]);F("stencil.enable",
2960);D("stencil.mask","stencilMask",-1);D("stencil.func","stencilFunc",[519,0,-1]);D("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);D("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);F("scissor.enable",3089);D("scissor.box","scissor",[0,0,b.drawingBufferWidth,b.drawingBufferHeight]);D("viewport","viewport",[0,0,b.drawingBufferWidth,b.drawingBufferHeight]);var za={gl:b,context:M,strings:p,next:oa,current:ja,draw:ga,elements:I,buffer:V,shader:X,attributes:R.state,uniforms:fa,
framebuffer:H,extensions:z,isBufferArgs:a},sa={primTypes:u,compareFuncs:v,blendFuncs:c,blendEquations:ma,stencilOps:x,glTypes:r,orientationType:G};ta&&(sa.backBuffer=[1029],sa.drawBuffer=y(t.maxDrawbuffers,function(a){return y(a,function(a){return 36064+a})}));var Ca=0;return{next:oa,current:ja,procs:function(){var a=Q(),f=a.proc("poll"),c=a.proc("refresh"),q=a.block();f(q);c(q);var d=a.shared,g=d.gl,n=d.next,e=d.current;q(e,".dirty=false;");h(a,f);c(d.framebuffer,".dirty=true;");h(a,c);Object.keys(ka).forEach(function(h){var d=
ka[h],b=q.def(n,".",h),m=a.block();m("if(",b,"){",g,".enable(",d,")}else{",g,".disable(",d,")}",e,".",h,"=",b,";");c(m);f("if(",b,"!==",e,".",h,"){",m,"}")});Object.keys(la).forEach(function(h){var d=la[h],b=ja[h],m,k,C=a.block();C(g,".",d,"(");Array.isArray(b)?(d=b.length,m=a.global.def(n,".",h),k=a.global.def(e,".",h),C(y(d,function(a){return m+"["+a+"]"}),");",y(d,function(a){return k+"["+a+"]="+m+"["+a+"];"}).join("")),f("if(",y(d,function(a){return m+"["+a+"]!=="+k+"["+a+"]"}).join("||"),"){",
C,"}")):(m=q.def(n,".",h),k=q.def(e,".",h),C(m,");",e,".",h,"=",m,";"),f("if(",m,"!==",k,"){",C,"}"));c(C)});return a.compile()}(),compile:function(a,h,f,c){var q=Q(),d;d=ca(a);var g=Y(a,d),e=J(a),n=T(a);a=L(a);var m=g.viewport;m&&(n.viewport=m);m=P("scissor.box");(g=g[m])&&(n[m]=g);g=0<Object.keys(n).length;d={framebuffer:d,draw:e,shader:a,state:n,dirty:g};d.uniforms=S(f);d.attributes=Z(h);d.context=N(c);Da(q,d);Ga(q,d);Fa(q,d);return q.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,
"./util/codegen":19,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/loop":24}],8:[function(b,p,t){function a(a,d){this.id=k++;this.type=a;this.data=d}function m(a){if(0===a.length)return[];var d=a.charAt(0),b=a.charAt(a.length-1);if(1<a.length&&d===b&&('"'===d||"'"===d))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(d=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return m(a.substr(0,d.index)).concat(m(d[1])).concat(m(a.substr(d.index+d[0].length)));
d=a.split(".");if(1===d.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(b=0;b<d.length;++b)a=a.concat(m(d[b]));return a}function d(a){return"["+m(a).join("][")+"]"}var k=0;p.exports={define:function(m,g){switch(typeof g){case "boolean":case "number":case "string":return new a(m,d(g+""));case "undefined":return new a(m|128,null)}},isDynamic:function(d){return"function"===typeof d&&!d._reglType||d instanceof a},unbox:function(m,g){if(m instanceof a){if(m.type&128)return new a(m.type&
-129,d(g))}else if("function"===typeof m)return new a(0,m);return m},accessor:d}},{}],9:[function(b,p,t){var a=b("./util/is-typed-array"),m=b("./util/is-ndarray"),d=b("./constants/primitives.json");p.exports=function(b,n,g){function p(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}function y(b){function k(g){var c=n.oes_element_index_uint;if(g)if("number"===typeof g)r(g);else{var b=null,p="static";Array.isArray(g)||a(g)||m(g)?b=g:("data"in g&&(b=g.data),"usage"in g&&(p=g.usage));Array.isArray(b)||
m(b)&&Array.isArray(b.data)||"type"in g?r({type:g.type||(c?"uint32":"uint16"),usage:p,data:b}):r({usage:p,data:b});if(Array.isArray(b)||a(b))r.dimension=3}else r();c=u.buffer.byteLength;b=0;switch(u.buffer.dtype){case 5121:case 5120:b=5121;break;case 5123:case 5122:b=5123;c>>=1;break;case 5125:case 5124:b=5125,c>>=2}var p=4,G=u.buffer.dimension;1===G&&(p=0);2===G&&(p=1);3===G&&(p=4);"object"===typeof g&&("primitive"in g&&(p=d[g.primitive]),"count"in g&&(c=g.vertCount|0));u.primType=p;u.vertCount=
c;u.type=b;return k}var u=new p,r=g.create(null,34963,!0);u.buffer=r._buffer;k(b);k._reglType="elements";k._elements=u;k.destroy=function(){r.destroy();u.buffer=null};return k}p.prototype.bind=function(){this.buffer.bind()};return{create:y,createStream:function(a){return y({usage:"stream",data:a})._elements},destroyStream:function(a){g.destroyStream(a.buffer)},getElements:function(a){return"function"===typeof a&&a._elements instanceof p?a._elements:null}}}},{"./constants/primitives.json":6,"./util/is-ndarray":21,
"./util/is-typed-array":22}],10:[function(b,p,t){p.exports=function(a){function b(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(b){try{d[b]=
a.getExtension(b)}catch(m){}})}var d={};b();return{extensions:d,refresh:b}}},{}],11:[function(b,p,t){var a=b("./util/values"),m=b("./util/extend");p.exports=function(d,b,n,g,p){function y(a,c,d,b){this.target=a;this.level=c;this.texture=d;this.renderbuffer=b}function t(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function z(a,c){var d=c.width,b=c.height;if(a.texture)var g=a.texture._texture,m=Math.max(1,g.params.width>>a.level),k=Math.max(1,
g.params.height>>a.level),d=d||m,b=b||k;else g=a.renderbuffer._renderbuffer,d=d||g.width,b=b||g.height;g.refCount+=1;c.width=d;c.height=b}function u(a,c){c?c.texture?d.framebufferTexture2D(36160,a,c.target,c.texture._texture.texture,c.level):d.framebufferRenderbuffer(36160,a,36161,c.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function r(a){var c=3553,d=0,b=null,g=null;"object"===typeof a&&("level"in a&&(d=a.level|0),"target"in a&&(c=a.target|0));var m=a._reglType;
"texture"===m?b=a:"renderbuffer"===m&&(g=a,c=36161,d=0);return new y(c,d,b,g)}function A(a){return a&&(a.texture||a.renderbuffer)}function c(){this.id=V++;I[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function v(a){d.isFramebuffer(a.framebuffer)||(a.framebuffer=d.createFramebuffer());G.dirty=!0;d.bindFramebuffer(36160,a.framebuffer);for(var c=
a.colorAttachments,g=0;g<c.length;++g)u(36064+g,c[g]);for(g=c.length;g<n.maxColorAttachments;++g)u(36064+g,null);u(36096,a.depthAttachment);u(36128,a.stencilAttachment);u(33306,a.depthStencilAttachment);b.webgl_draw_buffers&&b.webgl_draw_buffers.drawBuffersWEBGL(ea[c.length]);d.checkFramebufferStatus(36160)}function x(a){a=a.framebuffer;d.isFramebuffer(a)&&d.deleteFramebuffer(a)}var G={current:null,next:null,dirty:!1},aa={rgba:6408},B={rgba4:32854,rgb565:36194,"rgb5 a1":32855};b.ext_srgb&&(B.srgba=
35907);b.ext_color_buffer_half_float&&(B.rgba16f=34842,B.rgb16f=34843);b.webgl_color_buffer_float&&(B.rgba32f=34836);var W=[],da=[];b.webgl_depth_texture&&(W.push(6402),da.push(34041));m(m({},aa),B);a(aa);a(B);B=5121;W={uint8:5121};b.oes_texture_half_float&&(B=W["half float"]=36193);b.oes_texture_float&&(B=W["float"]=5126);W.best=B;var ea=function(){for(var a=Array(n.maxDrawbuffers),c=0;c<=n.maxDrawbuffers;++c)for(var d=a[c]=Array(c),b=0;b<c;++b)d[b]=36064+b;return a}(),V=0,I={};return m(G,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof c)?a:null},create:function(a){function b(a){var c,k=a||{},n=a=0;if("shape"in k){var u=k.shape;a=u[0];n=u[1]}else"radius"in k&&(a=n=k.radius),"width"in k&&(a=k.width),"height"in k&&(n=k.height);var x=null,u=!1;if("colorBuffers"in k||"colorBuffer"in k){x=k.colorBuffers||k.colorBuffer;Array.isArray(x)||(x=[x]);m.width=a;m.height=n;x=x.map(r);for(c=0;c<x.length;++c)z(x[c],m);a=m.width;n=m.height}else{var G=!0,w="rgba",B="uint8",I=1,
u=!0;m.width=a=a||d.drawingBufferWidth;m.height=n=n||d.drawingBufferHeight;"format"in k&&(w=k.format,G=w in aa);"type"in k&&(B=k.type);"colorCount"in k&&(I=k.colorCount|0);if(m.ownsColor)for(x=m.colorAttachments;x.length>I;)t(x.pop());else x=[];for(c=0;c<x.length;++c){var L;a:{L=x[c];var J=G,T=w,S=a,W=n;if(L.texture){var N=L.texture;if(J){N({format:T,type:B,width:S,height:W});N._texture.refCount+=1;L=!0;break a}}else if(N=L.renderbuffer,!J){N({format:T,width:S,height:W});N._renderbuffer.refCount+=
1;L=!0;break a}t(L);L=!1}L||(x[c--]=x[x.length-1],x.pop())}for(;x.length<I;)G?x.push(new y(3553,0,g.create({format:w,type:B,width:a,height:n},3553),null)):x.push(new y(36161,0,null,p.create({format:w,width:a,height:n})))}m.width=a;m.height=n;w=G=c=null;B=!1;"depthBuffer"in k&&(c=r(k.depthBuffer));"stencilBuffer"in k&&(G=r(k.stencilBuffer));"depthStencilBuffer"in k&&(w=r(k.depthStencilBuffer));if(c||G||w)z(c||G||w,m);else if(I=!0,J=L=!1,"depth"in k&&(I=!!k.depth),"stencil"in k&&(L=!!k.stencil),"depthTexture"in
k&&(J=!!k.depthTexture),k=m.depthAttachment||m.stencilAttachment||m.depthStencilAttachment,T=null,I||L)B=!0,J?(J=L?"depth stencil":"depth",m.ownsDepthStencil&&k.texture?(k.texture({format:J,width:a,height:n}),k.texture._texture.refCount+=1,T=k):T=new y(3553,0,g.create({format:J,width:a,height:n},3553),null)):(J=I?L?"depth stencil":"depth":"stencil",m.ownsDepthStencil&&k.renderbuffer?(k.renderbuffer({format:J,width:a,height:n}),k.renderbuffer._renderbuffer.refCount+=1,T=k):T=new y(36161,0,null,p.create({format:J,
width:a,height:n}))),I?L?w=T:c=T:G=T;a=m;a.colorAttachments.forEach(t);t(a.depthAttachment);t(a.stencilAttachment);t(a.depthStencilAttachment);m.colorAttachments=x;m.depthAttachment=c;m.stencilAttachment=G;m.depthStencilAttachment=w;m.ownsColor=u;m.ownsDepthStencil=B;b.color=x.map(A);b.depth=A(c);b.stencil=A(G);b.depthStencil=A(w);v(m);b.width=m.width;b.height=m.height;return b}var m=new c;b(a);b._reglType="framebuffer";b._framebuffer=m;b._destroy=function(){x(m)};return b},clear:function(){a(I).forEach(x)},
refresh:function(){a(I).forEach(v)}})}},{"./util/extend":20,"./util/values":28}],12:[function(b,p,t){p.exports=function(a,b){var d=1;b.ext_texture_filter_anisotropic&&(d=a.getParameter(34047));var k=1,n=1;b.webgl_draw_buffers&&(k=a.getParameter(34852),n=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),
maxAnisotropic:d,maxDrawbuffers:k,maxColorAttachments:n,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},{}],13:[function(b,p,t){var a=b("./util/is-typed-array");p.exports=function(b,d,k){return function(n){var g=n||{};a(n)?g={data:g}:2===arguments.length?g={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof n&&(g={});d();var p=g.x||0,y=g.y||0,t=g.width||k.viewportWidth,z=g.height||k.viewportHeight,g=g.data||new Uint8Array(t*z*4);b.pixelStorei(3333,
4);b.readPixels(p,y,t,z,6408,5121,g);return g}}},{"./util/is-typed-array":22}],14:[function(b,p,t){var a=b("./util/values");p.exports=function(b,d,k){function n(){this.id=t++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function g(a){b.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=b.createRenderbuffer());b.bindRenderbuffer(36161,a.renderbuffer);b.renderbufferStorage(36161,a.format,a.width,a.height)}function p(a){var d=a.renderbuffer;b.bindRenderbuffer(36161,
null);b.isRenderbuffer(d)&&b.deleteRenderbuffer(d);a.renderbuffer=null;a.refCount=0;delete z[a.id]}var y={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};d.ext_srgb&&(y.srgba=35907);d.ext_color_buffer_half_float&&(y.rgba16f=34842,y.rgb16f=34843);d.webgl_color_buffer_float&&(y.rgba32f=34836);var t=0,z={};n.prototype.decRef=function(){0===--this.refCount&&p(this)};return{create:function(a){function d(a){a=a||{};var m=0,k=0;"shape"in a?(k=a.shape,m=k[0]|0,k=
k[1]|0):("radius"in a&&(m=k=a.radius|0),"width"in a&&(m=a.width|0),"height"in a&&(k=a.height|0));d.width=b.width=Math.max(m,1);d.height=b.height=Math.max(k,1);b.format=32854;"format"in a&&(b.format=y[a.format]);g(b);return d}var b=new n;z[b.id]=b;d(a);d._reglType="renderbuffer";d._renderbuffer=b;d.destroy=function(){b.decRef()};return d},refresh:function(){a(z).forEach(g)},clear:function(){a(z).forEach(p)}}}},{"./util/values":28}],15:[function(b,p,t){var a=b("./util/values");p.exports=function(b,
d){function k(a,d,b,g){this.name=a;this.id=d;this.location=b;this.info=g}function n(a,d){for(var b=0;b<a.length;++b)if(a[b].id===d.id){a[b].location=d.location;return}a.push(d)}function g(a,g,k){k=35632===a?t:z;var n=k[g];if(!n){var p=d.str(g),n=b.createShader(a);b.shaderSource(n,p);b.compileShader(n);k[g]=n}return n}function p(a,b){this.id=A++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}function y(a,p){var r,u;r=g(35632,a.fragId);u=g(35633,a.vertId);var y=a.program=
b.createProgram();b.attachShader(y,r);b.attachShader(y,u);b.linkProgram(y);var t=b.getProgramParameter(y,35718),A=a.uniforms;for(r=0;r<t;++r)if(u=b.getActiveUniform(y,r))if(1<u.size)for(var K=0;K<u.size;++K){var z=u.name.replace("[0]","["+K+"]");n(A,new k(z,d.id(z),b.getUniformLocation(y,z),u))}else n(A,new k(u.name,d.id(u.name),b.getUniformLocation(y,u.name),u));t=b.getProgramParameter(y,35721);A=a.attributes;for(r=0;r<t;++r)(u=b.getActiveAttrib(y,r))&&n(A,new k(u.name,d.id(u.name),b.getAttribLocation(y,
u.name),u))}var t={},z={},u={},r=[],A=0;return{clear:function(){var c=b.deleteShader.bind(b);a(t).forEach(c);t={};a(z).forEach(c);z={};r.forEach(function(a){b.deleteProgram(a.program)});r.length=0;u={}},refresh:function(){t={};z={};r.forEach(y)},program:function(a,b,d){var g=u[b];g||(g=u[b]={});var k=g[a];k||(k=new p(b,a),y(k,d),g[a]=k,r.push(k));return k},shader:g,frag:null,vert:null}}},{"./util/values":28}],16:[function(b,p,t){p.exports=function(){var a={"":0},b=[""];return{id:function(d){var k=
a[d];if(k)return k;k=a[d]=b.length;b.push(d);return k},str:function(a){return b[a]}}}},{}],17:[function(b,p,t){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function m(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var d=a[0].length,g=1;g<b;++g)if(!Array.isArray(a[g])||a[g].length!==d)return!1;return!0}function d(a){return Object.prototype.toString.call(a)}function k(a){return"[object HTMLCanvasElement]"===d(a)}function n(a){return"[object CanvasRenderingContext2D]"===
d(a)}var g=b("./util/extend"),K=b("./util/values"),y=b("./util/is-typed-array"),U=b("./util/is-ndarray"),z=b("./util/load-texture"),u=b("./util/to-half-float"),r=b("./util/parse-dds"),A=[9984,9986,9985,9987];p.exports=function(c,b,p,t,aa){function B(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=
this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function W(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function da(a,c){var f,b,d=0,g=0,k=0,m=0,n=0,p=0,r=!1,u=!1,v=!1;for(f=0;f<c.length;++f)b=c[f],m=m||b.width<<b.miplevel,n=n||b.height<<b.miplevel,
d=d||b.type,g=g||b.format,k=k||b.internalformat,p=p||b.channels,r=r||b.needsPoll,u=u||b.needsListeners,b=b.miplevel,v=v||0<b;a.needsPoll=r;a.needsListeners=u;a.width=m;a.height=n;a.format=g;a.internalformat=k;a.type=d;if(3553!==a.target)for(f=0;6>f;++f);f=0<=A.indexOf(a.minFilter);a.genMipmaps=!v&&(a.genMipmaps||f);v=v||a.genMipmaps;a.minFilter||(a.minFilter=v?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(f=0;f<c.length;++f)b=c[f],b.channels||(b.channels=p),b.format||(b.format=g),b.internalformat||
(b.internalformat=k),b.type||(b.type=d)}function ea(a){this.id=T++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new W(a);this.pixels=[]}function V(a,b){function f(a,h){var f=h.mipmap,c;if(Array.isArray(f))for(var d=0;d<f.length;++d)c=new B(a),c.parseFlags(b),c.parseFlags(h),c.parse(f[d],d),g.push(c);else c=new B(a),c.parseFlags(b),c.parse(h,0),g.push(c)}var c;H(a);var d=a.params;W.call(d,a.target);var g=a.pixels;g.length=
0;d.parse(b);if(3553===a.target)f(3553,b);else{var k=b.faces||b;if(Array.isArray(k))for(c=0;6>c;++c)f(34069+c,k[c]);else if("string"!==typeof k)for(c=0;6>c;++c)f(34069+c,{})}da(d,g);d.needsListeners&&w(a);d.needsPoll&&(a.pollId=Z.length,Z.push(a));I(a)}function I(a){c.isTexture(a.texture)||(a.texture=c.createTexture());var b=a.target,f=a.unit;0<=f?(c.activeTexture(33984+f),J=f):c.bindTexture(b,a.texture);for(var b=a.pixels,d=a.params,g=0;g<b.length;++g)b[g].upload(d);d.upload();0>f&&((f=O[J])?c.bindTexture(f.target,
f.texture):(a.unit=J,O[J]=a))}function w(a){function b(a,h,f){var c=r(f);c.pixels.forEach(function(f){var b=new B(c.cube?f.target:a);b.channels=c.channels;b.compressed=c.compressed;b.type=c.type;b.internalformat=c.format;b.format=L[c.format];b.width=f.width;b.height=f.height;b.miplevel=f.miplevel||h;b.data=f.data;d.push(b)})}function f(){for(var f=0;f<d.length;++f){var g=d[f],k=g.image,m=g.video,n=g.xhr;k&&k.complete?(g.width=k.naturalWidth,g.height=k.naturalHeight):m&&2<m.readyState?(g.width=m.width,
g.height=m.height):n&&4===n.readyState&&(d[f]=d[d.length-1],d.pop(),n.removeEventListener("readystatechange",I),b(g.target,g.miplevel,n.response))}da(c,d);I(a)}var c=a.params,d=a.pixels;d.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",f):a.video&&1>a.readyState?a.video.addEventListener("progress",f):a.xhr&&a.xhr.addEventListener("readystatechange",f)});a.cancelPending=function(){d.forEach(function(a){a.image?a.image.removeEventListener("load",f):a.video?a.video.removeEventListener("progress",
f):a.xhr&&(a.xhr.removeEventListener("readystatechange",f),a.xhr.abort())})}}function H(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((Z[b]=Z[Z.length-1]).id=b,Z.pop(),a.pollId=-1)}function fa(a){var b=a.texture,f=a.unit,d=a.target;0<=f&&(c.activeTexture(33984+f),J=f,c.bindTexture(d,null),O[f]=null);H(a);c.isTexture(b)&&c.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete S[a.id]}var R={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
X={repeat:10497,clamp:33071,mirror:33648},ga={nearest:9728,linear:9729},M=g({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ga),P={none:0,browser:37444},F={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},D={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Q={};b.ext_srgb&&(D.srgb=35904,D.srgba=35906);b.oes_texture_float&&(F["float"]=5126);b.oes_texture_half_float&&
(F["half float"]=36193);b.webgl_depth_texture&&(g(D,{depth:6402,"depth stencil":34041}),g(F,{uint16:5123,uint32:5125,"depth stencil":34042}));b.webgl_compressed_texture_s3tc&&g(Q,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});b.webgl_compressed_texture_atc&&g(Q,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});b.webgl_compressed_texture_pvrtc&&g(Q,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});b.webgl_compressed_texture_etc1&&(Q["rgb etc1"]=36196);var ca=Array.prototype.slice.call(c.getParameter(34467));Object.keys(Q).forEach(function(a){var b=Q[a];0<=ca.indexOf(b)&&(D[a]=b)});var Y=Object.keys(D);p.textureFormats=Y;var L=Y.reduce(function(a,b){var f=D[b];6409===f||6406===f||6409===f||6410===f||6402===f||34041===f?a[f]=f:32855===f||0<=b.indexOf("rgba")?a[f]=6408:a[f]=6407;return a},{});g(B.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=P[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=D[b];b in F&&(this.type=F[b]);b in Q&&(this.compressed=!0)}"type"in a&&(this.type=F[a.type]);var b=this.width,f=this.height,c=this.channels;"shape"in a?(b=a.shape[0],f=a.shape[1],3===a.shape.length&&(c=a.shape[2])):("radius"in a&&(b=f=a.radius),"width"in a&&(b=a.width),
"height"in a&&(f=a.height),"channels"in a&&(c=a.channels));this.width=b|0;this.height=f|0;this.channels=c|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*c,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(b,c){this.miplevel=c;this.width>>=c;this.height>>=c;var f=b;switch(typeof b){case "object":if(!b)return;
this.parseFlags(b);var g=b.data;if("string"===typeof g||g&&(y(g)||a(g)||U(g)||k(g)||n(g)||"[object HTMLImageElement]"===d(g)||"[object HTMLVideoElement]"===d(g)||m(g)))f=b.data;break;case "undefined":return}"string"===typeof f&&(f=z(f,this.crossOrigin));var g=null,p=!1;if(null!==f)if(y(f))this.data=f;else if(a(f))g=f,p=!0;else if(U(f)){Array.isArray(f.data)?(g=f.data,p=!0):this.data=f.data;var r=f.shape;this.width=r[0];this.height=r[1];this.channels=3===r.length?r[2]:1;r=f.stride;this.strideX=f.stride[0];
this.strideY=f.stride[1];this.strideC=3===r.length?f.stride[2]:1;this.offset=f.offset;this.needsTranspose=!0}else if(k(f)||n(f))k(f)?this.canvas=f:this.canvas=f.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===d(f))this.image=f,f.complete?(this.width=f.naturalWidth,this.height=f.naturalHeight):(this.width=this.width||f.naturalWidth,this.height=this.height||f.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===d(f))this.video=f,1<f.readyState?(this.width=f.width,this.height=f.height):(this.width=this.width||f.width,this.height=this.height||f.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===d(f))this.xhr=f,this.needsListeners=!0;else if(m(f)){var p=f[0].length,r=f.length,v=1,t,x,w,A;if(Array.isArray(f[0][0]))for(v=f[0][0].length,g=Array(p*r*v),x=A=0;x<r;++x)for(t=0;t<p;++t)for(w=0;w<v;++w)g[A++]=f[x][t][w];
else for(g=Array(p*r),x=A=0;x<r;++x)for(t=0;t<p;++t)g[A++]=f[x][t];this.width=p;this.height=r;this.channels=v;p=!0}else b.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||aa.viewportWidth)|0,this.height=(this.height||aa.viewportHeight)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=
[6409,6410,6407,6408][(this.channels=this.channels||4)-1]);f=this.internalformat;r=this.format=L[f];if(!this.channels)switch(r){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}r=this.type;5126!==r&&36193!==r&&(r||(r=6402===f?5125:5121));this.type=r;if(p)switch(r){case 5121:this.data=new Uint8Array(g);break;case 5123:this.data=new Uint16Array(g);break;case 5125:this.data=new Uint32Array(g);break;
case 5126:this.data=new Float32Array(g);break;case 36193:this.data=u(g)}if(this.data&&this.needsTranspose){g=this.data;f=this.width;p=this.height;r=this.channels;v=this.strideX;t=this.strideY;x=this.strideC;w=this.offset;A=new g.constructor(f*p*r);for(var K=0,H=0;H<p;++H)for(var B=0;B<f;++B)for(var G=0;G<r;++G)A[K++]=g[t*H+v*B+x*G+w];this.data=A}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){c.pixelStorei(37440,
this.flipY);c.pixelStorei(37441,this.premultiplyAlpha);c.pixelStorei(37443,this.colorSpace);c.pixelStorei(3317,this.unpackAlignment);var b=this.target,f=this.miplevel,d=this.image,g=this.canvas,k=this.video,m=this.data,n=this.internalformat,r=this.format,p=this.type,u=this.width||Math.max(1,a.width>>f);a=this.height||Math.max(1,a.height>>f);k&&2<k.readyState?c.texImage2D(b,f,r,r,p,k):d&&d.complete?c.texImage2D(b,f,r,r,p,d):g?c.texImage2D(b,f,r,r,p,g):this.compressed?c.compressedTexImage2D(b,f,n,u,
a,0,m):this.copy?(t(),c.copyTexImage2D(b,f,r,this.x,this.y,u,a,0)):m?c.texImage2D(b,f,r,u,a,0,r,p,m):c.texImage2D(b,f,r,u||1,a||1,0,r,p,null)}});g(W.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=M[a.min]);"mag"in a&&(this.magFilter=ga[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=X[d]:Array.isArray(d)&&(b=X[d[0]],c=X[d[1]])}else"wrapS"in a&&(b=X[a.wrapS]),"wrapT"in a&&(c=X[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=R[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;c.texParameteri(a,10241,this.minFilter);c.texParameteri(a,10240,this.magFilter);c.texParameteri(a,10242,this.wrapS);c.texParameteri(a,10243,this.wrapT);b.ext_texture_filter_anisotropic&&c.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(c.hint(33170,this.mipmapHint),c.generateMipmap(a))}});
var J=0,T=0,S={},Z=[],N=p.maxTextureUnits,O=Array(N).map(function(){return null});g(ea.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<N;++b){var f=O[b];if(f){if(0<f.bindCount)continue;f.unit=-1}O[b]=this;a=b;break}this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture);J=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&fa(this)}});return{create:function(a,b){function c(a,g,h,k,m,n){var r=a||{};34067===b&&
6===arguments.length&&(r=[a,g,h,k,m,n]);V(d,r);c.width=d.params.width;c.height=d.params.height;return c}var d=new ea(b);S[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){K(S).forEach(I);for(var a=0;a<N;++a)O[a]=null;J=0;c.activeTexture(33984)},clear:function(){for(var a=0;a<N;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),O[a]=null;c.activeTexture(33984);J=0;K(S).forEach(fa)},poll:function(){Z.forEach(I)},getTexture:function(a){return null}}}},
{"./util/extend":20,"./util/is-ndarray":21,"./util/is-typed-array":22,"./util/load-texture":23,"./util/parse-dds":25,"./util/to-half-float":27,"./util/values":28}],18:[function(b,p,t){p.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],19:[function(b,p,t){function a(a){return Array.prototype.slice.call(a)}function m(b){return a(b).join("")}var d=b("./extend");p.exports=function(){function b(){var k=[],n=[];return d(function(){k.push.apply(k,
a(arguments))},{def:function(){var b="v"+g++;n.push(b);0<arguments.length&&(k.push(b,"="),k.push.apply(k,a(arguments)),k.push(";"));return b},toString:function(){return m([0<n.length?"var "+n+";":"",m(k)])}})}function n(){function a(b,c){m(b,c,"=",g.def(b,c),";")}var g=b(),m=b(),c=g.toString,n=m.toString;return d(g,{entry:g,exit:m,save:a,set:function(b,c,d){a(b,c);g(b,c,"=",d,";")},toString:function(){return c()+n()}})}var g=0,p=[],t=[],U=b(),z={};return{global:U,link:function(a){for(var b=0;b<t.length;++b)if(t[b]===
a)return p[b];b="g"+g++;p.push(b);t.push(a);return b},block:b,proc:function(a,b){function g(){var a="a"+c.length;c.push(a);return a}var c=[];b=b||0;for(var k=0;k<b;++k)g();var k=n(),p=k.toString;return z[a]=d(k,{arg:g,toString:function(){return m(["function(",c.join(),"){",p(),"}"])}})},scope:n,cond:function(){var b=m(arguments),g=n(),k=n(),c=g.toString,p=k.toString;return d(g,{then:function(){g.apply(g,a(arguments));return this},"else":function(){k.apply(k,a(arguments));return this},toString:function(){var a=
p();a&&(a="else{"+a+"}");return m(["if(",b,"){",c(),"}",a])}})},compile:function(){var a=['"use strict";',U,"return {"];Object.keys(z).forEach(function(b){a.push('"',b,'":',z[b].toString(),",")});a.push("}");var b=m(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,p.concat(b)).apply(null,t)}}}},{"./extend":20}],20:[function(b,p,t){p.exports=function(a,b){for(var d=Object.keys(b),k=0;k<d.length;++k)a[d[k]]=b[d[k]];return a}},{}],21:[function(b,p,t){var a=b("./is-typed-array");
p.exports=function(b){return!!b&&"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":22}],22:[function(b,p,t){var a=b("../constants/arraytypes.json");p.exports=function(b){return Object.prototype.toString.call(b)in a}},{"../constants/arraytypes.json":4}],23:[function(b,p,t){p.exports=function(a,b){if("undefined"!==typeof document){var d;d=(d=/\.(\w+)(\?.*)?$/.exec(a))&&
d[1]?d[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(d))return d=document.createElement("video"),d.autoplay=!0,d.loop=!0,b&&(d.crossOrigin=b),d.src=a,d;if(0<=["dds"].indexOf(d))return d=new XMLHttpRequest,d.responseType="arraybuffer",d.open("GET",a,!0),d.send(),d;d=new Image;b&&(d.crossOrigin=b);d.src=a;return d}return null}},{}],24:[function(b,p,t){p.exports=function(a,b){for(var d=Array(a),k=0;k<a;++k)d[k]=b(k);return d}},
{}],25:[function(b,p,t){p.exports=function(b){function p(a){for(var c=R,d=X,g=0;g<D;++g){var k=Math.max(1,c+3>>2)*Math.max(1,d+3>>2)*P;ca.pixels.push({target:a,miplevel:g,width:c,height:d,data:new Uint8Array(b,Q,k)});Q+=k;c>>=1;d>>=1}}var t=new Int32Array(b),fa=t[G],R=t[B],X=t[aa],ga=y,M=0,P=0,F=4;switch(t[ea]){case r:P=8;fa&u?(F=3,M=d):M=k;break;case A:P=16;M=n;break;case c:P=16;M=g;break;case v:P=8,M=K}var D=1;t[da]&U&&(D=Math.max(1,t[W]));var Q=t[x]+4,ca={width:R,height:X,channels:F,format:M,type:ga,
compressed:!0,cube:!1,pixels:[]};if(t[V]&z)for(ca.cube=!0,t=0;6>t;++t)p(m+t);else p(a);return ca};var a=3553,m=34069,d=33776,k=33777,n=33778,g=33779,K=36196,y=5121,U=131072,z=512,u=64,r=827611204,A=861165636,c=894720068,v=826496069,x=1,G=2,aa=3,B=4,W=7,da=20,ea=21,V=28},{}],26:[function(b,p,t){p.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,
30)},cancel:clearTimeout}},{}],27:[function(b,p,t){p.exports=function(a){for(var b=new Float32Array(a),b=new Uint32Array(b.buffer),d=new Uint16Array(a.length),k=0;k<a.length;++k)if(isNaN(a[k]))d[k]=65535;else if(Infinity===a[k])d[k]=31744;else if(-Infinity===a[k])d[k]=64512;else{var n=b[k],g=n>>>31<<15,p=(n<<1>>>24)-127,n=n>>13&1023;d[k]=-24>p?g:-14>p?g+(n+1024>>-14-p):15<p?g+31744:g+(p+15<<10)+n}return d}},{}],28:[function(b,p,t){p.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},
{}],29:[function(b,p,t){function a(a,b){function g(){var b=window.innerWidth,g=window.innerHeight;a!==document.body&&(g=a.getBoundingClientRect(),b=g.right-g.left,g=g.top-g.bottom);p.width=U*b;p.height=U*g;d(p.style,{width:b+"px",height:g+"px"})}var p=document.createElement("canvas"),t=m(p,b);d(p.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(p);a===document.body&&(p.style.position="absolute",d(a.style,{margin:0,padding:0}));var U=+t.options.pixelRatio;window.addEventListener("resize",
g,!1);var z=t.options.onDestroy;t.options=d(d({},t.options),{onDestroy:function(){window.removeEventListener("resize",g);a.removeChild(p);z&&z()}});g();return t}function m(a,b){function g(b){try{return a.getContext(b,m)}catch(d){return null}}var m=b.glOptions||{};return{gl:g("webgl")||g("experimental-webgl")||g("webgl-experimental"),options:d({pixelRatio:window.devicePixelRatio},b)}}var d=b("./util/extend");p.exports=function(b){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:b[0],
options:b[1]||{}};var n=document.body,g=b[1]||{};if("string"===typeof b[0])n=document.querySelector(b[0])||document.body;else if("object"===typeof b[0])if(b[0]instanceof HTMLElement)n=b[0];else{if(b[0]instanceof WebGLRenderingContext)return{gl:b[0],options:d({pixelRatio:1},g)};g=b[0]}return n.nodeName&&"CANVAS"===n.nodeName.toUpperCase()?m(n,g):a(n,g)}},{"./util/extend":20}],30:[function(b,p,t){var a=b("./lib/util/extend"),m=b("./lib/dynamic"),d=b("./lib/util/raf"),k=b("./lib/util/clock"),n=b("./lib/strings"),
g=b("./lib/webgl"),K=b("./lib/extension"),y=b("./lib/limits"),U=b("./lib/buffer"),z=b("./lib/elements"),u=b("./lib/texture"),r=b("./lib/renderbuffer"),A=b("./lib/framebuffer"),c=b("./lib/attribute"),v=b("./lib/shader"),x=b("./lib/read"),G=b("./lib/core");p.exports=function(){function b(){h=d.next(b);F.count+=1;var a=Z.viewport,c=Z.scissor_box;a[0]=a[1]=c[0]=c[1]=0;F.viewportWidth=F.frameBufferWidth=F.drawingBufferWidth=a[2]=c[2]=w.drawingBufferWidth;F.viewportHeight=F.frameBufferWidth=F.drawingBufferHeight=
a[3]=c[3]=w.drawingBufferHeight;a=k();F.deltaTime=(a-ga)/1E3;F.time=(a-X)/1E3;ga=a;S.procs.refresh();Y.poll();for(a=0;a<O.length;++a)(0,O[a])(F,null,0)}function p(){h&&(d.cancel(b),h=0)}function t(a){p();a.preventDefault();if(H.onContextLost)H.onContextLost()}function da(a){w.getError();fa.refresh();S.procs.refresh();D.refresh();Y.refresh();L.refresh();J.refresh();ca.refresh();if(H.onContextRestored)H.onContextRestored();b()}function ea(b){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var f=
a[c];m.isDynamic(f)?d[c]=m.unbox(f,c):b[c]=f});return{dynamic:d,"static":b}}function d(a){for(;t.length<a;)t.push(null);return t}var g=c(b.context||{}),h=c(b.uniforms||{}),k=c(b.attributes||{});b=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(b));var g=S.compile(b,
k,h,g),n=g.draw,p=g.batch,r=g.scope,t=[];return function(a,b){var c;if("function"===typeof a)return r.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)r.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)r.call(this,a[c],b,c);else return r.call(this,a,b,0);else if("number"===typeof a){if(0<a)return p.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return p.call(this,a,a.length)}else return n.call(this,a)}}function V(){S.procs.poll()}
var I=g(Array.prototype.slice.call(arguments)),w=I.gl,H=I.options,I=n(),fa=K(w),R=fa.extensions,X=k(),ga=X,M=w.drawingBufferWidth,P=w.drawingBufferHeight,F={count:0,deltaTime:0,time:0,viewportWidth:M,viewportHeight:P,framebufferWidth:M,framebufferHeight:P,drawingBufferWidth:M,drawingBufferHeight:P,pixelRatio:H.pixelRatio},M=y(w,R),D=U(w),Q=z(w,R,D),P=c(w,R,M,D,I),ca=v(w,I),Y=u(w,R,M,V,F),L=r(w,R,M),J=A(w,R,M,Y,L),T=x(w,V,F),S=G(w,I,R,M,D,Q,Y,J,{},P,ca,{elements:null,primitive:4,count:-1,offset:0,
instances:-1},F),Z=S.next,N=w.canvas,O=[],h=0;N&&(N.addEventListener("webglcontextlost",t,!1),N.addEventListener("webglcontextrestored",da,!1));S.procs.refresh();return a(ea,{clear:function(a){var b=0;V();var c=a.color;c&&(w.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(w.clearDepth(+a.depth),b|=256);"stencil"in a&&(w.clearStencil(a.stencil|0),b|=1024);w.clear(b)},prop:m.define.bind(null,1),context:m.define.bind(null,2),"this":m.define.bind(null,3),draw:ea({}),elements:function(a){return Q.create(a)},
buffer:function(a){return D.create(a,34962)},texture:function(a){return Y.create(a,3553)},cube:function(a){return 6===arguments.length?Y.create(Array.prototype.slice.call(arguments),34067):Y.create(a,34067)},renderbuffer:function(a){return L.create(a)},framebuffer:function(a){return J.create(a)},framebufferCube:function(a){},attributes:w.getContextAttributes(),frame:function(a){O.push(a);!h&&0<O.length&&b();return{cancel:function(){var b=O.find(function(b){return b===a});0>b||(O.splice(b,1),0>=O.length&&
p())}}},limits:M,read:T,destroy:function(){p();N&&(N.removeEventListener("webglcontextlost",t),N.removeEventListener("webglcontextrestored",da));ca.clear();J.clear();L.clear();Y.clear();D.clear();if(H.onDestroy)H.onDestroy()},_gl:w,_refresh:function(){S.procs.refresh()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":7,"./lib/dynamic":8,"./lib/elements":9,"./lib/extension":10,"./lib/framebuffer":11,"./lib/limits":12,"./lib/read":13,"./lib/renderbuffer":14,"./lib/shader":15,"./lib/strings":16,
"./lib/texture":17,"./lib/util/clock":18,"./lib/util/extend":20,"./lib/util/raf":26,"./lib/webgl":29}]},{},[1]);
