(function e$$0(e,l,d){function q(a,f){if(!l[a]){if(!e[a]){var u="function"==typeof require&&require;if(!f&&u)return u(a,!0);if(b)return b(a,!0);u=Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u;}u=l[a]={exports:{}};e[a][0].call(u.exports,function(b){var d=e[a][1][b];return q(d?d:b)},u,u.exports,e$$0,e,l,d)}return l[a].exports}for(var b="function"==typeof require&&require,a=0;a<d.length;a++)q(d[a]);return q})({1:[function(c,e,l){c=c("../regl")();var d=c({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform float tick;\n  varying vec2 uv;\n  void main () {\n    mat3 m = mat3(\n      cos(tick), sin(tick), -1.1 + cos(tick),\n      -sin(tick), cos(tick), 0,\n      0, 0, 1);\n    vec3 p = m * vec3(uv, 1);\n    gl_FragColor = texture2D(texture, p.xy / p.z);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n  }",attributes:{position:c.buffer([-2,0,0,-2,2,2])},uniforms:{tick:function(d,b,a){return.005*a.count},texture:c.texture({min:"nearest mipmap linear",mag:"nearest",wrap:"repeat",data:[[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[255,255,255,255,0,0,0,0],[0,0,0,0,255,255,255,255],[0,0,0,0,255,
255,255,255],[0,0,0,0,255,255,255,255],[0,0,0,0,255,255,255,255]]})},count:3});c.frame(function(){d()})},{"../regl":33}],2:[function(c,e,l){function d(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}var q=c("./constants/dtypes.json"),b=c("./extend");b(d.prototype,{equals:function(a,b){return this.pointer?a.pointer&&this.buffer===a.buffer&&this.size===b&&this.normalized===a.normalized&&this.type===
a.type&&this.offset===a.offset&&this.stride===a.stride&&this.divisor===a.divisor:!a.pointer&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w},set:function(a,b){(this.pointer=a.pointer)?(this.buffer=a.buffer,this.size=b,this.normalized=a.normalized,this.type=a.type,this.offset=a.offset,this.stride=a.stride,this.divisor=a.divisor):(this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w)}});e.exports=function(a,c,f,u,m){function e(){for(var a=Array(16),b=0;16>b;++b)a[b]=new d;this.records=a;this.top=0}function z(a){for(var b=
a.records,h=a.top;b.length-1<=h;)b.push(new d);return b[++a.top]}var C={};f=f.maxAttributes;for(var h=Array(f),w=0;w<f;++w)h[w]=new d;b(e.prototype,{pushVec:function(a,b,d,h){var m=z(this);m.pointer=!1;m.x=a;m.y=b;m.z=d;m.w=h},pushPtr:function(a,b,d,h,m,q,f){var c=z(this);c.pointer=!0;c.buffer=a;c.size=b;c.offset=d;c.stride=h;c.divisor=m;c.normalized=q;c.type=f},pushDyn:function(a){if("number"===typeof a)this.pushVec(a,0,0,0);else if(Array.isArray(a))this.pushVec(a[0],a[1],a[2],a[3]);else{var b=u.getBuffer(a),
d=0,h=0,m=0,c=0,f=!1,w=5126;b?w=b.dtype:(b=u.getBuffer(a.buffer),d=a.size||0,h=a.stride||0,m=a.offset||0,c=a.divisor||0,f=a.normalized||!1,w=b.dtype,"type"in a&&(w=q[a.type]));this.pushPtr(b,d,m,h,c,f,w)}},pop:function(){--this.top}});return{bindings:h,bind:function(b,d,h,m){m=h.size||m;if(!d.equals(h,m)){if(h.pointer){d.pointer||a.enableVertexAttribArray(b);d.buffer!==h.buffer&&h.buffer.bind();a.vertexAttribPointer(b,m,h.type,h.normalized,h.stride,h.offset);var q=c.angle_instanced_arrays;q&&q.vertexAttribDivisorANGLE(b,
h.divisor)}else d.pointer&&a.disableVertexAttribArray(b),a.vertexAttrib4f(b,h.x,h.y,h.z,h.w);d.set(h,m)}},def:function(a){a=m.id(a);var b=C[a];b||(b=C[a]=new e);return b}}}},{"./constants/dtypes.json":8,"./extend":14}],3:[function(c,e,l){function d(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);case 5122:return new Int16Array(b);case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);
default:return null}}var q=c("./is-typed-array"),b=c("./is-ndarray"),a=c("./constants/arraytypes.json"),I=c("./constants/dtypes.json"),f=c("./values"),u={"static":35044,dynamic:35048,stream:35040};e.exports=function(m){function c(a,b){this.id=h++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function e(a){m.isBuffer(a.buffer)||(a.buffer=m.createBuffer());a.bind();m.bufferData(a.type,a.data||a.byteLength,a.usage)}function C(a){var b=a.buffer;
m.isBuffer(b)&&m.deleteBuffer(b);a.buffer=null;delete w[a.id]}var h=0,w={};c.prototype.bind=function(){m.bindBuffer(this.type,this.buffer)};return{create:function(h,f,T){function t(h){var g=h||{};if(Array.isArray(g)||q(g)||b(g))g={data:g};else if("number"===typeof g)g={length:g|0};else if(null===g||void 0===g)g={};l.usage="usage"in g?u[g.usage]:35044;h=0;"type"in g&&(h=I[g.type]);var m=g.dimension|0||1,c=0,f=null;if("data"in g)if(f=g.data,null===f)c=g.length|0;else{if(b(f)){var m=f.shape,c=f.stride,
g=f.offset,K=0,w=0,T=0,p=0;1===m.length?(K=m[0],w=1,T=c[0],p=0):2===m.length&&(K=m[0],w=m[1],T=c[0],p=c[1]);h=h||a[Object.prototype.toString.call(f)]|0||5126;for(var m=w,c=d(h,K*w),f=f.data,E=0,la=0;la<K;++la)for(var Q=0;Q<w;++Q)c[E++]=f[T*la+p*Q+g];f=c}else if(Array.isArray(f))if(0<f.length&&Array.isArray(f[0])){m=f[0].length;h=h||5126;g=d(h,f.length*m);c=f;f=m;for(K=p=0;K<c.length;++K)for(T=c[K],w=0;w<f;++w)g[p++]=T[w];f=g}else h=h||5126,f=d(h,f);else h=h||a[Object.prototype.toString.call(f)]|0;
c=f.byteLength}else"length"in g&&(c=g.length|0);l.data=f;l.dtype=h||5121;l.byteLength=c;l.dimension=m;e(l);return t}var O=m.createBuffer(),l=new c(O,f);w[l.id]=l;T||t(h);t._reglType="buffer";t._buffer=l;t.destroy=function(){C(l)};return t},clear:function(){f(w).forEach(C)},refresh:function(){f(w).forEach(e)},getBuffer:function(a){return a&&a._buffer instanceof c?a._buffer:null}}}},{"./constants/arraytypes.json":7,"./constants/dtypes.json":8,"./is-ndarray":17,"./is-typed-array":18,"./values":32}],
4:[function(c,e,l){e.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],5:[function(c,e,l){var d=c("./extend");e.exports=function(){function c(){var a=[],m=[];return d(function(){a.push.apply(a,Array.prototype.slice.call(arguments))},{def:function(){var d="v"+b++;m.push(d);0<arguments.length&&(a.push(d,"="),a.push.apply(a,Array.prototype.slice.call(arguments)),a.push(";"));return d},toString:function(){return[0<m.length?
"var "+m+";":"",a.join("")].join("")}})}var b=0,a=[],e=[],f={};return{link:function(d){var m="g"+b++;a.push(m);e.push(d);return m},block:c,proc:function(a){var m=[],e=c(),I=e.toString;return f[a]=d(e,{arg:function(){var a="a"+b++;m.push(a);return a},toString:function(){return["function(",m.join(),"){",I(),"}"].join("")}})},compile:function(){var b=['"use strict";return {'];Object.keys(f).forEach(function(a){b.push('"',a,'":',f[a].toString(),",")});b.push("}");return Function.apply(null,a.concat([b.join("")])).apply(null,
e)}}}},{"./extend":14}],6:[function(c,e,l){function d(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function q(a,b,d,g){var m,f=",";switch(b){case 5126:m="1f";break;case 35664:m="2fv";break;case 35665:m="3fv";break;case 35666:m="4fv";break;case 35670:case 5124:m="1i";break;case 35671:case 35667:m="2iv";break;case 35672:case 35668:m="3iv";break;case 35673:case 35669:m="4iv";break;case 35674:m=
"Matrix2fv";f=",false,";break;case 35675:m="Matrix3fv";f=",false,";break;case 35676:m="Matrix4fv",f=",false,"}return a+".uniform"+m+"("+d+f+g+");"}function b(a){return a+"["+a+".length-1]"}function a(a,b){return"framebuffer"===a||a<b?-1:a>b?1:0}var I=c("./codegen"),f=c("./constants/primitives.json"),u=c("./constants/dtypes.json"),m={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,
"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},aa={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},z={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};e.exports=function(c,h,w,g,e,T,t,l,P,J,U,ea,V,ga,ha){function N(h,
g,e,R,K){function E(a){var D=qa[a];return D?D:D=qa[a]=r(L[a])}function u(a){var D=a.id,v=M[D];if(v)return v;v=a.func?k.def(r(a.data),"(",P,",",G,",",ja,")"):k.def(P,".",a.data);return M[D]=v}function t(a,D){return a.find(function(a){return a.name===D})}function Y(a){return N&&!(a in g||a in K)}var W=I(),r=W.link,k=W.proc("batch"),x=W.block(),y=k.def,ba=k.arg,n=r(c),S=r(h.program),Z=r(U.bind),ja=r(ga),oa=r(l),H=r(V.count),ca=r(V.offset),ta=r(V.instances),ka=r(V.primitive),qa={},da=r(T.elements),H=
y(b(H)),ca=y(b(ca)),ka=y(b(ka)),da=y(b(da)),A,F,ma=w.angle_instanced_arrays;ma&&(A=y(b(ta)),F=r(ma));var N="elements"in g,ta=ba(),ba=ba(),P=y(),G=y(),M={};k(n,".useProgram(",S,");");h.uniforms.forEach(function(a){if(!(a.name in e)){var D=r(a.location),v=r(J.def(a.name)),v=v+"["+v+".length-1]";a=a.info.type;35678===a||35680===a?(a=y(v+"._texture"),k(q(n,5124,D,a+".bind()")),x(a,".unbind();")):k(q(n,a,D,v))}});h.attributes.forEach(function(a){if(!(R.name in R)){var D=r(U.def(a.name));k(Z,"(",a.location,
",",r(U.bindings[a.location]),",",D,".records[",D,".top]",",",d(a.info.type),");")}});N||k("if(",da,"){",n,".bindBuffer(",34963,",",da,".buffer.buffer);","}else{",n,".bindBuffer(",34963,",null);","}");k("for(",G,"=0;",G,"<",ta,";++",G,"){",P,"=",ba,"[",G,"];");Object.keys(g).sort(a).forEach(function(a){function D(a){k("if(",v,"){",n,".enable(",a,");}else{",n,".disable(",a,");}")}var v=u(g[a]);switch(a){case "framebuffer":a=E("viewport");var b=E("scissor.box");k("if(",oa,".push(",v,"&&",v,"._framebuffer)){",
oa,".poll();",a,".setDirty();",b,".setDirty();","}");break;case "cull.enable":D(2884);break;case "blend.enable":D(3042);break;case "dither":D(3024);break;case "stencil.enable":D(2960);break;case "depth.enable":D(2929);break;case "scissor.enable":D(3089);break;case "polygonOffset.enable":D(32823);break;case "sample.alpha":D(32926);break;case "sample.enable":D(32928);break;case "depth.mask":k(n,".depthMask(",v,");");break;case "depth.func":a=r(aa);k(n,".depthFunc(",a,"[",v,"]);");break;case "depth.range":k(n,
".depthRange(",v,"[0],",v,"[1]);");break;case "blend.color":k(n,".blendColor(",v,"[0],",v,"[1],",v,"[2],",v,"[3]);");break;case "blend.equation":a=r(p);k("if(typeof ",v,'==="string"){',n,".blendEquation(",a,"[",v,"]);","}else{",n,".blendEquationSeparate(",a,"[",v,".rgb],",a,"[",v,".alpha]);","}");break;case "blend.func":a=r(m);k(n,".blendFuncSeparate(",a,'["srcRGB" in ',v,"?",v,".srcRGB:",v,".src],",a,'["dstRGB" in ',v,"?",v,".dstRGB:",v,".dst],",a,'["srcAlpha" in ',v,"?",v,".srcAlpha:",v,".src],",
a,'["dstAlpha" in ',v,"?",v,".dstAlpha:",v,".dst]);");break;case "stencil.mask":k(n,".stencilMask(",v,");");break;case "stencil.func":a=r(aa);k(n,".stencilFunc(",a,"[",v,'.cmp||"always"],',v,".ref|0,",'"mask" in ',v,"?",v,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":b=r(z);k(n,".stencilOpSeparate(","stencil.opFront"===a?1028:1029,",",b,"[",v,'.fail||"keep"],',b,"[",v,'.zfail||"keep"],',b,"[",v,'.pass||"keep"]);');break;case "polygonOffset.offset":k(n,".polygonOffset(",v,".factor||0,",
v,".units||0);");break;case "cull.face":k(n,".cullFace(",v,'==="front"?',1028,":",1029,");");break;case "lineWidth":k(n,".lineWidth(",v,");");break;case "frontFace":k(n,".frontFace(",v,'==="cw"?',2304,":",2305,");");break;case "colorMask":k(n,".colorMask(",v,"[0],",v,"[1],",v,"[2],",v,"[3]);");break;case "sample.coverage":k(n,".sampleCoverage(",v,".value,",v,".invert);");break;case "scissor.box":case "viewport":a=E(a),k(a,".push(",v,".x||0,",v,".y||0,",v,".w||-1,",v,".h||-1);")}});("viewport"in g||
"framebuffer"in g)&&k(E("viewport"),".poll();");("scissor.box"in g||"framebuffer"in g)&&k(E("scissor.box"),".poll();");"framebuffer"in g&&k(oa,".pop();");var ea=h.uniforms,ha=[];Object.keys(e).forEach(function(a){var D=t(ea,a);if(D){var v=D.info.type,b=r(D.location);a=u(e[a]);35678===D.info.type||35680===D.info.type?(D=y(a+"._texture"),ha.push(D),k(q(n,5124,b,D+".bind()"))):k(q(n,v,b,a))}});ha.forEach(function(a){k(a,".unbind();")});var ua=h.attributes;Object.keys(R).forEach(function(a){var D=t(ua,
a);D&&k(Z,"(",D.location,",",r(a.bindings[D.location]),",",u(R[a]),",",d(D.info.type),");")});g.count?k(H,"=",u(g.count),";"):Y("count")||k("if(",H,"){");g.offset&&k(ca,"=",u(g.offset),";");g.primitive&&(h=r(f),k(ka,"=",h,"[",u(g.primitive),"];"));N&&(h=u(g.elements),k(da,"=",h,"?",h,"._elements:null;"));Y("offset")&&k(ca,"=0;");k("if(",da,"){");Y("count")&&k(H,"=",da,".vertCount;","if(",H,">0){");Y("primitive")&&k(ka,"=",da,".primType;");N&&k(n,".bindBuffer(",34963,",",da,".buffer.buffer);");ma&&
(g.instances&&k(A,"=",u(g.instances),";"),k("if(",A,">0){",F,".drawElementsInstancedANGLE(",ka,",",H,",",da,".type,",ca,",",A,");}else{"));k(n,".drawElements(",ka,",",H,",",da,".type,",ca,");");ma&&k("}");Y("count")&&k("}");k("}else{");Y("count")||(Y("primitive")&&k(ka,"=",4,";"),ma&&k("if(",A,">0){",F,".drawArraysInstancedANGLE(",ka,",",ca,",",H,",",A,");}else{"),k(n,".drawArrays(",ka,",",ca,",",H,");}"),ma&&k("}"));k("}}",x);return W.compile().batch}var L=P.contextState,p={add:32774,subtract:32778,
"reverse subtract":32779};w.ext_blend_minmax&&(p.min=32775,p.max=32776);var E=0;return{draw:function(a){var h=I(),g=h.link,m=h.proc("draw"),f=m.def,p=g(c),e=g(a.program),K=g(U.bind),u=g(V.count),E=g(V.offset),r=g(V.instances),k=g(V.primitive),t=g(T.elements),l=[];m(p,".useProgram(",e,");");a.attributes.forEach(function(a){var b=g(U.def(a.name));m(K,"(",a.location,",",g(U.bindings[a.location]),",",b,".records[",b,".top]",",",d(a.info.type),");")});a.uniforms.forEach(function(a){var b=g(a.location),
h=g(J.def(a.name)),h=h+"["+h+".length-1]";a=a.info.type;35678===a||35680===a?(a=f(h+"._texture"),l.push(a),m(q(p,5124,b,a+".bind()"))):m(q(p,a,b,h))});l.forEach(function(a){m(a,".unbind();")});a=f(b(k));u=f(b(u));E=f(b(E));t=f(b(t));m("if(",u,"){");(e=w.angle_instanced_arrays)?(r=f(b(r)),e=g(e),m("if(",t,"){",t,".bind();","if(",r,">0){",e,".drawElementsInstancedANGLE(",a,",",u,",",t,".type,",E,",",r,");}else{",p,".drawElements(",a,",",u,",",t,".type,",E,");}","}else if(",r,">0){",e,".drawArraysInstancedANGLE(",
a,",",E,",",u,",",r,");}else{",p,".drawArrays(",a,",",E,",",u,");}}")):m("if(",t,"){",p,".drawElements(",a,",",u,",",t,".type,",E,");}","}else{",p,".drawArrays(",a,",",E,",",u,");}");return h.compile().draw},command:function(g,d,c,q,w,t,C){function B(a){var b=da[a];return b?b:b=da[a]=k(L[a])}function Y(a,b){var n=B(a);A(n,".push(",b,");");F(n,".pop();")}function W(a){var b=a.id,n=ua[b];if(n)return n;n=a.func?G.def(k(a.data),"(",sa,",0,",wa,")"):G.def(sa,".",a.data);return ua[b]=n}var r=I(),k=r.link,
x=r.block,y=r.proc,P=E++,n=k(ha);k(h);var S=k(ea.fragShaders),Z=k(ea.vertShaders),ja=k(ea.programs),oa=k(l),H={count:k(V.count),offset:k(V.offset),instances:k(V.instances),primitive:k(V.primitive)},ca=k(T.elements),ta=k(f),ka=k(aa),qa=k(z),da={},A=x(),F=x(),ma=!1;Object.keys(g).sort(a).forEach(function(a){var b=g[a];switch(a){case "frag":ma=!0;A(S,".push(",k(h.id(b)),");");F(S,".pop();");break;case "vert":ma=!0;A(Z,".push(",k(h.id(b)),");");F(Z,".pop();");break;case "framebuffer":l.getFramebuffer(b);
a=B("viewport");var n=B("scissor.box");A("if(",oa,".push(",k(b&&b._framebuffer),")){",a,".setDirty();",n,".setDirty();","}");F("if(",oa,".pop()){",a,".setDirty();",n,".setDirty();","}");break;case "count":case "offset":case "instances":A(H[a],".push(",b,");");F(H[a],".pop();");break;case "primitive":A(H.primitive,".push(",f[b],");");F(H.primitive,".pop();");break;case "elements":n=T.getElements(b);b=!("primitive"in g);a=!("count"in g);n?(n=k(n),A(ca,".push(",n,");"),b&&A(H.primitive,".push(",n,".primType);"),
a&&A(H.count,".push(",n,".vertCount);")):(A(ca,".push(null);"),b&&A(H.primitive,".push(",4,");"),a&&A(H.count,".push(0);"));b&&F(H.primitive,".pop();");a&&F(H.count,".pop();");"offset"in g||(A(H.offset,".push(0);"),F(H.offset,".pop();"));F(ca,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":Y(a,b);break;case "depth.func":Y(a,aa[b]);
break;case "depth.range":a=B(a);A(a,".push(",b[0],",",b[1],");");F(a,".pop();");break;case "blend.func":a=B(a);A(a,".push(",m["srcRGB"in b?b.srcRGB:b.src],",",m["dstRGB"in b?b.dstRGB:b.dst],",",m["srcAlpha"in b?b.srcAlpha:b.src],",",m["dstAlpha"in b?b.dstAlpha:b.dst],");");F(a,".pop();");break;case "blend.equation":a=B(a);"string"===typeof b?A(a,".push(",p[b],",",p[b],");"):"object"===typeof b&&A(a,".push(",p[b.rgb],",",p[b.alpha],");");F(a,".pop();");break;case "blend.color":a=B(a);A(a,".push(",
b[0],",",b[1],",",b[2],",",b[3],");");F(a,".pop();");break;case "stencil.mask":a=B(a);A(a,".push(",b,");");F(a,".pop();");break;case "stencil.func":var n=b.cmp||"keep",d=b.ref||0,b="mask"in b?b.mask:-1;a=B(a);A(a,".push(",aa[n],",",d,",",b,");");F(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":n=b.fail||"keep";d=b.zfail||"keep";b=b.pass||"keep";a=B(a);A(a,".push(",z[n],",",z[d],",",z[b],");");F(a,".pop();");break;case "polygonOffset.offset":n=b.factor||0;b=b.units||0;a=B(a);A(a,".push(",
n,",",b,");");F(a,".pop();");break;case "cull.face":n=0;"front"===b?n=1028:"back"===b&&(n=1029);b=B(a);A(b,".push(",n,");");F(b,".pop();");break;case "lineWidth":Y(a,b);break;case "frontFace":n=0;"cw"===b?n=2304:"ccw"===b&&(n=2305);b=B(a);A(b,".push(",n,");");F(b,".pop();");break;case "colorMask":a=B(a);A(a,".push(",b.map(function(a){return!!a}).join(),");");F(a,".pop();");break;case "sample.coverage":n="value"in b?b.value:1;b=!!b.invert;a=B(a);A(a,".push(",n,",",b,");");F(a,".pop();");break;case "viewport":case "scissor.box":var n=
b.x||0,d=b.y||0,c=-1,q=-1;"w"in b&&(c=b.w);"h"in b&&(q=b.h);b=B(a);A(b,".push(",n,",",d,",",c,",",q,");");F(b,".pop();")}});if(ma){if(g.frag&&g.vert)x=g.frag,A(ja,".push(",k(ea.create(h.id(g.vert),h.id(x))),");");else{var x=A.def(S,"[",S,".length-1]"),ra=A.def(Z,"[",Z,".length-1]"),va=k(ea.create);A(ja,".push(",va,"(",ra,",",x,"));")}F(ja,".pop();")}Object.keys(d).forEach(function(a){var b=k(J.def(a));a=d[a];a="function"===typeof a&&a._reglType?k(a):Array.isArray(a)?k(a.slice()):+a;A(b,".push(",a,
");");F(b,".pop();")});Object.keys(c).forEach(function(a){var b=k(U.def(a));a=c[a];if("number"===typeof a)A(b,".pushVec(",+a,",0,0,0);");else if(Array.isArray(a))A(b,".pushVec(",[a[0]||0,a[1]||0,a[2]||0,a[3]||0],");");else{var n=e.getBuffer(a),g=0,h=0,d=0,m=0,Z=!1,f=5126;n?f=n.dtype:(n=e.getBuffer(a.buffer),g=a.size||0,h=a.stride||0,d=a.offset||0,m=a.divisor||0,Z=a.normalized||!1,f=n.dtype,"type"in a&&(f=u[a.type]));A(b,".pushPtr(",[k(n),g,d,h,m,Z,f].join(),");")}F(b,".pop();")});var G=r.block(),
M=r.block(),wa,sa;C&&(wa=k(ga),sa=A.def());var ua={};Object.keys(q).sort(a).forEach(function(a){var b=W(q[a]);switch(a){case "framebuffer":a=B("viewport");var n=B("scissor.box");G("if(",oa,".push(",b,"&&",b,"._framebuffer)){",a,".setDirty();",n,".setDirty();","}");M("if(",oa,".pop()){",a,".setDirty();",n,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":a=
B(a);G(a,".push(",b,");");M(a,".pop();");break;case "count":case "offset":case "instances":a=H[a];G(a,".push(",b,");");M(a,".pop();");break;case "primitive":a=H.primitive;G(a,".push(",ta,"[",b,"]);");M(a,".pop();");break;case "depth.func":a=B(a);G(a,".push(",ka,"[",b,"]);");M(a,".pop();");break;case "blend.func":a=B(a);n=k(m);G(a,".push(",n,'["srcRGB" in ',b,"?",b,".srcRGB:",b,".src],",n,'["dstRGB" in ',b,"?",b,".dstRGB:",b,".dst],",n,'["srcAlpha" in ',b,"?",b,".srcAlpha:",b,".src],",n,'["dstAlpha" in ',
b,"?",b,".dstAlpha:",b,".dst]);");M(a,".pop();");break;case "blend.equation":a=B(a);n=k(p);G("if(typeof ",b,'==="string"){',a,".push(",n,"[",b,"],",n,"[",b,"]);","}else{",a,".push(",n,"[",b,".rgb],",n,"[",b,".alpha]);","}");M(a,".pop();");break;case "blend.color":a=B(a);G(a,".push(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");M(a,".pop();");break;case "stencil.mask":a=B(a);G(a,".push(",b,");");M(a,".pop();");break;case "stencil.func":a=B(a);G(a,".push(",ka,"[",b,".cmp],",b,".ref|0,",'"mask" in ',b,"?",
b,".mask:-1);");M(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":a=B(a);G(a,".push(",qa,"[",b,'.fail||"keep"],',qa,"[",b,'.zfail||"keep"],',qa,"[",b,'.pass||"keep"]);');M(a,".pop();");break;case "polygonOffset.offset":a=B(a);G(a,".push(",b,".factor||0,",b,".units||0);");M(a,".pop();");break;case "cull.face":a=B(a);G(a,".push(",b,'==="front"?',1028,":",1029,");");M(a,".pop();");break;case "frontFace":a=B(a);G(a,".push(",b,'==="cw"?',2304,":",2305,");");M(a,".pop();");break;case "colorMask":a=
B(a);G(a,".push(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");M(a,".pop();");break;case "sample.coverage":a=B(a);G(a,".push(",b,".value,",b,".invert);");M(a,".pop();");break;case "scissor.box":case "viewport":a=B(a);G(a,".push(",b,".x||0,",b,".y||0,",'"w" in ',b,"?",b,".w:-1,",'"h" in ',b,"?",b,".h:-1);");M(a,".pop();");break;case "elements":a=!("primitive"in q)&&!("primitive"in g);var n=!("count"in q)&&!("count"in g),h=!("offset"in q)&&!("offset"in g),d=G.def();G("if(",b,"){",d,"=",b,"._elements;",ca,
".push(",d,");",a?H.primitive+".push("+d+".primType);":"",n?H.count+".push("+d+".vertCount);":"",h?H.offset+".push("+d+".offset);":"","}else{",ca,".push(null);","}");M(ca,".pop();","if(",b,"){",a?H.primitive+".pop();":"",n?H.count+".pop();":"",h?H.offset+".pop();":"","}")}});Object.keys(w).forEach(function(a){var b=k(J.def(a));a=W(w[a]);G(b,".push(",a,");");M(b,".pop();")});Object.keys(t).forEach(function(a){var b=k(U.def(a));a=W(t[a]);G(b,".pushDyn(",a,");");M(b,".pop();")});x=y("scope");ra=x.arg();
va=x.arg();x(A);C&&x(sa,"=",ra,";",G);x(va,"();",C?M:"",F);x=y("draw");x(A);C&&x(sa,"=",x.arg(),";",G);ra=b(ja);x(n,"();","if(",ra,")",ra,".draw(",C?sa:"",");",C?M:"",F);var pa=y("batch");pa(A);C=pa.def(b(ja));y=k(function(a,b,n){var h=a.batchCache[P];h||(h=a.batchCache[P]=N(a,q,w,t,g));return h(b,n)});pa("if(",C,"){",n,"();",y,"(",C,",",pa.arg(),",",pa.arg(),");");Object.keys(q).forEach(function(a){(a=da[a])&&pa(a,".setDirty();")});pa("}",F);return r.compile()}}}},{"./codegen":5,"./constants/dtypes.json":8,
"./constants/primitives.json":9}],7:[function(c,e,l){e.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],8:[function(c,e,l){e.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],9:[function(c,e,l){e.exports={points:0,
lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],10:[function(c,e,l){function d(a,d){function f(){var d=window.innerWidth,h=window.innerHeight;a!==document.body&&(h=a.getBoundingClientRect(),d=h.right-h.left,h=h.top-h.bottom);c.width=e*d;c.height=e*h;b(c.style,{width:d+"px",height:h+"px"})}var c=document.createElement("canvas"),m=q(c,d);b(c.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(c);a===document.body&&(c.style.position="absolute",b(a.style,
{margin:0,padding:0}));var e=+m.options.pixelRatio;window.addEventListener("resize",f,!1);var l=m.options.onDestroy;m.options=b(b({},m.options),{onDestroy:function(){window.removeEventListener("resize",f);a.removeChild(c);l&&l()}});f();return m}function q(a,d){function f(b){try{return a.getContext(b,c)}catch(d){return null}}var c=d.glOptions||{};return{gl:f("webgl")||f("experimental-webgl")||f("webgl-experimental"),options:b({pixelRatio:window.devicePixelRatio},d)}}var b=c("./extend");e.exports=function(a){if("undefined"===
typeof document||"undefined"===typeof HTMLElement)return{gl:a[0],options:a[1]||{}};var c=document.body,f=a[1]||{};if("string"===typeof a[0])c=document.querySelector(a[0])||document.body;else if("object"===typeof a[0])if(a[0]instanceof HTMLElement)c=a[0];else{if(a[0]instanceof WebGLRenderingContext)return{gl:a[0],options:b({pixelRatio:1},f)};f=a[0]}return c.nodeName&&"CANVAS"===c.nodeName.toUpperCase()?q(c,f):d(c,f)}},{"./extend":14}],11:[function(c,e,l){e.exports=function(d){return{primitive:[4],
count:[0],offset:[0],instances:[0]}}},{}],12:[function(c,e,l){function d(a,d){this.id=b++;this.func=a;this.data=d}function q(a,b){switch(typeof a){case "boolean":case "number":case "string":return new d(!1,a);case "function":return new d(!0,a);default:return q}}var b=0;e.exports={define:q,isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof d},unbox:function(a,b){return a instanceof d?a:"function"===typeof a&&a!==q?new d(!0,a):new d(!1,b)}}},{}],13:[function(c,e,l){var d=
c("./is-typed-array"),q=c("./is-ndarray"),b=c("./constants/primitives.json");e.exports=function(a,c,f){function e(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}e.prototype.bind=function(){this.buffer.bind()};return{create:function(a){function l(a){var m=c.oes_element_index_uint;if(a)if("number"===typeof a)C(a);else{var g=null,f="static",e=0;Array.isArray(a)||d(a)||q(a)?g=a:("data"in a&&(g=a.data),"usage"in a&&(f=a.usage),"length"in a&&(e=a.length));Array.isArray(g)||q(g)&&"array"===
g.dtype||"type"in a?C({type:a.type||(m?"uint32":"uint16"),usage:f,data:g,length:e}):C({usage:f,data:g,length:e});if(Array.isArray(g)||d(g))C.dimension=3}else C();m=z.buffer.byteLength;g=0;switch(z.buffer.dtype){case 5121:case 5120:g=5121;break;case 5123:case 5122:g=5123;m>>=1;break;case 5125:case 5124:g=5125,m>>=2}f=4;e=z.buffer.dimension;1===e&&(f=0);2===e&&(f=1);3===e&&(f=4);"object"===typeof a&&("primitive"in a&&(f=b[a.primitive]),"count"in a&&(m=a.vertCount|0));z.primType=f;z.vertCount=m;z.type=
g;return l}var z=new e,C=f.create(null,34963,!0);z.buffer=C._buffer;l(a);l._reglType="elements";l._elements=z;l.destroy=function(){C.destroy();z.buffer=null};return l},elements:[null],getElements:function(a){return a&&a._elements instanceof e?a._elements:null}}}},{"./constants/primitives.json":9,"./is-ndarray":17,"./is-typed-array":18}],14:[function(c,e,l){e.exports=function(d,c){for(var b=Object.keys(c),a=0;a<b.length;++a)d[b[a]]=c[b[a]];return d}},{}],15:[function(c,e,l){e.exports=function(d){function c(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{b[a]=
d.getExtension(a)}catch(c){}})}var b={};c();return{extensions:b,refresh:c}}},{}],16:[function(c,e,l){var d=c("./values"),q=c("./extend"),b=[1029];e.exports=function(a,c,f,e,m){function l(a,b,g,d){this.target=a;this.level=b;this.texture=g;this.renderbuffer=d}function z(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function C(a,b){var g=b.width,d=b.height;if(a.texture)var c=a.texture._texture,h=Math.max(1,c.params.width>>a.level),m=Math.max(1,c.params.height>>
a.level),g=g||h,d=d||m;else c=a.renderbuffer._renderbuffer,g=g||c.width,d=d||c.height;c.refCount+=1;b.width=g;b.height=d}function h(b,g){g?g.texture?a.framebufferTexture2D(36160,b,g.target,g.texture._texture.texture,g.level):a.framebufferRenderbuffer(36160,b,36161,g.renderbuffer._renderbuffer.renderbuffer):a.framebufferTexture2D(36160,b,3553,null,0)}function w(a){var b=3553,g=0,d=null,c=null;"object"===typeof a&&("level"in a&&(g=a.level|0),"target"in a&&(b=a.target|0));var h=a._reglType;"texture"===
h?d=a:"renderbuffer"===h&&(c=a,b=36161,g=0);return new l(b,g,d,c)}function g(a){return a&&(a.texture||a.renderbuffer)}function K(){this.id=ga++;ha[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function T(b){a.isFramebuffer(b.framebuffer)||(b.framebuffer=a.createFramebuffer());L=!0;a.bindFramebuffer(36160,b.framebuffer);for(var g=b.colorAttachments,
d=0;d<g.length;++d)h(36064+d,g[d]);for(d=g.length;d<f.maxColorAttachments;++d)h(36064+d,null);h(36096,b.depthAttachment);h(36128,b.stencilAttachment);h(33306,b.depthStencilAttachment);c.webgl_draw_buffers&&c.webgl_draw_buffers.drawBuffersWEBGL(V[g.length]);a.checkFramebufferStatus(36160)}function t(b){b=b.framebuffer;a.isFramebuffer(b)&&a.deleteFramebuffer(b)}function O(){return N[N.length-1]}var P={rgba:6408},J={rgba4:32854,rgb565:36194,"rgb5 a1":32855};c.ext_srgb&&(J.srgba=35907);c.ext_color_buffer_half_float&&
(J.rgba16f=34842,J.rgb16f=34843);c.webgl_color_buffer_float&&(J.rgba32f=34836);var U=[],ea=[];c.webgl_depth_texture&&(U.push(6402),ea.push(34041));q(q({},P),J);d(P);d(J);J=5121;U={uint8:5121};c.oes_texture_half_float&&(J=U["half float"]=36193);c.oes_texture_float&&(J=U["float"]=5126);U.best=J;var V=function(){for(var a=Array(f.maxDrawbuffers),b=0;b<=f.maxDrawbuffers;++b)for(var g=a[b]=Array(b),d=0;d<b;++d)g[d]=36064+d;return a}(),ga=0,ha={},N=[null],L=!0;return{top:O,dirty:function(){return L},push:function(a){a=
a||null;L=L||a!==O();N.push(a);return L},pop:function(){var a=O();N.pop();return L=L||a!==O()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof K)?a:null},poll:function(){if(L){var g=N[N.length-1],d=c.webgl_draw_buffers;g?(a.bindFramebuffer(36160,g.framebuffer),d&&d.drawBuffersWEBGL(V[g.colorAttachments.length])):(a.bindFramebuffer(36160,null),d&&d.drawBuffersWEBGL(b));L=!1}},create:function(b){function d(b){var h,f=b||{},q=b=0;if("shape"in
f){var K=f.shape;b=K[0];q=K[1]}else"radius"in f&&(b=q=f.radius),"width"in f&&(b=f.width),"height"in f&&(q=f.height);var t=null,K=!1;if("colorBuffers"in f||"colorBuffer"in f){t=f.colorBuffers||f.colorBuffer;Array.isArray(t)||(t=[t]);c.width=b;c.height=q;t=t.map(w);for(h=0;h<t.length;++h)C(t[h],c);b=c.width;q=c.height}else{var p=!0,I="rgba",O="uint8",r=1,K=!0;c.width=b||a.drawingBufferWidth;c.height=q||a.drawingBufferHeight;"format"in f&&(I=f.format,p=I in P);"type"in f&&(O=f.type);"colorCount"in f&&
(r=f.colorCount|0);if(c.ownsColor)for(t=c.colorAttachments;t.length>r;)z(t.pop());else t=[];for(h=0;h<t.length;++h){var k;a:{k=t[h];var x=p,y=I,N=b,n=q;if(k.texture){var S=k.texture;if(x){S({format:y,type:O,width:N,height:n});S._texture.refCount+=1;k=!0;break a}}else if(S=k.renderbuffer,!x){S({format:y,width:N,height:n});S._renderbuffer.refCount+=1;k=!0;break a}z(k);k=!1}k||(t[h--]=t[t.length-1],t.pop())}for(;t.length<r;)p?t.push(new l(3553,0,e.create({format:I,type:O,width:b,height:q},3553),null)):
t.push(new l(36161,0,null,m.create({format:I,width:b,height:q})))}c.width=b;c.height=q;I=p=h=null;O=!1;"depthBuffer"in f&&(h=w(f.depthBuffer));"stencilBuffer"in f&&(p=w(f.stencilBuffer));"depthStencilBuffer"in f&&(I=w(f.depthStencilBuffer));if(h||p||I)C(h||p||I,c);else if(r=!0,x=k=!1,"depth"in f&&(r=!!f.depth),"stencil"in f&&(k=!!f.stencil),"depthTexture"in f&&(x=!!f.depthTexture),f=c.depthAttachment||c.stencilAttachment||c.depthStencilAttachment,y=null,r||k)O=!0,x?(x=k?"depth stencil":"depth",c.ownsDepthStencil&&
f.texture?(f.texture({format:x,width:b,height:q}),f.texture._texture.refCount+=1,y=f):y=new l(3553,0,e.create({format:x,width:b,height:q},3553),null)):(x=r?k?"depth stencil":"depth":"stencil",c.ownsDepthStencil&&f.renderbuffer?(f.renderbuffer({format:x,width:b,height:q}),f.renderbuffer._renderbuffer.refCount+=1,y=f):y=new l(36161,0,null,m.create({format:x,width:b,height:q}))),r?k?I=y:h=y:p=y;b=c;b.colorAttachments.forEach(z);z(b.depthAttachment);z(b.stencilAttachment);z(b.depthStencilAttachment);
c.colorAttachments=t;c.depthAttachment=h;c.stencilAttachment=p;c.depthStencilAttachment=I;c.ownsColor=K;c.ownsDepthStencil=O;d.color=t.map(g);d.depth=g(h);d.stencil=g(p);d.depthStencil=g(I);T(c);d.width=c.width;d.height=c.height;return d}var c=new K;d(b);d._reglType="framebuffer";d._framebuffer=c;d._destroy=function(){t(c)};return d},clear:function(){d(ha).forEach(t)},refresh:function(){d(ha).forEach(T)}}}},{"./extend":14,"./values":32}],17:[function(c,e,l){var d=c("./is-typed-array");e.exports=function(c){return"object"===
typeof c&&Array.isArray(c.shape)&&Array.isArray(c.stride)&&"number"===typeof c.offset&&c.shape.length===c.stride.length&&(Array.isArray(c.data)||d(c.data))}},{"./is-typed-array":18}],18:[function(c,e,l){var d=c("./constants/arraytypes.json");e.exports=function(c){return Object.prototype.toString.call(c)in d}},{"./constants/arraytypes.json":7}],19:[function(c,e,l){e.exports=function(d,c){var b=1;c.ext_texture_filter_anisotropic&&(b=d.getParameter(34047));var a=1,e=1;c.webgl_draw_buffers&&(a=d.getParameter(34852),
e=d.getParameter(36063));return{colorBits:[d.getParameter(3410),d.getParameter(3411),d.getParameter(3412),d.getParameter(3413)],depthBits:d.getParameter(3414),stencilBits:d.getParameter(3415),subpixelBits:d.getParameter(3408),extensions:Object.keys(c).filter(function(a){return!!c[a]}),maxAnisotropic:b,maxDrawbuffers:a,maxColorAttachments:e,pointSizeDims:d.getParameter(33901),lineWidthDims:d.getParameter(33902),maxViewportDims:d.getParameter(3386),maxCombinedTextureUnits:d.getParameter(35661),maxCubeMapSize:d.getParameter(34076),
maxRenderbufferSize:d.getParameter(34024),maxTextureUnits:d.getParameter(34930),maxTextureSize:d.getParameter(3379),maxAttributes:d.getParameter(34921),maxVertexUniforms:d.getParameter(36347),maxVertexTextureUnits:d.getParameter(35660),maxVaryingVectors:d.getParameter(36348),maxFragmentUniforms:d.getParameter(36349),glsl:d.getParameter(35724),renderer:d.getParameter(7937),vendor:d.getParameter(7936),version:d.getParameter(7938)}}},{}],20:[function(c,e,l){e.exports=function(d,c){if("undefined"!==typeof document){var b;
b=(b=/\.(\w+)(\?.*)?$/.exec(d))&&b[1]?b[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(b))return b=document.createElement("video"),b.autoplay=!0,b.loop=!0,c&&(b.crossOrigin=c),b.src=d,b;if(0<=["dds"].indexOf(b))return b=new XMLHttpRequest,b.responseType="arraybuffer",b.open("GET",d,!0),b.send(),b;b=new Image;c&&(b.crossOrigin=c);b.src=d;return b}return null}},{}],21:[function(c,e,l){e.exports=function(c){function e(a){for(var b=
p,d=E,g=0;g<X;++g){var f=Math.max(1,b+3>>2)*Math.max(1,d+3>>2)*ia;na.pixels.push({target:a,miplevel:g,width:b,height:d,data:new Uint8Array(c,fa,f)});fa+=f;b>>=1;d>>=1}}var l=new Int32Array(c),L=l[t],p=l[P],E=l[O],la=m,Q=0,ia=0,R=4;switch(l[ea]){case h:ia=8;L&C?(R=3,Q=b):Q=a;break;case w:ia=16;Q=I;break;case g:ia=16;Q=f;break;case K:ia=8,Q=u}var X=1;l[U]&aa&&(X=Math.max(1,l[J]));var fa=l[T]+4,na={width:p,height:E,channels:R,format:Q,type:la,compressed:!0,cube:!1,pixels:[]};if(l[V]&z)for(na.cube=!0,
l=0;6>l;++l)e(q+l);else e(d);return na};var d=3553,q=34069,b=33776,a=33777,I=33778,f=33779,u=36196,m=5121,aa=131072,z=512,C=64,h=827611204,w=861165636,g=894720068,K=826496069,T=1,t=2,O=3,P=4,J=7,U=20,ea=21,V=28},{}],22:[function(c,e,l){e.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(d){return requestAnimationFrame(d)},cancel:function(d){return cancelAnimationFrame(d)}}:{next:function(d){setTimeout(d,30)},cancel:clearTimeout}},{}],23:[function(c,
e,l){var d=c("./is-typed-array");e.exports=function(c,b,a){return function(e){var f=e||{};d(e)?f={data:f}:2===arguments.length?f={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof e&&(f={});b();var l=f.x||0,m=f.y||0,aa=f.width||a.width,z=f.height||a.height,f=f.data||new Uint8Array(aa*z*4);c.pixelStorei(3333,4);c.readPixels(l,m,aa,z,6408,5121,f);return f}}},{"./is-typed-array":18}],24:[function(c,e,l){var d=c("./values");e.exports=function(c,b,a){function e(){this.id=aa++;this.refCount=
1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function f(a){c.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=c.createRenderbuffer());c.bindRenderbuffer(36161,a.renderbuffer);c.renderbufferStorage(36161,a.format,a.width,a.height)}function l(a){var b=a.renderbuffer;c.bindRenderbuffer(36161,null);c.isRenderbuffer(b)&&c.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete z[a.id]}var m={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};
b.ext_srgb&&(m.srgba=35907);b.ext_color_buffer_half_float&&(m.rgba16f=34842,m.rgb16f=34843);b.webgl_color_buffer_float&&(m.rgba32f=34836);var aa=0,z={};e.prototype.decRef=function(){0===--this.refCount&&l(this)};return{create:function(a){function b(a){a=a||{};var d=0,e=0;"shape"in a?(e=a.shape,d=e[0]|0,e=e[1]|0):("radius"in a&&(d=e=a.radius|0),"width"in a&&(d=a.width|0),"height"in a&&(e=a.height|0));b.width=c.width=Math.max(d,1);b.height=c.height=Math.max(e,1);c.format=32854;"format"in a&&(c.format=
m[a.format]);f(c);return b}var c=new e;z[c.id]=c;b(a);b._reglType="renderbuffer";b._renderbuffer=c;b.destroy=function(){c.decRef()};return b},refresh:function(){d(z).forEach(f)},clear:function(){d(z).forEach(l)}}}},{"./values":32}],25:[function(c,e,l){function d(b,a,c){this.name=b;this.location=a;this.info=c}var q=c("./values");e.exports=function(b,a,c,f,e){function m(a,c){var d=35632===a?C:h,g=d[c];if(!g){var f=e.str(c),g=b.createShader(a);b.shaderSource(g,f);b.compileShader(g);d[c]=g}return g}function l(a,
b){this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function z(g){var h,e;h=m(35632,g.fragId);e=m(35633,g.vertId);var l=g.program=b.createProgram();b.attachShader(l,h);b.attachShader(l,e);b.linkProgram(l);var q=b.getProgramParameter(l,35718),w=g.uniforms=[];for(h=0;h<q;++h)if(e=b.getActiveUniform(l,h))if(1<e.size)for(var u=0;u<e.size;++u){var z=e.name.replace("[0]","["+u+"]");c.def(z);w.push(new d(z,b.getUniformLocation(l,
z),e))}else c.def(e.name),w.push(new d(e.name,b.getUniformLocation(l,e.name),e));q=b.getProgramParameter(l,35721);w=g.attributes=[];for(h=0;h<q;++h)if(e=b.getActiveAttrib(l,h))a.def(e.name),w.push(new d(e.name,b.getAttribLocation(l,e.name),e));g.draw=f(g);g.batchCache={}}var C={},h={},w={},g=[];return{create:function(a,b){var c=w[b];c||(c=w[b]={});var d=c[a];d||(d=new l(b,a),z(d),c[a]=d,g.push(d));return d},clear:function(){var a=b.deleteShader.bind(b);q(C).forEach(a);C={};q(h).forEach(a);h={};g.forEach(function(a){b.deleteProgram(a.program)});
g.length=0;w={}},refresh:function(){C={};h={};g.forEach(z)},programs:[null],fragShaders:[e.id("void main(){gl_FragColor=vec4(0,0,0,0);}")],vertShaders:[e.id("void main(){gl_Position=vec4(0,0,0,0);}")]}}},{"./values":32}],26:[function(c,e,l){e.exports=function(c,e){var b=c.length,a=c.slice(),l=c.slice(),f=!1,u=!0;return{push:function(){f=!1;for(var c=0;c<b;++c){var d=arguments[c];f=f||d!==l[c];a.push(d)}},pop:function(){f=!1;a.length-=b;for(var c=0;c<b;++c)f=f||a[a.length-b+c]!==l[c]},poll:function(){var c=
a.length-b;if(f||u){switch(b){case 1:e(a[c]);break;case 2:e(a[c],a[c+1]);break;case 3:e(a[c],a[c+1],a[c+2]);break;case 4:e(a[c],a[c+1],a[c+2],a[c+3]);break;case 5:e(a[c],a[c+1],a[c+2],a[c+3],a[c+4]);break;case 6:e(a[c],a[c+1],a[c+2],a[c+3],a[c+4],a[c+5]);break;default:e.apply(null,a.slice(c,a.length))}for(var d=0;d<b;++d)l[d]=a[c+d];u=f=!1}},setDirty:function(){u=!0}}}},{}],27:[function(c,e,l){var d=c("./stack"),q=c("./codegen");e.exports=function(b,a,c){function f(a,c){var g=d([!!c],function(c){c?
b.enable(a):b.disable(a)});g.flag=a;return g}var e={dither:f(3024),"blend.enable":f(3042),"blend.color":d([0,0,0,0],function(a,c,d,f){b.blendColor(a,c,d,f)}),"blend.equation":d([32774,32774],function(a,c){b.blendEquationSeparate(a,c)}),"blend.func":d([1,0,1,0],function(a,c,d,f){b.blendFuncSeparate(a,c,d,f)}),"depth.enable":f(2929,!0),"depth.func":d([513],function(a){b.depthFunc(a)}),"depth.range":d([0,1],function(a,c){b.depthRange(a,c)}),"depth.mask":d([!0],function(a){b.depthMask(a)}),"cull.enable":f(2884),
"cull.face":d([1029],function(a){b.cullFace(a)}),frontFace:d([2305],function(a){b.frontFace(a)}),colorMask:d([!0,!0,!0,!0],function(a,c,d,f){b.colorMask(a,c,d,f)}),lineWidth:d([1],function(a){b.lineWidth(a)}),"polygonOffset.enable":f(32823),"polygonOffset.offset":d([0,0],function(a,c){b.polygonOffset(a,c)}),"sample.alpha":f(32926),"sample.enable":f(32928),"sample.coverage":d([1,!1],function(a,c){b.sampleCoverage(a,c)}),"stencil.enable":f(2960),"stencil.mask":d([-1],function(a){b.stencilMask(a)}),
"stencil.func":d([519,0,-1],function(a,c,d){b.stencilFunc(a,c,d)}),"stencil.opFront":d([7680,7680,7680],function(a,c,d){b.stencilOpSeparate(1028,a,c,d)}),"stencil.opBack":d([7680,7680,7680],function(a,c,d){b.stencilOpSeparate(1029,a,c,d)}),"scissor.enable":f(3089),"scissor.box":d([0,0,-1,-1],function(c,d,g,f){var e=g,m=a.top();0>g&&(e=m?m.width-c:b.drawingBufferWidth-c);g=f;0>f&&(g=m?m.height-d:b.drawingBufferHeight-d);b.scissor(c,d,e,g)}),viewport:d([0,0,-1,-1],function(d,f,g,e){var m=g,l=a.top();
0>g&&(m=l?l.width-d:b.drawingBufferWidth-d);g=e;0>e&&(g=l?l.height-f:b.drawingBufferHeight-f);b.viewport(d,f,m,g);c.width=m;c.height=g})},m=q(),l=m.proc("poll"),z=m.proc("refresh");Object.keys(e).forEach(function(a){a=m.link(e[a]);l(a,".poll();");z(a,".setDirty();")});var C=m.compile();return{contextState:e,viewport:c,poll:C.poll,refresh:C.refresh,notifyViewportChanged:function(){e.viewport.setDirty();e["scissor.box"].setDirty()}}}},{"./codegen":5,"./stack":26}],28:[function(c,e,l){e.exports=function(){var c=
{},e=[""];return{id:function(b){var a=c[b];if(a)return a;a=c[b]=e.length;e.push(b);return a},str:function(b){return e[b]}}}},{}],29:[function(c,e,l){function d(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function q(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var c=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==c)return!1;return!0}function b(a){return Object.prototype.toString.call(a)}function a(a){return"[object HTMLCanvasElement]"===
b(a)}function I(a){return"[object CanvasRenderingContext2D]"===b(a)}var f=c("./extend"),u=c("./values"),m=c("./is-typed-array"),aa=c("./is-ndarray"),z=c("./load-texture"),C=c("./to-half-float"),h=c("./parse-dds"),w=[9984,9986,9985,9987];e.exports=function(c,e,l,t,O){function P(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=
this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function J(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function U(a,b){var c,d,f=0,e=0,g=0,h=0,m=0,k=0,l=!1,q=!1,p=!1;for(c=0;c<b.length;++c)d=b[c],h=h||d.width<<d.miplevel,
m=m||d.height<<d.miplevel,f=f||d.type,e=e||d.format,g=g||d.internalformat,k=k||d.channels,l=l||d.needsPoll,q=q||d.needsListeners,d=d.miplevel,p=p||0<d;a.needsPoll=l;a.needsListeners=q;a.width=h;a.height=m;a.format=e;a.internalformat=g;a.type=f;if(3553!==a.target)for(c=0;6>c;++c);c=0<=w.indexOf(a.minFilter);a.genMipmaps=!p&&(a.genMipmaps||c);p=p||a.genMipmaps;a.minFilter||(a.minFilter=p?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=k),
d.format||(d.format=e),d.internalformat||(d.internalformat=g),d.type||(d.type=f)}function ea(a){this.id=r++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new J(a);this.pixels=[]}function V(a,b){function c(a,d){var n=d.mipmap,f;if(Array.isArray(n))for(var g=0;g<n.length;++g)f=new P(a),f.parseFlags(b),f.parseFlags(d),f.parse(n[g],g),e.push(f);else f=new P(a),f.parseFlags(b),f.parse(d,0),e.push(f)}var d;N(a);var f=a.params;
J.call(f,a.target);var e=a.pixels;e.length=0;f.parse(b);if(3553===a.target)c(3553,b);else{var g=b.faces||b;if(Array.isArray(g))for(d=0;6>d;++d)c(34069+d,g[d]);else if("string"!==typeof g)for(d=0;6>d;++d)c(34069+d,{})}U(f,e);f.needsListeners&&ha(a);f.needsPoll&&(a.pollId=x.length,x.push(a));ga(a)}function ga(a){c.isTexture(a.texture)||(a.texture=c.createTexture());var b=a.target,d=a.unit;0<=d?(c.activeTexture(33984+d),W=d):c.bindTexture(b,a.texture);for(var b=a.pixels,f=a.params,e=0;e<b.length;++e)b[e].upload(f);
f.upload();0>d&&((d=ba[W])?c.bindTexture(d.target,d.texture):(a.unit=W,ba[W]=a))}function ha(a){function b(a,c,d){var n=h(d);n.pixels.forEach(function(b){var d=new P(n.cube?b.target:a);d.channels=n.channels;d.compressed=n.compressed;d.type=n.type;d.internalformat=n.format;d.format=Y[n.format];d.width=b.width;d.height=b.height;d.miplevel=b.miplevel||c;d.data=b.data;f.push(d)})}function c(){for(var e=0;e<f.length;++e){var g=f[e],h=g.image,m=g.video,k=g.xhr;h&&h.complete?(g.width=h.naturalWidth,g.height=
h.naturalHeight):m&&2<m.readyState?(g.width=m.width,g.height=m.height):k&&4===k.readyState&&(f[e]=f[f.length-1],f.pop(),k.removeEventListener("readystatechange",ga),b(g.target,g.miplevel,k.response))}U(d,f);ga(a)}var d=a.params,f=a.pixels;f.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){f.forEach(function(a){a.image?a.image.removeEventListener("load",
c):a.video?a.video.removeEventListener("progress",c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function N(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((x[b]=x[x.length-1]).id=b,x.pop(),a.pollId=-1)}function L(a){var b=a.texture,d=a.unit,f=a.target;0<=d&&(c.activeTexture(33984+d),W=d,c.bindTexture(f,null),ba[d]=null);N(a);c.isTexture(b)&&c.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete k[a.id]}var p={"don't care":4352,
"dont care":4352,nice:4354,fast:4353},E={repeat:10497,clamp:33071,mirror:33648},la={nearest:9728,linear:9729},Q=f({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},la),ia={none:0,browser:37444},R={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},X={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},fa={};e.ext_srgb&&(X.srgb=35904,X.srgba=35906);e.oes_texture_float&&
(R["float"]=5126);e.oes_texture_half_float&&(R["half float"]=36193);e.webgl_depth_texture&&(f(X,{depth:6402,"depth stencil":34041}),f(R,{uint16:5123,uint32:5125,"depth stencil":34042}));e.webgl_compressed_texture_s3tc&&f(fa,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});e.webgl_compressed_texture_atc&&f(fa,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});e.webgl_compressed_texture_pvrtc&&f(fa,{"rgb pvrtc 4bppv1":35840,
"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});e.webgl_compressed_texture_etc1&&(fa["rgb etc1"]=36196);var na=Array.prototype.slice.call(c.getParameter(34467));Object.keys(fa).forEach(function(a){var b=fa[a];0<=na.indexOf(b)&&(X[a]=b)});var B=Object.keys(X);l.textureFormats=B;var Y=B.reduce(function(a,b){var c=X[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});f(P.prototype,{parseFlags:function(a){if("object"===
typeof a&&a){"premultiplyAlpha"in a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=ia[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=X[b];b in R&&(this.type=R[b]);b in fa&&(this.compressed=!0)}"type"in a&&(this.type=R[a.type]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&
(b=c=a.radius),"width"in a&&(b=a.width),"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(c,f){this.miplevel=f;this.width>>=
f;this.height>>=f;var e=c;switch(typeof c){case "object":if(!c)return;this.parseFlags(c);var g=c.data;if("string"===typeof g||g&&(m(g)||d(g)||aa(g)||a(g)||I(g)||"[object HTMLImageElement]"===b(g)||"[object HTMLVideoElement]"===b(g)||q(g)))e=c.data;break;case "undefined":return}"string"===typeof e&&(e=z(e,this.crossOrigin));var g=null,h=!1;if(null!==e)if(m(e))this.data=e;else if(d(e))g=e,h=!0;else if(aa(e)){Array.isArray(e.data)?(g=e.data,h=!0):this.data=e.data;var k=e.shape;this.width=k[0];this.height=
k[1];this.channels=3===k.length?k[2]:1;k=e.stride;this.strideX=e.stride[0];this.strideY=e.stride[1];this.strideC=3===k.length?e.stride[2]:1;this.offset=e.offset;this.needsTranspose=!0}else if(a(e)||I(e))a(e)?this.canvas=e:this.canvas=e.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===b(e))this.image=e,e.complete?(this.width=e.naturalWidth,this.height=e.naturalHeight):(this.width=this.width||e.naturalWidth,this.height=
this.height||e.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();else if("[object HTMLVideoElement]"===b(e))this.video=e,1<e.readyState?(this.width=e.width,this.height=e.height):(this.width=this.width||e.width,this.height=this.height||e.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===b(e))this.xhr=e,this.needsListeners=!0;else if(q(e)){var h=e.length,k=e[0].length,l=1,p,r,u,t;if(Array.isArray(e[0][0]))for(l=e[0][0].length,g=
Array(h*k*l),r=t=0;r<k;++r)for(p=0;p<h;++p)for(u=0;u<l;++u)g[t++]=e[p][r][u];else for(g=Array(h*k),r=t=0;r<k;++r)for(p=0;p<h;++p)g[t++]=e[p][r];this.width=h;this.height=k;this.channels=l;h=!0}else c.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||O.width)|0,this.height=(this.height||O.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&
(this.type=5126));this.internalformat||(this.internalformat=[6409,6410,6407,6408][(this.channels=this.channels||4)-1]);e=this.internalformat;k=this.format=Y[e];if(!this.channels)switch(k){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}k=this.type;5126!==k&&36193!==k&&(k||(k=6402===e?5125:5121));this.type=k;if(h)switch(k){case 5121:this.data=new Uint8Array(g);break;case 5123:this.data=new Uint16Array(g);
break;case 5125:this.data=new Uint32Array(g);break;case 5126:this.data=new Float32Array(g);break;case 36193:this.data=C(g)}if(this.data&&this.needsTranspose){g=this.data;e=this.width;h=this.height;k=this.channels;l=this.strideX;p=this.strideY;r=this.strideC;u=this.offset;t=new g.constructor(e*h*k);for(var w=0,x=0;x<h;++x)for(var y=0;y<e;++y)for(var B=0;B<k;++B)t[w++]=g[p*x+l*y+r*B+u];this.data=t}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;
this.channels=4;this.compressed=!1},upload:function(a){c.pixelStorei(37440,this.flipY);c.pixelStorei(37441,this.premultiplyAlpha);c.pixelStorei(37443,this.colorSpace);c.pixelStorei(3317,this.unpackAlignment);var b=this.target,d=this.miplevel,e=this.image,f=this.canvas,h=this.video,k=this.data,m=this.internalformat,l=this.format,q=this.type,p=this.width||Math.max(1,a.width>>d);a=this.height||Math.max(1,a.height>>d);h&&2<h.readyState?c.texImage2D(b,d,l,l,q,h):e&&e.complete?c.texImage2D(b,d,l,l,q,e):
f?c.texImage2D(b,d,l,l,q,f):this.compressed?c.compressedTexImage2D(b,d,m,p,a,0,k):this.copy?(t(),c.copyTexImage2D(b,d,l,this.x,this.y,p,a,0)):k?c.texImage2D(b,d,l,p,a,0,l,q,k):c.texImage2D(b,d,l,p||1,a||1,0,l,q,null)}});f(J.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=Q[a.min]);"mag"in a&&(this.magFilter=la[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=E[d]:Array.isArray(d)&&(b=E[d[0]],c=E[d[1]])}else"wrapS"in a&&(b=
E[a.wrapS]),"wrapT"in a&&(c=E[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=p[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;c.texParameteri(a,10241,this.minFilter);c.texParameteri(a,10240,this.magFilter);c.texParameteri(a,10242,this.wrapS);c.texParameteri(a,10243,this.wrapT);e.ext_texture_filter_anisotropic&&c.texParameteri(a,34046,
this.anisotropic);this.genMipmaps&&(c.hint(33170,this.mipmapHint),c.generateMipmap(a))}});var W=0,r=0,k={},x=[],y=l.maxTextureUnits,ba=Array(y).map(function(){return null});f(ea.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<y;++b){var d=ba[b];if(d){if(0<d.bindCount)continue;d.unit=-1}ba[b]=this;a=b;break}this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture);W=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&
L(this)}});return{create:function(a,b){function c(a,e,f,g,h,k){var m=a||{};34067===b&&6===arguments.length&&(m=[a,e,f,g,h,k]);V(d,m);c.width=d.params.width;c.height=d.params.height;return c}var d=new ea(b);k[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){u(k).forEach(ga);for(var a=0;a<y;++a)ba[a]=null;W=0;c.activeTexture(33984)},clear:function(){for(var a=0;a<y;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),ba[a]=null;c.activeTexture(33984);
W=0;u(k).forEach(L)},poll:function(){x.forEach(ga)},getTexture:function(a){return null}}}},{"./extend":14,"./is-ndarray":17,"./is-typed-array":18,"./load-texture":20,"./parse-dds":21,"./to-half-float":30,"./values":32}],30:[function(c,e,l){e.exports=function(c){for(var e=new Float32Array(c),e=new Uint32Array(e.buffer),b=new Uint16Array(c.length),a=0;a<c.length;++a)if(isNaN(c[a]))b[a]=65535;else if(Infinity===c[a])b[a]=31744;else if(-Infinity===c[a])b[a]=64512;else{var l=e[a],f=l>>>31<<15,u=(l<<1>>>
24)-127,l=l>>13&1023;b[a]=-24>u?f:-14>u?f+(l+1024>>-14-u):15<u?f+31744:f+(u+15<<10)+l}return b}},{}],31:[function(c,e,l){e.exports=function(c){var e={};return{def:function(b){b=c.id(b);var a=e[b];a||(a=e[b]=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]);return a}}}},{}],32:[function(c,e,l){e.exports=function(c){return Object.keys(c).map(function(e){return c[e]})}},{}],33:[function(c,e,l){var d=c("./lib/extend"),q=c("./lib/context"),b=c("./lib/strings"),a=c("./lib/extension"),I=c("./lib/limits"),f=c("./lib/buffer"),
u=c("./lib/elements"),m=c("./lib/texture"),aa=c("./lib/renderbuffer"),z=c("./lib/framebuffer"),C=c("./lib/uniform"),h=c("./lib/attribute"),w=c("./lib/shader"),g=c("./lib/draw"),K=c("./lib/state"),T=c("./lib/compile"),t=c("./lib/read"),O=c("./lib/dynamic"),P=c("./lib/raf"),J=c("./lib/clock");e.exports=function(){function c(){ja=P.next(c);y.count+=1;if(y.width!==p.drawingBufferWidth||y.height!==p.drawingBufferHeight)y.width=p.drawingBufferWidth,y.height=p.drawingBufferHeight,ba.notifyViewportChanged();
var a=J();y.dt=a-y.t;y.t=a;r.poll();for(var b=0;b<Z.length;++b)(0,Z[b])(y.count,y.t,y.dt);y.renderTime=J()-a}function e(){ja&&(P.cancel(c),ja=0)}function l(a){e();a.preventDefault();if(E.onContextLost)E.onContextLost()}function ga(a){p.getError();la.refresh();X.refresh();r.refresh();k.refresh();x.refresh();Y.refresh();ba.refresh();if(E.onContextRestored)E.onContextRestored();c()}function ha(a){function b(a){var d={},e={};Object.keys(a).forEach(function(b){var f=a[b];O.isDynamic(f)?(c=!0,e[b]=O.unbox(f,
b)):d[b]=f});return{dynamic:e,"static":d}}var c=!1,e=b(a.uniforms||{}),f=b(a.attributes||{});a=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=d({},a);delete c.uniforms;delete c.attributes;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));var e=n.command(a["static"],e["static"],f["static"],a.dynamic,e.dynamic,f.dynamic,c),g=e.draw,h=e.batch,k=e.scope,l=[];return function(a,
b){if("number"===typeof a){for(var c=a|0;l.length<c;)l.push(null);return h(a|0,l)}return Array.isArray(a)?h(a.length,a):"function"===typeof a?k(null,a):"function"===typeof b?k(a,b):g(a)}}function N(){x.poll();ba.poll()}var L=q(Array.prototype.slice.call(arguments)),p=L.gl,E=L.options,L=b(),la=a(p),Q=la.extensions,ia={width:p.drawingBufferWidth,height:p.drawingBufferHeight},R=I(p,Q),X=f(p),fa=u(p,Q,X),na=C(L),B=h(p,Q,R,X,L),Y=w(p,B,na,function(a){return n.draw(a)},L),W=g(p,Q,X),r=m(p,Q,R,N,ia),k=aa(p,
Q,R),x=z(p,Q,R,r,k),y={count:0,start:J(),dt:0,t:J(),renderTime:0,width:p.drawingBufferWidth,height:p.drawingBufferHeight,pixelRatio:E.pixelRatio},ba=K(p,x,ia),ia=t(p,N,ia),n=T(p,L,Q,R,X,fa,r,x,ba,na,B,Y,W,y,N),S=p.canvas,Z=[],ja=0;S&&(S.addEventListener("webglcontextlost",l,!1),S.addEventListener("webglcontextrestored",ga,!1));return d(ha,{clear:function(a){var b=0;N();var c=a.color;c&&(p.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(p.clearDepth(+a.depth),b|=256);"stencil"in
a&&(p.clearStencil(a.stencil|0),b|=1024);p.clear(b)},prop:O.define,draw:ha({}),elements:function(a){return fa.create(a)},buffer:function(a){return X.create(a,34962)},texture:function(a){return r.create(a,3553)},cube:function(a){return 6===arguments.length?r.create(Array.prototype.slice.call(arguments),34067):r.create(a,34067)},renderbuffer:function(a){return k.create(a)},framebuffer:function(a){return x.create(a)},framebufferCube:function(a){},frame:function(a){Z.push(a);!ja&&0<Z.length&&c();return{cancel:function(){var b=
Z.find(function(b){return b===a});0>b||(Z.splice(b,1),0>=Z.length&&e())}}},stats:y,limits:R,read:ia,destroy:function(){e();S&&(S.removeEventListener("webglcontextlost",l),S.removeEventListener("webglcontextrestored",ga));Y.clear();x.clear();k.clear();r.clear();X.clear();if(E.onDestroy)E.onDestroy()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/clock":4,"./lib/compile":6,"./lib/context":10,"./lib/draw":11,"./lib/dynamic":12,"./lib/elements":13,"./lib/extend":14,"./lib/extension":15,"./lib/framebuffer":16,
"./lib/limits":19,"./lib/raf":22,"./lib/read":23,"./lib/renderbuffer":24,"./lib/shader":25,"./lib/state":27,"./lib/strings":28,"./lib/texture":29,"./lib/uniform":31}]},{},[1]);
