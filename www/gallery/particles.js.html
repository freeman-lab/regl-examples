<!DOCTYPE html>
      <html>
        <head>
          <title>example/particles.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(g,m,a){function b(d,f){if(!m[d]){if(!g[d]){var p="function"==typeof require&&require;if(!f&&p)return p(d,!0);if(c)return c(d,!0);p=Error("Cannot find module '"+d+"'");throw p.code="MODULE_NOT_FOUND",p;}p=m[d]={exports:{}};g[d][0].call(p.exports,function(a){var c=g[d][1][a];return b(c?c:a)},p,p.exports,e$$0,g,m,a)}return m[d].exports}for(var c="function"==typeof require&&require,d=0;d<a.length;d++)b(a[d]);return b})({1:[function(e,g,m){var a=e("../regl")(),b=e("gl-mat4"),c=e("hsv2rgb");
e=a.buffer(Array(1E4).fill().map(function(){var a=c(360*Math.random(),.6,1);return[10*Math.random(),10*Math.random(),10*Math.random(),10*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),a[0]/255,a[1]/255,a[2]/255]}));var d=a({vert:"\n  precision mediump float;\n  attribute vec4 freq, phase;\n  attribute vec3 color;\n  uniform float time;\n  uniform mat4 view, projection;\n  varying vec3 fragColor;\n  void main() {\n    vec3 position = 8.0 * cos(freq.xyz * time + phase.xyz);\n    gl_PointSize = 5.0 * (1.0 + cos(freq.w * time + phase.w));\n    gl_Position = projection * view * vec4(position, 1);\n    fragColor = color;\n  }",
frag:"\n  precision lowp float;\n  varying vec3 fragColor;\n  void main() {\n    if (length(gl_PointCoord.xy - 0.5) > 0.5) {\n      discard;\n    }\n    gl_FragColor = vec4(fragColor, 1);\n  }",attributes:{freq:{buffer:e,stride:44,offset:0},phase:{buffer:e,stride:44,offset:16},color:{buffer:e,stride:44,offset:32}},uniforms:{view:function(a,c){var d=.01*c.count;return b.lookAt([],[30*Math.cos(d),2.5,30*Math.sin(d)],[0,0,0],[0,1,0])},projection:function(a,c){return b.perspective([],Math.PI/4,c.viewportWidth/
c.viewportHeight,.01,1E3)},time:function(a,b){return.001*b.count}},count:1E4,primitive:"points"});a.frame(function(b,c){a.clear({depth:1,color:[0,0,0,1]});d()})},{"../regl":58,"gl-mat4":42,hsv2rgb:57}],2:[function(e,g,m){var a=e("./constants/dtypes.json");g.exports=function(b,c,d,h,f){function p(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function k(a){this.records=[];this.name=a}function l(a,
d,h,f){f=h.size||f;var k;k=d.pointer?h.pointer&&d.buffer===h.buffer&&d.size===f&&d.normalized===h.normalized&&d.type===(h.type||h.buffer.dtype||5126)&&d.offset===h.offset&&d.stride===h.stride&&d.divisor===h.divisor:!h.pointer&&d.x===h.x&&d.y===h.y&&d.z===h.z&&d.w===h.w;k||(h.pointer?(b.enableVertexAttribArray(a),h.buffer.bind(),b.vertexAttribPointer(a,f,h.type||h.buffer.dtype||5126,h.normalized,h.stride,h.offset),(k=c.angle_instanced_arrays)&&k.vertexAttribDivisorANGLE(a,h.divisor)):(b.disableVertexAttribArray(a),
b.vertexAttrib4f(a,h.x,h.y,h.z,h.w)),(d.pointer=h.pointer)?(d.buffer=h.buffer,d.size=f,d.normalized=h.normalized,d.type=h.type||h.buffer.dtype||5126,d.offset=h.offset,d.stride=h.stride,d.divisor=h.divisor):(d.x=h.x,d.y=h.y,d.z=h.z,d.w=h.w))}var G={};d=d.maxAttributes;for(var e=Array(d),n=0;n<d;++n)e[n]=new p;return{bindings:e,bind:function(a,b,d,c){d=d.records;l(a,b,d[d.length-1],c)},bindRecord:l,def:function(a){var b=f.id(a),d=G[b];d||(d=G[b]=new k(a));return d},box:function(b){var d=[new p];return{alloc:function(b){var c;
c=0>=d.length?new p:d.pop();if("number"===typeof b)c.pointer=!1,c.x=b,c.y=0,c.z=0,c.w=0;else if(Array.isArray(b))c.pointer=!1,c.x=b[0],c.y=b[1],c.z=b[2],c.w=b[3];else{var f=h.getBuffer(b),k=0,n=0,l=0,G=0,e=!1,r=0;f||(f=h.getBuffer(b.buffer),k=b.size||0,n=b.stride||0,l=b.offset||0,G=b.divisor||0,e=b.normalized||!1,r=0,"type"in b&&(r=a[b.type]));c.pointer=!0;c.buffer=f;c.size=k;c.offset=l;c.stride=n;c.divisor=G;c.normalized=e;c.type=r}return c},free:function(a){d.push(a)}}},state:G}}},{"./constants/dtypes.json":6}],
3:[function(e,g,m){function a(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);case 5122:return new Int16Array(b);case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var b=e("./util/is-typed-array"),c=e("./util/is-ndarray"),d=e("./constants/arraytypes.json"),h=e("./constants/dtypes.json"),f=e("./util/values"),p={"static":35044,dynamic:35048,stream:35040};
g.exports=function(k,l){function G(a,b){this.id=r++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function e(a){l(a);k.isBuffer(a.buffer)||(a.buffer=k.createBuffer());a.bind();k.bufferData(a.type,a.data||a.byteLength,a.usage)}function n(a){var b=a.buffer;l(a);k.isBuffer(b)&&k.deleteBuffer(b);a.buffer=null;delete q[a.id]}var r=0,q={};G.prototype.bind=function(){k.bindBuffer(this.type,this.buffer)};return{create:function(f,l,r){function g(f){var k=
f||{};if(Array.isArray(k)||b(k)||c(k))k={data:k};else if("number"===typeof k)k={length:k|0};else if(null===k||void 0===k)k={};u.usage="usage"in k?p[k.usage]:35044;f=0;"type"in k&&(f=h[k.type]);var n=k.dimension|0||1,q=0,l=null;if("data"in k)if(l=k.data,null===l)q=k.length|0;else{if(c(l)){var n=l.shape,q=l.stride,k=l.offset,G=0,r=0,y=0,S=0;1===n.length?(G=n[0],r=1,y=q[0],S=0):2===n.length&&(G=n[0],r=n[1],y=q[0],S=q[1]);f=f||d[Object.prototype.toString.call(l)]|0||5126;for(var n=r,q=a(f,G*r),l=l.data,
w=0,J=0;J<G;++J)for(var z=0;z<r;++z)q[w++]=l[y*J+S*z+k];l=q}else if(Array.isArray(l))if(0<l.length&&Array.isArray(l[0])){n=l[0].length;f=f||5126;k=a(f,l.length*n);q=l;l=n;for(G=S=0;G<q.length;++G)for(y=q[G],r=0;r<l;++r)k[S++]=y[r];l=k}else f=f||5126,l=a(f,l);else f=f||d[Object.prototype.toString.call(l)]|0;q=l.byteLength}else"length"in k&&(q=k.length|0);u.data=l;u.dtype=f||5121;u.byteLength=q;u.dimension=n;e(u);return g}var m=k.createBuffer(),u=new G(m,l);q[u.id]=u;r||g(f);g._reglType="buffer";g._buffer=
u;g.destroy=function(){n(u)};return g},clear:function(){f(q).forEach(n)},refresh:function(){f(q).forEach(e)},getBuffer:function(a){return a&&a._buffer instanceof G?a._buffer:null}}}},{"./constants/arraytypes.json":5,"./constants/dtypes.json":6,"./util/is-ndarray":24,"./util/is-typed-array":25,"./util/values":31}],4:[function(e,g,m){function a(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}
function b(a,b,c,d){var h,f=",";switch(b){case 5126:h="1f";break;case 35664:h="2fv";break;case 35665:h="3fv";break;case 35666:h="4fv";break;case 35670:case 5124:h="1i";break;case 35671:case 35667:h="2iv";break;case 35672:case 35668:h="3iv";break;case 35673:case 35669:h="4iv";break;case 35674:h="Matrix2fv";f=",false,";break;case 35675:h="Matrix3fv";f=",false,";break;case 35676:h="Matrix4fv",f=",false,"}return a+".uniform"+h+"("+c+f+d+");"}function c(a){return a+"["+a+".length-1]"}function d(a,b){return"framebuffer"===
a||a<b?-1:a>b?1:0}var h=e("./util/codegen"),f=e("./constants/primitives.json"),p={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},k={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,
">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},l={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};g.exports=function(G,e,n,r,q,g,w,z,t,m,u,B,A,W,R){function P(q,e,r,x,C){function w(a){var b=ra[a];return b?b:b=ra[a]=I(Q[a])}function t(a){var b=a.id,c=da[b];if(c)return c;switch(a.type){case 0:c=v.def(I(a.data),".call(this,",T,",",O,")");break;case 1:c=v.def(T,a.data);break;case 2:c=v.def(O,a.data);break;
case 3:c=v.def("this",a.data)}return da[b]=c}function B(a,b){for(var c=0;c<a.length;++c)if(a[c].name===b)return a[c];return null}function ja(a){return N&&!(a in e||a in C)}var ea=h(),I=ea.link,v=ea.proc("batch"),D=ea.block(),L=v.def,X=v.arg,E=I(G),aa=I(q.program),U=I(u.bind),la=I(u.bindRecord),O=I(W),Z=I(z),ba=I(A.count),ka=I(A.offset),qa=I(A.instances),V=I(A.primitive),ra={},F=I(g.elements),ba=L(c(ba)),ka=L(c(ka)),V=L(c(V)),F=L(c(F)),M,R,P=n.angle_instanced_arrays;P&&(M=L(c(qa)),R=I(P));var N="elements"in
e,qa=X(),X=X(),T=L(),pa=L(),da={};v(E,".useProgram(",aa,");");q.uniforms.forEach(function(a){if(!(a.name in r)){var c=I(a.location),d=I(m.def(a.name)),d=d+"["+d+".length-1]";a=a.info.type;35678===a||35680===a?(a=L(d+"._texture"),v(b(E,5124,c,a+".bind()")),D(a,".unbind();")):v(b(E,a,c,d))}});q.attributes.forEach(function(b){if(!(b.name in x)){var c=I(u.def(b.name));v(U,"(",b.location,",",I(u.bindings[b.location]),",",c,",",a(b.info.type),");")}});N||v("if(",F,")",E,".bindBuffer(",34963,",",F,".buffer.buffer);");
v("for(",pa,"=0;",pa,"<",qa,";++",pa,"){",T,"=",X,"[",pa,"];",O,".batchId=",pa,";");Object.keys(e).sort(d).forEach(function(a){function b(a){v("if(",c,"){",E,".enable(",a,");}else{",E,".disable(",a,");}")}var c=t(e[a]);switch(a){case "framebuffer":a=w("viewport");var d=w("scissor.box");v("if(",Z,".push(",c,"&&",c,"._framebuffer)){",Z,".poll();",a,".setDirty();",d,".setDirty();","}");break;case "cull.enable":b(2884);break;case "blend.enable":b(3042);break;case "dither":b(3024);break;case "stencil.enable":b(2960);
break;case "depth.enable":b(2929);break;case "scissor.enable":b(3089);break;case "polygonOffset.enable":b(32823);break;case "sample.alpha":b(32926);break;case "sample.enable":b(32928);break;case "depth.mask":v(E,".depthMask(",c,");");break;case "depth.func":a=I(k);v(E,".depthFunc(",a,"[",c,"]);");break;case "depth.range":v(E,".depthRange(",c,"[0],",c,"[1]);");break;case "blend.color":v(E,".blendColor(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "blend.equation":a=I(H);v("if(typeof ",c,'==="string"){',
E,".blendEquation(",a,"[",c,"]);","}else{",E,".blendEquationSeparate(",a,"[",c,".rgb],",a,"[",c,".alpha]);","}");break;case "blend.func":a=I(p);v(E,".blendFuncSeparate(",a,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",a,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",a,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",a,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");break;case "stencil.mask":v(E,".stencilMask(",c,");");break;case "stencil.func":a=I(k);v(E,".stencilFunc(",a,"[",c,'.cmp||"always"],',
c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":d=I(l);v(E,".stencilOpSeparate(","stencil.opFront"===a?1028:1029,",",d,"[",c,'.fail||"keep"],',d,"[",c,'.zfail||"keep"],',d,"[",c,'.pass||"keep"]);');break;case "polygonOffset.offset":v(E,".polygonOffset(",c,".factor||0,",c,".units||0);");break;case "cull.face":v(E,".cullFace(",c,'==="front"?',1028,":",1029,");");break;case "lineWidth":v(E,".lineWidth(",c,");");break;case "frontFace":v(E,".frontFace(",
c,'==="cw"?',2304,":",2305,");");break;case "colorMask":v(E,".colorMask(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "sample.coverage":v(E,".sampleCoverage(",c,".value,",c,".invert);");break;case "scissor.box":case "viewport":a=w(a),v(a,".push(",c,".x||0,",c,".y||0,",c,".w||-1,",c,".h||-1);")}});("viewport"in e||"framebuffer"in e)&&v(w("viewport"),".poll();");("scissor.box"in e||"framebuffer"in e)&&v(w("scissor.box"),".poll();");"framebuffer"in e&&v(Z,".pop();");var fa=q.uniforms,sa=[];Object.keys(r).forEach(function(a){var c=
B(fa,a);if(c){var d=c.info.type,h=I(c.location);a=t(r[a]);35678===c.info.type||35680===c.info.type?(c=L(a+"._texture"),sa.push(c),v(b(E,5124,h,c+".bind()"))):v(b(E,d,h,a))}});sa.forEach(function(a){v(a,".unbind();")});var na=q.attributes;Object.keys(x).forEach(function(b){var c=B(na,b);if(c){var d=I(u.box(b));b=t(x[b]);b=L(d+".alloc("+b+")");v(la,"(",c.location,",",I(u.bindings[c.location]),",",b,",",a(c.info.type),");");D(d,".free(",b,");")}});e.count&&v(ba,"=",t(e.count),";");e.offset&&v(ka,"=",
t(e.offset),";");e.primitive&&v(V,"=",I(f),"[",t(e.primitive),"];");P&&e.instances&&v(M,"=",t(e.instances),";");N&&(q=t(e.elements),v(F,"=",q,"?",q,"._elements:null;"));ja("offset")&&v(ka,"=0;");v("if(",F,"){");ja("count")&&v(ba,"=",F,".vertCount;");v("if(",ba,">0){");ja("primitive")&&v(V,"=",F,".primType;");N&&v(E,".bindBuffer(",34963,",",F,".buffer.buffer);");P&&v("if(",M,">0){",R,".drawElementsInstancedANGLE(",V,",",ba,",",F,".type,",ka,",",M,");}else ");v(E,".drawElements(",V,",",ba,",",F,".type,",
ka,");");v("}}else if(",ba,">0){");ja("count")||(ja("primitive")&&v(V,"=",4,";"),P&&v("if(",M,">0){",R,".drawArraysInstancedANGLE(",V,",",ka,",",ba,",",M,");}else{"),v(E,".drawArrays(",V,",",ka,",",ba,");"),P&&v("}"));v("}}",D);return ea.compile().batch}var Q=t.contextState,H={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(H.min=32775,H.max=32776);var C=0;return{draw:function(d){var f=h(),k=f.link,p=f.proc("draw"),q=p.def,l=k(G),e=k(d.program),r=k(u.bind),x=k(A.count),C=k(A.offset),
w=k(A.instances),z=k(A.primitive),t=k(g.elements),B=[];p(l,".useProgram(",e,");");d.attributes.forEach(function(b){var c=k(u.def(b.name));p(r,"(",b.location,",",k(u.bindings[b.location]),",",c,",",a(b.info.type),");")});d.uniforms.forEach(function(a){var c=k(a.location),d=k(m.def(a.name)),d=d+"["+d+".length-1]";a=a.info.type;35678===a||35680===a?(a=q(d+"._texture"),B.push(a),p(b(l,5124,c,a+".bind()"))):p(b(l,a,c,d))});B.forEach(function(a){p(a,".unbind();")});d=q(c(z));x=q(c(x));C=q(c(C));t=q(c(t));
p("if(",x,"){");(e=n.angle_instanced_arrays)?(w=q(c(w)),e=k(e),p("if(",t,"){",t,".bind();","if(",w,">0){",e,".drawElementsInstancedANGLE(",d,",",x,",",t,".type,",C,",",w,");}else{",l,".drawElements(",d,",",x,",",t,".type,",C,");}","}else if(",w,">0){",e,".drawArraysInstancedANGLE(",d,",",C,",",x,",",w,");}else{",l,".drawArrays(",d,",",C,",",x,");}}")):p("if(",t,"){",t,".bind();",l,".drawElements(",d,",",x,",",t,".type,",C,");","}else{",l,".drawArrays(",d,",",C,",",x,");}}");return f.compile().draw},
command:function(a,b,c,q,n,G,r,w){function t(a){var b=ra[a];return b?b:b=ra[a]=D(Q[a])}function ea(a,b){var c=t(a);F(c,".push(",b,");");M(c,".pop();")}function I(a){var b=a.id,c=pa[b];if(c)return c;switch(a.type){case 0:c=N.def(D(a.data),".call(this,",ma,",",V,")");break;case 1:c=N.def(ma,a.data);break;case 2:c=N.def(V,a.data);break;case 3:c=N.def("this",a.data)}return pa[b]=c}var v=h(),D=v.link,L=v.block,X=v.proc,E=C++,aa=D(R),U=D(B),la=D(z),O={count:D(A.count),offset:D(A.offset),instances:D(A.instances),
primitive:D(A.primitive)},Z=D(g.elements),ba=D(f),ka=D(k),qa=D(l),V=D(W),ra={},F=L(),M=L(),ma;w&&(ma=F.def());F(V,".batchId=0;");var ta=L();Object.keys(r["static"]).forEach(function(a){var b=F.def(V,".",a);ta(V,".",a,"=",D(r["static"][a]),";");M(V,".",a,"=",b,";")});Object.keys(r.dynamic).forEach(function(a){var b=F.def(V,".",a),c=F.def(),d=r.dynamic[a];ta(V,".",a,"=",c,";");switch(d.type){case 0:F(c,"=",D(d.data),".call(this,",ma,",",V,");");break;case 1:F(c,"=",ma,d.data,";");break;case 2:F(c,"=",
V,d.data,";");break;case 3:F(c,"=","this",d.data,";")}M(V,".",a,"=",b,";")});F(ta);Object.keys(a).sort(d).forEach(function(b){var c=a[b];switch(b){case "frag":case "vert":c=e.id(c);B.shader("frag"===b?35632:35633,c);F(U,".",b,".push(",c,");");M(U,".",b,".pop();");break;case "framebuffer":z.getFramebuffer(c);b=t("viewport");var d=t("scissor.box");F("if(",la,".push(",D(c&&c._framebuffer),")){",b,".setDirty();",d,".setDirty();","}");M("if(",la,".pop()){",b,".setDirty();",d,".setDirty();","}");break;
case "count":case "offset":case "instances":F(O[b],".push(",c,");");M(O[b],".pop();");break;case "primitive":F(O.primitive,".push(",f[c],");");M(O.primitive,".pop();");break;case "elements":d=g.getElements(c);c=!("primitive"in a);b=!("count"in a);d?(d=D(d),F(Z,".push(",d,");"),c&&F(O.primitive,".push(",d,".primType);"),b&&F(O.count,".push(",d,".vertCount);")):(F(Z,".push(null);"),c&&F(O.primitive,".push(",4,");"),b&&F(O.count,".push(0);"));c&&M(O.primitive,".pop();");b&&M(O.count,".pop();");"offset"in
a||(F(O.offset,".push(0);"),M(O.offset,".pop();"));M(Z,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":ea(b,c);break;case "depth.func":ea(b,k[c]);break;case "depth.range":b=t(b);F(b,".push(",c[0],",",c[1],");");M(b,".pop();");break;case "blend.func":b=t(b);F(b,".push(",p["srcRGB"in c?c.srcRGB:c.src],",",p["dstRGB"in c?c.dstRGB:
c.dst],",",p["srcAlpha"in c?c.srcAlpha:c.src],",",p["dstAlpha"in c?c.dstAlpha:c.dst],");");M(b,".pop();");break;case "blend.equation":b=t(b);"string"===typeof c?F(b,".push(",H[c],",",H[c],");"):"object"===typeof c&&F(b,".push(",H[c.rgb],",",H[c.alpha],");");M(b,".pop();");break;case "blend.color":b=t(b);F(b,".push(",c[0],",",c[1],",",c[2],",",c[3],");");M(b,".pop();");break;case "stencil.mask":b=t(b);F(b,".push(",c,");");M(b,".pop();");break;case "stencil.func":var d=c.cmp||"keep",h=c.ref||0,c="mask"in
c?c.mask:-1;b=t(b);F(b,".push(",k[d],",",h,",",c,");");M(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":d=c.fail||"keep";h=c.zfail||"keep";c=c.pass||"keep";b=t(b);F(b,".push(",l[d],",",l[h],",",l[c],");");M(b,".pop();");break;case "polygonOffset.offset":d=c.factor||0;c=c.units||0;b=t(b);F(b,".push(",d,",",c,");");M(b,".pop();");break;case "cull.face":d=0;"front"===c?d=1028:"back"===c&&(d=1029);c=t(b);F(c,".push(",d,");");M(c,".pop();");break;case "lineWidth":ea(b,c);break;case "frontFace":d=
0;"cw"===c?d=2304:"ccw"===c&&(d=2305);c=t(b);F(c,".push(",d,");");M(c,".pop();");break;case "colorMask":b=t(b);F(b,".push(",c.map(function(a){return!!a}).join(),");");M(b,".pop();");break;case "sample.coverage":d="value"in c?c.value:1;c=!!c.invert;b=t(b);F(b,".push(",d,",",c,");");M(b,".pop();");break;case "viewport":case "scissor.box":var d=c.x||0,h=c.y||0,q=-1,n=-1;"w"in c&&(q=c.w);"h"in c&&(n=c.h);c=t(b);F(c,".push(",d,",",h,",",q,",",n,");");M(c,".pop();")}});Object.keys(b).forEach(function(a){var c=
D(m.def(a));a=b[a];a="function"===typeof a&&a._reglType?D(a):Array.isArray(a)?D(a.slice()):+a;F(c,".push(",a,");");M(c,".pop();")});Object.keys(c).forEach(function(a){var b=c[a],d=D(u.def(a));a=D(u.box(a).alloc(b));F(d,".records.push(",a,");");M(d,".records.pop();")});var N=v.block(),T=v.block(),pa={};Object.keys(q).sort(d).forEach(function(b){var c=I(q[b]);switch(b){case "framebuffer":b=t("viewport");var d=t("scissor.box");N("if(",la,".push(",c,"&&",c,"._framebuffer)){",b,".setDirty();",d,".setDirty();",
"}");T("if(",la,".pop()){",b,".setDirty();",d,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":b=t(b);N(b,".push(",c,");");T(b,".pop();");break;case "count":case "offset":case "instances":b=O[b];N(b,".push(",c,");");T(b,".pop();");break;case "primitive":b=O.primitive;N(b,".push(",ba,"[",c,"]);");T(b,".pop();");
break;case "depth.func":b=t(b);N(b,".push(",ka,"[",c,"]);");T(b,".pop();");break;case "blend.func":b=t(b);d=D(p);N(b,".push(",d,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",d,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",d,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",d,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");T(b,".pop();");break;case "blend.equation":b=t(b);d=D(H);N("if(typeof ",c,'==="string"){',b,".push(",d,"[",c,"],",d,"[",c,"]);","}else{",b,".push(",d,"[",c,".rgb],",d,"[",c,
".alpha]);","}");T(b,".pop();");break;case "blend.color":b=t(b);N(b,".push(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");T(b,".pop();");break;case "stencil.mask":b=t(b);N(b,".push(",c,");");T(b,".pop();");break;case "stencil.func":b=t(b);N(b,".push(",ka,"[",c,".cmp],",c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");T(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":b=t(b);N(b,".push(",qa,"[",c,'.fail||"keep"],',qa,"[",c,'.zfail||"keep"],',qa,"[",c,'.pass||"keep"]);');T(b,".pop();");break;
case "polygonOffset.offset":b=t(b);N(b,".push(",c,".factor||0,",c,".units||0);");T(b,".pop();");break;case "cull.face":b=t(b);N(b,".push(",c,'==="front"?',1028,":",1029,");");T(b,".pop();");break;case "frontFace":b=t(b);N(b,".push(",c,'==="cw"?',2304,":",2305,");");T(b,".pop();");break;case "colorMask":b=t(b);N(b,".push(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");T(b,".pop();");break;case "sample.coverage":b=t(b);N(b,".push(",c,".value,",c,".invert);");T(b,".pop();");break;case "scissor.box":case "viewport":b=
t(b);N(b,".push(",c,".x||0,",c,".y||0,",'"w" in ',c,"?",c,".w:-1,",'"h" in ',c,"?",c,".h:-1);");T(b,".pop();");break;case "elements":b=!("primitive"in q)&&!("primitive"in a);var d=!("count"in q)&&!("count"in a),h=!("offset"in q)&&!("offset"in a),f=N.def();N("if(",c,"){",f,"=",c,"._elements;",Z,".push(",f,");",b?O.primitive+".push("+f+".primType);":"",d?O.count+".push("+f+".vertCount);":"",h?O.offset+".push("+f+".offset);":"","}else{",Z,".push(null);","}");T(Z,".pop();","if(",c,"){",b?O.primitive+
".pop();":"",d?O.count+".pop();":"",h?O.offset+".pop();":"","}")}});Object.keys(n).forEach(function(a){var b=D(m.def(a));a=I(n[a]);N(b,".push(",a,");");T(b,".pop();")});Object.keys(G).forEach(function(a){var b=D(u.def(a)),c=I(G[a]);a=D(u.box(a));N(b,".records.push(",a,".alloc(",c,"));");T(a,".free(",b,".records.pop());")});var da=X("scope"),fa=da.arg(),sa=da.arg();w&&da(ma,"=",fa,";");da(F);w&&da(N);da(sa,"(",fa,",",V,");",w?T:"",M);da=L();L=da.def();a.frag&&a.vert?(fa=a.frag,da(L,"=",D(B.program(e.id(a.vert),
e.id(fa))),";")):da(L,"=",U,".program","(",U,".vert[",U,".vert.length-1]",",",U,".frag[",U,".frag.length-1]",");");fa=X("draw");w&&fa(ma,"=",fa.arg(),";");fa(F,da);w&&fa(N);fa(aa,"();","if(",L,")",L,".draw.call(this",w?","+ma:"",");",w?T:"",M);var na=X("batch"),X=na.arg(),fa=na.arg();w&&na(ma,"=",fa,"[0];");na(F,da);w=D(function(b,c,d){var h=b.batchCache[E];h||(h=b.batchCache[E]=P(b,q,n,G,a));return h.call(this,c,d)});na("if(",L,"){",aa,"();",w,".call(this,",L,",",X,",",fa,");");Object.keys(q).forEach(function(a){(a=
ra[a])&&na(a,".setDirty();")});na("}",M);return v.compile()}}}},{"./constants/primitives.json":7,"./util/codegen":22}],5:[function(e,g,m){g.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],6:[function(e,g,m){g.exports={int8:5120,int16:5122,int32:5124,uint8:5121,
uint16:5123,uint32:5125,"float":5126}},{}],7:[function(e,g,m){g.exports={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],8:[function(e,g,m){g.exports=function(a){return{primitive:[4],count:[-1],offset:[0],instances:[0]}}},{}],9:[function(e,g,m){function a(a,b){this.id=d++;this.type=a;this.data=b}function b(a){if(0===a.length)return[];var c=a.charAt(0),d=a.charAt(a.length-1);if(1<a.length&&c===d&&('"'===c||"'"===c))return['"'+a.substr(1,a.length-
2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(c=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return b(a.substr(0,c.index)).concat(b(c[1])).concat(b(a.substr(c.index+c[0].length)));c=a.split(".");if(1===c.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(d=0;d<c.length;++d)a=a.concat(b(c[d]));return a}function c(a){return"["+b(a).join("][")+"]"}var d=0;g.exports={define:function(b,d){switch(typeof d){case "boolean":case "number":case "string":return new a(b,
c(d+""));case "undefined":return new a(b|128,null)}},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof a},unbox:function(b,d){if(b instanceof a){if(b.type&128)return new a(b.type&-129,c(d))}else if("function"===typeof b)return new a(0,b);return b},accessor:c}},{}],10:[function(e,g,m){var a=e("./util/is-typed-array"),b=e("./util/is-ndarray"),c=e("./constants/primitives.json");g.exports=function(d,h,f){function p(){this.buffer=null;this.primType=4;this.type=this.vertCount=
0}p.prototype.bind=function(){this.buffer.bind()};return{create:function(d){function l(d){var f=h.oes_element_index_uint;if(d)if("number"===typeof d)g(d);else{var k=null,p="static",w=0;Array.isArray(d)||a(d)||b(d)?k=d:("data"in d&&(k=d.data),"usage"in d&&(p=d.usage),"length"in d&&(w=d.length));Array.isArray(k)||b(k)&&"array"===k.dtype||"type"in d?g({type:d.type||(f?"uint32":"uint16"),usage:p,data:k,length:w}):g({usage:p,data:k,length:w});if(Array.isArray(k)||a(k))g.dimension=3}else g();f=e.buffer.byteLength;
k=0;switch(e.buffer.dtype){case 5121:case 5120:k=5121;break;case 5123:case 5122:k=5123;f>>=1;break;case 5125:case 5124:k=5125,f>>=2}p=4;w=e.buffer.dimension;1===w&&(p=0);2===w&&(p=1);3===w&&(p=4);"object"===typeof d&&("primitive"in d&&(p=c[d.primitive]),"count"in d&&(f=d.vertCount|0));e.primType=p;e.vertCount=f;e.type=k;return l}var e=new p,g=f.create(null,34963,!0);e.buffer=g._buffer;l(d);l._reglType="elements";l._elements=e;l.destroy=function(){g.destroy();e.buffer=null};return l},elements:[null],
getElements:function(a){return a&&a._elements instanceof p?a._elements:null}}}},{"./constants/primitives.json":7,"./util/is-ndarray":24,"./util/is-typed-array":25}],11:[function(e,g,m){g.exports=function(a){function b(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(b){try{c[b]=
a.getExtension(b)}catch(h){}})}var c={};b();return{extensions:c,refresh:b}}},{}],12:[function(e,g,m){var a=e("./util/values"),b=e("./util/extend"),c=[1029];g.exports=function(d,h,f,p,k){function l(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function e(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function g(a,b){var c=b.width,d=b.height;if(a.texture)var h=a.texture._texture,k=Math.max(1,h.params.width>>a.level),f=Math.max(1,
h.params.height>>a.level),c=c||k,d=d||f;else h=a.renderbuffer._renderbuffer,c=c||h.width,d=d||h.height;h.refCount+=1;b.width=c;b.height=d}function n(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function r(a){var b=3553,c=0,d=null,h=null;"object"===typeof a&&("level"in a&&(c=a.level|0),"target"in a&&(b=a.target|0));var k=a._reglType;
"texture"===k?d=a:"renderbuffer"===k&&(h=a,b=36161,c=0);return new l(b,c,d,h)}function q(a){return a&&(a.texture||a.renderbuffer)}function y(){this.id=R++;P[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function w(a){d.isFramebuffer(a.framebuffer)||(a.framebuffer=d.createFramebuffer());H=!0;d.bindFramebuffer(36160,a.framebuffer);for(var b=a.colorAttachments,
c=0;c<b.length;++c)n(36064+c,b[c]);for(c=b.length;c<f.maxColorAttachments;++c)n(36064+c,null);n(36096,a.depthAttachment);n(36128,a.stencilAttachment);n(33306,a.depthStencilAttachment);h.webgl_draw_buffers&&h.webgl_draw_buffers.drawBuffersWEBGL(W[b.length]);d.checkFramebufferStatus(36160)}function z(a){a=a.framebuffer;d.isFramebuffer(a)&&d.deleteFramebuffer(a)}function t(){return Q[Q.length-1]}var m={rgba:6408},u={rgba4:32854,rgb565:36194,"rgb5 a1":32855};h.ext_srgb&&(u.srgba=35907);h.ext_color_buffer_half_float&&
(u.rgba16f=34842,u.rgb16f=34843);h.webgl_color_buffer_float&&(u.rgba32f=34836);var B=[],A=[];h.webgl_depth_texture&&(B.push(6402),A.push(34041));b(b({},m),u);a(m);a(u);u=5121;B={uint8:5121};h.oes_texture_half_float&&(u=B["half float"]=36193);h.oes_texture_float&&(u=B["float"]=5126);B.best=u;var W=function(){for(var a=Array(f.maxDrawbuffers),b=0;b<=f.maxDrawbuffers;++b)for(var c=a[b]=Array(b),d=0;d<b;++d)c[d]=36064+d;return a}(),R=0,P={},Q=[null],H=!0;return{top:t,dirty:function(){return H},push:function(a){a=
a||null;H=H||a!==t();Q.push(a);return H},pop:function(){var a=t();Q.pop();return H=H||a!==t()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof y)?a:null},poll:function(){if(H){var a=Q[Q.length-1],b=h.webgl_draw_buffers;a?(d.bindFramebuffer(36160,a.framebuffer),b&&b.drawBuffersWEBGL(W[a.colorAttachments.length])):(d.bindFramebuffer(36160,null),b&&b.drawBuffersWEBGL(c));H=!1}},create:function(a){function b(a){var h,f=a||{},n=a=0;if("shape"in
f){var t=f.shape;a=t[0];n=t[1]}else"radius"in f&&(a=n=f.radius),"width"in f&&(a=f.width),"height"in f&&(n=f.height);var y=null,t=!1;if("colorBuffers"in f||"colorBuffer"in f){y=f.colorBuffers||f.colorBuffer;Array.isArray(y)||(y=[y]);c.width=a;c.height=n;y=y.map(r);for(h=0;h<y.length;++h)g(y[h],c);a=c.width;n=c.height}else{var z=!0,u="rgba",B="uint8",v=1,t=!0;c.width=a=a||d.drawingBufferWidth;c.height=n=n||d.drawingBufferHeight;"format"in f&&(u=f.format,z=u in m);"type"in f&&(B=f.type);"colorCount"in
f&&(v=f.colorCount|0);if(c.ownsColor)for(y=c.colorAttachments;y.length>v;)e(y.pop());else y=[];for(h=0;h<y.length;++h){var D;a:{D=y[h];var A=z,C=u,E=a,aa=n;if(D.texture){var U=D.texture;if(A){U({format:C,type:B,width:E,height:aa});U._texture.refCount+=1;D=!0;break a}}else if(U=D.renderbuffer,!A){U({format:C,width:E,height:aa});U._renderbuffer.refCount+=1;D=!0;break a}e(D);D=!1}D||(y[h--]=y[y.length-1],y.pop())}for(;y.length<v;)z?y.push(new l(3553,0,p.create({format:u,type:B,width:a,height:n},3553),
null)):y.push(new l(36161,0,null,k.create({format:u,width:a,height:n})))}c.width=a;c.height=n;u=z=h=null;B=!1;"depthBuffer"in f&&(h=r(f.depthBuffer));"stencilBuffer"in f&&(z=r(f.stencilBuffer));"depthStencilBuffer"in f&&(u=r(f.depthStencilBuffer));if(h||z||u)g(h||z||u,c);else if(v=!0,A=D=!1,"depth"in f&&(v=!!f.depth),"stencil"in f&&(D=!!f.stencil),"depthTexture"in f&&(A=!!f.depthTexture),f=c.depthAttachment||c.stencilAttachment||c.depthStencilAttachment,C=null,v||D)B=!0,A?(A=D?"depth stencil":"depth",
c.ownsDepthStencil&&f.texture?(f.texture({format:A,width:a,height:n}),f.texture._texture.refCount+=1,C=f):C=new l(3553,0,p.create({format:A,width:a,height:n},3553),null)):(A=v?D?"depth stencil":"depth":"stencil",c.ownsDepthStencil&&f.renderbuffer?(f.renderbuffer({format:A,width:a,height:n}),f.renderbuffer._renderbuffer.refCount+=1,C=f):C=new l(36161,0,null,k.create({format:A,width:a,height:n}))),v?D?u=C:h=C:z=C;a=c;a.colorAttachments.forEach(e);e(a.depthAttachment);e(a.stencilAttachment);e(a.depthStencilAttachment);
c.colorAttachments=y;c.depthAttachment=h;c.stencilAttachment=z;c.depthStencilAttachment=u;c.ownsColor=t;c.ownsDepthStencil=B;b.color=y.map(q);b.depth=q(h);b.stencil=q(z);b.depthStencil=q(u);w(c);b.width=c.width;b.height=c.height;return b}var c=new y;b(a);b._reglType="framebuffer";b._framebuffer=c;b._destroy=function(){z(c)};return b},clear:function(){a(P).forEach(z)},refresh:function(){a(P).forEach(w)}}}},{"./util/extend":23,"./util/values":31}],13:[function(e,g,m){g.exports=function(a,b){var c=1;
b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,h=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),h=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:h,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),
maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),
version:a.getParameter(7938)}}},{}],14:[function(e,g,m){var a=e("./util/is-typed-array");g.exports=function(b,c,d){return function(h){var f=h||{};a(h)?f={data:f}:2===arguments.length?f={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof h&&(f={});c();var p=f.x||0,k=f.y||0,l=f.width||d.width,e=f.height||d.height,f=f.data||new Uint8Array(l*e*4);b.pixelStorei(3333,4);b.readPixels(p,k,l,e,6408,5121,f);return f}}},{"./util/is-typed-array":25}],15:[function(e,g,m){var a=e("./util/values");g.exports=
function(b,c,d){function h(){this.id=l++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function f(a){b.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=b.createRenderbuffer());b.bindRenderbuffer(36161,a.renderbuffer);b.renderbufferStorage(36161,a.format,a.width,a.height)}function p(a){var c=a.renderbuffer;b.bindRenderbuffer(36161,null);b.isRenderbuffer(c)&&b.deleteRenderbuffer(c);a.renderbuffer=null;a.refCount=0;delete e[a.id]}var k={rgba4:32854,rgb565:36194,"rgb5 a1":32855,
depth:33189,stencil:36168,"depth stencil":34041};c.ext_srgb&&(k.srgba=35907);c.ext_color_buffer_half_float&&(k.rgba16f=34842,k.rgb16f=34843);c.webgl_color_buffer_float&&(k.rgba32f=34836);var l=0,e={};h.prototype.decRef=function(){0===--this.refCount&&p(this)};return{create:function(a){function b(a){a=a||{};var d=0,h=0;"shape"in a?(h=a.shape,d=h[0]|0,h=h[1]|0):("radius"in a&&(d=h=a.radius|0),"width"in a&&(d=a.width|0),"height"in a&&(h=a.height|0));b.width=c.width=Math.max(d,1);b.height=c.height=Math.max(h,
1);c.format=32854;"format"in a&&(c.format=k[a.format]);f(c);return b}var c=new h;e[c.id]=c;b(a);b._reglType="renderbuffer";b._renderbuffer=c;b.destroy=function(){c.decRef()};return b},refresh:function(){a(e).forEach(f)},clear:function(){a(e).forEach(p)}}}},{"./util/values":31}],16:[function(e,g,m){function a(a,b,h,f){this.name=a;this.id=b;this.location=h;this.info=f}var b=e("./util/values");g.exports=function(c,d,h,f,p){function k(a,b){var d=35632===a?x:n,f=d[b];if(!f){var h=p.str(b),f=c.createShader(a);
c.shaderSource(f,h);c.compileShader(f);d[b]=f}return f}function e(a,b){this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function g(b){var e,l;e=k(35632,b.fragId);l=k(35633,b.vertId);var n=b.program=c.createProgram();c.attachShader(n,e);c.attachShader(n,l);c.linkProgram(n);var q=c.getProgramParameter(n,35718),r=b.uniforms=[];for(e=0;e<q;++e)if(l=c.getActiveUniform(n,e))if(1<l.size)for(var G=0;G<l.size;++G){var x=l.name.replace("[0]",
"["+G+"]");h.def(x);r.push(new a(x,p.id(x),c.getUniformLocation(n,x),l))}else h.def(l.name),r.push(new a(l.name,p.id(l.name),c.getUniformLocation(n,l.name),l));q=c.getProgramParameter(n,35721);r=b.attributes=[];for(e=0;e<q;++e)if(l=c.getActiveAttrib(n,e))d.def(l.name),r.push(new a(l.name,p.id(l.name),c.getAttribLocation(n,l.name),l));b.draw=f(b);b.batchCache={}}var x={},n={},r={},q=[];return{clear:function(){var a=c.deleteShader.bind(c);b(x).forEach(a);x={};b(n).forEach(a);n={};q.forEach(function(a){c.deleteProgram(a.program)});
q.length=0;r={}},refresh:function(){x={};n={};q.forEach(g)},program:function(a,b){var c=r[b];c||(c=r[b]={});var d=c[a];d||(d=new e(b,a),g(d),c[a]=d,q.push(d));return d},shader:k,frag:[-1],vert:[-1]}}},{"./util/values":31}],17:[function(e,g,m){var a=e("./util/stack"),b=e("./util/codegen");g.exports=function(c,d,h){function f(b,d){var f=a([!!d],function(a){a?c.enable(b):c.disable(b)});f.flag=b;return f}var p={dither:f(3024),"blend.enable":f(3042),"blend.color":a([0,0,0,0],function(a,b,d,f){c.blendColor(a,
b,d,f)}),"blend.equation":a([32774,32774],function(a,b){c.blendEquationSeparate(a,b)}),"blend.func":a([1,0,1,0],function(a,b,d,f){c.blendFuncSeparate(a,b,d,f)}),"depth.enable":f(2929,!0),"depth.func":a([513],function(a){c.depthFunc(a)}),"depth.range":a([0,1],function(a,b){c.depthRange(a,b)}),"depth.mask":a([!0],function(a){c.depthMask(a)}),"cull.enable":f(2884),"cull.face":a([1029],function(a){c.cullFace(a)}),frontFace:a([2305],function(a){c.frontFace(a)}),colorMask:a([!0,!0,!0,!0],function(a,b,d,
f){c.colorMask(a,b,d,f)}),lineWidth:a([1],function(a){c.lineWidth(a)}),"polygonOffset.enable":f(32823),"polygonOffset.offset":a([0,0],function(a,b){c.polygonOffset(a,b)}),"sample.alpha":f(32926),"sample.enable":f(32928),"sample.coverage":a([1,!1],function(a,b){c.sampleCoverage(a,b)}),"stencil.enable":f(2960),"stencil.mask":a([-1],function(a){c.stencilMask(a)}),"stencil.func":a([519,0,-1],function(a,b,d){c.stencilFunc(a,b,d)}),"stencil.opFront":a([7680,7680,7680],function(a,b,d){c.stencilOpSeparate(1028,
a,b,d)}),"stencil.opBack":a([7680,7680,7680],function(a,b,d){c.stencilOpSeparate(1029,a,b,d)}),"scissor.enable":f(3089),"scissor.box":a([0,0,-1,-1],function(a,b,f,h){var k=f,p=d.top();0>f&&(k=p?p.width-a:c.drawingBufferWidth-a);f=h;0>h&&(f=p?p.height-b:c.drawingBufferHeight-b);c.scissor(a,b,k,f)}),viewport:a([0,0,-1,-1],function(a,b,f,k){var p=f,l=d.top();0>f&&(p=l?l.width-a:c.drawingBufferWidth-a);f=k;0>k&&(f=l?l.height-b:c.drawingBufferHeight-b);c.viewport(a,b,p,f);h.width=p;h.height=f})},k=b(),
l=k.proc("poll"),e=k.proc("refresh");Object.keys(p).forEach(function(a){a=k.link(p[a]);l(a,".poll();");e(a,".setDirty();")});var g=k.compile();return{contextState:p,viewport:h,poll:g.poll,refresh:g.refresh,notifyViewportChanged:function(){p.viewport.setDirty();p["scissor.box"].setDirty()}}}},{"./util/codegen":22,"./util/stack":29}],18:[function(e,g,m){g.exports=function(){var a={"":0},b=[""];return{id:function(c){var d=a[c];if(d)return d;d=a[c]=b.length;b.push(c);return d},str:function(a){return b[a]}}}},
{}],19:[function(e,g,m){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function b(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var c=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==c)return!1;return!0}function c(a){return Object.prototype.toString.call(a)}function d(a){return"[object HTMLCanvasElement]"===c(a)}function h(a){return"[object CanvasRenderingContext2D]"===c(a)}var f=e("./util/extend"),p=e("./util/values"),
k=e("./util/is-typed-array"),l=e("./util/is-ndarray"),G=e("./util/load-texture"),x=e("./util/to-half-float"),n=e("./util/parse-dds"),r=[9984,9986,9985,9987];g.exports=function(e,g,w,m,t){function K(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=
this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function u(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function B(a,b){var c,d,f=0,h=0,k=0,e=0,p=0,l=0,g=!1,n=!1,G=!1;for(c=0;c<b.length;++c)d=b[c],e=e||d.width<<d.miplevel,p=p||d.height<<d.miplevel,f=f||d.type,h=h||d.format,k=k||d.internalformat,
l=l||d.channels,g=g||d.needsPoll,n=n||d.needsListeners,d=d.miplevel,G=G||0<d;a.needsPoll=g;a.needsListeners=n;a.width=e;a.height=p;a.format=h;a.internalformat=k;a.type=f;if(3553!==a.target)for(c=0;6>c;++c);c=0<=r.indexOf(a.minFilter);a.genMipmaps=!G&&(a.genMipmaps||c);G=G||a.genMipmaps;a.minFilter||(a.minFilter=G?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=l),d.format||(d.format=h),d.internalformat||(d.internalformat=k),d.type||(d.type=
f)}function A(a){this.id=v++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new u(a);this.pixels=[]}function W(a,b){function c(a,d){var f=d.mipmap,k;if(Array.isArray(f))for(var e=0;e<f.length;++e)k=new K(a),k.parseFlags(b),k.parseFlags(d),k.parse(f[e],e),h.push(k);else k=new K(a),k.parseFlags(b),k.parse(d,0),h.push(k)}var d;Q(a);var f=a.params;u.call(f,a.target);var h=a.pixels;h.length=0;f.parse(b);if(3553===a.target)c(3553,
b);else{var k=b.faces||b;if(Array.isArray(k))for(d=0;6>d;++d)c(34069+d,k[d]);else if("string"!==typeof k)for(d=0;6>d;++d)c(34069+d,{})}B(f,h);f.needsListeners&&P(a);f.needsPoll&&(a.pollId=L.length,L.push(a));R(a)}function R(a){e.isTexture(a.texture)||(a.texture=e.createTexture());var b=a.target,c=a.unit;0<=c?(e.activeTexture(33984+c),I=c):e.bindTexture(b,a.texture);for(var b=a.pixels,d=a.params,f=0;f<b.length;++f)b[f].upload(d);d.upload();0>c&&((c=E[I])?e.bindTexture(c.target,c.texture):(a.unit=I,
E[I]=a))}function P(a){function b(a,c,d){var h=n(d);h.pixels.forEach(function(b){var d=new K(h.cube?b.target:a);d.channels=h.channels;d.compressed=h.compressed;d.type=h.type;d.internalformat=h.format;d.format=ea[h.format];d.width=b.width;d.height=b.height;d.miplevel=b.miplevel||c;d.data=b.data;f.push(d)})}function c(){for(var h=0;h<f.length;++h){var k=f[h],e=k.image,p=k.video,l=k.xhr;e&&e.complete?(k.width=e.naturalWidth,k.height=e.naturalHeight):p&&2<p.readyState?(k.width=p.width,k.height=p.height):
l&&4===l.readyState&&(f[h]=f[f.length-1],f.pop(),l.removeEventListener("readystatechange",R),b(k.target,k.miplevel,l.response))}B(d,f);R(a)}var d=a.params,f=a.pixels;f.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){f.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",
c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function Q(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((L[b]=L[L.length-1]).id=b,L.pop(),a.pollId=-1)}function H(a){var b=a.texture,c=a.unit,d=a.target;0<=c&&(e.activeTexture(33984+c),I=c,e.bindTexture(d,null),E[c]=null);Q(a);e.isTexture(b)&&e.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete D[a.id]}var C={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
S={repeat:10497,clamp:33071,mirror:33648},ha={nearest:9728,linear:9729},J=f({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ha),ia={none:0,browser:37444},ca={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ga={};g.ext_srgb&&(Y.srgb=35904,Y.srgba=35906);g.oes_texture_float&&(ca["float"]=5126);g.oes_texture_half_float&&
(ca["half float"]=36193);g.webgl_depth_texture&&(f(Y,{depth:6402,"depth stencil":34041}),f(ca,{uint16:5123,uint32:5125,"depth stencil":34042}));g.webgl_compressed_texture_s3tc&&f(ga,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});g.webgl_compressed_texture_atc&&f(ga,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});g.webgl_compressed_texture_pvrtc&&f(ga,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});g.webgl_compressed_texture_etc1&&(ga["rgb etc1"]=36196);var oa=Array.prototype.slice.call(e.getParameter(34467));Object.keys(ga).forEach(function(a){var b=ga[a];0<=oa.indexOf(b)&&(Y[a]=b)});var ja=Object.keys(Y);w.textureFormats=ja;var ea=ja.reduce(function(a,b){var c=Y[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});f(K.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=ia[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=Y[b];b in ca&&(this.type=ca[b]);b in ga&&(this.compressed=!0)}"type"in a&&(this.type=ca[a.type]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=
a.width),"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(f,e){this.miplevel=e;this.width>>=e;this.height>>=e;var p=f;switch(typeof f){case "object":if(!f)return;
this.parseFlags(f);var g=f.data;if("string"===typeof g||g&&(k(g)||a(g)||l(g)||d(g)||h(g)||"[object HTMLImageElement]"===c(g)||"[object HTMLVideoElement]"===c(g)||b(g)))p=f.data;break;case "undefined":return}"string"===typeof p&&(p=G(p,this.crossOrigin));var g=null,n=!1;if(null!==p)if(k(p))this.data=p;else if(a(p))g=p,n=!0;else if(l(p)){Array.isArray(p.data)?(g=p.data,n=!0):this.data=p.data;var q=p.shape;this.width=q[0];this.height=q[1];this.channels=3===q.length?q[2]:1;q=p.stride;this.strideX=p.stride[0];
this.strideY=p.stride[1];this.strideC=3===q.length?p.stride[2]:1;this.offset=p.offset;this.needsTranspose=!0}else if(d(p)||h(p))d(p)?this.canvas=p:this.canvas=p.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===c(p))this.image=p,p.complete?(this.width=p.naturalWidth,this.height=p.naturalHeight):(this.width=this.width||p.naturalWidth,this.height=this.height||p.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===c(p))this.video=p,1<p.readyState?(this.width=p.width,this.height=p.height):(this.width=this.width||p.width,this.height=this.height||p.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===c(p))this.xhr=p,this.needsListeners=!0;else if(b(p)){var n=p[0].length,q=p.length,r=1,u,v,w,y;if(Array.isArray(p[0][0]))for(r=p[0][0].length,g=Array(n*q*r),v=y=0;v<q;++v)for(u=0;u<n;++u)for(w=0;w<r;++w)g[y++]=p[v][u][w];
else for(g=Array(n*q),v=y=0;v<q;++v)for(u=0;u<n;++u)g[y++]=p[v][u];this.width=n;this.height=q;this.channels=r;n=!0}else f.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||t.width)|0,this.height=(this.height||t.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,
6410,6407,6408][(this.channels=this.channels||4)-1]);p=this.internalformat;q=this.format=ea[p];if(!this.channels)switch(q){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}q=this.type;5126!==q&&36193!==q&&(q||(q=6402===p?5125:5121));this.type=q;if(n)switch(q){case 5121:this.data=new Uint8Array(g);break;case 5123:this.data=new Uint16Array(g);break;case 5125:this.data=new Uint32Array(g);break;case 5126:this.data=
new Float32Array(g);break;case 36193:this.data=x(g)}if(this.data&&this.needsTranspose){g=this.data;p=this.width;n=this.height;q=this.channels;r=this.strideX;u=this.strideY;v=this.strideC;w=this.offset;y=new g.constructor(p*n*q);for(var m=0,z=0;z<n;++z)for(var A=0;A<p;++A)for(var B=0;B<q;++B)y[m++]=g[u*z+r*A+v*B+w];this.data=y}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){e.pixelStorei(37440,
this.flipY);e.pixelStorei(37441,this.premultiplyAlpha);e.pixelStorei(37443,this.colorSpace);e.pixelStorei(3317,this.unpackAlignment);var b=this.target,c=this.miplevel,d=this.image,f=this.canvas,h=this.video,k=this.data,p=this.internalformat,l=this.format,g=this.type,n=this.width||Math.max(1,a.width>>c);a=this.height||Math.max(1,a.height>>c);h&&2<h.readyState?e.texImage2D(b,c,l,l,g,h):d&&d.complete?e.texImage2D(b,c,l,l,g,d):f?e.texImage2D(b,c,l,l,g,f):this.compressed?e.compressedTexImage2D(b,c,p,n,
a,0,k):this.copy?(m(),e.copyTexImage2D(b,c,l,this.x,this.y,n,a,0)):k?e.texImage2D(b,c,l,n,a,0,l,g,k):e.texImage2D(b,c,l,n||1,a||1,0,l,g,null)}});f(u.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=J[a.min]);"mag"in a&&(this.magFilter=ha[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=S[d]:Array.isArray(d)&&(b=S[d[0]],c=S[d[1]])}else"wrapS"in a&&(b=S[a.wrapS]),"wrapT"in a&&(c=S[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=C[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;e.texParameteri(a,10241,this.minFilter);e.texParameteri(a,10240,this.magFilter);e.texParameteri(a,10242,this.wrapS);e.texParameteri(a,10243,this.wrapT);g.ext_texture_filter_anisotropic&&e.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(e.hint(33170,this.mipmapHint),e.generateMipmap(a))}});
var I=0,v=0,D={},L=[],X=w.maxTextureUnits,E=Array(X).map(function(){return null});f(A.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<X;++b){var c=E[b];if(c){if(0<c.bindCount)continue;c.unit=-1}E[b]=this;a=b;break}this.unit=a;e.activeTexture(33984+a);e.bindTexture(this.target,this.texture);I=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&H(this)}});return{create:function(a,b){function c(a,f,h,k,p,e){var l=a||{};34067===b&&
6===arguments.length&&(l=[a,f,h,k,p,e]);W(d,l);c.width=d.params.width;c.height=d.params.height;return c}var d=new A(b);D[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){p(D).forEach(R);for(var a=0;a<X;++a)E[a]=null;I=0;e.activeTexture(33984)},clear:function(){for(var a=0;a<X;++a)e.activeTexture(33984+a),e.bindTexture(3553,null),E[a]=null;e.activeTexture(33984);I=0;p(D).forEach(H)},poll:function(){L.forEach(R)},getTexture:function(a){return null}}}},
{"./util/extend":23,"./util/is-ndarray":24,"./util/is-typed-array":25,"./util/load-texture":26,"./util/parse-dds":27,"./util/to-half-float":30,"./util/values":31}],20:[function(e,g,m){g.exports=function(a){var b={};return{def:function(c){c=a.id(c);var d=b[c];d||(d=b[c]=[]);return d},uniforms:b}}},{}],21:[function(e,g,m){g.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(e,g,m){var a=e("./extend");g.exports=
function(){function b(){var b=[],d=[];return a(function(){b.push.apply(b,Array.prototype.slice.call(arguments))},{def:function(){var a="v"+c++;d.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,Array.prototype.slice.call(arguments)),b.push(";"));return a},toString:function(){return[0<d.length?"var "+d+";":"",b.join("")].join("")}})}var c=0,d=[],h=[],f={};return{link:function(a){var b="g"+c++;d.push(b);h.push(a);return b},block:b,proc:function(d){var h=[],e=b(),g=e.toString;return f[d]=a(e,
{arg:function(){var a="a"+c++;h.push(a);return a},toString:function(){return["function(",h.join(),"){",g(),"}"].join("")}})},compile:function(){var a=['"use strict";return {'];Object.keys(f).forEach(function(b){a.push('"',b,'":',f[b].toString(),",")});a.push("}");return Function.apply(null,d.concat([a.join("")])).apply(null,h)}}}},{"./extend":23}],23:[function(e,g,m){g.exports=function(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d)a[c[d]]=b[c[d]];return a}},{}],24:[function(e,g,m){var a=e("./is-typed-array");
g.exports=function(b){return!!b&&"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":25}],25:[function(e,g,m){var a=e("../constants/arraytypes.json");g.exports=function(b){return Object.prototype.toString.call(b)in a}},{"../constants/arraytypes.json":5}],26:[function(e,g,m){g.exports=function(a,b){if("undefined"!==typeof document){var c;c=(c=/\.(\w+)(\?.*)?$/.exec(a))&&
c[1]?c[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(c))return c=document.createElement("video"),c.autoplay=!0,c.loop=!0,b&&(c.crossOrigin=b),c.src=a,c;if(0<=["dds"].indexOf(c))return c=new XMLHttpRequest,c.responseType="arraybuffer",c.open("GET",a,!0),c.send(),c;c=new Image;b&&(c.crossOrigin=b);c.src=a;return c}return null}},{}],27:[function(e,g,m){g.exports=function(e){function g(a){for(var b=C,c=S,d=0;d<Y;++d){var f=Math.max(1,
b+3>>2)*Math.max(1,c+3>>2)*ia;oa.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(e,ga,f)});ga+=f;b>>=1;c>>=1}}var m=new Int32Array(e),H=m[z],C=m[K],S=m[t],ha=k,J=0,ia=0,ca=4;switch(m[A]){case n:ia=8;H&x?(ca=3,J=c):J=d;break;case r:ia=16;J=h;break;case q:ia=16;J=f;break;case y:ia=8,J=p}var Y=1;m[B]&l&&(Y=Math.max(1,m[u]));var ga=m[w]+4,oa={width:C,height:S,channels:ca,format:J,type:ha,compressed:!0,cube:!1,pixels:[]};if(m[W]&G)for(oa.cube=!0,m=0;6>m;++m)g(b+m);else g(a);return oa};
var a=3553,b=34069,c=33776,d=33777,h=33778,f=33779,p=36196,k=5121,l=131072,G=512,x=64,n=827611204,r=861165636,q=894720068,y=826496069,w=1,z=2,t=3,K=4,u=7,B=20,A=21,W=28},{}],28:[function(e,g,m){g.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,30)},cancel:clearTimeout}},{}],29:[function(e,g,m){g.exports=function(a,b){var c=
a.length,d=a.slice(),h=a.slice(),f=!1,p=!0;return{push:function(){f=!1;for(var a=0;a<c;++a){var b=arguments[a];f=f||b!==h[a];d.push(b)}},pop:function(){f=!1;d.length-=c;for(var a=0;a<c;++a)f=f||d[d.length-c+a]!==h[a]},poll:function(){var a=d.length-c;if(f||p){switch(c){case 1:b(d[a]);break;case 2:b(d[a],d[a+1]);break;case 3:b(d[a],d[a+1],d[a+2]);break;case 4:b(d[a],d[a+1],d[a+2],d[a+3]);break;case 5:b(d[a],d[a+1],d[a+2],d[a+3],d[a+4]);break;case 6:b(d[a],d[a+1],d[a+2],d[a+3],d[a+4],d[a+5]);break;
default:b.apply(null,d.slice(a,d.length))}for(var e=0;e<c;++e)h[e]=d[a+e];p=f=!1}},setDirty:function(){p=!0}}}},{}],30:[function(e,g,m){g.exports=function(a){for(var b=new Float32Array(a),b=new Uint32Array(b.buffer),c=new Uint16Array(a.length),d=0;d<a.length;++d)if(isNaN(a[d]))c[d]=65535;else if(Infinity===a[d])c[d]=31744;else if(-Infinity===a[d])c[d]=64512;else{var h=b[d],f=h>>>31<<15,e=(h<<1>>>24)-127,h=h>>13&1023;c[d]=-24>e?f:-14>e?f+(h+1024>>-14-e):15<e?f+31744:f+(e+15<<10)+h}return c}},{}],31:[function(e,
g,m){g.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},{}],32:[function(e,g,m){function a(a,h){function f(){var b=window.innerWidth,f=window.innerHeight;a!==document.body&&(f=a.getBoundingClientRect(),b=f.right-f.left,f=f.top-f.bottom);e.width=l*b;e.height=l*f;c(e.style,{width:b+"px",height:f+"px"})}var e=document.createElement("canvas"),k=b(e,h);c(e.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(e);a===document.body&&(e.style.position="absolute",c(a.style,
{margin:0,padding:0}));var l=+k.options.pixelRatio;window.addEventListener("resize",f,!1);var g=k.options.onDestroy;k.options=c(c({},k.options),{onDestroy:function(){window.removeEventListener("resize",f);a.removeChild(e);g&&g()}});f();return k}function b(a,b){function f(b){try{return a.getContext(b,e)}catch(c){return null}}var e=b.glOptions||{};return{gl:f("webgl")||f("experimental-webgl")||f("webgl-experimental"),options:c({pixelRatio:window.devicePixelRatio},b)}}var c=e("./util/extend");g.exports=
function(d){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:d[0],options:d[1]||{}};var h=document.body,f=d[1]||{};if("string"===typeof d[0])h=document.querySelector(d[0])||document.body;else if("object"===typeof d[0])if(d[0]instanceof HTMLElement)h=d[0];else{if(d[0]instanceof WebGLRenderingContext)return{gl:d[0],options:c({pixelRatio:1},f)};f=d[0]}return h.nodeName&&"CANVAS"===h.nodeName.toUpperCase()?b(h,f):a(h,f)}},{"./util/extend":23}],33:[function(e,g,m){g.exports=
function(a,b){var c=b[0],d=b[1],h=b[2],f=b[3],e=b[4],k=b[5],l=b[6],g=b[7],x=b[8],n=b[9],r=b[10],q=b[11],m=b[12],w=b[13],z=b[14],t=b[15];a[0]=k*(r*t-q*z)-n*(l*t-g*z)+w*(l*q-g*r);a[1]=-(d*(r*t-q*z)-n*(h*t-f*z)+w*(h*q-f*r));a[2]=d*(l*t-g*z)-k*(h*t-f*z)+w*(h*g-f*l);a[3]=-(d*(l*q-g*r)-k*(h*q-f*r)+n*(h*g-f*l));a[4]=-(e*(r*t-q*z)-x*(l*t-g*z)+m*(l*q-g*r));a[5]=c*(r*t-q*z)-x*(h*t-f*z)+m*(h*q-f*r);a[6]=-(c*(l*t-g*z)-e*(h*t-f*z)+m*(h*g-f*l));a[7]=c*(l*q-g*r)-e*(h*q-f*r)+x*(h*g-f*l);a[8]=e*(n*t-q*w)-x*(k*t-g*
w)+m*(k*q-g*n);a[9]=-(c*(n*t-q*w)-x*(d*t-f*w)+m*(d*q-f*n));a[10]=c*(k*t-g*w)-e*(d*t-f*w)+m*(d*g-f*k);a[11]=-(c*(k*q-g*n)-e*(d*q-f*n)+x*(d*g-f*k));a[12]=-(e*(n*z-r*w)-x*(k*z-l*w)+m*(k*r-l*n));a[13]=c*(n*z-r*w)-x*(d*z-h*w)+m*(d*r-h*n);a[14]=-(c*(k*z-l*w)-e*(d*z-h*w)+m*(d*l-h*k));a[15]=c*(k*r-l*n)-e*(d*r-h*n)+x*(d*l-h*k);return a}},{}],34:[function(e,g,m){g.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];
b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}},{}],35:[function(e,g,m){g.exports=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],36:[function(e,g,m){g.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=
1;return a}},{}],37:[function(e,g,m){g.exports=function(a){var b=a[0],c=a[1],d=a[2],h=a[3],f=a[4],e=a[5],k=a[6],l=a[7],g=a[8],m=a[9],n=a[10],r=a[11],q=a[12],y=a[13],w=a[14];a=a[15];return(b*e-c*f)*(n*a-r*w)-(b*k-d*f)*(m*a-r*y)+(b*l-h*f)*(m*w-n*y)+(c*k-d*e)*(g*a-r*q)-(c*l-h*e)*(g*w-n*q)+(d*l-h*k)*(g*y-m*q)}},{}],38:[function(e,g,m){g.exports=function(a,b){var c=b[0],d=b[1],h=b[2],f=b[3],e=c+c,k=d+d,l=h+h,c=c*e,g=d*e,d=d*k,m=h*e,n=h*k,h=h*l,e=f*e,k=f*k,f=f*l;a[0]=1-d-h;a[1]=g+f;a[2]=m-k;a[3]=0;a[4]=
g-f;a[5]=1-c-h;a[6]=n+e;a[7]=0;a[8]=m+k;a[9]=n-e;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],39:[function(e,g,m){g.exports=function(a,b,c){var d=b[0],h=b[1],f=b[2],e=b[3],k=d+d,l=h+h,g=f+f;b=d*k;var m=d*l,d=d*g,n=h*l,h=h*g,f=f*g,k=e*k,l=e*l,e=e*g;a[0]=1-(n+f);a[1]=m+e;a[2]=d-l;a[3]=0;a[4]=m-e;a[5]=1-(b+f);a[6]=h+k;a[7]=0;a[8]=d+l;a[9]=h-k;a[10]=1-(b+n);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}},{}],40:[function(e,g,m){g.exports=function(a,b,c,d,h,f,e){var k=
1/(c-b),g=1/(h-d),m=1/(f-e);a[0]=2*f*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*f*g;a[6]=0;a[7]=0;a[8]=(c+b)*k;a[9]=(h+d)*g;a[10]=(e+f)*m;a[11]=-1;a[12]=0;a[13]=0;a[14]=e*f*2*m;a[15]=0;return a}},{}],41:[function(e,g,m){g.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],42:[function(e,g,m){g.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),
invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":33,
"./clone":34,"./copy":35,"./create":36,"./determinant":37,"./fromQuat":38,"./fromRotationTranslation":39,"./frustum":40,"./identity":41,"./invert":43,"./lookAt":44,"./multiply":45,"./ortho":46,"./perspective":47,"./perspectiveFromFieldOfView":48,"./rotate":49,"./rotateX":50,"./rotateY":51,"./rotateZ":52,"./scale":53,"./str":54,"./translate":55,"./transpose":56}],43:[function(e,g,m){g.exports=function(a,b){var c=b[0],d=b[1],h=b[2],f=b[3],e=b[4],k=b[5],g=b[6],m=b[7],x=b[8],n=b[9],r=b[10],q=b[11],y=
b[12],w=b[13],z=b[14],t=b[15],K=c*k-d*e,u=c*g-h*e,B=c*m-f*e,A=d*g-h*k,W=d*m-f*k,R=h*m-f*g,P=x*w-n*y,Q=x*z-r*y,H=x*t-q*y,C=n*z-r*w,S=n*t-q*w,ha=r*t-q*z,J=K*ha-u*S+B*C+A*H-W*Q+R*P;if(!J)return null;J=1/J;a[0]=(k*ha-g*S+m*C)*J;a[1]=(h*S-d*ha-f*C)*J;a[2]=(w*R-z*W+t*A)*J;a[3]=(r*W-n*R-q*A)*J;a[4]=(g*H-e*ha-m*Q)*J;a[5]=(c*ha-h*H+f*Q)*J;a[6]=(z*B-y*R-t*u)*J;a[7]=(x*R-r*B+q*u)*J;a[8]=(e*S-k*H+m*P)*J;a[9]=(d*H-c*S-f*P)*J;a[10]=(y*W-w*B+t*K)*J;a[11]=(n*B-x*W-q*K)*J;a[12]=(k*Q-e*C-g*P)*J;a[13]=(c*C-d*Q+h*P)*
J;a[14]=(w*u-y*A-z*K)*J;a[15]=(x*A-n*u+r*K)*J;return a}},{}],44:[function(e,g,m){var a=e("./identity");g.exports=function(b,c,d,e){var f,g,k,l,m,x,n,r,q=c[0],y=c[1];c=c[2];k=e[0];l=e[1];g=e[2];n=d[0];e=d[1];f=d[2];if(1E-6>Math.abs(q-n)&&1E-6>Math.abs(y-e)&&1E-6>Math.abs(c-f))return a(b);d=q-n;e=y-e;n=c-f;r=1/Math.sqrt(d*d+e*e+n*n);d*=r;e*=r;n*=r;f=l*n-g*e;g=g*d-k*n;k=k*e-l*d;(r=Math.sqrt(f*f+g*g+k*k))?(r=1/r,f*=r,g*=r,k*=r):k=g=f=0;l=e*k-n*g;m=n*f-d*k;x=d*g-e*f;(r=Math.sqrt(l*l+m*m+x*x))?(r=1/r,l*=
r,m*=r,x*=r):x=m=l=0;b[0]=f;b[1]=l;b[2]=d;b[3]=0;b[4]=g;b[5]=m;b[6]=e;b[7]=0;b[8]=k;b[9]=x;b[10]=n;b[11]=0;b[12]=-(f*q+g*y+k*c);b[13]=-(l*q+m*y+x*c);b[14]=-(d*q+e*y+n*c);b[15]=1;return b}},{"./identity":41}],45:[function(e,g,m){g.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],k=b[4],l=b[5],m=b[6],x=b[7],n=b[8],r=b[9],q=b[10],y=b[11],w=b[12],z=b[13],t=b[14];b=b[15];var K=c[0],u=c[1],B=c[2],A=c[3];a[0]=K*d+u*k+B*n+A*w;a[1]=K*e+u*l+B*r+A*z;a[2]=K*f+u*m+B*q+A*t;a[3]=K*g+u*x+B*y+A*b;K=c[4];u=
c[5];B=c[6];A=c[7];a[4]=K*d+u*k+B*n+A*w;a[5]=K*e+u*l+B*r+A*z;a[6]=K*f+u*m+B*q+A*t;a[7]=K*g+u*x+B*y+A*b;K=c[8];u=c[9];B=c[10];A=c[11];a[8]=K*d+u*k+B*n+A*w;a[9]=K*e+u*l+B*r+A*z;a[10]=K*f+u*m+B*q+A*t;a[11]=K*g+u*x+B*y+A*b;K=c[12];u=c[13];B=c[14];A=c[15];a[12]=K*d+u*k+B*n+A*w;a[13]=K*e+u*l+B*r+A*z;a[14]=K*f+u*m+B*q+A*t;a[15]=K*g+u*x+B*y+A*b;return a}},{}],46:[function(e,g,m){g.exports=function(a,b,c,d,e,f,g){var k=1/(b-c),l=1/(d-e),m=1/(f-g);a[0]=-2*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*l;a[6]=0;a[7]=
0;a[8]=0;a[9]=0;a[10]=2*m;a[11]=0;a[12]=(b+c)*k;a[13]=(e+d)*l;a[14]=(g+f)*m;a[15]=1;return a}},{}],47:[function(e,g,m){g.exports=function(a,b,c,d,e){b=1/Math.tan(b/2);var f=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*f;a[15]=0;return a}},{}],48:[function(e,g,m){g.exports=function(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*
Math.PI/180);var k=2/(g+b),l=2/(e+f);a[0]=k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=l;a[6]=0;a[7]=0;a[8]=-((g-b)*k*.5);a[9]=(e-f)*l*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a}},{}],49:[function(e,g,m){g.exports=function(a,b,c,d){var e=d[0],f=d[1];d=d[2];var g=Math.sqrt(e*e+f*f+d*d),k,l,m,x,n,r,q,y,w,z,t,K,u,B,A,W,R,P,Q,H;if(1E-6>Math.abs(g))return null;g=1/g;e*=g;f*=g;d*=g;k=Math.sin(c);l=Math.cos(c);m=1-l;c=b[0];g=b[1];x=b[2];n=b[3];r=b[4];q=b[5];y=b[6];w=b[7];z=b[8];t=b[9];
K=b[10];u=b[11];B=e*e*m+l;A=f*e*m+d*k;W=d*e*m-f*k;R=e*f*m-d*k;P=f*f*m+l;Q=d*f*m+e*k;H=e*d*m+f*k;e=f*d*m-e*k;f=d*d*m+l;a[0]=c*B+r*A+z*W;a[1]=g*B+q*A+t*W;a[2]=x*B+y*A+K*W;a[3]=n*B+w*A+u*W;a[4]=c*R+r*P+z*Q;a[5]=g*R+q*P+t*Q;a[6]=x*R+y*P+K*Q;a[7]=n*R+w*P+u*Q;a[8]=c*H+r*e+z*f;a[9]=g*H+q*e+t*f;a[10]=x*H+y*e+K*f;a[11]=n*H+w*e+u*f;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],50:[function(e,g,m){g.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],k=
b[7],l=b[8],m=b[9],x=b[10],n=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+l*d;a[5]=f*c+m*d;a[6]=g*c+x*d;a[7]=k*c+n*d;a[8]=l*c-e*d;a[9]=m*c-f*d;a[10]=x*c-g*d;a[11]=n*c-k*d;return a}},{}],51:[function(e,g,m){g.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],k=b[3],l=b[8],m=b[9],x=b[10],n=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-l*
d;a[1]=f*c-m*d;a[2]=g*c-x*d;a[3]=k*c-n*d;a[8]=e*d+l*c;a[9]=f*d+m*c;a[10]=g*d+x*c;a[11]=k*d+n*c;return a}},{}],52:[function(e,g,m){g.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],k=b[3],l=b[4],m=b[5],x=b[6],n=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+l*d;a[1]=f*c+m*d;a[2]=g*c+x*d;a[3]=k*c+n*d;a[4]=l*c-e*d;a[5]=m*c-f*d;a[6]=x*c-g*d;a[7]=n*c-k*d;return a}},{}],53:[function(e,g,m){g.exports=function(a,
b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],54:[function(e,g,m){g.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],55:[function(e,g,m){g.exports=function(a,
b,c){var d=c[0],e=c[1];c=c[2];var f,g,k,l,m,x,n,r,q,y,w,z;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],g=b[1],k=b[2],l=b[3],m=b[4],x=b[5],n=b[6],r=b[7],q=b[8],y=b[9],w=b[10],z=b[11],a[0]=f,a[1]=g,a[2]=k,a[3]=l,a[4]=m,a[5]=x,a[6]=n,a[7]=r,a[8]=q,a[9]=y,a[10]=w,a[11]=z,a[12]=f*d+m*e+q*c+b[12],a[13]=g*d+x*e+y*c+b[13],a[14]=k*d+n*e+w*c+b[14],a[15]=l*d+r*e+z*c+b[15]);return a}},{}],56:[function(e,g,
m){g.exports=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],k=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=k}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],57:[function(e,g,m){function a(a,c,d,e){e[0]=b(255*a);e[1]=b(255*c);e[2]=b(255*d)}var b=Math.round,c=Math.min,d=Math.max,
h=Math.ceil;g.exports=function(b,e,g,l){l=l||[0,0,0];b%=360;e=d(0,c(e,1));g=d(0,c(g,1));if(e){e=(1-e)*g;var m=g-e,x=b%60;switch(b/60|0){case 0:a(g,m*b/60+e,e,l);break;case 1:a(m*(60-x)/60+e,g,e,l);break;case 2:a(e,g,m*x/60+e,l);break;case 3:a(e,m*(60-x)/60+e,g,l);break;case 4:a(m*x/60+e,e,g,l);break;case 5:a(g,e,m*(60-x)/60+e,l)}}else l[0]=l[1]=l[2]=h(255*g);return l}},{}],58:[function(e,g,m){var a=e("./lib/util/extend"),b=e("./lib/webgl"),c=e("./lib/strings"),d=e("./lib/extension"),h=e("./lib/limits"),
f=e("./lib/buffer"),p=e("./lib/elements"),k=e("./lib/texture"),l=e("./lib/renderbuffer"),G=e("./lib/framebuffer"),x=e("./lib/uniform"),n=e("./lib/attribute"),r=e("./lib/shader"),q=e("./lib/draw"),y=e("./lib/state"),w=e("./lib/compile"),z=e("./lib/read"),t=e("./lib/dynamic"),K=e("./lib/util/raf"),u=e("./lib/util/clock");g.exports=function(){function e(){ba=K.next(e);E.count+=1;aa.count=E.count;if(E.width!==C.drawingBufferWidth||E.height!==C.drawingBufferHeight)aa.viewportWidth=aa.drawingBufferWidth=
E.width=C.drawingBufferWidth,aa.viewportHeight=aa.drawingBufferHeight=E.height=C.drawingBufferHeight,U.notifyViewportChanged();var a=u();E.dt=a-E.t;E.t=a;aa.deltaTime=E.dt/1E3;aa.time=(a-X)/1E3;v.poll();for(var b=0;b<Z.length;++b)(0,Z[b])(null,aa);E.renderTime=u()-a}function g(){ba&&(K.cancel(e),ba=0)}function m(a){g();a.preventDefault();if(S.onContextLost)S.onContextLost()}function R(a){C.getError();ha.refresh();Y.refresh();v.refresh();D.refresh();L.refresh();ea.refresh();U.refresh();if(S.onContextRestored)S.onContextRestored();
e()}function P(b){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var f=a[c];t.isDynamic(f)?(e=!0,d[c]=t.unbox(f,c)):b[c]=f});return{dynamic:d,"static":b}}function d(a){for(;n.length<a;)n.push(null);return n}var e=!1,f=c(b.context||{}),g=c(b.uniforms||{}),h=c(b.attributes||{});b=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;c("blend");c("depth");
c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(b));var f=la.command(b["static"],g["static"],h["static"],b.dynamic,g.dynamic,h.dynamic,f,e),k=f.draw,l=f.batch,m=f.scope,n=[];return function(a,b){return"function"===typeof a?m.call(this,null,a):"function"===typeof b?m.call(this,a,b):"number"===typeof a?l.call(this,a|0,d(a|0)):Array.isArray(a)?l.call(this,a.length,a):k.call(this,a)}}function Q(){L.poll();U.poll()}var H=b(Array.prototype.slice.call(arguments)),C=H.gl,S=H.options,
H=c(),ha=d(C),J=ha.extensions,ia={width:C.drawingBufferWidth,height:C.drawingBufferHeight},ca=h(C,J),Y=f(C,function(a){for(var b=0;b<ja.bindings.length;++b){var c=ja.bindings[b];c.pointer&&c.buffer===a&&(c.pointer=!1,c.buffer=null,c.x=c.y=c.z=c.w=NaN,C.disableVertexAttribArray(b))}}),ga=p(C,J,Y),oa=x(H),ja=n(C,J,ca,Y,H),ea=r(C,ja,oa,function(a){return la.draw(a)},H),I=q(C,J,Y),v=k(C,J,ca,Q,ia),D=l(C,J,ca),L=G(C,J,ca,v,D),X=u(),E={count:0,start:X,dt:0,t:X,renderTime:0,width:C.drawingBufferWidth,height:C.drawingBufferHeight,
pixelRatio:S.pixelRatio},aa={count:0,batchId:0,deltaTime:0,time:0,viewportWidth:E.width,viewportHeight:E.height,drawingBufferWidth:E.width,drawingBufferHeight:E.height,pixelRatio:E.pixelRatio},U=y(C,L,ia),ia=z(C,Q,ia),la=w(C,H,J,ca,Y,ga,v,L,U,oa,ja,ea,I,aa,Q),O=C.canvas,Z=[],ba=0;O&&(O.addEventListener("webglcontextlost",m,!1),O.addEventListener("webglcontextrestored",R,!1));return a(P,{clear:function(a){var b=0;Q();var c=a.color;c&&(C.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in
a&&(C.clearDepth(+a.depth),b|=256);"stencil"in a&&(C.clearStencil(a.stencil|0),b|=1024);C.clear(b)},prop:t.define.bind(null,1),context:t.define.bind(null,2),"this":t.define.bind(null,3),draw:P({}),elements:function(a){return ga.create(a)},buffer:function(a){return Y.create(a,34962)},texture:function(a){return v.create(a,3553)},cube:function(a){return 6===arguments.length?v.create(Array.prototype.slice.call(arguments),34067):v.create(a,34067)},renderbuffer:function(a){return D.create(a)},framebuffer:function(a){return L.create(a)},
framebufferCube:function(a){},frame:function(a){Z.push(a);!ba&&0<Z.length&&e();return{cancel:function(){var b=Z.find(function(b){return b===a});0>b||(Z.splice(b,1),0>=Z.length&&g())}}},stats:E,limits:ca,read:ia,destroy:function(){g();O&&(O.removeEventListener("webglcontextlost",m),O.removeEventListener("webglcontextrestored",R));ea.clear();L.clear();D.clear();v.clear();Y.clear();if(S.onDestroy)S.onDestroy()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/compile":4,"./lib/draw":8,"./lib/dynamic":9,
"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/state":17,"./lib/strings":18,"./lib/texture":19,"./lib/uniform":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":28,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>