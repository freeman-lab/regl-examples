<!DOCTYPE html>
      <html>
        <head>
          <title>example/particles.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(h,n,a){function b(d,f){if(!n[d]){if(!h[d]){var g="function"==typeof require&&require;if(!f&&g)return g(d,!0);if(c)return c(d,!0);g=Error("Cannot find module '"+d+"'");throw g.code="MODULE_NOT_FOUND",g;}g=n[d]={exports:{}};h[d][0].call(g.exports,function(a){var c=h[d][1][a];return b(c?c:a)},g,g.exports,e$$0,h,n,a)}return n[d].exports}for(var c="function"==typeof require&&require,d=0;d<a.length;d++)b(a[d]);return b})({1:[function(e,h,n){var a=e("../regl")(),b=e("gl-mat4"),c=e("hsv2rgb");
e=a.buffer(Array(1E4).fill().map(function(){var a=c(360*Math.random(),.6,1);return[10*Math.random(),10*Math.random(),10*Math.random(),10*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),a[0]/255,a[1]/255,a[2]/255]}));var d=a({vert:"\n  precision mediump float;\n  attribute vec4 freq, phase;\n  attribute vec3 color;\n  uniform float time;\n  uniform mat4 view, projection;\n  varying vec3 fragColor;\n  void main() {\n    vec3 position = 8.0 * cos(freq.xyz * time + phase.xyz);\n    gl_PointSize = 5.0 * (1.0 + cos(freq.w * time + phase.w));\n    gl_Position = projection * view * vec4(position, 1);\n    fragColor = color;\n  }",
frag:"\n  precision lowp float;\n  varying vec3 fragColor;\n  void main() {\n    if (length(gl_PointCoord.xy - 0.5) > 0.5) {\n      discard;\n    }\n    gl_FragColor = vec4(fragColor, 1);\n  }",attributes:{freq:{buffer:e,stride:44,offset:0},phase:{buffer:e,stride:44,offset:16},color:{buffer:e,stride:44,offset:32}},uniforms:{view:function(a,d,c){a=.01*c.count;return b.lookAt([],[30*Math.cos(a),2.5,30*Math.sin(a)],[0,0,0],[0,1,0])},projection:function(a,d,c){return b.perspective([],Math.PI/4,c.width/
c.height,.01,1E3)},time:function(a,b,d){return.001*d.count}},count:1E4,primitive:"points"});a.frame(function(){a.clear({depth:1,color:[0,0,0,1]});d()})},{"../regl":59,"gl-mat4":43,hsv2rgb:58}],2:[function(e,h,n){function a(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}var b=e("./constants/dtypes.json"),c=e("./extend");c(a.prototype,{equals:function(a,b){return this.pointer?a.pointer&&this.buffer===
a.buffer&&this.size===b&&this.normalized===a.normalized&&this.type===a.type&&this.offset===a.offset&&this.stride===a.stride&&this.divisor===a.divisor:!a.pointer&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w},set:function(a,b){(this.pointer=a.pointer)?(this.buffer=a.buffer,this.size=b,this.normalized=a.normalized,this.type=a.type,this.offset=a.offset,this.stride=a.stride,this.divisor=a.divisor):(this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w)}});h.exports=function(d,m,f,g,k){function l(){for(var b=
Array(16),d=0;16>d;++d)b[d]=new a;this.records=b;this.top=0}function e(b){for(var d=b.records,c=b.top;d.length-1<=c;)d.push(new a);return d[++b.top]}var u={};f=f.maxAttributes;for(var q=Array(f),r=0;r<f;++r)q[r]=new a;c(l.prototype,{pushVec:function(a,b,d,c){var m=e(this);m.pointer=!1;m.x=a;m.y=b;m.z=d;m.w=c},pushPtr:function(a,b,d,c,m,f,g){var k=e(this);k.pointer=!0;k.buffer=a;k.size=b;k.offset=d;k.stride=c;k.divisor=m;k.normalized=f;k.type=g},pushDyn:function(a){if("number"===typeof a)this.pushVec(a,
0,0,0);else if(Array.isArray(a))this.pushVec(a[0],a[1],a[2],a[3]);else{var d=g.getBuffer(a),c=0,m=0,f=0,k=0,q=!1,l=5126;d?l=d.dtype:(d=g.getBuffer(a.buffer),c=a.size||0,m=a.stride||0,f=a.offset||0,k=a.divisor||0,q=a.normalized||!1,l=d.dtype,"type"in a&&(l=b[a.type]));this.pushPtr(d,c,f,m,k,q,l)}},pop:function(){--this.top}});return{bindings:q,bind:function(a,b,c,f){f=c.size||f;if(!b.equals(c,f)){if(c.pointer){b.pointer||d.enableVertexAttribArray(a);b.buffer!==c.buffer&&c.buffer.bind();d.vertexAttribPointer(a,
f,c.type,c.normalized,c.stride,c.offset);var g=m.angle_instanced_arrays;g&&g.vertexAttribDivisorANGLE(a,c.divisor)}else b.pointer&&d.disableVertexAttribArray(a),d.vertexAttrib4f(a,c.x,c.y,c.z,c.w);b.set(c,f)}},def:function(a){a=k.id(a);var b=u[a];b||(b=u[a]=new l);return b}}}},{"./constants/dtypes.json":9,"./extend":15}],3:[function(e,h,n){function a(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);
case 5122:return new Int16Array(b);case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var b=e("./check"),c=e("./is-typed-array"),d=e("./is-ndarray"),m=e("./constants/arraytypes.json"),f=e("./constants/dtypes.json"),g=e("./values"),k={"static":35044,dynamic:35048,stream:35040};h.exports=function(l){function e(a,b){this.id=r++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function u(a){l.isBuffer(a.buffer)||
(a.buffer=l.createBuffer());a.bind();l.bufferData(a.type,a.data||a.byteLength,a.usage)}function q(a){var d=a.buffer;b(d,"buffer must not be deleted already");l.isBuffer(d)&&l.deleteBuffer(d);a.buffer=null;delete p[a.id]}var r=0,p={};e.prototype.bind=function(){l.bindBuffer(this.type,this.buffer)};return{create:function(g,r,h){function y(g){var q=g||{};if(Array.isArray(q)||c(q)||d(q))q={data:q};else if("number"===typeof q)q={length:q|0};else if(null===q||void 0===q)q={};b.type(q,"object","buffer arguments must be an object, a number or an array");
"usage"in q?(b.parameter(q.usage,k,"invalid buffer usage"),x.usage=k[q.usage]):x.usage=35044;g=0;"type"in q&&(b.parameter(q.type,f,"invalid buffer type"),g=f[q.type]);var l=q.dimension|0||1,r=0,e=null;if("data"in q)if(e=q.data,null===e)r=q.length|0;else{if(d(e)){var l=e.shape,r=e.stride,q=e.offset,w=0,F=0,z=0,p=0;1===l.length?(w=l[0],F=1,z=r[0],p=0):2===l.length?(w=l[0],F=l[1],z=r[0],p=r[1]):b.raise("invalid shape");g=g||m[Object.prototype.toString.call(e)]|0||5126;for(var l=F,r=a(g,w*F),e=e.data,
h=0,v=0;v<w;++v)for(var A=0;A<F;++A)r[h++]=e[z*v+p*A+q];e=r}else if(Array.isArray(e))if(0<e.length&&Array.isArray(e[0])){l=e[0].length;g=g||5126;q=a(g,e.length*l);r=e;e=l;for(w=p=0;w<r.length;++w)for(z=r[w],F=0;F<e;++F)q[p++]=z[F];e=q}else g=g||5126,e=a(g,e);else b.isTypedArray(e,"invalid data type buffer data"),g=g||m[Object.prototype.toString.call(e)]|0;r=e.byteLength}else"length"in q&&(r=q.length|0,b.nni(r,"buffer length must be a nonnegative integer"));x.data=e;x.dtype=g||5121;x.byteLength=r;
x.dimension=l;u(x);return y}var A=l.createBuffer(),x=new e(A,r);p[x.id]=x;h||y(g);y._reglType="buffer";y._buffer=x;y.destroy=function(){q(x)};return y},clear:function(){g(p).forEach(q)},refresh:function(){g(p).forEach(u)},getBuffer:function(a){return a&&a._buffer instanceof e?a._buffer:null}}}},{"./check":4,"./constants/arraytypes.json":8,"./constants/dtypes.json":9,"./is-ndarray":18,"./is-typed-array":19,"./values":33}],4:[function(e,h,n){function a(a){a=Error("(regl) "+a);console.error(a);throw a;
}function b(b,c){b||a(c)}var c=e("./is-typed-array");e=e("./extend");h.exports=e(b,{raise:a,parameter:function(b,c,f){b in c||a("unknown parameter ("+b+")"+(f?": "+f:"")+". possible values: "+Object.keys(c).join())},type:function(b,c,f){typeof b!==c&&a("invalid parameter type"+(f?": "+f:"")+". expected "+c+", got "+typeof b)},isTypedArray:function(b,m){c(b)||a("invalid parameter type"+(m?": "+m:"")+". must be a typed array")},nni:function(b,c){0<=b&&(b|0)===b||a("invalid parameter type, ("+b+")"+
(c?": "+c:"")+". must be a nonnegative integer")},oneOf:function(b,c,f){0>c.indexOf(b)&&a("invalid value"+(f?": "+f:"")+". must be one of: "+c)},shaderError:function(a,c,f,g){a.getShaderParameter(c,a.COMPILE_STATUS)||(a=a.getShaderInfoLog(c),b.raise("Error compiling shader:\n"+a))},linkError:function(a,c){if(!a.getProgramParameter(c,a.LINK_STATUS)){var f=a.getProgramInfoLog(c);b.raise("Error linking program:\n"+f)}}})},{"./extend":15,"./is-typed-array":19}],5:[function(e,h,n){h.exports="undefined"!==
typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],6:[function(e,h,n){var a=e("./extend");h.exports=function(){function b(){var b=[],d=[];return a(function(){b.push.apply(b,Array.prototype.slice.call(arguments))},{def:function(){var a="v"+c++;d.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,Array.prototype.slice.call(arguments)),b.push(";"));return a},toString:function(){return[0<d.length?"var "+d+";":"",b.join("")].join("")}})}var c=
0,d=[],m=[],f={};return{link:function(a){var b="g"+c++;d.push(b);m.push(a);return b},block:b,proc:function(d){var m=[],l=b(),e=l.toString;return f[d]=a(l,{arg:function(){var a="a"+c++;m.push(a);return a},toString:function(){return["function(",m.join(),"){",e(),"}"].join("")}})},compile:function(){var a=['"use strict";return {'];Object.keys(f).forEach(function(b){a.push('"',b,'":',f[b].toString(),",")});a.push("}");return Function.apply(null,d.concat([a.join("")])).apply(null,m)}}}},{"./extend":15}],
7:[function(e,h,n){function a(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function b(a,b,c,d){var f,g=",";switch(b){case 5126:f="1f";break;case 35664:f="2fv";break;case 35665:f="3fv";break;case 35666:f="4fv";break;case 35670:case 5124:f="1i";break;case 35671:case 35667:f="2iv";break;case 35672:case 35668:f="3iv";break;case 35673:case 35669:f="4iv";break;case 35674:f="Matrix2fv";g=",false,";
break;case 35675:f="Matrix3fv";g=",false,";break;case 35676:f="Matrix4fv";g=",false,";break;default:m.raise("unsupported uniform type")}return a+".uniform"+f+"("+c+g+d+");"}function c(a){return a+"["+a+".length-1]"}function d(a,b){return"framebuffer"===a||a<b?-1:a>b?1:0}var m=e("./check"),f=e("./codegen"),g=e("./constants/primitives.json"),k=e("./constants/dtypes.json"),l={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,
"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},F={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},u={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};h.exports=function(q,e,p,
w,h,v,y,A,x,n,G,I,S,W,Y){function U(k,e,r,w,h){function z(a){var b=qa[a];return b?b:b=qa[a]=J(fa[a])}function y(a){var b=a.id,c=aa[b];if(c)return c;c=a.func?t.def(J(a.data),"(",pa,",",Q,",",X,")"):t.def(pa,".",a.data);return aa[b]=c}function x(a,b){return a.find(function(a){return a.name===b})}function ca(a){return na&&!(a in e||a in h)}var da=f(),J=da.link,t=da.proc("batch"),N=da.block(),L=t.def,ha=t.arg,B=J(q),M=J(k.program),V=J(G.bind),X=J(W),la=J(A),H=J(S.count),R=J(S.offset),sa=J(S.instances),
ea=J(S.primitive),qa={},ma=J(v.elements),H=L(c(H)),R=L(c(R)),ea=L(c(ea)),ma=L(c(ma)),C,O,I=p.angle_instanced_arrays;I&&(C=L(c(sa)),O=J(I));var na="elements"in e,sa=ha(),ha=ha(),pa=L(),Q=L(),aa={};t(B,".useProgram(",M,");");k.uniforms.forEach(function(a){if(!(a.name in r)){var c=J(a.location),d=J(n.def(a.name)),d=d+"["+d+".length-1]";a=a.info.type;35678===a||35680===a?(a=L(d+"._texture"),t(b(B,5124,c,a+".bind()")),N(a,".unbind();")):t(b(B,a,c,d))}});k.attributes.forEach(function(b){if(!(w.name in w)){var c=
J(G.def(b.name));t(V,"(",b.location,",",J(G.bindings[b.location]),",",c,".records[",c,".top]",",",a(b.info.type),");")}});na||t("if(",ma,"){",B,".bindBuffer(",34963,",",ma,".buffer.buffer);","}else{",B,".bindBuffer(",34963,",null);","}");t("for(",Q,"=0;",Q,"<",sa,";++",Q,"){",pa,"=",ha,"[",Q,"];");Object.keys(e).sort(d).forEach(function(a){function b(a){t("if(",c,"){",B,".enable(",a,");}else{",B,".disable(",a,");}")}var c=y(e[a]);switch(a){case "framebuffer":a=z("viewport");var d=z("scissor.box");
t("if(",la,".push(",c,"&&",c,"._framebuffer)){",la,".poll();",a,".setDirty();",d,".setDirty();","}");break;case "cull.enable":b(2884);break;case "blend.enable":b(3042);break;case "dither":b(3024);break;case "stencil.enable":b(2960);break;case "depth.enable":b(2929);break;case "scissor.enable":b(3089);break;case "polygonOffset.enable":b(32823);break;case "sample.alpha":b(32926);break;case "sample.enable":b(32928);break;case "depth.mask":t(B,".depthMask(",c,");");break;case "depth.func":a=J(F);t(B,
".depthFunc(",a,"[",c,"]);");break;case "depth.range":t(B,".depthRange(",c,"[0],",c,"[1]);");break;case "blend.color":t(B,".blendColor(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "blend.equation":a=J(D);t("if(typeof ",c,'==="string"){',B,".blendEquation(",a,"[",c,"]);","}else{",B,".blendEquationSeparate(",a,"[",c,".rgb],",a,"[",c,".alpha]);","}");break;case "blend.func":a=J(l);t(B,".blendFuncSeparate(",a,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",a,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",
a,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",a,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");break;case "stencil.mask":t(B,".stencilMask(",c,");");break;case "stencil.func":a=J(F);t(B,".stencilFunc(",a,"[",c,'.cmp||"always"],',c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":d=J(u);t(B,".stencilOpSeparate(","stencil.opFront"===a?1028:1029,",",d,"[",c,'.fail||"keep"],',d,"[",c,'.zfail||"keep"],',d,"[",c,'.pass||"keep"]);');break;case "polygonOffset.offset":t(B,
".polygonOffset(",c,".factor||0,",c,".units||0);");break;case "cull.face":t(B,".cullFace(",c,'==="front"?',1028,":",1029,");");break;case "lineWidth":t(B,".lineWidth(",c,");");break;case "frontFace":t(B,".frontFace(",c,'==="cw"?',2304,":",2305,");");break;case "colorMask":t(B,".colorMask(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "sample.coverage":t(B,".sampleCoverage(",c,".value,",c,".invert);");break;case "scissor.box":case "viewport":a=z(a);t(a,".push(",c,".x||0,",c,".y||0,",c,".w||-1,",
c,".h||-1);");break;case "primitives":case "offset":case "count":case "elements":break;default:m.raise("unsupported option for batch",a)}});("viewport"in e||"framebuffer"in e)&&t(z("viewport"),".poll();");("scissor.box"in e||"framebuffer"in e)&&t(z("scissor.box"),".poll();");"framebuffer"in e&&t(la,".pop();");var U=k.uniforms,Y=[];Object.keys(r).forEach(function(a){var c=x(U,a);if(c){var d=c.info.type,f=J(c.location);a=y(r[a]);35678===c.info.type||35680===c.info.type?(c=L(a+"._texture"),Y.push(c),
t(b(B,5124,f,c+".bind()"))):t(b(B,d,f,a))}});Y.forEach(function(a){t(a,".unbind();")});var ta=k.attributes;Object.keys(w).forEach(function(b){var c=x(ta,b);c&&t(V,"(",c.location,",",J(b.bindings[c.location]),",",y(w[b]),",",a(c.info.type),");")});e.count?t(H,"=",y(e.count),";"):ca("count")||t("if(",H,"){");e.offset&&t(R,"=",y(e.offset),";");e.primitive&&(k=J(g),t(ea,"=",k,"[",y(e.primitive),"];"));na&&(k=y(e.elements),t(ma,"=",k,"?",k,"._elements:null;"));ca("offset")&&t(R,"=0;");t("if(",ma,"){");
ca("count")&&t(H,"=",ma,".vertCount;","if(",H,">0){");ca("primitive")&&t(ea,"=",ma,".primType;");na&&t(B,".bindBuffer(",34963,",",ma,".buffer.buffer);");I&&(e.instances&&t(C,"=",y(e.instances),";"),t("if(",C,">0){",O,".drawElementsInstancedANGLE(",ea,",",H,",",ma,".type,",R,",",C,");}else{"));t(B,".drawElements(",ea,",",H,",",ma,".type,",R,");");I&&t("}");ca("count")&&t("}");t("}else{");ca("count")||(ca("primitive")&&t(ea,"=",4,";"),I&&t("if(",C,">0){",O,".drawArraysInstancedANGLE(",ea,",",R,",",
H,",",C,");}else{"),t(B,".drawArrays(",ea,",",R,",",H,");}"),I&&t("}"));t("}}",N);return da.compile().batch}var fa=x.contextState,D={add:32774,subtract:32778,"reverse subtract":32779};p.ext_blend_minmax&&(D.min=32775,D.max=32776);var O=0;return{draw:function(d){var m=f(),g=m.link,e=m.proc("draw"),k=e.def,l=g(q),r=g(d.program),w=g(G.bind),F=g(S.count),h=g(S.offset),z=g(S.instances),t=g(S.primitive),u=g(v.elements),L=[];e(l,".useProgram(",r,");");d.attributes.forEach(function(b){var c=g(G.def(b.name));
e(w,"(",b.location,",",g(G.bindings[b.location]),",",c,".records[",c,".top]",",",a(b.info.type),");")});d.uniforms.forEach(function(a){var c=g(a.location),d=g(n.def(a.name)),d=d+"["+d+".length-1]";a=a.info.type;35678===a||35680===a?(a=k(d+"._texture"),L.push(a),e(b(l,5124,c,a+".bind()"))):e(b(l,a,c,d))});L.forEach(function(a){e(a,".unbind();")});d=k(c(t));F=k(c(F));h=k(c(h));u=k(c(u));e("if(",F,"){");(r=p.angle_instanced_arrays)?(z=k(c(z)),r=g(r),e("if(",u,"){",u,".bind();","if(",z,">0){",r,".drawElementsInstancedANGLE(",
d,",",F,",",u,".type,",h,",",z,");}else{",l,".drawElements(",d,",",F,",",u,".type,",h,");}","}else if(",z,">0){",r,".drawArraysInstancedANGLE(",d,",",h,",",F,",",z,");}else{",l,".drawArrays(",d,",",h,",",F,");}}")):e("if(",u,"){",l,".drawElements(",d,",",F,",",u,".type,",h,");}","}else{",l,".drawArrays(",d,",",h,",",F,");}");return m.compile().draw},command:function(a,b,q,p,y,x,ba){function E(a){var b=ma[a];return b?b:b=ma[a]=t(fa[a])}function ca(a,b){var c=E(a);C(c,".push(",b,");");T(c,".pop();")}
function da(a){var b=a.id,c=ta[b];if(c)return c;c=a.func?Q.def(t(a.data),"(",ra,",0,",va,")"):Q.def(ra,".",a.data);return ta[b]=c}var J=f(),t=J.link,N=J.block,L=J.proc,ha=O++,B=t(Y);t(e);var M=t(I.fragShaders),V=t(I.vertShaders),X=t(I.programs),la=t(A),H={count:t(S.count),offset:t(S.offset),instances:t(S.instances),primitive:t(S.primitive)},R=t(v.elements),sa=t(g),ea=t(F),qa=t(u),ma={},C=N(),T=N(),ua=!1;Object.keys(a).sort(d).forEach(function(b){var c=a[b];switch(b){case "frag":ua=!0;C(M,".push(",
t(e.id(c)),");");T(M,".pop();");break;case "vert":ua=!0;C(V,".push(",t(e.id(c)),");");T(V,".pop();");break;case "framebuffer":b=A.getFramebuffer(c);m(null===c||b,"invalid framebuffer object");b=E("viewport");var d=E("scissor.box");C("if(",la,".push(",t(c&&c._framebuffer),")){",b,".setDirty();",d,".setDirty();","}");T("if(",la,".pop()){",b,".setDirty();",d,".setDirty();","}");break;case "count":case "offset":case "instances":m.nni(c,b);C(H[b],".push(",c,");");T(H[b],".pop();");break;case "primitive":m.parameter(c,
g,"not a valid drawing primitive");C(H.primitive,".push(",g[c],");");T(H.primitive,".pop();");break;case "elements":d=v.getElements(c);c=!("primitive"in a);b=!("count"in a);d?(d=t(d),C(R,".push(",d,");"),c&&C(H.primitive,".push(",d,".primType);"),b&&C(H.count,".push(",d,".vertCount);")):(C(R,".push(null);"),c&&C(H.primitive,".push(",4,");"),b&&C(H.count,".push(0);"));c&&T(H.primitive,".pop();");b&&T(H.count,".pop();");"offset"in a||(C(H.offset,".push(0);"),T(H.offset,".pop();"));T(R,".pop();");break;
case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":m.type(c,"boolean",b);ca(b,c);break;case "depth.func":m.parameter(c,F,b);ca(b,F[c]);break;case "depth.range":m(Array.isArray(c)&&2===c.length&&c[0]<=c[1],"depth range is 2d array");b=E(b);C(b,".push(",c[0],",",c[1],");");T(b,".pop();");break;case "blend.func":b=E(b);m.type(c,"object","blend func must be an object");
var d="srcRGB"in c?c.srcRGB:c.src,f="srcAlpha"in c?c.srcAlpha:c.src,B="dstRGB"in c?c.dstRGB:c.dst,c="dstAlpha"in c?c.dstAlpha:c.dst;m.parameter(d,l);m.parameter(f,l);m.parameter(B,l);m.parameter(c,l);C(b,".push(",l[d],",",l[B],",",l[f],",",l[c],");");T(b,".pop();");break;case "blend.equation":b=E(b);"string"===typeof c?(m.parameter(c,D,"invalid blend equation"),C(b,".push(",D[c],",",D[c],");")):"object"===typeof c?(m.parameter(c.rgb,D,"invalid blend equation rgb"),m.parameter(c.alpha,D,"invalid blend equation alpha"),
C(b,".push(",D[c.rgb],",",D[c.alpha],");")):m.raise("invalid blend equation");T(b,".pop();");break;case "blend.color":m(Array.isArray(c)&&4===c.length,"blend color is a 4d array");b=E(b);C(b,".push(",c[0],",",c[1],",",c[2],",",c[3],");");T(b,".pop();");break;case "stencil.mask":m.type(c,"number","stencil mask must be an integer");b=E(b);C(b,".push(",c,");");T(b,".pop();");break;case "stencil.func":m.type(c,"object","stencil func must be an object");d=c.cmp||"keep";f=c.ref||0;c="mask"in c?c.mask:-1;
m.parameter(d,F,"invalid stencil func cmp");m.type(f,"number","stencil func ref");m.type(c,"number","stencil func mask");b=E(b);C(b,".push(",F[d],",",f,",",c,");");T(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":m.type(c,"object",b);d=c.fail||"keep";f=c.zfail||"keep";c=c.pass||"keep";m.parameter(d,u,b);m.parameter(f,u,b);m.parameter(c,u,b);b=E(b);C(b,".push(",u[d],",",u[f],",",u[c],");");T(b,".pop();");break;case "polygonOffset.offset":m.type(c,"object",b);d=c.factor||0;c=c.units||
0;m.type(d,"number","offset.factor");m.type(c,"number","offset.units");b=E(b);C(b,".push(",d,",",c,");");T(b,".pop();");break;case "cull.face":d=0;"front"===c?d=1028:"back"===c&&(d=1029);m(!!d,"cull.face");c=E(b);C(c,".push(",d,");");T(c,".pop();");break;case "lineWidth":d=w.lineWidthDims;m("number"===typeof c&&c>=d[0]&&c<=d[1],"invalid line width, must positive number between "+d[0]+" and "+d[1]);ca(b,c);break;case "frontFace":d=0;"cw"===c?d=2304:"ccw"===c&&(d=2305);m(!!d,"frontFace");c=E(b);C(c,
".push(",d,");");T(c,".pop();");break;case "colorMask":m(Array.isArray(c)&&4===c.length,"color mask must be length 4 array");b=E(b);C(b,".push(",c.map(function(a){return!!a}).join(),");");T(b,".pop();");break;case "sample.coverage":m.type(c,"object",b);d="value"in c?c.value:1;c=!!c.invert;m("number"===typeof d&&0<=d&&1>=d,"sample value");b=E(b);C(b,".push(",d,",",c,");");T(b,".pop();");break;case "viewport":case "scissor.box":m("object"===typeof c&&c,b+" is an object");var d=c.x||0,f=c.y||0,k=B=-1;
m("number"===typeof d&&0<=d,b+".x must be a positive int");m("number"===typeof f&&0<=f,b+".y must be a positive int");"w"in c&&(B=c.w,m("number"===typeof B&&0<=B,b+".w must be a positive int"));"h"in c&&(k=c.h,m("number"===typeof k&&0<=k,b+".h must be a positive int"));c=E(b);C(c,".push(",d,",",f,",",B,",",k,");");T(c,".pop();");break;default:m.raise("unsupported parameter "+b)}});if(ua){if(a.frag&&a.vert)N=a.frag,C(X,".push(",t(I.create(e.id(a.vert),e.id(N))),");");else{var N=C.def(M,"[",M,".length-1]"),
na=C.def(V,"[",V,".length-1]"),pa=t(I.create);C(X,".push(",pa,"(",na,",",N,"));")}T(X,".pop();")}Object.keys(b).forEach(function(a){var c=t(n.def(a));a=b[a];a="function"===typeof a&&a._reglType?t(a):Array.isArray(a)?t(a.slice()):+a;C(c,".push(",a,");");T(c,".pop();")});Object.keys(q).forEach(function(a){var b=t(G.def(a)),c=q[a];if("number"===typeof c)C(b,".pushVec(",+c,",0,0,0);");else if(m(!!c,"invalid attribute: "+a),Array.isArray(c))C(b,".pushVec(",[c[0]||0,c[1]||0,c[2]||0,c[3]||0],");");else{var d=
h.getBuffer(c),f=0,g=0,B=0,e=0,l=!1,r=5126;d?r=d.dtype:(m.type(c,"object",'invalid attribute "'+a+'"'),d=h.getBuffer(c.buffer),f=c.size||0,g=c.stride||0,B=c.offset||0,e=c.divisor||0,l=c.normalized||!1,m(!!d,"invalid attribute "+a+".buffer"),r=d.dtype,"type"in c&&(m.parameter(c.type,k,"attribute type"),r=k[c.type]));m(!!d,"invalid attribute "+a+".buffer");m.nni(g,a+".stride");m.nni(B,a+".offset");m.nni(e,a+".divisor");m.type(l,"boolean",a+".normalized");m.oneOf(f,[0,1,2,3,4],a+".size");C(b,".pushPtr(",
[t(d),f,B,g,e,l,r].join(),");")}T(b,".pop();")});var Q=J.block(),aa=J.block(),va,ra;ba&&(va=t(W),ra=C.def());var ta={};Object.keys(p).sort(d).forEach(function(b){var c=da(p[b]);switch(b){case "framebuffer":b=E("viewport");var d=E("scissor.box");Q("if(",la,".push(",c,"&&",c,"._framebuffer)){",b,".setDirty();",d,".setDirty();","}");aa("if(",la,".pop()){",b,".setDirty();",d,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":b=
E(b);Q(b,".push(",c,");");aa(b,".pop();");break;case "count":case "offset":case "instances":b=H[b];Q(b,".push(",c,");");aa(b,".pop();");break;case "primitive":b=H.primitive;Q(b,".push(",sa,"[",c,"]);");aa(b,".pop();");break;case "depth.func":b=E(b);Q(b,".push(",ea,"[",c,"]);");aa(b,".pop();");break;case "blend.func":b=E(b);d=t(l);Q(b,".push(",d,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",d,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",d,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",d,'["dstAlpha" in ',
c,"?",c,".dstAlpha:",c,".dst]);");aa(b,".pop();");break;case "blend.equation":b=E(b);d=t(D);Q("if(typeof ",c,'==="string"){',b,".push(",d,"[",c,"],",d,"[",c,"]);","}else{",b,".push(",d,"[",c,".rgb],",d,"[",c,".alpha]);","}");aa(b,".pop();");break;case "blend.color":b=E(b);Q(b,".push(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");aa(b,".pop();");break;case "stencil.mask":b=E(b);Q(b,".push(",c,");");aa(b,".pop();");break;case "stencil.func":b=E(b);Q(b,".push(",ea,"[",c,".cmp],",c,".ref|0,",'"mask" in ',c,
"?",c,".mask:-1);");aa(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":b=E(b);Q(b,".push(",qa,"[",c,'.fail||"keep"],',qa,"[",c,'.zfail||"keep"],',qa,"[",c,'.pass||"keep"]);');aa(b,".pop();");break;case "polygonOffset.offset":b=E(b);Q(b,".push(",c,".factor||0,",c,".units||0);");aa(b,".pop();");break;case "cull.face":b=E(b);Q(b,".push(",c,'==="front"?',1028,":",1029,");");aa(b,".pop();");break;case "frontFace":b=E(b);Q(b,".push(",c,'==="cw"?',2304,":",2305,");");aa(b,".pop();");break;
case "colorMask":b=E(b);Q(b,".push(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");aa(b,".pop();");break;case "sample.coverage":b=E(b);Q(b,".push(",c,".value,",c,".invert);");aa(b,".pop();");break;case "scissor.box":case "viewport":b=E(b);Q(b,".push(",c,".x||0,",c,".y||0,",'"w" in ',c,"?",c,".w:-1,",'"h" in ',c,"?",c,".h:-1);");aa(b,".pop();");break;case "elements":b=!("primitive"in p)&&!("primitive"in a);var d=!("count"in p)&&!("count"in a),f=!("offset"in p)&&!("offset"in a),g=Q.def();Q("if(",c,"){",g,"=",
c,"._elements;",R,".push(",g,");",b?H.primitive+".push("+g+".primType);":"",d?H.count+".push("+g+".vertCount);":"",f?H.offset+".push("+g+".offset);":"","}else{",R,".push(null);","}");aa(R,".pop();","if(",c,"){",b?H.primitive+".pop();":"",d?H.count+".pop();":"",f?H.offset+".pop();":"","}");break;default:m.raise("unsupported dynamic option: "+b)}});Object.keys(y).forEach(function(a){var b=t(n.def(a));a=da(y[a]);Q(b,".push(",a,");");aa(b,".pop();")});Object.keys(x).forEach(function(a){var b=t(G.def(a));
a=da(x[a]);Q(b,".pushDyn(",a,");");aa(b,".pop();")});N=L("scope");na=N.arg();pa=N.arg();N(C);ba&&N(ra,"=",na,";",Q);N(pa,"();",ba?aa:"",T);N=L("draw");N(C);ba&&N(ra,"=",N.arg(),";",Q);na=c(X);N(B,"();","if(",na,")",na,".draw(",ba?ra:"",");",ba?aa:"",T);var oa=L("batch");oa(C);ba=oa.def(c(X));L=t(function(b,c,d){var f=b.batchCache[ha];f||(f=b.batchCache[ha]=U(b,p,y,x,a));return f(c,d)});oa("if(",ba,"){",B,"();",L,"(",ba,",",oa.arg(),",",oa.arg(),");");Object.keys(p).forEach(function(a){(a=ma[a])&&
oa(a,".setDirty();")});oa("}",T);return J.compile()}}}},{"./check":4,"./codegen":6,"./constants/dtypes.json":9,"./constants/primitives.json":10}],8:[function(e,h,n){h.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],9:[function(e,h,n){h.exports={int8:5120,
int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],10:[function(e,h,n){h.exports={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],11:[function(e,h,n){function a(a,c){function g(){var b=window.innerWidth,c=window.innerHeight;a!==document.body&&(c=a.getBoundingClientRect(),b=c.right-c.left,c=c.top-c.bottom);e.width=F*b;e.height=F*c;d(e.style,{width:b+"px",height:c+"px"})}var e=document.createElement("canvas"),l=b(e,c);d(e.style,
{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(e);a===document.body&&(e.style.position="absolute",d(a.style,{margin:0,padding:0}));var F=+l.options.pixelRatio;window.addEventListener("resize",g,!1);var h=l.options.onDestroy;l.options=d(d({},l.options),{onDestroy:function(){window.removeEventListener("resize",g);a.removeChild(e);h&&h()}});g();return l}function b(a,b){function g(b){try{return a.getContext(b,e)}catch(c){return null}}var e=b.glOptions||{},l=g("webgl")||g("experimental-webgl")||
g("webgl-experimental");c(l,"webgl not supported");return{gl:l,options:d({pixelRatio:window.devicePixelRatio},b)}}var c=e("./check"),d=e("./extend");h.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],options:c[1]||{}};var f=document.body,g=c[1]||{};if("string"===typeof c[0])f=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)f=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],
options:d({pixelRatio:1},g)};g=c[0]}return f.nodeName&&"CANVAS"===f.nodeName.toUpperCase()?b(f,g):a(f,g)}},{"./check":4,"./extend":15}],12:[function(e,h,n){h.exports=function(a){return{primitive:[4],count:[0],offset:[0],instances:[0]}}},{}],13:[function(e,h,n){function a(a,b){this.id=c++;this.func=a;this.data=b}function b(c,m){switch(typeof c){case "boolean":case "number":case "string":return new a(!1,c);case "function":return new a(!0,c);default:return b}}var c=0;h.exports={define:b,isDynamic:function(b){return"function"===
typeof b&&!b._reglType||b instanceof a},unbox:function(c,m){return c instanceof a?c:"function"===typeof c&&c!==b?new a(!0,c):new a(!1,m)}}},{}],14:[function(e,h,n){var a=e("./check"),b=e("./is-typed-array"),c=e("./is-ndarray"),d=e("./constants/primitives.json");h.exports=function(m,f,g){function e(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}e.prototype.bind=function(){this.buffer.bind()};return{create:function(m){function F(m){var g=f.oes_element_index_uint;if(m)if("number"===typeof m)q(m);
else{var e=null,k="static",l=0;Array.isArray(m)||b(m)||c(m)?e=m:(a.type(m,"object","invalid arguments for elements"),"data"in m&&(e=m.data),"usage"in m&&(k=m.usage),"length"in m&&(l=m.length));Array.isArray(e)||c(e)&&"array"===e.dtype||"type"in m?q({type:m.type||(g?"uint32":"uint16"),usage:k,data:e,length:l}):q({usage:k,data:e,length:l});if(Array.isArray(e)||b(e))q.dimension=3}else q();e=h.buffer.byteLength;k=0;switch(h.buffer.dtype){case 5121:case 5120:k=5121;break;case 5123:case 5122:k=5123;e>>=
1;break;case 5125:case 5124:a(g,"32 bit element buffers not supported");k=5125;e>>=2;break;default:a.raise("invalid element buffer type")}g=4;l=h.buffer.dimension;1===l&&(g=0);2===l&&(g=1);3===l&&(g=4);"object"===typeof m&&("primitive"in m&&(g=m.primitive,a.parameter(g,d),g=d[g]),"count"in m&&(e=m.vertCount|0));h.primType=g;h.vertCount=e;h.type=k;return F}var h=new e,q=g.create(null,34963,!0);h.buffer=q._buffer;F(m);F._reglType="elements";F._elements=h;F.destroy=function(){a(null!==h.buffer,"must not double destroy elements");
q.destroy();h.buffer=null};return F},elements:[null],getElements:function(a){return a&&a._elements instanceof e?a._elements:null}}}},{"./check":4,"./constants/primitives.json":10,"./is-ndarray":18,"./is-typed-array":19}],15:[function(e,h,n){h.exports=function(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d)a[c[d]]=b[c[d]];return a}},{}],16:[function(e,h,n){h.exports=function(a){function b(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(b){try{c[b]=
a.getExtension(b)}catch(m){}})}var c={};b();return{extensions:c,refresh:b}}},{}],17:[function(e,h,n){var a=e("./check"),b=e("./values"),c=e("./extend"),d=[1029];h.exports=function(m,f,g,e,l){function h(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function u(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function q(b,c,d){if(b.texture)a.oneOf(b.texture._texture.params.internalformat,c,"unsupported texture format for attachment");
else a.oneOf(b.renderbuffer._renderbuffer.format,d,"unsupported renderbuffer format for attachment")}function r(b,c){var d=c.width,f=c.height;if(b.texture){var m=b.texture._texture,g=Math.max(1,m.params.width>>b.level),e=Math.max(1,m.params.height>>b.level),d=d||g,f=f||e;a(g===d&&e===f,"inconsistent width/height for supplied texture");a(0>m.pollId,"polling fbo textures not supported")}else m=b.renderbuffer._renderbuffer,d=d||m.width,f=f||m.height,a(m.width===d&&m.height===f,"inconsistent width/height for renderbuffer"),
a(0<=ja.indexOf(m.format),"renderbuffer format not compatible with color channels");m.refCount+=1;c.width=d;c.height=f}function p(a,b){b?b.texture?m.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):m.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):m.framebufferTexture2D(36160,a,3553,null,0)}function w(b){var c=3553,d=0,f=null,m=null,g=b;"object"===typeof b&&(g=b.data,"level"in b&&(d=b.level|0),"target"in b&&(c=b.target|0));a.type(g,"function",
"invalid attachment data");g=b._reglType;"texture"===g?(f=b,34067===f._texture.target?a(34069<=c&&34075>c,"invalid cube map target"):a(3553===c)):"renderbuffer"===g?(m=b,c=36161,d=0):a.raise("invalid regl object for attachment");return new h(c,d,f,m)}function z(a){return a&&(a.texture||a.renderbuffer)}function v(){this.id=Z++;ga[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=
this.ownsColor=!1}function y(b){m.isFramebuffer(b.framebuffer)||(b.framebuffer=m.createFramebuffer());E=!0;m.bindFramebuffer(36160,b.framebuffer);for(var c=b.colorAttachments,d=0;d<c.length;++d)p(36064+d,c[d]);for(d=c.length;d<g.maxColorAttachments;++d)p(36064+d,null);p(36096,b.depthAttachment);p(36128,b.stencilAttachment);p(33306,b.depthStencilAttachment);f.webgl_draw_buffers&&f.webgl_draw_buffers.drawBuffersWEBGL(ia[c.length]);b=m.checkFramebufferStatus(36160);36053!==b&&a.raise("framebuffer configuration not supported, status = "+
n[b])}function A(b){b=b.framebuffer;a(b,"must not double destroy framebuffer");m.isFramebuffer(b)&&m.deleteFramebuffer(b)}function x(){return ba[ba.length-1]}var n={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"},G={rgba:6408},I={rgba4:32854,rgb565:36194,"rgb5 a1":32855};f.ext_srgb&&(I.srgba=35907);f.ext_color_buffer_half_float&&(I.rgba16f=34842,I.rgb16f=34843);f.webgl_color_buffer_float&&(I.rgba32f=34836);var S=
[33189],W=[36168],Y=[34041],U=[],fa=[],D=[];f.webgl_depth_texture&&(U.push(6402),D.push(34041));var O=c(c({},G),I),P=b(G),ja=b(I),I=5121,ka={uint8:5121};f.oes_texture_half_float&&(I=ka["half float"]=36193);f.oes_texture_float&&(I=ka["float"]=5126);ka.best=I;var ia=function(){for(var a=Array(g.maxDrawbuffers),b=0;b<=g.maxDrawbuffers;++b)for(var c=a[b]=Array(b),d=0;d<b;++d)c[d]=36064+d;return a}(),Z=0,ga={},ba=[null],E=!0;return{top:x,dirty:function(){return E},push:function(a){a=a||null;E=E||a!==x();
ba.push(a);return E},pop:function(){var a=x();ba.pop();return E=E||a!==x()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof v)?a:null},poll:function(){if(E){var a=ba[ba.length-1],b=f.webgl_draw_buffers;a?(m.bindFramebuffer(36160,a.framebuffer),b&&b.drawBuffersWEBGL(ia[a.colorAttachments.length])):(m.bindFramebuffer(36160,null),b&&b.drawBuffersWEBGL(d));E=!1}},create:function(b){function c(b){var g,p=b||{};g=f.webgl_draw_buffers;var v=
0,B=0;"shape"in p?(b=p.shape,a(Array.isArray(b)&&2<=b.length,"invalid shape for framebuffer"),v=b[0],B=b[1]):("radius"in p&&(v=B=p.radius),"width"in p&&(v=p.width),"height"in p&&(B=p.height));var M=null;b=!1;if("colorBuffers"in p||"colorBuffer"in p){M=p.colorBuffers||p.colorBuffer;Array.isArray(M)||(M=[M]);d.width=v;d.height=B;1<M.length&&a(g,"multiple render targets not supported");a(0<=M.length,"must specify at least one color attachment");M=M.map(w);for(g=0;g<M.length;++g)v=M[g],q(v,P,ja),r(v,
d);v=d.width;B=d.height}else{var V=!0,X="rgba",la="uint8",H=1;b=!0;d.width=v||m.drawingBufferWidth;d.height=B||m.drawingBufferHeight;"format"in p&&(X=p.format,a.parameter(X,O,"invalid color format"),V=X in G);"type"in p&&(a(V,"colorType can not be set for renderbuffer targets"),la=p.type,a.parameter(la,ka,"invalid color type"));"colorCount"in p&&(H=p.colorCount|0,a(0<=H,"color count must be positive"));if(d.ownsColor)for(M=d.colorAttachments;M.length>H;)u(M.pop());else M=[];for(g=0;g<M.length;++g){var R;
a:{R=M[g];var A=V,ea=X,x=v,n=B;if(R.texture){var C=R.texture;if(A){C({format:ea,type:la,width:x,height:n});C._texture.refCount+=1;R=!0;break a}}else if(C=R.renderbuffer,!A){C({format:ea,width:x,height:n});C._renderbuffer.refCount+=1;R=!0;break a}u(R);R=!1}R||(M[g--]=M[M.length-1],M.pop())}for(;M.length<H;)V?M.push(new h(3553,0,e.create({format:X,type:la,width:v,height:B},3553),null)):M.push(new h(36161,0,null,l.create({format:X,width:v,height:B})))}a(0<M.length,"must specify at least one color buffer");
d.width=v;d.height=B;X=V=g=null;la=!1;H=0;"depthBuffer"in p&&(g=w(p.depthBuffer),q(g,U,S),H+=1);"stencilBuffer"in p&&(V=w(p.stencilBuffer),q(V,fa,W),H+=1);"depthStencilBuffer"in p&&(X=w(p.depthStencilBuffer),q(X,D,Y),H+=1);if(g||V||X)a(1===H,"can specify only one of depth, stencil or depthStencil attachment"),r(g||V||X,d);else if(H=!0,A=R=!1,"depth"in p&&(H=!!p.depth),"stencil"in p&&(R=!!p.stencil),"depthTexture"in p&&(A=!!p.depthTexture),p=d.depthAttachment||d.stencilAttachment||d.depthStencilAttachment,
ea=null,H||R)la=!0,A?(a(f.webgl_depth_texture,"depth texture extension not supported"),a(H,"stencil only textures not supported"),A=R?"depth stencil":"depth",d.ownsDepthStencil&&p.texture?(p.texture({format:A,width:v,height:B}),p.texture._texture.refCount+=1,ea=p):ea=new h(3553,0,e.create({format:A,width:v,height:B},3553),null)):(A=H?R?"depth stencil":"depth":"stencil",d.ownsDepthStencil&&p.renderbuffer?(p.renderbuffer({format:A,width:v,height:B}),p.renderbuffer._renderbuffer.refCount+=1,ea=p):ea=
new h(36161,0,null,l.create({format:A,width:v,height:B}))),H?R?X=ea:g=ea:V=ea;v=d;v.colorAttachments.forEach(u);u(v.depthAttachment);u(v.stencilAttachment);u(v.depthStencilAttachment);d.colorAttachments=M;d.depthAttachment=g;d.stencilAttachment=V;d.depthStencilAttachment=X;d.ownsColor=b;d.ownsDepthStencil=la;c.color=M.map(z);c.depth=z(g);c.stencil=z(V);c.depthStencil=z(X);y(d);c.width=d.width;c.height=d.height;return c}var d=new v;c(b);c._reglType="framebuffer";c._framebuffer=d;c._destroy=function(){A(d)};
return c},clear:function(){b(ga).forEach(A)},refresh:function(){b(ga).forEach(y)}}}},{"./check":4,"./extend":15,"./values":33}],18:[function(e,h,n){var a=e("./is-typed-array");h.exports=function(b){return"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":19}],19:[function(e,h,n){var a=e("./constants/arraytypes.json");h.exports=function(b){return Object.prototype.toString.call(b)in
a}},{"./constants/arraytypes.json":8}],20:[function(e,h,n){h.exports=function(a,b){var c=1;b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,m=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),m=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:c,
maxDrawbuffers:d,maxColorAttachments:m,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},{}],21:[function(e,h,n){h.exports=function(a,b){if("undefined"!==typeof document){var c;c=(c=/\.(\w+)(\?.*)?$/.exec(a))&&c[1]?c[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(c))return c=document.createElement("video"),c.autoplay=!0,c.loop=!0,b&&(c.crossOrigin=b),c.src=
a,c;if(0<=["dds"].indexOf(c))return c=new XMLHttpRequest,c.responseType="arraybuffer",c.open("GET",a,!0),c.send(),c;c=new Image;b&&(c.crossOrigin=b);c.src=a;return c}return null}},{}],22:[function(e,h,n){var a=e("./check");h.exports=function(e){function h(a){for(var b=ja,c=ka,d=0;d<E;++d){var f=Math.max(1,b+3>>2)*Math.max(1,c+3>>2)*ga;da.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(e,ca,f)});ca+=f;b>>=1;c>>=1}}var n=new Int32Array(e);a(n[0]===b,"invalid magic number for dds header");
var P=n[K];a(P&p,"unsupported dds format");var ja=n[I],ka=n[G],ia=F,Z=0,ga=0,ba=4;switch(n[Y]){case z:ga=8;P&w?(ba=3,Z=m):Z=f;break;case v:ga=16;Z=g;break;case y:ga=16;Z=k;break;case A:ga=8;Z=l;break;default:a.raise("unsupported dds texture format")}var E=1;n[W]&u&&(E=Math.max(1,n[S]));var ca=n[x]+4,da={width:ja,height:ka,channels:ba,format:Z,type:ia,compressed:!0,cube:!1,pixels:[]},n=n[U];if(n&q)for(a((n&r)===r,"missing cubemap faces"),da.cube=!0,n=0;6>n;++n)h(d+n);else h(c);return da};var b=542327876,
c=3553,d=34069,m=33776,f=33777,g=33778,k=33779,l=36196,F=5121,u=131072,q=512,r=64512,p=4,w=64,z=827611204,v=861165636,y=894720068,A=826496069,x=1,K=2,G=3,I=4,S=7,W=20,Y=21,U=28},{"./check":4}],23:[function(e,h,n){h.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,30)},cancel:clearTimeout}},{}],24:[function(e,h,n){var a=e("./check"),
b=e("./is-typed-array");h.exports=function(c,d,m){return function(f){var g=f||{};b(f)?g={data:g}:2===arguments.length?g={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof f&&(g={});d();var e=g.x||0,l=g.y||0,h=g.width||m.width,u=g.height||m.height,q=h*u*4,g=g.data||new Uint8Array(q);a.isTypedArray(g);a(g.byteLength>=q,"data buffer too small");c.pixelStorei(3333,4);c.readPixels(e,l,h,u,6408,5121,g);return g}}},{"./check":4,"./is-typed-array":19}],25:[function(e,h,n){var a=e("./check"),b=
e("./values");h.exports=function(c,d,m){function f(){this.id=h++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function g(a){c.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=c.createRenderbuffer());c.bindRenderbuffer(36161,a.renderbuffer);c.renderbufferStorage(36161,a.format,a.width,a.height)}function e(b){var d=b.renderbuffer;a(d,"must not double destroy renderbuffer");c.bindRenderbuffer(36161,null);c.isRenderbuffer(d)&&c.deleteRenderbuffer(d);b.renderbuffer=
null;b.refCount=0;delete u[b.id]}var l={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};d.ext_srgb&&(l.srgba=35907);d.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);d.webgl_color_buffer_float&&(l.rgba32f=34836);var h=0,u={};f.prototype.decRef=function(){0===--this.refCount&&e(this)};return{create:function(b){function c(b){b=b||{};var f=0,e=0;"shape"in b?(e=b.shape,a(Array.isArray(e)&&2<=e.length,"invalid renderbuffer shape"),f=e[0]|0,e=e[1]|
0):("radius"in b&&(f=e=b.radius|0),"width"in b&&(f=b.width|0),"height"in b&&(e=b.height|0));var k=m.maxRenderbufferSize;a(0<=f&&0<=e&&f<=k&&e<=k,"invalid renderbuffer size");c.width=d.width=Math.max(f,1);c.height=d.height=Math.max(e,1);d.format=32854;"format"in b&&(b=b.format,a.parameter(b,l,"invalid render buffer format"),d.format=l[b]);g(d);return c}var d=new f;u[d.id]=d;c(b);c._reglType="renderbuffer";c._renderbuffer=d;c.destroy=function(){d.decRef()};return c},refresh:function(){b(u).forEach(g)},
clear:function(){b(u).forEach(e)}}}},{"./check":4,"./values":33}],26:[function(e,h,n){function a(a,b,c){this.name=a;this.location=b;this.info=c}var b=e("./check"),c=e("./values");h.exports=function(d,m,f,g,e){function l(a,c){var f=35632===a?q:r,m=f[c];if(!m){var g=e.str(c),m=d.createShader(a);d.shaderSource(m,g);d.compileShader(m);b.shaderError(d,m,g,a);f[c]=m}return m}function h(a,b){this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache=
{}}function u(c){var e,k;e=l(35632,c.fragId);k=l(35633,c.vertId);var q=c.program=d.createProgram();d.attachShader(q,e);d.attachShader(q,k);d.linkProgram(q);b.linkError(d,q);var h=d.getProgramParameter(q,35718),p=c.uniforms=[];for(e=0;e<h;++e)if(k=d.getActiveUniform(q,e))if(1<k.size)for(var r=0;r<k.size;++r){var w=k.name.replace("[0]","["+r+"]");f.def(w);p.push(new a(w,d.getUniformLocation(q,w),k))}else f.def(k.name),p.push(new a(k.name,d.getUniformLocation(q,k.name),k));h=d.getProgramParameter(q,
35721);p=c.attributes=[];for(e=0;e<h;++e)if(k=d.getActiveAttrib(q,e))m.def(k.name),p.push(new a(k.name,d.getAttribLocation(q,k.name),k));c.draw=g(c);c.batchCache={}}var q={},r={},p={},w=[];return{create:function(a,b){var c=p[b];c||(c=p[b]={});var d=c[a];d||(d=new h(b,a),u(d),c[a]=d,w.push(d));return d},clear:function(){var a=d.deleteShader.bind(d);c(q).forEach(a);q={};c(r).forEach(a);r={};w.forEach(function(a){d.deleteProgram(a.program)});w.length=0;p={}},refresh:function(){q={};r={};w.forEach(u)},
programs:[null],fragShaders:[e.id("void main(){gl_FragColor=vec4(0,0,0,0);}")],vertShaders:[e.id("void main(){gl_Position=vec4(0,0,0,0);}")]}}},{"./check":4,"./values":33}],27:[function(e,h,n){h.exports=function(a,b){var c=a.length,d=a.slice(),m=a.slice(),f=!1,e=!0;return{push:function(){f=!1;for(var a=0;a<c;++a){var b=arguments[a];f=f||b!==m[a];d.push(b)}},pop:function(){f=!1;d.length-=c;for(var a=0;a<c;++a)f=f||d[d.length-c+a]!==m[a]},poll:function(){var a=d.length-c;if(f||e){switch(c){case 1:b(d[a]);
break;case 2:b(d[a],d[a+1]);break;case 3:b(d[a],d[a+1],d[a+2]);break;case 4:b(d[a],d[a+1],d[a+2],d[a+3]);break;case 5:b(d[a],d[a+1],d[a+2],d[a+3],d[a+4]);break;case 6:b(d[a],d[a+1],d[a+2],d[a+3],d[a+4],d[a+5]);break;default:b.apply(null,d.slice(a,d.length))}for(var l=0;l<c;++l)m[l]=d[a+l];e=f=!1}},setDirty:function(){e=!0}}}},{}],28:[function(e,h,n){var a=e("./stack"),b=e("./codegen");h.exports=function(c,d,m){function f(b,d){var f=a([!!d],function(a){a?c.enable(b):c.disable(b)});f.flag=b;return f}
var e={dither:f(3024),"blend.enable":f(3042),"blend.color":a([0,0,0,0],function(a,b,d,f){c.blendColor(a,b,d,f)}),"blend.equation":a([32774,32774],function(a,b){c.blendEquationSeparate(a,b)}),"blend.func":a([1,0,1,0],function(a,b,d,f){c.blendFuncSeparate(a,b,d,f)}),"depth.enable":f(2929,!0),"depth.func":a([513],function(a){c.depthFunc(a)}),"depth.range":a([0,1],function(a,b){c.depthRange(a,b)}),"depth.mask":a([!0],function(a){c.depthMask(a)}),"cull.enable":f(2884),"cull.face":a([1029],function(a){c.cullFace(a)}),
frontFace:a([2305],function(a){c.frontFace(a)}),colorMask:a([!0,!0,!0,!0],function(a,b,d,f){c.colorMask(a,b,d,f)}),lineWidth:a([1],function(a){c.lineWidth(a)}),"polygonOffset.enable":f(32823),"polygonOffset.offset":a([0,0],function(a,b){c.polygonOffset(a,b)}),"sample.alpha":f(32926),"sample.enable":f(32928),"sample.coverage":a([1,!1],function(a,b){c.sampleCoverage(a,b)}),"stencil.enable":f(2960),"stencil.mask":a([-1],function(a){c.stencilMask(a)}),"stencil.func":a([519,0,-1],function(a,b,d){c.stencilFunc(a,
b,d)}),"stencil.opFront":a([7680,7680,7680],function(a,b,d){c.stencilOpSeparate(1028,a,b,d)}),"stencil.opBack":a([7680,7680,7680],function(a,b,d){c.stencilOpSeparate(1029,a,b,d)}),"scissor.enable":f(3089),"scissor.box":a([0,0,-1,-1],function(a,b,f,e){var m=f,g=d.top();0>f&&(m=g?g.width-a:c.drawingBufferWidth-a);f=e;0>e&&(f=g?g.height-b:c.drawingBufferHeight-b);c.scissor(a,b,m,f)}),viewport:a([0,0,-1,-1],function(a,b,f,e){var g=f,l=d.top();0>f&&(g=l?l.width-a:c.drawingBufferWidth-a);f=e;0>e&&(f=l?
l.height-b:c.drawingBufferHeight-b);c.viewport(a,b,g,f);m.width=g;m.height=f})},k=b(),l=k.proc("poll"),h=k.proc("refresh");Object.keys(e).forEach(function(a){a=k.link(e[a]);l(a,".poll();");h(a,".setDirty();")});var u=k.compile();return{contextState:e,viewport:m,poll:u.poll,refresh:u.refresh,notifyViewportChanged:function(){e.viewport.setDirty();e["scissor.box"].setDirty()}}}},{"./codegen":6,"./stack":27}],29:[function(e,h,n){h.exports=function(){var a={},b=[""];return{id:function(c){var d=a[c];if(d)return d;
d=a[c]=b.length;b.push(c);return d},str:function(a){return b[a]}}}},{}],30:[function(e,h,n){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function b(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var c=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==c)return!1;return!0}function c(a){return Object.prototype.toString.call(a)}function d(a){return"[object HTMLCanvasElement]"===c(a)}function m(a){return"[object CanvasRenderingContext2D]"===
c(a)}var f=e("./check"),g=e("./extend"),k=e("./values"),l=e("./is-typed-array"),F=e("./is-ndarray"),u=e("./load-texture"),q=e("./to-half-float"),r=e("./parse-dds"),p=[9984,9986,9985,9987];h.exports=function(e,h,n,y,A){function x(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=this.miplevel=0;
this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function K(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function G(a,b){var c,d,e=0,m=0,g=0,l=0,k=0,q=0,F=!1,r=!1,u=!1,t=0,n=[0,0,0,0,0,0],v=0,w=!1;for(c=0;c<b.length;++c){d=b[c];var l=l||d.width<<d.miplevel,k=k||
d.height<<d.miplevel,e=e||d.type,m=m||d.format,g=g||d.internalformat,q=q||d.channels,r=r||d.needsPoll,u=u||d.needsListeners,F=F||d.compressed,x=d.miplevel;d=d.target;w=w||0<x;3553===d?t|=1<<x:(d-=34069,n[d]|=1<<x,v|=1<<d)}a.needsPoll=r;a.needsListeners=u;a.width=l;a.height=k;a.format=m;a.internalformat=g;a.type=e;r=w?(l<<1)-1:1;if(3553===a.target)f(0===v,"pixmap type must not contain cubemap faces"),f(t===r,"missing mip map data");else for(f(63===v,"missing cubemap faces"),c=0;6>c;++c)f(n[c]===r,
"missing mip map data");c=0<=p.indexOf(a.minFilter);a.genMipmaps=!w&&(a.genMipmaps||c);w=w||a.genMipmaps;a.minFilter?f(w===c,"min filter inconsistent with mipmap data"):a.minFilter=w?9987:9728;w&&f(l===k&&!(l&l-1)&&!!l,"must be a square power of 2 to support mipmaps");a.genMipmaps&&f(!F,"mipmap generation not supported for compressed textures");a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;33071===a.wrapS&&33071===a.wrapT||f(!(l&l-1)&&!!l&&!(k&k-1)&&!!k&&!v,"incompatible size for wrap mode, image must be a power of 2");
(5126===e&&!h.oes_texture_float_linear||36193===e&&!h.oes_texture_half_float_linear)&&f(9728===this.magFilter&&9728===this.minFilter,"unsupported filter mode for float texture");for(c=0;c<b.length;++c)d=b[c],F=d.miplevel,d.width&&f(d.width<<F===l,"inconsistent width"),d.height&&f(d.height<<F===k,"inconsistent width"),d.channels?f(d.channels===q,"inconsistent channels"):d.channels=q,d.format?f(d.format===m,"inconsistent format"):d.format=m,d.internalformat?f(d.internalformat===g,"inconsistent internalformat"):
d.internalformat=g,d.type?f(d.type===e,"inconsistent type"):d.type=e,d.copy&&f(5121===d.type&&6408===d.internalformat,"incompatible format/type for copyTexImage2D")}function I(a){this.id=J++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new K(a);this.pixels=[]}function S(a,b){function c(a,d){var e=d.mipmap,f;if(Array.isArray(e))for(var g=0;g<e.length;++g)f=new x(a),f.parseFlags(b),f.parseFlags(d),f.parse(e[g],g),m.push(f);
else f=new x(a),f.parseFlags(b),f.parse(d,0),m.push(f)}var d;U(a);var e=a.params;K.call(e,a.target);var m=a.pixels;m.length=0;e.parse(b);if(3553===a.target)c(3553,b);else{var g=b.faces||b;if(Array.isArray(g))for(f(6===g.length,"invalid number of faces in cube map"),d=0;6>d;++d)c(34069+d,g[d]);else if("string"!==typeof g)for(d=0;6>d;++d)c(34069+d,{})}G(e,m);e.needsListeners&&Y(a);e.needsPoll&&(a.pollId=N.length,N.push(a));W(a)}function W(a){e.isTexture(a.texture)||(a.texture=e.createTexture());var b=
a.target,c=a.unit;0<=c?(e.activeTexture(33984+c),da=c):e.bindTexture(b,a.texture);for(var b=a.pixels,d=a.params,f=0;f<b.length;++f)b[f].upload(d);d.upload();0>c&&((c=ha[da])?e.bindTexture(c.target,c.texture):(a.unit=da,ha[da]=a))}function Y(a){function b(c,d,m){var g=r(m);f(g.format in ca,"unsupported dds texture format");g.cube?(f(34067===a.target),f.raise("cube map DDS not yet implemented")):f(3553===a.target);d&&f(1===g.pixels.length,"number of mip levels inconsistent");g.pixels.forEach(function(a){var b=
new x(g.cube?a.target:c);b.channels=g.channels;b.compressed=g.compressed;b.type=g.type;b.internalformat=g.format;b.format=ca[g.format];b.width=a.width;b.height=a.height;b.miplevel=a.miplevel||d;b.data=a.data;e.push(b)})}function c(){for(var f=0;f<e.length;++f){var m=e[f],g=m.image,l=m.video,k=m.xhr;g&&g.complete?(m.width=g.naturalWidth,m.height=g.naturalHeight):l&&2<l.readyState?(m.width=l.width,m.height=l.height):k&&4===k.readyState&&(e[f]=e[e.length-1],e.pop(),k.removeEventListener("readystatechange",
W),b(m.target,m.miplevel,k.response))}G(d,e);W(a)}var d=a.params,e=a.pixels;e.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){e.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function U(a){var b=
a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((N[b]=N[N.length-1]).id=b,N.pop(),a.pollId=-1)}function fa(a){var b=a.texture;f(b,"must not double destroy texture");var c=a.unit,d=a.target;0<=c&&(e.activeTexture(33984+c),da=c,e.bindTexture(d,null),ha[c]=null);U(a);e.isTexture(b)&&e.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete t[a.id]}var D={"don't care":4352,"dont care":4352,nice:4354,fast:4353},O={repeat:10497,clamp:33071,mirror:33648},P={nearest:9728,
linear:9729},ja=g({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},P),ka={none:0,browser:37444},ia={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Z={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ga={};h.ext_srgb&&(Z.srgb=35904,Z.srgba=35906);h.oes_texture_float&&(ia["float"]=5126);h.oes_texture_half_float&&(ia["half float"]=36193);h.webgl_depth_texture&&
(g(Z,{depth:6402,"depth stencil":34041}),g(ia,{uint16:5123,uint32:5125,"depth stencil":34042}));h.webgl_compressed_texture_s3tc&&g(ga,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});h.webgl_compressed_texture_atc&&g(ga,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});h.webgl_compressed_texture_pvrtc&&g(ga,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});h.webgl_compressed_texture_etc1&&
(ga["rgb etc1"]=36196);var ba=Array.prototype.slice.call(e.getParameter(34467));Object.keys(ga).forEach(function(a){var b=ga[a];0<=ba.indexOf(b)&&(Z[a]=b)});var E=Object.keys(Z);n.textureFormats=E;var ca=E.reduce(function(a,b){var c=Z[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});g(x.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in a&&(f.type(a.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),
this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(f.type(a.flipY,"boolean","invalid texture flip"),this.flipY=a.flipY);"alignment"in a&&(f.oneOf(a.alignment,[1,2,4,8],"invalid texture unpack alignment"),this.unpackAlignment=a.alignment);"colorSpace"in a&&(f.parameter(a.colorSpace,ka,"invalid colorSpace"),this.colorSpace=ka[a.colorSpace]);if("format"in a){var b=a.format;f.parameter(b,Z,"invalid texture format");this.internalformat=Z[b];b in ia&&(this.type=ia[b]);b in ga&&(this.compressed=!0)}"type"in
a&&(b=a.type,f.parameter(b,ia,"invalid texture type"),this.type=ia[b]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(f(Array.isArray(a.shape)&&2<=a.shape.length,"shape must be an array"),b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=a.width),"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,f(Array.isArray(b)&&2<=b.length,"invalid stride vector"),
this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(e,g){this.miplevel=g;this.width>>=g;this.height>>=g;var k=e;switch(typeof e){case "string":break;case "object":if(!e)return;this.parseFlags(e);var p=e.data;if("string"===typeof p||p&&(l(p)||a(p)||F(p)||d(p)||
m(p)||"[object HTMLImageElement]"===c(p)||"[object HTMLVideoElement]"===c(p)||b(p)))k=e.data;break;case "undefined":return;default:f.raise("invalid pixel data type")}"string"===typeof k&&(k=u(k,this.crossOrigin));var p=null,r=!1;this.compressed&&f(k instanceof Uint8Array||"[object XMLHttpRequest]"===c(k),"compressed texture data must be stored in a uint8array");if(null!==k)if(l(k))this.data=k;else if(a(k))p=k,r=!0;else if(F(k)){Array.isArray(k.data)?(p=k.data,r=!0):this.data=k.data;var t=k.shape;
this.width=t[0];this.height=t[1];this.channels=3===t.length?t[2]:1;t=k.stride;this.strideX=k.stride[0];this.strideY=k.stride[1];this.strideC=3===t.length?k.stride[2]:1;this.offset=k.offset;this.needsTranspose=!0}else if(d(k)||m(k))d(k)?this.canvas=k:this.canvas=k.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===c(k))this.image=k,k.complete?(this.width=k.naturalWidth,this.height=k.naturalHeight):(this.width=this.width||
k.naturalWidth,this.height=this.height||k.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();else if("[object HTMLVideoElement]"===c(k))this.video=k,1<k.readyState?(this.width=k.width,this.height=k.height):(this.width=this.width||k.width,this.height=this.height||k.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===c(k))this.xhr=k,this.needsListeners=!0;else if(b(k)){var r=k.length,t=k[0].length,n=1,w,v,x,y;if(Array.isArray(k[0][0]))for(n=
k[0][0].length,f(0<=n&&4>=n,"invalid number of channels for image data"),p=Array(r*t*n),v=y=0;v<t;++v)for(w=0;w<r;++w)for(x=0;x<n;++x)p[y++]=k[w][v][x];else for(p=Array(r*t),v=y=0;v<t;++v)for(w=0;w<r;++w)p[y++]=k[w][v];this.width=r;this.height=t;this.channels=n;r=!0}else e.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||A.width)|0,this.height=(this.height||A.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:
this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,6410,6407,6408][(this.channels=this.channels||4)-1],f(this.internalformat,"invalid number of channels"));t=this.internalformat;if(6402===t||34041===t)f(h.webgl_depth_texture,"depth/stencil texture not supported"),6402===t&&f(5123===this.type||5125,"depth texture type must be uint16 or uint32"),34041===t&&f(34042===this.type,"depth stencil texture format must match type"),
f(!this.data&&!p&&!this.image&&!this.video&&!this.canvas,"depth/stencil textures are for rendering only");k=this.format=ca[t];if(!this.channels)switch(k){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}k=this.type;5126===k?f(h.oes_texture_float,"float texture not supported"):36193===k?f(h.oes_texture_half_float,"half float texture not supported"):k||(k=6402===t?5125:5121);this.type=k;if(r)switch(k){case 5121:this.data=
new Uint8Array(p);break;case 5123:this.data=new Uint16Array(p);break;case 5125:this.data=new Uint32Array(p);break;case 5126:this.data=new Float32Array(p);break;case 36193:this.data=q(p);break;case 33635:case 32820:case 32819:case 34042:f.raise("unsupported format for automatic conversion");break;default:f.raise("unsupported type conversion")}if(this.data){if(this.needsTranspose){p=this.data;r=this.width;t=this.height;n=this.channels;w=this.strideX;v=this.strideY;x=this.strideC;y=this.offset;for(var C=
new p.constructor(r*t*n),G=0,D=0;D<t;++D)for(var E=0;E<r;++E)for(var I=0;I<n;++I)C[G++]=p[v*D+w*E+x*I+y];this.data=C}switch(k){case 5121:f(this.data instanceof Uint8Array||this.data instanceof Uint8ClampedArray,"incompatible pixel type");break;case 33635:case 32820:case 32819:case 5123:case 36193:f(this.data instanceof Uint16Array,"incompatible pixel type");break;case 5125:f(this.data instanceof Uint32Array,"incompatible pixel type");break;case 5126:f(this.data instanceof Float32Array,"incompatible pixel type");
break;default:f.raise("bad or missing pixel type")}}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){e.pixelStorei(37440,this.flipY);e.pixelStorei(37441,this.premultiplyAlpha);e.pixelStorei(37443,this.colorSpace);e.pixelStorei(3317,this.unpackAlignment);var b=this.target,c=this.miplevel,d=this.image,f=this.canvas,m=this.video,g=this.data,k=this.internalformat,l=this.format,h=this.type,p=this.width||
Math.max(1,a.width>>c);a=this.height||Math.max(1,a.height>>c);m&&2<m.readyState?e.texImage2D(b,c,l,l,h,m):d&&d.complete?e.texImage2D(b,c,l,l,h,d):f?e.texImage2D(b,c,l,l,h,f):this.compressed?e.compressedTexImage2D(b,c,k,p,a,0,g):this.copy?(y(),e.copyTexImage2D(b,c,l,this.x,this.y,p,a,0)):g?e.texImage2D(b,c,l,p,a,0,l,h,g):e.texImage2D(b,c,l,p||1,a||1,0,l,h,null)}});g(K.prototype,{parse:function(a){if("object"===typeof a&&a){if("min"in a){var b=a.min;f.parameter(b,ja);this.minFilter=ja[b]}"mag"in a&&
(b=a.mag,f.parameter(b,P),this.magFilter=P[b]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?(f.parameter(d,O),b=c=O[d]):Array.isArray(d)&&(f.parameter(d[0],O),f.parameter(d[1],O),b=O[d[0]],c=O[d[1]])}else"wrapS"in a&&(b=a.wrapS,f.parameter(b,O),b=O[b]),"wrapT"in a&&(c=a.wrapT,f.parameter(c,O),c=O[c]);this.wrapS=b;this.wrapT=c;"anisotropic"in a&&(b=a.anisotropic,f("number"===typeof b&&1<=b&&b<=n.maxAnisotropic,"aniso samples must be between 1 and "),this.anisotropic=
a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":f.parameter(a,D,"invalid mipmap hint");this.mipmapHint=D[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a;break;case "object":break;default:f.raise("invalid mipmap type")}}},upload:function(){var a=this.target;e.texParameteri(a,10241,this.minFilter);e.texParameteri(a,10240,this.magFilter);e.texParameteri(a,10242,this.wrapS);e.texParameteri(a,10243,this.wrapT);h.ext_texture_filter_anisotropic&&e.texParameteri(a,
34046,this.anisotropic);this.genMipmaps&&(e.hint(33170,this.mipmapHint),e.generateMipmap(a))}});var da=0,J=0,t={},N=[],L=n.maxTextureUnits,ha=Array(L).map(function(){return null});g(I.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<L;++b){var c=ha[b];if(c){if(0<c.bindCount)continue;c.unit=-1}ha[b]=this;a=b;break}a>=L&&f.raise("insufficient number of texture units");this.unit=a;e.activeTexture(33984+a);e.bindTexture(this.target,this.texture);da=a}return a},unbind:function(){--this.bindCount},
decRef:function(){0===--this.refCount&&fa(this)}});return{create:function(a,b){function c(a,e,f,m,g,k){var l=a||{};34067===b&&6===arguments.length&&(l=[a,e,f,m,g,k]);S(d,l);c.width=d.params.width;c.height=d.params.height;return c}var d=new I(b);t[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){k(t).forEach(W);for(var a=0;a<L;++a)ha[a]=null;da=0;e.activeTexture(33984)},clear:function(){for(var a=0;a<L;++a)e.activeTexture(33984+a),e.bindTexture(3553,
null),ha[a]=null;e.activeTexture(33984);da=0;k(t).forEach(fa)},poll:function(){N.forEach(W)},getTexture:function(a){return null}}}},{"./check":4,"./extend":15,"./is-ndarray":18,"./is-typed-array":19,"./load-texture":21,"./parse-dds":22,"./to-half-float":31,"./values":33}],31:[function(e,h,n){h.exports=function(a){for(var b=new Float32Array(a),b=new Uint32Array(b.buffer),c=new Uint16Array(a.length),d=0;d<a.length;++d)if(isNaN(a[d]))c[d]=65535;else if(Infinity===a[d])c[d]=31744;else if(-Infinity===
a[d])c[d]=64512;else{var e=b[d],f=e>>>31<<15,g=(e<<1>>>24)-127,e=e>>13&1023;c[d]=-24>g?f:-14>g?f+(e+1024>>-14-g):15<g?f+31744:f+(g+15<<10)+e}return c}},{}],32:[function(e,h,n){h.exports=function(a){var b={};return{def:function(c){c=a.id(c);var d=b[c];d||(d=b[c]=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]);return d}}}},{}],33:[function(e,h,n){h.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},{}],34:[function(e,h,n){h.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],k=
b[5],l=b[6],h=b[7],u=b[8],q=b[9],r=b[10],p=b[11],n=b[12],z=b[13],v=b[14],y=b[15];a[0]=k*(r*y-p*v)-q*(l*y-h*v)+z*(l*p-h*r);a[1]=-(d*(r*y-p*v)-q*(e*y-f*v)+z*(e*p-f*r));a[2]=d*(l*y-h*v)-k*(e*y-f*v)+z*(e*h-f*l);a[3]=-(d*(l*p-h*r)-k*(e*p-f*r)+q*(e*h-f*l));a[4]=-(g*(r*y-p*v)-u*(l*y-h*v)+n*(l*p-h*r));a[5]=c*(r*y-p*v)-u*(e*y-f*v)+n*(e*p-f*r);a[6]=-(c*(l*y-h*v)-g*(e*y-f*v)+n*(e*h-f*l));a[7]=c*(l*p-h*r)-g*(e*p-f*r)+u*(e*h-f*l);a[8]=g*(q*y-p*z)-u*(k*y-h*z)+n*(k*p-h*q);a[9]=-(c*(q*y-p*z)-u*(d*y-f*z)+n*(d*p-f*
q));a[10]=c*(k*y-h*z)-g*(d*y-f*z)+n*(d*h-f*k);a[11]=-(c*(k*p-h*q)-g*(d*p-f*q)+u*(d*h-f*k));a[12]=-(g*(q*v-r*z)-u*(k*v-l*z)+n*(k*r-l*q));a[13]=c*(q*v-r*z)-u*(d*v-e*z)+n*(d*r-e*q);a[14]=-(c*(k*v-l*z)-g*(d*v-e*z)+n*(d*l-e*k));a[15]=c*(k*r-l*q)-g*(d*r-e*q)+u*(d*l-e*k);return a}},{}],35:[function(e,h,n){h.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=
a[14];b[15]=a[15];return b}},{}],36:[function(e,h,n){h.exports=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],37:[function(e,h,n){h.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],38:[function(e,h,n){h.exports=function(a){var b=
a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],k=a[6],l=a[7],h=a[8],u=a[9],q=a[10],r=a[11],p=a[12],n=a[13],z=a[14];a=a[15];return(b*g-c*f)*(q*a-r*z)-(b*k-d*f)*(u*a-r*n)+(b*l-e*f)*(u*z-q*n)+(c*k-d*g)*(h*a-r*p)-(c*l-e*g)*(h*z-q*p)+(d*l-e*k)*(h*n-u*p)}},{}],39:[function(e,h,n){h.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,k=d+d,l=e+e,c=c*g,h=d*g,d=d*k,n=e*g,q=e*k,e=e*l,g=f*g,k=f*k,f=f*l;a[0]=1-d-e;a[1]=h+f;a[2]=n-k;a[3]=0;a[4]=h-f;a[5]=1-c-e;a[6]=q+g;a[7]=0;a[8]=n+k;a[9]=q-g;a[10]=1-c-d;a[11]=
0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],40:[function(e,h,n){h.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],k=d+d,l=e+e,h=f+f;b=d*k;var n=d*l,d=d*h,q=e*l,e=e*h,f=f*h,k=g*k,l=g*l,g=g*h;a[0]=1-(q+f);a[1]=n+g;a[2]=d-l;a[3]=0;a[4]=n-g;a[5]=1-(b+f);a[6]=e+k;a[7]=0;a[8]=d+l;a[9]=e-k;a[10]=1-(b+q);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}},{}],41:[function(e,h,n){h.exports=function(a,b,c,d,e,f,g){var k=1/(c-b),l=1/(e-d),h=1/(f-g);a[0]=2*f*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;
a[5]=2*f*l;a[6]=0;a[7]=0;a[8]=(c+b)*k;a[9]=(e+d)*l;a[10]=(g+f)*h;a[11]=-1;a[12]=0;a[13]=0;a[14]=g*f*2*h;a[15]=0;return a}},{}],42:[function(e,h,n){h.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],43:[function(e,h,n){h.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),
multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":34,"./clone":35,"./copy":36,"./create":37,"./determinant":38,"./fromQuat":39,
"./fromRotationTranslation":40,"./frustum":41,"./identity":42,"./invert":44,"./lookAt":45,"./multiply":46,"./ortho":47,"./perspective":48,"./perspectiveFromFieldOfView":49,"./rotate":50,"./rotateX":51,"./rotateY":52,"./rotateZ":53,"./scale":54,"./str":55,"./translate":56,"./transpose":57}],44:[function(e,h,n){h.exports=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],k=b[5],l=b[6],h=b[7],n=b[8],q=b[9],r=b[10],p=b[11],w=b[12],z=b[13],v=b[14],y=b[15],A=c*k-d*g,x=c*l-e*g,K=c*h-f*g,G=d*l-e*k,I=d*
h-f*k,S=e*h-f*l,W=n*z-q*w,Y=n*v-r*w,U=n*y-p*w,fa=q*v-r*z,D=q*y-p*z,O=r*y-p*v,P=A*O-x*D+K*fa+G*U-I*Y+S*W;if(!P)return null;P=1/P;a[0]=(k*O-l*D+h*fa)*P;a[1]=(e*D-d*O-f*fa)*P;a[2]=(z*S-v*I+y*G)*P;a[3]=(r*I-q*S-p*G)*P;a[4]=(l*U-g*O-h*Y)*P;a[5]=(c*O-e*U+f*Y)*P;a[6]=(v*K-w*S-y*x)*P;a[7]=(n*S-r*K+p*x)*P;a[8]=(g*D-k*U+h*W)*P;a[9]=(d*U-c*D-f*W)*P;a[10]=(w*I-z*K+y*A)*P;a[11]=(q*K-n*I-p*A)*P;a[12]=(k*Y-g*fa-l*W)*P;a[13]=(c*fa-d*Y+e*W)*P;a[14]=(z*x-w*G-v*A)*P;a[15]=(n*G-q*x+r*A)*P;return a}},{}],45:[function(e,
h,n){var a=e("./identity");h.exports=function(b,c,d,e){var f,g,k,l,h,n,q,r,p=c[0],w=c[1];c=c[2];k=e[0];l=e[1];g=e[2];q=d[0];e=d[1];f=d[2];if(1E-6>Math.abs(p-q)&&1E-6>Math.abs(w-e)&&1E-6>Math.abs(c-f))return a(b);d=p-q;e=w-e;q=c-f;r=1/Math.sqrt(d*d+e*e+q*q);d*=r;e*=r;q*=r;f=l*q-g*e;g=g*d-k*q;k=k*e-l*d;(r=Math.sqrt(f*f+g*g+k*k))?(r=1/r,f*=r,g*=r,k*=r):k=g=f=0;l=e*k-q*g;h=q*f-d*k;n=d*g-e*f;(r=Math.sqrt(l*l+h*h+n*n))?(r=1/r,l*=r,h*=r,n*=r):n=h=l=0;b[0]=f;b[1]=l;b[2]=d;b[3]=0;b[4]=g;b[5]=h;b[6]=e;b[7]=
0;b[8]=k;b[9]=n;b[10]=q;b[11]=0;b[12]=-(f*p+g*w+k*c);b[13]=-(l*p+h*w+n*c);b[14]=-(d*p+e*w+q*c);b[15]=1;return b}},{"./identity":42}],46:[function(e,h,n){h.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],k=b[4],h=b[5],n=b[6],u=b[7],q=b[8],r=b[9],p=b[10],w=b[11],z=b[12],v=b[13],y=b[14];b=b[15];var A=c[0],x=c[1],K=c[2],G=c[3];a[0]=A*d+x*k+K*q+G*z;a[1]=A*e+x*h+K*r+G*v;a[2]=A*f+x*n+K*p+G*y;a[3]=A*g+x*u+K*w+G*b;A=c[4];x=c[5];K=c[6];G=c[7];a[4]=A*d+x*k+K*q+G*z;a[5]=A*e+x*h+K*r+G*v;a[6]=A*f+x*n+K*
p+G*y;a[7]=A*g+x*u+K*w+G*b;A=c[8];x=c[9];K=c[10];G=c[11];a[8]=A*d+x*k+K*q+G*z;a[9]=A*e+x*h+K*r+G*v;a[10]=A*f+x*n+K*p+G*y;a[11]=A*g+x*u+K*w+G*b;A=c[12];x=c[13];K=c[14];G=c[15];a[12]=A*d+x*k+K*q+G*z;a[13]=A*e+x*h+K*r+G*v;a[14]=A*f+x*n+K*p+G*y;a[15]=A*g+x*u+K*w+G*b;return a}},{}],47:[function(e,h,n){h.exports=function(a,b,c,d,e,f,g){var k=1/(b-c),h=1/(d-e),n=1/(f-g);a[0]=-2*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*h;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*n;a[11]=0;a[12]=(b+c)*k;a[13]=(e+d)*h;a[14]=(g+f)*n;
a[15]=1;return a}},{}],48:[function(e,h,n){h.exports=function(a,b,c,d,e){b=1/Math.tan(b/2);var f=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*f;a[15]=0;return a}},{}],49:[function(e,h,n){h.exports=function(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var k=2/(g+b),h=2/(e+f);a[0]=k;a[1]=0;a[2]=0;
a[3]=0;a[4]=0;a[5]=h;a[6]=0;a[7]=0;a[8]=-((g-b)*k*.5);a[9]=(e-f)*h*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a}},{}],50:[function(e,h,n){h.exports=function(a,b,c,d){var e=d[0],f=d[1];d=d[2];var g=Math.sqrt(e*e+f*f+d*d),k,h,n,u,q,r,p,w,z,v,y,A,x,K,G,I,S,W,Y,U;if(1E-6>Math.abs(g))return null;g=1/g;e*=g;f*=g;d*=g;k=Math.sin(c);h=Math.cos(c);n=1-h;c=b[0];g=b[1];u=b[2];q=b[3];r=b[4];p=b[5];w=b[6];z=b[7];v=b[8];y=b[9];A=b[10];x=b[11];K=e*e*n+h;G=f*e*n+d*k;I=d*e*n-f*k;S=e*
f*n-d*k;W=f*f*n+h;Y=d*f*n+e*k;U=e*d*n+f*k;e=f*d*n-e*k;f=d*d*n+h;a[0]=c*K+r*G+v*I;a[1]=g*K+p*G+y*I;a[2]=u*K+w*G+A*I;a[3]=q*K+z*G+x*I;a[4]=c*S+r*W+v*Y;a[5]=g*S+p*W+y*Y;a[6]=u*S+w*W+A*Y;a[7]=q*S+z*W+x*Y;a[8]=c*U+r*e+v*f;a[9]=g*U+p*e+y*f;a[10]=u*U+w*e+A*f;a[11]=q*U+z*e+x*f;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],51:[function(e,h,n){h.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],k=b[7],h=b[8],n=b[9],u=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=
b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+h*d;a[5]=f*c+n*d;a[6]=g*c+u*d;a[7]=k*c+q*d;a[8]=h*c-e*d;a[9]=n*c-f*d;a[10]=u*c-g*d;a[11]=q*c-k*d;return a}},{}],52:[function(e,h,n){h.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],l=b[8],n=b[9],u=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-l*d;a[1]=f*c-n*d;a[2]=g*c-u*d;a[3]=h*c-q*d;a[8]=e*d+l*c;a[9]=
f*d+n*c;a[10]=g*d+u*c;a[11]=h*d+q*c;return a}},{}],53:[function(e,h,n){h.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],l=b[4],n=b[5],u=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+l*d;a[1]=f*c+n*d;a[2]=g*c+u*d;a[3]=h*c+q*d;a[4]=l*c-e*d;a[5]=n*c-f*d;a[6]=u*c-g*d;a[7]=q*c-h*d;return a}},{}],54:[function(e,h,n){h.exports=function(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*
d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],55:[function(e,h,n){h.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],56:[function(e,h,n){h.exports=function(a,b,c){var d=c[0],e=c[1];c=c[2];var f,g,h,l,n,
u,q,r,p,w,z,v;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],g=b[1],h=b[2],l=b[3],n=b[4],u=b[5],q=b[6],r=b[7],p=b[8],w=b[9],z=b[10],v=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=l,a[4]=n,a[5]=u,a[6]=q,a[7]=r,a[8]=p,a[9]=w,a[10]=z,a[11]=v,a[12]=f*d+n*e+p*c+b[12],a[13]=g*d+u*e+w*c+b[13],a[14]=h*d+q*e+z*c+b[14],a[15]=l*d+r*e+v*c+b[15]);return a}},{}],57:[function(e,h,n){h.exports=function(a,b){if(a===b){var c=
b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],58:[function(e,h,n){function a(a,c,d,e){e[0]=b(255*a);e[1]=b(255*c);e[2]=b(255*d)}var b=Math.round,c=Math.min,d=Math.max,m=Math.ceil;h.exports=function(b,e,h,l){l=
l||[0,0,0];b%=360;e=d(0,c(e,1));h=d(0,c(h,1));if(e){e=(1-e)*h;var n=h-e,u=b%60;switch(b/60|0){case 0:a(h,n*b/60+e,e,l);break;case 1:a(n*(60-u)/60+e,h,e,l);break;case 2:a(e,h,n*u/60+e,l);break;case 3:a(e,n*(60-u)/60+e,h,l);break;case 4:a(n*u/60+e,e,h,l);break;case 5:a(h,e,n*(60-u)/60+e,l)}}else l[0]=l[1]=l[2]=m(255*h);return l}},{}],59:[function(e,h,n){var a=e("./lib/check"),b=e("./lib/extend"),c=e("./lib/context"),d=e("./lib/strings"),m=e("./lib/extension"),f=e("./lib/limits"),g=e("./lib/buffer"),
k=e("./lib/elements"),l=e("./lib/texture"),F=e("./lib/renderbuffer"),u=e("./lib/framebuffer"),q=e("./lib/uniform"),r=e("./lib/attribute"),p=e("./lib/shader"),w=e("./lib/draw"),z=e("./lib/state"),v=e("./lib/compile"),y=e("./lib/read"),A=e("./lib/dynamic"),x=e("./lib/raf"),K=e("./lib/clock");h.exports=function(){function e(){X=x.next(e);L.count+=1;if(L.width!==D.drawingBufferWidth||L.height!==D.drawingBufferHeight)L.width=D.drawingBufferWidth,L.height=D.drawingBufferHeight,ha.notifyViewportChanged();
var a=K();L.dt=a-L.t;L.t=a;J.poll();for(var b=0;b<V.length;++b)(0,V[b])(L.count,L.t,L.dt);L.renderTime=K()-a}function h(){X&&(x.cancel(e),X=0)}function n(a){h();a.preventDefault();if(O.onContextLost)O.onContextLost()}function W(a){D.getError();P.refresh();Z.refresh();J.refresh();t.refresh();N.refresh();ca.refresh();ha.refresh();if(O.onContextRestored)O.onContextRestored();e()}function Y(c){function d(a){var b={},c={};Object.keys(a).forEach(function(d){var f=a[d];A.isDynamic(f)?(e=!0,c[d]=A.unbox(f,
d)):b[d]=f});return{dynamic:c,"static":b}}a(!!c,"invalid args to regl({...})");a.type(c,"object","invalid args to regl({...})");var e=!1,f=d(c.uniforms||{}),g=d(c.attributes||{});c=d(function(a){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=b({},a);delete d.uniforms;delete d.attributes;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(c));var f=B.command(c["static"],f["static"],g["static"],
c.dynamic,f.dynamic,g.dynamic,e),h=f.draw,k=f.batch,l=f.scope,m=[];return function(a,b){if("number"===typeof a){for(var c=a|0;m.length<c;)m.push(null);return k(a|0,m)}return Array.isArray(a)?k(a.length,a):"function"===typeof a?l(null,a):"function"===typeof b?l(a,b):h(a)}}function U(){N.poll();ha.poll()}var fa=c(Array.prototype.slice.call(arguments)),D=fa.gl,O=fa.options,fa=d(),P=m(D),ja=P.extensions,ka={width:D.drawingBufferWidth,height:D.drawingBufferHeight},ia=f(D,ja),Z=g(D),ga=k(D,ja,Z),ba=q(fa),
E=r(D,ja,ia,Z,fa),ca=p(D,E,ba,function(a){return B.draw(a)},fa),da=w(D,ja,Z),J=l(D,ja,ia,U,ka),t=F(D,ja,ia),N=u(D,ja,ia,J,t),L={count:0,start:K(),dt:0,t:K(),renderTime:0,width:D.drawingBufferWidth,height:D.drawingBufferHeight,pixelRatio:O.pixelRatio},ha=z(D,N,ka),ka=y(D,U,ka),B=v(D,fa,ja,ia,Z,ga,J,N,ha,ba,E,ca,da,L,U),M=D.canvas,V=[],X=0;M&&(M.addEventListener("webglcontextlost",n,!1),M.addEventListener("webglcontextrestored",W,!1));return b(Y,{clear:function(b){var c=0;U();var d=b.color;d&&(D.clearColor(+d[0]||
0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384);"depth"in b&&(D.clearDepth(+b.depth),c|=256);"stencil"in b&&(D.clearStencil(b.stencil|0),c|=1024);a(!!c,"called regl.clear with no buffer specified");D.clear(c)},prop:A.define,draw:Y({}),elements:function(a){return ga.create(a)},buffer:function(a){return Z.create(a,34962)},texture:function(a){return J.create(a,3553)},cube:function(a){return 6===arguments.length?J.create(Array.prototype.slice.call(arguments),34067):J.create(a,34067)},renderbuffer:function(a){return t.create(a)},
framebuffer:function(a){return N.create(a)},framebufferCube:function(b){a.raise("framebuffer cube not yet implemented")},frame:function(a){V.push(a);!X&&0<V.length&&e();return{cancel:function(){var b=V.find(function(b){return b===a});0>b||(V.splice(b,1),0>=V.length&&h())}}},stats:L,limits:ia,read:ka,destroy:function(){h();M&&(M.removeEventListener("webglcontextlost",n),M.removeEventListener("webglcontextrestored",W));ca.clear();N.clear();t.clear();J.clear();Z.clear();if(O.onDestroy)O.onDestroy()}})}},
{"./lib/attribute":2,"./lib/buffer":3,"./lib/check":4,"./lib/clock":5,"./lib/compile":7,"./lib/context":11,"./lib/draw":12,"./lib/dynamic":13,"./lib/elements":14,"./lib/extend":15,"./lib/extension":16,"./lib/framebuffer":17,"./lib/limits":20,"./lib/raf":23,"./lib/read":24,"./lib/renderbuffer":25,"./lib/shader":26,"./lib/state":28,"./lib/strings":29,"./lib/texture":30,"./lib/uniform":32}]},{},[1]);

        </script>
        </body>
      </html>