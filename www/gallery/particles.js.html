<!DOCTYPE html>
      <html>
        <head>
          <title>example/particles.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(n,q,a){function b(d,e){if(!q[d]){if(!n[d]){var c="function"==typeof require&&require;if(!e&&c)return c(d,!0);if(h)return h(d,!0);c=Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c;}c=q[d]={exports:{}};n[d][0].call(c.exports,function(a){var e=n[d][1][a];return b(e?e:a)},c,c.exports,e$$0,n,q,a)}return q[d].exports}for(var h="function"==typeof require&&require,g=0;g<a.length;g++)b(a[g]);return b})({1:[function(f,n,q){var a=f("../regl")(),b=f("gl-mat4"),h=f("hsv2rgb");
f=a.buffer(Array(1E4).fill().map(function(){var a=h(360*Math.random(),.6,1);return[10*Math.random(),10*Math.random(),10*Math.random(),10*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),a[0]/255,a[1]/255,a[2]/255]}));var g=a({vert:"\n  precision mediump float;\n  attribute vec4 freq, phase;\n  attribute vec3 color;\n  uniform float time;\n  uniform mat4 view, projection;\n  varying vec3 fragColor;\n  void main() {\n    vec3 position = 8.0 * cos(freq.xyz * time + phase.xyz);\n    gl_PointSize = 5.0 * (1.0 + cos(freq.w * time + phase.w));\n    gl_Position = projection * view * vec4(position, 1);\n    fragColor = color;\n  }",
frag:"\n  precision lowp float;\n  varying vec3 fragColor;\n  void main() {\n    if (length(gl_PointCoord.xy - 0.5) > 0.5) {\n      discard;\n    }\n    gl_FragColor = vec4(fragColor, 1);\n  }",attributes:{freq:{buffer:f,stride:44,offset:0},phase:{buffer:f,stride:44,offset:16},color:{buffer:f,stride:44,offset:32}},uniforms:{view:function(a){a=.01*a.tick;return b.lookAt([],[30*Math.cos(a),2.5,30*Math.sin(a)],[0,0,0],[0,1,0])},projection:function(a){return b.perspective([],Math.PI/4,a.viewportWidth/
a.viewportHeight,.01,1E3)},time:function(a){return.001*a.tick}},count:1E4,primitive:"points"});a.frame(function(){a.clear({depth:1,color:[0,0,0,1]});g()})},{"../regl":58,"gl-mat4":42,hsv2rgb:57}],2:[function(f,n,q){function a(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}n.exports=function(b,h,g,d,e){b=g.maxAttributes;h=Array(b);for(g=0;g<b;++g)h[g]=new a;return{Record:a,scope:{},state:h}}},{}],3:[function(f,
n,q){function a(a){return l[Object.prototype.toString.call(a)]|0}function b(a,b){for(var d=0;d<b.length;++d)a[d]=b[d]}function h(a,b,d,e,c,g,h){for(var m=0,p=0;p<d;++p)for(var k=0;k<e;++k)a[m++]=b[c*p+g*k+h]}function g(a,b,d){for(var e=0,c=0;c<b.length;++c)for(var g=b[c],h=0;h<d;++h)a[e++]=g[h]}var d=f("./util/is-typed-array"),e=f("./util/is-ndarray"),c=f("./util/values"),m=f("./util/pool"),l=f("./constants/arraytypes.json"),t=f("./constants/dtypes.json"),B=f("./constants/usage.json"),k=[];k[5120]=
1;k[5122]=2;k[5124]=4;k[5121]=1;k[5123]=2;k[5125]=4;k[5126]=4;n.exports=function(l,f,v){function r(a){this.id=z++;this.buffer=l.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;v.profile&&(this.stats={size:0})}function u(a,b,d){a.byteLength=b.byteLength;l.bufferData(a.type,b,d)}function n(c,p,k,l,f){c.usage=k;if(Array.isArray(p))c.dtype=l||5126,0<p.length&&(Array.isArray(p[0])?(c.dimension=p[0].length,l=m.allocType(c.dtype,p.length*c.dimension),g(l,p,
c.dimension),u(c,l,k),m.freeType(l)):"number"===typeof p[0]?(c.dimension=f,l=m.allocType(c.dtype,p.length),b(l,p),u(c,l,k),m.freeType(l)):d(p[0])&&(c.dimension=p[0].length,c.dtype=l||a(p[0])||5126,l=m.allocType(c.dtype,p.length*c.dimension),g(l,p,c.dimension),u(c,l,k),m.freeType(l)));else if(d(p))c.dtype=l||a(p),c.dimension=f,u(c,p,k);else if(e(p)){var r=p.shape,t=p.stride;f=p.offset;var B=0,v=0,x=0,z=0;1===r.length?(B=r[0],v=1,x=t[0],z=0):2===r.length&&(B=r[0],v=r[1],x=t[0],z=t[1]);c.dtype=l||a(p.data)||
5126;c.dimension=v;l=m.allocType(c.dtype,B*v);h(l,p.data,B,v,x,z,f);u(c,l,k);m.freeType(l)}}function E(a){f.bufferCount--;l.deleteBuffer(a.buffer);a.buffer=null;delete p[a.id]}var z=0,p={};r.prototype.bind=function(){l.bindBuffer(this.type,this.buffer)};r.prototype.destroy=function(){E(this)};var D=[];v.profile&&(f.getTotalBufferSize=function(){var a=0;Object.keys(p).forEach(function(b){a+=p[b].stats.size});return a});return{create:function(c,u,z){function D(a){var b=35044,c=null,g=0,h=0,p=1;Array.isArray(a)||
d(a)||e(a)?c=a:"number"===typeof a?g=a|0:a&&("data"in a&&(c=a.data),"usage"in a&&(b=B[a.usage]),"type"in a&&(h=t[a.type]),"dimension"in a&&(p=a.dimension|0),"length"in a&&(g=a.length|0));q.bind();c?n(q,c,b,h,p):(l.bufferData(q.type,g,b),q.dtype=h||5121,q.usage=b,q.dimension=p,q.byteLength=g);v.profile&&(q.stats.size=q.byteLength*k[q.dtype]);return D}f.bufferCount++;var q=new r(u);p[q.id]=q;z||D(c);D._reglType="buffer";D._buffer=q;D.subdata=function(c,p){var k=(p||0)|0;q.bind();if(Array.isArray(c)){if(0<
c.length)if("number"===typeof c[0]){var r=m.allocType(q.dtype,c.length);b(r,c);l.bufferSubData(q.type,k,r);m.freeType(r)}else if(Array.isArray(c[0])||d(c[0])){var r=c[0].length,f=m.allocType(q.dtype,c.length*r);g(f,c,r);l.bufferSubData(q.type,k,f);m.freeType(f)}}else if(d(c))l.bufferSubData(q.type,k,c);else if(e(c)){var t=c.shape,u=c.stride,B=f=r=0,v=0;1===t.length?(r=t[0],f=1,B=u[0],v=0):2===t.length&&(r=t[0],f=t[1],B=u[0],v=u[1]);t=Array.isArray(c.data)?q.dtype:a(c.data);t=m.allocType(t,r*f);h(t,
c.data,r,f,B,v,c.offset);l.bufferSubData(q.type,k,t);m.freeType(t)}return D};v.profile&&(D.stats=q.stats);D.destroy=function(){E(q)};return D},createStream:function(a,b){var c=D.pop();c||(c=new r(a));c.bind();n(c,b,35040,0,1);return c},destroyStream:function(a){D.push(a)},clear:function(){c(p).forEach(E);D.forEach(E)},getBuffer:function(a){return a&&a._buffer instanceof r?a._buffer:null},_initBuffer:n}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,
"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(f,n,q){n.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(f,n,q){n.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},
{}],6:[function(f,n,q){n.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(f,n,q){n.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(f,n,q){function a(a){return Array.isArray(a)||l(a)||t(a)}function b(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function h(a,b,c,d){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=d}function g(a){return a&&
!(a.thisDep||a.contextDep||a.propDep)}function d(a){return new h(!1,!1,!1,a)}function e(a,b){var c=a.type;return 0===c?(c=a.data.length,new h(!0,1<=c,2<=c,b)):new h(3===c,2===c,1===c,b)}var c=f("./util/codegen"),m=f("./util/loop"),l=f("./util/is-typed-array"),t=f("./util/is-ndarray"),B=f("./util/is-array-like"),k=f("./constants/primitives.json"),x=f("./constants/dtypes.json"),y=["x","y","z","w"],v={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,
"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},r={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},u={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,
invert:5386},C={cw:2304,ccw:2305},E=new h(!1,!1,!1,function(){});n.exports=function(l,p,f,t,n,q,P,J,U,I,H,G,ia,V,X){function aa(a){return a.replace(".","_")}function Q(a,b,c){var d=aa(a);za.push(a);w[d]=ba[d]=!!c;Y[d]=b}function K(a,b,c){var d=aa(a);za.push(a);Array.isArray(c)?(ba[d]=c.slice(),w[d]=c.slice()):ba[d]=w[d]=c;pa[d]=b}function M(){var a=c(),b=a.link,d=a.global;a.id=Ha++;a.batchId="0";var e=b(Ga),g=a.shared={props:"a0"};Object.keys(Ga).forEach(function(a){g[a]=d.def(e,".",a)});var h=a.next=
{},w=a.current={};Object.keys(pa).forEach(function(a){Array.isArray(ba[a])&&(h[a]=d.def(g.next,".",a),w[a]=d.def(g.current,".",a))});var N=a.constants={};Object.keys(Aa).forEach(function(a){N[a]=d.def(JSON.stringify(Aa[a]))});a.invoke=function(c,d){switch(d.type){case 0:var N=["this",g.context,g.props,a.batchId];return c.def(b(d.data),".call(",N.slice(0,Math.max(d.data.length+1,4)),")");case 1:return c.def(g.props,d.data);case 2:return c.def(g.context,d.data);case 3:return c.def("this",d.data)}};
a.attribCache={};var Ea={};a.scopeAttrib=function(a){a=p.id(a);if(a in Ea)return Ea[a];var c=I.scope[a];c||(c=I.scope[a]=new na);return Ea[a]=b(c)};return a}function R(a){var b=a["static"];a=a.dynamic;var c;if("profile"in b){var g=!!b.profile;c=d(function(a,b){return g});c.enable=g}else if("profile"in a){var h=a.profile;c=e(h,function(a,b){return a.invoke(b,h)})}return c}function ja(a){var b=a["static"];a=a.dynamic;if("framebuffer"in b){var c=b.framebuffer;return c?(c=J.getFramebuffer(c),d(function(a,
b){var d=a.link(c),N=a.shared;b.set(N.framebuffer,".next",d);N=N.context;b.set(N,".framebufferWidth",d+".width");b.set(N,".framebufferHeight",d+".height");return d})):d(function(a,b){var c=a.shared;b.set(c.framebuffer,".next","null");c=c.context;b.set(c,".framebufferWidth",c+".drawingBufferWidth");b.set(c,".framebufferHeight",c+".drawingBufferHeight");return"null"})}if("framebuffer"in a){var g=a.framebuffer;return e(g,function(a,b){var c=a.invoke(b,g),d=a.shared,e=d.framebuffer,c=b.def(e,".getFramebuffer(",
c,")");b.set(e,".next",c);d=d.context;b.set(d,".framebufferWidth",c+"?"+c+".width:"+d+".drawingBufferWidth");b.set(d,".framebufferHeight",c+"?"+c+".height:"+d+".drawingBufferHeight");return c})}return null}function qa(a,b){function c(a){if(a in d){var A=d[a];a=!0;var w=A.x|0,p=A.y|0,k,m;"width"in A?k=A.width|0:a=!1;"height"in A?m=A.height|0:a=!1;return new h(!a&&b&&b.thisDep,!a&&b&&b.contextDep,!a&&b&&b.propDep,function(a,b){var c=a.shared.context,d=k;"width"in A||(d=b.def(c,".","framebufferWidth",
"-",w));var N=m;"height"in A||(N=b.def(c,".","framebufferHeight","-",p));return[w,p,d,N]})}if(a in g){var l=g[a];a=e(l,function(a,b){var c=a.invoke(b,l),d=a.shared.context,N=b.def(c,".x|0"),e=b.def(c,".y|0"),g=b.def('"width" in ',c,"?",c,".width|0:","(",d,".","framebufferWidth","-",N,")"),c=b.def('"height" in ',c,"?",c,".height|0:","(",d,".","framebufferHeight","-",e,")");return[N,e,g,c]});b&&(a.thisDep=a.thisDep||b.thisDep,a.contextDep=a.contextDep||b.contextDep,a.propDep=a.propDep||b.propDep);return a}return b?
new h(b.thisDep,b.contextDep,b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),b.def(c,".","framebufferHeight")]}):null}var d=a["static"],g=a.dynamic,w=c("viewport");if(w)var p=w,w=new h(w.thisDep,w.contextDep,w.propDep,function(a,b){var c=p.append(a,b),d=a.shared.context;b.set(d,".viewportWidth",c[2]);b.set(d,".viewportHeight",c[3]);return c});return{viewport:w,scissor_box:c("scissor.box")}}function ua(a){function b(a){if(a in c){var g=p.id(c[a]);a=d(function(){return g});
a.id=g;return a}if(a in w){var A=w[a];return e(A,function(a,b){var c=a.invoke(b,A);return b.def(a.shared.strings,".id(",c,")")})}return null}var c=a["static"],w=a.dynamic,k=b("frag"),m=b("vert"),l=null;g(k)&&g(m)?(l=H.program(m.id,k.id),a=d(function(a,b){return a.link(l)})):a=new h(k&&k.thisDep||m&&m.thisDep,k&&k.contextDep||m&&m.contextDep,k&&k.propDep||m&&m.propDep,function(a,b){var c=a.shared.shader,d;d=k?k.append(a,b):b.def(c,".","frag");var e;e=m?m.append(a,b):b.def(c,".","vert");return b.def(c+
".program("+e+","+d+")")});return{frag:k,vert:m,progVar:a,program:l}}function ka(b){function c(a,b){if(a in w){var g=w[a]|0;return d(function(a,c){b&&(a.OFFSET=g);return g})}if(a in p){var A=p[a];return e(A,function(a,c){var d=a.invoke(c,A);b&&(a.OFFSET=d);return d})}return b&&m?d(function(a,b){a.OFFSET="0";return 0}):null}var w=b["static"],p=b.dynamic,m=function(){if("elements"in w){var b=w.elements;a(b)?b=q.getElements(q.create(b)):b&&(b=q.getElements(b));var c=d(function(a,c){if(b){var d=a.link(b);
return a.ELEMENTS=d}return a.ELEMENTS=null});c.value=b;return c}if("elements"in p){var g=p.elements;return e(g,function(a,b){var c=a.shared,d=c.isBufferArgs,c=c.elements,e=a.invoke(b,g),N=b.def("null"),d=b.def(d,"(",e,")"),e=a.cond(d).then(N,"=",c,".createStream(",e,");")["else"](N,"=",c,".getElements(",e,");");b.entry(e);b.exit(a.cond(d).then(c,".destroyStream(",N,");"));return a.ELEMENTS=N})}return null}(),l=c("offset",!0);return{elements:m,primitive:function(){if("primitive"in w){var a=w.primitive;
return d(function(b,c){return k[a]})}if("primitive"in p){var b=p.primitive;return e(b,function(a,c){var d=a.constants.primTypes,e=a.invoke(c,b);return c.def(d,"[",e,"]")})}return m?g(m)?m.value?d(function(a,b){return b.def(a.ELEMENTS,".primType")}):d(function(){return 4}):new h(m.thisDep,m.contextDep,m.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in w){var a=w.count|0;return d(function(){return a})}if("count"in p){var b=p.count;return e(b,
function(a,c){return a.invoke(c,b)})}return m?g(m)?m?l?new h(l.thisDep,l.contextDep,l.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):d(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):d(function(){return-1}):new h(m.thisDep||l.thisDep,m.contextDep||l.contextDep,m.propDep||l.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")}):null}(),instances:c("instances",!1),offset:l}}function ra(a){var b=
a["static"],c=a.dynamic,g={};za.forEach(function(a){function A(N,h){if(a in b){var p=N(b[a]);g[w]=d(function(){return p})}else if(a in c){var m=c[a];g[w]=e(m,function(a,b){return h(a,b,a.invoke(b,m))})}}var w=aa(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return A(function(a){return a},function(a,b,c){return c});case "depth.func":return A(function(a){return r[a]},
function(a,b,c){return b.def(a.constants.compareFuncs,"[",c,"]")});case "depth.range":return A(function(a){return a},function(a,b,c){a=b.def("+",c,"[0]");b=b.def("+",c,"[1]");return[a,b]});case "blend.func":return A(function(a){return[v["srcRGB"in a?a.srcRGB:a.src],v["dstRGB"in a?a.dstRGB:a.dst],v["srcAlpha"in a?a.srcAlpha:a.src],v["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,c){function d(a,g){var A=b.def('"',a,g,'" in ',c,"?",c,".",a,g,":",c,".",a);return b.def(e,"[",A,"]")}var e=a.constants.blendFuncs;
a=d("src","RGB");var g=d("src","Alpha"),A=d("dst","RGB"),w=d("dst","Alpha");return[a,A,g,w]});case "blend.equation":return A(function(a){if("string"===typeof a)return[oa[a],oa[a]];if("object"===typeof a)return[oa[a.rgb],oa[a.alpha]]},function(a,b,c){var d=a.constants.blendEquations,e=b.def(),g=b.def();a=a.cond("typeof ",c,'==="string"');a.then(e,"=",g,"=",d,"[",c,"];");a["else"](e,"=",d,"[",c,".rgb];",g,"=",d,"[",c,".alpha];");b(a);return[e,g]});case "blend.color":return A(function(a){return m(4,
function(b){return+a[b]})},function(a,b,c){return m(4,function(a){return b.def("+",c,"[",a,"]")})});case "stencil.mask":return A(function(a){return a|0},function(a,b,c){return b.def(c,"|0")});case "stencil.func":return A(function(a){return[r[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,c){a=b.def('"cmp" in ',c,"?",a.constants.compareFuncs,"[",c,".cmp]",":",7680);var d=b.def(c,".ref|0");b=b.def('"mask" in ',c,"?",c,".mask|0:-1");return[a,d,b]});case "stencil.opFront":case "stencil.opBack":return A(function(b){return["stencil.opBack"===
a?1029:1028,u[b.fail||"keep"],u[b.zfail||"keep"],u[b.pass||"keep"]]},function(b,c,d){function e(a){return c.def('"',a,'" in ',d,"?",g,"[",d,".",a,"]:",7680)}var g=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,e("fail"),e("zfail"),e("pass")]});case "polygonOffset.offset":return A(function(a){return[a.factor|0,a.units|0]},function(a,b,c){a=b.def(c,".factor|0");b=b.def(c,".units|0");return[a,b]});case "cull.face":return A(function(a){var b=0;"front"===a?b=1028:"back"===a&&(b=1029);return b},
function(a,b,c){return b.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return A(function(a){return a},function(a,b,c){return c});case "frontFace":return A(function(a){return C[a]},function(a,b,c){return b.def(c+'==="cw"?2304:2305')});case "colorMask":return A(function(a){return a.map(function(a){return!!a})},function(a,b,c){return m(4,function(a){return"!!"+c+"["+a+"]"})});case "sample.coverage":return A(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,b,c){a=b.def('"value" in ',
c,"?+",c,".value:1");b=b.def("!!",c,".invert");return[a,b]})}});return g}function la(a){var b=a["static"],c=a.dynamic,g={};Object.keys(b).forEach(function(a){var c=b[a],e;"number"===typeof c||"boolean"===typeof c?e=d(function(){return c}):"function"!==typeof c||"texture2d"!==c._reglType&&"textureCube"!==c._reglType?B(c)&&(e=d(function(a){return a.global.def("[",m(c.length,function(a){return c[a]}),"]")})):e=d(function(a){return a.link(c)});e.value=c;g[a]=e});Object.keys(c).forEach(function(a){var b=
c[a];g[a]=e(b,function(a,c){return a.invoke(c,b)})});return g}function da(b){var c=b["static"],g=b.dynamic,w={};Object.keys(c).forEach(function(b){var e=c[b],g=p.id(b),A=new na;if(a(e))A.state=1,A.buffer=n.getBuffer(n.create(e,34962,!1)),A.type=A.buffer.dtype;else{var h=n.getBuffer(e);if(h)A.state=1,A.buffer=h,A.type=h.dtype;else if(e.constant){var m=e.constant;A.state=2;"number"===typeof m?A.x=m:y.forEach(function(a,b){b<m.length&&(A[a]=m[b])})}else{var h=n.getBuffer(e.buffer),k=e.offset|0,l=e.stride|
0,f=e.size|0,r=!!e.normalized,t=0;"type"in e&&(t=x[e.type]);e=e.divisor|0;A.buffer=h;A.state=1;A.size=f;A.normalized=r;A.type=t||h.dtype;A.offset=k;A.stride=l;A.divisor=e}}w[b]=d(function(a,b){var c=a.attribCache;if(g in c)return c[g];var d={isStream:!1};Object.keys(A).forEach(function(a){d[a]=A[a]});A.buffer&&(d.buffer=a.link(A.buffer));return c[g]=d})});Object.keys(g).forEach(function(a){var b=g[a];w[a]=e(b,function(a,c){function d(a){c(h[a],"=",e,".",a,"|0;")}var e=a.invoke(c,b),g=a.shared,A=g.isBufferArgs,
w=g.buffer,h={isStream:c.def(!1)},p=new na;p.state=1;Object.keys(p).forEach(function(a){h[a]=c.def(""+p[a])});var m=h.buffer,fa=h.type;c("if(",A,"(",e,")){",h.isStream,"=true;",m,"=",w,".createStream(",34962,",",e,");",fa,"=",m,".dtype;","}else{",m,"=",w,".getBuffer(",e,");","if(",m,"){",fa,"=",m,".dtype;","}else if(",e,".constant){",h.state,"=",2,";",y.map(function(a,b){return h[a]+"="+e+".length>="+b+"?"+e+"["+b+"]:0;"}).join(""),"}else{",m,"=",w,".getBuffer(",e,".buffer);",fa,'="type" in ',e,"?",
g.glTypes,"[",e,".type]:",m,".dtype;",h.normalized,"=!!",e,".normalized;");d("size");d("offset");d("stride");d("divisor");c("}}");c.exit("if(",h.isStream,"){",w,".destroyStream(",m,");","}");return h})});return w}function sa(a){var b=a["static"],c=a.dynamic,g={};Object.keys(b).forEach(function(a){var c=b[a];g[a]=d(function(a,b){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var b=c[a];g[a]=e(b,function(a,c){return a.invoke(c,b)})});return g}function S(a,
b,c){var d=a.shared.context,e=a.scope();Object.keys(c).forEach(function(g){b.save(d,"."+g);e(d,".",g,"=",c[g].append(a,b),";")});b(e)}function F(a,b,c){var d=a.shared,e=d.gl,g=d.framebuffer,w;ta&&(w=b.def(d.extensions,".webgl_draw_buffers"));var h=a.constants,d=h.drawBuffer,h=h.backBuffer;a=c?c.append(a,b):b.def(g,".next");b("if(",g,".dirty||",a,"!==",g,".cur){","if(",a,"){",e,".bindFramebuffer(",36160,",",a,".framebuffer);");ta&&b(w,".drawBuffersWEBGL(",d,"[",a,".colorAttachments.length]);");b("}else{",
e,".bindFramebuffer(",36160,",null);");ta&&b(w,".drawBuffersWEBGL(",h,");");b("}",g,".cur=",a,";",g,".dirty=false;","}")}function ca(a,b,c){var d=a.shared,e=d.gl,g=a.current,w=a.next,h=d.current,p=d.next,k=a.cond(h,".dirty");za.forEach(function(b){b=aa(b);if(!(b in c.state)){var d,l;if(b in w){d=w[b];l=g[b];var fa=m(ba[b].length,function(a){return k.def(d,"[",a,"]")});k(a.cond(fa.map(function(a,b){return a+"!=="+l+"["+b+"]"}).join("||")).then(e,".",pa[b],"(",fa,");",fa.map(function(a,b){return l+
"["+b+"]="+a}).join(";"),";"))}else d=k.def(p,".",b),fa=a.cond(d,"!==",h,".",b),k(fa),b in Y?fa(a.cond(d).then(e,".enable(",Y[b],");")["else"](e,".disable(",Y[b],");"),h,".",b,"=",d,";"):fa(e,".",pa[b],"(",d,");",h,".",b,"=",d,";")}});0===Object.keys(c.state).length&&k(h,".dirty=false;");b(k)}function Z(a,c,d,e){var h=a.shared,w=a.current,p=h.current,m=h.gl;b(Object.keys(d)).forEach(function(b){var h=d[b];if(!e||e(h)){var k=h.append(a,c);if(Y[b]){var l=Y[b];g(h)?k?c(m,".enable(",l,");"):c(m,".disable(",
l,");"):c(a.cond(k).then(m,".enable(",l,");")["else"](m,".disable(",l,");"));c(p,".",b,"=",k,";")}else if(B(k)){var f=w[b];c(m,".",pa[b],"(",k,");",k.map(function(a,b){return f+"["+b+"]="+a}).join(";"),";")}else c(m,".",pa[b],"(",k,");",p,".",b,"=",k,";")}})}function W(a,b){ea&&!a.instancing&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function va(a,b,c,d,e){function h(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function w(a){t=b.def();a(t,"=",
h(),";");"string"===typeof e?a(l,".count+=",e,";"):a(l,".count++;");V&&(d?(u=b.def(),a(u,"=",r,".getNumPendingQueries();")):a(r,".beginQuery(",l,");"))}function p(a){a(l,".cpuTime+=",h(),"-",t,";");V&&(d?a(r,".pushScopeStats(",u,",",r,".getNumPendingQueries(),",l,");"):a(r,".endQuery();"))}function m(a){var c=b.def(f,".profile");b(f,".profile=",a,";");b.exit(f,".profile=",c,";")}var k=a.shared,l=a.stats,f=k.current,r=k.timer;c=c.profile;var t,u;if(c){if(g(c)){c.enable?(w(b),p(b.exit),m("true")):m("false");
return}c=c.append(a,b);m(c)}else c=b.def(f,".profile");k=a.block();w(k);b("if(",c,"){",k,"}");a=a.block();p(a);b.exit("if(",c,"){",a,"}")}function wa(a,b,c,d,e){function g(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function h(c,d,e){function g(){b("if(!",l,".pointer){",m,".enableVertexAttribArray(",k,");",l,".pointer=true;}");var c=e.type,h;h=e.size?b.def(e.size,"||",d):d;b("if(",l,".type!==",
c,"||",l,".size!==",h,"||",t.map(function(a){return l+"."+a+"!=="+e[a]}).join("||"),"){",m,".bindBuffer(",34962,",",f,".buffer);",m,".vertexAttribPointer(",[k,h,c,e.normalized,e.stride,e.offset],");",l,".type=",c,";",l,".size=",h,";",t.map(function(a){return l+"."+a+"="+e[a]+";"}).join(""),"}");ea&&(c=e.divisor,b("if(",l,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[k,c],");",l,".divisor=",c,";}"))}function p(){b("if(",l,".pointer){",m,".disableVertexAttribArray(",k,");",l,".pointer=false;",
"}if(",y.map(function(a,b){return l+"."+a+"!=="+r[b]}).join("||"),"){",m,".vertexAttrib4f(",k,",",r,");",y.map(function(a,b){return l+"."+a+"="+r[b]+";"}).join(""),"}")}var m=w.gl,k=b.def(c,".location"),l=b.def(w.attributes,"[",k,"]");c=e.state;var f=e.buffer,r=[e.x,e.y,e.z,e.w],t=["buffer","normalized","offset","stride"];1===c?g():2===c?p():(b("if(",c,"===",1,"){"),g(),b("}else{"),p(),b("}"))}var w=a.shared;d.forEach(function(d){var w=d.name,m=c.attributes[w],p;if(m){if(!e(m))return;p=m.append(a,
b)}else{if(!e(E))return;var k=a.scopeAttrib(w);p={};Object.keys(new na).forEach(function(a){p[a]=b.def(k,".",a)})}h(a.link(d),g(d.info.type),p)})}function xa(a,b,c,d,e){for(var h=a.shared,w=h.gl,k,l=0;l<d.length;++l){var f=d[l],r=f.name,t=f.info.type,u=c.uniforms[r],f=a.link(f)+".location",v;if(u){if(!e(u))continue;if(g(u)){r=u.value;if(35678===t||35680===t)t=a.link(r._texture),b(w,".uniform1i(",f,",",t+".bind());"),b.exit(t,".unbind();");else if(35674===t||35675===t||35676===t)r=a.global.def("new Float32Array(["+
Array.prototype.slice.call(r)+"])"),u=2,35675===t?u=3:35676===t&&(u=4),b(w,".uniformMatrix",u,"fv(",f,",false,",r,");");else{switch(t){case 5126:k="1f";break;case 35664:k="2f";break;case 35665:k="3f";break;case 35666:k="4f";break;case 35670:k="1i";break;case 5124:k="1i";break;case 35671:k="2i";break;case 35667:k="2i";break;case 35672:k="3i";break;case 35668:k="3i";break;case 35673:k="4i";break;case 35669:k="4i"}b(w,".uniform",k,"(",f,",",B(r)?Array.prototype.slice.call(r):r,");")}continue}else v=
u.append(a,b)}else{if(!e(E))continue;v=b.def(h.uniforms,"[",p.id(r),"]")}r=1;switch(t){case 35678:case 35680:t=b.def(v,"._texture");b(w,".uniform1i(",f,",",t,".bind());");b.exit(t,".unbind();");continue;case 5124:case 35670:k="1i";break;case 35667:case 35671:k="2i";r=2;break;case 35668:case 35672:k="3i";r=3;break;case 35669:case 35673:k="4i";r=4;break;case 5126:k="1f";break;case 35664:k="2f";r=2;break;case 35665:k="3f";r=3;break;case 35666:k="4f";r=4;break;case 35674:k="Matrix2fv";break;case 35675:k=
"Matrix3fv";break;case 35676:k="Matrix4fv"}b(w,".uniform",k,"(",f,",");if("M"===k.charAt(0)){var f=Math.pow(t-35674+2,2),Y=a.global.def("new Float32Array(",f,")");b("false,(Array.isArray(",v,")||",v," instanceof Float32Array)?",v,":(",m(f,function(a){return Y+"["+a+"]="+v+"["+a+"]"}),",",Y,")")}else 1<r?b(m(r,function(a){return v+"["+a+"]"})):b(v);b(");")}}function ga(a,b,c,d){function e(g){var h=l[g];return h?h.contextDep&&d.contextDynamic||h.propDep?h.append(a,c):h.append(a,b):b.def(p,".",g)}function h(){function a(){c(B,
".drawElementsInstancedANGLE(",[f,u,Y,t+"<<(("+Y+"-5121)>>1)",v],");")}function b(){c(B,".drawArraysInstancedANGLE(",[f,t,u,v],");")}r?x?a():(c("if(",r,"){"),a(),c("}else{"),b(),c("}")):b()}function w(){function a(){c(m+".drawElements("+[f,u,Y,t+"<<(("+Y+"-5121)>>1)"]+");")}function b(){c(m+".drawArrays("+[f,t,u]+");")}r?x?a():(c("if(",r,"){"),a(),c("}else{"),b(),c("}")):b()}var k=a.shared,m=k.gl,p=k.draw,l=d.draw,r=function(){var e=l.elements,g=b;if(e){if(e.contextDep&&d.contextDynamic||e.propDep)g=
c;e=e.append(a,g)}else e=g.def(p,".","elements");e&&g("if("+e+")"+m+".bindBuffer(34963,"+e+".buffer.buffer);");return e}(),f=e("primitive"),t=e("offset"),u=function(){var e=l.count,g=b;if(e){if(e.contextDep&&d.contextDynamic||e.propDep)g=c;e=e.append(a,g)}else e=g.def(p,".","count");return e}();if("number"===typeof u){if(0===u)return}else c("if(",u,"){"),c.exit("}");var v,B;ea&&(v=e("instances"),B=a.instancing);var Y=r+".type",x=l.elements&&g(l.elements);ea&&("number"!==typeof v||0<=v)?"string"===
typeof v?(c("if(",v,">0){"),h(),c("}else if(",v,"<0){"),w(),c("}")):h():w()}function ha(a,b,c,d,e){b=M();e=b.proc("body",e);ea&&(b.instancing=e.def(b.shared.extensions,".angle_instanced_arrays"));a(b,e,c,d);return b.compile().body}function ma(a,b,c,d){W(a,b);wa(a,b,c,d.attributes,function(){return!0});xa(a,b,c,d.uniforms,function(){return!0});ga(a,b,b,c)}function Fa(a,b){var c=a.proc("draw",1);W(a,c);S(a,c,b.context);F(a,c,b.framebuffer);ca(a,c,b);Z(a,c,b.state);va(a,c,b,!1,!0);var d=b.shader.progVar.append(a,
c);c(a.shared.gl,".useProgram(",d,".program);");if(b.shader.program)ma(a,c,b,b.shader.program);else{var e=a.global.def("{}"),g=c.def(d,".id"),h=c.def(e,"[",g,"]");c(a.cond(h).then(h,".call(this,a0);")["else"](h,"=",e,"[",g,"]=",a.link(function(c){return ha(ma,a,b,c,1)}),"(",d,");",h,".call(this,a0);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function Ba(a,b,c,d){function e(){return!0}a.batchId="a1";W(a,b);wa(a,b,c,d.attributes,e);xa(a,b,c,d.uniforms,e);ga(a,b,b,c)}function ya(a,
b,c,d){function e(a){return a.contextDep&&h||a.propDep}function g(a){return!e(a)}W(a,b);var h=c.contextDep,w=b.def(),k=b.def();a.shared.props=k;a.batchId=w;var m=a.scope(),p=a.scope();b(m.entry,"for(",w,"=0;",w,"<","a1",";++",w,"){",k,"=","a0","[",w,"];",p,"}",m.exit);c.needsContext&&S(a,p,c.context);c.needsFramebuffer&&F(a,p,c.framebuffer);Z(a,p,c.state,e);c.profile&&e(c.profile)&&va(a,p,c,!1,!0);d?(wa(a,m,c,d.attributes,g),wa(a,p,c,d.attributes,e),xa(a,m,c,d.uniforms,g),xa(a,p,c,d.uniforms,e),ga(a,
m,p,c)):(b=a.global.def("{}"),d=c.shader.progVar.append(a,p),k=p.def(d,".id"),m=p.def(b,"[",k,"]"),p(a.shared.gl,".useProgram(",d,".program);","if(!",m,"){",m,"=",b,"[",k,"]=",a.link(function(b){return ha(Ba,a,c,b,2)}),"(",d,");}",m,".call(this,a0[",w,"],",w,");"))}function Ca(a,b){function c(a){return a.contextDep&&e||a.propDep}var d=a.proc("batch",2);a.batchId="0";W(a,d);var e=!1,g=!0;Object.keys(b.context).forEach(function(a){e=e||b.context[a].propDep});e||(S(a,d,b.context),g=!1);var h=b.framebuffer,
w=!1;h?(h.propDep?e=w=!0:h.contextDep&&e&&(w=!0),w||F(a,d,h)):F(a,d,null);b.state.viewport&&b.state.viewport.propDep&&(e=!0);ca(a,d,b);Z(a,d,b.state,function(a){return!c(a)});b.profile&&c(b.profile)||va(a,d,b,!1,"a1");b.contextDep=e;b.needsContext=g;b.needsFramebuffer=w;g=b.shader.progVar;if(g.contextDep&&e||g.propDep)ya(a,d,b,null);else if(g=g.append(a,d),d(a.shared.gl,".useProgram(",g,".program);"),b.shader.program)ya(a,d,b,b.shader.program);else{var h=a.global.def("{}"),w=d.def(g,".id"),p=d.def(h,
"[",w,"]");d(a.cond(p).then(p,".call(this,a0,a1);")["else"](p,"=",h,"[",w,"]=",a.link(function(c){return ha(ya,a,b,c,2)}),"(",g,");",p,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&d(a.shared.current,".dirty=true;")}function Da(a,c){function d(b){var h=c.shader[b];h&&e.set(g.shader,"."+b,h.append(a,e))}var e=a.proc("scope",3);a.batchId="a2";var g=a.shared,h=g.current;S(a,e,c.context);c.framebuffer&&c.framebuffer.append(a,e);b(Object.keys(c.state)).forEach(function(b){var d=c.state[b].append(a,
e);B(d)?d.forEach(function(c,d){e.set(a.next[b],"["+d+"]",c)}):e.set(g.next,"."+b,d)});va(a,e,c,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(b){var d=c.draw[b];d&&e.set(g.draw,"."+b,""+d.append(a,e))});Object.keys(c.uniforms).forEach(function(b){e.set(g.uniforms,"["+p.id(b)+"]",c.uniforms[b].append(a,e))});Object.keys(c.attributes).forEach(function(b){var d=c.attributes[b].append(a,e),g=a.scopeAttrib(b);Object.keys(new na).forEach(function(a){e.set(g,"."+a,d[a])})});
d("vert");d("frag");0<Object.keys(c.state).length&&(e(h,".dirty=true;"),e.exit(h,".dirty=true;"));e("a1(",a.shared.context,",a0,0);")}var na=I.Record,oa={add:32774,subtract:32778,"reverse subtract":32779};f.ext_blend_minmax&&(oa.min=32775,oa.max=32776);var ea=f.angle_instanced_arrays,ta=f.webgl_draw_buffers,ba={dirty:!0,profile:X.profile},w={},za=[],Y={},pa={};Q("dither",3024);Q("blend.enable",3042);K("blend.color","blendColor",[0,0,0,0]);K("blend.equation","blendEquationSeparate",[32774,32774]);
K("blend.func","blendFuncSeparate",[1,0,1,0]);Q("depth.enable",2929,!0);K("depth.func","depthFunc",513);K("depth.range","depthRange",[0,1]);K("depth.mask","depthMask",!0);K("colorMask","colorMask",[!0,!0,!0,!0]);Q("cull.enable",2884);K("cull.face","cullFace",1029);K("frontFace","frontFace",2305);K("lineWidth","lineWidth",1);Q("polygonOffset.enable",32823);K("polygonOffset.offset","polygonOffset",[0,0]);Q("sample.alpha",32926);Q("sample.enable",32928);K("sample.coverage","sampleCoverage",[1,!1]);Q("stencil.enable",
2960);K("stencil.mask","stencilMask",-1);K("stencil.func","stencilFunc",[519,0,-1]);K("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);K("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);Q("scissor.enable",3089);K("scissor.box","scissor",[0,0,l.drawingBufferWidth,l.drawingBufferHeight]);K("viewport","viewport",[0,0,l.drawingBufferWidth,l.drawingBufferHeight]);var Ga={gl:l,context:ia,strings:p,next:w,current:ba,draw:G,elements:q,buffer:n,shader:H,attributes:I.state,uniforms:U,
framebuffer:J,extensions:f,timer:V,isBufferArgs:a},Aa={primTypes:k,compareFuncs:r,blendFuncs:v,blendEquations:oa,stencilOps:u,glTypes:x,orientationType:C};ta&&(Aa.backBuffer=[1029],Aa.drawBuffer=m(t.maxDrawbuffers,function(a){return 0===a?[0]:m(a,function(a){return 36064+a})}));var Ha=0;return{next:w,current:ba,procs:function(){var a=M(),b=a.proc("poll"),c=a.proc("refresh"),d=a.block();b(d);c(d);var e=a.shared,g=e.gl,h=e.next,w=e.current;d(w,".dirty=false;");F(a,b);c(e.framebuffer,".dirty=true;");
F(a,c);Object.keys(Y).forEach(function(e){var p=Y[e],k=d.def(h,".",e),m=a.block();m("if(",k,"){",g,".enable(",p,")}else{",g,".disable(",p,")}",w,".",e,"=",k,";");c(m);b("if(",k,"!==",w,".",e,"){",m,"}")});Object.keys(pa).forEach(function(e){var p=pa[e],k=ba[e],l,r,f=a.block();f(g,".",p,"(");B(k)?(p=k.length,l=a.global.def(h,".",e),r=a.global.def(w,".",e),f(m(p,function(a){return l+"["+a+"]"}),");",m(p,function(a){return r+"["+a+"]="+l+"["+a+"];"}).join("")),b("if(",m(p,function(a){return l+"["+a+
"]!=="+r+"["+a+"]"}).join("||"),"){",f,"}")):(l=d.def(h,".",e),r=d.def(w,".",e),f(l,");",w,".",e,"=",l,";"),b("if(",l,"!==",r,"){",f,"}"));c(f)});return a.compile()}(),compile:function(a,b,c,d,e){var g=M();g.stats=g.link(e);e=ja(a);var h=qa(a,e),w=ka(a),p=ra(a),k=ua(a),m=h.viewport;m&&(p.viewport=m);m=aa("scissor.box");(h=h[m])&&(p[m]=h);h=0<Object.keys(p).length;e={framebuffer:e,draw:w,shader:k,state:p,dirty:h};e.profile=R(a);e.uniforms=la(c);e.attributes=da(b);e.context=sa(d);Fa(g,e);Da(g,e);Ca(g,
e);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(f,n,q){function a(a,b){this.id=g++;this.type=a;this.data=b}function b(a){if(0===a.length)return[];var e=a.charAt(0),c=a.charAt(a.length-1);if(1<a.length&&e===c&&('"'===e||"'"===e))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return b(a.substr(0,
e.index)).concat(b(e[1])).concat(b(a.substr(e.index+e[0].length)));e=a.split(".");if(1===e.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(c=0;c<e.length;++c)a=a.concat(b(e[c]));return a}function h(a){return"["+b(a).join("][")+"]"}var g=0;n.exports={define:function(b,e){return new a(b,h(e+""))},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof a},unbox:function(b,e){return"function"===typeof b?new a(0,b):b},accessor:h}},{}],10:[function(f,n,
q){var a=f("./util/is-typed-array"),b=f("./util/is-ndarray"),h=f("./util/values"),g=f("./constants/primitives.json"),d=f("./constants/usage.json");n.exports=function(e,c,m,l){function f(a){this.id=n++;x[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function B(e,d,g,h,p,k,l){(k=l)||a(d)&&(!b(d)||a(d.data))||(k=c.oes_element_index_uint?5125:5123);e.buffer.bind();m._initBuffer(e.buffer,d,g,k,3);d=l;if(!l){switch(e.buffer.dtype){case 5121:case 5120:d=5121;break;case 5123:case 5122:d=
5123;break;case 5125:case 5124:d=5125}e.buffer.dtype=d}e.type=d;0>p&&(p=e.buffer.byteLength,5123===d?p>>=1:5125===d&&(p>>=2));e.vertCount=p;p=h;0>h&&(p=4,h=e.buffer.dimension,1===h&&(p=0),2===h&&(p=1),3===h&&(p=4));e.primType=p}function k(a){l.elementsCount--;delete x[a.id];a.buffer.destroy();a.buffer=null}var x={},n=0,v={uint8:5121,uint16:5123};c.oes_element_index_uint&&(v.uint32=5125);f.prototype.bind=function(){this.buffer.bind()};var r=[];return{create:function(c){function h(c){if(c)if("number"===
typeof c)r(c),x.primType=4,x.vertCount=c|0,x.type=5121;else{var k=null,m=35044,l=-1,f=-1,t=0,u=0;Array.isArray(c)||a(c)||b(c)?k=c:("data"in c&&(k=c.data),"usage"in c&&(m=d[c.usage]),"primitive"in c&&(l=g[c.primitive]),"count"in c&&(f=c.count|0),"length"in c&&(t=c.length|0),"type"in c&&(u=v[c.type]));k?B(x,k,m,l,f,t,u):(c=x.buffer,c.bind(),e.bufferData(34963,t,m),c.dtype=u||5121,c.usage=m,c.dimension=3,c.byteLength=t,x.primType=0>l?4:l,x.vertCount=0>f?0:f,x.type=c.dtype)}else r(),x.primType=4,x.vertCount=
0,x.type=5121;return h}var r=m.create(null,34963,!0),x=new f(r._buffer);l.elementsCount++;h(c);h._reglType="elements";h._elements=x;h.subdata=function(a,b){r.subdata(a,b);return h};h.destroy=function(){k(x)};return h},createStream:function(a){var b=r.pop();b||(b=new f(m.create(null,34963,!0)._buffer));B(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){r.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof f?a._elements:null},clear:function(){h(x).forEach(k)}}}},
{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(f,n,q){n.exports=function(a,b){function h(b){b=b.toLowerCase();if(b in g)return!0;var e;try{e=g[b]=a.getExtension(b)}catch(d){}return!!e}for(var g={},d=0;d<b.extensions.length;++d){var e=b.extensions[d];if(!h(e))return b.onDestroy(),b.onDone('"'+e+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),
null}b.optionalExtensions.forEach(h);return{extensions:g,refresh:function(){b.extensions.forEach(h);b.optionalExtensions.forEach(h)}}}},{}],12:[function(f,n,q){var a=f("./util/values"),b=f("./util/extend"),h=[];h[6408]=4;var g=[];g[5121]=1;g[5126]=4;g[36193]=2;n.exports=function(d,e,c,m,l,f){function B(a,b,c){this.target=a;this.texture=b;this.renderbuffer=c;var e=a=0;b?(a=b.width,e=b.height):c&&(a=c.width,e=c.height);this.width=a;this.height=e}function k(a){a&&(a.texture&&a.texture._texture.decRef(),
a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function x(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function n(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function v(a){var b=3553,c=null,e=null,d=a;"object"===typeof a&&(d=a.data,"target"in a&&(b=a.target|0));a=d._reglType;
"texture2d"===a?c=d:"textureCube"===a?c=d:"renderbuffer"===a&&(e=d,b=36161);return new B(b,c,e)}function r(a,b,c,e,d){if(c)return a=m.create2D({width:a,height:b,format:e,type:d}),a._texture.refCount=0,new B(3553,a,null);a=l.create({width:a,height:b,format:e});a._renderbuffer.refCount=0;return new B(36161,null,a)}function u(a){return a&&(a.texture||a.renderbuffer)}function q(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function E(){this.id=U++;I[this.id]=this;
this.framebuffer=d.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function z(a){a.colorAttachments.forEach(k);k(a.depthAttachment);k(a.stencilAttachment);k(a.depthStencilAttachment)}function p(a){d.deleteFramebuffer(a.framebuffer);a.framebuffer=null;f.framebufferCount--;delete I[a.id]}function D(a){var b;d.bindFramebuffer(36160,a.framebuffer);var e=a.colorAttachments;for(b=0;b<e.length;++b)n(36064+
b,e[b]);for(b=e.length;b<c.maxColorAttachments;++b)n(36064+b,null);n(36096,a.depthAttachment);n(36128,a.stencilAttachment);n(33306,a.depthStencilAttachment);d.checkFramebufferStatus(36160);d.bindFramebuffer(36160,L.next);L.current=L.next}function T(a,c){function d(a,b){var c,m=0,p=0,l=!0,f=!0;c=null;var t=!0,B="rgba",n="uint8",q=1,y=null,E=null,C=null,H=!1;if("number"===typeof a)m=a|0,p=b|0||m;else if(a){"shape"in a?(p=a.shape,m=p[0],p=p[1]):("radius"in a&&(m=p=a.radius),"width"in a&&(m=a.width),
"height"in a&&(p=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);c||("colorCount"in a&&(q=a.colorCount|0),"colorTexture"in a&&(t=!!a.colorTexture,B="rgba4"),"colorType"in a&&(n=a.colorType,t||("half float"===n?e.ext_color_buffer_half_float&&(B="rgba16f"):"float"===n&&e.webgl_color_buffer_float&&(B="rgba32f"))),"colorFormat"in a&&(B=a.colorFormat,0<=O.indexOf(B)?t=!0:0<=P.indexOf(B)&&(t=!1)));if("depthTexture"in a||"depthStencilTexture"in a)H=!(!a.depthTexture&&!a.depthStencilTexture);
"depth"in a&&("boolean"===typeof a.depth?l=a.depth:(y=a.depth,f=!1));"stencil"in a&&("boolean"===typeof a.stencil?f=a.stencil:(E=a.stencil,l=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?l=f=a.depthStencil:(C=a.depthStencil,f=l=!1))}else m=p=1;var F=null,G=null,Z=null,W=null;if(Array.isArray(c))F=c.map(v);else if(c)F=[v(c)];else for(F=Array(q),c=0;c<q;++c)F[c]=r(m,p,t,B,n);m=m||F[0].width;p=p||F[0].height;y?G=v(y):l&&!f&&(G=r(m,p,H,"depth","uint32"));E?Z=v(E):f&&!l&&(Z=r(m,p,!1,"stencil",
"uint8"));C?W=v(C):!y&&!E&&f&&l&&(W=r(m,p,H,"depth stencil","depth stencil"));l=null;for(c=0;c<F.length;++c)x(F[c],m,p),F[c]&&F[c].texture&&(f=h[F[c].texture._texture.format]*g[F[c].texture._texture.type],null===l&&(l=f));x(G,m,p);x(Z,m,p);x(W,m,p);z(k);k.width=m;k.height=p;k.colorAttachments=F;k.depthAttachment=G;k.stencilAttachment=Z;k.depthStencilAttachment=W;d.color=F.map(u);d.depth=u(G);d.stencil=u(Z);d.depthStencil=u(W);d.width=k.width;d.height=k.height;D(k);return d}var k=new E;f.framebufferCount++;
d(a,c);return b(d,{resize:function(a,b){var c=a|0,e=b|0||c;if(c===k.width&&e===k.height)return d;for(var g=k.colorAttachments,h=0;h<g.length;++h)q(g[h],c,e);q(k.depthAttachment,c,e);q(k.stencilAttachment,c,e);q(k.depthStencilAttachment,c,e);k.width=d.width=c;k.height=d.height=e;D(k);return d},_reglType:"framebuffer",_framebuffer:k,destroy:function(){p(k);z(k)}})}var L={current:null,next:null,dirty:!1},O=["rgba"],P=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&P.push("srgba");e.ext_color_buffer_half_float&&
P.push("rgba16f","rgb16f");e.webgl_color_buffer_float&&P.push("rgba32f");var J=["uint8"];e.oes_texture_half_float&&J.push("half float");e.oes_texture_float&&J.push("float");var U=0,I={};return b(L,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof E)?a:null},create:T,createCube:function(a){function c(a){var d={color:null},g=0,h=null,k="rgba",p="uint8",l=1;if("number"===typeof a)g=a|0;else if(a){"shape"in a?g=a.shape[0]:("radius"in a&&
(g=a.radius|0),"width"in a?g=a.width|0:"height"in a&&(g=a.height|0));if("color"in a||"colors"in a)h=a.color||a.colors,Array.isArray(h);h||("colorCount"in a&&(l=a.colorCount|0),"colorType"in a&&(p=a.colorType),"colorFormat"in a&&(k=a.colorFormat));"depth"in a&&(d.depth=a.depth);"stencil"in a&&(d.stencil=a.stencil);"depthStencil"in a&&(d.depthStencil=a.depthStencil)}else g=1;var f;if(h)if(Array.isArray(h))for(a=0;a<h.length;++a);else f=[h];else for(f=Array(l),h={radius:g,format:k,type:p},a=0;a<l;++a)f[a]=
m.createCube(h);d.color=Array(f.length);for(a=0;a<f.length;++a)l=f[a],g=g||l.width,d.color[a]={target:34069,data:f[a]};for(a=0;6>a;++a){for(l=0;l<f.length;++l)d.color[l].target=34069+a;0<a&&(d.depth=e[0].depth,d.stencil=e[0].stencil,d.depthStencil=e[0].depthStencil);if(e[a])e[a](d);else e[a]=T(d)}return b(c,{width:g,height:g,color:f})}var e=Array(6);c(a);return b(c,{faces:e,resize:function(a){for(var b=0;6>b;++b)e[b].resize(a);return c},_reglType:"framebufferCube",destroy:function(){e.forEach(function(a){a.destroy()})}})},
clear:function(){a(I).forEach(p)}})}},{"./util/extend":23,"./util/values":31}],13:[function(f,n,q){n.exports=function(a,b){var h=1;b.ext_texture_filter_anisotropic&&(h=a.getParameter(34047));var g=1,d=1;b.webgl_draw_buffers&&(g=a.getParameter(34852),d=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),
maxAnisotropic:h,maxDrawbuffers:g,maxColorAttachments:d,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},{}],14:[function(f,n,q){var a=f("./util/is-typed-array");n.exports=function(b,h,g,d,e){return function(c){var e=0,h=0,f=d.framebufferWidth,B=d.framebufferHeight,k=null;a(c)?k=c:c&&(e=c.x|0,h=c.y|0,f=(c.width||d.framebufferWidth-e)|0,B=(c.height||d.framebufferHeight-h)|0,k=c.data||null);g();k=k||new Uint8Array(f*B*4);b.pixelStorei(3333,4);b.readPixels(e,
h,f,B,6408,5121,k);return k}}},{"./util/is-typed-array":26}],15:[function(f,n,q){var a=f("./util/values"),b=[];b[32854]=2;b[32855]=2;b[36194]=2;b[33189]=2;b[36168]=1;b[34041]=4;b[35907]=4;b[34836]=16;b[34842]=8;b[34843]=6;n.exports=function(h,g,d,e,c){function m(a){this.id=B++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;c.profile&&(this.stats={size:0})}function l(a){var b=a.renderbuffer;h.bindRenderbuffer(36161,null);h.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=
0;delete k[a.id];e.renderbufferCount--}var f={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};g.ext_srgb&&(f.srgba=35907);g.ext_color_buffer_half_float&&(f.rgba16f=34842,f.rgb16f=34843);g.webgl_color_buffer_float&&(f.rgba32f=34836);var B=0,k={};m.prototype.decRef=function(){0>=--this.refCount&&l(this)};c.profile&&(e.getTotalRenderbufferSize=function(){var a=0;Object.keys(k).forEach(function(b){a+=k[b].stats.size});return a});return{create:function(a,d){function g(a,
e){var d=0,k=0,m=32854;"object"===typeof a&&a?("shape"in a?(k=a.shape,d=k[0]|0,k=k[1]|0):("radius"in a&&(d=k=a.radius|0),"width"in a&&(d=a.width|0),"height"in a&&(k=a.height|0)),"format"in a&&(m=f[a.format])):"number"===typeof a?(d=a|0,k="number"===typeof e?e|0:d):a||(d=k=1);if(d!==l.width||k!==l.height||m!==l.format)return g.width=l.width=d,g.height=l.height=k,l.format=m,h.bindRenderbuffer(36161,l.renderbuffer),h.renderbufferStorage(36161,m,d,k),c.profile&&(l.stats.size=b[l.format]*l.width*l.height),
g}var l=new m(h.createRenderbuffer());k[l.id]=l;e.renderbufferCount++;g(a,d);g.resize=function(a,e){var d=a|0,k=e|0||d;if(d===l.width&&k===l.height)return g;g.width=l.width=d;g.height=l.height=k;h.bindRenderbuffer(36161,l.renderbuffer);h.renderbufferStorage(36161,l.format,d,k);c.profile&&(l.stats.size=b[l.format]*l.width*l.height);return g};g._reglType="renderbuffer";g._renderbuffer=l;c.profile&&(g.stats=l.stats);g.destroy=function(){l.decRef()};return g},clear:function(){a(k).forEach(l)}}}},{"./util/values":31}],
16:[function(f,n,q){var a=f("./util/values");n.exports=function(b,h,g,d){function e(a,b,c,e){this.name=a;this.id=b;this.location=c;this.info=e}function c(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function m(a,c,e){e=35632===a?f:B;var d=e[c];if(!d){var g=h.str(c),d=b.createShader(a);b.shaderSource(d,g);b.compileShader(d);e[c]=d}return d}function l(a,b){this.id=q++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];d.profile&&
(this.stats={uniformsCount:0,attributesCount:0})}var f={},B={},k={},n=[],q=0;d.profile&&(g.getMaxUniformsCount=function(){var a=0;n.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)});return a},g.getMaxAttributesCount=function(){var a=0;n.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});return{clear:function(){var c=b.deleteShader.bind(b);a(f).forEach(c);f={};a(B).forEach(c);B={};n.forEach(function(a){b.deleteProgram(a.program)});n.length=
0;k={};g.shaderCount=0},program:function(a,f,t){g.shaderCount++;(t=k[f])||(t=k[f]={});var B=t[a];if(!B){var q=B=new l(f,a),y,p;y=m(35632,q.fragId);p=m(35633,q.vertId);f=q.program=b.createProgram();b.attachShader(f,y);b.attachShader(f,p);b.linkProgram(f);var D=b.getProgramParameter(f,35718);d.profile&&(q.stats.uniformsCount=D);var T=q.uniforms;for(y=0;y<D;++y)if(p=b.getActiveUniform(f,y))if(1<p.size)for(var L=0;L<p.size;++L){var O=p.name.replace("[0]","["+L+"]");c(T,new e(O,h.id(O),b.getUniformLocation(f,
O),p))}else c(T,new e(p.name,h.id(p.name),b.getUniformLocation(f,p.name),p));D=b.getProgramParameter(f,35721);d.profile&&(q.stats.attributesCount=D);q=q.attributes;for(y=0;y<D;++y)(p=b.getActiveAttrib(f,y))&&c(q,new e(p.name,h.id(p.name),b.getAttribLocation(f,p.name),p));t[a]=B;n.push(B)}return B},shader:m,frag:null,vert:null}}},{"./util/values":31}],17:[function(f,n,q){n.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,
maxTextureUnits:0}}},{}],18:[function(f,n,q){n.exports=function(){var a={"":0},b=[""];return{id:function(h){var g=a[h];if(g)return g;g=a[h]=b.length;b.push(h);return g},str:function(a){return b[a]}}}},{}],19:[function(f,n,q){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function b(a){return Array.isArray(a)&&0!==a.length&&x(a[0])?!0:!1}function h(a){return Object.prototype.toString.call(a)}function g(c){if(!c)return!1;var e=h(c);return 0<=C.indexOf(e)?!0:a(c)||b(c)||
t(c)}function d(a,b){36193===a.type?(a.data=k(b),B.freeType(b)):a.data=b}function e(a,b,c,e,d,g){a="undefined"!==typeof z[a]?z[a]:u[a]*E[b];g&&(a*=6);if(d){for(e=0;1<=c;)e+=a*c*c,c/=2;return e}return a*c*e}var c=f("./util/extend"),m=f("./util/values"),l=f("./util/is-typed-array"),t=f("./util/is-ndarray"),B=f("./util/pool"),k=f("./util/to-half-float"),x=f("./util/is-array-like");q=f("./constants/arraytypes.json");var y=f("./constants/arraytypes.json"),v=[9984,9986,9985,9987],r=[0,6409,6410,6407,6408],
u={};u[6409]=u[6406]=u[6402]=1;u[34041]=u[6410]=2;u[6407]=u[35904]=3;u[6408]=u[35906]=4;var C=Object.keys(q).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),E=[];E[5121]=1;E[5126]=4;E[36193]=2;E[5123]=2;E[5125]=4;var z=[];z[32854]=2;z[32855]=2;z[36194]=2;z[34041]=4;z[33776]=.5;z[33777]=.5;z[33778]=1;z[33779]=1;z[35986]=.5;z[35987]=1;z[34798]=1;z[35840]=.5;z[35841]=.25;z[35842]=.5;z[35843]=.25;z[36196]=.5;n.exports=
function(f,n,q,z,E,C,J){function U(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function I(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}
function H(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=xa[b.colorSpace]);"type"in b&&(a.type=ga[b.type]);var c=a.width,e=a.height,d=a.channels,g=!1;"shape"in b?(c=b.shape[0],e=b.shape[1],3===b.shape.length&&(d=b.shape[2],g=!0)):("radius"in b&&(c=e=b.radius),"width"in b&&(c=b.width),"height"in b&&(e=b.height),"channels"in b&&(d=b.channels,
g=!0));a.width=c|0;a.height=e|0;a.channels=d|0;c=!1;"format"in b&&(c=b.format,e=a.internalformat=ha[c],a.format=ya[e],c in ga&&!("type"in b)&&(a.type=ga[c]),c in ma&&(a.compressed=!0),c=!0);!g&&c?a.channels=u[a.format]:g&&!c&&a.channels!==r[a.format]&&(a.format=a.internalformat=r[a.channels])}}function G(a){f.pixelStorei(37440,a.flipY);f.pixelStorei(37441,a.premultiplyAlpha);f.pixelStorei(37443,a.colorSpace);f.pixelStorei(3317,a.unpackAlignment)}function ia(){U.call(this);this.yOffset=this.xOffset=
0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function V(c,e){var m=null;g(e)?m=e:e&&(H(c,e),"x"in e&&(c.xOffset=e.x|0),"y"in e&&(c.yOffset=e.y|0),g(e.data)&&(m=e.data));if(e.copy){var f=E.viewportWidth,p=E.viewportHeight;c.width=c.width||f-c.xOffset;c.height=c.height||p-c.yOffset;c.needsCopy=!0}else if(!m)c.width=c.width||1,c.height=c.height||1;else if(l(m))c.data=m,"type"in e||5121!==c.type||(c.type=y[Object.prototype.toString.call(m)]|0);else if(a(m)){f=m;p=c.width*c.height*
c.channels;switch(c.type){case 5121:case 5123:case 5125:case 5126:p=B.allocType(c.type,p);p.set(f);c.data=p;break;case 36193:c.data=k(f)}c.alignment=1;c.needsFree=!0}else if(t(m)){f=m.data;Array.isArray(f)||5121!==c.type||(c.type=y[Object.prototype.toString.call(f)]|0);var p=m.shape,n=m.stride,v,A,q,u;3===p.length?(q=p[2],u=n[2]):u=q=1;v=p[0];A=p[1];p=n[0];n=n[1];c.alignment=1;c.width=v;c.height=A;c.channels=q;c.format=c.internalformat=r[q];c.needsFree=!0;v=u;m=m.offset;q=c.width;u=c.height;A=c.channels;
for(var z=B.allocType(36193===c.type?5126:c.type,q*u*A),D=0,C=0;C<u;++C)for(var F=0;F<q;++F)for(var Z=0;Z<A;++Z)z[D++]=f[p*F+n*C+v*Z+m];d(c,z)}else if("[object HTMLCanvasElement]"===h(m)||"[object CanvasRenderingContext2D]"===h(m))"[object HTMLCanvasElement]"===h(m)?c.element=m:c.element=m.canvas,c.width=c.element.width,c.height=c.element.height;else if("[object HTMLImageElement]"===h(m))c.element=m,c.width=m.naturalWidth,c.height=m.naturalHeight;else if("[object HTMLVideoElement]"===h(m))c.element=
m,c.width=m.videoWidth,c.height=m.videoHeight,c.needsPoll=!0;else if(b(m)){f=m[0].length;p=m.length;n=1;if(x(m[0][0])){v=n=m[0][0].length;q=B.allocType(36193===c.type?5126:c.type,f*p*v);for(A=u=0;A<p;++A)for(z=m[A],D=0;D<f;++D)for(C=z[D],F=0;F<v;++F)q[u++]=C[F];d(c,q)}else{v=B.allocType(36193===c.type?5126:c.type,f*p);for(u=q=0;u<p;++u)for(A=m[u],z=0;z<f;++z)v[q++]=A[z];d(c,v)}c.alignment=1;c.width=f;c.height=p;c.channels=n;c.format=c.internalformat=r[n];c.needsFree=!0}}function X(a,b,c,e,d){var g=
a.element,h=a.data,m=a.internalformat,k=a.format,l=a.type,t=a.width,n=a.height;G(a);g?f.texSubImage2D(b,d,c,e,k,l,g):a.compressed?f.compressedTexSubImage2D(b,d,c,e,m,t,n,h):a.needsCopy?(z(),f.copyTexSubImage2D(b,d,c,e,a.xOffset,a.yOffset,t,n)):f.texSubImage2D(b,d,c,e,t,n,k,l,h)}function aa(){return Ca.pop()||new ia}function Q(a){a.needsFree&&B.freeType(a.data);ia.call(a);Ca.push(a)}function K(){U.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function M(a,
b,c){var e=a.images[0]=aa();a.mipmask=1;e.width=a.width=b;e.height=a.height=c}function R(a,b){var c=null;if(g(b))c=a.images[0]=aa(),I(c,a),V(c,b),a.mipmask=1;else if(H(a,b),Array.isArray(b.mipmap))for(var e=b.mipmap,d=0;d<e.length;++d)c=a.images[d]=aa(),I(c,a),c.width>>=d,c.height>>=d,V(c,e[d]),a.mipmask|=1<<d;else c=a.images[0]=aa(),I(c,a),V(c,b),a.mipmask=1;I(a,a.images[0])}function ja(a,b){for(var c=a.images,e=0;e<c.length&&c[e];++e){var d=c[e],g=b,h=e,m=d.element,k=d.data,l=d.internalformat,t=
d.format,n=d.type,B=d.width,r=d.height;G(d);m?f.texImage2D(g,h,t,t,n,m):d.compressed?f.compressedTexImage2D(g,h,l,B,r,0,k):d.needsCopy?(z(),f.copyTexImage2D(g,h,t,d.xOffset,d.yOffset,B,r,0)):f.texImage2D(g,h,t,B,r,0,t,n,k)}}function qa(){var a=Da.pop()||new K;U.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ua(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&Q(b[c]),b[c]=null;Da.push(a)}function ka(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=
1;this.genMipmaps=!1;this.mipmapHint=4352}function ra(a,b){"min"in b&&(a.minFilter=wa[b.min],0<=v.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=va[b.mag]);var c=a.wrapS,e=a.wrapT;if("wrap"in b){var d=b.wrap;"string"===typeof d?c=e=W[d]:Array.isArray(d)&&(c=W[d[0]],e=W[d[1]])}else"wrapS"in b&&(c=W[b.wrapS]),"wrapT"in b&&(e=W[b.wrapT]);a.wrapS=c;a.wrapT=e;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=Z[b.mipmap];
c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function la(a,b){f.texParameteri(b,10241,a.minFilter);f.texParameteri(b,10240,a.magFilter);f.texParameteri(b,10242,a.wrapS);f.texParameteri(b,10243,a.wrapT);n.ext_texture_filter_anisotropic&&f.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(f.hint(33170,a.mipmapHint),f.generateMipmap(b))}function da(){var a=na.pop()||new ka;ka.call(a);return a}function sa(a){U.call(this);
this.mipmask=0;this.internalformat=6408;this.id=oa++;this.refCount=1;this.target=a;this.texture=f.createTexture();this.unit=-1;this.bindCount=0;J.profile&&(this.stats={size:0})}function S(a){f.activeTexture(33984);f.bindTexture(a.target,a.texture)}function F(){var a=ba[0];a?f.bindTexture(a.target,a.texture):f.bindTexture(3553,null)}function ca(a){var b=a.texture,c=a.unit,e=a.target;0<=c&&(f.activeTexture(33984+c),f.bindTexture(e,null),ba[c]=null);f.deleteTexture(b);a.texture=null;a.params=null;a.pixels=
null;a.refCount=0;delete ea[a.id];C.textureCount--}var Z={"don't care":4352,"dont care":4352,nice:4354,fast:4353},W={repeat:10497,clamp:33071,mirror:33648},va={nearest:9728,linear:9729},wa=c({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},va),xa={none:0,browser:37444},ga={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ha={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,
rgb565:36194},ma={};n.ext_srgb&&(ha.srgb=35904,ha.srgba=35906);n.oes_texture_float&&(ga["float"]=5126);n.oes_texture_half_float&&(ga.float16=ga["half float"]=36193);n.webgl_depth_texture&&(c(ha,{depth:6402,"depth stencil":34041}),c(ga,{uint16:5123,uint32:5125,"depth stencil":34042}));n.webgl_compressed_texture_s3tc&&c(ma,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});n.webgl_compressed_texture_atc&&c(ma,{"rgb atc":35986,"rgba atc explicit alpha":35987,
"rgba atc interpolated alpha":34798});n.webgl_compressed_texture_pvrtc&&c(ma,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});n.webgl_compressed_texture_etc1&&(ma["rgb etc1"]=36196);var Fa=Array.prototype.slice.call(f.getParameter(34467));Object.keys(ma).forEach(function(a){var b=ma[a];0<=Fa.indexOf(b)&&(ha[a]=b)});var Ba=Object.keys(ha);q.textureFormats=Ba;var ya=Ba.reduce(function(a,b){var c=ha[b];6409===c||6406===c||6409===c||6410===c||6402===
c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Ca=[],Da=[],na=[],oa=0,ea={},ta=q.maxTextureUnits,ba=Array(ta).map(function(){return null});c(sa.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<ta;++b){var c=ba[b];if(c){if(0<c.bindCount)continue;c.unit=-1}ba[b]=this;a=b;break}J.profile&&C.maxTextureUnits<a+1&&(C.maxTextureUnits=a+1);this.unit=a;f.activeTexture(33984+a);f.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},
decRef:function(){0>=--this.refCount&&ca(this)}});J.profile&&(C.getTotalTextureSize=function(){var a=0;Object.keys(ea).forEach(function(b){a+=ea[b].stats.size});return a});return{create2D:function(a,b){function c(a,b){var g=da(),h=qa();"number"===typeof a?"number"===typeof b?M(h,a|0,b|0):M(h,a|0,a|0):a?(ra(g,a),R(h,a)):M(h,1,1);g.genMipmaps&&(h.mipmask=(h.width<<1)-1);d.mipmask=h.mipmask;I(d,h);d.internalformat=h.internalformat;c.width=h.width;c.height=h.height;S(d);ja(h,3553);la(g,3553);F();na.push(g);
ua(h);J.profile&&(d.stats.size=e(d.internalformat,d.type,h.width,h.height,g.genMipmaps,!1));return c}var d=new sa(3553);ea[d.id]=d;C.textureCount++;c(a,b);c.subimage=function(a,b,e,g){b|=0;e|=0;g|=0;var h=aa();I(h,d);h.width>>=g;h.height>>=g;h.width-=b;h.height-=e;V(h,a);S(d);X(h,3553,b,e,g);F();Q(h);return c};c.resize=function(a,b){var g=a|0,h=b|0||g;if(g===d.width&&h===d.height)return c;c.width=d.width=g;c.height=d.height=h;S(d);f.texImage2D(3553,0,d.format,g,h,0,d.format,d.type,null);F();J.profile&&
(d.stats.size=e(d.internalformat,d.type,g,h,!1,!1));return c};c._reglType="texture2d";c._texture=d;J.profile&&(c.stats=d.stats);c.destroy=function(){d.decRef()};return c},createCube:function(a,b,c,d,g,h){function m(a,b,c,d,g,h){var f,p=da();for(f=0;6>f;++f)l[f]=qa();if("number"===typeof a||!a)for(a=a|0||1,f=0;6>f;++f)M(l[f],a,a);else if("object"===typeof a)if(b)R(l[0],a),R(l[1],b),R(l[2],c),R(l[3],d),R(l[4],g),R(l[5],h);else if(ra(p,a),H(k,a),"faces"in a)for(a=a.faces,f=0;6>f;++f)I(l[f],k),R(l[f],
a[f]);else for(f=0;6>f;++f)R(l[f],a);I(k,l[0]);k.mipmask=p.genMipmaps?(l[0].width<<1)-1:l[0].mipmask;k.internalformat=l[0].internalformat;m.width=l[0].width;m.height=l[0].height;S(k);for(f=0;6>f;++f)ja(l[f],34069+f);la(p,34067);F();J.profile&&(k.stats.size=e(k.internalformat,k.type,m.width,m.height,p.genMipmaps,!0));na.push(p);for(f=0;6>f;++f)ua(l[f]);return m}var k=new sa(34067);ea[k.id]=k;C.cubeCount++;var l=Array(6);m(a,b,c,d,g,h);m.subimage=function(a,b,c,d,e){c|=0;d|=0;e|=0;var g=aa();I(g,k);
g.width>>=e;g.height>>=e;g.width-=c;g.height-=d;V(g,b);S(k);X(g,34069+a,c,d,e);F();Q(g);return m};m.resize=function(a){a|=0;if(a!==k.width){m.width=k.width=a;m.height=k.height=a;S(k);for(var b=0;6>b;++b)f.texImage2D(34069+b,0,k.format,a,a,0,k.format,k.type,null);F();J.profile&&(k.stats.size=e(k.internalformat,k.type,m.width,m.height,!1,!0));return m}};m._reglType="textureCube";m._texture=k;J.profile&&(m.stats=k.stats);m.destroy=function(){k.decRef()};return m},clear:function(){for(var a=0;a<ta;++a)f.activeTexture(33984+
a),f.bindTexture(3553,null),ba[a]=null;m(ea).forEach(ca);C.cubeCount=0;C.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(f,n,q){n.exports=function(a,b){function h(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function g(a,b,c){var d=m.pop()||new h;d.startQueryIndex=
a;d.endQueryIndex=b;d.sum=0;d.stats=c;f.push(d)}var d=b.ext_disjoint_timer_query;if(!d)return null;var e=[],c=[],m=[],f=[],t=[],n=[];return{beginQuery:function(a){var b=e.pop()||d.createQueryEXT();d.beginQueryEXT(35007,b);c.push(b);g(c.length-1,c.length,a)},endQuery:function(){d.endQueryEXT(35007)},pushScopeStats:g,update:function(){var a,b;a=c.length;if(0!==a){n.length=Math.max(n.length,a+1);t.length=Math.max(t.length,a+1);t[0]=0;var g=n[0]=0;for(b=a=0;b<c.length;++b){var h=c[b];d.getQueryObjectEXT(h,
34919)?(g+=d.getQueryObjectEXT(h,34918),e.push(h)):c[a++]=h;t[b+1]=g;n[b+1]=a}c.length=a;for(b=a=0;b<f.length;++b){var g=f[b],r=g.startQueryIndex,h=g.endQueryIndex;g.sum+=t[h]-t[r];r=n[r];h=n[h];h===r?(g.stats.gpuTime+=g.sum/1E6,m.push(g)):(g.startQueryIndex=r,g.endQueryIndex=h,f[a++]=g)}f.length=a}},getNumPendingQueries:function(){return c.length},clear:function(){e.push.apply(e,c);for(var a=0;a<e.length;a++)d.deleteQueryEXT(e[a]);c.length=0;e.length=0}}}},{}],21:[function(f,n,q){n.exports="undefined"!==
typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(f,n,q){function a(a){return Array.prototype.slice.call(a)}function b(b){return a(b).join("")}var h=f("./extend");n.exports=function(){function g(){var c=[],d=[];return h(function(){c.push.apply(c,a(arguments))},{def:function(){var b="v"+e++;d.push(b);0<arguments.length&&(c.push(b,"="),c.push.apply(c,a(arguments)),c.push(";"));return b},toString:function(){return b([0<d.length?"var "+
d+";":"",b(c)])}})}function d(){function b(a,e){d(a,e,"=",c.def(a,e),";")}var c=g(),d=g(),e=c.toString,m=d.toString;return h(function(){c.apply(c,a(arguments))},{def:c.def,entry:c,exit:d,save:b,set:function(a,d,e){b(a,d);c(a,d,"=",e,";")},toString:function(){return e()+m()}})}var e=0,c=[],m=[],f=g(),t={};return{global:f,link:function(a){for(var b=0;b<m.length;++b)if(m[b]===a)return c[b];b="g"+e++;c.push(b);m.push(a);return b},block:g,proc:function(a,c){function e(){var a="a"+g.length;g.push(a);return a}
var g=[];c=c||0;for(var m=0;m<c;++m)e();var m=d(),f=m.toString;return t[a]=h(m,{arg:e,toString:function(){return b(["function(",g.join(),"){",f(),"}"])}})},scope:d,cond:function(){var c=b(arguments),e=d(),g=d(),m=e.toString,f=g.toString;return h(e,{then:function(){e.apply(e,a(arguments));return this},"else":function(){g.apply(g,a(arguments));return this},toString:function(){var a=f();a&&(a="else{"+a+"}");return b(["if(",c,"){",m(),"}",a])}})},compile:function(){var a=['"use strict";',f,"return {"];
Object.keys(t).forEach(function(b){a.push('"',b,'":',t[b].toString(),",")});a.push("}");var d=b(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,c.concat(d)).apply(null,m)}}}},{"./extend":23}],23:[function(f,n,q){n.exports=function(a,b){for(var h=Object.keys(b),g=0;g<h.length;++g)a[h[g]]=b[h[g]];return a}},{}],24:[function(f,n,q){var a=f("./is-typed-array");n.exports=function(b){return Array.isArray(b)||a(b)}},{"./is-typed-array":26}],25:[function(f,n,q){var a=
f("./is-typed-array");n.exports=function(b){return!!b&&"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":26}],26:[function(f,n,q){var a=f("../constants/arraytypes.json");n.exports=function(b){return Object.prototype.toString.call(b)in a}},{"../constants/arraytypes.json":4}],27:[function(f,n,q){n.exports=function(a,b){for(var h=Array(a),g=0;g<a;++g)h[g]=b(g);return h}},
{}],28:[function(f,n,q){function a(a){var b,c;b=(65535<a)<<4;a>>>=b;c=(255<a)<<3;a>>>=c;b|=c;c=(15<a)<<2;a>>>=c;b|=c;c=(3<a)<<1;return b|c|a>>>c>>1}function b(b){a:{for(var e=16;268435456>=e;e*=16)if(b<=e){b=e;break a}b=0}e=g[a(b)>>2];return 0<e.length?e.pop():new ArrayBuffer(b)}function h(b){g[a(b.byteLength)>>2].push(b)}var g=f("./loop")(8,function(){return[]});n.exports={alloc:b,free:h,allocType:function(a,e){var c=null;switch(a){case 5120:c=new Int8Array(b(e),0,e);break;case 5121:c=new Uint8Array(b(e),
0,e);break;case 5122:c=new Int16Array(b(2*e),0,e);break;case 5123:c=new Uint16Array(b(2*e),0,e);break;case 5124:c=new Int32Array(b(4*e),0,e);break;case 5125:c=new Uint32Array(b(4*e),0,e);break;case 5126:c=new Float32Array(b(4*e),0,e);break;default:return null}return c.length!==e?c.subarray(0,e):c},freeType:function(a){h(a.buffer)}}},{"./loop":27}],29:[function(f,n,q){n.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},
cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){return setTimeout(a,16)},cancel:clearTimeout}},{}],30:[function(f,n,q){var a=f("./pool"),b=new Float32Array(1),h=new Uint32Array(b.buffer);n.exports=function(g){for(var d=a.allocType(5123,g.length),e=0;e<g.length;++e)if(isNaN(g[e]))d[e]=65535;else if(Infinity===g[e])d[e]=31744;else if(-Infinity===g[e])d[e]=64512;else{b[0]=g[e];var c=h[0],m=c>>>31<<15,f=(c<<1>>>24)-127,c=c>>13&1023;d[e]=-24>f?m:-14>f?m+(c+1024>>-14-f):15<f?m+31744:
m+(f+15<<10)+c}return d}},{"./pool":28}],31:[function(f,n,q){n.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},{}],32:[function(f,n,q){function a(a,b,g){function h(){var b=window.innerWidth,c=window.innerHeight;a!==document.body&&(c=a.getBoundingClientRect(),b=c.right-c.left,c=c.top-c.bottom);f.width=g*b;f.height=g*c;d(f.style,{width:b+"px",height:c+"px"})}var f=document.createElement("canvas");d(f.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(f);a===document.body&&
(f.style.position="absolute",d(a.style,{margin:0,padding:0}));window.addEventListener("resize",h,!1);h();return{canvas:f,onDestroy:function(){window.removeEventListener("resize",h);a.removeChild(f)}}}function b(a,b){function d(g){try{return a.getContext(g,b)}catch(h){return null}}return d("webgl")||d("experimental-webgl")||d("webgl-experimental")}function h(a){return"string"===typeof a?a.split():a}function g(a){return"string"===typeof a?document.querySelector(a):a}var d=f("./util/extend");n.exports=
function(d){var c=d||{},f,l,t,n;d={};var k=[],q=[],y="undefined"===typeof window?1:window.devicePixelRatio,v=!1,r=function(a){},u=function(){};"string"===typeof c?f=document.querySelector(c):"object"===typeof c&&("string"===typeof c.nodeName&&"function"===typeof c.appendChild&&"function"===typeof c.getBoundingClientRect?f=c:"function"===typeof c.drawArrays||"function"===typeof c.drawElements?(n=c,t=n.canvas):("gl"in c?n=c.gl:"canvas"in c?t=g(c.canvas):"container"in c&&(l=g(c.container)),"attributes"in
c&&(d=c.attributes),"extensions"in c&&(k=h(c.extensions)),"optionalExtensions"in c&&(q=h(c.optionalExtensions)),"onDone"in c&&(r=c.onDone),"profile"in c&&(v=!!c.profile),"pixelRatio"in c&&(y=+c.pixelRatio)));f&&("canvas"===f.nodeName.toLowerCase()?t=f:l=f);if(!n){if(!t){f=a(l||document.body,r,y);if(!f)return null;t=f.canvas;u=f.onDestroy}n=b(t,d)}return n?{gl:n,canvas:t,container:l,extensions:k,optionalExtensions:q,pixelRatio:y,profile:v,onDone:r,onDestroy:u}:(u(),r("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),
null)}},{"./util/extend":23}],33:[function(f,n,q){n.exports=function(a,b){var h=b[0],g=b[1],d=b[2],e=b[3],c=b[4],f=b[5],l=b[6],t=b[7],n=b[8],k=b[9],q=b[10],y=b[11],v=b[12],r=b[13],u=b[14],C=b[15];a[0]=f*(q*C-y*u)-k*(l*C-t*u)+r*(l*y-t*q);a[1]=-(g*(q*C-y*u)-k*(d*C-e*u)+r*(d*y-e*q));a[2]=g*(l*C-t*u)-f*(d*C-e*u)+r*(d*t-e*l);a[3]=-(g*(l*y-t*q)-f*(d*y-e*q)+k*(d*t-e*l));a[4]=-(c*(q*C-y*u)-n*(l*C-t*u)+v*(l*y-t*q));a[5]=h*(q*C-y*u)-n*(d*C-e*u)+v*(d*y-e*q);a[6]=-(h*(l*C-t*u)-c*(d*C-e*u)+v*(d*t-e*l));a[7]=h*
(l*y-t*q)-c*(d*y-e*q)+n*(d*t-e*l);a[8]=c*(k*C-y*r)-n*(f*C-t*r)+v*(f*y-t*k);a[9]=-(h*(k*C-y*r)-n*(g*C-e*r)+v*(g*y-e*k));a[10]=h*(f*C-t*r)-c*(g*C-e*r)+v*(g*t-e*f);a[11]=-(h*(f*y-t*k)-c*(g*y-e*k)+n*(g*t-e*f));a[12]=-(c*(k*u-q*r)-n*(f*u-l*r)+v*(f*q-l*k));a[13]=h*(k*u-q*r)-n*(g*u-d*r)+v*(g*q-d*k);a[14]=-(h*(f*u-l*r)-c*(g*u-d*r)+v*(g*l-d*f));a[15]=h*(f*q-l*k)-c*(g*q-d*k)+n*(g*l-d*f);return a}},{}],34:[function(f,n,q){n.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];
b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}},{}],35:[function(f,n,q){n.exports=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],36:[function(f,n,q){n.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;
a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],37:[function(f,n,q){n.exports=function(a){var b=a[0],h=a[1],g=a[2],d=a[3],e=a[4],c=a[5],f=a[6],l=a[7],n=a[8],q=a[9],k=a[10],x=a[11],y=a[12],v=a[13],r=a[14];a=a[15];return(b*c-h*e)*(k*a-x*r)-(b*f-g*e)*(q*a-x*v)+(b*l-d*e)*(q*r-k*v)+(h*f-g*c)*(n*a-x*y)-(h*l-d*c)*(n*r-k*y)+(g*l-d*f)*(n*v-q*y)}},{}],38:[function(f,n,q){n.exports=function(a,b){var h=b[0],g=b[1],d=b[2],e=b[3],c=h+h,f=g+g,l=d+d,h=h*c,n=g*c,g=g*f,q=d*c,k=d*f,d=d*
l,c=e*c,f=e*f,e=e*l;a[0]=1-g-d;a[1]=n+e;a[2]=q-f;a[3]=0;a[4]=n-e;a[5]=1-h-d;a[6]=k+c;a[7]=0;a[8]=q+f;a[9]=k-c;a[10]=1-h-g;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],39:[function(f,n,q){n.exports=function(a,b,h){var g=b[0],d=b[1],e=b[2],c=b[3],f=g+g,l=d+d,n=e+e;b=g*f;var q=g*l,g=g*n,k=d*l,d=d*n,e=e*n,f=c*f,l=c*l,c=c*n;a[0]=1-(k+e);a[1]=q+c;a[2]=g-l;a[3]=0;a[4]=q-c;a[5]=1-(b+e);a[6]=d+f;a[7]=0;a[8]=g+l;a[9]=d-f;a[10]=1-(b+k);a[11]=0;a[12]=h[0];a[13]=h[1];a[14]=h[2];a[15]=1;return a}},{}],
40:[function(f,n,q){n.exports=function(a,b,h,g,d,e,c){var f=1/(h-b),l=1/(d-g),n=1/(e-c);a[0]=2*e*f;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e*l;a[6]=0;a[7]=0;a[8]=(h+b)*f;a[9]=(d+g)*l;a[10]=(c+e)*n;a[11]=-1;a[12]=0;a[13]=0;a[14]=c*e*2*n;a[15]=0;return a}},{}],41:[function(f,n,q){n.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],42:[function(f,n,q){n.exports={create:f("./create"),clone:f("./clone"),copy:f("./copy"),
identity:f("./identity"),transpose:f("./transpose"),invert:f("./invert"),adjoint:f("./adjoint"),determinant:f("./determinant"),multiply:f("./multiply"),translate:f("./translate"),scale:f("./scale"),rotate:f("./rotate"),rotateX:f("./rotateX"),rotateY:f("./rotateY"),rotateZ:f("./rotateZ"),fromRotationTranslation:f("./fromRotationTranslation"),fromQuat:f("./fromQuat"),frustum:f("./frustum"),perspective:f("./perspective"),perspectiveFromFieldOfView:f("./perspectiveFromFieldOfView"),ortho:f("./ortho"),
lookAt:f("./lookAt"),str:f("./str")}},{"./adjoint":33,"./clone":34,"./copy":35,"./create":36,"./determinant":37,"./fromQuat":38,"./fromRotationTranslation":39,"./frustum":40,"./identity":41,"./invert":43,"./lookAt":44,"./multiply":45,"./ortho":46,"./perspective":47,"./perspectiveFromFieldOfView":48,"./rotate":49,"./rotateX":50,"./rotateY":51,"./rotateZ":52,"./scale":53,"./str":54,"./translate":55,"./transpose":56}],43:[function(f,n,q){n.exports=function(a,b){var h=b[0],g=b[1],d=b[2],e=b[3],c=b[4],
f=b[5],l=b[6],n=b[7],q=b[8],k=b[9],x=b[10],y=b[11],v=b[12],r=b[13],u=b[14],C=b[15],E=h*f-g*c,z=h*l-d*c,p=h*n-e*c,D=g*l-d*f,T=g*n-e*f,L=d*n-e*l,O=q*r-k*v,P=q*u-x*v,J=q*C-y*v,U=k*u-x*r,I=k*C-y*r,H=x*C-y*u,G=E*H-z*I+p*U+D*J-T*P+L*O;if(!G)return null;G=1/G;a[0]=(f*H-l*I+n*U)*G;a[1]=(d*I-g*H-e*U)*G;a[2]=(r*L-u*T+C*D)*G;a[3]=(x*T-k*L-y*D)*G;a[4]=(l*J-c*H-n*P)*G;a[5]=(h*H-d*J+e*P)*G;a[6]=(u*p-v*L-C*z)*G;a[7]=(q*L-x*p+y*z)*G;a[8]=(c*I-f*J+n*O)*G;a[9]=(g*J-h*I-e*O)*G;a[10]=(v*T-r*p+C*E)*G;a[11]=(k*p-q*T-y*
E)*G;a[12]=(f*P-c*U-l*O)*G;a[13]=(h*U-g*P+d*O)*G;a[14]=(r*z-v*D-u*E)*G;a[15]=(q*D-k*z+x*E)*G;return a}},{}],44:[function(f,n,q){var a=f("./identity");n.exports=function(b,h,g,d){var e,c,f,l,n,q,k,x,y=h[0],v=h[1];h=h[2];f=d[0];l=d[1];c=d[2];k=g[0];d=g[1];e=g[2];if(1E-6>Math.abs(y-k)&&1E-6>Math.abs(v-d)&&1E-6>Math.abs(h-e))return a(b);g=y-k;d=v-d;k=h-e;x=1/Math.sqrt(g*g+d*d+k*k);g*=x;d*=x;k*=x;e=l*k-c*d;c=c*g-f*k;f=f*d-l*g;(x=Math.sqrt(e*e+c*c+f*f))?(x=1/x,e*=x,c*=x,f*=x):f=c=e=0;l=d*f-k*c;n=k*e-g*
f;q=g*c-d*e;(x=Math.sqrt(l*l+n*n+q*q))?(x=1/x,l*=x,n*=x,q*=x):q=n=l=0;b[0]=e;b[1]=l;b[2]=g;b[3]=0;b[4]=c;b[5]=n;b[6]=d;b[7]=0;b[8]=f;b[9]=q;b[10]=k;b[11]=0;b[12]=-(e*y+c*v+f*h);b[13]=-(l*y+n*v+q*h);b[14]=-(g*y+d*v+k*h);b[15]=1;return b}},{"./identity":41}],45:[function(f,n,q){n.exports=function(a,b,f){var g=b[0],d=b[1],e=b[2],c=b[3],m=b[4],l=b[5],n=b[6],q=b[7],k=b[8],x=b[9],y=b[10],v=b[11],r=b[12],u=b[13],C=b[14];b=b[15];var E=f[0],z=f[1],p=f[2],D=f[3];a[0]=E*g+z*m+p*k+D*r;a[1]=E*d+z*l+p*x+D*u;a[2]=
E*e+z*n+p*y+D*C;a[3]=E*c+z*q+p*v+D*b;E=f[4];z=f[5];p=f[6];D=f[7];a[4]=E*g+z*m+p*k+D*r;a[5]=E*d+z*l+p*x+D*u;a[6]=E*e+z*n+p*y+D*C;a[7]=E*c+z*q+p*v+D*b;E=f[8];z=f[9];p=f[10];D=f[11];a[8]=E*g+z*m+p*k+D*r;a[9]=E*d+z*l+p*x+D*u;a[10]=E*e+z*n+p*y+D*C;a[11]=E*c+z*q+p*v+D*b;E=f[12];z=f[13];p=f[14];D=f[15];a[12]=E*g+z*m+p*k+D*r;a[13]=E*d+z*l+p*x+D*u;a[14]=E*e+z*n+p*y+D*C;a[15]=E*c+z*q+p*v+D*b;return a}},{}],46:[function(f,n,q){n.exports=function(a,b,f,g,d,e,c){var m=1/(b-f),l=1/(g-d),n=1/(e-c);a[0]=-2*m;a[1]=
0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*l;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*n;a[11]=0;a[12]=(b+f)*m;a[13]=(d+g)*l;a[14]=(c+e)*n;a[15]=1;return a}},{}],47:[function(f,n,q){n.exports=function(a,b,f,g,d){b=1/Math.tan(b/2);var e=1/(g-d);a[0]=b/f;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(d+g)*e;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*d*g*e;a[15]=0;return a}},{}],48:[function(f,n,q){n.exports=function(a,b,f,g){var d=Math.tan(b.upDegrees*Math.PI/180),e=Math.tan(b.downDegrees*Math.PI/180),c=
Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var m=2/(c+b),l=2/(d+e);a[0]=m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=l;a[6]=0;a[7]=0;a[8]=-((c-b)*m*.5);a[9]=(d-e)*l*.5;a[10]=g/(f-g);a[11]=-1;a[12]=0;a[13]=0;a[14]=g*f/(f-g);a[15]=0;return a}},{}],49:[function(f,n,q){n.exports=function(a,b,f,g){var d=g[0],e=g[1];g=g[2];var c=Math.sqrt(d*d+e*e+g*g),m,l,n,q,k,x,y,v,r,u,C,E,z,p,D,T,L,O,P,J;if(1E-6>Math.abs(c))return null;c=1/c;d*=c;e*=c;g*=c;m=Math.sin(f);l=Math.cos(f);n=1-l;f=b[0];
c=b[1];q=b[2];k=b[3];x=b[4];y=b[5];v=b[6];r=b[7];u=b[8];C=b[9];E=b[10];z=b[11];p=d*d*n+l;D=e*d*n+g*m;T=g*d*n-e*m;L=d*e*n-g*m;O=e*e*n+l;P=g*e*n+d*m;J=d*g*n+e*m;d=e*g*n-d*m;e=g*g*n+l;a[0]=f*p+x*D+u*T;a[1]=c*p+y*D+C*T;a[2]=q*p+v*D+E*T;a[3]=k*p+r*D+z*T;a[4]=f*L+x*O+u*P;a[5]=c*L+y*O+C*P;a[6]=q*L+v*O+E*P;a[7]=k*L+r*O+z*P;a[8]=f*J+x*d+u*e;a[9]=c*J+y*d+C*e;a[10]=q*J+v*d+E*e;a[11]=k*J+r*d+z*e;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],50:[function(f,n,q){n.exports=function(a,b,
f){var g=Math.sin(f);f=Math.cos(f);var d=b[4],e=b[5],c=b[6],m=b[7],l=b[8],n=b[9],q=b[10],k=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=d*f+l*g;a[5]=e*f+n*g;a[6]=c*f+q*g;a[7]=m*f+k*g;a[8]=l*f-d*g;a[9]=n*f-e*g;a[10]=q*f-c*g;a[11]=k*f-m*g;return a}},{}],51:[function(f,n,q){n.exports=function(a,b,f){var g=Math.sin(f);f=Math.cos(f);var d=b[0],e=b[1],c=b[2],m=b[3],l=b[8],n=b[9],q=b[10],k=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],
a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*f-l*g;a[1]=e*f-n*g;a[2]=c*f-q*g;a[3]=m*f-k*g;a[8]=d*g+l*f;a[9]=e*g+n*f;a[10]=c*g+q*f;a[11]=m*g+k*f;return a}},{}],52:[function(f,n,q){n.exports=function(a,b,f){var g=Math.sin(f);f=Math.cos(f);var d=b[0],e=b[1],c=b[2],m=b[3],l=b[4],n=b[5],q=b[6],k=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*f+l*g;a[1]=e*f+n*g;a[2]=c*f+q*g;a[3]=m*f+k*g;a[4]=l*f-d*g;a[5]=n*f-e*g;a[6]=q*f-c*g;a[7]=
k*f-m*g;return a}},{}],53:[function(f,n,q){n.exports=function(a,b,f){var g=f[0],d=f[1];f=f[2];a[0]=b[0]*g;a[1]=b[1]*g;a[2]=b[2]*g;a[3]=b[3]*g;a[4]=b[4]*d;a[5]=b[5]*d;a[6]=b[6]*d;a[7]=b[7]*d;a[8]=b[8]*f;a[9]=b[9]*f;a[10]=b[10]*f;a[11]=b[11]*f;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],54:[function(f,n,q){n.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+
a[14]+", "+a[15]+")"}},{}],55:[function(f,n,q){n.exports=function(a,b,f){var g=f[0],d=f[1];f=f[2];var e,c,m,l,n,q,k,x,y,v,r,u;b===a?(a[12]=b[0]*g+b[4]*d+b[8]*f+b[12],a[13]=b[1]*g+b[5]*d+b[9]*f+b[13],a[14]=b[2]*g+b[6]*d+b[10]*f+b[14],a[15]=b[3]*g+b[7]*d+b[11]*f+b[15]):(e=b[0],c=b[1],m=b[2],l=b[3],n=b[4],q=b[5],k=b[6],x=b[7],y=b[8],v=b[9],r=b[10],u=b[11],a[0]=e,a[1]=c,a[2]=m,a[3]=l,a[4]=n,a[5]=q,a[6]=k,a[7]=x,a[8]=y,a[9]=v,a[10]=r,a[11]=u,a[12]=e*g+n*d+y*f+b[12],a[13]=c*g+q*d+v*f+b[13],a[14]=m*g+k*
d+r*f+b[14],a[15]=l*g+x*d+u*f+b[15]);return a}},{}],56:[function(f,n,q){n.exports=function(a,b){if(a===b){var f=b[1],g=b[2],d=b[3],e=b[6],c=b[7],m=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=f;a[6]=b[9];a[7]=b[13];a[8]=g;a[9]=e;a[11]=b[14];a[12]=d;a[13]=c;a[14]=m}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],57:[function(f,n,q){function a(a,c,d,f){f[0]=b(255*
a);f[1]=b(255*c);f[2]=b(255*d)}var b=Math.round,h=Math.min,g=Math.max,d=Math.ceil;n.exports=function(b,c,f,l){l=l||[0,0,0];b%=360;c=g(0,h(c,1));f=g(0,h(f,1));if(c){c=(1-c)*f;var n=f-c,q=b%60;switch(b/60|0){case 0:a(f,n*b/60+c,c,l);break;case 1:a(n*(60-q)/60+c,f,c,l);break;case 2:a(c,f,n*q/60+c,l);break;case 3:a(c,n*(60-q)/60+c,f,l);break;case 4:a(n*q/60+c,c,f,l);break;case 5:a(f,c,n*(60-q)/60+c,l)}}else l[0]=l[1]=l[2]=d(255*f);return l}},{}],58:[function(f,n,q){function a(a,b){for(var c=0;c<a.length;++c)if(a[c]===
b)return c;return-1}var b=f("./lib/util/extend"),h=f("./lib/dynamic"),g=f("./lib/util/raf"),d=f("./lib/util/clock"),e=f("./lib/strings"),c=f("./lib/webgl"),m=f("./lib/extension"),l=f("./lib/limits"),t=f("./lib/buffer"),B=f("./lib/elements"),k=f("./lib/texture"),x=f("./lib/renderbuffer"),y=f("./lib/framebuffer"),v=f("./lib/attribute"),r=f("./lib/shader"),u=f("./lib/read"),C=f("./lib/core"),E=f("./lib/stats"),z=f("./lib/timer");n.exports=function(f){function n(){if(0===F.length)X&&X.update(),ca=null;
else{ca=g.next(n);J();for(var a=F.length-1;0<=a;--a){var b=F[a];b&&b(M,null,0)}H.flush();X&&X.update()}}function q(a){}function L(a){}function O(a){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var e=a[c];h.isDynamic(e)?d[c]=h.unbox(e,c):b[c]=e});return{dynamic:d,"static":b}}function d(a){for(;p.length<a;)p.push(null);return p}var e=c(a.context||{}),f=c(a.uniforms||{}),g=c(a.attributes||{}),k=c(function(a){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+
"."+c]=b[c]})}}var d=b({},a);delete d.uniforms;delete d.attributes;delete d.context;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(a));a={gpuTime:0,cpuTime:0,count:0};var e=da.compile(k,g,f,e,a),l=e.draw,m=e.batch,n=e.scope,p=[];return b(function(a,b){var c;if("function"===typeof a)return n.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)n.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)n.call(this,
a[c],b,c);else return n.call(this,a,b,0);else if("number"===typeof a){if(0<a)return m.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return m.call(this,a,a.length)}else return l.call(this,a)},{stats:a})}function P(){var a=sa.viewport,b=sa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;M.viewportWidth=M.framebufferWidth=M.drawingBufferWidth=a[2]=b[2]=H.drawingBufferWidth;M.viewportHeight=M.framebufferHeight=M.drawingBufferHeight=a[3]=b[3]=H.drawingBufferHeight}function J(){M.tick+=1;M.time=(d()-aa)/
1E3;P();da.procs.poll()}function U(){P();da.procs.refresh();X&&X.update()}var I=c(f);if(!I)return null;var H=I.gl;f=H.getContextAttributes();var G=m(H,I);if(!G)return null;var ia=e(),V=E(),G=G.extensions,X=z(H,G),aa=d(),Q=H.drawingBufferWidth,K=H.drawingBufferHeight,M={tick:0,time:0,viewportWidth:Q,viewportHeight:K,framebufferWidth:Q,framebufferHeight:K,drawingBufferWidth:Q,drawingBufferHeight:K,pixelRatio:I.pixelRatio},R=l(H,G),ja=t(H,V,I),qa=B(H,G,ja,V),Q=v(H,G,R,ja,ia),ua=r(H,ia,V,I),ka=k(H,G,
R,function(){da.procs.poll()},M,V,I),ra=x(H,G,R,V,I),la=y(H,G,R,ka,ra,V),da=C(H,ia,G,R,ja,qa,ka,la,{},Q,ua,{elements:null,primitive:4,count:-1,offset:0,instances:-1},M,X,I),ia=u(H,la,da.procs.poll,M,f),sa=da.next,S=H.canvas,F=[],ca=null;S&&(S.addEventListener("webglcontextlost",q,!1),S.addEventListener("webglcontextrestored",L,!1));U();f=b(O,{clear:function(a){var b=0;da.procs.poll();var c=a.color;c&&(H.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(H.clearDepth(+a.depth),
b|=256);"stencil"in a&&(H.clearStencil(a.stencil|0),b|=1024);H.clear(b)},prop:h.define.bind(null,1),context:h.define.bind(null,2),"this":h.define.bind(null,3),draw:O({}),buffer:function(a){return ja.create(a,34962)},elements:qa.create,texture:ka.create2D,cube:ka.createCube,renderbuffer:ra.create,framebuffer:la.create,framebufferCube:la.createCube,attributes:f,frame:function(b){F.push(b);!ca&&0<F.length&&(ca=g.next(n));return{cancel:function(){function c(){var b=a(F,c);F[b]=F[F.length-1];--F.length;
0>=F.length&&ca&&(g.cancel(n),ca=null)}var d=a(F,b);F[d]=c}}},limits:R,hasExtension:function(a){return 0<=R.extensions.indexOf(a.toLowerCase())},read:ia,destroy:function(){F.length=0;ca&&(g.cancel(n),ca=null);S&&(S.removeEventListener("webglcontextlost",q),S.removeEventListener("webglcontextrestored",L));ua.clear();la.clear();ra.clear();ka.clear();qa.clear();ja.clear();X&&X.clear();I.onDestroy()},_gl:H,_refresh:U,poll:function(){J();X&&X.update()},stats:V});I.onDone(null,f);return f}},{"./lib/attribute":2,
"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>