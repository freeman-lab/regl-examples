(function e$$0(k,m,a){function b(d,g){if(!m[d]){if(!k[d]){var l="function"==typeof require&&require;if(!g&&l)return l(d,!0);if(c)return c(d,!0);l=Error("Cannot find module '"+d+"'");throw l.code="MODULE_NOT_FOUND",l;}l=m[d]={exports:{}};k[d][0].call(l.exports,function(a){var c=k[d][1][a];return b(c?c:a)},l,l.exports,e$$0,k,m,a)}return m[d].exports}for(var c="function"==typeof require&&require,d=0;d<a.length;d++)b(a[d]);return b})({1:[function(e,k,m){var a=e("../regl")(),b=e("gl-mat4"),c=e("hsv2rgb");
e=a.buffer(Array(1E4).fill().map(function(){var a=c(360*Math.random(),.6,1);return[10*Math.random(),10*Math.random(),10*Math.random(),10*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),a[0]/255,a[1]/255,a[2]/255]}));var d=a({vert:"\n  precision mediump float;\n  attribute vec4 freq, phase;\n  attribute vec3 color;\n  uniform float time;\n  uniform mat4 view, projection;\n  varying vec3 fragColor;\n  void main() {\n    vec3 position = 8.0 * cos(freq.xyz * time + phase.xyz);\n    gl_PointSize = 5.0 * (1.0 + cos(freq.w * time + phase.w));\n    gl_Position = projection * view * vec4(position, 1);\n    fragColor = color;\n  }",
frag:"\n  precision lowp float;\n  varying vec3 fragColor;\n  void main() {\n    if (length(gl_PointCoord.xy - 0.5) > 0.5) {\n      discard;\n    }\n    gl_FragColor = vec4(fragColor, 1);\n  }",attributes:{freq:{buffer:e,stride:44,offset:0},phase:{buffer:e,stride:44,offset:16},color:{buffer:e,stride:44,offset:32}},uniforms:{view:function(a,c,d){a=.01*d.count;return b.lookAt([],[30*Math.cos(a),2.5,30*Math.sin(a)],[0,0,0],[0,1,0])},projection:function(a,c,d){return b.perspective([],Math.PI/4,d.width/
d.height,.01,1E3)},time:function(a,b,c){return.001*c.count}},count:1E4,primitive:"points"});a.frame(function(){a.clear({depth:1,color:[0,0,0,1]});d()})},{"../regl":57,"gl-mat4":41,hsv2rgb:56}],2:[function(e,k,m){function a(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}var b=e("./constants/dtypes.json");Object.assign(a.prototype,{equals:function(a,b){return this.pointer?a.pointer&&this.buffer===
a.buffer&&this.size===b&&this.normalized===a.normalized&&this.type===a.type&&this.offset===a.offset&&this.stride===a.stride&&this.divisor===a.divisor:!a.pointer&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w},set:function(a,b){(this.pointer=a.pointer)?(this.buffer=a.buffer,this.size=b,this.normalized=a.normalized,this.type=a.type,this.offset=a.offset,this.stride=a.stride,this.divisor=a.divisor):(this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w)}});k.exports=function(c,d,f,g){function l(){for(var b=
Array(16),c=0;16>c;++c)b[c]=new a;this.records=b;this.top=0}function q(b){for(var c=b.records,d=b.top;c.length-1<=d;)c.push(new a);return c[++b.top]}var h={};f=f.maxAttributes;for(var P=Array(f),e=0;e<f;++e)P[e]=new a;Object.assign(l.prototype,{pushVec:function(a,b,c,d){var f=q(this);f.pointer=!1;f.x=a;f.y=b;f.z=c;f.w=d},pushPtr:function(a,b,c,d,f,g,l){var h=q(this);h.pointer=!0;h.buffer=a;h.size=b;h.offset=c;h.stride=d;h.divisor=f;h.normalized=g;h.type=l},pushDyn:function(a){if("number"===typeof a)this.pushVec(a,
0,0,0);else if(Array.isArray(a))this.pushVec(a[0],a[1],a[2],a[3]);else{var c=g.getBuffer(a),d=0,f=0,l=0,q=0,h=!1,e=5126;c?e=c.dtype:(c=g.getBuffer(a.buffer),d=a.size||0,f=a.stride||0,l=a.offset||0,q=a.divisor||0,h=a.normalized||!1,e=c.dtype,"type"in a&&(e=b[a.type]));this.pushPtr(c,d,l,f,q,h,e)}},pop:function(){--this.top}});return{bindings:P,attributes:h,bind:function(a,b,f,g){g=f.size||g;if(!b.equals(f,g)){if(f.pointer){b.pointer||c.enableVertexAttribArray(a);b.buffer!==f.buffer&&f.buffer.bind();
c.vertexAttribPointer(a,g,f.type,f.normalized,f.stride,f.offset);var l=d.angle_instanced_arrays;l&&l.vertexAttribDivisorANGLE(a,f.divisor)}else b.pointer&&c.disableVertexAttribArray(a),c.vertexAttrib4f(a,f.x,f.y,f.z,f.w);b.set(f,g)}},def:function(a){a in h||(h[a]=new l)}}}},{"./constants/dtypes.json":9}],3:[function(e,k,m){function a(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);case 5122:return new Int16Array(b);
case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var b=e("./check"),c=e("./is-typed-array"),d=e("./is-ndarray"),f=e("./constants/arraytypes.json"),g=e("./constants/dtypes.json"),l=e("./values"),q={"static":35044,dynamic:35048,stream:35040};k.exports=function(h){function e(a,b){this.id=n++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function k(a){h.isBuffer(a.buffer)||(a.buffer=h.createBuffer());
a.bind();h.bufferData(a.type,a.data||a.byteLength,a.usage)}function r(a){var c=a.buffer;b(c,"buffer must not be deleted already");h.isBuffer(c)&&h.deleteBuffer(c);a.buffer=null;delete p[a.id]}var n=0,p={};e.prototype.bind=function(){h.bindBuffer(this.type,this.buffer)};return{create:function(l,n,w){function v(l){var h=l||{};if(Array.isArray(h)||c(h)||d(h))h={data:h};else if("number"===typeof h)h={length:h|0};else if(null===h||void 0===h)h={};b.type(h,"object","buffer arguments must be an object, a number or an array");
"usage"in h?(b.parameter(h.usage,q,"invalid buffer usage"),D.usage=q[h.usage]):D.usage=35044;l=0;"type"in h&&(b.parameter(h.type,g,"invalid buffer type"),l=g[h.type]);var r=h.dimension|0||1,p=0,n=null;if("data"in h)if(n=h.data,null===n)p=h.length|0;else{if(d(n)){var r=n.shape,p=n.stride,h=n.offset,e=0,P=0,C=0,u=0;1===r.length?(e=r[0],P=1,C=p[0],u=0):2===r.length?(e=r[0],P=r[1],C=p[0],u=p[1]):b.raise("invalid shape");l=l||f[Object.prototype.toString.call(n)]|0||5126;for(var r=P,p=a(l,e*P),n=n.data,
w=0,A=0;A<e;++A)for(var m=0;m<P;++m)p[w++]=n[C*A+u*m+h];n=p}else if(Array.isArray(n))if(0<n.length&&Array.isArray(n[0])){r=n[0].length;l=l||5126;h=a(l,n.length*r);p=n;n=r;for(e=u=0;e<p.length;++e)for(C=p[e],P=0;P<n;++P)h[u++]=C[P];n=h}else l=l||5126,n=a(l,n);else b.isTypedArray(n,"invalid data type buffer data"),l=l||f[Object.prototype.toString.call(n)]|0;p=n.byteLength}else"length"in h&&(p=h.length|0,b.nni(p,"buffer length must be a nonnegative integer"));D.data=n;D.dtype=l||5121;D.byteLength=p;
D.dimension=r;k(D);return v}var A=h.createBuffer(),D=new e(A,n);p[D.id]=D;w||v(l);v._reglType="buffer";v._buffer=D;v.destroy=function(){r(D)};return v},clear:function(){l(p).forEach(r)},refresh:function(){l(p).forEach(k)},getBuffer:function(a){return a&&a._buffer instanceof e?a._buffer:null}}}},{"./check":4,"./constants/arraytypes.json":8,"./constants/dtypes.json":9,"./is-ndarray":17,"./is-typed-array":18,"./values":31}],4:[function(e,k,m){function a(a){a=Error("(regl) "+a);console.error(a);throw a;
}var b=e("./is-typed-array");k.exports=Object.assign(function(b,d){b||a(d)},{raise:a,parameter:function(b,d,f){b in d||a("unknown parameter ("+b+")"+(f?": "+f:"")+". possible values: "+Object.keys(d).join())},type:function(b,d,f){typeof b!==d&&a("invalid parameter type"+(f?": "+f:"")+". expected "+d+", got "+typeof b)},isTypedArray:function(c,d){b(c)||a("invalid parameter type"+(d?": "+d:"")+". must be a typed array")},nni:function(b,d){0<=b&&(b|0)===b||a("invalid parameter type, ("+b+")"+(d?": "+
d:"")+". must be a nonnegative integer")},oneOf:function(b,d,f){0>d.indexOf(b)&&a("invalid value"+(f?": "+f:"")+". must be one of: "+d)}})},{"./is-typed-array":18}],5:[function(e,k,m){k.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],6:[function(e,k,m){k.exports=function(){function a(){var a=[],c=[];return Object.assign(function(){a.push.apply(a,Array.prototype.slice.call(arguments))},{def:function(){var d="v"+b++;c.push(d);
0<arguments.length&&(a.push(d,"="),a.push.apply(a,Array.prototype.slice.call(arguments)),a.push(";"));return d},toString:function(){return[0<c.length?"var "+c+";":"",a.join("")].join("")}})}var b=0,c=[],d=[],f={};return{link:function(a){var f="g"+b++;c.push(f);d.push(a);return f},block:a,proc:function(c){var d=[],q=a(),h=q.toString;return f[c]=Object.assign(q,{arg:function(){var a="a"+b++;d.push(a);return a},toString:function(){return["function(",d.join(),"){",h(),"}"].join("")}})},compile:function(){var a=
['"use strict";return {'];Object.keys(f).forEach(function(b){a.push('"',b,'":',f[b].toString(),",")});a.push("}");return Function.apply(null,c.concat([a.join("")])).apply(null,d)}}}},{}],7:[function(e,k,m){function a(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function b(a,b,c,d){var g,l=",";switch(b){case 5126:g="1f";break;case 35664:g="2fv";break;case 35665:g="3fv";break;case 35666:g=
"4fv";break;case 35670:case 5124:g="1i";break;case 35671:case 35667:g="2iv";break;case 35672:case 35668:g="3iv";break;case 35673:case 35669:g="4iv";break;case 35674:g="Matrix2fv";l=",false,";break;case 35675:g="Matrix3fv";l=",false,";break;case 35676:g="Matrix4fv";l=",false,";break;default:f.raise("unsupported uniform type")}return a+".uniform"+g+"("+c+l+d+");"}function c(a){return a+"["+a+".length-1]"}function d(a,b){return"framebuffer"===a||a<b?-1:a>b?1:0}var f=e("./check"),g=e("./codegen"),l=e("./constants/primitives.json"),
q=e("./constants/dtypes.json"),h={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},P={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,
">=":518,always:519},z={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};k.exports=function(r,n,p,e,k,w,v,A,D,m,y,N,U,Y){function K(q,p,e,C,w){function A(a){var b=pa[a];return b?b:b=pa[a]=I(G[a])}function y(a){var b=a.id,c=aa[b];if(c)return c;c=a.func?t.def(I(a.data),"(",V,",",R,",",ca,")"):t.def(V,".",a.data);return aa[b]=c}function E(a,b){return a.find(function(a){return a.name===b})}function W(a){return la&&!(a in p||a in
w)}var Z=g(),I=Z.link,t=Z.proc("batch"),S=Z.block(),X=t.def,da=t.arg,B=I(r),L=I(q.program),x=I(m.bind),ca=I(U),na=I(v),H=I(N.count),ka=I(N.offset),qa=I(N.instances),ba=I(N.primitive),pa={},ga=I(k.elements),H=X(c(H)),ka=X(c(ka)),ba=X(c(ba)),ga=X(c(ga)),F,O,K=n.angle_instanced_arrays;K&&(F=X(c(qa)),O=I(K));var la="elements"in p,qa=da(),da=da(),V=X(),R=X(),aa={};t(B,".useProgram(",L,");");q.uniforms.forEach(function(a){if(!(a.name in e)){var c=I(a.location),d=I(D.uniforms[a.name]),d=d+"["+d+".length-1]";
35678===a.info.type||35680===a.info.type?(a=X(d+"._texture"),t(b(B,5124,c,a+".bind()")),S(a,".unbind();")):t(b(B,a.info.type,c,d))}});q.attributes.forEach(function(b){if(!(C.name in C)){var c=I(m.attributes[b.name]);t(x,"(",b.location,",",I(m.bindings[b.location]),",",c,".records[",c,".top]",",",a(b.info.type),");")}});la||t("if(",ga,"){",B,".bindBuffer(",34963,",",ga,".buffer.buffer);","}else{",B,".bindBuffer(",34963,",null);","}");t("for(",R,"=0;",R,"<",qa,";++",R,"){",V,"=",da,"[",R,"];");Object.keys(p).sort(d).forEach(function(a){function b(a){t("if(",
c,"){",B,".enable(",a,");}else{",B,".disable(",a,");}")}var c=y(p[a]);switch(a){case "framebuffer":a=A("viewport");var d=A("scissor.box");t("if(",na,".push(",c,"&&",c,"._framebuffer)){",na,".poll();",a,".setDirty();",d,".setDirty();","}");break;case "cull.enable":b(2884);break;case "blend.enable":b(3042);break;case "dither":b(3024);break;case "stencil.enable":b(2960);break;case "depth.enable":b(2929);break;case "scissor.enable":b(3089);break;case "polygonOffset.enable":b(32823);break;case "sample.alpha":b(32926);
break;case "sample.enable":b(32928);break;case "depth.mask":t(B,".depthMask(",c,");");break;case "depth.func":a=I(P);t(B,".depthFunc(",a,"[",c,"]);");break;case "depth.range":t(B,".depthRange(",c,"[0],",c,"[1]);");break;case "blend.color":t(B,".blendColor(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "blend.equation":a=I(Q);t("if(typeof ",c,'==="string"){',B,".blendEquation(",a,"[",c,"]);","}else{",B,".blendEquationSeparate(",a,"[",c,".rgb],",a,"[",c,".alpha]);","}");break;case "blend.func":a=
I(h);t(B,".blendFuncSeparate(",a,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",a,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",a,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",a,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");break;case "stencil.mask":t(B,".stencilMask(",c,");");break;case "stencil.func":a=I(P);t(B,".stencilFunc(",a,"[",c,'.cmp||"always"],',c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":d=I(z);t(B,".stencilOpSeparate(","stencil.opFront"===
a?1028:1029,",",d,"[",c,'.fail||"keep"],',d,"[",c,'.zfail||"keep"],',d,"[",c,'.pass||"keep"]);');break;case "polygonOffset.offset":t(B,".polygonOffset(",c,".factor||0,",c,".units||0);");break;case "cull.face":t(B,".cullFace(",c,'==="front"?',1028,":",1029,");");break;case "lineWidth":t(B,".lineWidth(",c,");");break;case "frontFace":t(B,".frontFace(",c,'==="cw"?',2304,":",2305,");");break;case "colorMask":t(B,".colorMask(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");break;case "sample.coverage":t(B,".sampleCoverage(",
c,".value,",c,".invert);");break;case "scissor.box":case "viewport":a=A(a);t(a,".push(",c,".x||0,",c,".y||0,",c,".w||-1,",c,".h||-1);");break;case "primitives":case "offset":case "count":case "elements":break;default:f.raise("unsupported option for batch",a)}});("viewport"in p||"framebuffer"in p)&&t(A("viewport"),".poll();");("scissor.box"in p||"framebuffer"in p)&&t(A("scissor.box"),".poll();");"framebuffer"in p&&t(na,".pop();");var Y=q.uniforms,ma=[];Object.keys(e).forEach(function(a){var c=E(Y,
a);if(c){var d=c.info.type,f=I(c.location);a=y(e[a]);35678===c.info.type||35680===c.info.type?(c=X(a+"._texture"),ma.push(c),t(b(B,5124,f,c+".bind()"))):t(b(B,d,f,a))}});ma.forEach(function(a){t(a,".unbind();")});var ra=q.attributes;Object.keys(C).forEach(function(b){var c=E(ra,b);c&&t(x,"(",c.location,",",I(b.bindings[c.location]),",",y(C[b]),",",a(c.info.type),");")});p.count?t(H,"=",y(p.count),";"):W("count")||t("if(",H,"){");p.offset&&t(ka,"=",y(p.offset),";");p.primitive&&(q=I(l),t(ba,"=",q,
"[",y(p.primitive),"];"));la&&(q=y(p.elements),t(ga,"=",q,"?",q,"._elements:null;"));W("offset")&&t(ka,"=0;");t("if(",ga,"){");W("count")&&t(H,"=",ga,".vertCount;","if(",H,">0){");W("primitive")&&t(ba,"=",ga,".primType;");la&&t(B,".bindBuffer(",34963,",",ga,".buffer.buffer);");K&&(p.instances&&t(F,"=",y(p.instances),";"),t("if(",F,">0){",O,".drawElementsInstancedANGLE(",ba,",",H,",",ga,".type,",ka,",",F,");}else{"));t(B,".drawElements(",ba,",",H,",",ga,".type,",ka,");");K&&t("}");W("count")&&t("}");
t("}else{");W("count")||(W("primitive")&&t(ba,"=",4,";"),K&&t("if(",F,">0){",O,".drawArraysInstancedANGLE(",ba,",",ka,",",H,",",F,");}else{"),t(B,".drawArrays(",ba,",",ka,",",H,");}"),K&&t("}"));t("}}",S);return Z.compile().batch}var G=A.contextState,Q={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(Q.min=32775,Q.max=32776);var V=0;return{draw:function(d){var f=g(),l=f.link,h=f.proc("draw"),p=h.def,q=l(r),e=l(d.program),P=l(m.bind),C=l(N.count),w=l(N.offset),z=l(N.instances),
t=l(N.primitive),v=l(k.elements),X=[];h(q,".useProgram(",e,");");d.attributes.forEach(function(b){var c=l(m.attributes[b.name]);h(P,"(",b.location,",",l(m.bindings[b.location]),",",c,".records[",c,".top]",",",a(b.info.type),");")});d.uniforms.forEach(function(a){var c=l(a.location),d=l(D.uniforms[a.name]),d=d+"["+d+".length-1]";35678===a.info.type||35680===a.info.type?(a=p(d+"._texture"),X.push(a),h(b(q,5124,c,a+".bind()"))):h(b(q,a.info.type,c,d))});X.forEach(function(a){h(a,".unbind();")});d=p(c(t));
C=p(c(C));w=p(c(w));v=p(c(v));h("if(",C,"){");(e=n.angle_instanced_arrays)?(z=p(c(z)),e=l(e),h("if(",v,"){",v,".bind();","if(",z,">0){",e,".drawElementsInstancedANGLE(",d,",",C,",",v,".type,",w,",",z,");}else{",q,".drawElements(",d,",",C,",",v,".type,",w,");}","}else if(",z,">0){",e,".drawArraysInstancedANGLE(",d,",",w,",",C,",",z,");}else{",q,".drawArrays(",d,",",w,",",C,");}}")):h("if(",v,"){",q,".drawElements(",d,",",C,",",v,".type,",w,");}","}else{",q,".drawArrays(",d,",",w,",",C,");}");return f.compile().draw},
command:function(a,b,r,n,w,A,T){function E(a){var b=ga[a];return b?b:b=ga[a]=t(G[a])}function W(a,b){var c=E(a);F(c,".push(",b,");");O(c,".pop();")}function Z(a){var b=a.id,c=ra[b];if(c)return c;c=a.func?R.def(t(a.data),"(",ma,",0,",ua,")"):R.def(ma,".",a.data);return ra[b]=c}var I=g(),t=I.link,S=I.block,X=I.proc,da=V++,B=t(Y),L=t(y.fragShaders),x=t(y.vertShaders),ca=t(y.programs),na=t(v),H={count:t(N.count),offset:t(N.offset),instances:t(N.instances),primitive:t(N.primitive)},ka=t(k.elements),qa=
t(l),ba=t(P),pa=t(z),ga={},F=S(),O=S(),ta=!1;Object.keys(a).sort(d).forEach(function(b){var c=a[b];switch(b){case "frag":ta=!0;F(L,".push(",t(c),");");O(L,".pop();");break;case "vert":ta=!0;F(x,".push(",t(c),");");O(x,".pop();");break;case "framebuffer":b=v.getFramebuffer(c);f(null===c||b,"invalid framebuffer object");b=E("viewport");var d=E("scissor.box");F("if(",na,".push(",t(c&&c._framebuffer),")){",b,".setDirty();",d,".setDirty();","}");O("if(",na,".pop()){",b,".setDirty();",d,".setDirty();",
"}");break;case "count":case "offset":case "instances":f.nni(c,b);F(H[b],".push(",c,");");O(H[b],".pop();");break;case "primitive":f.parameter(c,l,"not a valid drawing primitive");F(H.primitive,".push(",l[c],");");O(H.primitive,".pop();");break;case "elements":d=k.getElements(c);c=!("primitive"in a);b=!("count"in a);d?(d=t(d),F(ka,".push(",d,");"),c&&F(H.primitive,".push(",d,".primType);"),b&&F(H.count,".push(",d,".vertCount);")):(F(ka,".push(null);"),c&&F(H.primitive,".push(",4,");"),b&&F(H.count,
".push(0);"));c&&O(H.primitive,".pop();");b&&O(H.count,".pop();");"offset"in a||(F(H.offset,".push(0);"),O(H.offset,".pop();"));O(ka,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":f.type(c,"boolean",b);W(b,c);break;case "depth.func":f.parameter(c,P,b);W(b,P[c]);break;case "depth.range":f(Array.isArray(c)&&2===c.length&&c[0]<=
c[1],"depth range is 2d array");b=E(b);F(b,".push(",c[0],",",c[1],");");O(b,".pop();");break;case "blend.func":b=E(b);f.type(c,"object","blend func must be an object");var d="srcRGB"in c?c.srcRGB:c.src,g="srcAlpha"in c?c.srcAlpha:c.src,B="dstRGB"in c?c.dstRGB:c.dst,c="dstAlpha"in c?c.dstAlpha:c.dst;f.parameter(d,h);f.parameter(g,h);f.parameter(B,h);f.parameter(c,h);F(b,".push(",h[d],",",h[B],",",h[g],",",h[c],");");O(b,".pop();");break;case "blend.equation":b=E(b);"string"===typeof c?(f.parameter(c,
Q,"invalid blend equation"),F(b,".push(",Q[c],",",Q[c],");")):"object"===typeof c?(f.parameter(c.rgb,Q,"invalid blend equation rgb"),f.parameter(c.alpha,Q,"invalid blend equation alpha"),F(b,".push(",Q[c.rgb],",",Q[c.alpha],");")):f.raise("invalid blend equation");O(b,".pop();");break;case "blend.color":f(Array.isArray(c)&&4===c.length,"blend color is a 4d array");b=E(b);F(b,".push(",c[0],",",c[1],",",c[2],",",c[3],");");O(b,".pop();");break;case "stencil.mask":f.type(c,"number","stencil mask must be an integer");
b=E(b);F(b,".push(",c,");");O(b,".pop();");break;case "stencil.func":f.type(c,"object","stencil func must be an object");d=c.cmp||"keep";g=c.ref||0;c="mask"in c?c.mask:-1;f.parameter(d,P,"invalid stencil func cmp");f.type(g,"number","stencil func ref");f.type(c,"number","stencil func mask");b=E(b);F(b,".push(",P[d],",",g,",",c,");");O(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":f.type(c,"object",b);d=c.fail||"keep";g=c.zfail||"keep";c=c.pass||"keep";f.parameter(d,z,b);f.parameter(g,
z,b);f.parameter(c,z,b);b=E(b);F(b,".push(",z[d],",",z[g],",",z[c],");");O(b,".pop();");break;case "polygonOffset.offset":f.type(c,"object",b);d=c.factor||0;c=c.units||0;f.type(d,"number","offset.factor");f.type(c,"number","offset.units");b=E(b);F(b,".push(",d,",",c,");");O(b,".pop();");break;case "cull.face":d=0;"front"===c?d=1028:"back"===c&&(d=1029);f(!!d,"cull.face");c=E(b);F(c,".push(",d,");");O(c,".pop();");break;case "lineWidth":d=p.lineWidthDims;f("number"===typeof c&&c>=d[0]&&c<=d[1],"invalid line width, must positive number between "+
d[0]+" and "+d[1]);W(b,c);break;case "frontFace":d=0;"cw"===c?d=2304:"ccw"===c&&(d=2305);f(!!d,"frontFace");c=E(b);F(c,".push(",d,");");O(c,".pop();");break;case "colorMask":f(Array.isArray(c)&&4===c.length,"color mask must be length 4 array");b=E(b);F(b,".push(",c.map(function(a){return!!a}).join(),");");O(b,".pop();");break;case "sample.coverage":f.type(c,"object",b);d="value"in c?c.value:1;c=!!c.invert;f("number"===typeof d&&0<=d&&1>=d,"sample value");b=E(b);F(b,".push(",d,",",c,");");O(b,".pop();");
break;case "viewport":case "scissor.box":f("object"===typeof c&&c,b+" is an object");var d=c.x||0,g=c.y||0,q=B=-1;f("number"===typeof d&&0<=d,b+".x must be a positive int");f("number"===typeof g&&0<=g,b+".y must be a positive int");"w"in c&&(B=c.w,f("number"===typeof B&&0<=B,b+".w must be a positive int"));"h"in c&&(q=c.h,f("number"===typeof q&&0<=q,b+".h must be a positive int"));c=E(b);F(c,".push(",d,",",g,",",B,",",q,");");O(c,".pop();");break;default:f.raise("unsupported parameter "+b)}});if(ta){if(a.frag&&
a.vert)F(ca,".push(",t(y.create(a.vert,a.frag)),");");else{var S=F.def(L,"[",L,".length-1]"),la=F.def(x,"[",x,".length-1]"),sa=t(y.create);F(ca,".push(",sa,"(",la,",",S,"));")}O(ca,".pop();")}Object.keys(b).forEach(function(a){D.def(a);var c=t(D.uniforms[a]);a=b[a];a="function"===typeof a&&a._reglType?t(a):Array.isArray(a)?t(a.slice()):+a;F(c,".push(",a,");");O(c,".pop();")});Object.keys(r).forEach(function(a){m.def(a);var b=t(m.attributes[a]),c=r[a];if("number"===typeof c)F(b,".pushVec(",+c,",0,0,0);");
else if(f(!!c,"invalid attribute: "+a),Array.isArray(c))F(b,".pushVec(",[c[0]||0,c[1]||0,c[2]||0,c[3]||0],");");else{var d=e.getBuffer(c),g=0,B=0,l=0,h=0,p=!1,x=5126;d?x=d.dtype:(f.type(c,"object",'invalid attribute "'+a+'"'),d=e.getBuffer(c.buffer),g=c.size||0,B=c.stride||0,l=c.offset||0,h=c.divisor||0,p=c.normalized||!1,f(!!d,"invalid attribute "+a+".buffer"),x=d.dtype,"type"in c&&(f.parameter(c.type,q,"attribute type"),x=q[c.type]));f(!!d,"invalid attribute "+a+".buffer");f.nni(B,a+".stride");
f.nni(l,a+".offset");f.nni(h,a+".divisor");f.type(p,"boolean",a+".normalized");f.oneOf(g,[0,1,2,3,4],a+".size");F(b,".pushPtr(",[t(d),g,l,B,h,p,x].join(),");")}O(b,".pop();")});var R=I.block(),aa=I.block(),ua,ma;T&&(ua=t(U),ma=F.def());var ra={};Object.keys(n).sort(d).forEach(function(b){var c=Z(n[b]);switch(b){case "framebuffer":b=E("viewport");var d=E("scissor.box");R("if(",na,".push(",c,"&&",c,"._framebuffer)){",b,".setDirty();",d,".setDirty();","}");aa("if(",na,".pop()){",b,".setDirty();",d,".setDirty();",
"}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":b=E(b);R(b,".push(",c,");");aa(b,".pop();");break;case "count":case "offset":case "instances":b=H[b];R(b,".push(",c,");");aa(b,".pop();");break;case "primitive":b=H.primitive;R(b,".push(",qa,"[",c,"]);");aa(b,".pop();");break;case "depth.func":b=E(b);R(b,".push(",ba,"[",
c,"]);");aa(b,".pop();");break;case "blend.func":b=E(b);d=t(h);R(b,".push(",d,'["srcRGB" in ',c,"?",c,".srcRGB:",c,".src],",d,'["dstRGB" in ',c,"?",c,".dstRGB:",c,".dst],",d,'["srcAlpha" in ',c,"?",c,".srcAlpha:",c,".src],",d,'["dstAlpha" in ',c,"?",c,".dstAlpha:",c,".dst]);");aa(b,".pop();");break;case "blend.equation":b=E(b);d=t(Q);R("if(typeof ",c,'==="string"){',b,".push(",d,"[",c,"],",d,"[",c,"]);","}else{",b,".push(",d,"[",c,".rgb],",d,"[",c,".alpha]);","}");aa(b,".pop();");break;case "blend.color":b=
E(b);R(b,".push(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");aa(b,".pop();");break;case "stencil.mask":b=E(b);R(b,".push(",c,");");aa(b,".pop();");break;case "stencil.func":b=E(b);R(b,".push(",ba,"[",c,".cmp],",c,".ref|0,",'"mask" in ',c,"?",c,".mask:-1);");aa(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":b=E(b);R(b,".push(",pa,"[",c,'.fail||"keep"],',pa,"[",c,'.zfail||"keep"],',pa,"[",c,'.pass||"keep"]);');aa(b,".pop();");break;case "polygonOffset.offset":b=E(b);R(b,".push(",c,".factor||0,",
c,".units||0);");aa(b,".pop();");break;case "cull.face":b=E(b);R(b,".push(",c,'==="front"?',1028,":",1029,");");aa(b,".pop();");break;case "frontFace":b=E(b);R(b,".push(",c,'==="cw"?',2304,":",2305,");");aa(b,".pop();");break;case "colorMask":b=E(b);R(b,".push(",c,"[0],",c,"[1],",c,"[2],",c,"[3]);");aa(b,".pop();");break;case "sample.coverage":b=E(b);R(b,".push(",c,".value,",c,".invert);");aa(b,".pop();");break;case "scissor.box":case "viewport":b=E(b);R(b,".push(",c,".x||0,",c,".y||0,",'"w" in ',
c,"?",c,".w:-1,",'"h" in ',c,"?",c,".h:-1);");aa(b,".pop();");break;case "elements":b=!("primitive"in n)&&!("primitive"in a);var d=!("count"in n)&&!("count"in a),g=!("offset"in n)&&!("offset"in a),B=R.def();R("if(",c,"){",B,"=",c,"._elements;",ka,".push(",B,");",b?H.primitive+".push("+B+".primType);":"",d?H.count+".push("+B+".vertCount);":"",g?H.offset+".push("+B+".offset);":"","}else{",ka,".push(null);","}");aa(ka,".pop();","if(",c,"){",b?H.primitive+".pop();":"",d?H.count+".pop();":"",g?H.offset+
".pop();":"","}");break;default:f.raise("unsupported dynamic option: "+b)}});Object.keys(w).forEach(function(a){D.def(a);var b=t(D.uniforms[a]);a=Z(w[a]);R(b,".push(",a,");");aa(b,".pop();")});Object.keys(A).forEach(function(a){m.def(a);var b=t(m.attributes[a]);a=Z(A[a]);R(b,".pushDyn(",a,");");aa(b,".pop();")});S=X("scope");la=S.arg();sa=S.arg();S(F);T&&S(ma,"=",la,";",R);S(sa,"();",T?aa:"",O);S=X("draw");S(F);T&&S(ma,"=",S.arg(),";",R);la=c(ca);S(B,"();","if(",la,")",la,".draw(",T?ma:"",");",T?
aa:"",O);var oa=X("batch");oa(F);T=oa.def(c(ca));X=t(function(b,c,d){var f=b.batchCache[da];f||(f=b.batchCache[da]=K(b,n,w,A,a));return f(c,d)});oa("if(",T,"){",B,"();",X,"(",T,",",oa.arg(),",",oa.arg(),");");Object.keys(n).forEach(function(a){(a=ga[a])&&oa(a,".setDirty();")});oa("}",O);return I.compile()}}}},{"./check":4,"./codegen":6,"./constants/dtypes.json":9,"./constants/primitives.json":10}],8:[function(e,k,m){k.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,
"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],9:[function(e,k,m){k.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],10:[function(e,k,m){k.exports={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],11:[function(e,k,m){function a(a,c){function g(){var b=
window.innerWidth,c=window.innerHeight;a!==document.body&&(c=a.getBoundingClientRect(),b=c.right-c.left,c=c.top-c.bottom);l.width=h*b;l.height=h*c;Object.assign(l.style,{width:b+"px",height:c+"px"})}var l=document.createElement("canvas"),q=b(l,c);Object.assign(l.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(l);a===document.body&&(l.style.position="absolute",Object.assign(a.style,{margin:0,padding:0}));var h=+q.options.pixelRatio;window.addEventListener("resize",g,!1);var e=q.options.onDestroy;
q.options=Object.assign({},q.options,{onDestroy:function(){window.removeEventListener("resize",g);a.removeChild(l);e&&e()}});g();return q}function b(a,b){function g(b){try{return a.getContext(b,l)}catch(c){return null}}var l=b.glOptions||{},q=g("webgl")||g("experimental-webgl")||g("webgl-experimental");c(q,"webgl not supported");return{gl:q,options:Object.assign({pixelRatio:window.devicePixelRatio},b)}}var c=e("./check");k.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],
options:c[1]||{}};var f=document.body,g=c[1]||{};if("string"===typeof c[0])f=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)f=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],options:Object.assign({pixelRatio:1},g)};g=c[0]}return f.nodeName&&"CANVAS"===f.nodeName.toUpperCase()?b(f,g):a(f,g)}},{"./check":4}],12:[function(e,k,m){k.exports=function(a){return{primitive:[4],count:[0],offset:[0],instances:[0]}}},{}],13:[function(e,
k,m){function a(a,b){this.id=c++;this.func=a;this.data=b}function b(c,f){switch(typeof c){case "boolean":case "number":case "string":return new a(!1,c);case "function":return new a(!0,c);default:return b}}var c=0;k.exports={define:b,isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof a},unbox:function(c,f){return c instanceof a?c:"function"===typeof c&&c!==b?new a(!0,c):new a(!1,f)}}},{}],14:[function(e,k,m){var a=e("./check"),b=e("./is-typed-array"),c=e("./is-ndarray"),
d=e("./constants/primitives.json");k.exports=function(f,g,l){function q(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}q.prototype.bind=function(){this.buffer.bind()};return{create:function(f){function e(f){var l=g.oes_element_index_uint;if(f)if("number"===typeof f)r(f);else{var h=null,q="static",w=0;Array.isArray(f)||b(f)||c(f)?h=f:(a.type(f,"object","invalid arguments for elements"),"data"in f&&(h=f.data),"usage"in f&&(q=f.usage),"length"in f&&(w=f.length));Array.isArray(h)||c(h)&&
"array"===h.dtype||"type"in f?r({type:f.type||(l?"uint32":"uint16"),usage:q,data:h,length:w}):r({usage:q,data:h,length:w});if(Array.isArray(h)||b(h))r.dimension=3}else r();h=k.buffer.byteLength;q=0;switch(k.buffer.dtype){case 5121:case 5120:q=5121;break;case 5123:case 5122:q=5123;h>>=1;break;case 5125:case 5124:a(l,"32 bit element buffers not supported");q=5125;h>>=2;break;default:a.raise("invalid element buffer type")}l=4;w=k.buffer.dimension;1===w&&(l=0);2===w&&(l=1);3===w&&(l=4);"object"===typeof f&&
("primitive"in f&&(l=f.primitive,a.parameter(l,d),l=d[l]),"count"in f&&(h=f.vertCount|0));k.primType=l;k.vertCount=h;k.type=q;return e}var k=new q,r=l.create(null,34963,!0);k.buffer=r._buffer;e(f);Object.assign(e,{_reglType:"elements",_elements:k,destroy:function(){a(null!==k.buffer,"must not double destroy elements");r.destroy();k.buffer=null}});return e},elements:[null],getElements:function(a){return a&&a._elements instanceof q?a._elements:null}}}},{"./check":4,"./constants/primitives.json":10,
"./is-ndarray":17,"./is-typed-array":18}],15:[function(e,k,m){k.exports=function(a){function b(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(b){try{c[b]=
a.getExtension(b)}catch(f){}})}var c={};b();return{extensions:c,refresh:b}}},{}],16:[function(e,k,m){var a=e("./check"),b=e("./values"),c=[1029];k.exports=function(d,f,g,l,q){function h(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function e(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function k(b,c,d){if(b.texture)a.oneOf(b.texture._texture.params.internalformat,c,"unsupported texture format for attachment");else a.oneOf(b.renderbuffer._renderbuffer.format,
d,"unsupported renderbuffer format for attachment")}function r(b,c){var d=c.width,f=c.height;if(b.texture){var g=b.texture._texture,l=Math.max(1,g.params.width>>b.level),h=Math.max(1,g.params.height>>b.level),d=d||l,f=f||h;a(l===d&&h===f,"inconsistent width/height for supplied texture");a(0>g.pollId,"polling fbo textures not supported")}else g=b.renderbuffer._renderbuffer,d=d||g.width,f=f||g.height,a(g.width===d&&g.height===f,"inconsistent width/height for renderbuffer"),a(0<=M.indexOf(g.format),
"renderbuffer format not compatible with color channels");g.refCount+=1;c.width=d;c.height=f}function n(a,b){b?b.texture?d.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):d.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,a,3553,null,0)}function p(b){var c=3553,d=0,f=null,g=null,l=b;"object"===typeof b&&(l=b.data,"level"in b&&(d=b.level|0),"target"in b&&(c=b.target|0));a.type(l,"function","invalid attachment data");
l=b._reglType;"texture"===l?(f=b,34067===f._texture.target?a(34069<=c&&34075>c,"invalid cube map target"):a(3553===c)):"renderbuffer"===l?(g=b,c=36161,d=0):a.raise("invalid regl object for attachment");return new h(c,d,f,g)}function C(a){return a&&(a.texture||a.renderbuffer)}function u(){this.id=ja++;ea[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=
!1}function w(b){d.isFramebuffer(b.framebuffer)||(b.framebuffer=d.createFramebuffer());E=!0;d.bindFramebuffer(36160,b.framebuffer);for(var c=b.colorAttachments,l=0;l<c.length;++l)n(36064+l,c[l]);for(l=c.length;l<g.maxColorAttachments;++l)n(36064+l,null);n(36096,b.depthAttachment);n(36128,b.stencilAttachment);n(33306,b.depthStencilAttachment);f.webgl_draw_buffers&&f.webgl_draw_buffers.drawBuffersWEBGL(ia[c.length]);b=d.checkFramebufferStatus(36160);36053!==b&&a.raise("framebuffer configuration not supported, status = "+
m[b])}function v(b){b=b.framebuffer;a(b,"must not double destroy framebuffer");d.isFramebuffer(b)&&d.deleteFramebuffer(b)}function A(){return T[T.length-1]}var m={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"},J={rgba:6408},y={rgba4:32854,rgb565:36194,"rgb5 a1":32855};f.ext_srgb&&(y.srgba=35907);f.ext_color_buffer_half_float&&(y.rgba16f=34842,y.rgb16f=34843);f.webgl_color_buffer_float&&(y.rgba32f=34836);var N=
[33189],U=[36168],Y=[34041],K=[],G=[],Q=[];f.webgl_depth_texture&&(K.push(6402),Q.push(34041));var V=Object.assign({},J,y),ha=b(J),M=b(y),y=5121,fa={uint8:5121};f.oes_texture_half_float&&(y=fa["half float"]=36193);f.oes_texture_float&&(y=fa["float"]=5126);fa.best=y;var ia=function(){for(var a=Array(g.maxDrawbuffers),b=0;b<=g.maxDrawbuffers;++b)for(var c=a[b]=Array(b),d=0;d<b;++d)c[d]=36064+d;return a}(),ja=0,ea={},T=[null],E=!0;return{top:A,dirty:function(){return E},push:function(a){a=a||null;E=
E||a!==A();T.push(a);return E},pop:function(){var a=A();T.pop();return E=E||a!==A()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof u)?a:null},poll:function(){if(E){var a=T[T.length-1],b=f.webgl_draw_buffers;a?(d.bindFramebuffer(36160,a.framebuffer),b&&b.drawBuffersWEBGL(ia[a.colorAttachments.length])):(d.bindFramebuffer(36160,null),b&&b.drawBuffersWEBGL(c));E=!1}},create:function(b){function c(b){var n,u=b||{};n=f.webgl_draw_buffers;
var v=0,B=0;"shape"in u?(b=u.shape,a(Array.isArray(b)&&2<=b.length,"invalid shape for framebuffer"),v=b[0],B=b[1]):("radius"in u&&(v=B=u.radius),"width"in u&&(v=u.width),"height"in u&&(B=u.height));var L=null;b=!1;if("colorBuffers"in u||"colorBuffer"in u){L=u.colorBuffers||u.colorBuffer;Array.isArray(L)||(L=[L]);g.width=v;g.height=B;1<L.length&&a(n,"multiple render targets not supported");a(0<=L.length,"must specify at least one color attachment");L=L.map(p);for(n=0;n<L.length;++n)v=L[n],k(v,ha,M),
r(v,g);v=g.width;B=g.height}else{var x=!0,ca="rgba",A="uint8",H=1;b=!0;g.width=v||d.drawingBufferWidth;g.height=B||d.drawingBufferHeight;"format"in u&&(ca=u.format,a.parameter(ca,V,"invalid color format"),x=ca in J);"type"in u&&(a(x,"colorType can not be set for renderbuffer targets"),A=u.type,a.parameter(A,fa,"invalid color type"));"colorCount"in u&&(H=u.colorCount|0,a(0<=H,"color count must be positive"));if(g.ownsColor)for(L=g.colorAttachments;L.length>H;)e(L.pop());else L=[];for(n=0;n<L.length;++n){var m;
a:{m=L[n];var y=x,ba=ca,D=v,ga=B;if(m.texture){var F=m.texture;if(y){F({format:ba,type:A,width:D,height:ga});F._texture.refCount+=1;m=!0;break a}}else if(F=m.renderbuffer,!y){F({format:ba,width:D,height:ga});F._renderbuffer.refCount+=1;m=!0;break a}e(m);m=!1}m||(L[n--]=L[L.length-1],L.pop())}for(;L.length<H;)x?L.push(new h(3553,0,l.create({format:ca,type:A,width:v,height:B},3553),null)):L.push(new h(36161,0,null,q.create({format:ca,width:v,height:B})))}a(0<L.length,"must specify at least one color buffer");
g.width=v;g.height=B;ca=x=n=null;A=!1;H=0;"depthBuffer"in u&&(n=p(u.depthBuffer),k(n,K,N),H+=1);"stencilBuffer"in u&&(x=p(u.stencilBuffer),k(x,G,U),H+=1);"depthStencilBuffer"in u&&(ca=p(u.depthStencilBuffer),k(ca,Q,Y),H+=1);if(n||x||ca)a(1===H,"can specify only one of depth, stencil or depthStencil attachment"),r(n||x||ca,g);else if(H=!0,y=m=!1,"depth"in u&&(H=!!u.depth),"stencil"in u&&(m=!!u.stencil),"depthTexture"in u&&(y=!!u.depthTexture),u=g.depthAttachment||g.stencilAttachment||g.depthStencilAttachment,
ba=null,H||m)A=!0,y?(a(f.webgl_depth_texture,"depth texture extension not supported"),a(H,"stencil only textures not supported"),y=m?"depth stencil":"depth",g.ownsDepthStencil&&u.texture?(u.texture({format:y,width:v,height:B}),u.texture._texture.refCount+=1,ba=u):ba=new h(3553,0,l.create({format:y,width:v,height:B},3553),null)):(y=H?m?"depth stencil":"depth":"stencil",g.ownsDepthStencil&&u.renderbuffer?(u.renderbuffer({format:y,width:v,height:B}),u.renderbuffer._renderbuffer.refCount+=1,ba=u):ba=
new h(36161,0,null,q.create({format:y,width:v,height:B}))),H?m?ca=ba:n=ba:x=ba;v=g;v.colorAttachments.forEach(e);e(v.depthAttachment);e(v.stencilAttachment);e(v.depthStencilAttachment);g.colorAttachments=L;g.depthAttachment=n;g.stencilAttachment=x;g.depthStencilAttachment=ca;g.ownsColor=b;g.ownsDepthStencil=A;c.color=L.map(C);c.depth=C(n);c.stencil=C(x);c.depthStencil=C(ca);w(g);c.width=g.width;c.height=g.height;return c}var g=new u;c(b);Object.assign(c,{_reglType:"framebuffer",_framebuffer:g,destroy:function(){v(g)}});
return c},clear:function(){b(ea).forEach(v)},refresh:function(){b(ea).forEach(w)}}}},{"./check":4,"./values":31}],17:[function(e,k,m){var a=e("./is-typed-array");k.exports=function(b){return"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":18}],18:[function(e,k,m){var a=e("./constants/arraytypes.json");k.exports=function(b){return Object.prototype.toString.call(b)in
a}},{"./constants/arraytypes.json":8}],19:[function(e,k,m){k.exports=function(a,b){var c=1;b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,f=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),f=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:c,
maxDrawbuffers:d,maxColorAttachments:f,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},{}],20:[function(e,k,m){k.exports=function(a,b){if("undefined"!==typeof document){var c;c=(c=/\.(\w+)(\?.*)?$/.exec(a))&&c[1]?c[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(c))return c=document.createElement("video"),c.autoplay=!0,c.loop=!0,b&&(c.crossOrigin=b),c.src=
a,c;if(0<=["dds"].indexOf(c))return c=new XMLHttpRequest,c.responseType="arraybuffer",c.open("GET",a,!0),c.send(),c;c=new Image;b&&(c.crossOrigin=b);c.src=a;return c}return null}},{}],21:[function(e,k,m){var a=e("./check");k.exports=function(e){function k(a){for(var b=fa,c=ia,d=0;d<W;++d){var f=Math.max(1,b+3>>2)*Math.max(1,c+3>>2)*T;I.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(e,Z,f)});Z+=f;b>>=1;c>>=1}}var m=new Int32Array(e);a(m[0]===b,"invalid magic number for dds header");
var M=m[J];a(M&p,"unsupported dds format");var fa=m[N],ia=m[y],ja=P,ea=0,T=0,E=4;switch(m[K]){case u:T=8;M&C?(E=3,ea=f):ea=g;break;case w:T=16;ea=l;break;case v:T=16;ea=q;break;case A:T=8;ea=h;break;default:a.raise("unsupported dds texture format")}var W=1;m[Y]&z&&(W=Math.max(1,m[U]));var Z=m[D]+4,I={width:fa,height:ia,channels:E,format:ea,type:ja,compressed:!0,cube:!1,pixels:[]},m=m[G];if(m&r)for(a((m&n)===n,"missing cubemap faces"),I.cube=!0,m=0;6>m;++m)k(d+m);else k(c);return I};var b=542327876,
c=3553,d=34069,f=33776,g=33777,l=33778,q=33779,h=36196,P=5121,z=131072,r=512,n=64512,p=4,C=64,u=827611204,w=861165636,v=894720068,A=826496069,D=1,J=2,y=3,N=4,U=7,Y=20,K=21,G=28},{"./check":4}],22:[function(e,k,m){k.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,30)},cancel:clearTimeout}},{}],23:[function(e,k,m){var a=e("./check"),
b=e("./is-typed-array");k.exports=function(c,d,f){return function(g){var l=g||{};b(g)?l={data:l}:2===arguments.length?l={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof g&&(l={});d();var q=l.x||0,h=l.y||0,e=l.width||f.width,k=l.height||f.height,r=e*k*4,l=l.data||new Uint8Array(r);a.isTypedArray(l);a(l.byteLength>=r,"data buffer too small");c.pixelStorei(3333,4);c.readPixels(q,h,e,k,6408,5121,l);return l}}},{"./check":4,"./is-typed-array":18}],24:[function(e,k,m){var a=e("./check"),b=
e("./values");k.exports=function(c,d,f){function g(){this.id=e++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function l(a){c.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=c.createRenderbuffer());c.bindRenderbuffer(36161,a.renderbuffer);c.renderbufferStorage(36161,a.format,a.width,a.height)}function q(b){var d=b.renderbuffer;a(d,"must not double destroy renderbuffer");c.bindRenderbuffer(36161,null);c.isRenderbuffer(d)&&c.deleteRenderbuffer(d);b.renderbuffer=
null;b.refCount=0;delete k[b.id]}var h={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};d.ext_srgb&&(h.srgba=35907);d.ext_color_buffer_half_float&&(h.rgba16f=34842,h.rgb16f=34843);d.webgl_color_buffer_float&&(h.rgba32f=34836);var e=0,k={};g.prototype.decRef=function(){0===--this.refCount&&q(this)};return{create:function(b){function c(b){b=b||{};var g=0,q=0;"shape"in b?(q=b.shape,a(Array.isArray(q)&&2<=q.length,"invalid renderbuffer shape"),g=q[0]|0,q=q[1]|
0):("radius"in b&&(g=q=b.radius|0),"width"in b&&(g=b.width|0),"height"in b&&(q=b.height|0));var e=f.maxRenderbufferSize;a(0<=g&&0<=q&&g<=e&&q<=e,"invalid renderbuffer size");c.width=d.width=Math.max(g,1);c.height=d.height=Math.max(q,1);d.format=32854;"format"in b&&(b=b.format,a.parameter(b,h,"invalid render buffer format"),d.format=h[b]);l(d);return c}var d=new g;k[d.id]=d;c(b);Object.assign(c,{_reglType:"renderbuffer",_renderbuffer:d,destroy:function(){d.decRef()}});return c},refresh:function(){b(k).forEach(l)},
clear:function(){b(k).forEach(q)}}}},{"./check":4,"./values":31}],25:[function(e,k,m){function a(a,b,f){this.name=a;this.location=b;this.info=f}var b=e("./check");k.exports=function(c,d,f,g){function l(a,d){var f=n[a],g=f[d];if(!g){g=c.createShader(a);c.shaderSource(g,d);c.compileShader(g);if(!c.getShaderParameter(g,c.COMPILE_STATUS)){var l=c.getShaderInfoLog(g);b.raise("Error compiling shader:\n"+l)}f[d]=g}return g}function q(){Object.keys(n).forEach(function(a){Object.keys(n[a]).forEach(function(b){c.deleteShader(n[a][b])})});
n[35632]={};n[35633]={}}function h(a,b){this.fragSrc=a;this.vertSrc=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function e(){m.forEach(function(a){a.destroy()});m.length=0;p={}}function k(){m.forEach(function(a){a.link()})}function r(){q();e()}var n={},p={},m=[];Object.assign(h.prototype,{link:function(){var h,q;h=l(c.FRAGMENT_SHADER,this.fragSrc);q=l(c.VERTEX_SHADER,this.vertSrc);var e=this.program=c.createProgram();c.attachShader(e,h);c.attachShader(e,
q);c.linkProgram(e);c.getProgramParameter(e,c.LINK_STATUS)||(h=c.getProgramInfoLog(e),b.raise("Error linking program:\n"+h));var p=c.getProgramParameter(e,c.ACTIVE_UNIFORMS),n=this.uniforms=[];for(h=0;h<p;++h)if(q=c.getActiveUniform(e,h))if(1<q.size)for(var r=0;r<q.size;++r){var k=q.name.replace("[0]","["+r+"]");n.push(new a(k,c.getUniformLocation(e,k),q));f.def(k)}else n.push(new a(q.name,c.getUniformLocation(e,q.name),q)),f.def(q.name);p=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES);n=this.attributes=
[];for(h=0;h<p;++h)if(q=c.getActiveAttrib(e,h))n.push(new a(q.name,c.getAttribLocation(e,q.name),q)),d.def(q.name);this.draw=g(this);this.batchCache={}},destroy:function(){c.deleteProgram(this.program)}});r();return{create:function(a,b){var c=p[b];c||(c=p[b]={});var d=c[a];d||(d=new h(b,a),d.link(),c[a]=d,m.push(d));return d},clear:r,refresh:function(){n[35632]={};n[35633]={};k()},programs:[null],fragShaders:["void main(){gl_FragColor=vec4(0,0,0,0);}"],vertShaders:["void main(){gl_Position=vec4(0,0,0,0);}"]}}},
{"./check":4}],26:[function(e,k,m){k.exports=function(a,b){var c=a.length,d=a.slice(),f=a.slice(),g=!1,l=!0;return{push:function(){g=!1;for(var a=0;a<c;++a){var b=arguments[a];g=g||b!==f[a];d.push(b)}},pop:function(){g=!1;d.length-=c;for(var a=0;a<c;++a)g=g||d[d.length-c+a]!==f[a]},poll:function(){var a=d.length-c;if(g||l){switch(c){case 1:b(d[a]);break;case 2:b(d[a],d[a+1]);break;case 3:b(d[a],d[a+1],d[a+2]);break;case 4:b(d[a],d[a+1],d[a+2],d[a+3]);break;case 5:b(d[a],d[a+1],d[a+2],d[a+3],d[a+4]);
break;case 6:b(d[a],d[a+1],d[a+2],d[a+3],d[a+4],d[a+5]);break;default:b.apply(null,d.slice(a,d.length))}for(var h=0;h<c;++h)f[h]=d[a+h];l=g=!1}},setDirty:function(){l=!0}}}},{}],27:[function(e,k,m){var a=e("./stack"),b=e("./codegen");k.exports=function(c,d,f){function g(b,d){var g=a([!!d],function(a){a?c.enable(b):c.disable(b)});g.flag=b;return g}var l={dither:g(3024),"blend.enable":g(3042),"blend.color":a([0,0,0,0],function(a,b,d,g){c.blendColor(a,b,d,g)}),"blend.equation":a([32774,32774],function(a,
b){c.blendEquationSeparate(a,b)}),"blend.func":a([1,0,1,0],function(a,b,d,g){c.blendFuncSeparate(a,b,d,g)}),"depth.enable":g(2929,!0),"depth.func":a([513],function(a){c.depthFunc(a)}),"depth.range":a([0,1],function(a,b){c.depthRange(a,b)}),"depth.mask":a([!0],function(a){c.depthMask(a)}),"cull.enable":g(2884),"cull.face":a([1029],function(a){c.cullFace(a)}),frontFace:a([2305],function(a){c.frontFace(a)}),colorMask:a([!0,!0,!0,!0],function(a,b,d,g){c.colorMask(a,b,d,g)}),lineWidth:a([1],function(a){c.lineWidth(a)}),
"polygonOffset.enable":g(32823),"polygonOffset.offset":a([0,0],function(a,b){c.polygonOffset(a,b)}),"sample.alpha":g(32926),"sample.enable":g(32928),"sample.coverage":a([1,!1],function(a,b){c.sampleCoverage(a,b)}),"stencil.enable":g(2960),"stencil.mask":a([-1],function(a){c.stencilMask(a)}),"stencil.func":a([519,0,-1],function(a,b,d){c.stencilFunc(a,b,d)}),"stencil.opFront":a([7680,7680,7680],function(a,b,d){c.stencilOpSeparate(1028,a,b,d)}),"stencil.opBack":a([7680,7680,7680],function(a,b,d){c.stencilOpSeparate(1029,
a,b,d)}),"scissor.enable":g(3089),"scissor.box":a([0,0,-1,-1],function(a,b,g,f){var l=g,h=d.top();0>g&&(l=h?h.width-a:c.drawingBufferWidth-a);g=f;0>f&&(g=h?h.height-b:c.drawingBufferHeight-b);c.scissor(a,b,l,g)}),viewport:a([0,0,-1,-1],function(a,b,g,l){var h=g,e=d.top();0>g&&(h=e?e.width-a:c.drawingBufferWidth-a);g=l;0>l&&(g=e?e.height-b:c.drawingBufferHeight-b);c.viewport(a,b,h,g);f.width=h;f.height=g})},e=b(),h=e.proc("poll"),k=e.proc("refresh");Object.keys(l).forEach(function(a){a=e.link(l[a]);
h(a,".poll();");k(a,".setDirty();")});var m=e.compile();return{contextState:l,viewport:f,poll:m.poll,refresh:m.refresh,notifyViewportChanged:function(){l.viewport.setDirty();l["scissor.box"].setDirty()}}}},{"./codegen":6,"./stack":26}],28:[function(e,k,m){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function b(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var c=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==
c)return!1;return!0}function c(a){return Object.prototype.toString.call(a)}function d(a){return"[object HTMLCanvasElement]"===c(a)}function f(a){return"[object CanvasRenderingContext2D]"===c(a)}var g=e("./check"),l=e("./values"),q=e("./is-typed-array"),h=e("./is-ndarray"),P=e("./load-texture"),z=e("./to-half-float"),r=e("./parse-dds"),n=[9984,9986,9985,9987];k.exports=function(e,k,m,w,v){function A(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=
this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function D(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=
4352}function J(a,b){var c,d,f=0,l=0,e=0,h=0,q=0,m=0,p=!1,r=!1,P=!1,t=0,u=[0,0,0,0,0,0],v=0,z=!1;for(c=0;c<b.length;++c){d=b[c];var h=h||d.width<<d.miplevel,q=q||d.height<<d.miplevel,f=f||d.type,l=l||d.format,e=e||d.internalformat,m=m||d.channels,r=r||d.needsPoll,P=P||d.needsListeners,p=p||d.compressed,w=d.miplevel;d=d.target;z=z||0<w;3553===d?t|=1<<w:(d-=34069,u[d]|=1<<w,v|=1<<d)}a.needsPoll=r;a.needsListeners=P;a.width=h;a.height=q;a.format=l;a.internalformat=e;a.type=f;r=z?(h<<1)-1:1;if(3553===
a.target)g(0===v,"pixmap type must not contain cubemap faces"),g(t===r,"missing mip map data");else for(g(63===v,"missing cubemap faces"),c=0;6>c;++c)g(u[c]===r,"missing mip map data");c=0<=n.indexOf(a.minFilter);a.genMipmaps=!z&&(a.genMipmaps||c);z=z||a.genMipmaps;a.minFilter?g(z===c,"min filter inconsistent with mipmap data"):a.minFilter=z?9987:9728;z&&g(h===q&&!(h&h-1)&&!!h,"must be a square power of 2 to support mipmaps");a.genMipmaps&&g(!p,"mipmap generation not supported for compressed textures");
a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;33071===a.wrapS&&33071===a.wrapT||g(!(h&h-1)&&!!h&&!(q&q-1)&&!!q&&!v,"incompatible size for wrap mode, image must be a power of 2");(5126===f&&!k.oes_texture_float_linear||36193===f&&!k.oes_texture_half_float_linear)&&g(9728===this.magFilter&&9728===this.minFilter,"unsupported filter mode for float texture");for(c=0;c<b.length;++c)d=b[c],p=d.miplevel,d.width&&g(d.width<<p===h,"inconsistent width"),d.height&&g(d.height<<p===q,"inconsistent width"),d.channels?
g(d.channels===m,"inconsistent channels"):d.channels=m,d.format?g(d.format===l,"inconsistent format"):d.format=l,d.internalformat?g(d.internalformat===e,"inconsistent internalformat"):d.internalformat=e,d.type?g(d.type===f,"inconsistent type"):d.type=f,d.copy&&g(5121===d.type&&6408===d.internalformat,"incompatible format/type for copyTexImage2D")}function y(a){this.id=I++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=
new D(a);this.pixels=[]}function N(a,b){function c(a,d){var g=d.mipmap,f;if(Array.isArray(g))for(var h=0;h<g.length;++h)f=new A(a),f.parseFlags(b),f.parseFlags(d),f.parse(g[h],h),l.push(f);else f=new A(a),f.parseFlags(b),f.parse(d,0),l.push(f)}var d;K(a);var f=a.params;D.call(f,a.target);var l=a.pixels;l.length=0;f.parse(b);if(3553===a.target)c(3553,b);else{var h=b.faces||b;if(Array.isArray(h))for(g(6===h.length,"invalid number of faces in cube map"),d=0;6>d;++d)c(34069+d,h[d]);else if("string"!==
typeof h)for(d=0;6>d;++d)c(34069+d,{})}J(f,l);f.needsListeners&&Y(a);f.needsPoll&&(a.pollId=S.length,S.push(a));U(a)}function U(a){e.isTexture(a.texture)||(a.texture=e.createTexture());var b=a.target,c=a.unit;0<=c?(e.activeTexture(33984+c),Z=c):e.bindTexture(b,a.texture);for(var b=a.pixels,d=a.params,g=0;g<b.length;++g)b[g].upload(d);d.upload();0>c&&((c=da[Z])?e.bindTexture(c.target,c.texture):(a.unit=Z,da[Z]=a))}function Y(a){function b(c,d,l){var h=r(l);g(h.format in W,"unsupported dds texture format");
h.cube?(g(34067===a.target),g.raise("cube map DDS not yet implemented")):g(3553===a.target);d&&g(1===h.pixels.length,"number of mip levels inconsistent");h.pixels.forEach(function(a){var b=new A(h.cube?a.target:c);b.channels=h.channels;b.compressed=h.compressed;b.type=h.type;b.internalformat=h.format;b.format=W[h.format];b.width=a.width;b.height=a.height;b.miplevel=a.miplevel||d;b.data=a.data;f.push(b)})}function c(){for(var g=0;g<f.length;++g){var h=f[g],l=h.image,e=h.video,q=h.xhr;l&&l.complete?
(h.width=l.naturalWidth,h.height=l.naturalHeight):e&&2<e.readyState?(h.width=e.width,h.height=e.height):q&&4===q.readyState&&(f[g]=f[f.length-1],f.pop(),q.removeEventListener("readystatechange",U),b(h.target,h.miplevel,q.response))}J(d,f);U(a)}var d=a.params,f=a.pixels;f.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){f.forEach(function(a){a.image?
a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function K(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((S[b]=S[S.length-1]).id=b,S.pop(),a.pollId=-1)}function G(a){var b=a.texture;g(b,"must not double destroy texture");var c=a.unit,d=a.target;0<=c&&(e.activeTexture(33984+c),Z=c,e.bindTexture(d,null),da[c]=null);K(a);e.isTexture(b)&&e.deleteTexture(b);a.texture=
null;a.params=null;a.pixels=null;a.refCount=0;delete t[a.id]}var Q={"don't care":4352,"dont care":4352,nice:4354,fast:4353},V={repeat:10497,clamp:33071,mirror:33648},ha={nearest:9728,linear:9729},M=Object.assign({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ha),fa={none:0,browser:37444},ia={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ja={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,
rgba4:32854,"rgb5 a1":32855,rgb565:36194},ea={};k.ext_srgb&&(ja.srgb=35904,ja.srgba=35906);k.oes_texture_float&&(ia["float"]=5126);k.oes_texture_half_float&&(ia["half float"]=36193);k.webgl_depth_texture&&(Object.assign(ja,{depth:6402,"depth stencil":34041}),Object.assign(ia,{uint16:5123,uint32:5125,"depth stencil":34042}));k.webgl_compressed_texture_s3tc&&Object.assign(ea,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});k.webgl_compressed_texture_atc&&
Object.assign(ea,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});k.webgl_compressed_texture_pvrtc&&Object.assign(ea,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});k.webgl_compressed_texture_etc1&&(ea["rgb etc1"]=36196);var T=Array.prototype.slice.call(e.getParameter(34467));Object.keys(ea).forEach(function(a){var b=ea[a];0<=T.indexOf(b)&&(ja[a]=b)});var E=Object.keys(ja);m.textureFormats=E;var W=E.reduce(function(a,
b){var c=ja[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});Object.assign(A.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in a&&(g.type(a.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(g.type(a.flipY,"boolean","invalid texture flip"),this.flipY=a.flipY);"alignment"in a&&(g.oneOf(a.alignment,[1,2,4,8],"invalid texture unpack alignment"),
this.unpackAlignment=a.alignment);"colorSpace"in a&&(g.parameter(a.colorSpace,fa,"invalid colorSpace"),this.colorSpace=fa[a.colorSpace]);if("format"in a){var b=a.format;g.parameter(b,ja,"invalid texture format");this.internalformat=ja[b];b in ia&&(this.type=ia[b]);b in ea&&(this.compressed=!0)}"type"in a&&(b=a.type,g.parameter(b,ia,"invalid texture type"),this.type=ia[b]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(g(Array.isArray(a.shape)&&2<=a.shape.length,"shape must be an array"),
b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=a.width),"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,g(Array.isArray(b)&&2<=b.length,"invalid stride vector"),this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|
0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(l,e){this.miplevel=e;this.width>>=e;this.height>>=e;var x=l;switch(typeof l){case "string":break;case "object":if(!l)return;this.parseFlags(l);var n=l.data;if("string"===typeof n||n&&(q(n)||a(n)||h(n)||d(n)||f(n)||"[object HTMLImageElement]"===c(n)||"[object HTMLVideoElement]"===c(n)||b(n)))x=l.data;break;case "undefined":return;default:g.raise("invalid pixel data type")}"string"===typeof x&&(x=P(x,this.crossOrigin));
var n=null,m=!1;this.compressed&&g(x instanceof Uint8Array||"[object XMLHttpRequest]"===c(x),"compressed texture data must be stored in a uint8array");if(null!==x)if(q(x))this.data=x;else if(a(x))n=x,m=!0;else if(h(x)){Array.isArray(x.data)?(n=x.data,m=!0):this.data=x.data;var p=x.shape;this.width=p[0];this.height=p[1];this.channels=3===p.length?p[2]:1;p=x.stride;this.strideX=x.stride[0];this.strideY=x.stride[1];this.strideC=3===p.length?x.stride[2]:1;this.offset=x.offset;this.needsTranspose=!0}else if(d(x)||
f(x))d(x)?this.canvas=x:this.canvas=x.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===c(x))this.image=x,x.complete?(this.width=x.naturalWidth,this.height=x.naturalHeight):(this.width=this.width||x.naturalWidth,this.height=this.height||x.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();else if("[object HTMLVideoElement]"===c(x))this.video=x,1<x.readyState?(this.width=x.width,this.height=x.height):(this.width=
this.width||x.width,this.height=this.height||x.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===c(x))this.xhr=x,this.needsListeners=!0;else if(b(x)){var m=x.length,p=x[0].length,r=1,t,u,w,y;if(Array.isArray(x[0][0]))for(r=x[0][0].length,g(0<=r&&4>=r,"invalid number of channels for image data"),n=Array(m*p*r),u=y=0;u<p;++u)for(t=0;t<m;++t)for(w=0;w<r;++w)n[y++]=x[t][u][w];else for(n=Array(m*p),u=y=0;u<p;++u)for(t=0;t<m;++t)n[y++]=x[t][u];
this.width=m;this.height=p;this.channels=r;m=!0}else l.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||v.width)|0,this.height=(this.height||v.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,6410,6407,6408][(this.channels=this.channels||4)-1],g(this.internalformat,
"invalid number of channels"));p=this.internalformat;if(6402===p||34041===p)g(k.webgl_depth_texture,"depth/stencil texture not supported"),6402===p&&g(5123===this.type||5125,"depth texture type must be uint16 or uint32"),34041===p&&g(34042===this.type,"depth stencil texture format must match type"),g(!this.data&&!n&&!this.image&&!this.video&&!this.canvas,"depth/stencil textures are for rendering only");x=this.format=W[p];if(!this.channels)switch(x){case 6409:case 6406:case 6402:this.channels=1;break;
case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}x=this.type;5126===x?g(k.oes_texture_float,"float texture not supported"):36193===x?g(k.oes_texture_half_float,"half float texture not supported"):x||(x=6402===p?5125:5121);this.type=x;if(m)switch(x){case 5121:this.data=new Uint8Array(n);break;case 5123:this.data=new Uint16Array(n);break;case 5125:this.data=new Uint32Array(n);break;case 5126:this.data=new Float32Array(n);break;case 36193:this.data=z(n);
break;case 33635:case 32820:case 32819:case 34042:g.raise("unsupported format for automatic conversion");break;default:g.raise("unsupported type conversion")}if(this.data){if(this.needsTranspose){n=this.data;m=this.width;p=this.height;r=this.channels;t=this.strideX;u=this.strideY;w=this.strideC;y=this.offset;for(var A=new n.constructor(m*p*r),D=0,E=0;E<p;++E)for(var G=0;G<m;++G)for(var I=0;I<r;++I)A[D++]=n[u*E+t*G+w*I+y];this.data=A}switch(x){case 5121:g(this.data instanceof Uint8Array||this.data instanceof
Uint8ClampedArray,"incompatible pixel type");break;case 33635:case 32820:case 32819:case 5123:case 36193:g(this.data instanceof Uint16Array,"incompatible pixel type");break;case 5125:g(this.data instanceof Uint32Array,"incompatible pixel type");break;case 5126:g(this.data instanceof Float32Array,"incompatible pixel type");break;default:g.raise("bad or missing pixel type")}}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=
!1},upload:function(a){e.pixelStorei(37440,this.flipY);e.pixelStorei(37441,this.premultiplyAlpha);e.pixelStorei(37443,this.colorSpace);e.pixelStorei(3317,this.unpackAlignment);var b=this.target,c=this.miplevel,d=this.image,g=this.canvas,f=this.video,l=this.data,h=this.internalformat,q=this.format,n=this.type,k=this.width||Math.max(1,a.width>>c);a=this.height||Math.max(1,a.height>>c);f&&2<f.readyState?e.texImage2D(b,c,q,q,n,f):d&&d.complete?e.texImage2D(b,c,q,q,n,d):g?e.texImage2D(b,c,q,q,n,g):this.compressed?
e.compressedTexImage2D(b,c,h,k,a,0,l):this.copy?(w(),e.copyTexImage2D(b,c,q,this.x,this.y,k,a,0)):l?e.texImage2D(b,c,q,k,a,0,q,n,l):e.texImage2D(b,c,q,k||1,a||1,0,q,n,null)}});Object.assign(D.prototype,{parse:function(a){if("object"===typeof a&&a){if("min"in a){var b=a.min;g.parameter(b,M);this.minFilter=M[b]}"mag"in a&&(b=a.mag,g.parameter(b,ha),this.magFilter=ha[b]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?(g.parameter(d,V),b=c=V[d]):Array.isArray(d)&&(g.parameter(d[0],
V),g.parameter(d[1],V),b=V[d[0]],c=V[d[1]])}else"wrapS"in a&&(b=a.wrapS,g.parameter(b,V),b=V[b]),"wrapT"in a&&(c=a.wrapT,g.parameter(c,V),c=V[c]);this.wrapS=b;this.wrapT=c;"anisotropic"in a&&(b=a.anisotropic,g("number"===typeof b&&1<=b&&b<=m.maxAnisotropic,"aniso samples must be between 1 and "),this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":g.parameter(a,Q,"invalid mipmap hint");this.mipmapHint=Q[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=
!!a;break;case "object":break;default:g.raise("invalid mipmap type")}}},upload:function(){var a=this.target;e.texParameteri(a,10241,this.minFilter);e.texParameteri(a,10240,this.magFilter);e.texParameteri(a,10242,this.wrapS);e.texParameteri(a,10243,this.wrapT);k.ext_texture_filter_anisotropic&&e.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(e.hint(33170,this.mipmapHint),e.generateMipmap(a))}});var Z=0,I=0,t={},S=[],X=m.maxTextureUnits,da=Array(X).map(function(){return null});Object.assign(y.prototype,
{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<X;++b){var c=da[b];if(c){if(0<c.bindCount)continue;c.unit=-1}da[b]=this;a=b;break}a>=X&&g.raise("insufficient number of texture units");this.unit=a;e.activeTexture(33984+a);e.bindTexture(this.target,this.texture);Z=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&G(this)}});return{create:function(a,b){function c(a,f,g,l,h,e){var q=a||{};34067===b&&6===arguments.length&&(q=[a,f,g,l,h,e]);
N(d,q);c.width=d.params.width;c.height=d.params.height;return c}var d=new y(b);t[d.id]=d;c(a);Object.assign(c,{_reglType:"texture",_texture:d,destroy:function(){d.decRef()}});return c},refresh:function(){l(t).forEach(U);for(var a=0;a<X;++a)da[a]=null;Z=0;e.activeTexture(33984)},clear:function(){for(var a=0;a<X;++a)e.activeTexture(33984+a),e.bindTexture(3553,null),da[a]=null;e.activeTexture(33984);Z=0;l(t).forEach(G)},poll:function(){S.forEach(U)},getTexture:function(a){return null}}}},{"./check":4,
"./is-ndarray":17,"./is-typed-array":18,"./load-texture":20,"./parse-dds":21,"./to-half-float":29,"./values":31}],29:[function(e,k,m){k.exports=function(a){for(var b=new Float32Array(a),b=new Uint32Array(b.buffer),c=new Uint16Array(a.length),d=0;d<a.length;++d)if(isNaN(a[d]))c[d]=65535;else if(Infinity===a[d])c[d]=31744;else if(-Infinity===a[d])c[d]=64512;else{var f=b[d],g=f>>>31<<15,l=(f<<1>>>24)-127,f=f>>13&1023;c[d]=-24>l?g:-14>l?g+(f+1024>>-14-l):15<l?g+31744:g+(l+15<<10)+f}return c}},{}],30:[function(e,
k,m){k.exports=function(){var a={};return{uniforms:a,def:function(b){b in a||(a[b]=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]])}}}},{}],31:[function(e,k,m){k.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},{}],32:[function(e,k,m){k.exports=function(a,b){var c=b[0],d=b[1],f=b[2],g=b[3],l=b[4],e=b[5],h=b[6],k=b[7],m=b[8],r=b[9],n=b[10],p=b[11],C=b[12],u=b[13],w=b[14],v=b[15];a[0]=e*(n*v-p*w)-r*(h*v-k*w)+u*(h*p-k*n);a[1]=-(d*(n*v-p*w)-r*(f*v-g*w)+u*(f*p-g*n));a[2]=d*(h*v-k*w)-e*(f*
v-g*w)+u*(f*k-g*h);a[3]=-(d*(h*p-k*n)-e*(f*p-g*n)+r*(f*k-g*h));a[4]=-(l*(n*v-p*w)-m*(h*v-k*w)+C*(h*p-k*n));a[5]=c*(n*v-p*w)-m*(f*v-g*w)+C*(f*p-g*n);a[6]=-(c*(h*v-k*w)-l*(f*v-g*w)+C*(f*k-g*h));a[7]=c*(h*p-k*n)-l*(f*p-g*n)+m*(f*k-g*h);a[8]=l*(r*v-p*u)-m*(e*v-k*u)+C*(e*p-k*r);a[9]=-(c*(r*v-p*u)-m*(d*v-g*u)+C*(d*p-g*r));a[10]=c*(e*v-k*u)-l*(d*v-g*u)+C*(d*k-g*e);a[11]=-(c*(e*p-k*r)-l*(d*p-g*r)+m*(d*k-g*e));a[12]=-(l*(r*w-n*u)-m*(e*w-h*u)+C*(e*n-h*r));a[13]=c*(r*w-n*u)-m*(d*w-f*u)+C*(d*n-f*r);a[14]=-(c*
(e*w-h*u)-l*(d*w-f*u)+C*(d*h-f*e));a[15]=c*(e*n-h*r)-l*(d*n-f*r)+m*(d*h-f*e);return a}},{}],33:[function(e,k,m){k.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}},{}],34:[function(e,k,m){k.exports=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];
a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],35:[function(e,k,m){k.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],36:[function(e,k,m){k.exports=function(a){var b=a[0],c=a[1],d=a[2],f=a[3],g=a[4],l=a[5],e=a[6],h=a[7],k=a[8],m=a[9],r=a[10],n=a[11],p=a[12],C=a[13],u=a[14];a=a[15];return(b*l-c*g)*(r*a-n*u)-(b*e-d*g)*(m*a-n*C)+(b*h-f*g)*(m*u-
r*C)+(c*e-d*l)*(k*a-n*p)-(c*h-f*l)*(k*u-r*p)+(d*h-f*e)*(k*C-m*p)}},{}],37:[function(e,k,m){k.exports=function(a,b){var c=b[0],d=b[1],f=b[2],g=b[3],l=c+c,e=d+d,h=f+f,c=c*l,k=d*l,d=d*e,m=f*l,r=f*e,f=f*h,l=g*l,e=g*e,g=g*h;a[0]=1-d-f;a[1]=k+g;a[2]=m-e;a[3]=0;a[4]=k-g;a[5]=1-c-f;a[6]=r+l;a[7]=0;a[8]=m+e;a[9]=r-l;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],38:[function(e,k,m){k.exports=function(a,b,c){var d=b[0],f=b[1],g=b[2],l=b[3],e=d+d,h=f+f,k=g+g;b=d*e;var m=d*h,d=d*k,r=f*h,f=
f*k,g=g*k,e=l*e,h=l*h,l=l*k;a[0]=1-(r+g);a[1]=m+l;a[2]=d-h;a[3]=0;a[4]=m-l;a[5]=1-(b+g);a[6]=f+e;a[7]=0;a[8]=d+h;a[9]=f-e;a[10]=1-(b+r);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}},{}],39:[function(e,k,m){k.exports=function(a,b,c,d,f,g,e){var k=1/(c-b),h=1/(f-d),m=1/(g-e);a[0]=2*g*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*g*h;a[6]=0;a[7]=0;a[8]=(c+b)*k;a[9]=(f+d)*h;a[10]=(e+g)*m;a[11]=-1;a[12]=0;a[13]=0;a[14]=e*g*2*m;a[15]=0;return a}},{}],40:[function(e,k,m){k.exports=function(a){a[0]=
1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],41:[function(e,k,m){k.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),
fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":32,"./clone":33,"./copy":34,"./create":35,"./determinant":36,"./fromQuat":37,"./fromRotationTranslation":38,"./frustum":39,"./identity":40,"./invert":42,"./lookAt":43,"./multiply":44,"./ortho":45,"./perspective":46,"./perspectiveFromFieldOfView":47,
"./rotate":48,"./rotateX":49,"./rotateY":50,"./rotateZ":51,"./scale":52,"./str":53,"./translate":54,"./transpose":55}],42:[function(e,k,m){k.exports=function(a,b){var c=b[0],d=b[1],f=b[2],g=b[3],e=b[4],k=b[5],h=b[6],m=b[7],z=b[8],r=b[9],n=b[10],p=b[11],C=b[12],u=b[13],w=b[14],v=b[15],A=c*k-d*e,D=c*h-f*e,J=c*m-g*e,y=d*h-f*k,N=d*m-g*k,U=f*m-g*h,Y=z*u-r*C,K=z*w-n*C,G=z*v-p*C,Q=r*w-n*u,V=r*v-p*u,ha=n*v-p*w,M=A*ha-D*V+J*Q+y*G-N*K+U*Y;if(!M)return null;M=1/M;a[0]=(k*ha-h*V+m*Q)*M;a[1]=(f*V-d*ha-g*Q)*M;
a[2]=(u*U-w*N+v*y)*M;a[3]=(n*N-r*U-p*y)*M;a[4]=(h*G-e*ha-m*K)*M;a[5]=(c*ha-f*G+g*K)*M;a[6]=(w*J-C*U-v*D)*M;a[7]=(z*U-n*J+p*D)*M;a[8]=(e*V-k*G+m*Y)*M;a[9]=(d*G-c*V-g*Y)*M;a[10]=(C*N-u*J+v*A)*M;a[11]=(r*J-z*N-p*A)*M;a[12]=(k*K-e*Q-h*Y)*M;a[13]=(c*Q-d*K+f*Y)*M;a[14]=(u*D-C*y-w*A)*M;a[15]=(z*y-r*D+n*A)*M;return a}},{}],43:[function(e,k,m){var a=e("./identity");k.exports=function(b,c,d,f){var g,e,k,h,m,z,r,n,p=c[0],C=c[1];c=c[2];k=f[0];h=f[1];e=f[2];r=d[0];f=d[1];g=d[2];if(1E-6>Math.abs(p-r)&&1E-6>Math.abs(C-
f)&&1E-6>Math.abs(c-g))return a(b);d=p-r;f=C-f;r=c-g;n=1/Math.sqrt(d*d+f*f+r*r);d*=n;f*=n;r*=n;g=h*r-e*f;e=e*d-k*r;k=k*f-h*d;(n=Math.sqrt(g*g+e*e+k*k))?(n=1/n,g*=n,e*=n,k*=n):k=e=g=0;h=f*k-r*e;m=r*g-d*k;z=d*e-f*g;(n=Math.sqrt(h*h+m*m+z*z))?(n=1/n,h*=n,m*=n,z*=n):z=m=h=0;b[0]=g;b[1]=h;b[2]=d;b[3]=0;b[4]=e;b[5]=m;b[6]=f;b[7]=0;b[8]=k;b[9]=z;b[10]=r;b[11]=0;b[12]=-(g*p+e*C+k*c);b[13]=-(h*p+m*C+z*c);b[14]=-(d*p+f*C+r*c);b[15]=1;return b}},{"./identity":40}],44:[function(e,k,m){k.exports=function(a,b,
c){var d=b[0],f=b[1],g=b[2],e=b[3],k=b[4],h=b[5],m=b[6],z=b[7],r=b[8],n=b[9],p=b[10],C=b[11],u=b[12],w=b[13],v=b[14];b=b[15];var A=c[0],D=c[1],J=c[2],y=c[3];a[0]=A*d+D*k+J*r+y*u;a[1]=A*f+D*h+J*n+y*w;a[2]=A*g+D*m+J*p+y*v;a[3]=A*e+D*z+J*C+y*b;A=c[4];D=c[5];J=c[6];y=c[7];a[4]=A*d+D*k+J*r+y*u;a[5]=A*f+D*h+J*n+y*w;a[6]=A*g+D*m+J*p+y*v;a[7]=A*e+D*z+J*C+y*b;A=c[8];D=c[9];J=c[10];y=c[11];a[8]=A*d+D*k+J*r+y*u;a[9]=A*f+D*h+J*n+y*w;a[10]=A*g+D*m+J*p+y*v;a[11]=A*e+D*z+J*C+y*b;A=c[12];D=c[13];J=c[14];y=c[15];
a[12]=A*d+D*k+J*r+y*u;a[13]=A*f+D*h+J*n+y*w;a[14]=A*g+D*m+J*p+y*v;a[15]=A*e+D*z+J*C+y*b;return a}},{}],45:[function(e,k,m){k.exports=function(a,b,c,d,f,g,e){var k=1/(b-c),h=1/(d-f),m=1/(g-e);a[0]=-2*k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*h;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*m;a[11]=0;a[12]=(b+c)*k;a[13]=(f+d)*h;a[14]=(e+g)*m;a[15]=1;return a}},{}],46:[function(e,k,m){k.exports=function(a,b,c,d,f){b=1/Math.tan(b/2);var g=1/(d-f);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=
0;a[10]=(f+d)*g;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*f*d*g;a[15]=0;return a}},{}],47:[function(e,k,m){k.exports=function(a,b,c,d){var f=Math.tan(b.upDegrees*Math.PI/180),g=Math.tan(b.downDegrees*Math.PI/180),e=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var k=2/(e+b),h=2/(f+g);a[0]=k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=h;a[6]=0;a[7]=0;a[8]=-((e-b)*k*.5);a[9]=(f-g)*h*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a}},{}],48:[function(e,k,m){k.exports=
function(a,b,c,d){var f=d[0],g=d[1];d=d[2];var e=Math.sqrt(f*f+g*g+d*d),k,h,m,z,r,n,p,C,u,w,v,A,D,J,y,N,U,Y,K,G;if(1E-6>Math.abs(e))return null;e=1/e;f*=e;g*=e;d*=e;k=Math.sin(c);h=Math.cos(c);m=1-h;c=b[0];e=b[1];z=b[2];r=b[3];n=b[4];p=b[5];C=b[6];u=b[7];w=b[8];v=b[9];A=b[10];D=b[11];J=f*f*m+h;y=g*f*m+d*k;N=d*f*m-g*k;U=f*g*m-d*k;Y=g*g*m+h;K=d*g*m+f*k;G=f*d*m+g*k;f=g*d*m-f*k;g=d*d*m+h;a[0]=c*J+n*y+w*N;a[1]=e*J+p*y+v*N;a[2]=z*J+C*y+A*N;a[3]=r*J+u*y+D*N;a[4]=c*U+n*Y+w*K;a[5]=e*U+p*Y+v*K;a[6]=z*U+C*Y+
A*K;a[7]=r*U+u*Y+D*K;a[8]=c*G+n*f+w*g;a[9]=e*G+p*f+v*g;a[10]=z*G+C*f+A*g;a[11]=r*G+u*f+D*g;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],49:[function(e,k,m){k.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[4],g=b[5],e=b[6],k=b[7],h=b[8],m=b[9],z=b[10],r=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=f*c+h*d;a[5]=g*c+m*d;a[6]=e*c+z*d;a[7]=k*c+r*d;a[8]=h*c-f*d;a[9]=m*c-g*d;a[10]=z*c-e*d;a[11]=r*c-
k*d;return a}},{}],50:[function(e,k,m){k.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[0],g=b[1],e=b[2],k=b[3],h=b[8],m=b[9],z=b[10],r=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=f*c-h*d;a[1]=g*c-m*d;a[2]=e*c-z*d;a[3]=k*c-r*d;a[8]=f*d+h*c;a[9]=g*d+m*c;a[10]=e*d+z*c;a[11]=k*d+r*c;return a}},{}],51:[function(e,k,m){k.exports=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[0],g=b[1],e=b[2],k=b[3],h=b[4],m=b[5],
z=b[6],r=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=f*c+h*d;a[1]=g*c+m*d;a[2]=e*c+z*d;a[3]=k*c+r*d;a[4]=h*c-f*d;a[5]=m*c-g*d;a[6]=z*c-e*d;a[7]=r*c-k*d;return a}},{}],52:[function(e,k,m){k.exports=function(a,b,c){var d=c[0],f=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*f;a[5]=b[5]*f;a[6]=b[6]*f;a[7]=b[7]*f;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];
return a}},{}],53:[function(e,k,m){k.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],54:[function(e,k,m){k.exports=function(a,b,c){var d=c[0],f=c[1];c=c[2];var g,e,k,h,m,z,r,n,p,C,u,w;b===a?(a[12]=b[0]*d+b[4]*f+b[8]*c+b[12],a[13]=b[1]*d+b[5]*f+b[9]*c+b[13],a[14]=b[2]*d+b[6]*f+b[10]*c+b[14],a[15]=b[3]*d+b[7]*f+b[11]*c+b[15]):(g=b[0],e=b[1],k=b[2],
h=b[3],m=b[4],z=b[5],r=b[6],n=b[7],p=b[8],C=b[9],u=b[10],w=b[11],a[0]=g,a[1]=e,a[2]=k,a[3]=h,a[4]=m,a[5]=z,a[6]=r,a[7]=n,a[8]=p,a[9]=C,a[10]=u,a[11]=w,a[12]=g*d+m*f+p*c+b[12],a[13]=e*d+z*f+C*c+b[13],a[14]=k*d+r*f+u*c+b[14],a[15]=h*d+n*f+w*c+b[15]);return a}},{}],55:[function(e,k,m){k.exports=function(a,b){if(a===b){var c=b[1],d=b[2],f=b[3],g=b[6],e=b[7],k=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=g;a[11]=b[14];a[12]=f;a[13]=e;a[14]=k}else a[0]=b[0],a[1]=b[4],a[2]=
b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],56:[function(e,k,m){function a(a,c,d,f){f[0]=b(255*a);f[1]=b(255*c);f[2]=b(255*d)}var b=Math.round,c=Math.min,d=Math.max,f=Math.ceil;k.exports=function(b,e,k,h){h=h||[0,0,0];b%=360;e=d(0,c(e,1));k=d(0,c(k,1));if(e){e=(1-e)*k;var m=k-e,z=b%60;switch(b/60|0){case 0:a(k,m*b/60+e,e,h);break;case 1:a(m*(60-z)/60+e,k,e,h);break;case 2:a(e,k,m*
z/60+e,h);break;case 3:a(e,m*(60-z)/60+e,k,h);break;case 4:a(m*z/60+e,e,k,h);break;case 5:a(k,e,m*(60-z)/60+e,h)}}else h[0]=h[1]=h[2]=f(255*k);return h}},{}],57:[function(e,k,m){var a=e("./lib/check"),b=e("./lib/context"),c=e("./lib/extension"),d=e("./lib/limits"),f=e("./lib/buffer"),g=e("./lib/elements"),l=e("./lib/texture"),q=e("./lib/renderbuffer"),h=e("./lib/framebuffer"),P=e("./lib/uniform"),z=e("./lib/attribute"),r=e("./lib/shader"),n=e("./lib/draw"),p=e("./lib/state"),C=e("./lib/compile"),
u=e("./lib/read"),w=e("./lib/dynamic"),v=e("./lib/raf"),A=e("./lib/clock");k.exports=function(){function e(){L=v.next(e);t.count+=1;if(t.width!==G.drawingBufferWidth||t.height!==G.drawingBufferHeight)t.width=G.drawingBufferWidth,t.height=G.drawingBufferHeight,S.notifyViewportChanged();var a=A();t.dt=a-t.t;t.t=a;W.poll();for(var b=0;b<B.length;++b)(0,B[b])(t.count,t.t,t.dt);t.renderTime=A()-a}function k(){L&&(v.cancel(e),L=0)}function m(a){k();a.preventDefault();if(Q.onContextLost)Q.onContextLost()}
function N(a){G.getError();V.refresh();fa.refresh();W.refresh();Z.refresh();I.refresh();T.refresh();S.refresh();if(Q.onContextRestored)Q.onContextRestored();e()}function U(b){function c(a){var b={},e={};Object.keys(a).forEach(function(c){var f=a[c];w.isDynamic(f)?(d=!0,e[c]=w.unbox(f,c)):b[c]=f});return{dynamic:e,"static":b}}a(!!b,"invalid args to regl({...})");a.type(b,"object","invalid args to regl({...})");var d=!1,e=c(b.uniforms||{}),f=c(b.attributes||{});b=c(function(a){function b(a){if(a in
c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=Object.assign({},a);delete c.uniforms;delete c.attributes;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(b));var e=X.command(b["static"],e["static"],f["static"],b.dynamic,e.dynamic,f.dynamic,d),g=e.draw,h=e.batch,k=e.scope,l=[];return function(a,b){if("number"===typeof a){for(var c=a|0;l.length<c;)l.push(null);return h(a|0,l)}return Array.isArray(a)?h(a.length,
a):"function"===typeof a?k(null,a):"function"===typeof b?k(a,b):g(a)}}function Y(){I.poll();S.poll()}var K=b(Array.prototype.slice.call(arguments)),G=K.gl,Q=K.options,V=c(G),K=V.extensions,ha={width:G.drawingBufferWidth,height:G.drawingBufferHeight},M=d(G,K),fa=f(G),ia=g(G,K,fa),ja=P(),ea=z(G,K,M,fa),T=r(G,ea,ja,function(a){return X.draw(a)}),E=n(G,K,fa),W=l(G,K,M,Y,ha),Z=q(G,K,M),I=h(G,K,M,W,Z),t={count:0,start:A(),dt:0,t:A(),renderTime:0,width:G.drawingBufferWidth,height:G.drawingBufferHeight,pixelRatio:Q.pixelRatio},
S=p(G,I,ha),ha=u(G,Y,ha),X=C(G,K,M,fa,ia,W,I,S,ja,ea,T,E,t,Y),da=G.canvas,B=[],L=0;da&&(da.addEventListener("webglcontextlost",m,!1),da.addEventListener("webglcontextrestored",N,!1));return Object.assign(U,{clear:function(b){var c=0;Y();var d=b.color;d&&(G.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384);"depth"in b&&(G.clearDepth(+b.depth),c|=256);"stencil"in b&&(G.clearStencil(b.stencil|0),c|=1024);a(!!c,"called regl.clear with no buffer specified");G.clear(c)},prop:w.define,draw:U({}),
elements:function(a){return ia.create(a)},buffer:function(a){return fa.create(a,34962)},texture:function(a){return W.create(a,3553)},cube:function(a){return 6===arguments.length?W.create(Array.prototype.slice.call(arguments),34067):W.create(a,34067)},renderbuffer:function(a){return Z.create(a)},framebuffer:function(a){return I.create(a)},framebufferCube:function(b){a.raise("framebuffer cube not yet implemented")},frame:function(a){B.push(a);!L&&0<B.length&&e();return{cancel:function(){var b=B.find(function(b){return b===
a});0>b||(B.splice(b,1),0>=B.length&&k())}}},stats:t,limits:M,read:ha,destroy:function(){k();da&&(da.removeEventListener("webglcontextlost",m),da.removeEventListener("webglcontextrestored",N));T.clear();I.clear();Z.clear();W.clear();fa.clear();if(Q.onDestroy)Q.onDestroy()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/check":4,"./lib/clock":5,"./lib/compile":7,"./lib/context":11,"./lib/draw":12,"./lib/dynamic":13,"./lib/elements":14,"./lib/extension":15,"./lib/framebuffer":16,"./lib/limits":19,
"./lib/raf":22,"./lib/read":23,"./lib/renderbuffer":24,"./lib/shader":25,"./lib/state":27,"./lib/texture":28,"./lib/uniform":30}]},{},[1]);
