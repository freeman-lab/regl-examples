(function e$$0(k,p,a){function b(c,e){if(!p[c]){if(!k[c]){var d="function"==typeof require&&require;if(!e&&d)return d(c,!0);if(g)return g(c,!0);d=Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d;}d=p[c]={exports:{}};k[c][0].call(d.exports,function(a){var d=k[c][1][a];return b(d?d:a)},d,d.exports,e$$0,k,p,a)}return p[c].exports}for(var g="function"==typeof require&&require,d=0;d<a.length;d++)b(a[d]);return b})({1:[function(f,k,p){var a=f("../regl")(),b=f("gl-mat4"),g=f("hsv2rgb");
f=a.buffer(Array(1E4).fill().map(function(){var a=g(360*Math.random(),.6,1);return[10*Math.random(),10*Math.random(),10*Math.random(),10*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),2*Math.PI*Math.random(),a[0]/255,a[1]/255,a[2]/255]}));var d=a({vert:"\n  precision mediump float;\n  attribute vec4 freq, phase;\n  attribute vec3 color;\n  uniform float time;\n  uniform mat4 view, projection;\n  varying vec3 fragColor;\n  void main() {\n    vec3 position = 8.0 * cos(freq.xyz * time + phase.xyz);\n    gl_PointSize = 5.0 * (1.0 + cos(freq.w * time + phase.w));\n    gl_Position = projection * view * vec4(position, 1);\n    fragColor = color;\n  }",
frag:"\n  precision lowp float;\n  varying vec3 fragColor;\n  void main() {\n    if (length(gl_PointCoord.xy - 0.5) > 0.5) {\n      discard;\n    }\n    gl_FragColor = vec4(fragColor, 1);\n  }",attributes:{freq:{buffer:f,stride:44,offset:0},phase:{buffer:f,stride:44,offset:16},color:{buffer:f,stride:44,offset:32}},uniforms:{view:function(a){a=.01*a.count;return b.lookAt([],[30*Math.cos(a),2.5,30*Math.sin(a)],[0,0,0],[0,1,0])},projection:function(a){return b.perspective([],Math.PI/4,a.viewportWidth/
a.viewportHeight,.01,1E3)},time:function(a){return.001*a.count}},count:1E4,primitive:"points"});a.frame(function(){a.clear({depth:1,color:[0,0,0,1]});d()})},{"../regl":55,"gl-mat4":39,hsv2rgb:54}],2:[function(f,k,p){function a(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}k.exports=function(b,g,d,c,e){b=d.maxAttributes;g=Array(b);for(d=0;d<b;++d)g[d]=new a;return{Record:a,scope:{},state:g}}},{}],3:[function(f,
k,p){function a(a){return h[Object.prototype.toString.call(a)]|0}function b(a,b){for(var c=0;c<b.length;++c)a[c]=b[c]}function g(a,b,c,d,e,g,l){for(var m=0,h=0;h<c;++h)for(var f=0;f<d;++f)a[m++]=b[e*h+g*f+l]}function d(a,b,c){for(var d=0,e=0;e<b.length;++e)for(var g=b[e],l=0;l<c;++l)a[d++]=g[l]}var c=f("./util/is-typed-array"),e=f("./util/is-ndarray"),l=f("./util/values"),m=f("./util/pool"),h=f("./constants/arraytypes.json"),C=f("./constants/dtypes.json"),t=f("./constants/usage.json");k.exports=function(n){function h(a){this.id=
q++;this.buffer=n.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function f(a,b,c){a.byteLength=b.byteLength;n.bufferData(a.type,b,c)}function w(l,n,q,h,u){l.usage=q;if(Array.isArray(n))l.dtype=h||5126,0<n.length&&(Array.isArray(n[0])?(l.dimension=n[0].length,h=m.allocType(l.dtype,n.length*l.dimension),d(h,n,l.dimension),f(l,h,q),m.freeType(h)):"number"===typeof n[0]?(l.dimension=u,h=m.allocType(l.dtype,n.length),b(h,n),f(l,h,q),m.freeType(h)):c(n[0])&&
(l.dimension=n[0].length,l.dtype=h||a(n[0])||5126,h=m.allocType(l.dtype,n.length*l.dimension),d(h,n,l.dimension),f(l,h,q),m.freeType(h)));else if(c(n))l.dtype=h||a(n),l.dimension=u,f(l,n,q);else if(e(n)){var y=n.shape,A=n.stride;u=n.offset;var C=0,t=0,k=0,w=0;1===y.length?(C=y[0],t=1,k=A[0],w=0):2===y.length&&(C=y[0],t=y[1],k=A[0],w=A[1]);l.dtype=h||a(n.data)||5126;l.dimension=t;h=m.allocType(l.dtype,C*t);g(h,n.data,C,t,k,w,u);f(l,h,q);m.freeType(h)}}function u(a){var b=a.buffer;n.isBuffer(b)&&n.deleteBuffer(b);
a.buffer=null;delete k[a.id]}var q=0,k={};h.prototype.bind=function(){n.bindBuffer(this.type,this.buffer)};var x=[];return{create:function(l,q,f){function v(a){var b=35044,d=null,g=0,l=0,m=1;Array.isArray(a)||c(a)||e(a)?d=a:"number"===typeof a?g=a|0:a&&("data"in a&&(d=a.data),"usage"in a&&(b=t[a.usage]),"type"in a&&(l=C[a.type]),"dimension"in a&&(m=a.dimension|0),"length"in a&&(g=a.length|0));x.bind();d?w(x,d,b,l,m):(n.bufferData(x.type,g,b),x.dtype=l||5121,x.usage=b,x.dimension=m,x.byteLength=g);
return v}var x=new h(q);k[x.id]=x;f||v(l);v._reglType="buffer";v._buffer=x;v.subdata=function(l,h){var q=(h||0)|0;x.bind();if(Array.isArray(l)){if(0<l.length)if("number"===typeof l[0]){var f=m.allocType(x.dtype,l.length);b(f,l);n.bufferSubData(x.type,q,f);m.freeType(f)}else if(Array.isArray(l[0])||c(l[0])){var f=l[0].length,u=m.allocType(x.dtype,l.length*f);d(u,l,f);n.bufferSubData(x.type,q,u);m.freeType(u)}}else if(c(l))n.bufferSubData(x.type,q,l);else if(e(l)){var A=l.shape,t=l.stride,C=u=f=0,k=
0;1===A.length?(f=A[0],u=1,C=t[0],k=0):2===A.length&&(f=A[0],u=A[1],C=t[0],k=t[1]);A=Array.isArray(l.data)?x.dtype:a(l.data);A=m.allocType(A,f*u);g(A,l.data,f,u,C,k,l.offset);n.bufferSubData(x.type,q,A);m.freeType(A)}return v};v.destroy=function(){u(x)};return v},createStream:function(a,b){var c=x.pop();c||(c=new h(a),c.buffer=n.createBuffer());c.bind();w(c,b,35040,0,1);return c},destroyStream:function(a){x.push(a)},clear:function(){l(k).forEach(u)},getBuffer:function(a){return a&&a._buffer instanceof
h?a._buffer:null},_initBuffer:w}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/pool":25,"./util/values":28}],4:[function(f,k,p){k.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},
{}],5:[function(f,k,p){k.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(f,k,p){k.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(f,k,p){k.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(f,k,p){function a(a){return Array.isArray(a)||h(a)||C(a)}function b(a){return a.sort(function(a,b){return"viewport"===a?-1:
"viewport"===b?1:a<b?-1:1})}function g(a,b,c,d){this.thisDep=a;this.contextDep=b;this.propDep=c;this.append=d}function d(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function c(a){return new g(!1,!1,!1,a)}function e(a,b){var c=a.type;return 0===c?(c=a.data.length,new g(!0,1<=c,2<=c,b)):new g(3===c,2===c,1===c,b)}var l=f("./util/codegen"),m=f("./util/loop"),h=f("./util/is-typed-array"),C=f("./util/is-ndarray"),t=f("./constants/primitives.json"),n=f("./constants/dtypes.json"),A=["x","y","z","w"],
v={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},w={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},
u={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},q={cw:2304,ccw:2305},E=new g(!1,!1,!1,function(){});k.exports=function(f,C,k,p,F,H,y,O,J,S,P,Q,I){function M(a){return a.replace(".","_")}function K(a,b,c){var d=M(a);ka.push(a);sa[d]=r[d]=!!c;ea[d]=b}function L(a,b,c){var d=M(a);ka.push(a);Array.isArray(c)?(r[d]=c.slice(),sa[d]=c.slice()):r[d]=sa[d]=c;fa[d]=b}function ba(){var a=l(),b=a.link,c=a.global;a.id=Ba++;a.batchId=
"0";var d=b(Aa),e=a.shared={props:"a0"};Object.keys(Aa).forEach(function(a){e[a]=c.def(d,".",a)});var g=a.next={},n=a.current={};Object.keys(fa).forEach(function(a){Array.isArray(r[a])&&(g[a]=c.def(e.next,".",a),n[a]=c.def(e.current,".",a))});var G=a.constants={};Object.keys(ua).forEach(function(a){G[a]=c.def(JSON.stringify(ua[a]))});a.invoke=function(c,G){switch(G.type){case 0:var d=["this",e.context,e.props,a.batchId];return c.def(b(G.data),".call(",d.slice(0,Math.max(G.data.length+1,4)),")");case 1:return c.def(e.props,
G.data);case 2:return c.def(e.context,G.data);case 3:return c.def("this",G.data)}};a.attribCache={};var ya={};a.scopeAttrib=function(a){a=C.id(a);if(a in ya)return ya[a];var c=S.scope[a];c||(c=S.scope[a]=new la);return ya[a]=b(c)};return a}function Z(a){var b=a["static"];a=a.dynamic;if("framebuffer"in b){var d=b.framebuffer;return d?(d=O.getFramebuffer(d),c(function(a,b){var c=a.link(d),G=a.shared;b.set(G.framebuffer,".next",c);G=G.context;b.set(G,".framebufferWidth",c+".width");b.set(G,".framebufferHeight",
c+".height");return c})):c(function(a,b){var c=a.shared;b.set(c.framebuffer,".next","null");c=c.context;b.set(c,".framebufferWidth",c+".drawingBufferWidth");b.set(c,".framebufferHeight",c+".drawingBufferHeight");return null})}if("framebuffer"in a){var g=a.framebuffer;return e(g,function(a,b){var c=a.invoke(b,g),G=a.shared,d=G.framebuffer,c=b.def(d,".getFramebuffer(",c,")");b.set(d,".next",c);G=G.context;b.set(G,".framebufferWidth",c+"?"+c+".width:"+G+".drawingBufferWidth");b.set(G,".framebufferHeight",
c+"?"+c+".height:"+G+".drawingBufferHeight");return c})}return null}function ga(a,b){function c(a){if(a in d){var r=d[a];a=!0;var R=r.x|0,n=r.y|0,m,h;"w"in r?m=r.w|0:a=!1;"h"in r?h=r.h|0:a=!1;return new g(a&&b&&b.thisDep,a&&b&&b.contextDep,a&&b&&b.propDep,function(a,b){var c=a.shared.context,d=m;"w"in r||(d=b.def(c,".","framebufferWidth","-",R));var G=h;"h"in r||(G=b.def(c,".","framebufferHeight","-",n));return[R,n,d,G]})}if(a in l){var q=l[a];a=e(q,function(a,b){var c=a.invoke(b,q),d=a.shared.context,
G=b.def(c,".x|0"),e=b.def(c,".y|0"),g=b.def('"w" in ',c,"?",c,".w|0:","(",d,".","framebufferWidth","-",G,")"),c=b.def('"h" in ',c,"?",c,".h|0:","(",d,".","framebufferHeight","-",e,")");return[G,e,g,c]});b&&(a.thisDep=a.thisDep||b.thisDep,a.contextDep=a.contextDep||b.contextDep,a.propDep=a.propDep||b.prpoDep);return a}return b?new g(b.thisDep,b.contextDep,b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),b.def(c,".","framebufferHeight")]}):null}var d=a["static"],
l=a.dynamic,r=c("viewport");if(r)var n=r,r=new g(r.thisDep,r.contextDep,r.propDep,function(a,b){var c=n.append(a,b),d=a.shared.context;b.set(d,".viewportWidth",c[2]);b.set(d,".viewportHeight",c[3]);return c});return{viewport:r,scissor_box:c("scissor.box")}}function ha(a){function b(a){if(a in r){var d=C.id(r[a]);a=c(function(){return d});a.id=d;return a}if(a in l){var g=l[a];return e(g,function(a,b){var c=a.invoke(b,g);return b.def(a.shared.strings,".id(",c,")")})}return null}var r=a["static"],l=
a.dynamic,n=b("frag"),m=b("vert"),h=null;d(n)&&d(m)?(h=P.program(m.id,n.id),a=c(function(a,b){return a.link(h)})):a=new g(n&&n.thisDep||m&&m.thisDep,n&&n.contextDep||m&&m.contextDep,n&&n.propDep||m&&m.propDep,function(a,b){var c=a.shared.shader,d;d=n?n.append(a,b):b.def(c,".","frag");var e;e=m?m.append(a,b):b.def(c,".","vert");return b.def(c+".program("+e+","+d+")")});return{frag:n,vert:m,progVar:a,program:h}}function oa(b){function r(a,b){if(a in l){var d=l[a]|0;return c(function(a,c){b&&(a.OFFSET=
d);return d})}if(a in n){var g=n[a];return e(g,function(a,c){var d=a.invoke(c,g);b&&(a.OFFSET=d);return d})}return b&&m?c(function(a,b){a.OFFSET="0";return 0}):null}var l=b["static"],n=b.dynamic,m=function(){if("elements"in l){var b=l.elements;a(b)?b=H.getElements(H.create(b)):b&&(b=H.getElements(b));var d=c(function(a,c){if(b){var d=a.link(b);return a.ELEMENTS=d}return a.ELEMENTS=null});d.value=b;return d}if("elements"in n){var g=n.elements;return e(g,function(a,b){var c=a.shared,d=c.isBufferArgs,
c=c.elements,G=a.invoke(b,g),e=b.def("null"),d=b.def(d,"(",G,")"),G=a.cond(d).then(e,"=",c,".createStream(",G,");")["else"](e,"=",c,".getElements(",G,");");b.entry(G);b.exit(a.cond(d).then(c,".destroyStream(",e,");"));return a.ELEMENTS=e})}return null}(),h=r("offset",!0);return{elements:m,primitive:function(){if("primitive"in l){var a=l.primitive;return c(function(b,c){return t[a]})}if("primitive"in n){var b=n.primitive;return e(b,function(a,c){var d=a.constants.primTypes,e=a.invoke(c,b);return c.def(d,
"[",e,"]")})}return m?d(m)?m.value?c(function(a,b){return b.def(a.ELEMENTS,".primType")}):c(function(){return 4}):new g(m.thisDep,m.contextDep,m.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in l){var a=l.count|0;return c(function(){return a})}if("count"in n){var b=n.count;return e(b,function(a,c){return a.invoke(c,b)})}return m?d(m)?m?h?new g(h.thisDep,h.contextDep,h.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):
c(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):c(function(){return-1}):new g(m.thisDep||h.thisDep,m.contextDep||h.contextDep,m.propDep||h.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")}):null}(),instances:r("instances",!1),offset:h}}function ca(a){var b=a["static"],d=a.dynamic,g={};ka.forEach(function(a){function l(G,n){if(a in b){var R=G(b[a]);g[r]=c(function(){return R})}else if(a in d){var m=d[a];g[r]=e(m,
function(a,b){return n(a,b,a.invoke(b,m))})}}var r=M(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return l(function(a){return a},function(a,b,c){return c});case "depth.func":return l(function(a){return w[a]},function(a,b,c){return b.def(a.constants.compareFuncs,"[",c,"]")});case "depth.range":return l(function(a){return a},function(a,
b,c){a=b.def("+",c,"[0]");b=b.def("+",c,"[1]");return[a,b]});case "blend.func":return l(function(a){return[v["srcRGB"in a?a.srcRGB:a.src],v["dstRGB"in a?a.dstRGB:a.dst],v["srcAlpha"in a?a.srcAlpha:a.src],v["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,c){function d(a,g){var l=b.def('"',a,g,'" in ',c,"?",c,".",a,g,":",c,".",a);return b.def(e,"[",l,"]")}var e=a.constants.blendFuncs;a=d("src","RGB");var g=d("src","Alpha"),l=d("dst","RGB"),r=d("dst","Alpha");return[a,l,g,r]});case "blend.equation":return l(function(a){if("string"===
typeof a)return[V[a],V[a]];if("object"===typeof a)return[V[a.rgb],V[a.alpha]]},function(a,b,c){var d=a.constants.blendEquations,e=b.def(),g=b.def();a=a.cond("typeof ",c,'==="string"');a.then(e,"=",g,"=",d,"[",c,"];");a["else"](e,"=",d,"[",c,".rgb];",g,"=",d,"[",c,".alpha];");b(a);return[e,g]});case "blend.color":return l(function(a){return m(4,function(b){return+a[b]})},function(a,b,c){return m(4,function(a){return b.def("+",c,"[",a,"]")})});case "stencil.mask":return l(function(a){return a|0},function(a,
b,c){return b.def(c,"|0")});case "stencil.func":return l(function(a){return[w[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,c){a=b.def('"cmp" in ',c,"?",a.constants.compareFuncs,"[",c,".cmp]",":",7680);var d=b.def(c,".ref|0");b=b.def('"mask" in ',c,"?",c,".mask|0:-1");return[a,d,b]});case "stencil.opFront":case "stencil.opBack":return l(function(b){return["stencil.opBack"===a?1029:1028,u[b.fail||"keep"],u[b.zfail||"keep"],u[b.pass||"keep"]]},function(b,c,d){function e(a){return c.def('"',
a,'" in ',d,"?",g,"[",d,".",a,"]:",7680)}var g=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,e("fail"),e("zfail"),e("pass")]});case "polygonOffset.offset":return l(function(a){return[a.factor|0,a.units|0]},function(a,b,c){a=b.def(c,".factor|0");b=b.def(c,".units|0");return[a,b]});case "cull.face":return l(function(a){var b=0;"front"===a?b=1028:"back"===a&&(b=1029);return b},function(a,b,c){return b.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return l(function(a){return a},
function(a,b,c){return c});case "frontFace":return l(function(a){return q[a]},function(a,b,c){return b.def(c+'==="cw"?2304:2305')});case "colorMask":return l(function(a){return a.map(function(a){return!!a})},function(a,b,c){return m(4,function(a){return"!!"+c+"["+a+"]"})});case "sample.coverage":return l(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,b,c){a=b.def('"value" in ',c,"?+",c,".value:1");b=b.def("!!",c,".invert");return[a,b]})}});return g}function ia(a){var b=a["static"],
d=a.dynamic,g={};Object.keys(b).forEach(function(a){var d=b[a],e;if("number"===typeof d||"boolean"===typeof d)e=c(function(){return d});else if("function"===typeof d&&("texture2d"===d._reglType||"textureCube"===d._reglTYpe))e=c(function(a){return a.link(d)});else if(Array.isArray(d)||h(d))e=c(function(a){return a.global.def("[",m(d.length,function(a){return d[a]}),"]")});e.value=d;g[a]=e});Object.keys(d).forEach(function(a){var b=d[a];g[a]=e(b,function(a,c){return a.invoke(c,b)})});return g}function T(b){var d=
b["static"],g=b.dynamic,l={};Object.keys(d).forEach(function(b){var e=d[b],g=C.id(b),r=new la;if(a(e))r.state=1,r.buffer=F.getBuffer(F.create(e,34962,!1)),r.type=r.buffer.dtype;else{var m=F.getBuffer(e);if(m)r.state=1,r.buffer=m,r.type=m.dtype;else if(e.constant){var R=e.constant;r.state=2;"number"===typeof R?r.x=R:A.forEach(function(a,b){b<R.length&&(r[a]=R[b])})}else{var m=F.getBuffer(e.buffer),h=e.offset|0,q=e.stride|0,f=e.size|0,u=!!e.normalized,t=0;"type"in e&&(t=n[e.type]);e=e.divisor|0;r.buffer=
m;r.state=1;r.size=f;r.normalized=u;r.type=t||m.dtype;r.offset=h;r.stride=q;r.divisor=e}}l[b]=c(function(a,b){var c=a.attribCache;if(g in c)return c[g];var d={isStream:!1};Object.keys(r).forEach(function(a){d[a]=r[a]});r.buffer&&(d.buffer=a.link(r.buffer));return c[g]=d})});Object.keys(g).forEach(function(a){var b=g[a];l[a]=e(b,function(a,c){function d(a){c(n[a],"=",e,".",a,"|0;")}var e=a.invoke(c,b),g=a.shared,r=g.isBufferArgs,l=g.buffer,n={isStream:c.def(!1)},m=new la;m.state=1;Object.keys(m).forEach(function(a){n[a]=
c.def(""+m[a])});var R=n.buffer,h=n.type;c("if(",r,"(",e,")){",n.isStream,"=true;",R,"=",l,".createStream(",34962,",",e,");",h,"=",R,".dtype;","}else{",R,"=",l,".getBuffer(",e,");","if(",R,"){",h,"=",R,".dtype;","}else if(",e,".constant){",n.state,"=",2,";",A.map(function(a,b){return n[a]+"="+e+".length>="+b+"?"+e+"["+b+"]:0;"}).join(""),"}else{",R,"=",l,".getBuffer(",e,".buffer);",h,'="type" in ',e,"?",g.glTypes,"[",e,".type]:",R,".dtype;",n.normalized,"=!!",e,".normalized;");d("size");d("offset");
d("stride");d("divisor");c("}}");return n})});return l}function N(a){var b=a["static"],d=a.dynamic,g={};Object.keys(b).forEach(function(a){var d=b[a];g[a]=c(function(a,b){return"number"===typeof d||"boolean"===typeof d?""+d:a.link(d)})});Object.keys(d).forEach(function(a){var b=d[a];g[a]=e(b,function(a,c){return a.invoke(c,b)})});return g}function U(a,b,c){var d=a.shared.context,e=a.scope();Object.keys(c).forEach(function(g){b.save(d,"."+g);e(d,".",g,"=",c[g].append(a,b),";")});b(e)}function ma(a,
b,c){var d=a.shared,e=d.gl,g=d.framebuffer,r;aa&&(r=b.def(d.extensions,".webgl_draw_buffers"));var l=a.constants,d=l.drawBuffer,l=l.backBuffer;a=c?c.append(a,b):b.def(g,".next");b("if(",g,".dirty||",a,"!==",g,".cur){","if(",a,"){",e,".bindFramebuffer(",36160,",",a,".framebuffer);");aa&&b(r,".drawBuffersWEBGL(",d,"[",a,".colorAttachments.length]);");b("}else{",e,".bindFramebuffer(",36160,",null);");aa&&b(r,".drawBuffersWEBGL(",l,");");b("}",g,".cur=",a,";",g,".dirty=false;","}")}function ja(a,b,c){var d=
a.shared,e=d.gl,g=a.current,l=a.next,n=d.current,h=d.next,q=a.cond(n,".dirty");ka.forEach(function(b){b=M(b);if(!(b in c.state)){var d,f;if(b in l){d=l[b];f=g[b];var u=m(r[b].length,function(a){return q.def(d,"[",a,"]")});q(a.cond(u.map(function(a,b){return a+"==="+f+"["+b+"]"}).join("&&")).then(e,".",fa[b],"(",u,");",u.map(function(a,b){return f+"["+b+"]="+a}).join(";"),";"))}else d=q.def(h,".",b),u=a.cond(d,"!==",n,".",b),q(u),b in ea?u(a.cond(d).then(e,".enable(",ea[b],");")["else"](e,".disable(",
ea[b],");"),n,".",b,"=",d,";"):u(e,".",fa[b],"(",d,");",n,".",b,"=",d,";")}});0===Object.keys(c.state).length&&q(n,".dirty=false;");b(q)}function pa(a,c,e,g){var l=a.shared,r=a.current,n=l.current,m=l.gl;b(Object.keys(e)).forEach(function(b){var l=e[b];if(!g||g(l)){var h=l.append(a,c);if(ea[b]){var q=ea[b];d(l)?h?c(m,".enable(",q,");"):c(m,".disable(",q,");"):c(a.cond(h).then(m,".enable(",q,");")["else"](m,".disable(",q,");"));c(n,".",b,"=",h,";")}else if(Array.isArray(h)){var f=r[b];c(m,".",fa[b],
"(",h,");",h.map(function(a,b){return f+"["+b+"]="+a}).join(";"),";")}else c(m,".",fa[b],"(",h,");",n,".",b,"=",h,";")}})}function na(a,b){da&&!a.instancing&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function qa(a,b,c,d,e){function g(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function l(c,d,e){function g(){b("if(!",q,".pointer){",m,".enableVertexAttribArray(",
h,");",q,".pointer=true;}");var c=e.type,l;l=e.size?b.def(e.size,"||",d):d;b("if(",q,".type!==",c,"||",q,".size!==",l,"||",C.map(function(a){return q+"."+a+"!=="+e[a]}).join("||"),"){",m,".bindBuffer(",34962,",",f,".buffer);",m,".vertexAttribPointer(",[h,l,c,e.normalized,e.stride,e.offset],");",q,".type=",c,";",q,".size=",l,";",C.map(function(a){return q+"."+a+"="+e[a]+";"}).join(""),"}");da&&(c=e.divisor,b("if(",q,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[h,c],");",q,".divisor=",
c,";}"))}function n(){b("if(",q,".pointer){",m,".disableVertexAttribArray(",h,");",q,".pointer=false;","}if(",A.map(function(a,b){return q+"."+a+"!=="+u[b]}).join("||"),"){",m,".vertexAttrib4f(",h,",",u,");",A.map(function(a,b){return q+"."+a+"="+u[b]+";"}).join(""),"}")}var m=r.gl,h=b.def(c,".location"),q=b.def(r.attributes,"[",h,"]");c=e.state;var f=e.buffer,u=[e.x,e.y,e.z,e.w],C=["buffer","normalized","offset","stride"];1===c?g():2===c?n():(b("if(",c,"===",1,"){"),g(),b("}else{"),n(),b("}"))}var r=
a.shared;d.forEach(function(d){var r=d.name,n=c.attributes[r],m;if(n){if(!e(n))return;m=n.append(a,b)}else{if(!e(E))return;var h=a.scopeAttrib(r);m={};Object.keys(new la).forEach(function(a){m[a]=b.def(h,".",a)})}l(a.link(d),g(d.info.type),m)})}function W(a,b,c,d,e){for(var g=a.shared,l=g.gl,r,n=0;n<d.length;++n){var m=d[n],h=m.name,q=m.info.type,f=c.uniforms[h],m=a.link(m)+".location";if(f){if(!e(f))continue;if(f["static"]){h=f.value;if(35678===q||35680===q)q=a.link(h._texture),b(l,".uniform1i(",
m,q+".bind());"),b.exit(q,".unbind()");else if(35674===q||35675===q||35676===q)h=a.global.def("["+h+"]"),f=2,35675===q?f=3:35676===q&&(f=4),b(l,".uniformMatrix",f,"fv(",m,",false,",h,");");else{switch(q){case 5126:r="1f";break;case 35664:r="2f";break;case 35665:r="3f";break;case 35666:r="4f";break;case 35670:r="1i";break;case 5124:r="1i";break;case 35671:r="2i";break;case 35667:r="2i";break;case 35672:r="3i";break;case 35668:r="3i";break;case 35673:r="4i";break;case 35669:r="4i"}b(l,".uniform",r,
"(",m,",",h,");")}continue}else h=f.append(a,b)}else{if(!e(E))continue;h=b.def(g.uniforms,"[",C.id(h),"]")}f=",";switch(q){case 35678:case 35680:q=b.def(h,"._texture");b(l,".uniform1i(",m,",",q,".bind());");b.exit(q,".unbind();");continue;case 5124:case 35670:r="1i";break;case 35667:case 35671:r="2iv";break;case 35668:case 35672:r="3iv";break;case 35669:case 35673:r="4iv";break;case 5126:r="1f";break;case 35664:r="2fv";break;case 35665:r="3fv";break;case 35666:r="4fv";break;case 35674:r="Matrix2fv";
f=",false,";break;case 35675:r="Matrix3fv";f=",false,";break;case 35676:r="Matrix4fv",f=",false,"}b(l,".uniform",r,"(",m,f,h,");")}}function X(a,b,c,e){function g(d){var e=q[d];return e?e.batchStatic?e.append(a,b):e.append(a,c):b.def(h,".",d)}function r(){function a(){c(k,".drawElementsInstancedANGLE(",[u,C,v,A+"<<(("+v+"-5121)>>1)",t],");")}function b(){c(k,".drawArraysInstancedANGLE(",[u,A,C,t],");")}f?ka?a():(c("if(",f,"){"),a(),c("}else{"),b(),c("}")):b()}function l(){function a(){c(m+".drawElements("+
[u,C,v,A+"<<(("+v+"-5121)>>1)"]+");")}function b(){c(m+".drawArrays("+[u,A,C]+");")}f?ka?a():(c("if(",f,"){"),a(),c("}else{"),b(),c("}")):b()}var n=a.shared,m=n.gl,h=n.draw,q=e.draw,f=function(){var d=q.elements,e=b;d?(d.batchStatic||(e=c),d=d.append(a,e)):d=e.def(h,".","elements");d&&e("if("+d+")"+m+".bindBuffer(34963,"+d+".buffer.buffer);");return d}(),u=g("primitive"),A=g("offset"),C=function(){var d=q.count,e=b;d?(d.batchStatic||(e=c),d=d.append(a,e)):d=e.def(h,".","count");return d}();if("number"===
typeof C){if(0===C)return}else c("if(",C,"){"),c.exit("}");var t,k;da&&(t=g("instances"),k=a.instancing);var v=f+".type",ka=q.elements&&d(q.elements);da&&("number"!==typeof t||0<=t)?"string"===typeof t?(c("if(",t,">0){"),r(),c("}else if(",t,"<0){"),l(),c("}")):r():l()}function Y(a,b,c,d,e){b=ba();e=b.proc("body",e);da&&(b.instancing=e.def(b.shared.extensions,".angle_instanced_arrays"));a(b,e,c,d);return b.compile().body}function va(a,b,c,d){na(a,b);qa(a,b,c,d.attributes,function(){return!0});W(a,
b,c,d.uniforms,function(){return!0});X(a,b,b,c)}function wa(a,b){var c=a.proc("draw",1);na(a,c);U(a,c,b.context);ma(a,c,b.framebuffer);ja(a,c,b);pa(a,c,b.state);var d=b.shader.progVar.append(a,c);c(a.shared.gl,".useProgram(",d,".program);");if(b.shader.program)va(a,c,b,b.shader.program);else{var e=a.global.def("{}"),g=c.def(d,".id"),r=c.def(e,"[",g,"]");c(a.cond(r).then(r,".call(this,a0);")["else"](r,"=",e,"[",g,"]=",a.link(function(c){return Y(va,a,b,c,1)}),"(",d,");",r,".call(this,a0);"))}0<Object.keys(b.state).length&&
c(a.shared.current,".dirty=true;")}function za(a,b,c,d){function e(){return!0}a.batchId="a1";na(a,b);qa(a,b,c,d.attributes,e);W(a,b,c,d.uniforms,e);X(a,b,b,c)}function ra(a,b,c,d){function e(a){return a.contextDep&&r||a.propDep}function g(a){return!e(a)}na(a,b);var r=c.contextDynamic,l=b.def(),n=b.def();a.shared.props=n;a.batchId=l;var m=a.scope(),h=a.scope();b(m.entry,"for(",l,"=0;",l,"<","a1",";++",l,"){",n,"=","a0","[",l,"];",h,"}",m.exit);c.needsContext&&U(a,h,c.context);c.needsFramebuffer&&ma(a,
h,c.framebuffer);pa(a,h,c.state,e);d?(qa(a,m,c,d.attributes,g),qa(a,h,c,d.attributes,e),W(a,m,c,d.uniforms,g),W(a,h,c,d.uniforms,e),X(a,m,h,c)):(b=a.global.def("{}"),d=c.shader.progVar.append(a,h),n=h.def(d,".id"),m=h.def(b,"[",n,"]"),h(a.shared.gl,".useProgram(",d,".program);","if(!",m,"){",m,"=",b,"[",n,"]=",a.link(function(b){return Y(za,a,c,b,2)}),"(",d,");}",m,".call(this,a0[",l,"],",l,");"))}function xa(a,b){var c=a.proc("batch",2);a.batchId="0";na(a,c);var d=!1,e=!0;Object.keys(b.context).forEach(function(a){d=
d||b.context[a].propDep});d||(U(a,c,b.context),e=!1);var g=b.framebuffer,r=!1;g&&(g.propDep?d=r=!0:g.contextDep&&d&&(r=!0),r||ma(a,c,g));b.state.viewport&&b.state.viewport.propDynamic&&(d=!0);ja(a,c,b);pa(a,c,b.state,function(a){return!(a.contextDep&&d||a.propDep)});b.contextDep=d;b.needsContext=e;b.needsFramebuffer=r;e=b.shader.progVar;if(e.contextDep&&d||e.propDep)ra(a,c,b,null);else if(e=e.append(a,c),c(a.shared.gl,".useProgram(",e,".program);"),b.shader.program)ra(a,c,b,b.shader.program);else{var g=
a.global.def("{}"),r=c.def(e,".id"),l=c.def(g,"[",r,"]");c(a.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",g,"[",r,"]=",a.link(function(c){return Y(ra,a,b,c,2)}),"(",e,");",l,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}function ta(a,c){function d(b){var r=c.shader[b];r&&e.set(g.shader,"."+b,r.append(a,e))}var e=a.proc("scope",3);a.batchId="a2";var g=a.shared,r=g.current;U(a,e,c.context);c.framebuffer&&c.framebuffer.append(a,e);b(Object.keys(c.state)).forEach(function(b){var d=
c.state[b].append(a,e);Array.isArray(d)?d.forEach(function(c,d){e.set(a.next[b],"["+d+"]",c)}):e.set(g.next,"."+b,d)});["elements","offset","count","instances","primitive"].forEach(function(b){var d=c.draw[b];d&&e.set(g.draw,"."+b,""+d.append(a,e))});Object.keys(c.uniforms).forEach(function(b){e.set(g.uniforms,"["+C.id(b)+"]",c.uniforms[b].append(a,e))});Object.keys(c.attributes).forEach(function(b){var d=c.attributes[b].append(a,e),g=a.scopeAttrib(b);Object.keys(new la).forEach(function(a){e.set(g,
"."+a,d[a])})});d("vert");d("frag");0<Object.keys(c.state).length&&(e(r,".dirty=true;"),e.exit(r,".dirty=true;"));e("a1(",a.shared.context,",a0,0);")}var la=S.Record,V={add:32774,subtract:32778,"reverse subtract":32779};k.ext_blend_minmax&&(V.min=32775,V.max=32776);var da=k.angle_instanced_arrays,aa=k.webgl_draw_buffers,r={dirty:!0},sa={},ka=[],ea={},fa={};K("dither",3024);K("blend.enable",3042);L("blend.color","blendColor",[0,0,0,0]);L("blend.equation","blendEquationSeparate",[32774,32774]);L("blend.func",
"blendFuncSeparate",[1,0,1,0]);K("depth.enable",2929,!0);L("depth.func","depthFunc",513);L("depth.range","depthRange",[0,1]);L("depth.mask","depthMask",!0);L("colorMask","colorMask",[!0,!0,!0,!0]);K("cull.enable",2884);L("cull.face","cullFace",1029);L("frontFace","frontFace",2305);L("lineWidth","lineWidth",1);K("polygonOffset.enable",32823);L("polygonOffset.offset","polygonOffset",[0,0]);K("sample.alpha",32926);K("sample.enable",32928);L("sample.coverage","sampleCoverage",[1,!1]);K("stencil.enable",
2960);L("stencil.mask","stencilMask",-1);L("stencil.func","stencilFunc",[519,0,-1]);L("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);L("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);K("scissor.enable",3089);L("scissor.box","scissor",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);L("viewport","viewport",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);var Aa={gl:f,context:I,strings:C,next:sa,current:r,draw:Q,elements:H,buffer:F,shader:P,attributes:S.state,uniforms:J,
framebuffer:O,extensions:k,isBufferArgs:a},ua={primTypes:t,compareFuncs:w,blendFuncs:v,blendEquations:V,stencilOps:u,glTypes:n,orientationType:q};aa&&(ua.backBuffer=[1029],ua.drawBuffer=m(p.maxDrawbuffers,function(a){return 0===a?[0]:m(a,function(a){return 36064+a})}));var Ba=0;return{next:sa,current:r,procs:function(){var a=ba(),b=a.proc("poll"),c=a.proc("refresh"),d=a.block();b(d);c(d);var e=a.shared,g=e.gl,l=e.next,n=e.current;d(n,".dirty=false;");ma(a,b);c(e.framebuffer,".dirty=true;");ma(a,c);
Object.keys(ea).forEach(function(e){var r=ea[e],m=d.def(l,".",e),h=a.block();h("if(",m,"){",g,".enable(",r,")}else{",g,".disable(",r,")}",n,".",e,"=",m,";");c(h);b("if(",m,"!==",n,".",e,"){",h,"}")});Object.keys(fa).forEach(function(e){var h=fa[e],q=r[e],f,u,C=a.block();C(g,".",h,"(");Array.isArray(q)?(h=q.length,f=a.global.def(l,".",e),u=a.global.def(n,".",e),C(m(h,function(a){return f+"["+a+"]"}),");",m(h,function(a){return u+"["+a+"]="+f+"["+a+"];"}).join("")),b("if(",m(h,function(a){return f+
"["+a+"]!=="+u+"["+a+"]"}).join("||"),"){",C,"}")):(f=d.def(l,".",e),u=d.def(n,".",e),C(f,");",n,".",e,"=",f,";"),b("if(",f,"!==",u,"){",C,"}"));c(C)});return a.compile()}(),compile:function(a,b,c,d){var e=ba(),g;g=Z(a);var r=ga(a,g),l=oa(a),n=ca(a);a=ha(a);var m=r.viewport;m&&(n.viewport=m);m=M("scissor.box");(r=r[m])&&(n[m]=r);r=0<Object.keys(n).length;g={framebuffer:g,draw:l,shader:a,state:n,dirty:r};g.uniforms=ia(c);g.attributes=T(b);g.context=N(d);wa(e,g);ta(e,g);xa(e,g);return e.compile()}}}},
{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":20,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/loop":24}],9:[function(f,k,p){function a(a,b){this.id=d++;this.type=a;this.data=b}function b(a){if(0===a.length)return[];var d=a.charAt(0),g=a.charAt(a.length-1);if(1<a.length&&d===g&&('"'===d||"'"===d))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(d=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return b(a.substr(0,d.index)).concat(b(d[1])).concat(b(a.substr(d.index+
d[0].length)));d=a.split(".");if(1===d.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(g=0;g<d.length;++g)a=a.concat(b(d[g]));return a}function g(a){return"["+b(a).join("][")+"]"}var d=0;k.exports={define:function(b,d){switch(typeof d){case "boolean":case "number":case "string":return new a(b,g(d+""));case "undefined":return new a(b|128,null)}},isDynamic:function(b){return"function"===typeof b&&!b._reglType||b instanceof a},unbox:function(b,d){if(b instanceof a){if(b.type&
128)return new a(b.type&-129,g(d))}else if("function"===typeof b)return new a(0,b);return b},accessor:g}},{}],10:[function(f,k,p){var a=f("./util/is-typed-array"),b=f("./util/is-ndarray"),g=f("./constants/primitives.json"),d=f("./constants/usage.json");k.exports=function(c,e,l){function m(a){this.buffer=a;this.primType=4;this.type=this.vertCount=0}function h(c,d,g,m,h,q,f){(q=f)||a(d)&&(!b(d)||a(d.data))||(q=e.oes_element_index_uint?5125:5123);c.buffer.bind();l._initBuffer(c.buffer,d,g,q,3);d=f;if(!f){switch(c.buffer.dtype){case 5121:case 5120:d=
5121;break;case 5123:case 5122:d=5123;break;case 5125:case 5124:d=5125}c.buffer.dtype=d}c.type=d;0>h&&(h=c.buffer.byteLength,5123===d?h>>=1:5125===d&&(h>>=2));c.vertCount=h;h=m;0>m&&(h=4,m=c.buffer.dimension,1===m&&(h=0),2===m&&(h=1),3===m&&(h=4));c.primType=h}var f={uint8:5121,uint16:5123};e.oes_element_index_uint&&(f.uint32=5125);m.prototype.bind=function(){this.buffer.bind()};var t=[];return{create:function(e){function t(e){if(e)if("number"===typeof e)k(e),w.primType=4,w.vertCount=e|0,w.type=5121;
else{var l=null,m=35044,n=-1,p=-1,D=0,z=0;Array.isArray(e)||a(e)||b(e)?l=e:("data"in e&&(l=e.data),"usage"in e&&(m=d[e.usage]),"primitive"in e&&(n=g[e.primitive]),"count"in e&&(p=e.count|0),"length"in e&&(D=e.length|0),"type"in e&&(z=f[e.type]));l?h(w,l,m,n,p,D,z):(e=w.buffer,e.bind(),c.bufferData(34963,D,m),e.dtype=z||5121,e.usage=m,e.dimension=3,e.byteLength=D,w.primType=0>n?4:n,w.vertCount=0>p?0:p,w.type=e.dtype)}else k(),w.primType=4,w.vertCount=0,w.type=5121;return t}var k=l.create(null,34963,
!0),w=new m(k._buffer);t(e);t._reglType="elements";t._elements=w;t.subdata=function(a,b){k.subdata(a,b);return t};t.destroy=function(){k.destroy();w.buffer=null};return t},createStream:function(a){var b=t.pop();b||(b=new m(l.create(null,34963,!0)._buffer));h(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){t.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof m?a._elements:null}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":22,
"./util/is-typed-array":23}],11:[function(f,k,p){k.exports=function(a){function b(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(b){try{g[b]=
a.getExtension(b)}catch(c){}})}var g={};b();return{extensions:g,refresh:b}}},{}],12:[function(f,k,p){var a=f("./util/values"),b=f("./util/extend");k.exports=function(g,d,c,e,l){function m(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function h(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function f(a,b){var c=b.width,d=b.height;if(a.texture)var e=a.texture._texture,g=Math.max(1,e.params.width>>a.level),l=Math.max(1,
e.params.height>>a.level),c=c||g,d=d||l;else e=a.renderbuffer._renderbuffer,c=c||e.width,d=d||e.height;e.refCount+=1;b.width=c;b.height=d}function t(a,b){b?b.texture?g.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):g.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):g.framebufferTexture2D(36160,a,3553,null,0)}function n(a){var b=3553,c=0,d=null,e=null;"object"===typeof a&&("level"in a&&(c=a.level|0),"target"in a&&(b=a.target|0));var g=a._reglType;
"texture"===g?d=a:"renderbuffer"===g&&(e=a,b=36161,c=0);return new m(b,c,d,e)}function k(a){return a&&(a.texture||a.renderbuffer)}function v(){this.id=F++;H[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function w(a){g.isFramebuffer(a.framebuffer)||(a.framebuffer=g.createFramebuffer());q.dirty=!0;g.bindFramebuffer(36160,a.framebuffer);for(var b=
a.colorAttachments,e=0;e<b.length;++e)t(36064+e,b[e]);for(e=b.length;e<c.maxColorAttachments;++e)t(36064+e,null);t(36096,a.depthAttachment);t(36128,a.stencilAttachment);t(33306,a.depthStencilAttachment);d.webgl_draw_buffers&&d.webgl_draw_buffers.drawBuffersWEBGL(z[b.length]);g.checkFramebufferStatus(36160)}function u(a){a=a.framebuffer;g.isFramebuffer(a)&&g.deleteFramebuffer(a)}var q={current:null,next:null,dirty:!1},E={rgba:6408},x={rgba4:32854,rgb565:36194,"rgb5 a1":32855};d.ext_srgb&&(x.srgba=
35907);d.ext_color_buffer_half_float&&(x.rgba16f=34842,x.rgb16f=34843);d.webgl_color_buffer_float&&(x.rgba32f=34836);var p=[],D=[];d.webgl_depth_texture&&(p.push(6402),D.push(34041));b(b({},E),x);a(E);a(x);x=5121;p={uint8:5121};d.oes_texture_half_float&&(x=p["half float"]=36193);d.oes_texture_float&&(x=p["float"]=5126);p.best=x;var z=function(){for(var a=Array(c.maxDrawbuffers),b=0;b<=c.maxDrawbuffers;++b)for(var d=a[b]=Array(b),e=0;e<b;++e)d[e]=36064+e;return a}(),F=0,H={};return b(q,{getFramebuffer:function(a){return"function"===
typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof v)?a:null},create:function(a){function b(a){var d,q=a||{},t=a=0;if("shape"in q){var u=q.shape;a=u[0];t=u[1]}else"radius"in q&&(a=t=q.radius),"width"in q&&(a=q.width),"height"in q&&(t=q.height);var v=null,u=!1;if("colorBuffers"in q||"colorBuffer"in q){v=q.colorBuffers||q.colorBuffer;Array.isArray(v)||(v=[v]);c.width=a;c.height=t;v=v.map(n);for(d=0;d<v.length;++d)f(v[d],c);a=c.width;t=c.height}else{var x=!0,p="rgba",z="uint8",D=1,
u=!0;c.width=a=a||g.drawingBufferWidth;c.height=t=t||g.drawingBufferHeight;"format"in q&&(p=q.format,x=p in E);"type"in q&&(z=q.type);"colorCount"in q&&(D=q.colorCount|0);if(c.ownsColor)for(v=c.colorAttachments;v.length>D;)h(v.pop());else v=[];for(d=0;d<v.length;++d){var B;a:{B=v[d];var y=x,F=p,H=a,T=t;if(B.texture){var N=B.texture;if(y){N({format:F,type:z,width:H,height:T});N._texture.refCount+=1;B=!0;break a}}else if(N=B.renderbuffer,!y){N({format:F,width:H,height:T});N._renderbuffer.refCount+=
1;B=!0;break a}h(B);B=!1}B||(v[d--]=v[v.length-1],v.pop())}for(;v.length<D;)x?v.push(new m(3553,0,e.create2D({format:p,type:z,width:a,height:t},3553),null)):v.push(new m(36161,0,null,l.create({format:p,width:a,height:t})))}c.width=a;c.height=t;p=x=d=null;z=!1;"depthBuffer"in q&&(d=n(q.depthBuffer));"stencilBuffer"in q&&(x=n(q.stencilBuffer));"depthStencilBuffer"in q&&(p=n(q.depthStencilBuffer));if(d||x||p)f(d||x||p,c);else if(D=!0,y=B=!1,"depth"in q&&(D=!!q.depth),"stencil"in q&&(B=!!q.stencil),"depthTexture"in
q&&(y=!!q.depthTexture),q=c.depthAttachment||c.stencilAttachment||c.depthStencilAttachment,F=null,D||B)z=!0,y?(y=B?"depth stencil":"depth",c.ownsDepthStencil&&q.texture?(q.texture({format:y,width:a,height:t}),q.texture._texture.refCount+=1,F=q):F=new m(3553,0,e.create({format:y,width:a,height:t},3553),null)):(y=D?B?"depth stencil":"depth":"stencil",c.ownsDepthStencil&&q.renderbuffer?(q.renderbuffer({format:y,width:a,height:t}),q.renderbuffer._renderbuffer.refCount+=1,F=q):F=new m(36161,0,null,l.create({format:y,
width:a,height:t}))),D?B?p=F:d=F:x=F;a=c;a.colorAttachments.forEach(h);h(a.depthAttachment);h(a.stencilAttachment);h(a.depthStencilAttachment);c.colorAttachments=v;c.depthAttachment=d;c.stencilAttachment=x;c.depthStencilAttachment=p;c.ownsColor=u;c.ownsDepthStencil=z;b.color=v.map(k);b.depth=k(d);b.stencil=k(x);b.depthStencil=k(p);w(c);b.width=c.width;b.height=c.height;return b}var c=new v;b(a);b._reglType="framebuffer";b._framebuffer=c;b._destroy=function(){u(c)};return b},clear:function(){a(H).forEach(u)},
refresh:function(){a(H).forEach(w)}})}},{"./util/extend":21,"./util/values":28}],13:[function(f,k,p){k.exports=function(a,b){var g=1;b.ext_texture_filter_anisotropic&&(g=a.getParameter(34047));var d=1,c=1;b.webgl_draw_buffers&&(d=a.getParameter(34852),c=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),
maxAnisotropic:g,maxDrawbuffers:d,maxColorAttachments:c,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),
maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}},{}],14:[function(f,k,p){var a=f("./util/is-typed-array");k.exports=function(b,g,d){return function(c){var e=c||{};a(c)?e={data:e}:2===arguments.length?e={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof c&&(e={});g();var l=e.x||0,m=e.y||0,h=e.width||d.viewportWidth,f=e.height||d.viewportHeight,e=e.data||new Uint8Array(h*f*4);b.pixelStorei(3333,
4);b.readPixels(l,m,h,f,6408,5121,e);return e}}},{"./util/is-typed-array":23}],15:[function(f,k,p){var a=f("./util/values");k.exports=function(b,g,d){function c(){this.id=h++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function e(a){b.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=b.createRenderbuffer());b.bindRenderbuffer(36161,a.renderbuffer);b.renderbufferStorage(36161,a.format,a.width,a.height)}function l(a){var c=a.renderbuffer;b.bindRenderbuffer(36161,
null);b.isRenderbuffer(c)&&b.deleteRenderbuffer(c);a.renderbuffer=null;a.refCount=0;delete f[a.id]}var m={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};g.ext_srgb&&(m.srgba=35907);g.ext_color_buffer_half_float&&(m.rgba16f=34842,m.rgb16f=34843);g.webgl_color_buffer_float&&(m.rgba32f=34836);var h=0,f={};c.prototype.decRef=function(){0===--this.refCount&&l(this)};return{create:function(a){function b(a){a=a||{};var c=0,g=0;"shape"in a?(g=a.shape,c=g[0]|0,g=
g[1]|0):("radius"in a&&(c=g=a.radius|0),"width"in a&&(c=a.width|0),"height"in a&&(g=a.height|0));b.width=d.width=Math.max(c,1);b.height=d.height=Math.max(g,1);d.format=32854;"format"in a&&(d.format=m[a.format]);e(d);return b}var d=new c;f[d.id]=d;b(a);b._reglType="renderbuffer";b._renderbuffer=d;b.destroy=function(){d.decRef()};return b},refresh:function(){a(f).forEach(e)},clear:function(){a(f).forEach(l)}}}},{"./util/values":28}],16:[function(f,k,p){var a=f("./util/values");k.exports=function(b,
g){function d(a,b,c,d){this.name=a;this.id=b;this.location=c;this.info=d}function c(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id){a[c].location=b.location;return}a.push(b)}function e(a,c,d){d=35632===a?h:f;var e=d[c];if(!e){var l=g.str(c),e=b.createShader(a);b.shaderSource(e,l);b.compileShader(e);d[c]=e}return e}function l(a,b){this.id=k++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}function m(a,l){var m,h;m=e(35632,a.fragId);h=e(35633,a.vertId);var n=a.program=
b.createProgram();b.attachShader(n,m);b.attachShader(n,h);b.linkProgram(n);var f=b.getProgramParameter(n,35718),t=a.uniforms;for(m=0;m<f;++m)if(h=b.getActiveUniform(n,m))if(1<h.size)for(var k=0;k<h.size;++k){var C=h.name.replace("[0]","["+k+"]");c(t,new d(C,g.id(C),b.getUniformLocation(n,C),h))}else c(t,new d(h.name,g.id(h.name),b.getUniformLocation(n,h.name),h));f=b.getProgramParameter(n,35721);t=a.attributes;for(m=0;m<f;++m)(h=b.getActiveAttrib(n,m))&&c(t,new d(h.name,g.id(h.name),b.getAttribLocation(n,
h.name),h))}var h={},f={},t={},n=[],k=0;return{clear:function(){var c=b.deleteShader.bind(b);a(h).forEach(c);h={};a(f).forEach(c);f={};n.forEach(function(a){b.deleteProgram(a.program)});n.length=0;t={}},refresh:function(){h={};f={};n.forEach(m)},program:function(a,b,c){var d=t[b];d||(d=t[b]={});var e=d[a];e||(e=new l(b,a),m(e,c),d[a]=e,n.push(e));return e},shader:e,frag:null,vert:null}}},{"./util/values":28}],17:[function(f,k,p){k.exports=function(){var a={"":0},b=[""];return{id:function(g){var d=
a[g];if(d)return d;d=a[g]=b.length;b.push(g);return d},str:function(a){return b[a]}}}},{}],18:[function(f,k,p){function a(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function b(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var c=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==c)return!1;return!0}function g(a){return Object.prototype.toString.call(a)}function d(c){if(!c)return!1;var d=g(c);return 0<=u.indexOf(d)?!0:
a(c)||b(c)||h(c)}function c(a,b){36193===a.type?(a.data=t(b),C.freeType(b)):a.data=b}var e=f("./util/extend"),l=f("./util/values"),m=f("./util/is-typed-array"),h=f("./util/is-ndarray"),C=f("./util/pool"),t=f("./util/to-half-float");p=f("./constants/arraytypes.json");var n=f("./constants/arraytypes.json"),A=[9984,9986,9985,9987],v=[0,6409,6410,6407,6408],w={};w[6409]=w[6406]=w[6402]=1;w[34041]=w[6410]=2;w[6407]=3;w[6408]=4;var u=Object.keys(p).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]",
"[object HTMLImageElement]","[object HTMLVideoElement]"]);k.exports=function(f,k,u,p,D){function z(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function F(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;
a.width=b.width;a.height=b.height;a.channels=b.channels}function H(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=qa[b.colorSpace]);"type"in b&&(a.type=W[b.type]);var c=a.width,d=a.height,e=a.channels,g=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(e=b.shape[2],g=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),
"height"in b&&(d=b.height),"channels"in b&&(e=b.channels,g=!0));a.width=c|0;a.height=d|0;a.channels=e|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=X[c],a.format=za[d],c in W&&!("type"in b)&&(a.type=W[c]),c in Y&&(a.compressed=!0),c=!0);!g&&c?a.channels=w[a.format]:g&&!c&&a.channels!==v[a.format]&&(a.format=a.internalformat=v[a.channels])}}function y(a){f.pixelStorei(37440,a.flipY);f.pixelStorei(37441,a.premultiplyAlpha);f.pixelStorei(37443,a.colorSpace);f.pixelStorei(3317,a.unpackAlignment)}
function O(){z.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function J(e,l){var f=null;d(l)?f=l:l&&(H(e,l),"x"in l&&(e.xOffset=l.x|0),"y"in l&&(e.yOffset=l.y|0),d(l.data)&&(f=l.data));if(l.copy){var q=D.viewportWidth,k=D.viewportHeight;e.width=e.width||q-e.xOffset;e.height=e.height||k-e.yOffset;e.needsCopy=!0}else if(!f)e.width=e.width||1,e.height=e.height||1;else if(m(f))e.data=f,"type"in l||5121!==e.type||(e.type=n[Object.prototype.toString.call(f)]|
0);else if(a(f)){q=f;k=e.width*e.height*e.channels;switch(e.type){case 5121:case 5123:case 5125:case 5126:k=C.allocType(e.type,k);k.set(q);e.data=k;break;case 36193:e.data=t(q)}e.alignment=1;e.needsFree=!0}else if(h(f)){q=f.data;Array.isArray(q)||5121!==e.type||(e.type=n[Object.prototype.toString.call(q)]|0);var k=f.shape,u=f.stride,A,p,w,x;3===k.length?(w=k[2],x=u[2]):x=w=1;A=k[0];p=k[1];k=u[0];u=u[1];e.alignment=1;e.width=A;e.height=p;e.channels=w;e.format=e.internalformat=v[w];e.needsFree=!0;A=
x;f=f.offset;w=e.width;x=e.height;p=e.channels;for(var y=C.allocType(36193===e.type?5126:e.type,w*x*p),z=0,E=0;E<x;++E)for(var B=0;B<w;++B)for(var F=0;F<p;++F)y[z++]=q[k*B+u*E+A*F+f];c(e,y)}else if("[object HTMLCanvasElement]"===g(f)||"[object CanvasRenderingContext2D]"===g(f))"[object HTMLCanvasElement]"===g(f)?e.element=f:e.element=f.canvas,e.width=e.element.width,e.height=e.element.height;else if("[object HTMLImageElement]"===g(f))e.element=f,e.width=f.naturalWidth,e.height=f.naturalHeight;else if("[object HTMLVideoElement]"===
g(f))e.element=f,e.width=f.videoWidth,e.height=f.videoHeight,e.needsPoll=!0;else if(b(f)){q=f[0].length;k=f.length;u=1;if(Array.isArray(f[0][0])){A=u=f[0][0].length;w=C.allocType(36193===e.type?5126:e.type,q*k*A);for(p=x=0;p<k;++p)for(y=f[p],z=0;z<q;++z)for(E=y[z],B=0;B<A;++B)w[x++]=E[B];c(e,w)}else{A=C.allocType(36193===e.type?5126:e.type,q*k);for(x=w=0;x<k;++x)for(p=f[x],y=0;y<q;++y)A[w++]=p[y];c(e,A)}e.alignment=1;e.width=q;e.height=k;e.channels=u;e.format=e.internalformat=v[u];e.needsFree=!0}}
function S(a,b,c,d,e){var g=a.element,l=a.data,m=a.internalformat,h=a.format,n=a.type,k=a.width,t=a.height;y(a);g?f.texSubImage2D(b,e,c,d,h,n,g):a.compressed?f.compressedTexSubImage2D(b,e,c,d,m,k,t,l):a.needsCopy?(p(),f.copyTexSubImage2D(b,e,c,d,a.xOffset,a.yOffset,k,t)):f.texSubImage2D(b,e,c,d,k,t,h,n,l)}function P(){return ra.pop()||new O}function Q(a){a.needsFree&&C.freeType(a.data);O.call(a);ra.push(a)}function I(){z.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=
Array(16)}function M(a,b,c){var d=a.images[0]=P();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function K(a,b){var c=null;if(d(b))c=a.images[0]=P(),J(c,b),a.mipmask=1;else if(H(a,b),Array.isArray(b.mipmap))for(var e=b.mipmap,g=0;g<e.length;++g)c=a.images[g]=P(),F(c,a),c.width>>=g,c.height>>=g,J(c,e[g]),a.mipmask|=1<<g;else c=a.images[0]=P(),F(c,a),J(c,b),a.mipmask=1;F(a,a.images[0])}function L(a,b){for(var c=a.images,d=0;d<c.length&&c[d];++d){var e=c[d],g=b,l=d,m=e.element,h=e.data,n=e.internalformat,
k=e.format,t=e.type,C=e.width,u=e.height;y(e);m?f.texImage2D(g,l,k,k,t,m):e.compressed?f.compressedTexImage2D(g,l,n,C,u,0,h):e.needsCopy?(p(),f.copyTexImage2D(g,l,k,e.xOffset,e.yOffset,C,u,0)):f.texImage2D(g,l,k,C,u,0,k,t,h)}}function ba(){var a=xa.pop()||new I;z.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function Z(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&Q(b[c]),b[c]=null;xa.push(a)}function ga(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=
1;this.genMipmaps=!1;this.mipmapHint=4352}function ha(a,b){"min"in b&&(a.minFilter=na[b.min],0<=A.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in b&&(a.magFilter=pa[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var e=b.wrap;"string"===typeof e?c=d=ja[e]:Array.isArray(e)&&(c=ja[e[0]],d=ja[e[1]])}else"wrapS"in b&&(c=ja[b.wrapS]),"wrapT"in b&&(d=ja[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=
ma[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function oa(a,b){f.texParameteri(b,10241,a.minFilter);f.texParameteri(b,10240,a.magFilter);f.texParameteri(b,10242,a.wrapS);f.texParameteri(b,10243,a.wrapT);k.ext_texture_filter_anisotropic&&f.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(f.hint(33170,a.mipmapHint),f.generateMipmap(b))}function ca(){var a=ta.pop()||new ga;ga.call(a);return a}
function ia(a){z.call(this);this.mipmask=0;this.id=la++;this.refCount=1;this.target=a;this.texture=f.createTexture();this.unit=-1;this.bindCount=0}function T(a){f.activeTexture(33984);f.bindTexture(a.target,a.texture)}function N(){var a=aa[0];a?f.bindTexture(a.target,a.texture):f.bindTexture(3553,null)}function U(a){var b=a.texture,c=a.unit,d=a.target;0<=c&&(f.activeTexture(33984+c),f.bindTexture(d,null),aa[c]=null);f.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete V[a.id]}
var ma={"don't care":4352,"dont care":4352,nice:4354,fast:4353},ja={repeat:10497,clamp:33071,mirror:33648},pa={nearest:9728,linear:9729},na=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},pa),qa={none:0,browser:37444},W={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},X={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Y={};k.ext_srgb&&(X.srgb=35904,
X.srgba=35906);k.oes_texture_float&&(W["float"]=5126);k.oes_texture_half_float&&(W.float16=W["half float"]=36193);k.webgl_depth_texture&&(e(X,{depth:6402,"depth stencil":34041}),e(W,{uint16:5123,uint32:5125,"depth stencil":34042}));k.webgl_compressed_texture_s3tc&&e(Y,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});k.webgl_compressed_texture_atc&&e(Y,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});k.webgl_compressed_texture_pvrtc&&
e(Y,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});k.webgl_compressed_texture_etc1&&(Y["rgb etc1"]=36196);var va=Array.prototype.slice.call(f.getParameter(34467));Object.keys(Y).forEach(function(a){var b=Y[a];0<=va.indexOf(b)&&(X[a]=b)});var wa=Object.keys(X);u.textureFormats=wa;var za=wa.reduce(function(a,b){var c=X[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},
{}),ra=[],xa=[],ta=[],la=0,V={},da=u.maxTextureUnits,aa=Array(da).map(function(){return null});e(ia.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<da;++b){var c=aa[b];if(c){if(0<c.bindCount)continue;c.unit=-1}aa[b]=this;a=b;break}this.unit=a;f.activeTexture(33984+a);f.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&U(this)}});return{create2D:function(a,b){function c(a,b){var e=ca(),g=ba();
"number"===typeof a?"number"===typeof b?M(g,a|0,b|0):M(g,a|0,a|0):a?(ha(e,a),K(g,a)):M(g,1,1);e.genMipmaps&&(g.mipmask=(g.width<<1)-1);d.mipmask=g.mipmask;F(d,g);c.width=g.width;c.height=g.height;T(d);L(g,3553);oa(e,3553);N();ta.push(e);Z(g);return c}var d=new ia(3553);V[d.id]=d;c(a,b);c.subimage=function(a,b,e,g){b|=0;e|=0;g|=0;var l=P();F(l,d);l.width>>=g;l.height>>=g;l.width-=b;l.height-=e;J(l,a);T(d);S(l,3553,b,e,g);N();Q(l);return c};c._reglType="texture2d";c._texture=d;c.destroy=function(){d.decRef()};
return c},createCube:function(a,b,c,d,e,g){function l(a,b,c,d,e,g){var h,n=ca();for(h=0;6>h;++h)f[h]=ba();if("number"===typeof a||!a)for(a=a|0||1,h=0;6>h;++h)M(f[h],a,a);else if("object"===typeof a)if(b)K(f[0],a),K(f[1],b),K(f[2],c),K(f[3],d),K(f[4],e),K(f[5],g);else if(ha(n,a),H(m,a),"faces"in a)for(a=a.faces,h=0;6>h;++h)F(f[h],m),K(f[h],a[h]);else for(h=0;6>h;++h)K(f[h],a);F(m,f[0]);m.mipmask=n.genMipmaps?(f[0].width<<1)-1:f[0].mipmask;l.width=f[0].width;l.height=f[0].height;T(m);for(h=0;6>h;++h)L(f[h],
34069+h);oa(n,34067);N();ta.push(n);for(h=0;6>h;++h)Z(f[h]);return l}var m=new ia(34067);V[m.id]=m;var f=Array(6);l(a,b,c,d,e,g);l.subimage=function(a,b,c,d,e){c|=0;d|=0;e|=0;var g=P();F(g,m);g.width>>=e;g.height>>=e;g.width-=c;g.height-=d;J(g,b);T(m);S(g,34069+a,c,d,e);N();Q(g);return l};l._reglType="textureCube";l._texture=m;l.destroy=function(){m.decRef()};return l},clear:function(){for(var a=0;a<da;++a)f.activeTexture(33984+a),f.bindTexture(3553,null),aa[a]=null;l(V).forEach(U)},getTexture:function(a){return null}}}},
{"./constants/arraytypes.json":4,"./util/extend":21,"./util/is-ndarray":22,"./util/is-typed-array":23,"./util/pool":25,"./util/to-half-float":27,"./util/values":28}],19:[function(f,k,p){k.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],20:[function(f,k,p){function a(a){return Array.prototype.slice.call(a)}function b(b){return a(b).join("")}var g=f("./extend");k.exports=function(){function d(){var c=[],d=[];return g(function(){c.push.apply(c,
a(arguments))},{def:function(){var b="v"+e++;d.push(b);0<arguments.length&&(c.push(b,"="),c.push.apply(c,a(arguments)),c.push(";"));return b},toString:function(){return b([0<d.length?"var "+d+";":"",b(c)])}})}function c(){function a(d,e){c(d,e,"=",b.def(d,e),";")}var b=d(),c=d(),e=b.toString,l=c.toString;return g(b,{entry:b,exit:c,save:a,set:function(c,d,e){a(c,d);b(c,d,"=",e,";")},toString:function(){return e()+l()}})}var e=0,l=[],f=[],h=d(),k={};return{global:h,link:function(a){for(var b=0;b<f.length;++b)if(f[b]===
a)return l[b];b="g"+e++;l.push(b);f.push(a);return b},block:d,proc:function(a,d){function e(){var a="a"+l.length;l.push(a);return a}var l=[];d=d||0;for(var f=0;f<d;++f)e();var f=c(),h=f.toString;return k[a]=g(f,{arg:e,toString:function(){return b(["function(",l.join(),"){",h(),"}"])}})},scope:c,cond:function(){var d=b(arguments),e=c(),l=c(),f=e.toString,h=l.toString;return g(e,{then:function(){e.apply(e,a(arguments));return this},"else":function(){l.apply(l,a(arguments));return this},toString:function(){var a=
h();a&&(a="else{"+a+"}");return b(["if(",d,"){",f(),"}",a])}})},compile:function(){var a=['"use strict";',h,"return {"];Object.keys(k).forEach(function(b){a.push('"',b,'":',k[b].toString(),",")});a.push("}");var c=b(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,l.concat(c)).apply(null,f)}}}},{"./extend":21}],21:[function(f,k,p){k.exports=function(a,b){for(var g=Object.keys(b),d=0;d<g.length;++d)a[g[d]]=b[g[d]];return a}},{}],22:[function(f,k,p){var a=f("./is-typed-array");
k.exports=function(b){return!!b&&"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||a(b.data))}},{"./is-typed-array":23}],23:[function(f,k,p){var a=f("../constants/arraytypes.json");k.exports=function(b){return Object.prototype.toString.call(b)in a}},{"../constants/arraytypes.json":4}],24:[function(f,k,p){k.exports=function(a,b){for(var g=Array(a),d=0;d<a;++d)g[d]=b(d);return g}},{}],25:[function(f,
k,p){function a(a){var b,d;b=(65535<a)<<4;a>>>=b;d=(255<a)<<3;a>>>=d;b|=d;d=(15<a)<<2;a>>>=d;b|=d;d=(3<a)<<1;return b|d|a>>>d>>1}function b(b){a:{for(var e=16;268435456>=e;e*=16)if(b<=e){b=e;break a}b=0}e=d[a(b)>>2];return 0<e.length?e.pop():new ArrayBuffer(b)}function g(b){d[a(b.byteLength)>>2].push(b)}var d=f("./loop")(8,function(){return[]});k.exports={alloc:b,free:g,allocType:function(a,d){var g=null;switch(a){case 5120:g=new Int8Array(b(d),0,d);break;case 5121:g=new Uint8Array(b(d),0,d);break;
case 5122:g=new Int16Array(b(2*d),0,d);break;case 5123:g=new Uint16Array(b(2*d),0,d);break;case 5124:g=new Int32Array(b(4*d),0,d);break;case 5125:g=new Uint32Array(b(4*d),0,d);break;case 5126:g=new Float32Array(b(4*d),0,d);break;default:return null}return g.length!==d?g.subarray(0,d):g},freeType:function(a){g(a.buffer)}}},{"./loop":24}],26:[function(f,k,p){k.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},
cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,30)},cancel:clearTimeout}},{}],27:[function(f,k,p){var a=f("./pool"),b=new Float32Array(1),g=new Uint32Array(b.buffer);k.exports=function(d){for(var c=a.allocType(5123,d.length),e=0;e<d.length;++e)if(isNaN(d[e]))c[e]=65535;else if(Infinity===d[e])c[e]=31744;else if(-Infinity===d[e])c[e]=64512;else{b[0]=d[e];var l=g[0],f=l>>>31<<15,h=(l<<1>>>24)-127,l=l>>13&1023;c[e]=-24>h?f:-14>h?f+(l+1024>>-14-h):15<h?f+31744:f+(h+
15<<10)+l}return c}},{"./pool":25}],28:[function(f,k,p){k.exports=function(a){return Object.keys(a).map(function(b){return a[b]})}},{}],29:[function(f,k,p){function a(a,c){function e(){var b=window.innerWidth,c=window.innerHeight;a!==document.body&&(c=a.getBoundingClientRect(),b=c.right-c.left,c=c.top-c.bottom);l.width=h*b;l.height=h*c;g(l.style,{width:b+"px",height:c+"px"})}var l=document.createElement("canvas"),f=b(l,c);g(l.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(l);a===
document.body&&(l.style.position="absolute",g(a.style,{margin:0,padding:0}));var h=+f.options.pixelRatio;window.addEventListener("resize",e,!1);var k=f.options.onDestroy;f.options=g(g({},f.options),{onDestroy:function(){window.removeEventListener("resize",e);a.removeChild(l);k&&k()}});e();return f}function b(a,b){function e(b){try{return a.getContext(b,l)}catch(c){return null}}var l=b.glOptions||{};return{gl:e("webgl")||e("experimental-webgl")||e("webgl-experimental"),options:g({pixelRatio:window.devicePixelRatio},
b)}}var g=f("./util/extend");k.exports=function(d){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:d[0],options:d[1]||{}};var c=document.body,e=d[1]||{};if("string"===typeof d[0])c=document.querySelector(d[0])||document.body;else if("object"===typeof d[0])if(d[0]instanceof HTMLElement)c=d[0];else{if(d[0]instanceof WebGLRenderingContext)return{gl:d[0],options:g({pixelRatio:1},e)};e=d[0]}return c.nodeName&&"CANVAS"===c.nodeName.toUpperCase()?b(c,e):a(c,e)}},{"./util/extend":21}],
30:[function(f,k,p){k.exports=function(a,b){var g=b[0],d=b[1],c=b[2],e=b[3],l=b[4],f=b[5],h=b[6],k=b[7],t=b[8],n=b[9],p=b[10],v=b[11],w=b[12],u=b[13],q=b[14],E=b[15];a[0]=f*(p*E-v*q)-n*(h*E-k*q)+u*(h*v-k*p);a[1]=-(d*(p*E-v*q)-n*(c*E-e*q)+u*(c*v-e*p));a[2]=d*(h*E-k*q)-f*(c*E-e*q)+u*(c*k-e*h);a[3]=-(d*(h*v-k*p)-f*(c*v-e*p)+n*(c*k-e*h));a[4]=-(l*(p*E-v*q)-t*(h*E-k*q)+w*(h*v-k*p));a[5]=g*(p*E-v*q)-t*(c*E-e*q)+w*(c*v-e*p);a[6]=-(g*(h*E-k*q)-l*(c*E-e*q)+w*(c*k-e*h));a[7]=g*(h*v-k*p)-l*(c*v-e*p)+t*(c*k-
e*h);a[8]=l*(n*E-v*u)-t*(f*E-k*u)+w*(f*v-k*n);a[9]=-(g*(n*E-v*u)-t*(d*E-e*u)+w*(d*v-e*n));a[10]=g*(f*E-k*u)-l*(d*E-e*u)+w*(d*k-e*f);a[11]=-(g*(f*v-k*n)-l*(d*v-e*n)+t*(d*k-e*f));a[12]=-(l*(n*q-p*u)-t*(f*q-h*u)+w*(f*p-h*n));a[13]=g*(n*q-p*u)-t*(d*q-c*u)+w*(d*p-c*n);a[14]=-(g*(f*q-h*u)-l*(d*q-c*u)+w*(d*h-c*f));a[15]=g*(f*p-h*n)-l*(d*p-c*n)+t*(d*h-c*f);return a}},{}],31:[function(f,k,p){k.exports=function(a){var b=new Float32Array(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];
b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}},{}],32:[function(f,k,p){k.exports=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],33:[function(f,k,p){k.exports=function(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;
a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],34:[function(f,k,p){k.exports=function(a){var b=a[0],g=a[1],d=a[2],c=a[3],e=a[4],l=a[5],f=a[6],h=a[7],k=a[8],t=a[9],n=a[10],p=a[11],v=a[12],w=a[13],u=a[14];a=a[15];return(b*l-g*e)*(n*a-p*u)-(b*f-d*e)*(t*a-p*w)+(b*h-c*e)*(t*u-n*w)+(g*f-d*l)*(k*a-p*v)-(g*h-c*l)*(k*u-n*v)+(d*h-c*f)*(k*w-t*v)}},{}],35:[function(f,k,p){k.exports=function(a,b){var g=b[0],d=b[1],c=b[2],e=b[3],l=g+g,f=d+d,h=c+c,g=g*l,k=d*l,d=d*f,t=c*l,n=c*f,c=c*h,l=e*l,f=e*f,e=e*h;a[0]=1-d-c;
a[1]=k+e;a[2]=t-f;a[3]=0;a[4]=k-e;a[5]=1-g-c;a[6]=n+l;a[7]=0;a[8]=t+f;a[9]=n-l;a[10]=1-g-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],36:[function(f,k,p){k.exports=function(a,b,g){var d=b[0],c=b[1],e=b[2],f=b[3],m=d+d,h=c+c,k=e+e;b=d*m;var t=d*h,d=d*k,n=c*h,c=c*k,e=e*k,m=f*m,h=f*h,f=f*k;a[0]=1-(n+e);a[1]=t+f;a[2]=d-h;a[3]=0;a[4]=t-f;a[5]=1-(b+e);a[6]=c+m;a[7]=0;a[8]=d+h;a[9]=c-m;a[10]=1-(b+n);a[11]=0;a[12]=g[0];a[13]=g[1];a[14]=g[2];a[15]=1;return a}},{}],37:[function(f,k,p){k.exports=
function(a,b,g,d,c,e,f){var m=1/(g-b),h=1/(c-d),k=1/(e-f);a[0]=2*e*m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e*h;a[6]=0;a[7]=0;a[8]=(g+b)*m;a[9]=(c+d)*h;a[10]=(f+e)*k;a[11]=-1;a[12]=0;a[13]=0;a[14]=f*e*2*k;a[15]=0;return a}},{}],38:[function(f,k,p){k.exports=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}},{}],39:[function(f,k,p){k.exports={create:f("./create"),clone:f("./clone"),copy:f("./copy"),identity:f("./identity"),
transpose:f("./transpose"),invert:f("./invert"),adjoint:f("./adjoint"),determinant:f("./determinant"),multiply:f("./multiply"),translate:f("./translate"),scale:f("./scale"),rotate:f("./rotate"),rotateX:f("./rotateX"),rotateY:f("./rotateY"),rotateZ:f("./rotateZ"),fromRotationTranslation:f("./fromRotationTranslation"),fromQuat:f("./fromQuat"),frustum:f("./frustum"),perspective:f("./perspective"),perspectiveFromFieldOfView:f("./perspectiveFromFieldOfView"),ortho:f("./ortho"),lookAt:f("./lookAt"),str:f("./str")}},
{"./adjoint":30,"./clone":31,"./copy":32,"./create":33,"./determinant":34,"./fromQuat":35,"./fromRotationTranslation":36,"./frustum":37,"./identity":38,"./invert":40,"./lookAt":41,"./multiply":42,"./ortho":43,"./perspective":44,"./perspectiveFromFieldOfView":45,"./rotate":46,"./rotateX":47,"./rotateY":48,"./rotateZ":49,"./scale":50,"./str":51,"./translate":52,"./transpose":53}],40:[function(f,k,p){k.exports=function(a,b){var g=b[0],d=b[1],c=b[2],e=b[3],f=b[4],m=b[5],h=b[6],k=b[7],t=b[8],n=b[9],p=
b[10],v=b[11],w=b[12],u=b[13],q=b[14],E=b[15],x=g*m-d*f,B=g*h-c*f,D=g*k-e*f,z=d*h-c*m,F=d*k-e*m,H=c*k-e*h,y=t*u-n*w,O=t*q-p*w,J=t*E-v*w,S=n*q-p*u,P=n*E-v*u,Q=p*E-v*q,I=x*Q-B*P+D*S+z*J-F*O+H*y;if(!I)return null;I=1/I;a[0]=(m*Q-h*P+k*S)*I;a[1]=(c*P-d*Q-e*S)*I;a[2]=(u*H-q*F+E*z)*I;a[3]=(p*F-n*H-v*z)*I;a[4]=(h*J-f*Q-k*O)*I;a[5]=(g*Q-c*J+e*O)*I;a[6]=(q*D-w*H-E*B)*I;a[7]=(t*H-p*D+v*B)*I;a[8]=(f*P-m*J+k*y)*I;a[9]=(d*J-g*P-e*y)*I;a[10]=(w*F-u*D+E*x)*I;a[11]=(n*D-t*F-v*x)*I;a[12]=(m*O-f*S-h*y)*I;a[13]=(g*
S-d*O+c*y)*I;a[14]=(u*B-w*z-q*x)*I;a[15]=(t*z-n*B+p*x)*I;return a}},{}],41:[function(f,k,p){var a=f("./identity");k.exports=function(b,g,d,c){var e,f,m,h,k,t,n,p,v=g[0],w=g[1];g=g[2];m=c[0];h=c[1];f=c[2];n=d[0];c=d[1];e=d[2];if(1E-6>Math.abs(v-n)&&1E-6>Math.abs(w-c)&&1E-6>Math.abs(g-e))return a(b);d=v-n;c=w-c;n=g-e;p=1/Math.sqrt(d*d+c*c+n*n);d*=p;c*=p;n*=p;e=h*n-f*c;f=f*d-m*n;m=m*c-h*d;(p=Math.sqrt(e*e+f*f+m*m))?(p=1/p,e*=p,f*=p,m*=p):m=f=e=0;h=c*m-n*f;k=n*e-d*m;t=d*f-c*e;(p=Math.sqrt(h*h+k*k+t*t))?
(p=1/p,h*=p,k*=p,t*=p):t=k=h=0;b[0]=e;b[1]=h;b[2]=d;b[3]=0;b[4]=f;b[5]=k;b[6]=c;b[7]=0;b[8]=m;b[9]=t;b[10]=n;b[11]=0;b[12]=-(e*v+f*w+m*g);b[13]=-(h*v+k*w+t*g);b[14]=-(d*v+c*w+n*g);b[15]=1;return b}},{"./identity":38}],42:[function(f,k,p){k.exports=function(a,b,g){var d=b[0],c=b[1],e=b[2],f=b[3],m=b[4],h=b[5],k=b[6],p=b[7],n=b[8],A=b[9],v=b[10],w=b[11],u=b[12],q=b[13],E=b[14];b=b[15];var x=g[0],B=g[1],D=g[2],z=g[3];a[0]=x*d+B*m+D*n+z*u;a[1]=x*c+B*h+D*A+z*q;a[2]=x*e+B*k+D*v+z*E;a[3]=x*f+B*p+D*w+z*b;
x=g[4];B=g[5];D=g[6];z=g[7];a[4]=x*d+B*m+D*n+z*u;a[5]=x*c+B*h+D*A+z*q;a[6]=x*e+B*k+D*v+z*E;a[7]=x*f+B*p+D*w+z*b;x=g[8];B=g[9];D=g[10];z=g[11];a[8]=x*d+B*m+D*n+z*u;a[9]=x*c+B*h+D*A+z*q;a[10]=x*e+B*k+D*v+z*E;a[11]=x*f+B*p+D*w+z*b;x=g[12];B=g[13];D=g[14];z=g[15];a[12]=x*d+B*m+D*n+z*u;a[13]=x*c+B*h+D*A+z*q;a[14]=x*e+B*k+D*v+z*E;a[15]=x*f+B*p+D*w+z*b;return a}},{}],43:[function(f,k,p){k.exports=function(a,b,g,d,c,e,f){var m=1/(b-g),h=1/(d-c),k=1/(e-f);a[0]=-2*m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*h;a[6]=
0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*k;a[11]=0;a[12]=(b+g)*m;a[13]=(c+d)*h;a[14]=(f+e)*k;a[15]=1;return a}},{}],44:[function(f,k,p){k.exports=function(a,b,g,d,c){b=1/Math.tan(b/2);var e=1/(d-c);a[0]=b/g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(c+d)*e;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*c*d*e;a[15]=0;return a}},{}],45:[function(f,k,p){k.exports=function(a,b,g,d){var c=Math.tan(b.upDegrees*Math.PI/180),e=Math.tan(b.downDegrees*Math.PI/180),f=Math.tan(b.leftDegrees*Math.PI/180);b=
Math.tan(b.rightDegrees*Math.PI/180);var m=2/(f+b),h=2/(c+e);a[0]=m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=h;a[6]=0;a[7]=0;a[8]=-((f-b)*m*.5);a[9]=(c-e)*h*.5;a[10]=d/(g-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*g/(g-d);a[15]=0;return a}},{}],46:[function(f,k,p){k.exports=function(a,b,g,d){var c=d[0],e=d[1];d=d[2];var f=Math.sqrt(c*c+e*e+d*d),m,h,k,p,n,A,v,w,u,q,E,x,B,D,z,F,H,y,O,J;if(1E-6>Math.abs(f))return null;f=1/f;c*=f;e*=f;d*=f;m=Math.sin(g);h=Math.cos(g);k=1-h;g=b[0];f=b[1];p=b[2];n=b[3];A=b[4];v=b[5];
w=b[6];u=b[7];q=b[8];E=b[9];x=b[10];B=b[11];D=c*c*k+h;z=e*c*k+d*m;F=d*c*k-e*m;H=c*e*k-d*m;y=e*e*k+h;O=d*e*k+c*m;J=c*d*k+e*m;c=e*d*k-c*m;e=d*d*k+h;a[0]=g*D+A*z+q*F;a[1]=f*D+v*z+E*F;a[2]=p*D+w*z+x*F;a[3]=n*D+u*z+B*F;a[4]=g*H+A*y+q*O;a[5]=f*H+v*y+E*O;a[6]=p*H+w*y+x*O;a[7]=n*H+u*y+B*O;a[8]=g*J+A*c+q*e;a[9]=f*J+v*c+E*e;a[10]=p*J+w*c+x*e;a[11]=n*J+u*c+B*e;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}},{}],47:[function(f,k,p){k.exports=function(a,b,g){var d=Math.sin(g);g=Math.cos(g);
var c=b[4],e=b[5],f=b[6],m=b[7],h=b[8],k=b[9],p=b[10],n=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=c*g+h*d;a[5]=e*g+k*d;a[6]=f*g+p*d;a[7]=m*g+n*d;a[8]=h*g-c*d;a[9]=k*g-e*d;a[10]=p*g-f*d;a[11]=n*g-m*d;return a}},{}],48:[function(f,k,p){k.exports=function(a,b,g){var d=Math.sin(g);g=Math.cos(g);var c=b[0],e=b[1],f=b[2],m=b[3],h=b[8],k=b[9],p=b[10],n=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],
a[15]=b[15]);a[0]=c*g-h*d;a[1]=e*g-k*d;a[2]=f*g-p*d;a[3]=m*g-n*d;a[8]=c*d+h*g;a[9]=e*d+k*g;a[10]=f*d+p*g;a[11]=m*d+n*g;return a}},{}],49:[function(f,k,p){k.exports=function(a,b,g){var d=Math.sin(g);g=Math.cos(g);var c=b[0],e=b[1],f=b[2],k=b[3],h=b[4],p=b[5],t=b[6],n=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=c*g+h*d;a[1]=e*g+p*d;a[2]=f*g+t*d;a[3]=k*g+n*d;a[4]=h*g-c*d;a[5]=p*g-e*d;a[6]=t*g-f*d;a[7]=n*g-k*d;return a}},{}],50:[function(f,
k,p){k.exports=function(a,b,g){var d=g[0],c=g[1];g=g[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*g;a[9]=b[9]*g;a[10]=b[10]*g;a[11]=b[11]*g;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}},{}],51:[function(f,k,p){k.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],52:[function(f,
k,p){k.exports=function(a,b,g){var d=g[0],c=g[1];g=g[2];var e,f,k,h,p,t,n,A,v,w,u,q;b===a?(a[12]=b[0]*d+b[4]*c+b[8]*g+b[12],a[13]=b[1]*d+b[5]*c+b[9]*g+b[13],a[14]=b[2]*d+b[6]*c+b[10]*g+b[14],a[15]=b[3]*d+b[7]*c+b[11]*g+b[15]):(e=b[0],f=b[1],k=b[2],h=b[3],p=b[4],t=b[5],n=b[6],A=b[7],v=b[8],w=b[9],u=b[10],q=b[11],a[0]=e,a[1]=f,a[2]=k,a[3]=h,a[4]=p,a[5]=t,a[6]=n,a[7]=A,a[8]=v,a[9]=w,a[10]=u,a[11]=q,a[12]=e*d+p*c+v*g+b[12],a[13]=f*d+t*c+w*g+b[13],a[14]=k*d+n*c+u*g+b[14],a[15]=h*d+A*c+q*g+b[15]);return a}},
{}],53:[function(f,k,p){k.exports=function(a,b){if(a===b){var g=b[1],d=b[2],c=b[3],e=b[6],f=b[7],k=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=g;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=e;a[11]=b[14];a[12]=c;a[13]=f;a[14]=k}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],54:[function(f,k,p){function a(a,c,d,g){g[0]=b(255*a);g[1]=b(255*c);g[2]=b(255*d)}var b=Math.round,
g=Math.min,d=Math.max,c=Math.ceil;k.exports=function(b,f,k,h){h=h||[0,0,0];b%=360;f=d(0,g(f,1));k=d(0,g(k,1));if(f){f=(1-f)*k;var p=k-f,t=b%60;switch(b/60|0){case 0:a(k,p*b/60+f,f,h);break;case 1:a(p*(60-t)/60+f,k,f,h);break;case 2:a(f,k,p*t/60+f,h);break;case 3:a(f,p*(60-t)/60+f,k,h);break;case 4:a(p*t/60+f,f,k,h);break;case 5:a(k,f,p*(60-t)/60+f,h)}}else h[0]=h[1]=h[2]=c(255*k);return h}},{}],55:[function(f,k,p){var a=f("./lib/util/extend"),b=f("./lib/dynamic"),g=f("./lib/util/raf"),d=f("./lib/util/clock"),
c=f("./lib/strings"),e=f("./lib/webgl"),l=f("./lib/extension"),m=f("./lib/limits"),h=f("./lib/buffer"),C=f("./lib/elements"),t=f("./lib/texture"),n=f("./lib/renderbuffer"),A=f("./lib/framebuffer"),v=f("./lib/attribute"),w=f("./lib/shader"),u=f("./lib/read"),q=f("./lib/core");k.exports=function(){function f(){U=g.next(f);M.count+=1;var a=d();M.deltaTime=(a-P)/1E3;M.time=(a-S)/1E3;P=a;F();for(a=0;a<N.length;++a)(0,N[a])(M,null,0)}function k(a){}function p(a){}function D(c){function d(a){var c={},e=
{};Object.keys(a).forEach(function(d){var f=a[d];b.isDynamic(f)?e[d]=b.unbox(f,d):c[d]=f});return{dynamic:e,"static":c}}function e(a){for(;n.length<a;)n.push(null);return n}var f=d(c.context||{}),g=d(c.uniforms||{}),h=d(c.attributes||{});c=d(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");
c("sample");return d}(c));var f=ca.compile(c,h,g,f),k=f.draw,l=f.batch,m=f.scope,n=[];return function(a,b){var c;if("function"===typeof a)return m.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)m.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)m.call(this,a[c],b,c);else return m.call(this,a,b,0);else if("number"===typeof a){if(0<a)return l.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return l.call(this,a,a.length)}else return k.call(this,
a)}}function z(){ca.procs.poll()}function F(){var a=ia.viewport,b=ia.scissor_box;a[0]=a[1]=b[0]=b[1]=0;M.viewportWidth=M.frameBufferWidth=M.drawingBufferWidth=a[2]=b[2]=y.drawingBufferWidth;M.viewportHeight=M.frameBufferWidth=M.drawingBufferHeight=a[3]=b[3]=y.drawingBufferHeight;ca.procs.refresh()}var H=e(Array.prototype.slice.call(arguments)),y=H.gl,O=H.options,H=c(),J=l(y).extensions,S=d(),P=S,Q=y.drawingBufferWidth,I=y.drawingBufferHeight,M={count:0,deltaTime:0,time:0,viewportWidth:Q,viewportHeight:I,
framebufferWidth:Q,framebufferHeight:I,drawingBufferWidth:Q,drawingBufferHeight:I,pixelRatio:O.pixelRatio},K=m(y,J),L=h(y),Q=C(y,J,L),I=v(y,J,K,L,H),ba=w(y,H),Z=t(y,J,K,z,M),ga=n(y,J,K),ha=A(y,J,K,Z,ga),oa=u(y,z,M),ca=q(y,H,J,K,L,Q,Z,ha,{},I,ba,{elements:null,primitive:4,count:-1,offset:0,instances:-1},M),ia=ca.next,T=y.canvas,N=[],U=0;T&&(T.addEventListener("webglcontextlost",k,!1),T.addEventListener("webglcontextrestored",p,!1));F();return a(D,{clear:function(a){var b=0;z();var c=a.color;c&&(y.clearColor(+c[0]||
0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(y.clearDepth(+a.depth),b|=256);"stencil"in a&&(y.clearStencil(a.stencil|0),b|=1024);y.clear(b)},prop:b.define.bind(null,1),context:b.define.bind(null,2),"this":b.define.bind(null,3),draw:D({}),buffer:function(a){return L.create(a,34962)},elements:Q.create,texture:Z.create2D,cube:Z.createCube,renderbuffer:ga.create,framebuffer:ha.create,framebufferCube:function(a){},attributes:y.getContextAttributes(),frame:function(a){N.push(a);!U&&0<N.length&&
f();return{cancel:function(){var b=N.find(function(b){return b===a});0>b||(N.splice(b,1),0>=N.length&&U&&(g.cancel(f),U=0))}}},limits:K,hasExtension:function(a){return 0<=K.extensions.indexOf(a.toLowerCase())},read:oa,destroy:function(){U&&(g.cancel(f),U=0);T&&(T.removeEventListener("webglcontextlost",k),T.removeEventListener("webglcontextrestored",p));ba.clear();ha.clear();ga.clear();Z.clear();L.clear();if(O.onDestroy)O.onDestroy()},_gl:y,_refresh:F})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,
"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/strings":17,"./lib/texture":18,"./lib/util/clock":19,"./lib/util/extend":21,"./lib/util/raf":26,"./lib/webgl":29}]},{},[1]);
