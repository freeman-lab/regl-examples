(function e$$0(n,q,k){function a(h,d){if(!q[h]){if(!n[h]){var b="function"==typeof require&&require;if(!d&&b)return b(h,!0);if(p)return p(h,!0);b=Error("Cannot find module '"+h+"'");throw b.code="MODULE_NOT_FOUND",b;}b=q[h]={exports:{}};n[h][0].call(b.exports,function(d){var b=n[h][1][d];return a(b?b:d)},b,b.exports,e$$0,n,q,k)}return q[h].exports}for(var p="function"==typeof require&&require,E=0;E<k.length;E++)a(k[E]);return a})({1:[function(f,n,q){var k=f("../regl")({extensions:"OES_texture_float"}),
a=f("mouse-change")(),p=Array(2).fill().map(function(){return k.framebuffer({radius:512,colorType:"float",depthStencil:!1})}),E=k({vert:"\n  precision mediump float;\n  attribute vec2 position;\n  void main () {\n    gl_Position = vec4(position, 0, 1);\n  }\n  ",frag:"\n  precision highp float;\n\n  uniform sampler2D state;\n  uniform float shapeX, shapeY, deltaT, gravity;\n\n  void main () {\n    vec2 shape = vec2(shapeX, shapeY);\n    vec4 prevState = texture2D(state,\n      gl_FragCoord.xy / shape);\n\n    vec2 position = prevState.xy;\n    vec2 velocity = prevState.zw;\n\n    position += 0.5 * velocity * deltaT;\n    if (position.x < -1.0 || position.x > 1.0) {\n      velocity.x *= -1.0;\n    }\n    if (position.y < -1.0 || position.y > 1.0) {\n      velocity.y *= -1.0;\n    }\n    position += 0.5 * velocity * deltaT;\n\n    velocity.y = velocity.y + gravity * deltaT;\n\n    gl_FragColor = vec4(position, velocity);\n  }\n  ",
depth:{enable:!1},framebuffer:function(a){return p[(a.tick+1)%2]},uniforms:{state:function(a){return p[a.tick%2]},shapeX:k.context("viewportWidth"),shapeY:k.context("viewportHeight"),deltaT:.1,gravity:-.5},attributes:{position:[0,-4,4,4,-4,4]},primitive:"triangles",elements:null,offset:0,count:3}),h=k({vert:"\n  precision highp float;\n  attribute vec2 sprite;\n  uniform sampler2D state;\n  varying vec2 rg;\n  void main () {\n    vec2 position = texture2D(state, sprite).xy;\n    gl_PointSize = 16.0;\n    rg = sprite;\n    gl_Position = vec4(position, 0, 1);\n  }\n  ",
frag:"\n  precision highp float;\n  varying vec2 rg;\n  void main () {\n    gl_FragColor = vec4(rg, 1.0 - max(rg.x, rg.y), 1);\n  }\n  ",attributes:{sprite:Array(262144).fill().map(function(a,d){return[d%512/512,(d/512|0)/512]}).reverse()},uniforms:{state:function(a){return p[a.tick%2]}},primitive:"points",offset:function(a,d){return 262144-d.count},elements:null,count:k.prop("count")}),d=0,b={data:new Float32Array(256),width:64,height:1},u=document.createElement("div");Object.assign(u.style,{color:"white",
position:"absolute",left:"20px",top:"20px","z-index":20});document.body.appendChild(u);k.frame(function(f){var n=f.tick,r=f.pixelRatio,m=Math.min(Math.max(2*r*a.x/f.drawingBufferWidth-1,-.999),.999);f=-Math.min(Math.max(2*r*a.y/f.drawingBufferHeight-1,-.999),.999);if(a.buttons){for(r=0;64>r;++r)b.data[4*r]=m,b.data[4*r+1]=f,b.data[4*r+2]=.25*(Math.random()-.5),b.data[4*r+3]=Math.random();p[n%2].color[0].subimage(b,d%512,(d/512|0)%512);d+=64;u.innerText=Math.min(d,262144)}E();k.clear({color:[0,0,0,
1],depth:1});h({count:Math.min(d,262144)})})},{"../regl":35,"mouse-change":33}],2:[function(f,n,q){function k(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}n.exports=function(a,p,f,h,d){a=f.maxAttributes;p=Array(a);for(f=0;f<a;++f)p[f]=new k;return{Record:k,scope:{},state:p}}},{}],3:[function(f,n,q){function k(a){return J[Object.prototype.toString.call(a)]|0}function a(a,d){for(var h=0;h<d.length;++h)a[h]=
d[h]}function p(a,d,h,b,l,k,p){for(var m=0,c=0;c<h;++c)for(var f=0;f<b;++f)a[m++]=d[l*c+k*f+p]}function E(a,d,h){for(var b=0,l=0;l<d.length;++l)for(var k=d[l],p=0;p<h;++p)a[b++]=k[p]}var h=f("./util/is-typed-array"),d=f("./util/is-ndarray"),b=f("./util/values"),u=f("./util/pool"),J=f("./constants/arraytypes.json"),F=f("./constants/dtypes.json"),r=f("./constants/usage.json"),m=[];m[5120]=1;m[5122]=2;m[5124]=4;m[5121]=1;m[5123]=2;m[5125]=4;m[5126]=4;n.exports=function(f,x,C){function g(a){this.id=A++;
this.buffer=f.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;C.profile&&(this.stats={size:0})}function l(a,d,h){a.byteLength=d.byteLength;f.bufferData(a.type,d,h)}function n(c,b,f,g,m,A){c.usage=f;if(Array.isArray(b))c.dtype=g||5126,0<b.length&&(Array.isArray(b[0])?(c.dimension=b[0].length,g=u.allocType(c.dtype,b.length*c.dimension),E(g,b,c.dimension),l(c,g,f),A?c.persistentData=g:u.freeType(g)):"number"===typeof b[0]?(c.dimension=
m,g=u.allocType(c.dtype,b.length),a(g,b),l(c,g,f),A?c.persistentData=g:u.freeType(g)):h(b[0])&&(c.dimension=b[0].length,c.dtype=g||k(b[0])||5126,g=u.allocType(c.dtype,b.length*c.dimension),E(g,b,c.dimension),l(c,g,f),A?c.persistentData=g:u.freeType(g)));else if(h(b))c.dtype=g||k(b),c.dimension=m,l(c,b,f),A&&(c.persistentData=new Uint8Array(new Uint8Array(b.buffer)));else if(d(b)){var O=b.shape,Q=b.stride;m=b.offset;var r=0,x=0,t=0,Z=0;1===O.length?(r=O[0],x=1,t=Q[0],Z=0):2===O.length&&(r=O[0],x=O[1],
t=Q[0],Z=Q[1]);c.dtype=g||k(b.data)||5126;c.dimension=x;g=u.allocType(c.dtype,r*x);p(g,b.data,r,x,t,Z,m);l(c,g,f);A?c.persistentData=g:u.freeType(g)}}function D(a){x.bufferCount--;f.deleteBuffer(a.buffer);a.buffer=null;delete c[a.id]}var A=0,c={};g.prototype.bind=function(){f.bindBuffer(this.type,this.buffer)};g.prototype.destroy=function(){D(this)};var O=[];C.profile&&(x.getTotalBufferSize=function(){var a=0;Object.keys(c).forEach(function(d){a+=c[d].stats.size});return a});return{create:function(b,
l,A,O){function J(a){var c=35044,b=null,g=0,l=0,k=1;Array.isArray(a)||h(a)||d(a)?b=a:"number"===typeof a?g=a|0:a&&("data"in a&&(b=a.data),"usage"in a&&(c=r[a.usage]),"type"in a&&(l=F[a.type]),"dimension"in a&&(k=a.dimension|0),"length"in a&&(g=a.length|0));q.bind();b?n(q,b,c,l,k,O):(f.bufferData(q.type,g,c),q.dtype=l||5121,q.usage=c,q.dimension=k,q.byteLength=g);C.profile&&(q.stats.size=q.byteLength*m[q.dtype]);return J}x.bufferCount++;var q=new g(l);c[q.id]=q;A||J(b);J._reglType="buffer";J._buffer=
q;J.subdata=function(c,b){var g=(b||0)|0;q.bind();if(Array.isArray(c)){if(0<c.length)if("number"===typeof c[0]){var l=u.allocType(q.dtype,c.length);a(l,c);f.bufferSubData(q.type,g,l);u.freeType(l)}else if(Array.isArray(c[0])||h(c[0])){var l=c[0].length,t=u.allocType(q.dtype,c.length*l);E(t,c,l);f.bufferSubData(q.type,g,t);u.freeType(t)}}else if(h(c))f.bufferSubData(q.type,g,c);else if(d(c)){var m=c.shape,A=c.stride,O=t=l=0,r=0;1===m.length?(l=m[0],t=1,O=A[0],r=0):2===m.length&&(l=m[0],t=m[1],O=A[0],
r=A[1]);m=Array.isArray(c.data)?q.dtype:k(c.data);m=u.allocType(m,l*t);p(m,c.data,l,t,O,r,c.offset);f.bufferSubData(q.type,g,m);u.freeType(m)}return J};C.profile&&(J.stats=q.stats);J.destroy=function(){D(q)};return J},createStream:function(a,c){var d=O.pop();d||(d=new g(a));d.bind();n(d,c,35040,0,1,!1);return d},destroyStream:function(a){O.push(a)},clear:function(){b(c).forEach(D);O.forEach(D)},getBuffer:function(a){return a&&a._buffer instanceof g?a._buffer:null},restore:function(){b(c).forEach(function(a){a.buffer=
f.createBuffer();f.bindBuffer(a.type,a.buffer);f.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:n}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(f,n,q){n.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,
"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(f,n,q){n.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(f,n,q){n.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(f,n,q){n.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(f,n,q){function k(a){return Array.isArray(a)||
J(a)||F(a)}function a(a){return a.sort(function(a,c){return"viewport"===a?-1:"viewport"===c?1:a<c?-1:1})}function p(a,c,d,b){this.thisDep=a;this.contextDep=c;this.propDep=d;this.append=b}function E(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function h(a){return new p(!1,!1,!1,a)}function d(a,c){var d=a.type;return 0===d?(d=a.data.length,new p(!0,1<=d,2<=d,c)):4===d?(d=a.data,new p(d.thisDep,d.contextDep,d.propDep,c)):new p(3===d,2===d,1===d,c)}var b=f("./util/codegen"),u=f("./util/loop"),
J=f("./util/is-typed-array"),F=f("./util/is-ndarray"),r=f("./util/is-array-like"),m=f("./dynamic"),H=f("./constants/primitives.json"),x=f("./constants/dtypes.json"),C=["x","y","z","w"],g="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),l={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,
"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},G={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},D={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},A={cw:2304,ccw:2305},c=new p(!1,!1,!1,function(){});n.exports=function(f,
n,q,J,F,ma,na,M,Q,oa,ta,t,Z,aa,ia){function V(a){return a.replace(".","_")}function L(a,e,c){var d=V(a);Ha.push(a);Ba[d]=ua[d]=!!c;va[d]=e}function B(a,e,c){var d=V(a);Ha.push(a);Array.isArray(c)?(ua[d]=c.slice(),Ba[d]=c.slice()):ua[d]=Ba[d]=c;wa[d]=e}function xa(){var a=b(),e=a.link,c=a.global;a.id=Na++;a.batchId="0";var d=e(Ma),h=a.shared={props:"a0"};Object.keys(Ma).forEach(function(a){h[a]=c.def(d,".",a)});var l=a.next={},T=a.current={};Object.keys(wa).forEach(function(a){Array.isArray(ua[a])&&
(l[a]=c.def(h.next,".",a),T[a]=c.def(h.current,".",a))});var Oa=a.constants={};Object.keys(Ia).forEach(function(a){Oa[a]=c.def(JSON.stringify(Ia[a]))});a.invoke=function(z,I){switch(I.type){case 0:var c=["this",h.context,h.props,a.batchId];return z.def(e(I.data),".call(",c.slice(0,Math.max(I.data.length+1,4)),")");case 1:return z.def(h.props,I.data);case 2:return z.def(h.context,I.data);case 3:return z.def("this",I.data);case 4:return I.data.append(a,z),I.data.ref}};a.attribCache={};var z={};a.scopeAttrib=
function(a){a=n.id(a);if(a in z)return z[a];var y=oa.scope[a];y||(y=oa.scope[a]=new w);return z[a]=e(y)};return a}function pa(a){var e=a["static"];a=a.dynamic;var c;if("profile"in e){var b=!!e.profile;c=h(function(a,e){return b});c.enable=b}else if("profile"in a){var l=a.profile;c=d(l,function(a,e){return a.invoke(e,l)})}return c}function ya(a,e){var c=a["static"],b=a.dynamic;if("framebuffer"in c){var l=c.framebuffer;return l?(l=M.getFramebuffer(l),h(function(a,e){var z=a.link(l),c=a.shared;e.set(c.framebuffer,
".next",z);c=c.context;e.set(c,".framebufferWidth",z+".width");e.set(c,".framebufferHeight",z+".height");return z})):h(function(a,e){var z=a.shared;e.set(z.framebuffer,".next","null");z=z.context;e.set(z,".framebufferWidth",z+".drawingBufferWidth");e.set(z,".framebufferHeight",z+".drawingBufferHeight");return"null"})}if("framebuffer"in b){var g=b.framebuffer;return d(g,function(a,e){var z=a.invoke(e,g),c=a.shared,I=c.framebuffer,z=e.def(I,".getFramebuffer(",z,")");e.set(I,".next",z);c=c.context;e.set(c,
".framebufferWidth",z+"?"+z+".width:"+c+".drawingBufferWidth");e.set(c,".framebufferHeight",z+"?"+z+".height:"+c+".drawingBufferHeight");return z})}return null}function P(a,e,c){function b(a){if(a in h){var z=h[a];a=!0;var c=z.x|0,I=z.y|0,y,g;"width"in z?y=z.width|0:a=!1;"height"in z?g=z.height|0:a=!1;return new p(!a&&e&&e.thisDep,!a&&e&&e.contextDep,!a&&e&&e.propDep,function(a,e){var d=a.shared.context,R=y;"width"in z||(R=e.def(d,".","framebufferWidth","-",c));var b=g;"height"in z||(b=e.def(d,".",
"framebufferHeight","-",I));return[c,I,R,b]})}if(a in l){var T=l[a];a=d(T,function(a,e){var z=a.invoke(e,T),c=a.shared.context,I=e.def(z,".x|0"),y=e.def(z,".y|0"),d=e.def('"width" in ',z,"?",z,".width|0:","(",c,".","framebufferWidth","-",I,")"),z=e.def('"height" in ',z,"?",z,".height|0:","(",c,".","framebufferHeight","-",y,")");return[I,y,d,z]});e&&(a.thisDep=a.thisDep||e.thisDep,a.contextDep=a.contextDep||e.contextDep,a.propDep=a.propDep||e.propDep);return a}return e?new p(e.thisDep,e.contextDep,
e.propDep,function(a,e){var z=a.shared.context;return[0,0,e.def(z,".","framebufferWidth"),e.def(z,".","framebufferHeight")]}):null}var h=a["static"],l=a.dynamic;if(a=b("viewport")){var g=a;a=new p(a.thisDep,a.contextDep,a.propDep,function(a,e){var c=g.append(a,e),I=a.shared.context;e.set(I,".viewportWidth",c[2]);e.set(I,".viewportHeight",c[3]);return c})}return{viewport:a,scissor_box:b("scissor.box")}}function ca(a){function e(a){if(a in c){var z=n.id(c[a]);a=h(function(){return z});a.id=z;return a}if(a in
b){var y=b[a];return d(y,function(a,e){var z=a.invoke(e,y);return e.def(a.shared.strings,".id(",z,")")})}return null}var c=a["static"],b=a.dynamic,l=e("frag"),g=e("vert"),T=null;E(l)&&E(g)?(T=ta.program(g.id,l.id),a=h(function(a,e){return a.link(T)})):a=new p(l&&l.thisDep||g&&g.thisDep,l&&l.contextDep||g&&g.contextDep,l&&l.propDep||g&&g.propDep,function(a,e){var c=a.shared.shader,I;I=l?l.append(a,e):e.def(c,".","frag");var y;y=g?g.append(a,e):e.def(c,".","vert");return e.def(c+".program("+y+","+I+
")")});return{frag:l,vert:g,progVar:a,program:T}}function da(a,e){function c(a,e){if(a in b){var y=b[a]|0;return h(function(a,c){e&&(a.OFFSET=y);return y})}if(a in l){var I=l[a];return d(I,function(a,c){var y=a.invoke(c,I);e&&(a.OFFSET=y);return y})}return e&&g?h(function(a,e){a.OFFSET="0";return 0}):null}var b=a["static"],l=a.dynamic,g=function(){if("elements"in b){var a=b.elements;k(a)?a=ma.getElements(ma.create(a,!0)):a&&(a=ma.getElements(a));var e=h(function(e,c){if(a){var z=e.link(a);return e.ELEMENTS=
z}return e.ELEMENTS=null});e.value=a;return e}if("elements"in l){var c=l.elements;return d(c,function(a,e){var z=a.shared,y=z.isBufferArgs,z=z.elements,d=a.invoke(e,c),b=e.def("null"),y=e.def(y,"(",d,")"),d=a.cond(y).then(b,"=",z,".createStream(",d,");")["else"](b,"=",z,".getElements(",d,");");e.entry(d);e.exit(a.cond(y).then(z,".destroyStream(",b,");"));return a.ELEMENTS=b})}return null}(),T=c("offset",!0);return{elements:g,primitive:function(){if("primitive"in b){var a=b.primitive;return h(function(e,
c){return H[a]})}if("primitive"in l){var e=l.primitive;return d(e,function(a,c){var y=a.constants.primTypes,d=a.invoke(c,e);return c.def(y,"[",d,"]")})}return g?E(g)?g.value?h(function(a,e){return e.def(a.ELEMENTS,".primType")}):h(function(){return 4}):new p(g.thisDep,g.contextDep,g.propDep,function(a,e){var c=a.ELEMENTS;return e.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in b){var a=b.count|0;return h(function(){return a})}if("count"in l){var e=l.count;return d(e,function(a,
c){return a.invoke(c,e)})}return g?E(g)?g?T?new p(T.thisDep,T.contextDep,T.propDep,function(a,e){return e.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):h(function(a,e){return e.def(a.ELEMENTS,".vertCount")}):h(function(){return-1}):new p(g.thisDep||T.thisDep,g.contextDep||T.contextDep,g.propDep||T.propDep,function(a,e){var c=a.ELEMENTS;return a.OFFSET?e.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):e.def(c,"?",c,".vertCount:-1")}):null}(),instances:c("instances",!1),offset:T}}function ra(a,e){var c=a["static"],
b=a.dynamic,g={};Ha.forEach(function(a){function e(z,R){if(a in c){var I=z(c[a]);g[y]=h(function(){return I})}else if(a in b){var l=b[a];g[y]=d(l,function(a,e){return R(a,e,a.invoke(e,l))})}}var y=V(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return e(function(a){return a},function(a,e,c){return c});case "depth.func":return e(function(a){return G[a]},
function(a,e,c){return e.def(a.constants.compareFuncs,"[",c,"]")});case "depth.range":return e(function(a){return a},function(a,e,c){a=e.def("+",c,"[0]");e=e.def("+",c,"[1]");return[a,e]});case "blend.func":return e(function(a){return[l["srcRGB"in a?a.srcRGB:a.src],l["dstRGB"in a?a.dstRGB:a.dst],l["srcAlpha"in a?a.srcAlpha:a.src],l["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,e,c){function y(a,z){return e.def('"',a,z,'" in ',c,"?",c,".",a,z,":",c,".",a)}a=a.constants.blendFuncs;var d=y("src","RGB"),
b=y("dst","RGB"),d=e.def(a,"[",d,"]"),R=e.def(a,"[",y("src","Alpha"),"]"),b=e.def(a,"[",b,"]");a=e.def(a,"[",y("dst","Alpha"),"]");return[d,b,R,a]});case "blend.equation":return e(function(a){if("string"===typeof a)return[ea[a],ea[a]];if("object"===typeof a)return[ea[a.rgb],ea[a.alpha]]},function(a,e,c){var y=a.constants.blendEquations,d=e.def(),b=e.def();a=a.cond("typeof ",c,'==="string"');a.then(d,"=",b,"=",y,"[",c,"];");a["else"](d,"=",y,"[",c,".rgb];",b,"=",y,"[",c,".alpha];");e(a);return[d,b]});
case "blend.color":return e(function(a){return u(4,function(e){return+a[e]})},function(a,e,c){return u(4,function(a){return e.def("+",c,"[",a,"]")})});case "stencil.mask":return e(function(a){return a|0},function(a,e,c){return e.def(c,"|0")});case "stencil.func":return e(function(a){return[G[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,e,c){a=e.def('"cmp" in ',c,"?",a.constants.compareFuncs,"[",c,".cmp]",":",7680);var y=e.def(c,".ref|0");e=e.def('"mask" in ',c,"?",c,".mask|0:-1");return[a,
y,e]});case "stencil.opFront":case "stencil.opBack":return e(function(e){return["stencil.opBack"===a?1029:1028,D[e.fail||"keep"],D[e.zfail||"keep"],D[e.zpass||"keep"]]},function(e,c,y){function d(a){return c.def('"',a,'" in ',y,"?",b,"[",y,".",a,"]:",7680)}var b=e.constants.stencilOps;return["stencil.opBack"===a?1029:1028,d("fail"),d("zfail"),d("zpass")]});case "polygonOffset.offset":return e(function(a){return[a.factor|0,a.units|0]},function(a,e,c){a=e.def(c,".factor|0");e=e.def(c,".units|0");return[a,
e]});case "cull.face":return e(function(a){var e=0;"front"===a?e=1028:"back"===a&&(e=1029);return e},function(a,e,c){return e.def(c,'==="front"?',1028,":",1029)});case "lineWidth":return e(function(a){return a},function(a,e,c){return c});case "frontFace":return e(function(a){return A[a]},function(a,e,c){return e.def(c+'==="cw"?2304:2305')});case "colorMask":return e(function(a){return a.map(function(a){return!!a})},function(a,e,c){return u(4,function(a){return"!!"+c+"["+a+"]"})});case "sample.coverage":return e(function(a){return["value"in
a?a.value:1,!!a.invert]},function(a,e,c){a=e.def('"value" in ',c,"?+",c,".value:1");e=e.def("!!",c,".invert");return[a,e]})}});return g}function fa(a,e){var c=a["static"],b=a.dynamic,g={};Object.keys(c).forEach(function(a){var e=c[a],y;if("number"===typeof e||"boolean"===typeof e)y=h(function(){return e});else if("function"===typeof e){var d=e._reglType;if("texture2d"===d||"textureCube"===d)y=h(function(a){return a.link(e)});else if("framebuffer"===d||"framebufferCube"===d)y=h(function(a){return a.link(e.color[0])})}else r(e)&&
(y=h(function(a){return a.global.def("[",u(e.length,function(a){return e[a]}),"]")}));y.value=e;g[a]=y});Object.keys(b).forEach(function(a){var e=b[a];g[a]=d(e,function(a,c){return a.invoke(c,e)})});return g}function W(a,e){var c=a["static"],b=a.dynamic,g={};Object.keys(c).forEach(function(a){var e=c[a],y=n.id(a),d=new w;if(k(e))d.state=1,d.buffer=F.getBuffer(F.create(e,34962,!1,!0)),d.type=d.buffer.dtype;else{var b=F.getBuffer(e);if(b)d.state=1,d.buffer=b,d.type=b.dtype;else if(e.constant){var R=
e.constant;d.buffer="null";d.state=2;"number"===typeof R?d.x=R:C.forEach(function(a,e){e<R.length&&(d[a]=R[e])})}else{var b=k(e.buffer)?F.getBuffer(F.create(e.buffer,34962,!1,!0)):F.getBuffer(e.buffer),l=e.offset|0,f=e.stride|0,v=e.size|0,t=!!e.normalized,m=0;"type"in e&&(m=x[e.type]);e=e.divisor|0;d.buffer=b;d.state=1;d.size=v;d.normalized=t;d.type=m||b.dtype;d.offset=l;d.stride=f;d.divisor=e}}g[a]=h(function(a,e){var c=a.attribCache;if(y in c)return c[y];var b={isStream:!1};Object.keys(d).forEach(function(a){b[a]=
d[a]});d.buffer&&(b.buffer=a.link(d.buffer));return c[y]=b})});Object.keys(b).forEach(function(a){var e=b[a];g[a]=d(e,function(a,c){function d(a){c(l[a],"=",y,".",a,"|0;")}var y=a.invoke(c,e),b=a.shared,R=b.isBufferArgs,g=b.buffer,l={isStream:c.def(!1)},h=new w;h.state=1;Object.keys(h).forEach(function(a){l[a]=c.def(""+h[a])});var f=l.buffer,v=l.type;c("if(",R,"(",y,")){",l.isStream,"=true;",f,"=",g,".createStream(",34962,",",y,");",v,"=",f,".dtype;","}else{",f,"=",g,".getBuffer(",y,");","if(",f,
"){",v,"=",f,".dtype;",'}else if("constant" in ',y,"){",l.state,"=",2,";","if(typeof "+y+'.constant === "number"){',l[C[0]],"=",y,".constant;",C.slice(1).map(function(a){return l[a]}).join("="),"=0;","}else{",C.map(function(a,e){return l[a]+"="+y+".constant.length>="+e+"?"+y+".constant["+e+"]:0;"}).join(""),"}}else{","if(",R,"(",y,".buffer)){",f,"=",g,".createStream(",34962,",",y,".buffer);","}else{",f,"=",g,".getBuffer(",y,".buffer);","}",v,'="type" in ',y,"?",b.glTypes,"[",y,".type]:",f,".dtype;",
l.normalized,"=!!",y,".normalized;");d("size");d("offset");d("stride");d("divisor");c("}}");c.exit("if(",l.isStream,"){",g,".destroyStream(",f,");","}");return l})});return g}function sa(a){var e=a["static"],c=a.dynamic,b={};Object.keys(e).forEach(function(a){var c=e[a];b[a]=h(function(a,e){return"number"===typeof c||"boolean"===typeof c?""+c:a.link(c)})});Object.keys(c).forEach(function(a){var e=c[a];b[a]=d(e,function(a,c){return a.invoke(c,e)})});return b}function qa(a,e,c,d,b){var l=ya(a,b),g=
P(a,l,b),h=da(a,b),f=ra(a,b),v=ca(a,b),w=g.viewport;w&&(f.viewport=w);w=V("scissor.box");(g=g[w])&&(f[w]=g);g=0<Object.keys(f).length;l={framebuffer:l,draw:h,shader:v,state:f,dirty:g};l.profile=pa(a,b);l.uniforms=fa(c,b);l.attributes=W(e,b);l.context=sa(d,b);return l}function K(a,e,c){var d=a.shared.context,b=a.scope();Object.keys(c).forEach(function(l){e.save(d,"."+l);b(d,".",l,"=",c[l].append(a,e),";")});e(b)}function ga(a,e,c,d){var b=a.shared,l=b.gl,g=b.framebuffer,h;Ja&&(h=e.def(b.extensions,
".webgl_draw_buffers"));var f=a.constants,b=f.drawBuffer,f=f.backBuffer;a=c?c.append(a,e):e.def(g,".next");d||e("if(",a,"!==",g,".cur){");e("if(",a,"){",l,".bindFramebuffer(",36160,",",a,".framebuffer);");Ja&&e(h,".drawBuffersWEBGL(",b,"[",a,".colorAttachments.length]);");e("}else{",l,".bindFramebuffer(",36160,",null);");Ja&&e(h,".drawBuffersWEBGL(",f,");");e("}",g,".cur=",a,";");d||e("}")}function ja(a,e,c){var d=a.shared,b=d.gl,l=a.current,g=a.next,h=d.current,f=d.next,w=a.cond(h,".dirty");Ha.forEach(function(e){e=
V(e);if(!(e in c.state)){var d,R;if(e in g){d=g[e];R=l[e];var v=u(ua[e].length,function(a){return w.def(d,"[",a,"]")});w(a.cond(v.map(function(a,e){return a+"!=="+R+"["+e+"]"}).join("||")).then(b,".",wa[e],"(",v,");",v.map(function(a,e){return R+"["+e+"]="+a}).join(";"),";"))}else d=w.def(f,".",e),v=a.cond(d,"!==",h,".",e),w(v),e in va?v(a.cond(d).then(b,".enable(",va[e],");")["else"](b,".disable(",va[e],");"),h,".",e,"=",d,";"):v(b,".",wa[e],"(",d,");",h,".",e,"=",d,";")}});0===Object.keys(c.state).length&&
w(h,".dirty=false;");e(w)}function N(e,c,d,b){var l=e.shared,g=e.current,h=l.current,f=l.gl;a(Object.keys(d)).forEach(function(a){var l=d[a];if(!b||b(l)){var v=l.append(e,c);if(va[a]){var w=va[a];E(l)?v?c(f,".enable(",w,");"):c(f,".disable(",w,");"):c(e.cond(v).then(f,".enable(",w,");")["else"](f,".disable(",w,");"));c(h,".",a,"=",v,";")}else if(r(v)){var k=g[a];c(f,".",wa[a],"(",v,");",v.map(function(a,e){return k+"["+e+"]="+a}).join(";"),";")}else c(f,".",wa[a],"(",v,");",h,".",a,"=",v,";")}})}
function U(a,e){Ca&&(a.instancing=e.def(a.shared.extensions,".angle_instanced_arrays"))}function X(a,e,c,d,b){function l(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function g(a){t=e.def();a(t,"=",l(),";");"string"===typeof b?a(w,".count+=",b,";"):a(w,".count++;");aa&&(d?(p=e.def(),a(p,"=",m,".getNumPendingQueries();")):a(m,".beginQuery(",w,");"))}function h(a){a(w,".cpuTime+=",l(),"-",t,";");aa&&(d?a(m,".pushScopeStats(",p,",",m,".getNumPendingQueries(),",w,");"):a(m,
".endQuery();"))}function f(a){var c=e.def(k,".profile");e(k,".profile=",a,";");e.exit(k,".profile=",c,";")}var v=a.shared,w=a.stats,k=v.current,m=v.timer;c=c.profile;var t,p;if(c){if(E(c)){c.enable?(g(e),h(e.exit),f("true")):f("false");return}c=c.append(a,e);f(c)}else c=e.def(k,".profile");v=a.block();g(v);e("if(",c,"){",v,"}");a=a.block();h(a);e.exit("if(",c,"){",a,"}")}function Y(a,e,d,b,l){function g(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;
case 35666:case 35669:case 35673:return 4;default:return 1}}function h(c,d,b){function l(){e("if(!",k,".buffer){",v,".enableVertexAttribArray(",w,");}");var c=b.type,g;g=b.size?e.def(b.size,"||",d):d;e("if(",k,".type!==",c,"||",k,".size!==",g,"||",p.map(function(a){return k+"."+a+"!=="+b[a]}).join("||"),"){",v,".bindBuffer(",34962,",",m,".buffer);",v,".vertexAttribPointer(",[w,g,c,b.normalized,b.stride,b.offset],");",k,".type=",c,";",k,".size=",g,";",p.map(function(a){return k+"."+a+"="+b[a]+";"}).join(""),
"}");Ca&&(c=b.divisor,e("if(",k,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[w,c],");",k,".divisor=",c,";}"))}function g(){e("if(",k,".buffer){",v,".disableVertexAttribArray(",w,");","}if(",C.map(function(a,e){return k+"."+a+"!=="+t[e]}).join("||"),"){",v,".vertexAttrib4f(",w,",",t,");",C.map(function(a,e){return k+"."+a+"="+t[e]+";"}).join(""),"}")}var v=f.gl,w=e.def(c,".location"),k=e.def(f.attributes,"[",w,"]");c=b.state;var m=b.buffer,t=[b.x,b.y,b.z,b.w],p=["buffer","normalized",
"offset","stride"];1===c?l():2===c?g():(e("if(",c,"===",1,"){"),l(),e("}else{"),g(),e("}"))}var f=a.shared;b.forEach(function(b){var f=b.name,v=d.attributes[f],k;if(v){if(!l(v))return;k=v.append(a,e)}else{if(!l(c))return;var m=a.scopeAttrib(f);k={};Object.keys(new w).forEach(function(a){k[a]=e.def(m,".",a)})}h(a.link(b),g(b.info.type),k)})}function ba(a,e,d,b,l){for(var g=a.shared,h=g.gl,f,v=0;v<b.length;++v){var w=b[v],k=w.name,m=w.info.type,t=d.uniforms[k],w=a.link(w)+".location",p;if(t){if(!l(t))continue;
if(E(t)){k=t.value;if(35678===m||35680===m)m=a.link(k._texture||k.color[0]._texture),e(h,".uniform1i(",w,",",m+".bind());"),e.exit(m,".unbind();");else if(35674===m||35675===m||35676===m)k=a.global.def("new Float32Array(["+Array.prototype.slice.call(k)+"])"),t=2,35675===m?t=3:35676===m&&(t=4),e(h,".uniformMatrix",t,"fv(",w,",false,",k,");");else{switch(m){case 5126:f="1f";break;case 35664:f="2f";break;case 35665:f="3f";break;case 35666:f="4f";break;case 35670:f="1i";break;case 5124:f="1i";break;case 35671:f=
"2i";break;case 35667:f="2i";break;case 35672:f="3i";break;case 35668:f="3i";break;case 35673:f="4i";break;case 35669:f="4i"}e(h,".uniform",f,"(",w,",",r(k)?Array.prototype.slice.call(k):k,");")}continue}else p=t.append(a,e)}else{if(!l(c))continue;p=e.def(g.uniforms,"[",n.id(k),"]")}35678===m?e("if(",p,"&&",p,'._reglType==="framebuffer"){',p,"=",p,".color[0];","}"):35680===m&&e("if(",p,"&&",p,'._reglType==="framebufferCube"){',p,"=",p,".color[0];","}");k=1;switch(m){case 35678:case 35680:m=e.def(p,
"._texture");e(h,".uniform1i(",w,",",m,".bind());");e.exit(m,".unbind();");continue;case 5124:case 35670:f="1i";break;case 35667:case 35671:f="2i";k=2;break;case 35668:case 35672:f="3i";k=3;break;case 35669:case 35673:f="4i";k=4;break;case 5126:f="1f";break;case 35664:f="2f";k=2;break;case 35665:f="3f";k=3;break;case 35666:f="4f";k=4;break;case 35674:f="Matrix2fv";break;case 35675:f="Matrix3fv";break;case 35676:f="Matrix4fv"}e(h,".uniform",f,"(",w,",");if("M"===f.charAt(0)){var w=Math.pow(m-35674+
2,2),A=a.global.def("new Float32Array(",w,")");e("false,(Array.isArray(",p,")||",p," instanceof Float32Array)?",p,":(",u(w,function(a){return A+"["+a+"]="+p+"["+a+"]"}),",",A,")")}else 1<k?e(u(k,function(a){return p+"["+a+"]"})):e(p);e(");")}}function ha(a,e,c,d){function b(l){var g=v[l];return g?g.contextDep&&d.contextDynamic||g.propDep?g.append(a,c):g.append(a,e):e.def(w,".",l)}function l(){function a(){c(u,".drawElementsInstancedANGLE(",[m,p,ea,t+"<<(("+ea+"-5121)>>1)",A],");")}function e(){c(u,
".drawArraysInstancedANGLE(",[m,t,p,A],");")}k?r?a():(c("if(",k,"){"),a(),c("}else{"),e(),c("}")):e()}function g(){function a(){c(f+".drawElements("+[m,p,ea,t+"<<(("+ea+"-5121)>>1)"]+");")}function e(){c(f+".drawArrays("+[m,t,p]+");")}k?r?a():(c("if(",k,"){"),a(),c("}else{"),e(),c("}")):e()}var h=a.shared,f=h.gl,w=h.draw,v=d.draw,k=function(){var b=v.elements,l=e;if(b){if(b.contextDep&&d.contextDynamic||b.propDep)l=c;b=b.append(a,l)}else b=l.def(w,".","elements");b&&l("if("+b+")"+f+".bindBuffer(34963,"+
b+".buffer.buffer);");return b}(),m=b("primitive"),t=b("offset"),p=function(){var b=v.count,l=e;if(b){if(b.contextDep&&d.contextDynamic||b.propDep)l=c;b=b.append(a,l)}else b=l.def(w,".","count");return b}();if("number"===typeof p){if(0===p)return}else c("if(",p,"){"),c.exit("}");var A,u;Ca&&(A=b("instances"),u=a.instancing);var ea=k+".type",r=v.elements&&E(v.elements);Ca&&("number"!==typeof A||0<=A)?"string"===typeof A?(c("if(",A,">0){"),l(),c("}else if(",A,"<0){"),g(),c("}")):l():g()}function Da(a,
e,c,b,d){e=xa();d=e.proc("body",d);Ca&&(e.instancing=d.def(e.shared.extensions,".angle_instanced_arrays"));a(e,d,c,b);return e.compile().body}function Ea(a,e,c,b){U(a,e);Y(a,e,c,b.attributes,function(){return!0});ba(a,e,c,b.uniforms,function(){return!0});ha(a,e,e,c)}function Ka(a,e){var c=a.proc("draw",1);U(a,c);K(a,c,e.context);ga(a,c,e.framebuffer);ja(a,c,e);N(a,c,e.state);X(a,c,e,!1,!0);var b=e.shader.progVar.append(a,c);c(a.shared.gl,".useProgram(",b,".program);");if(e.shader.program)Ea(a,c,e,
e.shader.program);else{var d=a.global.def("{}"),l=c.def(b,".id"),g=c.def(d,"[",l,"]");c(a.cond(g).then(g,".call(this,a0);")["else"](g,"=",d,"[",l,"]=",a.link(function(c){return Da(Ea,a,e,c,1)}),"(",b,");",g,".call(this,a0);"))}0<Object.keys(e.state).length&&c(a.shared.current,".dirty=true;")}function La(a,e,c,b){function d(){return!0}a.batchId="a1";U(a,e);Y(a,e,c,b.attributes,d);ba(a,e,c,b.uniforms,d);ha(a,e,e,c)}function ka(a,e,c,b){function d(a){return a.contextDep&&g||a.propDep}function l(a){return!d(a)}
U(a,e);var g=c.contextDep,h=e.def(),f=e.def();a.shared.props=f;a.batchId=h;var v=a.scope(),w=a.scope();e(v.entry,"for(",h,"=0;",h,"<","a1",";++",h,"){",f,"=","a0","[",h,"];",w,"}",v.exit);c.needsContext&&K(a,w,c.context);c.needsFramebuffer&&ga(a,w,c.framebuffer);N(a,w,c.state,d);c.profile&&d(c.profile)&&X(a,w,c,!1,!0);b?(Y(a,v,c,b.attributes,l),Y(a,w,c,b.attributes,d),ba(a,v,c,b.uniforms,l),ba(a,w,c,b.uniforms,d),ha(a,v,w,c)):(e=a.global.def("{}"),b=c.shader.progVar.append(a,w),f=w.def(b,".id"),v=
w.def(e,"[",f,"]"),w(a.shared.gl,".useProgram(",b,".program);","if(!",v,"){",v,"=",e,"[",f,"]=",a.link(function(e){return Da(La,a,c,e,2)}),"(",b,");}",v,".call(this,a0[",h,"],",h,");"))}function Fa(a,e){function c(a){return a.contextDep&&d||a.propDep}var b=a.proc("batch",2);a.batchId="0";U(a,b);var d=!1,l=!0;Object.keys(e.context).forEach(function(a){d=d||e.context[a].propDep});d||(K(a,b,e.context),l=!1);var g=e.framebuffer,h=!1;g?(g.propDep?d=h=!0:g.contextDep&&d&&(h=!0),h||ga(a,b,g)):ga(a,b,null);
e.state.viewport&&e.state.viewport.propDep&&(d=!0);ja(a,b,e);N(a,b,e.state,function(a){return!c(a)});e.profile&&c(e.profile)||X(a,b,e,!1,"a1");e.contextDep=d;e.needsContext=l;e.needsFramebuffer=h;l=e.shader.progVar;if(l.contextDep&&d||l.propDep)ka(a,b,e,null);else if(l=l.append(a,b),b(a.shared.gl,".useProgram(",l,".program);"),e.shader.program)ka(a,b,e,e.shader.program);else{var g=a.global.def("{}"),h=b.def(l,".id"),f=b.def(g,"[",h,"]");b(a.cond(f).then(f,".call(this,a0,a1);")["else"](f,"=",g,"[",
h,"]=",a.link(function(c){return Da(ka,a,e,c,2)}),"(",l,");",f,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&b(a.shared.current,".dirty=true;")}function Aa(e,c){function b(a){var g=c.shader[a];g&&d.set(l.shader,"."+a,g.append(e,d))}var d=e.proc("scope",3);e.batchId="a2";var l=e.shared,g=l.current;K(e,d,c.context);c.framebuffer&&c.framebuffer.append(e,d);a(Object.keys(c.state)).forEach(function(a){var b=c.state[a].append(e,d);r(b)?b.forEach(function(c,b){d.set(e.next[a],"["+b+"]",c)}):d.set(l.next,
"."+a,b)});X(e,d,c,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(a){var b=c.draw[a];b&&d.set(l.draw,"."+a,""+b.append(e,d))});Object.keys(c.uniforms).forEach(function(a){d.set(l.uniforms,"["+n.id(a)+"]",c.uniforms[a].append(e,d))});Object.keys(c.attributes).forEach(function(a){var b=c.attributes[a].append(e,d),l=e.scopeAttrib(a);Object.keys(new w).forEach(function(a){d.set(l,"."+a,b[a])})});b("vert");b("frag");0<Object.keys(c.state).length&&(d(g,".dirty=true;"),d.exit(g,
".dirty=true;"));d("a1(",e.shared.context,",a0,",e.batchId,");")}function e(a){if("object"===typeof a&&!r(a)){for(var e=Object.keys(a),c=0;c<e.length;++c)if(m.isDynamic(a[e[c]]))return!0;return!1}}function v(a,c,b){function l(a,e){f.forEach(function(c){var b=g[c];m.isDynamic(b)&&(b=a.invoke(e,b),e(t,".",c,"=",b,";"))})}var g=c["static"][b];if(g&&e(g)){var h=a.global,f=Object.keys(g),w=!1,v=!1,k=!1,t=a.global.def("{}");f.forEach(function(e){var c=g[e];if(m.isDynamic(c))"function"===typeof c&&(c=g[e]=
m.unbox(c)),e=d(c,null),w=w||e.thisDep,k=k||e.propDep,v=v||e.contextDep;else{h(t,".",e,"=");switch(typeof c){case "number":h(c);break;case "string":h('"',c,'"');break;case "object":Array.isArray(c)&&h("[",c.join(),"]");break;default:h(a.link(c))}h(";")}});c.dynamic[b]=new m.DynamicVariable(4,{thisDep:w,contextDep:v,propDep:k,ref:t,append:l});delete c["static"][b]}}var w=oa.Record,ea={add:32774,subtract:32778,"reverse subtract":32779};q.ext_blend_minmax&&(ea.min=32775,ea.max=32776);var Ca=q.angle_instanced_arrays,
Ja=q.webgl_draw_buffers,ua={dirty:!0,profile:ia.profile},Ba={},Ha=[],va={},wa={};L("dither",3024);L("blend.enable",3042);B("blend.color","blendColor",[0,0,0,0]);B("blend.equation","blendEquationSeparate",[32774,32774]);B("blend.func","blendFuncSeparate",[1,0,1,0]);L("depth.enable",2929,!0);B("depth.func","depthFunc",513);B("depth.range","depthRange",[0,1]);B("depth.mask","depthMask",!0);B("colorMask","colorMask",[!0,!0,!0,!0]);L("cull.enable",2884);B("cull.face","cullFace",1029);B("frontFace","frontFace",
2305);B("lineWidth","lineWidth",1);L("polygonOffset.enable",32823);B("polygonOffset.offset","polygonOffset",[0,0]);L("sample.alpha",32926);L("sample.enable",32928);B("sample.coverage","sampleCoverage",[1,!1]);L("stencil.enable",2960);B("stencil.mask","stencilMask",-1);B("stencil.func","stencilFunc",[519,0,-1]);B("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);B("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);L("scissor.enable",3089);B("scissor.box","scissor",[0,0,f.drawingBufferWidth,
f.drawingBufferHeight]);B("viewport","viewport",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);var Ma={gl:f,context:Z,strings:n,next:Ba,current:ua,draw:t,elements:ma,buffer:F,shader:ta,attributes:oa.state,uniforms:Q,framebuffer:M,extensions:q,timer:aa,isBufferArgs:k},Ia={primTypes:H,compareFuncs:G,blendFuncs:l,blendEquations:ea,stencilOps:D,glTypes:x,orientationType:A};Ja&&(Ia.backBuffer=[1029],Ia.drawBuffer=u(J.maxDrawbuffers,function(a){return 0===a?[0]:u(a,function(a){return 36064+a})}));var Na=
0;return{next:Ba,current:ua,procs:function(){var a=xa(),e=a.proc("poll"),c=a.proc("refresh"),b=a.block();e(b);c(b);var d=a.shared,l=d.gl,g=d.next,h=d.current;b(h,".dirty=false;");ga(a,e);ga(a,c,null,!0);var w=f.getExtension("angle_instanced_arrays"),v;w&&(v=a.link(w));for(var k=0;k<J.maxAttributes;++k){var m=c.def(d.attributes,"[",k,"]"),t=a.cond(m,".buffer");t.then(l,".enableVertexAttribArray(",k,");",l,".bindBuffer(",34962,",",m,".buffer.buffer);",l,".vertexAttribPointer(",k,",",m,".size,",m,".type,",
m,".normalized,",m,".stride,",m,".offset);")["else"](l,".disableVertexAttribArray(",k,");",l,".vertexAttrib4f(",k,",",m,".x,",m,".y,",m,".z,",m,".w);",m,".buffer=null;");c(t);w&&c(v,".vertexAttribDivisorANGLE(",k,",",m,".divisor);")}Object.keys(va).forEach(function(d){var f=va[d],w=b.def(g,".",d),v=a.block();v("if(",w,"){",l,".enable(",f,")}else{",l,".disable(",f,")}",h,".",d,"=",w,";");c(v);e("if(",w,"!==",h,".",d,"){",v,"}")});Object.keys(wa).forEach(function(d){var f=wa[d],w=ua[d],v,k,m=a.block();
m(l,".",f,"(");r(w)?(f=w.length,v=a.global.def(g,".",d),k=a.global.def(h,".",d),m(u(f,function(a){return v+"["+a+"]"}),");",u(f,function(a){return k+"["+a+"]="+v+"["+a+"];"}).join("")),e("if(",u(f,function(a){return v+"["+a+"]!=="+k+"["+a+"]"}).join("||"),"){",m,"}")):(v=b.def(g,".",d),k=b.def(h,".",d),m(v,");",h,".",d,"=",v,";"),e("if(",v,"!==",k,"){",m,"}"));c(m)});return a.compile()}(),compile:function(a,e,c,b,d){var l=xa();l.stats=l.link(d);Object.keys(e["static"]).forEach(function(a){v(l,e,a)});
g.forEach(function(e){v(l,a,e)});c=qa(a,e,c,b,l);Ka(l,c);Aa(l,c);Fa(l,c);return l.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(f,n,q){function k(a,d){this.id=E++;this.type=a;this.data=d}function a(h){if(0===h.length)return[];var d=h.charAt(0),b=h.charAt(h.length-1);if(1<h.length&&d===b&&('"'===d||"'"===d))return['"'+h.substr(1,h.length-
2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(d=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(h))return a(h.substr(0,d.index)).concat(a(d[1])).concat(a(h.substr(d.index+d[0].length)));d=h.split(".");if(1===d.length)return['"'+h.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];h=[];for(b=0;b<d.length;++b)h=h.concat(a(d[b]));return h}function p(h){return"["+a(h).join("][")+"]"}var E=0;n.exports={DynamicVariable:k,define:function(a,d){return new k(a,p(d+""))},isDynamic:function(a){return"function"===
typeof a&&!a._reglType||a instanceof k},unbox:function(a,d){return"function"===typeof a?new k(0,a):a},accessor:p}},{}],10:[function(f,n,q){var k=f("./util/is-typed-array"),a=f("./util/is-ndarray"),p=f("./util/values"),E=f("./constants/primitives.json"),h=f("./constants/usage.json");n.exports=function(d,b,f,n){function q(a){this.id=x++;H[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function r(d,g,h,m,c,p,r){(p=r)||k(g)&&(!a(g)||k(g.data))||(p=b.oes_element_index_uint?5125:
5123);d.buffer.bind();f._initBuffer(d.buffer,g,h,p,3);g=r;if(!r){switch(d.buffer.dtype){case 5121:case 5120:g=5121;break;case 5123:case 5122:g=5123;break;case 5125:case 5124:g=5125}d.buffer.dtype=g}d.type=g;0>c&&(c=d.buffer.byteLength,5123===g?c>>=1:5125===g&&(c>>=2));d.vertCount=c;c=m;0>m&&(c=4,m=d.buffer.dimension,1===m&&(c=0),2===m&&(c=1),3===m&&(c=4));d.primType=c}function m(a){n.elementsCount--;delete H[a.id];a.buffer.destroy();a.buffer=null}var H={},x=0,C={uint8:5121,uint16:5123};b.oes_element_index_uint&&
(C.uint32=5125);q.prototype.bind=function(){this.buffer.bind()};var g=[];return{create:function(b,g){function p(b){if(b)if("number"===typeof b)A(b),c.primType=4,c.vertCount=b|0,c.type=5121;else{var g=null,l=35044,f=-1,m=-1,u=0,x=0;Array.isArray(b)||k(b)||a(b)?g=b:("data"in b&&(g=b.data),"usage"in b&&(l=h[b.usage]),"primitive"in b&&(f=E[b.primitive]),"count"in b&&(m=b.count|0),"length"in b&&(u=b.length|0),"type"in b&&(x=C[b.type]));g?r(c,g,l,f,m,u,x):(b=c.buffer,b.bind(),d.bufferData(34963,u,l),b.dtype=
x||5121,b.usage=l,b.dimension=3,b.byteLength=u,c.primType=0>f?4:f,c.vertCount=0>m?0:m,c.type=b.dtype)}else A(),c.primType=4,c.vertCount=0,c.type=5121;return p}var A=f.create(null,34963,!0),c=new q(A._buffer);n.elementsCount++;p(b);p._reglType="elements";p._elements=c;p.subdata=function(a,c){A.subdata(a,c);return p};p.destroy=function(){m(c)};return p},createStream:function(a){var b=g.pop();b||(b=new q(f.create(null,34963,!0,!1)._buffer));r(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){g.push(a)},
getElements:function(a){return"function"===typeof a&&a._elements instanceof q?a._elements:null},clear:function(){p(H).forEach(m)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(f,n,q){n.exports=function(f,a){function p(a){a=a.toLowerCase();var d;try{d=E[a]=f.getExtension(a)}catch(h){}return!!d}for(var E={},h=0;h<a.extensions.length;++h){var d=a.extensions[h];if(!p(d))return a.onDestroy(),a.onDone('"'+
d+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}a.optionalExtensions.forEach(p);return{extensions:E,restore:function(){Object.keys(E).forEach(function(a){if(!p(a))throw Error("(regl): error restoring extension "+a);})}}}},{}],12:[function(f,n,q){var k=f("./util/values"),a=f("./util/extend"),p=[];p[6408]=4;var E=[];E[5121]=1;E[5126]=4;E[36193]=2;n.exports=function(f,d,b,u,n,q){function r(a,c,b){this.target=a;this.texture=c;this.renderbuffer=
b;var d=a=0;c?(a=c.width,d=c.height):b&&(a=b.width,d=b.height);this.width=a;this.height=d}function m(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function H(a,c,b){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function x(a,c){c?c.texture?f.framebufferTexture2D(36160,a,c.target,c.texture._texture.texture,0):f.framebufferRenderbuffer(36160,a,36161,c.renderbuffer._renderbuffer.renderbuffer):f.framebufferTexture2D(36160,
a,3553,null,0)}function C(a){var c=3553,b=null,d=null,g=a;"object"===typeof a&&(g=a.data,"target"in a&&(c=a.target|0));a=g._reglType;"texture2d"===a?b=g:"textureCube"===a?b=g:"renderbuffer"===a&&(d=g,c=36161);return new r(c,b,d)}function g(a,c,b,d,g){if(b)return a=u.create2D({width:a,height:c,format:d,type:g}),a._texture.refCount=0,new r(3553,a,null);a=n.create({width:a,height:c,format:d});a._renderbuffer.refCount=0;return new r(36161,null,a)}function l(a){return a&&(a.texture||a.renderbuffer)}function G(a,
c,b){a&&(a.texture?a.texture.resize(c,b):a.renderbuffer&&a.renderbuffer.resize(c,b))}function D(){this.id=na++;M[this.id]=this;this.framebuffer=f.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function A(a){a.colorAttachments.forEach(m);m(a.depthAttachment);m(a.stencilAttachment);m(a.depthStencilAttachment)}function c(a){f.deleteFramebuffer(a.framebuffer);a.framebuffer=null;q.framebufferCount--;delete M[a.id]}
function O(a){var c;f.bindFramebuffer(36160,a.framebuffer);var d=a.colorAttachments;for(c=0;c<d.length;++c)x(36064+c,d[c]);for(c=d.length;c<b.maxColorAttachments;++c)x(36064+c,null);x(36096,a.depthAttachment);x(36128,a.stencilAttachment);x(33306,a.depthStencilAttachment);f.checkFramebufferStatus(36160);f.bindFramebuffer(36160,la.next);la.cur=la.next;f.getError()}function S(b,d){function f(a,c){var b,d=0,k=0,m=!0,u=!0;b=null;var r=!0,x="rgba",n="uint8",q=1,D=null,F=null,J=null,G=!1;if("number"===typeof a)d=
a|0,k=c|0||d;else if(a){"shape"in a?(k=a.shape,d=k[0],k=k[1]):("radius"in a&&(d=k=a.radius),"width"in a&&(d=a.width),"height"in a&&(k=a.height));if("color"in a||"colors"in a)b=a.color||a.colors,Array.isArray(b);if(!b){"colorCount"in a&&(q=a.colorCount|0);"colorTexture"in a&&(r=!!a.colorTexture,x="rgba4");if("colorType"in a&&(n=a.colorType,!r))if("half float"===n||"float16"===n)x="rgba16f";else if("float"===n||"float32"===n)x="rgba32f";"colorFormat"in a&&(x=a.colorFormat,0<=Ga.indexOf(x)?r=!0:0<=za.indexOf(x)&&
(r=!1))}if("depthTexture"in a||"depthStencilTexture"in a)G=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?m=a.depth:(D=a.depth,u=!1));"stencil"in a&&("boolean"===typeof a.stencil?u=a.stencil:(F=a.stencil,m=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?m=u=a.depthStencil:(J=a.depthStencil,u=m=!1))}else d=k=1;var S=null,Q=null,K=null,la=null;if(Array.isArray(b))S=b.map(C);else if(b)S=[C(b)];else for(S=Array(q),b=0;b<q;++b)S[b]=g(d,k,r,x,n);d=d||S[0].width;
k=k||S[0].height;D?Q=C(D):m&&!u&&(Q=g(d,k,G,"depth","uint32"));F?K=C(F):u&&!m&&(K=g(d,k,!1,"stencil","uint8"));J?la=C(J):!D&&!F&&u&&m&&(la=g(d,k,G,"depth stencil","depth stencil"));m=null;for(b=0;b<S.length;++b)H(S[b],d,k),S[b]&&S[b].texture&&(u=p[S[b].texture._texture.format]*E[S[b].texture._texture.type],null===m&&(m=u));H(Q,d,k);H(K,d,k);H(la,d,k);A(h);h.width=d;h.height=k;h.colorAttachments=S;h.depthAttachment=Q;h.stencilAttachment=K;h.depthStencilAttachment=la;f.color=S.map(l);f.depth=l(Q);f.stencil=
l(K);f.depthStencil=l(la);f.width=h.width;f.height=h.height;O(h);return f}var h=new D;q.framebufferCount++;f(b,d);return a(f,{resize:function(a,c){var b=a|0,d=c|0||b;if(b===h.width&&d===h.height)return f;for(var g=h.colorAttachments,l=0;l<g.length;++l)G(g[l],b,d);G(h.depthAttachment,b,d);G(h.stencilAttachment,b,d);G(h.depthStencilAttachment,b,d);h.width=f.width=b;h.height=f.height=d;O(h);return f},_reglType:"framebuffer",_framebuffer:h,destroy:function(){c(h);A(h)}})}var la={cur:null,next:null,dirty:!1},
Ga=["rgba"],za=["rgba4","rgb565","rgb5 a1"];d.ext_srgb&&za.push("srgba");d.ext_color_buffer_half_float&&za.push("rgba16f","rgb16f");d.webgl_color_buffer_float&&za.push("rgba32f");var ma=["uint8"];d.oes_texture_half_float&&ma.push("half float","float16");d.oes_texture_float&&ma.push("float","float32");var na=0,M={};return a(la,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof D)?a:null},create:S,createCube:function(c){function b(c){var g,
l={color:null},f=0,h=null;g="rgba";var k="uint8",m=1;if("number"===typeof c)f=c|0;else if(c){"shape"in c?f=c.shape[0]:("radius"in c&&(f=c.radius|0),"width"in c?f=c.width|0:"height"in c&&(f=c.height|0));if("color"in c||"colors"in c)h=c.color||c.colors,Array.isArray(h);h||("colorCount"in c&&(m=c.colorCount|0),"colorType"in c&&(k=c.colorType),"colorFormat"in c&&(g=c.colorFormat));"depth"in c&&(l.depth=c.depth);"stencil"in c&&(l.stencil=c.stencil);"depthStencil"in c&&(l.depthStencil=c.depthStencil)}else f=
1;if(h)if(Array.isArray(h))for(c=[],g=0;g<h.length;++g)c[g]=h[g];else c=[h];else for(c=Array(m),h={radius:f,format:g,type:k},g=0;g<m;++g)c[g]=u.createCube(h);l.color=Array(c.length);for(g=0;g<c.length;++g)m=c[g],f=f||m.width,l.color[g]={target:34069,data:c[g]};for(g=0;6>g;++g){for(m=0;m<c.length;++m)l.color[m].target=34069+g;0<g&&(l.depth=d[0].depth,l.stencil=d[0].stencil,l.depthStencil=d[0].depthStencil);if(d[g])d[g](l);else d[g]=S(l)}return a(b,{width:f,height:f,color:c})}var d=Array(6);b(c);return a(b,
{faces:d,resize:function(a){var c=a|0;if(c===b.width)return b;var g=b.color;for(a=0;a<g.length;++a)g[a].resize(c);for(a=0;6>a;++a)d[a].resize(c);b.width=b.height=c;return b},_reglType:"framebufferCube",destroy:function(){d.forEach(function(a){a.destroy()})}})},clear:function(){k(M).forEach(c)},restore:function(){k(M).forEach(function(a){a.framebuffer=f.createFramebuffer();O(a)})}})}},{"./util/extend":23,"./util/values":31}],13:[function(f,n,q){n.exports=function(f,a){var p=1;a.ext_texture_filter_anisotropic&&
(p=f.getParameter(34047));var n=1,h=1;a.webgl_draw_buffers&&(n=f.getParameter(34852),h=f.getParameter(36063));return{colorBits:[f.getParameter(3410),f.getParameter(3411),f.getParameter(3412),f.getParameter(3413)],depthBits:f.getParameter(3414),stencilBits:f.getParameter(3415),subpixelBits:f.getParameter(3408),extensions:Object.keys(a).filter(function(d){return!!a[d]}),maxAnisotropic:p,maxDrawbuffers:n,maxColorAttachments:h,pointSizeDims:f.getParameter(33901),lineWidthDims:f.getParameter(33902),maxViewportDims:f.getParameter(3386),
maxCombinedTextureUnits:f.getParameter(35661),maxCubeMapSize:f.getParameter(34076),maxRenderbufferSize:f.getParameter(34024),maxTextureUnits:f.getParameter(34930),maxTextureSize:f.getParameter(3379),maxAttributes:f.getParameter(34921),maxVertexUniforms:f.getParameter(36347),maxVertexTextureUnits:f.getParameter(35660),maxVaryingVectors:f.getParameter(36348),maxFragmentUniforms:f.getParameter(36349),glsl:f.getParameter(35724),renderer:f.getParameter(7937),vendor:f.getParameter(7936),version:f.getParameter(7938)}}},
{}],14:[function(f,n,q){var k=f("./util/is-typed-array");n.exports=function(a,f,n,h,d,b){return function(b){var d;d=null===f.next?5121:f.next.colorAttachments[0].texture._texture.type;var q=0,r=0,m=h.framebufferWidth,H=h.framebufferHeight,x=null;k(b)?x=b:b&&(q=b.x|0,r=b.y|0,m=(b.width||h.framebufferWidth-q)|0,H=(b.height||h.framebufferHeight-r)|0,x=b.data||null);n();b=m*H*4;x||(5121===d?x=new Uint8Array(b):5126===d&&(x=x||new Float32Array(b)));a.pixelStorei(3333,4);a.readPixels(q,r,m,H,6408,d,x);
return x}}},{"./util/is-typed-array":26}],15:[function(f,n,q){var k=f("./util/values"),a=[];a[32854]=2;a[32855]=2;a[36194]=2;a[33189]=2;a[36168]=1;a[34041]=4;a[35907]=4;a[34836]=16;a[34842]=8;a[34843]=6;n.exports=function(f,n,h,d,b){function u(a){this.id=r++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;b.profile&&(this.stats={size:0})}function q(a){var b=a.renderbuffer;f.bindRenderbuffer(36161,null);f.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete m[a.id];
d.renderbufferCount--}var F={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};n.ext_srgb&&(F.srgba=35907);n.ext_color_buffer_half_float&&(F.rgba16f=34842,F.rgb16f=34843);n.webgl_color_buffer_float&&(F.rgba32f=34836);var r=0,m={};u.prototype.decRef=function(){0>=--this.refCount&&q(this)};b.profile&&(d.getTotalRenderbufferSize=function(){var a=0;Object.keys(m).forEach(function(b){a+=m[b].stats.size});return a});return{create:function(h,k){function r(d,h){var m=
0,k=0,c=32854;"object"===typeof d&&d?("shape"in d?(k=d.shape,m=k[0]|0,k=k[1]|0):("radius"in d&&(m=k=d.radius|0),"width"in d&&(m=d.width|0),"height"in d&&(k=d.height|0)),"format"in d&&(c=F[d.format])):"number"===typeof d?(m=d|0,k="number"===typeof h?h|0:m):d||(m=k=1);if(m!==g.width||k!==g.height||c!==g.format)return r.width=g.width=m,r.height=g.height=k,g.format=c,f.bindRenderbuffer(36161,g.renderbuffer),f.renderbufferStorage(36161,c,m,k),b.profile&&(g.stats.size=a[g.format]*g.width*g.height),r}var g=
new u(f.createRenderbuffer());m[g.id]=g;d.renderbufferCount++;r(h,k);r.resize=function(d,h){var m=d|0,k=h|0||m;if(m===g.width&&k===g.height)return r;r.width=g.width=m;r.height=g.height=k;f.bindRenderbuffer(36161,g.renderbuffer);f.renderbufferStorage(36161,g.format,m,k);b.profile&&(g.stats.size=a[g.format]*g.width*g.height);return r};r._reglType="renderbuffer";r._renderbuffer=g;b.profile&&(r.stats=g.stats);r.destroy=function(){g.decRef()};return r},clear:function(){k(m).forEach(q)},restore:function(){k(m).forEach(function(a){a.renderbuffer=
f.createRenderbuffer();f.bindRenderbuffer(36161,a.renderbuffer);f.renderbufferStorage(36161,a.format,a.width,a.height)});f.bindRenderbuffer(36161,null)}}}},{"./util/values":31}],16:[function(f,n,q){var k=f("./util/values");n.exports=function(a,f,n,h){function d(a,b,d,f){this.name=a;this.id=b;this.location=d;this.info=f}function b(a,b){for(var d=0;d<a.length;++d)if(a[d].id===b.id){a[d].location=b.location;return}a.push(b)}function u(b,d,h){h=35632===b?r:m;var k=h[d];if(!k){var n=f.str(d),k=a.createShader(b);
a.shaderSource(k,n);a.compileShader(k);h[d]=k}return k}function q(a,b){this.id=C++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];h.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function F(g,l){var m,k;m=u(35632,g.fragId);k=u(35633,g.vertId);var r=g.program=a.createProgram();a.attachShader(r,m);a.attachShader(r,k);a.linkProgram(r);var c=a.getProgramParameter(r,35718);h.profile&&(g.stats.uniformsCount=c);var n=g.uniforms;for(m=0;m<c;++m)if(k=a.getActiveUniform(r,
m))if(1<k.size)for(var q=0;q<k.size;++q){var x=k.name.replace("[0]","["+q+"]");b(n,new d(x,f.id(x),a.getUniformLocation(r,x),k))}else b(n,new d(k.name,f.id(k.name),a.getUniformLocation(r,k.name),k));c=a.getProgramParameter(r,35721);h.profile&&(g.stats.attributesCount=c);n=g.attributes;for(m=0;m<c;++m)(k=a.getActiveAttrib(r,m))&&b(n,new d(k.name,f.id(k.name),a.getAttribLocation(r,k.name),k))}var r={},m={},H={},x=[],C=0;h.profile&&(n.getMaxUniformsCount=function(){var a=0;x.forEach(function(b){b.stats.uniformsCount>
a&&(a=b.stats.uniformsCount)});return a},n.getMaxAttributesCount=function(){var a=0;x.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)});return a});return{clear:function(){var b=a.deleteShader.bind(a);k(r).forEach(b);r={};k(m).forEach(b);m={};x.forEach(function(b){a.deleteProgram(b.program)});x.length=0;H={};n.shaderCount=0},program:function(a,b,d){n.shaderCount++;var f=H[b];f||(f=H[b]={});var h=f[a];h||(h=new q(b,a),F(h,d),f[a]=h,x.push(h));return h},restore:function(){r=
{};m={};for(var a=0;a<x.length;++a)F(x[a])},shader:u,frag:-1,vert:-1}}},{"./util/values":31}],17:[function(f,n,q){n.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(f,n,q){n.exports=function(){var f={"":0},a=[""];return{id:function(p){var n=f[p];if(n)return n;n=f[p]=a.length;a.push(p);return n},str:function(f){return a[f]}}}},{}],19:[function(f,n,q){function k(a){return Array.isArray(a)&&
(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&H(a[0])?!0:!1}function p(a){return Object.prototype.toString.call(a)}function E(c){if(!c)return!1;var b=p(c);return 0<=G.indexOf(b)?!0:k(c)||a(c)||F(c)}function h(a,b){36193===a.type?(a.data=m(b),r.freeType(b)):a.data=b}function d(a,b,d,f,g,h){a="undefined"!==typeof A[a]?A[a]:l[a]*D[b];h&&(a*=6);if(g){for(f=0;1<=d;)f+=a*d*d,d/=2;return f}return a*d*f}var b=f("./util/extend"),u=f("./util/values"),J=f("./util/is-typed-array"),
F=f("./util/is-ndarray"),r=f("./util/pool"),m=f("./util/to-half-float"),H=f("./util/is-array-like");q=f("./constants/arraytypes.json");var x=f("./constants/arraytypes.json"),C=[9984,9986,9985,9987],g=[0,6409,6410,6407,6408],l={};l[6409]=l[6406]=l[6402]=1;l[34041]=l[6410]=2;l[6407]=l[35904]=3;l[6408]=l[35906]=4;var G=Object.keys(q).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),D=[];D[5121]=1;D[5126]=4;D[36193]=2;D[5123]=
2;D[5125]=4;var A=[];A[32854]=2;A[32855]=2;A[36194]=2;A[34041]=4;A[33776]=.5;A[33777]=.5;A[33778]=1;A[33779]=1;A[35986]=.5;A[35987]=1;A[34798]=1;A[35840]=.5;A[35841]=.25;A[35842]=.5;A[35843]=.25;A[36196]=.5;n.exports=function(c,f,n,q,A,D,G){function na(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function M(a,c){a.internalformat=c.internalformat;a.format=c.format;
a.type=c.type;a.compressed=c.compressed;a.premultiplyAlpha=c.premultiplyAlpha;a.flipY=c.flipY;a.unpackAlignment=c.unpackAlignment;a.colorSpace=c.colorSpace;a.width=c.width;a.height=c.height;a.channels=c.channels}function Q(a,c){if("object"===typeof c&&c){"premultiplyAlpha"in c&&(a.premultiplyAlpha=c.premultiplyAlpha);"flipY"in c&&(a.flipY=c.flipY);"alignment"in c&&(a.unpackAlignment=c.alignment);"colorSpace"in c&&(a.colorSpace=N[c.colorSpace]);"type"in c&&(a.type=U[c.type]);var b=a.width,d=a.height,
f=a.channels,h=!1;"shape"in c?(b=c.shape[0],d=c.shape[1],3===c.shape.length&&(f=c.shape[2],h=!0)):("radius"in c&&(b=d=c.radius),"width"in c&&(b=c.width),"height"in c&&(d=c.height),"channels"in c&&(f=c.channels,h=!0));a.width=b|0;a.height=d|0;a.channels=f|0;b=!1;"format"in c&&(b=c.format,d=a.internalformat=X[b],a.format=Da[d],b in U&&!("type"in c)&&(a.type=U[b]),b in Y&&(a.compressed=!0),b=!0);!h&&b?a.channels=l[a.format]:h&&!b&&a.channels!==g[a.format]&&(a.format=a.internalformat=g[a.channels])}}
function oa(a){c.pixelStorei(37440,a.flipY);c.pixelStorei(37441,a.premultiplyAlpha);c.pixelStorei(37443,a.colorSpace);c.pixelStorei(3317,a.unpackAlignment)}function ta(){na.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function t(e,c){var b=null;E(c)?b=c:c&&(Q(e,c),"x"in c&&(e.xOffset=c.x|0),"y"in c&&(e.yOffset=c.y|0),E(c.data)&&(b=c.data));if(c.copy){var d=A.viewportWidth,f=A.viewportHeight;e.width=e.width||d-e.xOffset;e.height=e.height||
f-e.yOffset;e.needsCopy=!0}else if(!b)e.width=e.width||1,e.height=e.height||1;else if(J(b))e.data=b,"type"in c||5121!==e.type||(e.type=x[Object.prototype.toString.call(b)]|0);else if(k(b)){d=b;f=e.width*e.height*e.channels;switch(e.type){case 5121:case 5123:case 5125:case 5126:f=r.allocType(e.type,f);f.set(d);e.data=f;break;case 36193:e.data=m(d)}e.alignment=1;e.needsFree=!0}else if(F(b)){d=b.data;Array.isArray(d)||5121!==e.type||(e.type=x[Object.prototype.toString.call(d)]|0);var f=b.shape,l=b.stride,
n,u,q,t;3===f.length?(q=f[2],t=l[2]):t=q=1;n=f[0];u=f[1];f=l[0];l=l[1];e.alignment=1;e.width=n;e.height=u;e.channels=q;e.format=e.internalformat=g[q];e.needsFree=!0;n=t;b=b.offset;q=e.width;t=e.height;u=e.channels;for(var C=r.allocType(36193===e.type?5126:e.type,q*t*u),ha=0,B=0;B<t;++B)for(var D=0;D<q;++D)for(var y=0;y<u;++y)C[ha++]=d[f*D+l*B+n*y+b];h(e,C)}else if("[object HTMLCanvasElement]"===p(b)||"[object CanvasRenderingContext2D]"===p(b))"[object HTMLCanvasElement]"===p(b)?e.element=b:e.element=
b.canvas,e.width=e.element.width,e.height=e.element.height;else if("[object HTMLImageElement]"===p(b))e.element=b,e.width=b.naturalWidth,e.height=b.naturalHeight;else if("[object HTMLVideoElement]"===p(b))e.element=b,e.width=b.videoWidth,e.height=b.videoHeight,e.needsPoll=!0;else if(a(b)){d=b[0].length;f=b.length;l=1;if(H(b[0][0])){n=l=b[0][0].length;q=r.allocType(36193===e.type?5126:e.type,d*f*n);for(u=t=0;u<f;++u)for(C=b[u],ha=0;ha<d;++ha)for(B=C[ha],D=0;D<n;++D)q[t++]=B[D];h(e,q)}else{n=r.allocType(36193===
e.type?5126:e.type,d*f);for(t=q=0;t<f;++t)for(u=b[t],C=0;C<d;++C)n[q++]=u[C];h(e,n)}e.alignment=1;e.width=d;e.height=f;e.channels=l;e.format=e.internalformat=g[l];e.needsFree=!0}}function Z(a,b,d,f,g){var h=a.element,l=a.data,m=a.internalformat,k=a.format,p=a.type,n=a.width,r=a.height;oa(a);h?c.texSubImage2D(b,g,d,f,k,p,h):a.compressed?c.compressedTexSubImage2D(b,g,d,f,m,n,r,l):a.needsCopy?(q(),c.copyTexSubImage2D(b,g,d,f,a.xOffset,a.yOffset,n,r)):c.texSubImage2D(b,g,d,f,n,r,k,p,l)}function aa(){return Ea.pop()||
new ta}function ia(a){a.needsFree&&r.freeType(a.data);ta.call(a);Ea.push(a)}function V(){na.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function L(a,c,b){var d=a.images[0]=aa();a.mipmask=1;d.width=a.width=c;d.height=a.height=b}function B(a,c){var b=null;if(E(c))b=a.images[0]=aa(),M(b,a),t(b,c),a.mipmask=1;else if(Q(a,c),Array.isArray(c.mipmap))for(var d=c.mipmap,f=0;f<d.length;++f)b=a.images[f]=aa(),M(b,a),b.width>>=f,b.height>>=f,t(b,d[f]),a.mipmask|=1<<
f;else b=a.images[0]=aa(),M(b,a),t(b,c),a.mipmask=1;M(a,a.images[0])}function xa(a,b){for(var d=a.images,f=0;f<d.length&&d[f];++f){var g=d[f],h=b,l=f,m=g.element,k=g.data,p=g.internalformat,n=g.format,r=g.type,u=g.width,x=g.height;oa(g);m?c.texImage2D(h,l,n,n,r,m):g.compressed?c.compressedTexImage2D(h,l,p,u,x,0,k):g.needsCopy?(q(),c.copyTexImage2D(h,l,n,g.xOffset,g.yOffset,u,x,0)):c.texImage2D(h,l,n,u,x,0,n,r,k)}}function pa(){var a=Ka.pop()||new V;na.call(a);for(var c=a.mipmask=0;16>c;++c)a.images[c]=
null;return a}function ya(a){for(var c=a.images,b=0;b<c.length;++b)c[b]&&ia(c[b]),c[b]=null;Ka.push(a)}function P(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function ca(a,c){"min"in c&&(a.minFilter=ja[c.min],0<=C.indexOf(a.minFilter)&&(a.genMipmaps=!0));"mag"in c&&(a.magFilter=ga[c.mag]);var b=a.wrapS,d=a.wrapT;if("wrap"in c){var f=c.wrap;"string"===typeof f?b=d=K[f]:Array.isArray(f)&&(b=K[f[0]],d=K[f[1]])}else"wrapS"in
c&&(b=K[c.wrapS]),"wrapT"in c&&(d=K[c.wrapT]);a.wrapS=b;a.wrapT=d;"anisotropic"in c&&(a.anisotropic=c.anisotropic);if("mipmap"in c){b=!1;switch(typeof c.mipmap){case "string":a.mipmapHint=qa[c.mipmap];b=a.genMipmaps=!0;break;case "boolean":b=a.genMipmaps=c.mipmap;break;case "object":a.genMipmaps=!1,b=!0}!b||"min"in c||(a.minFilter=9984)}}function da(a,b){c.texParameteri(b,10241,a.minFilter);c.texParameteri(b,10240,a.magFilter);c.texParameteri(b,10242,a.wrapS);c.texParameteri(b,10243,a.wrapT);f.ext_texture_filter_anisotropic&&
c.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(c.hint(33170,a.mipmapHint),c.generateMipmap(b))}function ra(a){na.call(this);this.mipmask=0;this.internalformat=6408;this.id=La++;this.refCount=1;this.target=a;this.texture=c.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new P;G.profile&&(this.stats={size:0})}function fa(a){c.activeTexture(33984);c.bindTexture(a.target,a.texture)}function W(){var a=Aa[0];a?c.bindTexture(a.target,a.texture):c.bindTexture(3553,null)}function sa(a){var b=
a.texture,d=a.unit,f=a.target;0<=d&&(c.activeTexture(33984+d),c.bindTexture(f,null),Aa[d]=null);c.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete ka[a.id];D.textureCount--}var qa={"don't care":4352,"dont care":4352,nice:4354,fast:4353},K={repeat:10497,clamp:33071,mirror:33648},ga={nearest:9728,linear:9729},ja=b({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ga),N={none:0,browser:37444},
U={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},X={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Y={};f.ext_srgb&&(X.srgb=35904,X.srgba=35906);f.oes_texture_float&&(U.float32=U["float"]=5126);f.oes_texture_half_float&&(U.float16=U["half float"]=36193);f.webgl_depth_texture&&(b(X,{depth:6402,"depth stencil":34041}),b(U,{uint16:5123,uint32:5125,"depth stencil":34042}));f.webgl_compressed_texture_s3tc&&b(Y,{"rgb s3tc dxt1":33776,
"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});f.webgl_compressed_texture_atc&&b(Y,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});f.webgl_compressed_texture_pvrtc&&b(Y,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});f.webgl_compressed_texture_etc1&&(Y["rgb etc1"]=36196);var ba=Array.prototype.slice.call(c.getParameter(34467));Object.keys(Y).forEach(function(a){var c=Y[a];0<=ba.indexOf(c)&&
(X[a]=c)});var ha=Object.keys(X);n.textureFormats=ha;var Da=ha.reduce(function(a,c){var b=X[c];6409===b||6406===b||6409===b||6410===b||6402===b||34041===b?a[b]=b:32855===b||0<=c.indexOf("rgba")?a[b]=6408:a[b]=6407;return a},{}),Ea=[],Ka=[],La=0,ka={},Fa=n.maxTextureUnits,Aa=Array(Fa).map(function(){return null});b(ra.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<Fa;++b){var d=Aa[b];if(d){if(0<d.bindCount)continue;d.unit=-1}Aa[b]=this;a=b;break}G.profile&&D.maxTextureUnits<
a+1&&(D.maxTextureUnits=a+1);this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&sa(this)}});G.profile&&(D.getTotalTextureSize=function(){var a=0;Object.keys(ka).forEach(function(c){a+=ka[c].stats.size});return a});return{create2D:function(a,b){function f(a,c){var b=g.texInfo;P.call(b);var e=pa();"number"===typeof a?"number"===typeof c?L(e,a|0,c|0):L(e,a|0,a|0):a?(ca(b,a),B(e,a)):L(e,1,1);
b.genMipmaps&&(e.mipmask=(e.width<<1)-1);g.mipmask=e.mipmask;M(g,e);g.internalformat=e.internalformat;f.width=e.width;f.height=e.height;fa(g);xa(e,3553);da(b,3553);W();ya(e);G.profile&&(g.stats.size=d(g.internalformat,g.type,e.width,e.height,b.genMipmaps,!1));return f}var g=new ra(3553);ka[g.id]=g;D.textureCount++;f(a,b);f.subimage=function(a,c,b,e){c|=0;b|=0;e|=0;var d=aa();M(d,g);d.width>>=e;d.height>>=e;d.width-=c;d.height-=b;t(d,a);fa(g);Z(d,3553,c,b,e);W();ia(d);return f};f.resize=function(a,
b){var e=a|0,h=b|0||e;if(e===g.width&&h===g.height)return f;f.width=g.width=e;f.height=g.height=h;fa(g);for(var l=0;g.mipmask>>l;++l)c.texImage2D(3553,l,g.format,e>>l,h>>l,0,g.format,g.type,null);W();G.profile&&(g.stats.size=d(g.internalformat,g.type,e,h,!1,!1));return f};f._reglType="texture2d";f._texture=g;G.profile&&(f.stats=g.stats);f.destroy=function(){g.decRef()};return f},createCube:function(a,b,f,g,h,l){function m(a,c,b,e,f,g){var h,l=k.texInfo;P.call(l);for(h=0;6>h;++h)p[h]=pa();if("number"===
typeof a||!a)for(a=a|0||1,h=0;6>h;++h)L(p[h],a,a);else if("object"===typeof a)if(c)B(p[0],a),B(p[1],c),B(p[2],b),B(p[3],e),B(p[4],f),B(p[5],g);else if(ca(l,a),Q(k,a),"faces"in a)for(a=a.faces,h=0;6>h;++h)M(p[h],k),B(p[h],a[h]);else for(h=0;6>h;++h)B(p[h],a);M(k,p[0]);k.mipmask=l.genMipmaps?(p[0].width<<1)-1:p[0].mipmask;k.internalformat=p[0].internalformat;m.width=p[0].width;m.height=p[0].height;fa(k);for(h=0;6>h;++h)xa(p[h],34069+h);da(l,34067);W();G.profile&&(k.stats.size=d(k.internalformat,k.type,
m.width,m.height,l.genMipmaps,!0));for(h=0;6>h;++h)ya(p[h]);return m}var k=new ra(34067);ka[k.id]=k;D.cubeCount++;var p=Array(6);m(a,b,f,g,h,l);m.subimage=function(a,c,b,e,d){b|=0;e|=0;d|=0;var f=aa();M(f,k);f.width>>=d;f.height>>=d;f.width-=b;f.height-=e;t(f,c);fa(k);Z(f,34069+a,b,e,d);W();ia(f);return m};m.resize=function(a){a|=0;if(a!==k.width){m.width=k.width=a;m.height=k.height=a;fa(k);for(var b=0;6>b;++b)for(var e=0;k.mipmask>>e;++e)c.texImage2D(34069+b,e,k.format,a>>e,a>>e,0,k.format,k.type,
null);W();G.profile&&(k.stats.size=d(k.internalformat,k.type,m.width,m.height,!1,!0));return m}};m._reglType="textureCube";m._texture=k;G.profile&&(m.stats=k.stats);m.destroy=function(){k.decRef()};return m},clear:function(){for(var a=0;a<Fa;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),Aa[a]=null;u(ka).forEach(sa);D.cubeCount=0;D.textureCount=0},getTexture:function(a){return null},restore:function(){u(ka).forEach(function(a){a.texture=c.createTexture();c.bindTexture(a.target,a.texture);for(var b=
0;32>b;++b)if(0!==(a.mipmask&1<<b))if(3553===a.target)c.texImage2D(3553,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);else for(var d=0;6>d;++d)c.texImage2D(34069+d,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);da(a.texInfo,a.target)})}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(f,
n,q){n.exports=function(f,a){function p(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function n(a,b,d){var f=u.pop()||new p;f.startQueryIndex=a;f.endQueryIndex=b;f.sum=0;f.stats=d;q.push(f)}var h=a.ext_disjoint_timer_query;if(!h)return null;var d=[],b=[],u=[],q=[],F=[],r=[];return{beginQuery:function(a){var f=d.pop()||h.createQueryEXT();h.beginQueryEXT(35007,f);b.push(f);n(b.length-1,b.length,a)},endQuery:function(){h.endQueryEXT(35007)},pushScopeStats:n,update:function(){var a,
f;a=b.length;if(0!==a){r.length=Math.max(r.length,a+1);F.length=Math.max(F.length,a+1);F[0]=0;var k=r[0]=0;for(f=a=0;f<b.length;++f){var p=b[f];h.getQueryObjectEXT(p,34919)?(k+=h.getQueryObjectEXT(p,34918),d.push(p)):b[a++]=p;F[f+1]=k;r[f+1]=a}b.length=a;for(f=a=0;f<q.length;++f){var k=q[f],g=k.startQueryIndex,p=k.endQueryIndex;k.sum+=F[p]-F[g];g=r[g];p=r[p];p===g?(k.stats.gpuTime+=k.sum/1E6,u.push(k)):(k.startQueryIndex=g,k.endQueryIndex=p,q[a++]=k)}q.length=a}},getNumPendingQueries:function(){return b.length},
clear:function(){d.push.apply(d,b);for(var a=0;a<d.length;a++)h.deleteQueryEXT(d[a]);b.length=0;d.length=0},restore:function(){b.length=0;d.length=0}}}},{}],21:[function(f,n,q){n.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(f,n,q){function k(a){return Array.prototype.slice.call(a)}function a(a){return k(a).join("")}var p=f("./extend");n.exports=function(){function f(){var b=[],h=[];return p(function(){b.push.apply(b,
k(arguments))},{def:function(){var a="v"+d++;h.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,k(arguments)),b.push(";"));return a},toString:function(){return a([0<h.length?"var "+h+";":"",a(b)])}})}function h(){function a(f,h){d(f,h,"=",b.def(f,h),";")}var b=f(),d=f(),h=b.toString,n=d.toString;return p(function(){b.apply(b,k(arguments))},{def:b.def,entry:b,exit:d,save:a,set:function(d,f,h){a(d,f);b(d,f,"=",h,";")},toString:function(){return h()+n()}})}var d=0,b=[],n=[],q=f(),F={};return{global:q,
link:function(a){for(var f=0;f<n.length;++f)if(n[f]===a)return b[f];f="g"+d++;b.push(f);n.push(a);return f},block:f,proc:function(b,d){function f(){var a="a"+k.length;k.push(a);return a}var k=[];d=d||0;for(var n=0;n<d;++n)f();var n=h(),g=n.toString;return F[b]=p(n,{arg:f,toString:function(){return a(["function(",k.join(),"){",g(),"}"])}})},scope:h,cond:function(){var b=a(arguments),d=h(),f=h(),n=d.toString,q=f.toString;return p(d,{then:function(){d.apply(d,k(arguments));return this},"else":function(){f.apply(f,
k(arguments));return this},toString:function(){var d=q();d&&(d="else{"+d+"}");return a(["if(",b,"){",n(),"}",d])}})},compile:function(){var d=['"use strict";',q,"return {"];Object.keys(F).forEach(function(a){d.push('"',a,'":',F[a].toString(),",")});d.push("}");var f=a(d).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,b.concat(f)).apply(null,n)}}}},{"./extend":23}],23:[function(f,n,q){n.exports=function(f,a){for(var p=Object.keys(a),n=0;n<p.length;++n)f[p[n]]=
a[p[n]];return f}},{}],24:[function(f,n,q){var k=f("./is-typed-array");n.exports=function(a){return Array.isArray(a)||k(a)}},{"./is-typed-array":26}],25:[function(f,n,q){var k=f("./is-typed-array");n.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||k(a.data))}},{"./is-typed-array":26}],26:[function(f,n,q){var k=f("../constants/arraytypes.json");n.exports=function(a){return Object.prototype.toString.call(a)in
k}},{"../constants/arraytypes.json":4}],27:[function(f,n,q){n.exports=function(f,a){for(var p=Array(f),n=0;n<f;++n)p[n]=a(n);return p}},{}],28:[function(f,n,q){function k(a){var d,b;d=(65535<a)<<4;a>>>=d;b=(255<a)<<3;a>>>=b;d|=b;b=(15<a)<<2;a>>>=b;d|=b;b=(3<a)<<1;return d|b|a>>>b>>1}function a(a){a:{for(var d=16;268435456>=d;d*=16)if(a<=d){a=d;break a}a=0}d=E[k(a)>>2];return 0<d.length?d.pop():new ArrayBuffer(a)}function p(a){E[k(a.byteLength)>>2].push(a)}var E=f("./loop")(8,function(){return[]});
n.exports={alloc:a,free:p,allocType:function(f,d){var b=null;switch(f){case 5120:b=new Int8Array(a(d),0,d);break;case 5121:b=new Uint8Array(a(d),0,d);break;case 5122:b=new Int16Array(a(2*d),0,d);break;case 5123:b=new Uint16Array(a(2*d),0,d);break;case 5124:b=new Int32Array(a(4*d),0,d);break;case 5125:b=new Uint32Array(a(4*d),0,d);break;case 5126:b=new Float32Array(a(4*d),0,d);break;default:return null}return b.length!==d?b.subarray(0,d):b},freeType:function(a){p(a.buffer)}}},{"./loop":27}],29:[function(f,
n,q){n.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(f){return requestAnimationFrame(f)},cancel:function(f){return cancelAnimationFrame(f)}}:{next:function(f){return setTimeout(f,16)},cancel:clearTimeout}},{}],30:[function(f,n,q){var k=f("./pool"),a=new Float32Array(1),p=new Uint32Array(a.buffer);n.exports=function(f){for(var h=k.allocType(5123,f.length),d=0;d<f.length;++d)if(isNaN(f[d]))h[d]=65535;else if(Infinity===f[d])h[d]=31744;else if(-Infinity===
f[d])h[d]=64512;else{a[0]=f[d];var b=p[0],n=b>>>31<<15,q=(b<<1>>>24)-127,b=b>>13&1023;h[d]=-24>q?n:-14>q?n+(b+1024>>-14-q):15<q?n+31744:n+(q+15<<10)+b}return h}},{"./pool":28}],31:[function(f,n,q){n.exports=function(f){return Object.keys(f).map(function(a){return f[a]})}},{}],32:[function(f,n,q){function k(a,b,f){function k(){var b=window.innerWidth,m=window.innerHeight;a!==document.body&&(m=a.getBoundingClientRect(),b=m.right-m.left,m=m.top-m.bottom);p.width=f*b;p.height=f*m;h(p.style,{width:b+"px",
height:m+"px"})}var p=document.createElement("canvas");h(p.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(p);a===document.body&&(p.style.position="absolute",h(a.style,{margin:0,padding:0}));window.addEventListener("resize",k,!1);k();return{canvas:p,onDestroy:function(){window.removeEventListener("resize",k);a.removeChild(p)}}}function a(a,b){function f(h){try{return a.getContext(h,b)}catch(k){return null}}return f("webgl")||f("experimental-webgl")||f("webgl-experimental")}function p(a){return"string"===
typeof a?a.split():a}function E(a){return"string"===typeof a?document.querySelector(a):a}var h=f("./util/extend");n.exports=function(d){var b=d||{},f,h,n,q;d={};var m=[],H=[],x="undefined"===typeof window?1:window.devicePixelRatio,C=!1,g=function(a){},l=function(){};"string"===typeof b?f=document.querySelector(b):"object"===typeof b&&("string"===typeof b.nodeName&&"function"===typeof b.appendChild&&"function"===typeof b.getBoundingClientRect?f=b:"function"===typeof b.drawArrays||"function"===typeof b.drawElements?
(q=b,n=q.canvas):("gl"in b?q=b.gl:"canvas"in b?n=E(b.canvas):"container"in b&&(h=E(b.container)),"attributes"in b&&(d=b.attributes),"extensions"in b&&(m=p(b.extensions)),"optionalExtensions"in b&&(H=p(b.optionalExtensions)),"onDone"in b&&(g=b.onDone),"profile"in b&&(C=!!b.profile),"pixelRatio"in b&&(x=+b.pixelRatio)));f&&("canvas"===f.nodeName.toLowerCase()?n=f:h=f);if(!q){if(!n){f=k(h||document.body,g,x);if(!f)return null;n=f.canvas;l=f.onDestroy}q=a(n,d)}return q?{gl:q,canvas:n,container:h,extensions:m,
optionalExtensions:H,pixelRatio:x,profile:C,onDone:g,onDestroy:l}:(l(),g("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/extend":23}],33:[function(f,n,q){n.exports=function(a,f){function n(a){var c=!1;"altKey"in a&&(c=c||a.altKey!==l.alt,l.alt=!!a.altKey);"shiftKey"in a&&(c=c||a.shiftKey!==l.shift,l.shift=!!a.shiftKey);"ctrlKey"in a&&(c=c||a.ctrlKey!==l.control,l.control=!!a.ctrlKey);"metaKey"in a&&(c=c||a.metaKey!==l.meta,l.meta=!!a.metaKey);
return c}function h(a,c){var b=k.x(c),d=k.y(c);"buttons"in c&&(a=c.buttons|0);if(a!==x||b!==C||d!==g||n(c))x=a|0,C=b||0,g=d||0,f&&f(x,C,g,l)}function d(a){h(0,a)}function b(){if(x||C||g||l.shift||l.alt||l.meta||l.control)x=C=g=0,l.shift=l.alt=l.control=l.meta=!1,f&&f(0,0,0,l)}function q(a){n(a)&&f&&f(x,C,g,l)}function J(a){0===k.buttons(a)?h(0,a):h(x,a)}function F(a){h(x|k.buttons(a),a)}function r(a){h(x&~k.buttons(a),a)}function m(){G||(G=!0,a.addEventListener("mousemove",J),a.addEventListener("mousedown",
F),a.addEventListener("mouseup",r),a.addEventListener("mouseleave",d),a.addEventListener("mouseenter",d),a.addEventListener("mouseout",d),a.addEventListener("mouseover",d),a.addEventListener("blur",b),a.addEventListener("keyup",q),a.addEventListener("keydown",q),a.addEventListener("keypress",q),a!==window&&(window.addEventListener("blur",b),window.addEventListener("keyup",q),window.addEventListener("keydown",q),window.addEventListener("keypress",q)))}function H(){G&&(G=!1,a.removeEventListener("mousemove",
J),a.removeEventListener("mousedown",F),a.removeEventListener("mouseup",r),a.removeEventListener("mouseleave",d),a.removeEventListener("mouseenter",d),a.removeEventListener("mouseout",d),a.removeEventListener("mouseover",d),a.removeEventListener("blur",b),a.removeEventListener("keyup",q),a.removeEventListener("keydown",q),a.removeEventListener("keypress",q),a!==window&&(window.removeEventListener("blur",b),window.removeEventListener("keyup",q),window.removeEventListener("keydown",q),window.removeEventListener("keypress",
q)))}f||(f=a,a=window);var x=0,C=0,g=0,l={shift:!1,alt:!1,control:!1,meta:!1},G=!1;m();var D={element:a};Object.defineProperties(D,{enabled:{get:function(){return G},set:function(a){a?m():H},enumerable:!0},buttons:{get:function(){return x},enumerable:!0},x:{get:function(){return C},enumerable:!0},y:{get:function(){return g},enumerable:!0},mods:{get:function(){return l},enumerable:!0}});return D};var k=f("mouse-event")},{"mouse-event":34}],34:[function(f,n,q){function k(a){return a.target||a.srcElement||
window}q.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};q.element=k;q.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var f=k(a).getBoundingClientRect();return a.clientX-f.left}return 0};q.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var f=
k(a).getBoundingClientRect();return a.clientY-f.top}return 0}},{}],35:[function(f,n,q){function k(a,b){for(var d=0;d<a.length;++d)if(a[d]===b)return d;return-1}var a=f("./lib/util/extend"),p=f("./lib/dynamic"),E=f("./lib/util/raf"),h=f("./lib/util/clock"),d=f("./lib/strings"),b=f("./lib/webgl"),u=f("./lib/extension"),J=f("./lib/limits"),F=f("./lib/buffer"),r=f("./lib/elements"),m=f("./lib/texture"),H=f("./lib/renderbuffer"),x=f("./lib/framebuffer"),C=f("./lib/attribute"),g=f("./lib/shader"),l=f("./lib/read"),
G=f("./lib/core"),D=f("./lib/stats"),A=f("./lib/timer");n.exports=function(c){function f(){if(0===N.length)B&&B.update(),ba=null;else{ba=E.next(f);Q();for(var a=N.length-1;0<=a;--a){var b=N[a];b&&b(P,null,0)}t.flush();B&&B.update()}}function n(){!ba&&0<N.length&&(ba=E.next(f))}function q(){ba&&(E.cancel(f),ba=null)}function Ga(a){a.preventDefault();q();U.forEach(function(a){a()})}function za(a){t.getError();aa.restore();fa.restore();da.restore();W.restore();sa.restore();qa.restore();B&&B.restore();
K.procs.refresh();n();X.forEach(function(a){a()})}function ma(b){function c(a){var b={},d={};Object.keys(a).forEach(function(c){var e=a[c];p.isDynamic(e)?d[c]=p.unbox(e,c):b[c]=e});return{dynamic:d,"static":b}}function d(a){for(;n.length<a;)n.push(null);return n}var f=c(b.context||{}),g=c(b.uniforms||{}),h=c(b.attributes||{}),k=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;delete d.context;
"stencil"in d&&d.stencil.op&&(d.stencil.opBack=d.stencil.opFront=d.stencil.op,delete d.stencil.op);c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(b));b={gpuTime:0,cpuTime:0,count:0};var f=K.compile(k,h,g,f,b),l=f.draw,e=f.batch,m=f.scope,n=[];return a(function(a,b){var c;if("function"===typeof a)return m.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)m.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)m.call(this,
a[c],b,c);else return m.call(this,a,b,0);else if("number"===typeof a){if(0<a)return e.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return e.call(this,a,a.length)}else return l.call(this,a)},{stats:b})}function na(a){N.push(a);n();return{cancel:function(){function b(){var a=k(N,b);N[a]=N[N.length-1];--N.length;0>=N.length&&q()}var c=k(N,a);N[c]=b}}}function M(){var a=ga.viewport,b=ga.scissor_box;a[0]=a[1]=b[0]=b[1]=0;P.viewportWidth=P.framebufferWidth=P.drawingBufferWidth=a[2]=b[2]=
t.drawingBufferWidth;P.viewportHeight=P.framebufferHeight=P.drawingBufferHeight=a[3]=b[3]=t.drawingBufferHeight}function Q(){P.tick+=1;P.time=ta();M();K.procs.poll()}function oa(){M();K.procs.refresh();B&&B.update()}function ta(){return(h()-xa)/1E3}c=b(c);if(!c)return null;var t=c.gl,Z=t.getContextAttributes();t.isContextLost();var aa=u(t,c);if(!aa)return null;var ia=d(),V=D(),L=aa.extensions,B=A(t,L),xa=h(),pa=t.drawingBufferWidth,ya=t.drawingBufferHeight,P={tick:0,time:0,viewportWidth:pa,viewportHeight:ya,
framebufferWidth:pa,framebufferHeight:ya,drawingBufferWidth:pa,drawingBufferHeight:ya,pixelRatio:c.pixelRatio},ca=J(t,L),da=F(t,V,c),ra=r(t,L,da,V),pa=C(t,L,ca,da,ia),fa=g(t,ia,V,c),W=m(t,L,ca,function(){K.procs.poll()},P,V,c),sa=H(t,L,ca,V,c),qa=x(t,L,ca,W,sa,V),K=G(t,ia,L,ca,da,ra,W,qa,{},pa,fa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},P,B,c),ia=l(t,qa,K.procs.poll,P,Z,L),ga=K.next,ja=t.canvas,N=[],U=[],X=[],Y=[c.onDestroy],ba=null;ja&&(ja.addEventListener("webglcontextlost",Ga,
!1),ja.addEventListener("webglcontextrestored",za,!1));oa();Z=a(ma,{clear:function(a){var b=0;K.procs.poll();var c=a.color;c&&(t.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(t.clearDepth(+a.depth),b|=256);"stencil"in a&&(t.clearStencil(a.stencil|0),b|=1024);t.clear(b)},prop:p.define.bind(null,1),context:p.define.bind(null,2),"this":p.define.bind(null,3),draw:ma({}),buffer:function(a){return da.create(a,34962,!1,!1)},elements:function(a){return ra.create(a,!1)},texture:W.create2D,
cube:W.createCube,renderbuffer:sa.create,framebuffer:qa.create,framebufferCube:qa.createCube,attributes:Z,frame:na,on:function(a,b){var c;switch(a){case "frame":return na(b);case "lost":c=U;break;case "restore":c=X;break;case "destroy":c=Y}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];c.pop();break}}}},limits:ca,hasExtension:function(a){return 0<=ca.extensions.indexOf(a.toLowerCase())},read:ia,destroy:function(){N.length=0;q();ja&&(ja.removeEventListener("webglcontextlost",
Ga),ja.removeEventListener("webglcontextrestored",za));fa.clear();qa.clear();sa.clear();W.clear();ra.clear();da.clear();B&&B.clear();Y.forEach(function(a){a()})},_gl:t,_refresh:oa,poll:function(){Q();B&&B.update()},now:ta,stats:V});c.onDone(null,Z);return Z}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,
"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);
