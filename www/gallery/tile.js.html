<!DOCTYPE html>
      <html>
        <head>
          <title>example/tile.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(g,k,c){function d(a,h){if(!k[a]){if(!g[a]){var v="function"==typeof require&&require;if(!h&&v)return v(a,!0);if(b)return b(a,!0);v=Error("Cannot find module '"+a+"'");throw v.code="MODULE_NOT_FOUND",v;}v=k[a]={exports:{}};g[a][0].call(v.exports,function(b){var c=g[a][1][b];return d(c?c:b)},v,v.exports,e$$0,g,k,c)}return k[a].exports}for(var b="function"==typeof require&&require,a=0;a<c.length;a++)d(c[a]);return d})({1:[function(e,g,k){g.exports=[[[1,11],[1,11],[1,11],[1,11],[1,11],
[1,11],[1,11],[1,11],[6,6],[7,6],[8,6],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,0],[1,0],[1,0],[2,0],[1,11],[1,11],[1,11],[6,6],[7,6],[8,6],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,1],[1,1],[1,1],[2,1],[1,11],[1,11],[1,11],[6,6],[8,8],[8,6],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,1],[1,1],[0,3],[5,2],[1,11],[13,12],[13,12],[6,6],[7,6],[6,9],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,1],[1,1],[2,1],[1,11],[1,11],[13,15],[13,15],[6,6],[7,6],[7,6],[6,9],[1,11],[1,11],[1,11],[1,
11]],[[1,11],[0,2],[1,2],[2,2],[1,11],[1,11],[14,2],[15,2],[6,6],[7,6],[7,6],[7,6],[6,9],[8,5],[1,11],[1,11]],[[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[6,6],[8,8],[7,6],[7,6],[7,6],[8,6],[1,11],[1,11]],[[4,5],[2,5],[0,5],[1,5],[2,5],[1,11],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6],[8,9],[6,9],[8,5],[1,11]],[[2,8],[3,9],[4,9],[4,6],[3,9],[5,0],[1,11],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6],[8,8],[8,6],[1,11]],[[4,7],[4,7],[4,8],[5,8],[2,9],[3,9],[4,5],[2,5],[1,11],[1,11],[6,7],[7,8],[7,6],
[7,6],[6,9],[8,5]],[[1,11],[1,11],[3,7],[4,7],[4,8],[5,9],[5,8],[0,9],[2,5],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6],[6,9]],[[1,11],[1,11],[1,11],[1,11],[0,7],[4,8],[4,6],[4,6],[5,1],[1,11],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6]],[[1,11],[9,0],[10,0],[8,0],[1,11],[3,7],[1,7],[1,7],[5,7],[1,11],[1,11],[1,11],[1,11],[6,7],[7,7],[7,7]],[[1,11],[9,1],[11,3],[11,1],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[9,2],[7,2],[11,2],[1,11],[1,11],[1,11],[2,12],[1,
13],[1,13],[1,13],[1,13],[1,13],[1,13],[0,12],[1,11]],[[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[2,10],[3,10],[3,10],[3,10],[3,10],[3,10],[3,10],[0,10],[1,11]]]},{}],2:[function(e,g,k){var c=e("../regl")(),d=e("mouse-change")(),b=e("./assets/map.json"),a=c({attributes:{position:c.buffer([-1,-1,1,-1,-1,1,1,1,-1,1,1,-1])},uniforms:{view:c.prop("view")},count:6}),G=c({frag:"\n  precision mediump float;\n  uniform sampler2D map, tiles;\n  uniform vec2 mapSize, tileSize;\n  varying vec2 uv;\n  void main() {\n    vec2 tileCoord = floor(255.0 * texture2D(map,\n        (floor(uv.yx)) / mapSize).ra);\n    gl_FragColor = texture2D(tiles, (tileCoord + fract(uv)) / tileSize);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  uniform vec4 view;\n  varying vec2 uv;\n  void main() {\n    uv = mix(view.xw, view.zy, 0.5 * (1.0 + position));\n    gl_Position = vec4(position, 1, 1);\n  }",depth:{enable:!1},uniforms:{tiles:c.texture("assets/tiles.png"),tileSize:[16,16],map:c.texture(b),mapSize:[b[0].length,b.length]}});c.frame(function(){var h=c.stats,v=h.width,p=h.height,h=b[0].length*d.x/v,e=b.length*d.y/p,v=v/p*10;a({view:[h-.5*v,e-5,h+.5*v,e+5]},function(){G()})})},
{"../regl":36,"./assets/map.json":1,"mouse-change":34}],3:[function(e,g,k){function c(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}var d=e("./constants/dtypes.json"),b=e("./extend");b(c.prototype,{equals:function(a,b){return this.pointer?a.pointer&&this.buffer===a.buffer&&this.size===b&&this.normalized===a.normalized&&this.type===a.type&&this.offset===a.offset&&this.stride===a.stride&&this.divisor===
a.divisor:!a.pointer&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w},set:function(a,b){(this.pointer=a.pointer)?(this.buffer=a.buffer,this.size=b,this.normalized=a.normalized,this.type=a.type,this.offset=a.offset,this.stride=a.stride,this.divisor=a.divisor):(this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w)}});g.exports=function(a,e,h,v,p){function g(){for(var l=Array(16),a=0;16>a;++a)l[a]=new c;this.records=l;this.top=0}function A(a){for(var b=a.records,d=a.top;b.length-1<=d;)b.push(new c);return b[++a.top]}
var C={};h=h.maxAttributes;for(var f=Array(h),x=0;x<h;++x)f[x]=new c;b(g.prototype,{pushVec:function(a,b,d,c){var f=A(this);f.pointer=!1;f.x=a;f.y=b;f.z=d;f.w=c},pushPtr:function(a,b,d,c,f,p,h){var e=A(this);e.pointer=!0;e.buffer=a;e.size=b;e.offset=d;e.stride=c;e.divisor=f;e.normalized=p;e.type=h},pushDyn:function(a){if("number"===typeof a)this.pushVec(a,0,0,0);else if(Array.isArray(a))this.pushVec(a[0],a[1],a[2],a[3]);else{var b=v.getBuffer(a),c=0,f=0,p=0,h=0,e=!1,G=5126;b?G=b.dtype:(b=v.getBuffer(a.buffer),
c=a.size||0,f=a.stride||0,p=a.offset||0,h=a.divisor||0,e=a.normalized||!1,G=b.dtype,"type"in a&&(G=d[a.type]));this.pushPtr(b,c,p,f,h,e,G)}},pop:function(){--this.top}});return{bindings:f,bind:function(b,d,c,f){f=c.size||f;if(!d.equals(c,f)){if(c.pointer){d.pointer||a.enableVertexAttribArray(b);d.buffer!==c.buffer&&c.buffer.bind();a.vertexAttribPointer(b,f,c.type,c.normalized,c.stride,c.offset);var p=e.angle_instanced_arrays;p&&p.vertexAttribDivisorANGLE(b,c.divisor)}else d.pointer&&a.disableVertexAttribArray(b),
a.vertexAttrib4f(b,c.x,c.y,c.z,c.w);d.set(c,f)}},def:function(a){a=p.id(a);var b=C[a];b||(b=C[a]=new g);return b}}}},{"./constants/dtypes.json":9,"./extend":15}],4:[function(e,g,k){function c(a,b){switch(a){case 5121:return new Uint8Array(b);case 5123:return new Uint16Array(b);case 5125:return new Uint32Array(b);case 5120:return new Int8Array(b);case 5122:return new Int16Array(b);case 5124:return new Int32Array(b);case 5126:return new Float32Array(b);default:return null}}var d=e("./is-typed-array"),
b=e("./is-ndarray"),a=e("./constants/arraytypes.json"),G=e("./constants/dtypes.json"),h=e("./values"),v={"static":35044,dynamic:35048,stream:35040};g.exports=function(p){function e(a,b){this.id=f++;this.buffer=a;this.type=b;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function g(a){p.isBuffer(a.buffer)||(a.buffer=p.createBuffer());a.bind();p.bufferData(a.type,a.data||a.byteLength,a.usage)}function C(a){var b=a.buffer;p.isBuffer(b)&&p.deleteBuffer(b);a.buffer=
null;delete x[a.id]}var f=0,x={};e.prototype.bind=function(){p.bindBuffer(this.type,this.buffer)};return{create:function(l,f,h){function q(f){var l=f||{};if(Array.isArray(l)||d(l)||b(l))l={data:l};else if("number"===typeof l)l={length:l|0};else if(null===l||void 0===l)l={};k.usage="usage"in l?v[l.usage]:35044;f=0;"type"in l&&(f=G[l.type]);var p=l.dimension|0||1,h=0,e=null;if("data"in l)if(e=l.data,null===e)h=l.length|0;else{if(b(e)){var p=e.shape,h=e.stride,l=e.offset,D=0,x=0,S=0,r=0;1===p.length?
(D=p[0],x=1,S=h[0],r=0):2===p.length&&(D=p[0],x=p[1],S=h[0],r=h[1]);f=f||a[Object.prototype.toString.call(e)]|0||5126;for(var p=x,h=c(f,D*x),e=e.data,C=0,ka=0;ka<D;++ka)for(var P=0;P<x;++P)h[C++]=e[S*ka+r*P+l];e=h}else if(Array.isArray(e))if(0<e.length&&Array.isArray(e[0])){p=e[0].length;f=f||5126;l=c(f,e.length*p);h=e;e=p;for(D=r=0;D<h.length;++D)for(S=h[D],x=0;x<e;++x)l[r++]=S[x];e=l}else f=f||5126,e=c(f,e);else f=f||a[Object.prototype.toString.call(e)]|0;h=e.byteLength}else"length"in l&&(h=l.length|
0);k.data=e;k.dtype=f||5121;k.byteLength=h;k.dimension=p;g(k);return q}var N=p.createBuffer(),k=new e(N,f);x[k.id]=k;h||q(l);q._reglType="buffer";q._buffer=k;q.destroy=function(){C(k)};return q},clear:function(){h(x).forEach(C)},refresh:function(){h(x).forEach(g)},getBuffer:function(a){return a&&a._buffer instanceof e?a._buffer:null}}}},{"./constants/arraytypes.json":8,"./constants/dtypes.json":9,"./is-ndarray":18,"./is-typed-array":19,"./values":33}],5:[function(e,g,k){g.exports="undefined"!==typeof performance&&
performance.now?function(){return performance.now()}:function(){return+new Date}},{}],6:[function(e,g,k){var c=e("./extend");g.exports=function(){function d(){var a=[],d=[];return c(function(){a.push.apply(a,Array.prototype.slice.call(arguments))},{def:function(){var c="v"+b++;d.push(c);0<arguments.length&&(a.push(c,"="),a.push.apply(a,Array.prototype.slice.call(arguments)),a.push(";"));return c},toString:function(){return[0<d.length?"var "+d+";":"",a.join("")].join("")}})}var b=0,a=[],e=[],h={};
return{link:function(c){var d="g"+b++;a.push(d);e.push(c);return d},block:d,proc:function(a){var e=[],G=d(),g=G.toString;return h[a]=c(G,{arg:function(){var a="a"+b++;e.push(a);return a},toString:function(){return["function(",e.join(),"){",g(),"}"].join("")}})},compile:function(){var b=['"use strict";return {'];Object.keys(h).forEach(function(a){b.push('"',a,'":',h[a].toString(),",")});b.push("}");return Function.apply(null,a.concat([b.join("")])).apply(null,e)}}}},{"./extend":15}],7:[function(e,
g,k){function c(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function d(a,b,c,d){var e,h=",";switch(b){case 5126:e="1f";break;case 35664:e="2fv";break;case 35665:e="3fv";break;case 35666:e="4fv";break;case 35670:case 5124:e="1i";break;case 35671:case 35667:e="2iv";break;case 35672:case 35668:e="3iv";break;case 35673:case 35669:e="4iv";break;case 35674:e="Matrix2fv";h=",false,";break;case 35675:e=
"Matrix3fv";h=",false,";break;case 35676:e="Matrix4fv",h=",false,"}return a+".uniform"+e+"("+c+h+d+");"}function b(a){return a+"["+a+".length-1]"}function a(a,b){return"framebuffer"===a||a<b?-1:a>b?1:0}var G=e("./codegen"),h=e("./constants/primitives.json"),v=e("./constants/dtypes.json"),p={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,
"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Z={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},A={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};g.exports=function(e,f,x,l,D,g,q,k,K,t,T,da,U,fa,ga){function O(l,f,D,Q,v){function q(a){var b=
pa[a];return b?b:b=pa[a]=w(L[a])}function F(a){var b=a.id,u=M[b];if(u)return u;u=a.func?m.def(w(a.data),"(",K,",",I,",",ia,")"):m.def(K,".",a.data);return M[b]=u}function E(a,b){return a.find(function(a){return a.name===b})}function X(a){return O&&!(a in f||a in v)}var V=G(),w=V.link,m=V.proc("batch"),y=V.block(),z=m.def,aa=m.arg,n=w(e),R=w(l.program),Y=w(T.bind),ia=w(fa),na=w(k),J=w(U.count),ba=w(U.offset),sa=w(U.instances),ja=w(U.primitive),pa={},ca=w(g.elements),J=z(b(J)),ba=z(b(ba)),ja=z(b(ja)),
ca=z(b(ca)),B,H,la=x.angle_instanced_arrays;la&&(B=z(b(sa)),H=w(la));var O="elements"in f,sa=aa(),aa=aa(),K=z(),I=z(),M={};m(n,".useProgram(",R,");");l.uniforms.forEach(function(a){if(!(a.name in D)){var b=w(a.location),u=w(t.def(a.name)),u=u+"["+u+".length-1]";a=a.info.type;35678===a||35680===a?(a=z(u+"._texture"),m(d(n,5124,b,a+".bind()")),y(a,".unbind();")):m(d(n,a,b,u))}});l.attributes.forEach(function(a){if(!(Q.name in Q)){var b=w(T.def(a.name));m(Y,"(",a.location,",",w(T.bindings[a.location]),
",",b,".records[",b,".top]",",",c(a.info.type),");")}});O||m("if(",ca,"){",n,".bindBuffer(",34963,",",ca,".buffer.buffer);","}else{",n,".bindBuffer(",34963,",null);","}");m("for(",I,"=0;",I,"<",sa,";++",I,"){",K,"=",aa,"[",I,"];");Object.keys(f).sort(a).forEach(function(a){function b(a){m("if(",u,"){",n,".enable(",a,");}else{",n,".disable(",a,");}")}var u=F(f[a]);switch(a){case "framebuffer":a=q("viewport");var c=q("scissor.box");m("if(",na,".push(",u,"&&",u,"._framebuffer)){",na,".poll();",a,".setDirty();",
c,".setDirty();","}");break;case "cull.enable":b(2884);break;case "blend.enable":b(3042);break;case "dither":b(3024);break;case "stencil.enable":b(2960);break;case "depth.enable":b(2929);break;case "scissor.enable":b(3089);break;case "polygonOffset.enable":b(32823);break;case "sample.alpha":b(32926);break;case "sample.enable":b(32928);break;case "depth.mask":m(n,".depthMask(",u,");");break;case "depth.func":a=w(Z);m(n,".depthFunc(",a,"[",u,"]);");break;case "depth.range":m(n,".depthRange(",u,"[0],",
u,"[1]);");break;case "blend.color":m(n,".blendColor(",u,"[0],",u,"[1],",u,"[2],",u,"[3]);");break;case "blend.equation":a=w(r);m("if(typeof ",u,'==="string"){',n,".blendEquation(",a,"[",u,"]);","}else{",n,".blendEquationSeparate(",a,"[",u,".rgb],",a,"[",u,".alpha]);","}");break;case "blend.func":a=w(p);m(n,".blendFuncSeparate(",a,'["srcRGB" in ',u,"?",u,".srcRGB:",u,".src],",a,'["dstRGB" in ',u,"?",u,".dstRGB:",u,".dst],",a,'["srcAlpha" in ',u,"?",u,".srcAlpha:",u,".src],",a,'["dstAlpha" in ',u,
"?",u,".dstAlpha:",u,".dst]);");break;case "stencil.mask":m(n,".stencilMask(",u,");");break;case "stencil.func":a=w(Z);m(n,".stencilFunc(",a,"[",u,'.cmp||"always"],',u,".ref|0,",'"mask" in ',u,"?",u,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":c=w(A);m(n,".stencilOpSeparate(","stencil.opFront"===a?1028:1029,",",c,"[",u,'.fail||"keep"],',c,"[",u,'.zfail||"keep"],',c,"[",u,'.pass||"keep"]);');break;case "polygonOffset.offset":m(n,".polygonOffset(",u,".factor||0,",u,".units||0);");
break;case "cull.face":m(n,".cullFace(",u,'==="front"?',1028,":",1029,");");break;case "lineWidth":m(n,".lineWidth(",u,");");break;case "frontFace":m(n,".frontFace(",u,'==="cw"?',2304,":",2305,");");break;case "colorMask":m(n,".colorMask(",u,"[0],",u,"[1],",u,"[2],",u,"[3]);");break;case "sample.coverage":m(n,".sampleCoverage(",u,".value,",u,".invert);");break;case "scissor.box":case "viewport":a=q(a),m(a,".push(",u,".x||0,",u,".y||0,",u,".w||-1,",u,".h||-1);")}});("viewport"in f||"framebuffer"in
f)&&m(q("viewport"),".poll();");("scissor.box"in f||"framebuffer"in f)&&m(q("scissor.box"),".poll();");"framebuffer"in f&&m(na,".pop();");var da=l.uniforms,ga=[];Object.keys(D).forEach(function(a){var b=E(da,a);if(b){var u=b.info.type,c=w(b.location);a=F(D[a]);35678===b.info.type||35680===b.info.type?(b=z(a+"._texture"),ga.push(b),m(d(n,5124,c,b+".bind()"))):m(d(n,u,c,a))}});ga.forEach(function(a){m(a,".unbind();")});var ta=l.attributes;Object.keys(Q).forEach(function(a){var b=E(ta,a);b&&m(Y,"(",
b.location,",",w(a.bindings[b.location]),",",F(Q[a]),",",c(b.info.type),");")});f.count?m(J,"=",F(f.count),";"):X("count")||m("if(",J,"){");f.offset&&m(ba,"=",F(f.offset),";");f.primitive&&(l=w(h),m(ja,"=",l,"[",F(f.primitive),"];"));O&&(l=F(f.elements),m(ca,"=",l,"?",l,"._elements:null;"));X("offset")&&m(ba,"=0;");m("if(",ca,"){");X("count")&&m(J,"=",ca,".vertCount;","if(",J,">0){");X("primitive")&&m(ja,"=",ca,".primType;");O&&m(n,".bindBuffer(",34963,",",ca,".buffer.buffer);");la&&(f.instances&&
m(B,"=",F(f.instances),";"),m("if(",B,">0){",H,".drawElementsInstancedANGLE(",ja,",",J,",",ca,".type,",ba,",",B,");}else{"));m(n,".drawElements(",ja,",",J,",",ca,".type,",ba,");");la&&m("}");X("count")&&m("}");m("}else{");X("count")||(X("primitive")&&m(ja,"=",4,";"),la&&m("if(",B,">0){",H,".drawArraysInstancedANGLE(",ja,",",ba,",",J,",",B,");}else{"),m(n,".drawArrays(",ja,",",ba,",",J,");}"),la&&m("}"));m("}}",y);return V.compile().batch}var L=K.contextState,r={add:32774,subtract:32778,"reverse subtract":32779};
x.ext_blend_minmax&&(r.min=32775,r.max=32776);var F=0;return{draw:function(a){var l=G(),f=l.link,h=l.proc("draw"),p=h.def,r=f(e),D=f(a.program),q=f(T.bind),v=f(U.count),F=f(U.offset),w=f(U.instances),m=f(U.primitive),k=f(g.elements),A=[];h(r,".useProgram(",D,");");a.attributes.forEach(function(a){var b=f(T.def(a.name));h(q,"(",a.location,",",f(T.bindings[a.location]),",",b,".records[",b,".top]",",",c(a.info.type),");")});a.uniforms.forEach(function(a){var b=f(a.location),c=f(t.def(a.name)),c=c+"["+
c+".length-1]";a=a.info.type;35678===a||35680===a?(a=p(c+"._texture"),A.push(a),h(d(r,5124,b,a+".bind()"))):h(d(r,a,b,c))});A.forEach(function(a){h(a,".unbind();")});a=p(b(m));v=p(b(v));F=p(b(F));k=p(b(k));h("if(",v,"){");(D=x.angle_instanced_arrays)?(w=p(b(w)),D=f(D),h("if(",k,"){",k,".bind();","if(",w,">0){",D,".drawElementsInstancedANGLE(",a,",",v,",",k,".type,",F,",",w,");}else{",r,".drawElements(",a,",",v,",",k,".type,",F,");}","}else if(",w,">0){",D,".drawArraysInstancedANGLE(",a,",",F,",",
v,",",w,");}else{",r,".drawArrays(",a,",",F,",",v,");}}")):h("if(",k,"){",r,".drawElements(",a,",",v,",",k,".type,",F,");}","}else{",r,".drawArrays(",a,",",F,",",v,");}");return l.compile().draw},command:function(c,d,l,e,x,q,C){function E(a){var b=ca[a];return b?b:b=ca[a]=m(L[a])}function X(a,b){var c=E(a);B(c,".push(",b,");");H(c,".pop();")}function V(a){var b=a.id,c=ta[b];if(c)return c;c=a.func?I.def(m(a.data),"(",ra,",0,",va,")"):I.def(ra,".",a.data);return ta[b]=c}var w=G(),m=w.link,y=w.block,
z=w.proc,K=F++,n=m(ga);m(f);var R=m(da.fragShaders),Y=m(da.vertShaders),ia=m(da.programs),na=m(k),J={count:m(U.count),offset:m(U.offset),instances:m(U.instances),primitive:m(U.primitive)},ba=m(g.elements),sa=m(h),ja=m(Z),pa=m(A),ca={},B=y(),H=y(),la=!1;Object.keys(c).sort(a).forEach(function(a){var b=c[a];switch(a){case "frag":la=!0;B(R,".push(",m(f.id(b)),");");H(R,".pop();");break;case "vert":la=!0;B(Y,".push(",m(f.id(b)),");");H(Y,".pop();");break;case "framebuffer":k.getFramebuffer(b);a=E("viewport");
var n=E("scissor.box");B("if(",na,".push(",m(b&&b._framebuffer),")){",a,".setDirty();",n,".setDirty();","}");H("if(",na,".pop()){",a,".setDirty();",n,".setDirty();","}");break;case "count":case "offset":case "instances":B(J[a],".push(",b,");");H(J[a],".pop();");break;case "primitive":B(J.primitive,".push(",h[b],");");H(J.primitive,".pop();");break;case "elements":n=g.getElements(b);b=!("primitive"in c);a=!("count"in c);n?(n=m(n),B(ba,".push(",n,");"),b&&B(J.primitive,".push(",n,".primType);"),a&&
B(J.count,".push(",n,".vertCount);")):(B(ba,".push(null);"),b&&B(J.primitive,".push(",4,");"),a&&B(J.count,".push(0);"));b&&H(J.primitive,".pop();");a&&H(J.count,".pop();");"offset"in c||(B(J.offset,".push(0);"),H(J.offset,".pop();"));H(ba,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":X(a,b);break;case "depth.func":X(a,Z[b]);
break;case "depth.range":a=E(a);B(a,".push(",b[0],",",b[1],");");H(a,".pop();");break;case "blend.func":a=E(a);B(a,".push(",p["srcRGB"in b?b.srcRGB:b.src],",",p["dstRGB"in b?b.dstRGB:b.dst],",",p["srcAlpha"in b?b.srcAlpha:b.src],",",p["dstAlpha"in b?b.dstAlpha:b.dst],");");H(a,".pop();");break;case "blend.equation":a=E(a);"string"===typeof b?B(a,".push(",r[b],",",r[b],");"):"object"===typeof b&&B(a,".push(",r[b.rgb],",",r[b.alpha],");");H(a,".pop();");break;case "blend.color":a=E(a);B(a,".push(",
b[0],",",b[1],",",b[2],",",b[3],");");H(a,".pop();");break;case "stencil.mask":a=E(a);B(a,".push(",b,");");H(a,".pop();");break;case "stencil.func":var n=b.cmp||"keep",d=b.ref||0,b="mask"in b?b.mask:-1;a=E(a);B(a,".push(",Z[n],",",d,",",b,");");H(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":n=b.fail||"keep";d=b.zfail||"keep";b=b.pass||"keep";a=E(a);B(a,".push(",A[n],",",A[d],",",A[b],");");H(a,".pop();");break;case "polygonOffset.offset":n=b.factor||0;b=b.units||0;a=E(a);B(a,".push(",
n,",",b,");");H(a,".pop();");break;case "cull.face":n=0;"front"===b?n=1028:"back"===b&&(n=1029);b=E(a);B(b,".push(",n,");");H(b,".pop();");break;case "lineWidth":X(a,b);break;case "frontFace":n=0;"cw"===b?n=2304:"ccw"===b&&(n=2305);b=E(a);B(b,".push(",n,");");H(b,".pop();");break;case "colorMask":a=E(a);B(a,".push(",b.map(function(a){return!!a}).join(),");");H(a,".pop();");break;case "sample.coverage":n="value"in b?b.value:1;b=!!b.invert;a=E(a);B(a,".push(",n,",",b,");");H(a,".pop();");break;case "viewport":case "scissor.box":var n=
b.x||0,d=b.y||0,l=-1,e=-1;"w"in b&&(l=b.w);"h"in b&&(e=b.h);b=E(a);B(b,".push(",n,",",d,",",l,",",e,");");H(b,".pop();")}});if(la){if(c.frag&&c.vert)y=c.frag,B(ia,".push(",m(da.create(f.id(c.vert),f.id(y))),");");else{var y=B.def(R,"[",R,".length-1]"),qa=B.def(Y,"[",Y,".length-1]"),ua=m(da.create);B(ia,".push(",ua,"(",qa,",",y,"));")}H(ia,".pop();")}Object.keys(d).forEach(function(a){var b=m(t.def(a));a=d[a];a="function"===typeof a&&a._reglType?m(a):Array.isArray(a)?m(a.slice()):+a;B(b,".push(",a,
");");H(b,".pop();")});Object.keys(l).forEach(function(a){var b=m(T.def(a));a=l[a];if("number"===typeof a)B(b,".pushVec(",+a,",0,0,0);");else if(Array.isArray(a))B(b,".pushVec(",[a[0]||0,a[1]||0,a[2]||0,a[3]||0],");");else{var n=D.getBuffer(a),c=0,d=0,f=0,e=0,Y=!1,h=5126;n?h=n.dtype:(n=D.getBuffer(a.buffer),c=a.size||0,d=a.stride||0,f=a.offset||0,e=a.divisor||0,Y=a.normalized||!1,h=n.dtype,"type"in a&&(h=v[a.type]));B(b,".pushPtr(",[m(n),c,f,d,e,Y,h].join(),");")}H(b,".pop();")});var I=w.block(),
M=w.block(),va,ra;C&&(va=m(fa),ra=B.def());var ta={};Object.keys(e).sort(a).forEach(function(a){var b=V(e[a]);switch(a){case "framebuffer":a=E("viewport");var n=E("scissor.box");I("if(",na,".push(",b,"&&",b,"._framebuffer)){",a,".setDirty();",n,".setDirty();","}");M("if(",na,".pop()){",a,".setDirty();",n,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":a=
E(a);I(a,".push(",b,");");M(a,".pop();");break;case "count":case "offset":case "instances":a=J[a];I(a,".push(",b,");");M(a,".pop();");break;case "primitive":a=J.primitive;I(a,".push(",sa,"[",b,"]);");M(a,".pop();");break;case "depth.func":a=E(a);I(a,".push(",ja,"[",b,"]);");M(a,".pop();");break;case "blend.func":a=E(a);n=m(p);I(a,".push(",n,'["srcRGB" in ',b,"?",b,".srcRGB:",b,".src],",n,'["dstRGB" in ',b,"?",b,".dstRGB:",b,".dst],",n,'["srcAlpha" in ',b,"?",b,".srcAlpha:",b,".src],",n,'["dstAlpha" in ',
b,"?",b,".dstAlpha:",b,".dst]);");M(a,".pop();");break;case "blend.equation":a=E(a);n=m(r);I("if(typeof ",b,'==="string"){',a,".push(",n,"[",b,"],",n,"[",b,"]);","}else{",a,".push(",n,"[",b,".rgb],",n,"[",b,".alpha]);","}");M(a,".pop();");break;case "blend.color":a=E(a);I(a,".push(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");M(a,".pop();");break;case "stencil.mask":a=E(a);I(a,".push(",b,");");M(a,".pop();");break;case "stencil.func":a=E(a);I(a,".push(",ja,"[",b,".cmp],",b,".ref|0,",'"mask" in ',b,"?",
b,".mask:-1);");M(a,".pop();");break;case "stencil.opFront":case "stencil.opBack":a=E(a);I(a,".push(",pa,"[",b,'.fail||"keep"],',pa,"[",b,'.zfail||"keep"],',pa,"[",b,'.pass||"keep"]);');M(a,".pop();");break;case "polygonOffset.offset":a=E(a);I(a,".push(",b,".factor||0,",b,".units||0);");M(a,".pop();");break;case "cull.face":a=E(a);I(a,".push(",b,'==="front"?',1028,":",1029,");");M(a,".pop();");break;case "frontFace":a=E(a);I(a,".push(",b,'==="cw"?',2304,":",2305,");");M(a,".pop();");break;case "colorMask":a=
E(a);I(a,".push(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");M(a,".pop();");break;case "sample.coverage":a=E(a);I(a,".push(",b,".value,",b,".invert);");M(a,".pop();");break;case "scissor.box":case "viewport":a=E(a);I(a,".push(",b,".x||0,",b,".y||0,",'"w" in ',b,"?",b,".w:-1,",'"h" in ',b,"?",b,".h:-1);");M(a,".pop();");break;case "elements":a=!("primitive"in e)&&!("primitive"in c);var n=!("count"in e)&&!("count"in c),d=!("offset"in e)&&!("offset"in c),f=I.def();I("if(",b,"){",f,"=",b,"._elements;",ba,
".push(",f,");",a?J.primitive+".push("+f+".primType);":"",n?J.count+".push("+f+".vertCount);":"",d?J.offset+".push("+f+".offset);":"","}else{",ba,".push(null);","}");M(ba,".pop();","if(",b,"){",a?J.primitive+".pop();":"",n?J.count+".pop();":"",d?J.offset+".pop();":"","}")}});Object.keys(x).forEach(function(a){var b=m(t.def(a));a=V(x[a]);I(b,".push(",a,");");M(b,".pop();")});Object.keys(q).forEach(function(a){var b=m(T.def(a));a=V(q[a]);I(b,".pushDyn(",a,");");M(b,".pop();")});y=z("scope");qa=y.arg();
ua=y.arg();y(B);C&&y(ra,"=",qa,";",I);y(ua,"();",C?M:"",H);y=z("draw");y(B);C&&y(ra,"=",y.arg(),";",I);qa=b(ia);y(n,"();","if(",qa,")",qa,".draw(",C?ra:"",");",C?M:"",H);var oa=z("batch");oa(B);C=oa.def(b(ia));z=m(function(a,b,n){var d=a.batchCache[K];d||(d=a.batchCache[K]=O(a,e,x,q,c));return d(b,n)});oa("if(",C,"){",n,"();",z,"(",C,",",oa.arg(),",",oa.arg(),");");Object.keys(e).forEach(function(a){(a=ca[a])&&oa(a,".setDirty();")});oa("}",H);return w.compile()}}}},{"./codegen":6,"./constants/dtypes.json":9,
"./constants/primitives.json":10}],8:[function(e,g,k){g.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],9:[function(e,g,k){g.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],10:[function(e,g,k){g.exports={points:0,
lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],11:[function(e,g,k){function c(a,c){function e(){var c=window.innerWidth,d=window.innerHeight;a!==document.body&&(d=a.getBoundingClientRect(),c=d.right-d.left,d=d.top-d.bottom);v.width=g*c;v.height=g*d;b(v.style,{width:c+"px",height:d+"px"})}var v=document.createElement("canvas"),p=d(v,c);b(v.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(v);a===document.body&&(v.style.position="absolute",b(a.style,
{margin:0,padding:0}));var g=+p.options.pixelRatio;window.addEventListener("resize",e,!1);var k=p.options.onDestroy;p.options=b(b({},p.options),{onDestroy:function(){window.removeEventListener("resize",e);a.removeChild(v);k&&k()}});e();return p}function d(a,c){function d(b){try{return a.getContext(b,e)}catch(c){return null}}var e=c.glOptions||{};return{gl:d("webgl")||d("experimental-webgl")||d("webgl-experimental"),options:b({pixelRatio:window.devicePixelRatio},c)}}var b=e("./extend");g.exports=function(a){if("undefined"===
typeof document||"undefined"===typeof HTMLElement)return{gl:a[0],options:a[1]||{}};var e=document.body,h=a[1]||{};if("string"===typeof a[0])e=document.querySelector(a[0])||document.body;else if("object"===typeof a[0])if(a[0]instanceof HTMLElement)e=a[0];else{if(a[0]instanceof WebGLRenderingContext)return{gl:a[0],options:b({pixelRatio:1},h)};h=a[0]}return e.nodeName&&"CANVAS"===e.nodeName.toUpperCase()?d(e,h):c(e,h)}},{"./extend":15}],12:[function(e,g,k){g.exports=function(c){return{primitive:[4],
count:[0],offset:[0],instances:[0]}}},{}],13:[function(e,g,k){function c(a,c){this.id=b++;this.func=a;this.data=c}function d(a,b){switch(typeof a){case "boolean":case "number":case "string":return new c(!1,a);case "function":return new c(!0,a);default:return d}}var b=0;g.exports={define:d,isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof c},unbox:function(a,b){return a instanceof c?a:"function"===typeof a&&a!==d?new c(!0,a):new c(!1,b)}}},{}],14:[function(e,g,k){var c=
e("./is-typed-array"),d=e("./is-ndarray"),b=e("./constants/primitives.json");g.exports=function(a,e,h){function g(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}g.prototype.bind=function(){this.buffer.bind()};return{create:function(a){function k(a){var h=e.oes_element_index_uint;if(a)if("number"===typeof a)C(a);else{var l=null,p="static",g=0;Array.isArray(a)||c(a)||d(a)?l=a:("data"in a&&(l=a.data),"usage"in a&&(p=a.usage),"length"in a&&(g=a.length));Array.isArray(l)||d(l)&&"array"===
l.dtype||"type"in a?C({type:a.type||(h?"uint32":"uint16"),usage:p,data:l,length:g}):C({usage:p,data:l,length:g});if(Array.isArray(l)||c(l))C.dimension=3}else C();h=A.buffer.byteLength;l=0;switch(A.buffer.dtype){case 5121:case 5120:l=5121;break;case 5123:case 5122:l=5123;h>>=1;break;case 5125:case 5124:l=5125,h>>=2}p=4;g=A.buffer.dimension;1===g&&(p=0);2===g&&(p=1);3===g&&(p=4);"object"===typeof a&&("primitive"in a&&(p=b[a.primitive]),"count"in a&&(h=a.vertCount|0));A.primType=p;A.vertCount=h;A.type=
l;return k}var A=new g,C=h.create(null,34963,!0);A.buffer=C._buffer;k(a);k._reglType="elements";k._elements=A;k.destroy=function(){C.destroy();A.buffer=null};return k},elements:[null],getElements:function(a){return a&&a._elements instanceof g?a._elements:null}}}},{"./constants/primitives.json":10,"./is-ndarray":18,"./is-typed-array":19}],15:[function(e,g,k){g.exports=function(c,d){for(var b=Object.keys(d),a=0;a<b.length;++a)c[b[a]]=d[b[a]];return c}},{}],16:[function(e,g,k){g.exports=function(c){function d(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{b[a]=
c.getExtension(a)}catch(d){}})}var b={};d();return{extensions:b,refresh:d}}},{}],17:[function(e,g,k){var c=e("./values"),d=e("./extend"),b=[1029];g.exports=function(a,e,h,g,p){function k(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function A(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function C(a,b){var c=b.width,d=b.height;if(a.texture)var e=a.texture._texture,l=Math.max(1,e.params.width>>a.level),f=Math.max(1,e.params.height>>
a.level),c=c||l,d=d||f;else e=a.renderbuffer._renderbuffer,c=c||e.width,d=d||e.height;e.refCount+=1;b.width=c;b.height=d}function f(b,c){c?c.texture?a.framebufferTexture2D(36160,b,c.target,c.texture._texture.texture,c.level):a.framebufferRenderbuffer(36160,b,36161,c.renderbuffer._renderbuffer.renderbuffer):a.framebufferTexture2D(36160,b,3553,null,0)}function x(a){var b=3553,c=0,d=null,e=null;"object"===typeof a&&("level"in a&&(c=a.level|0),"target"in a&&(b=a.target|0));var l=a._reglType;"texture"===
l?d=a:"renderbuffer"===l&&(e=a,b=36161,c=0);return new k(b,c,d,e)}function l(a){return a&&(a.texture||a.renderbuffer)}function D(){this.id=fa++;ga[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function S(b){a.isFramebuffer(b.framebuffer)||(b.framebuffer=a.createFramebuffer());L=!0;a.bindFramebuffer(36160,b.framebuffer);for(var c=b.colorAttachments,
d=0;d<c.length;++d)f(36064+d,c[d]);for(d=c.length;d<h.maxColorAttachments;++d)f(36064+d,null);f(36096,b.depthAttachment);f(36128,b.stencilAttachment);f(33306,b.depthStencilAttachment);e.webgl_draw_buffers&&e.webgl_draw_buffers.drawBuffersWEBGL(U[c.length]);a.checkFramebufferStatus(36160)}function q(b){b=b.framebuffer;a.isFramebuffer(b)&&a.deleteFramebuffer(b)}function N(){return O[O.length-1]}var K={rgba:6408},t={rgba4:32854,rgb565:36194,"rgb5 a1":32855};e.ext_srgb&&(t.srgba=35907);e.ext_color_buffer_half_float&&
(t.rgba16f=34842,t.rgb16f=34843);e.webgl_color_buffer_float&&(t.rgba32f=34836);var T=[],da=[];e.webgl_depth_texture&&(T.push(6402),da.push(34041));d(d({},K),t);c(K);c(t);t=5121;T={uint8:5121};e.oes_texture_half_float&&(t=T["half float"]=36193);e.oes_texture_float&&(t=T["float"]=5126);T.best=t;var U=function(){for(var a=Array(h.maxDrawbuffers),b=0;b<=h.maxDrawbuffers;++b)for(var c=a[b]=Array(b),d=0;d<b;++d)c[d]=36064+d;return a}(),fa=0,ga={},O=[null],L=!0;return{top:N,dirty:function(){return L},push:function(a){a=
a||null;L=L||a!==N();O.push(a);return L},pop:function(){var a=N();O.pop();return L=L||a!==N()},getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof D)?a:null},poll:function(){if(L){var c=O[O.length-1],d=e.webgl_draw_buffers;c?(a.bindFramebuffer(36160,c.framebuffer),d&&d.drawBuffersWEBGL(U[c.colorAttachments.length])):(a.bindFramebuffer(36160,null),d&&d.drawBuffersWEBGL(b));L=!1}},create:function(b){function c(b){var e,f=b||{},h=b=0;if("shape"in
f){var D=f.shape;b=D[0];h=D[1]}else"radius"in f&&(b=h=f.radius),"width"in f&&(b=f.width),"height"in f&&(h=f.height);var q=null,D=!1;if("colorBuffers"in f||"colorBuffer"in f){q=f.colorBuffers||f.colorBuffer;Array.isArray(q)||(q=[q]);d.width=b;d.height=h;q=q.map(x);for(e=0;e<q.length;++e)C(q[e],d);b=d.width;h=d.height}else{var t=!0,G="rgba",r="uint8",w=1,D=!0;d.width=b||a.drawingBufferWidth;d.height=h||a.drawingBufferHeight;"format"in f&&(G=f.format,t=G in K);"type"in f&&(r=f.type);"colorCount"in f&&
(w=f.colorCount|0);if(d.ownsColor)for(q=d.colorAttachments;q.length>w;)A(q.pop());else q=[];for(e=0;e<q.length;++e){var m;a:{m=q[e];var y=t,z=G,N=b,n=h;if(m.texture){var R=m.texture;if(y){R({format:z,type:r,width:N,height:n});R._texture.refCount+=1;m=!0;break a}}else if(R=m.renderbuffer,!y){R({format:z,width:N,height:n});R._renderbuffer.refCount+=1;m=!0;break a}A(m);m=!1}m||(q[e--]=q[q.length-1],q.pop())}for(;q.length<w;)t?q.push(new k(3553,0,g.create({format:G,type:r,width:b,height:h},3553),null)):
q.push(new k(36161,0,null,p.create({format:G,width:b,height:h})))}d.width=b;d.height=h;G=t=e=null;r=!1;"depthBuffer"in f&&(e=x(f.depthBuffer));"stencilBuffer"in f&&(t=x(f.stencilBuffer));"depthStencilBuffer"in f&&(G=x(f.depthStencilBuffer));if(e||t||G)C(e||t||G,d);else if(w=!0,y=m=!1,"depth"in f&&(w=!!f.depth),"stencil"in f&&(m=!!f.stencil),"depthTexture"in f&&(y=!!f.depthTexture),f=d.depthAttachment||d.stencilAttachment||d.depthStencilAttachment,z=null,w||m)r=!0,y?(y=m?"depth stencil":"depth",d.ownsDepthStencil&&
f.texture?(f.texture({format:y,width:b,height:h}),f.texture._texture.refCount+=1,z=f):z=new k(3553,0,g.create({format:y,width:b,height:h},3553),null)):(y=w?m?"depth stencil":"depth":"stencil",d.ownsDepthStencil&&f.renderbuffer?(f.renderbuffer({format:y,width:b,height:h}),f.renderbuffer._renderbuffer.refCount+=1,z=f):z=new k(36161,0,null,p.create({format:y,width:b,height:h}))),w?m?G=z:e=z:t=z;b=d;b.colorAttachments.forEach(A);A(b.depthAttachment);A(b.stencilAttachment);A(b.depthStencilAttachment);
d.colorAttachments=q;d.depthAttachment=e;d.stencilAttachment=t;d.depthStencilAttachment=G;d.ownsColor=D;d.ownsDepthStencil=r;c.color=q.map(l);c.depth=l(e);c.stencil=l(t);c.depthStencil=l(G);S(d);c.width=d.width;c.height=d.height;return c}var d=new D;c(b);c._reglType="framebuffer";c._framebuffer=d;c._destroy=function(){q(d)};return c},clear:function(){c(ga).forEach(q)},refresh:function(){c(ga).forEach(S)}}}},{"./extend":15,"./values":33}],18:[function(e,g,k){var c=e("./is-typed-array");g.exports=function(d){return"object"===
typeof d&&Array.isArray(d.shape)&&Array.isArray(d.stride)&&"number"===typeof d.offset&&d.shape.length===d.stride.length&&(Array.isArray(d.data)||c(d.data))}},{"./is-typed-array":19}],19:[function(e,g,k){var c=e("./constants/arraytypes.json");g.exports=function(d){return Object.prototype.toString.call(d)in c}},{"./constants/arraytypes.json":8}],20:[function(e,g,k){g.exports=function(c,d){var b=1;d.ext_texture_filter_anisotropic&&(b=c.getParameter(34047));var a=1,e=1;d.webgl_draw_buffers&&(a=c.getParameter(34852),
e=c.getParameter(36063));return{colorBits:[c.getParameter(3410),c.getParameter(3411),c.getParameter(3412),c.getParameter(3413)],depthBits:c.getParameter(3414),stencilBits:c.getParameter(3415),subpixelBits:c.getParameter(3408),extensions:Object.keys(d).filter(function(a){return!!d[a]}),maxAnisotropic:b,maxDrawbuffers:a,maxColorAttachments:e,pointSizeDims:c.getParameter(33901),lineWidthDims:c.getParameter(33902),maxViewportDims:c.getParameter(3386),maxCombinedTextureUnits:c.getParameter(35661),maxCubeMapSize:c.getParameter(34076),
maxRenderbufferSize:c.getParameter(34024),maxTextureUnits:c.getParameter(34930),maxTextureSize:c.getParameter(3379),maxAttributes:c.getParameter(34921),maxVertexUniforms:c.getParameter(36347),maxVertexTextureUnits:c.getParameter(35660),maxVaryingVectors:c.getParameter(36348),maxFragmentUniforms:c.getParameter(36349),glsl:c.getParameter(35724),renderer:c.getParameter(7937),vendor:c.getParameter(7936),version:c.getParameter(7938)}}},{}],21:[function(e,g,k){g.exports=function(c,d){if("undefined"!==typeof document){var b;
b=(b=/\.(\w+)(\?.*)?$/.exec(c))&&b[1]?b[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(b))return b=document.createElement("video"),b.autoplay=!0,b.loop=!0,d&&(b.crossOrigin=d),b.src=c,b;if(0<=["dds"].indexOf(b))return b=new XMLHttpRequest,b.responseType="arraybuffer",b.open("GET",c,!0),b.send(),b;b=new Image;d&&(b.crossOrigin=d);b.src=c;return b}return null}},{}],22:[function(e,g,k){g.exports=function(e){function g(a){for(var b=
r,c=F,d=0;d<W;++d){var f=Math.max(1,b+3>>2)*Math.max(1,c+3>>2)*ha;ma.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(e,ea,f)});ea+=f;b>>=1;c>>=1}}var k=new Int32Array(e),L=k[q],r=k[K],F=k[N],ka=p,P=0,ha=0,Q=4;switch(k[da]){case f:ha=8;L&C?(Q=3,P=b):P=a;break;case x:ha=16;P=G;break;case l:ha=16;P=h;break;case D:ha=8,P=v}var W=1;k[T]&Z&&(W=Math.max(1,k[t]));var ea=k[S]+4,ma={width:r,height:F,channels:Q,format:P,type:ka,compressed:!0,cube:!1,pixels:[]};if(k[U]&A)for(ma.cube=!0,
k=0;6>k;++k)g(d+k);else g(c);return ma};var c=3553,d=34069,b=33776,a=33777,G=33778,h=33779,v=36196,p=5121,Z=131072,A=512,C=64,f=827611204,x=861165636,l=894720068,D=826496069,S=1,q=2,N=3,K=4,t=7,T=20,da=21,U=28},{}],23:[function(e,g,k){g.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(c){return requestAnimationFrame(c)},cancel:function(c){return cancelAnimationFrame(c)}}:{next:function(c){setTimeout(c,30)},cancel:clearTimeout}},{}],24:[function(e,
g,k){var c=e("./is-typed-array");g.exports=function(d,b,a){return function(e){var h=e||{};c(e)?h={data:h}:2===arguments.length?h={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof e&&(h={});b();var g=h.x||0,p=h.y||0,k=h.width||a.width,A=h.height||a.height,h=h.data||new Uint8Array(k*A*4);d.pixelStorei(3333,4);d.readPixels(g,p,k,A,6408,5121,h);return h}}},{"./is-typed-array":19}],25:[function(e,g,k){var c=e("./values");g.exports=function(d,b,a){function e(){this.id=k++;this.refCount=1;this.renderbuffer=
null;this.format=32854;this.height=this.width=0}function h(a){d.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=d.createRenderbuffer());d.bindRenderbuffer(36161,a.renderbuffer);d.renderbufferStorage(36161,a.format,a.width,a.height)}function g(a){var b=a.renderbuffer;d.bindRenderbuffer(36161,null);d.isRenderbuffer(b)&&d.deleteRenderbuffer(b);a.renderbuffer=null;a.refCount=0;delete A[a.id]}var p={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(p.srgba=
35907);b.ext_color_buffer_half_float&&(p.rgba16f=34842,p.rgb16f=34843);b.webgl_color_buffer_float&&(p.rgba32f=34836);var k=0,A={};e.prototype.decRef=function(){0===--this.refCount&&g(this)};return{create:function(a){function b(a){a=a||{};var d=0,e=0;"shape"in a?(e=a.shape,d=e[0]|0,e=e[1]|0):("radius"in a&&(d=e=a.radius|0),"width"in a&&(d=a.width|0),"height"in a&&(e=a.height|0));b.width=c.width=Math.max(d,1);b.height=c.height=Math.max(e,1);c.format=32854;"format"in a&&(c.format=p[a.format]);h(c);return b}
var c=new e;A[c.id]=c;b(a);b._reglType="renderbuffer";b._renderbuffer=c;b.destroy=function(){c.decRef()};return b},refresh:function(){c(A).forEach(h)},clear:function(){c(A).forEach(g)}}}},{"./values":33}],26:[function(e,g,k){function c(b,a,c){this.name=b;this.location=a;this.info=c}var d=e("./values");g.exports=function(b,a,e,h,g){function p(a,c){var d=35632===a?C:f,e=d[c];if(!e){var l=g.str(c),e=b.createShader(a);b.shaderSource(e,l);b.compileShader(e);d[c]=e}return e}function k(a,b){this.fragId=
a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function A(d){var f,l;f=p(35632,d.fragId);l=p(35633,d.vertId);var g=d.program=b.createProgram();b.attachShader(g,f);b.attachShader(g,l);b.linkProgram(g);var k=b.getProgramParameter(g,35718),t=d.uniforms=[];for(f=0;f<k;++f)if(l=b.getActiveUniform(g,f))if(1<l.size)for(var x=0;x<l.size;++x){var v=l.name.replace("[0]","["+x+"]");e.def(v);t.push(new c(v,b.getUniformLocation(g,v),l))}else e.def(l.name),
t.push(new c(l.name,b.getUniformLocation(g,l.name),l));k=b.getProgramParameter(g,35721);t=d.attributes=[];for(f=0;f<k;++f)if(l=b.getActiveAttrib(g,f))a.def(l.name),t.push(new c(l.name,b.getAttribLocation(g,l.name),l));d.draw=h(d);d.batchCache={}}var C={},f={},x={},l=[];return{create:function(a,b){var c=x[b];c||(c=x[b]={});var d=c[a];d||(d=new k(b,a),A(d),c[a]=d,l.push(d));return d},clear:function(){var a=b.deleteShader.bind(b);d(C).forEach(a);C={};d(f).forEach(a);f={};l.forEach(function(a){b.deleteProgram(a.program)});
l.length=0;x={}},refresh:function(){C={};f={};l.forEach(A)},programs:[null],fragShaders:[g.id("void main(){gl_FragColor=vec4(0,0,0,0);}")],vertShaders:[g.id("void main(){gl_Position=vec4(0,0,0,0);}")]}}},{"./values":33}],27:[function(e,g,k){g.exports=function(c,d){var b=c.length,a=c.slice(),e=c.slice(),h=!1,g=!0;return{push:function(){h=!1;for(var c=0;c<b;++c){var d=arguments[c];h=h||d!==e[c];a.push(d)}},pop:function(){h=!1;a.length-=b;for(var c=0;c<b;++c)h=h||a[a.length-b+c]!==e[c]},poll:function(){var c=
a.length-b;if(h||g){switch(b){case 1:d(a[c]);break;case 2:d(a[c],a[c+1]);break;case 3:d(a[c],a[c+1],a[c+2]);break;case 4:d(a[c],a[c+1],a[c+2],a[c+3]);break;case 5:d(a[c],a[c+1],a[c+2],a[c+3],a[c+4]);break;case 6:d(a[c],a[c+1],a[c+2],a[c+3],a[c+4],a[c+5]);break;default:d.apply(null,a.slice(c,a.length))}for(var k=0;k<b;++k)e[k]=a[c+k];g=h=!1}},setDirty:function(){g=!0}}}},{}],28:[function(e,g,k){var c=e("./stack"),d=e("./codegen");g.exports=function(b,a,e){function h(a,d){var e=c([!!d],function(c){c?
b.enable(a):b.disable(a)});e.flag=a;return e}var g={dither:h(3024),"blend.enable":h(3042),"blend.color":c([0,0,0,0],function(a,c,d,e){b.blendColor(a,c,d,e)}),"blend.equation":c([32774,32774],function(a,c){b.blendEquationSeparate(a,c)}),"blend.func":c([1,0,1,0],function(a,c,d,e){b.blendFuncSeparate(a,c,d,e)}),"depth.enable":h(2929,!0),"depth.func":c([513],function(a){b.depthFunc(a)}),"depth.range":c([0,1],function(a,c){b.depthRange(a,c)}),"depth.mask":c([!0],function(a){b.depthMask(a)}),"cull.enable":h(2884),
"cull.face":c([1029],function(a){b.cullFace(a)}),frontFace:c([2305],function(a){b.frontFace(a)}),colorMask:c([!0,!0,!0,!0],function(a,c,d,e){b.colorMask(a,c,d,e)}),lineWidth:c([1],function(a){b.lineWidth(a)}),"polygonOffset.enable":h(32823),"polygonOffset.offset":c([0,0],function(a,c){b.polygonOffset(a,c)}),"sample.alpha":h(32926),"sample.enable":h(32928),"sample.coverage":c([1,!1],function(a,c){b.sampleCoverage(a,c)}),"stencil.enable":h(2960),"stencil.mask":c([-1],function(a){b.stencilMask(a)}),
"stencil.func":c([519,0,-1],function(a,c,d){b.stencilFunc(a,c,d)}),"stencil.opFront":c([7680,7680,7680],function(a,c,d){b.stencilOpSeparate(1028,a,c,d)}),"stencil.opBack":c([7680,7680,7680],function(a,c,d){b.stencilOpSeparate(1029,a,c,d)}),"scissor.enable":h(3089),"scissor.box":c([0,0,-1,-1],function(c,d,e,h){var g=e,k=a.top();0>e&&(g=k?k.width-c:b.drawingBufferWidth-c);e=h;0>h&&(e=k?k.height-d:b.drawingBufferHeight-d);b.scissor(c,d,g,e)}),viewport:c([0,0,-1,-1],function(c,d,l,h){var g=l,k=a.top();
0>l&&(g=k?k.width-c:b.drawingBufferWidth-c);l=h;0>h&&(l=k?k.height-d:b.drawingBufferHeight-d);b.viewport(c,d,g,l);e.width=g;e.height=l})},k=d(),Z=k.proc("poll"),A=k.proc("refresh");Object.keys(g).forEach(function(a){a=k.link(g[a]);Z(a,".poll();");A(a,".setDirty();")});var C=k.compile();return{contextState:g,viewport:e,poll:C.poll,refresh:C.refresh,notifyViewportChanged:function(){g.viewport.setDirty();g["scissor.box"].setDirty()}}}},{"./codegen":6,"./stack":27}],29:[function(e,g,k){g.exports=function(){var c=
{},d=[""];return{id:function(b){var a=c[b];if(a)return a;a=c[b]=d.length;d.push(b);return a},str:function(b){return d[b]}}}},{}],30:[function(e,g,k){function c(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function d(a){if(!Array.isArray(a))return!1;var b=a.length;if(0===b||!Array.isArray(a[0]))return!1;for(var c=a[0].length,d=1;d<b;++d)if(!Array.isArray(a[d])||a[d].length!==c)return!1;return!0}function b(a){return Object.prototype.toString.call(a)}function a(a){return"[object HTMLCanvasElement]"===
b(a)}function G(a){return"[object CanvasRenderingContext2D]"===b(a)}var h=e("./extend"),v=e("./values"),p=e("./is-typed-array"),Z=e("./is-ndarray"),A=e("./load-texture"),C=e("./to-half-float"),f=e("./parse-dds"),x=[9984,9986,9985,9987];g.exports=function(e,g,k,q,N){function K(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=
this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function t(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function T(a,b){var c,d,e=0,h=0,f=0,g=0,k=0,l=0,m=!1,p=!1,t=!1;for(c=0;c<b.length;++c)d=b[c],g=g||d.width<<d.miplevel,
k=k||d.height<<d.miplevel,e=e||d.type,h=h||d.format,f=f||d.internalformat,l=l||d.channels,m=m||d.needsPoll,p=p||d.needsListeners,d=d.miplevel,t=t||0<d;a.needsPoll=m;a.needsListeners=p;a.width=g;a.height=k;a.format=h;a.internalformat=f;a.type=e;if(3553!==a.target)for(c=0;6>c;++c);c=0<=x.indexOf(a.minFilter);a.genMipmaps=!t&&(a.genMipmaps||c);t=t||a.genMipmaps;a.minFilter||(a.minFilter=t?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=l),
d.format||(d.format=h),d.internalformat||(d.internalformat=f),d.type||(d.type=e)}function da(a){this.id=w++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new t(a);this.pixels=[]}function U(a,b){function c(a,d){var e=d.mipmap,n;if(Array.isArray(e))for(var f=0;f<e.length;++f)n=new K(a),n.parseFlags(b),n.parseFlags(d),n.parse(e[f],f),h.push(n);else n=new K(a),n.parseFlags(b),n.parse(d,0),h.push(n)}var d;O(a);var e=a.params;
t.call(e,a.target);var h=a.pixels;h.length=0;e.parse(b);if(3553===a.target)c(3553,b);else{var f=b.faces||b;if(Array.isArray(f))for(d=0;6>d;++d)c(34069+d,f[d]);else if("string"!==typeof f)for(d=0;6>d;++d)c(34069+d,{})}T(e,h);e.needsListeners&&ga(a);e.needsPoll&&(a.pollId=y.length,y.push(a));fa(a)}function fa(a){e.isTexture(a.texture)||(a.texture=e.createTexture());var b=a.target,c=a.unit;0<=c?(e.activeTexture(33984+c),V=c):e.bindTexture(b,a.texture);for(var b=a.pixels,d=a.params,h=0;h<b.length;++h)b[h].upload(d);
d.upload();0>c&&((c=aa[V])?e.bindTexture(c.target,c.texture):(a.unit=V,aa[V]=a))}function ga(a){function b(a,c,d){var n=f(d);n.pixels.forEach(function(b){var d=new K(n.cube?b.target:a);d.channels=n.channels;d.compressed=n.compressed;d.type=n.type;d.internalformat=n.format;d.format=X[n.format];d.width=b.width;d.height=b.height;d.miplevel=b.miplevel||c;d.data=b.data;e.push(d)})}function c(){for(var h=0;h<e.length;++h){var f=e[h],g=f.image,k=f.video,l=f.xhr;g&&g.complete?(f.width=g.naturalWidth,f.height=
g.naturalHeight):k&&2<k.readyState?(f.width=k.width,f.height=k.height):l&&4===l.readyState&&(e[h]=e[e.length-1],e.pop(),l.removeEventListener("readystatechange",fa),b(f.target,f.miplevel,l.response))}T(d,e);fa(a)}var d=a.params,e=a.pixels;e.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){e.forEach(function(a){a.image?a.image.removeEventListener("load",
c):a.video?a.video.removeEventListener("progress",c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function O(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((y[b]=y[y.length-1]).id=b,y.pop(),a.pollId=-1)}function L(a){var b=a.texture,c=a.unit,d=a.target;0<=c&&(e.activeTexture(33984+c),V=c,e.bindTexture(d,null),aa[c]=null);O(a);e.isTexture(b)&&e.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete m[a.id]}var r={"don't care":4352,
"dont care":4352,nice:4354,fast:4353},F={repeat:10497,clamp:33071,mirror:33648},ka={nearest:9728,linear:9729},P=h({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ka),ha={none:0,browser:37444},Q={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},W={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ea={};g.ext_srgb&&(W.srgb=35904,W.srgba=35906);g.oes_texture_float&&
(Q["float"]=5126);g.oes_texture_half_float&&(Q["half float"]=36193);g.webgl_depth_texture&&(h(W,{depth:6402,"depth stencil":34041}),h(Q,{uint16:5123,uint32:5125,"depth stencil":34042}));g.webgl_compressed_texture_s3tc&&h(ea,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});g.webgl_compressed_texture_atc&&h(ea,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});g.webgl_compressed_texture_pvrtc&&h(ea,{"rgb pvrtc 4bppv1":35840,
"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});g.webgl_compressed_texture_etc1&&(ea["rgb etc1"]=36196);var ma=Array.prototype.slice.call(e.getParameter(34467));Object.keys(ea).forEach(function(a){var b=ea[a];0<=ma.indexOf(b)&&(W[a]=b)});var E=Object.keys(W);k.textureFormats=E;var X=E.reduce(function(a,b){var c=W[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});h(K.prototype,{parseFlags:function(a){if("object"===
typeof a&&a){"premultiplyAlpha"in a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=ha[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=W[b];b in Q&&(this.type=Q[b]);b in ea&&(this.compressed=!0)}"type"in a&&(this.type=Q[a.type]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&
(b=c=a.radius),"width"in a&&(b=a.width),"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(e,h){this.miplevel=h;this.width>>=
h;this.height>>=h;var f=e;switch(typeof e){case "object":if(!e)return;this.parseFlags(e);var g=e.data;if("string"===typeof g||g&&(p(g)||c(g)||Z(g)||a(g)||G(g)||"[object HTMLImageElement]"===b(g)||"[object HTMLVideoElement]"===b(g)||d(g)))f=e.data;break;case "undefined":return}"string"===typeof f&&(f=A(f,this.crossOrigin));var g=null,k=!1;if(null!==f)if(p(f))this.data=f;else if(c(f))g=f,k=!0;else if(Z(f)){Array.isArray(f.data)?(g=f.data,k=!0):this.data=f.data;var l=f.shape;this.width=l[0];this.height=
l[1];this.channels=3===l.length?l[2]:1;l=f.stride;this.strideX=f.stride[0];this.strideY=f.stride[1];this.strideC=3===l.length?f.stride[2]:1;this.offset=f.offset;this.needsTranspose=!0}else if(a(f)||G(f))a(f)?this.canvas=f:this.canvas=f.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===b(f))this.image=f,f.complete?(this.width=f.naturalWidth,this.height=f.naturalHeight):(this.width=this.width||f.naturalWidth,this.height=
this.height||f.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();else if("[object HTMLVideoElement]"===b(f))this.video=f,1<f.readyState?(this.width=f.width,this.height=f.height):(this.width=this.width||f.width,this.height=this.height||f.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===b(f))this.xhr=f,this.needsListeners=!0;else if(d(f)){var k=f.length,l=f[0].length,m=1,t,q,v,r;if(Array.isArray(f[0][0]))for(m=f[0][0].length,g=
Array(k*l*m),q=r=0;q<l;++q)for(t=0;t<k;++t)for(v=0;v<m;++v)g[r++]=f[t][q][v];else for(g=Array(k*l),q=r=0;q<l;++q)for(t=0;t<k;++t)g[r++]=f[t][q];this.width=k;this.height=l;this.channels=m;k=!0}else e.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||N.width)|0,this.height=(this.height||N.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&
(this.type=5126));this.internalformat||(this.internalformat=[6409,6410,6407,6408][(this.channels=this.channels||4)-1]);f=this.internalformat;l=this.format=X[f];if(!this.channels)switch(l){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}l=this.type;5126!==l&&36193!==l&&(l||(l=6402===f?5125:5121));this.type=l;if(k)switch(l){case 5121:this.data=new Uint8Array(g);break;case 5123:this.data=new Uint16Array(g);
break;case 5125:this.data=new Uint32Array(g);break;case 5126:this.data=new Float32Array(g);break;case 36193:this.data=C(g)}if(this.data&&this.needsTranspose){g=this.data;f=this.width;k=this.height;l=this.channels;m=this.strideX;t=this.strideY;q=this.strideC;v=this.offset;r=new g.constructor(f*k*l);for(var w=0,x=0;x<k;++x)for(var y=0;y<f;++y)for(var z=0;z<l;++z)r[w++]=g[t*x+m*y+q*z+v];this.data=r}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;
this.channels=4;this.compressed=!1},upload:function(a){e.pixelStorei(37440,this.flipY);e.pixelStorei(37441,this.premultiplyAlpha);e.pixelStorei(37443,this.colorSpace);e.pixelStorei(3317,this.unpackAlignment);var b=this.target,c=this.miplevel,d=this.image,f=this.canvas,h=this.video,g=this.data,k=this.internalformat,m=this.format,p=this.type,t=this.width||Math.max(1,a.width>>c);a=this.height||Math.max(1,a.height>>c);h&&2<h.readyState?e.texImage2D(b,c,m,m,p,h):d&&d.complete?e.texImage2D(b,c,m,m,p,d):
f?e.texImage2D(b,c,m,m,p,f):this.compressed?e.compressedTexImage2D(b,c,k,t,a,0,g):this.copy?(q(),e.copyTexImage2D(b,c,m,this.x,this.y,t,a,0)):g?e.texImage2D(b,c,m,t,a,0,m,p,g):e.texImage2D(b,c,m,t||1,a||1,0,m,p,null)}});h(t.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=P[a.min]);"mag"in a&&(this.magFilter=ka[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=F[d]:Array.isArray(d)&&(b=F[d[0]],c=F[d[1]])}else"wrapS"in a&&(b=
F[a.wrapS]),"wrapT"in a&&(c=F[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=r[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;e.texParameteri(a,10241,this.minFilter);e.texParameteri(a,10240,this.magFilter);e.texParameteri(a,10242,this.wrapS);e.texParameteri(a,10243,this.wrapT);g.ext_texture_filter_anisotropic&&e.texParameteri(a,34046,
this.anisotropic);this.genMipmaps&&(e.hint(33170,this.mipmapHint),e.generateMipmap(a))}});var V=0,w=0,m={},y=[],z=k.maxTextureUnits,aa=Array(z).map(function(){return null});h(da.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<z;++b){var c=aa[b];if(c){if(0<c.bindCount)continue;c.unit=-1}aa[b]=this;a=b;break}this.unit=a;e.activeTexture(33984+a);e.bindTexture(this.target,this.texture);V=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&
L(this)}});return{create:function(a,b){function c(a,e,f,h,g,l){var k=a||{};34067===b&&6===arguments.length&&(k=[a,e,f,h,g,l]);U(d,k);c.width=d.params.width;c.height=d.params.height;return c}var d=new da(b);m[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){v(m).forEach(fa);for(var a=0;a<z;++a)aa[a]=null;V=0;e.activeTexture(33984)},clear:function(){for(var a=0;a<z;++a)e.activeTexture(33984+a),e.bindTexture(3553,null),aa[a]=null;e.activeTexture(33984);
V=0;v(m).forEach(L)},poll:function(){y.forEach(fa)},getTexture:function(a){return null}}}},{"./extend":15,"./is-ndarray":18,"./is-typed-array":19,"./load-texture":21,"./parse-dds":22,"./to-half-float":31,"./values":33}],31:[function(e,g,k){g.exports=function(c){for(var d=new Float32Array(c),d=new Uint32Array(d.buffer),b=new Uint16Array(c.length),a=0;a<c.length;++a)if(isNaN(c[a]))b[a]=65535;else if(Infinity===c[a])b[a]=31744;else if(-Infinity===c[a])b[a]=64512;else{var e=d[a],h=e>>>31<<15,g=(e<<1>>>
24)-127,e=e>>13&1023;b[a]=-24>g?h:-14>g?h+(e+1024>>-14-g):15<g?h+31744:h+(g+15<<10)+e}return b}},{}],32:[function(e,g,k){g.exports=function(c){var d={};return{def:function(b){b=c.id(b);var a=d[b];a||(a=d[b]=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]);return a}}}},{}],33:[function(e,g,k){g.exports=function(c){return Object.keys(c).map(function(d){return c[d]})}},{}],34:[function(e,g,k){g.exports=function(d,b){function a(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==q.alt,q.alt=!!a.altKey);"shiftKey"in a&&(b=
b||a.shiftKey!==q.shift,q.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==q.control,q.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==q.meta,q.meta=!!a.metaKey);return b}function e(d,f){var g=c.x(f),h=c.y(f);"buttons"in f&&(d=f.buttons|0);if(d!==l||g!==D||h!==S||a(f))l=d|0,D=g||0,S=h||0,b&&b(l,D,S,q)}function g(a){e(0,a)}function k(){if(l||D||S||q.shift||q.alt||q.meta||q.control)l=D=S=0,q.shift=q.alt=q.control=q.meta=!1,b&&b(0,0,0,q)}function p(c){a(c)&&b&&b(l,D,S,q)}function Z(a){0===
c.buttons(a)?e(0,a):e(l,a)}function A(a){e(l|c.buttons(a),a)}function C(a){e(l&~c.buttons(a),a)}function f(){N||(N=!0,d.addEventListener("mousemove",Z),d.addEventListener("mousedown",A),d.addEventListener("mouseup",C),d.addEventListener("mouseleave",g),d.addEventListener("mouseenter",g),d.addEventListener("mouseout",g),d.addEventListener("mouseover",g),d.addEventListener("blur",k),d.addEventListener("keyup",p),d.addEventListener("keydown",p),d.addEventListener("keypress",p),d!==window&&(window.addEventListener("blur",
k),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}function x(){N&&(N=!1,d.removeEventListener("mousemove",Z),d.removeEventListener("mousedown",A),d.removeEventListener("mouseup",C),d.removeEventListener("mouseleave",g),d.removeEventListener("mouseenter",g),d.removeEventListener("mouseout",g),d.removeEventListener("mouseover",g),d.removeEventListener("blur",k),d.removeEventListener("keyup",p),d.removeEventListener("keydown",p),d.removeEventListener("keypress",
p),d!==window&&(window.removeEventListener("blur",k),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}b||(b=d,d=window);var l=0,D=0,S=0,q={shift:!1,alt:!1,control:!1,meta:!1},N=!1;f();var K={element:d};Object.defineProperties(K,{enabled:{get:function(){return N},set:function(a){a?f():x},enumerable:!0},buttons:{get:function(){return l},enumerable:!0},x:{get:function(){return D},enumerable:!0},y:{get:function(){return S},enumerable:!0},
mods:{get:function(){return q},enumerable:!0}});return K};var c=e("mouse-event")},{"mouse-event":35}],35:[function(e,g,k){function c(c){return c.target||c.srcElement||window}k.buttons=function(c){if("object"===typeof c){if("buttons"in c)return c.buttons;if("which"in c){c=c.which;if(2===c)return 4;if(3===c)return 2;if(0<c)return 1<<c-1}else if("button"in c){c=c.button;if(1===c)return 4;if(2===c)return 2;if(0<=c)return 1<<c}}return 0};k.element=c;k.x=function(d){if("object"===typeof d){if("offsetX"in
d)return d.offsetX;var b=c(d).getBoundingClientRect();return d.clientX-b.left}return 0};k.y=function(d){if("object"===typeof d){if("offsetY"in d)return d.offsetY;var b=c(d).getBoundingClientRect();return d.clientY-b.top}return 0}},{}],36:[function(e,g,k){var c=e("./lib/extend"),d=e("./lib/context"),b=e("./lib/strings"),a=e("./lib/extension"),G=e("./lib/limits"),h=e("./lib/buffer"),v=e("./lib/elements"),p=e("./lib/texture"),Z=e("./lib/renderbuffer"),A=e("./lib/framebuffer"),C=e("./lib/uniform"),f=
e("./lib/attribute"),x=e("./lib/shader"),l=e("./lib/draw"),D=e("./lib/state"),S=e("./lib/compile"),q=e("./lib/read"),N=e("./lib/dynamic"),K=e("./lib/raf"),t=e("./lib/clock");g.exports=function(){function e(){ia=K.next(e);z.count+=1;if(z.width!==r.drawingBufferWidth||z.height!==r.drawingBufferHeight)z.width=r.drawingBufferWidth,z.height=r.drawingBufferHeight,aa.notifyViewportChanged();var a=t();z.dt=a-z.t;z.t=a;w.poll();for(var b=0;b<Y.length;++b)(0,Y[b])(z.count,z.t,z.dt);z.renderTime=t()-a}function g(){ia&&
(K.cancel(e),ia=0)}function k(a){g();a.preventDefault();if(F.onContextLost)F.onContextLost()}function fa(a){r.getError();ka.refresh();W.refresh();w.refresh();m.refresh();y.refresh();X.refresh();aa.refresh();if(F.onContextRestored)F.onContextRestored();e()}function ga(a){function b(a){var c={},e={};Object.keys(a).forEach(function(b){var f=a[b];N.isDynamic(f)?(d=!0,e[b]=N.unbox(f,b)):c[b]=f});return{dynamic:e,"static":c}}var d=!1,e=b(a.uniforms||{}),f=b(a.attributes||{});a=b(function(a){function b(a){if(a in
d){var c=d[a];delete d[a];Object.keys(c).forEach(function(b){d[a+"."+b]=c[b]})}}var d=c({},a);delete d.uniforms;delete d.attributes;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return d}(a));var e=n.command(a["static"],e["static"],f["static"],a.dynamic,e.dynamic,f.dynamic,d),g=e.draw,h=e.batch,k=e.scope,l=[];return function(a,b){if("number"===typeof a){for(var c=a|0;l.length<c;)l.push(null);return h(a|0,l)}return Array.isArray(a)?h(a.length,a):"function"===
typeof a?k(null,a):"function"===typeof b?k(a,b):g(a)}}function O(){y.poll();aa.poll()}var L=d(Array.prototype.slice.call(arguments)),r=L.gl,F=L.options,L=b(),ka=a(r),P=ka.extensions,ha={width:r.drawingBufferWidth,height:r.drawingBufferHeight},Q=G(r,P),W=h(r),ea=v(r,P,W),ma=C(L),E=f(r,P,Q,W,L),X=x(r,E,ma,function(a){return n.draw(a)},L),V=l(r,P,W),w=p(r,P,Q,O,ha),m=Z(r,P,Q),y=A(r,P,Q,w,m),z={count:0,start:t(),dt:0,t:t(),renderTime:0,width:r.drawingBufferWidth,height:r.drawingBufferHeight,pixelRatio:F.pixelRatio},
aa=D(r,y,ha),ha=q(r,O,ha),n=S(r,L,P,Q,W,ea,w,y,aa,ma,E,X,V,z,O),R=r.canvas,Y=[],ia=0;R&&(R.addEventListener("webglcontextlost",k,!1),R.addEventListener("webglcontextrestored",fa,!1));return c(ga,{clear:function(a){var b=0;O();var c=a.color;c&&(r.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(r.clearDepth(+a.depth),b|=256);"stencil"in a&&(r.clearStencil(a.stencil|0),b|=1024);r.clear(b)},prop:N.define,draw:ga({}),elements:function(a){return ea.create(a)},buffer:function(a){return W.create(a,
34962)},texture:function(a){return w.create(a,3553)},cube:function(a){return 6===arguments.length?w.create(Array.prototype.slice.call(arguments),34067):w.create(a,34067)},renderbuffer:function(a){return m.create(a)},framebuffer:function(a){return y.create(a)},framebufferCube:function(a){},frame:function(a){Y.push(a);!ia&&0<Y.length&&e();return{cancel:function(){var b=Y.find(function(b){return b===a});0>b||(Y.splice(b,1),0>=Y.length&&g())}}},stats:z,limits:Q,read:ha,destroy:function(){g();R&&(R.removeEventListener("webglcontextlost",
k),R.removeEventListener("webglcontextrestored",fa));X.clear();y.clear();m.clear();w.clear();W.clear();if(F.onDestroy)F.onDestroy()}})}},{"./lib/attribute":3,"./lib/buffer":4,"./lib/clock":5,"./lib/compile":7,"./lib/context":11,"./lib/draw":12,"./lib/dynamic":13,"./lib/elements":14,"./lib/extend":15,"./lib/extension":16,"./lib/framebuffer":17,"./lib/limits":20,"./lib/raf":23,"./lib/read":24,"./lib/renderbuffer":25,"./lib/shader":26,"./lib/state":28,"./lib/strings":29,"./lib/texture":30,"./lib/uniform":32}]},
{},[2]);

        </script>
        </body>
      </html>