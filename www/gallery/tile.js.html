<!DOCTYPE html>
      <html>
        <head>
          <title>example/tile.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(h,l,a){function e(d,g){if(!l[d]){if(!h[d]){var r="function"==typeof require&&require;if(!g&&r)return r(d,!0);if(c)return c(d,!0);r=Error("Cannot find module '"+d+"'");throw r.code="MODULE_NOT_FOUND",r;}r=l[d]={exports:{}};h[d][0].call(r.exports,function(c){var a=h[d][1][c];return e(a?a:c)},r,r.exports,e$$0,h,l,a)}return l[d].exports}for(var c="function"==typeof require&&require,d=0;d<a.length;d++)e(a[d]);return e})({1:[function(f,h,l){h.exports=[[[1,11],[1,11],[1,11],[1,11],[1,11],
[1,11],[1,11],[1,11],[6,6],[7,6],[8,6],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,0],[1,0],[1,0],[2,0],[1,11],[1,11],[1,11],[6,6],[7,6],[8,6],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,1],[1,1],[1,1],[2,1],[1,11],[1,11],[1,11],[6,6],[8,8],[8,6],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,1],[1,1],[0,3],[5,2],[1,11],[13,12],[13,12],[6,6],[7,6],[6,9],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[0,1],[1,1],[2,1],[1,11],[1,11],[13,15],[13,15],[6,6],[7,6],[7,6],[6,9],[1,11],[1,11],[1,11],[1,
11]],[[1,11],[0,2],[1,2],[2,2],[1,11],[1,11],[14,2],[15,2],[6,6],[7,6],[7,6],[7,6],[6,9],[8,5],[1,11],[1,11]],[[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[6,6],[8,8],[7,6],[7,6],[7,6],[8,6],[1,11],[1,11]],[[4,5],[2,5],[0,5],[1,5],[2,5],[1,11],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6],[8,9],[6,9],[8,5],[1,11]],[[2,8],[3,9],[4,9],[4,6],[3,9],[5,0],[1,11],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6],[8,8],[8,6],[1,11]],[[4,7],[4,7],[4,8],[5,8],[2,9],[3,9],[4,5],[2,5],[1,11],[1,11],[6,7],[7,8],[7,6],
[7,6],[6,9],[8,5]],[[1,11],[1,11],[3,7],[4,7],[4,8],[5,9],[5,8],[0,9],[2,5],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6],[6,9]],[[1,11],[1,11],[1,11],[1,11],[0,7],[4,8],[4,6],[4,6],[5,1],[1,11],[1,11],[1,11],[6,7],[7,8],[7,6],[7,6]],[[1,11],[9,0],[10,0],[8,0],[1,11],[3,7],[1,7],[1,7],[5,7],[1,11],[1,11],[1,11],[1,11],[6,7],[7,7],[7,7]],[[1,11],[9,1],[11,3],[11,1],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11]],[[1,11],[9,2],[7,2],[11,2],[1,11],[1,11],[1,11],[2,12],[1,
13],[1,13],[1,13],[1,13],[1,13],[1,13],[0,12],[1,11]],[[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[1,11],[2,10],[3,10],[3,10],[3,10],[3,10],[3,10],[3,10],[0,10],[1,11]]]},{}],2:[function(f,h,l){var a=f("../regl")(),e=f("mouse-change")(),c=f("./assets/map.json"),d=a({frag:"\n  precision mediump float;\n  uniform sampler2D map, tiles;\n  uniform vec2 mapSize, tileSize;\n  varying vec2 uv;\n  void main() {\n    vec2 tileCoord = floor(255.0 * texture2D(map, floor(uv) / mapSize).ra);\n    gl_FragColor = texture2D(tiles, (tileCoord + fract(uv)) / tileSize);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  uniform vec4 view;\n  varying vec2 uv;\n  void main() {\n    uv = mix(view.xw, view.zy, 0.5 * (1.0 + position));\n    gl_Position = vec4(position, 1, 1);\n  }",depth:{enable:!1},uniforms:{tiles:a.texture("assets/tiles.png"),tileSize:[16,16],map:a.texture(c),mapSize:[c[0].length,c.length],view:a.prop("view")},attributes:{position:a.buffer([-1,-1,1,-1,-1,1,1,1,-1,1,1,-1])},count:6});a.frame(function(){var L=a.stats,g=L.width,r=L.height,
L=c[0].length*e.x/g,m=c.length*e.y/r,g=g/r*10;d({view:[L-.5*g,m-5,L+.5*g,m+5]})})},{"../regl":36,"./assets/map.json":1,"mouse-change":34}],3:[function(f,h,l){var a=f("./constants/dtypes.json");h.exports=function(e,c,d,L,g){function r(){this.pointer=!1;this.w=this.z=this.y=this.x=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function m(c){this.records=[];this.name=c}function f(d,b,a,k){k=a.size||k;var m;m=b.pointer?a.pointer&&b.buffer===a.buffer&&
b.size===k&&b.normalized===a.normalized&&b.type===a.type&&b.offset===a.offset&&b.stride===a.stride&&b.divisor===a.divisor:!a.pointer&&b.x===a.x&&b.y===a.y&&b.z===a.z&&b.w===a.w;m||(a.pointer?(b.pointer||e.enableVertexAttribArray(d),b.buffer!==a.buffer&&a.buffer.bind(),e.vertexAttribPointer(d,k,a.type,a.normalized,a.stride,a.offset),(m=c.angle_instanced_arrays)&&m.vertexAttribDivisorANGLE(d,a.divisor)):(b.pointer&&e.disableVertexAttribArray(d),e.vertexAttrib4f(d,a.x,a.y,a.z,a.w)),(b.pointer=a.pointer)?
(b.buffer=a.buffer,b.size=k,b.normalized=a.normalized,b.type=a.type,b.offset=a.offset,b.stride=a.stride,b.divisor=a.divisor):(b.x=a.x,b.y=a.y,b.z=a.z,b.w=a.w))}var h={};d=d.maxAttributes;for(var x=Array(d),k=0;k<d;++k)x[k]=new r;return{bindings:x,bind:function(a,b,c,d){c=c.records;f(a,b,c[c.length-1],d)},bindRecord:f,def:function(a){var b=g.id(a),c=h[b];c||(c=h[b]=new m(a));return c},box:function(c){var b=[new r];return{alloc:function(c){var d;d=0>=b.length?new r:b.pop();if("number"===typeof c)d.pointer=
!1,d.x=c,d.y=0,d.z=0,d.w=0;else if(Array.isArray(c))d.pointer=!1,d.x=c[0],d.y=c[1],d.z=c[2],d.w=c[3];else{var e=L.getBuffer(c),k=0,m=0,g=0,f=0,h=!1,u=5126;e?u=e.dtype:(e=L.getBuffer(c.buffer),k=c.size||0,m=c.stride||0,g=c.offset||0,f=c.divisor||0,h=c.normalized||!1,u=e.dtype,"type"in c&&(u=a[c.type]));d.pointer=!0;d.buffer=e;d.size=k;d.offset=g;d.stride=m;d.divisor=f;d.normalized=h;d.type=u}return d},free:function(c){b.push(c)}}},state:h}}},{"./constants/dtypes.json":7}],4:[function(f,h,l){function a(c,
a){switch(c){case 5121:return new Uint8Array(a);case 5123:return new Uint16Array(a);case 5125:return new Uint32Array(a);case 5120:return new Int8Array(a);case 5122:return new Int16Array(a);case 5124:return new Int32Array(a);case 5126:return new Float32Array(a);default:return null}}var e=f("./util/is-typed-array"),c=f("./util/is-ndarray"),d=f("./constants/arraytypes.json"),L=f("./constants/dtypes.json"),g=f("./util/values"),r={"static":35044,dynamic:35048,stream:35040};h.exports=function(m){function f(c,
a){this.id=k++;this.buffer=c;this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.data=null;this.dtype=5121}function h(c){m.isBuffer(c.buffer)||(c.buffer=m.createBuffer());c.bind();m.bufferData(c.type,c.data||c.byteLength,c.usage)}function x(c){var a=c.buffer;m.isBuffer(a)&&m.deleteBuffer(a);c.buffer=null;delete u[c.id]}var k=0,u={};f.prototype.bind=function(){m.bindBuffer(this.type,this.buffer)};return{create:function(b,k,g){function v(b){var k=b||{};if(Array.isArray(k)||e(k)||c(k))k=
{data:k};else if("number"===typeof k)k={length:k|0};else if(null===k||void 0===k)k={};l.usage="usage"in k?r[k.usage]:35044;b=0;"type"in k&&(b=L[k.type]);var m=k.dimension|0||1,g=0,f=null;if("data"in k)if(f=k.data,null===f)g=k.length|0;else{if(c(f)){var m=f.shape,g=f.stride,k=f.offset,w=0,u=0,q=0,p=0;1===m.length?(w=m[0],u=1,q=g[0],p=0):2===m.length&&(w=m[0],u=m[1],q=g[0],p=g[1]);b=b||d[Object.prototype.toString.call(f)]|0||5126;for(var m=u,g=a(b,w*u),f=f.data,S=0,ha=0;ha<w;++ha)for(var O=0;O<u;++O)g[S++]=
f[q*ha+p*O+k];f=g}else if(Array.isArray(f))if(0<f.length&&Array.isArray(f[0])){m=f[0].length;b=b||5126;k=a(b,f.length*m);g=f;f=m;for(w=p=0;w<g.length;++w)for(q=g[w],u=0;u<f;++u)k[p++]=q[u];f=k}else b=b||5126,f=a(b,f);else b=b||d[Object.prototype.toString.call(f)]|0;g=f.byteLength}else"length"in k&&(g=k.length|0);l.data=f;l.dtype=b||5121;l.byteLength=g;l.dimension=m;h(l);return v}var y=m.createBuffer(),l=new f(y,k);u[l.id]=l;g||v(b);v._reglType="buffer";v._buffer=l;v.destroy=function(){x(l)};return v},
clear:function(){g(u).forEach(x)},refresh:function(){g(u).forEach(h)},getBuffer:function(c){return c&&c._buffer instanceof f?c._buffer:null}}}},{"./constants/arraytypes.json":6,"./constants/dtypes.json":7,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/values":33}],5:[function(f,h,l){function a(c){switch(c){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function e(c,a,d,e){var b,m=",";switch(a){case 5126:b=
"1f";break;case 35664:b="2fv";break;case 35665:b="3fv";break;case 35666:b="4fv";break;case 35670:case 5124:b="1i";break;case 35671:case 35667:b="2iv";break;case 35672:case 35668:b="3iv";break;case 35673:case 35669:b="4iv";break;case 35674:b="Matrix2fv";m=",false,";break;case 35675:b="Matrix3fv";m=",false,";break;case 35676:b="Matrix4fv",m=",false,"}return c+".uniform"+b+"("+d+m+e+");"}function c(c){return c+"["+c+".length-1]"}function d(c,a){return"framebuffer"===c||c<a?-1:c>a?1:0}var L=f("./util/codegen"),
g=f("./constants/primitives.json"),r={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},m={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,
gequal:518,">=":518,always:519},R={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386};h.exports=function(f,h,k,u,b,w,q,v,l,N,t,E,Q,ja,W){function fa(b,p,h,u,T){function q(c){var a=H[c];return a?a:a=H[c]=A(V[c])}function l(c){var a=c.id,b=W[a];if(b)return b;b=c.func?n.def(A(c.data),"(",X,",",Z,",",ba,")"):n.def(X,".",c.data);return W[a]=b}function ia(c,a){for(var b=0;b<c.length;++b)if(c[b].name===a)return c[b];return null}function x(c){return ka&&
!(c in p||c in T)}var y=L(),A=y.link,n=y.proc("batch"),ca=y.block(),J=n.def,D=n.arg,z=A(f),M=A(b.program),P=A(t.bind),I=A(t.bindRecord),ba=A(ja),pa=A(v),da=A(Q.count),ga=A(Q.offset),la=A(Q.instances),B=A(Q.primitive),H={},F=A(w.elements),da=J(c(da)),ga=J(c(ga)),B=J(c(B)),F=J(c(F)),K,E,ea=k.angle_instanced_arrays;ea&&(K=J(c(la)),E=A(ea));var ka="elements"in p,la=D(),D=D(),X=J(),Z=J(),W={};n(z,".useProgram(",M,");");b.uniforms.forEach(function(c){if(!(c.name in h)){var a=A(c.location),b=A(N.def(c.name)),
b=b+"["+b+".length-1]";c=c.info.type;35678===c||35680===c?(c=J(b+"._texture"),n(e(z,5124,a,c+".bind()")),ca(c,".unbind();")):n(e(z,c,a,b))}});b.attributes.forEach(function(c){if(!(c.name in u)){var b=A(t.def(c.name));n(P,"(",c.location,",",A(t.bindings[c.location]),",",b,",",a(c.info.type),");")}});ka||n("if(",F,")",z,".bindBuffer(",34963,",",F,".buffer.buffer);");n("for(",Z,"=0;",Z,"<",la,";++",Z,"){",X,"=",D,"[",Z,"];");Object.keys(p).sort(d).forEach(function(c){function a(c){n("if(",b,"){",z,".enable(",
c,");}else{",z,".disable(",c,");}")}var b=l(p[c]);switch(c){case "framebuffer":c=q("viewport");var d=q("scissor.box");n("if(",pa,".push(",b,"&&",b,"._framebuffer)){",pa,".poll();",c,".setDirty();",d,".setDirty();","}");break;case "cull.enable":a(2884);break;case "blend.enable":a(3042);break;case "dither":a(3024);break;case "stencil.enable":a(2960);break;case "depth.enable":a(2929);break;case "scissor.enable":a(3089);break;case "polygonOffset.enable":a(32823);break;case "sample.alpha":a(32926);break;
case "sample.enable":a(32928);break;case "depth.mask":n(z,".depthMask(",b,");");break;case "depth.func":c=A(m);n(z,".depthFunc(",c,"[",b,"]);");break;case "depth.range":n(z,".depthRange(",b,"[0],",b,"[1]);");break;case "blend.color":n(z,".blendColor(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");break;case "blend.equation":c=A(G);n("if(typeof ",b,'==="string"){',z,".blendEquation(",c,"[",b,"]);","}else{",z,".blendEquationSeparate(",c,"[",b,".rgb],",c,"[",b,".alpha]);","}");break;case "blend.func":c=A(r);
n(z,".blendFuncSeparate(",c,'["srcRGB" in ',b,"?",b,".srcRGB:",b,".src],",c,'["dstRGB" in ',b,"?",b,".dstRGB:",b,".dst],",c,'["srcAlpha" in ',b,"?",b,".srcAlpha:",b,".src],",c,'["dstAlpha" in ',b,"?",b,".dstAlpha:",b,".dst]);");break;case "stencil.mask":n(z,".stencilMask(",b,");");break;case "stencil.func":c=A(m);n(z,".stencilFunc(",c,"[",b,'.cmp||"always"],',b,".ref|0,",'"mask" in ',b,"?",b,".mask:-1);");break;case "stencil.opFront":case "stencil.opBack":d=A(R);n(z,".stencilOpSeparate(","stencil.opFront"===
c?1028:1029,",",d,"[",b,'.fail||"keep"],',d,"[",b,'.zfail||"keep"],',d,"[",b,'.pass||"keep"]);');break;case "polygonOffset.offset":n(z,".polygonOffset(",b,".factor||0,",b,".units||0);");break;case "cull.face":n(z,".cullFace(",b,'==="front"?',1028,":",1029,");");break;case "lineWidth":n(z,".lineWidth(",b,");");break;case "frontFace":n(z,".frontFace(",b,'==="cw"?',2304,":",2305,");");break;case "colorMask":n(z,".colorMask(",b,"[0],",b,"[1],",b,"[2],",b,"[3]);");break;case "sample.coverage":n(z,".sampleCoverage(",
b,".value,",b,".invert);");break;case "scissor.box":case "viewport":c=q(c),n(c,".push(",b,".x||0,",b,".y||0,",b,".w||-1,",b,".h||-1);")}});("viewport"in p||"framebuffer"in p)&&n(q("viewport"),".poll();");("scissor.box"in p||"framebuffer"in p)&&n(q("scissor.box"),".poll();");"framebuffer"in p&&n(pa,".pop();");var fa=b.uniforms,ra=[];Object.keys(h).forEach(function(c){var b=ia(fa,c);if(b){var a=b.info.type,d=A(b.location);c=l(h[c]);35678===b.info.type||35680===b.info.type?(b=J(c+"._texture"),ra.push(b),
n(e(z,5124,d,b+".bind()"))):n(e(z,a,d,c))}});ra.forEach(function(c){n(c,".unbind();")});var ta=b.attributes;Object.keys(u).forEach(function(c){var b=ia(ta,c);if(b){var d=A(t.box(c));c=l(u[c]);c=J(d+".alloc("+c+")");n(I,"(",b.location,",",A(t.bindings[b.location]),",",c,",",a(b.info.type),");");ca(d,".free(",c,");")}});p.count&&n(da,"=",l(p.count),";");p.offset&&n(ga,"=",l(p.offset),";");p.primitive&&n(B,"=",A(g),"[",l(p.primitive),"];");ea&&p.instances&&n(K,"=",l(p.instances),";");ka&&(b=l(p.elements),
n(F,"=",b,"?",b,"._elements:null;"));x("offset")&&n(ga,"=0;");n("if(",F,"){");x("count")&&n(da,"=",F,".vertCount;");n("if(",da,">0){");x("primitive")&&n(B,"=",F,".primType;");ka&&n(z,".bindBuffer(",34963,",",F,".buffer.buffer);");ea&&n("if(",K,">0){",E,".drawElementsInstancedANGLE(",B,",",da,",",F,".type,",ga,",",K,");}else ");n(z,".drawElements(",B,",",da,",",F,".type,",ga,");");n("}}else if(",da,">0){");x("count")||(x("primitive")&&n(B,"=",4,";"),ea&&n("if(",K,">0){",E,".drawArraysInstancedANGLE(",
B,",",ga,",",da,",",K,");}else{"),n(z,".drawArrays(",B,",",ga,",",da,");"),ea&&n("}"));n("}}",ca);return y.compile().batch}var V=l.contextState,G={add:32774,subtract:32778,"reverse subtract":32779};k.ext_blend_minmax&&(G.min=32775,G.max=32776);var p=0;return{draw:function(b){var d=L(),m=d.link,g=d.proc("draw"),p=g.def,r=m(f),h=m(b.program),u=m(t.bind),v=m(Q.count),q=m(Q.offset),l=m(Q.instances),n=m(Q.primitive),x=m(w.elements),R=[];g(r,".useProgram(",h,");");b.attributes.forEach(function(c){var b=
m(t.def(c.name));g(u,"(",c.location,",",m(t.bindings[c.location]),",",b,",",a(c.info.type),");")});b.uniforms.forEach(function(c){var b=m(c.location),a=m(N.def(c.name)),a=a+"["+a+".length-1]";c=c.info.type;35678===c||35680===c?(c=p(a+"._texture"),R.push(c),g(e(r,5124,b,c+".bind()"))):g(e(r,c,b,a))});R.forEach(function(c){g(c,".unbind();")});b=p(c(n));v=p(c(v));q=p(c(q));x=p(c(x));g("if(",v,"){");(h=k.angle_instanced_arrays)?(l=p(c(l)),h=m(h),g("if(",x,"){",x,".bind();","if(",l,">0){",h,".drawElementsInstancedANGLE(",
b,",",v,",",x,".type,",q,",",l,");}else{",r,".drawElements(",b,",",v,",",x,".type,",q,");}","}else if(",l,">0){",h,".drawArraysInstancedANGLE(",b,",",q,",",v,",",l,");}else{",r,".drawArrays(",b,",",q,",",v,");}}")):g("if(",x,"){",x,".bind();",r,".drawElements(",b,",",v,",",x,".type,",q,");","}else{",r,".drawArrays(",b,",",q,",",v,");}}");return d.compile().draw},command:function(c,b,a,e,k,f,u){function q(c){var b=la[c];return b?b:b=la[c]=n(V[c])}function l(c,b){var a=q(c);B(a,".push(",b,");");H(a,
".pop();")}function y(c){var b=c.id,a=ka[b];if(a)return a;a=c.func?F.def(n(c.data),"(",ea,",0,",qa,")"):F.def(ea,".",c.data);return ka[b]=a}var A=L(),n=A.link,C=A.block,J=A.proc,D=p++,z=n(W),M=n(E),P=n(v),I={count:n(Q.count),offset:n(Q.offset),instances:n(Q.instances),primitive:n(Q.primitive)},ba=n(w.elements),pa=n(g),da=n(m),ga=n(R),la={},B=C(),H=C();Object.keys(c).sort(d).forEach(function(b){var a=c[b];switch(b){case "frag":case "vert":a=h.id(a);E.shader("frag"===b?35632:35633,a);B(M,".",b,".push(",
a,");");H(M,".",b,".pop();");break;case "framebuffer":v.getFramebuffer(a);b=q("viewport");var d=q("scissor.box");B("if(",P,".push(",n(a&&a._framebuffer),")){",b,".setDirty();",d,".setDirty();","}");H("if(",P,".pop()){",b,".setDirty();",d,".setDirty();","}");break;case "count":case "offset":case "instances":B(I[b],".push(",a,");");H(I[b],".pop();");break;case "primitive":B(I.primitive,".push(",g[a],");");H(I.primitive,".pop();");break;case "elements":d=w.getElements(a);a=!("primitive"in c);b=!("count"in
c);d?(d=n(d),B(ba,".push(",d,");"),a&&B(I.primitive,".push(",d,".primType);"),b&&B(I.count,".push(",d,".vertCount);")):(B(ba,".push(null);"),a&&B(I.primitive,".push(",4,");"),b&&B(I.count,".push(0);"));a&&H(I.primitive,".pop();");b&&H(I.count,".pop();");"offset"in c||(B(I.offset,".push(0);"),H(I.offset,".pop();"));H(ba,".pop();");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":l(b,
a);break;case "depth.func":l(b,m[a]);break;case "depth.range":b=q(b);B(b,".push(",a[0],",",a[1],");");H(b,".pop();");break;case "blend.func":b=q(b);B(b,".push(",r["srcRGB"in a?a.srcRGB:a.src],",",r["dstRGB"in a?a.dstRGB:a.dst],",",r["srcAlpha"in a?a.srcAlpha:a.src],",",r["dstAlpha"in a?a.dstAlpha:a.dst],");");H(b,".pop();");break;case "blend.equation":b=q(b);"string"===typeof a?B(b,".push(",G[a],",",G[a],");"):"object"===typeof a&&B(b,".push(",G[a.rgb],",",G[a.alpha],");");H(b,".pop();");break;case "blend.color":b=
q(b);B(b,".push(",a[0],",",a[1],",",a[2],",",a[3],");");H(b,".pop();");break;case "stencil.mask":b=q(b);B(b,".push(",a,");");H(b,".pop();");break;case "stencil.func":var d=a.cmp||"keep",e=a.ref||0,a="mask"in a?a.mask:-1;b=q(b);B(b,".push(",m[d],",",e,",",a,");");H(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":d=a.fail||"keep";e=a.zfail||"keep";a=a.pass||"keep";b=q(b);B(b,".push(",R[d],",",R[e],",",R[a],");");H(b,".pop();");break;case "polygonOffset.offset":d=a.factor||0;a=a.units||
0;b=q(b);B(b,".push(",d,",",a,");");H(b,".pop();");break;case "cull.face":d=0;"front"===a?d=1028:"back"===a&&(d=1029);a=q(b);B(a,".push(",d,");");H(a,".pop();");break;case "lineWidth":l(b,a);break;case "frontFace":d=0;"cw"===a?d=2304:"ccw"===a&&(d=2305);a=q(b);B(a,".push(",d,");");H(a,".pop();");break;case "colorMask":b=q(b);B(b,".push(",a.map(function(b){return!!b}).join(),");");H(b,".pop();");break;case "sample.coverage":d="value"in a?a.value:1;a=!!a.invert;b=q(b);B(b,".push(",d,",",a,");");H(b,
".pop();");break;case "viewport":case "scissor.box":var d=a.x||0,e=a.y||0,k=-1,p=-1;"w"in a&&(k=a.w);"h"in a&&(p=a.h);a=q(b);B(a,".push(",d,",",e,",",k,",",p,");");H(a,".pop();")}});Object.keys(b).forEach(function(c){var a=n(N.def(c));c=b[c];c="function"===typeof c&&c._reglType?n(c):Array.isArray(c)?n(c.slice()):+c;B(a,".push(",c,");");H(a,".pop();")});Object.keys(a).forEach(function(b){var c=a[b],d=n(t.def(b));b=n(t.box(b).alloc(c));B(d,".records.push(",b,");");H(d,".records.pop();")});var F=A.block(),
K=A.block(),qa,ea;u&&(qa=n(ja),ea=B.def());var ka={};Object.keys(e).sort(d).forEach(function(b){var a=y(e[b]);switch(b){case "framebuffer":b=q("viewport");var d=q("scissor.box");F("if(",P,".push(",a,"&&",a,"._framebuffer)){",b,".setDirty();",d,".setDirty();","}");K("if(",P,".pop()){",b,".setDirty();",d,".setDirty();","}");break;case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "lineWidth":case "depth.mask":b=
q(b);F(b,".push(",a,");");K(b,".pop();");break;case "count":case "offset":case "instances":b=I[b];F(b,".push(",a,");");K(b,".pop();");break;case "primitive":b=I.primitive;F(b,".push(",pa,"[",a,"]);");K(b,".pop();");break;case "depth.func":b=q(b);F(b,".push(",da,"[",a,"]);");K(b,".pop();");break;case "blend.func":b=q(b);d=n(r);F(b,".push(",d,'["srcRGB" in ',a,"?",a,".srcRGB:",a,".src],",d,'["dstRGB" in ',a,"?",a,".dstRGB:",a,".dst],",d,'["srcAlpha" in ',a,"?",a,".srcAlpha:",a,".src],",d,'["dstAlpha" in ',
a,"?",a,".dstAlpha:",a,".dst]);");K(b,".pop();");break;case "blend.equation":b=q(b);d=n(G);F("if(typeof ",a,'==="string"){',b,".push(",d,"[",a,"],",d,"[",a,"]);","}else{",b,".push(",d,"[",a,".rgb],",d,"[",a,".alpha]);","}");K(b,".pop();");break;case "blend.color":b=q(b);F(b,".push(",a,"[0],",a,"[1],",a,"[2],",a,"[3]);");K(b,".pop();");break;case "stencil.mask":b=q(b);F(b,".push(",a,");");K(b,".pop();");break;case "stencil.func":b=q(b);F(b,".push(",da,"[",a,".cmp],",a,".ref|0,",'"mask" in ',a,"?",
a,".mask:-1);");K(b,".pop();");break;case "stencil.opFront":case "stencil.opBack":b=q(b);F(b,".push(",ga,"[",a,'.fail||"keep"],',ga,"[",a,'.zfail||"keep"],',ga,"[",a,'.pass||"keep"]);');K(b,".pop();");break;case "polygonOffset.offset":b=q(b);F(b,".push(",a,".factor||0,",a,".units||0);");K(b,".pop();");break;case "cull.face":b=q(b);F(b,".push(",a,'==="front"?',1028,":",1029,");");K(b,".pop();");break;case "frontFace":b=q(b);F(b,".push(",a,'==="cw"?',2304,":",2305,");");K(b,".pop();");break;case "colorMask":b=
q(b);F(b,".push(",a,"[0],",a,"[1],",a,"[2],",a,"[3]);");K(b,".pop();");break;case "sample.coverage":b=q(b);F(b,".push(",a,".value,",a,".invert);");K(b,".pop();");break;case "scissor.box":case "viewport":b=q(b);F(b,".push(",a,".x||0,",a,".y||0,",'"w" in ',a,"?",a,".w:-1,",'"h" in ',a,"?",a,".h:-1);");K(b,".pop();");break;case "elements":b=!("primitive"in e)&&!("primitive"in c);var d=!("count"in e)&&!("count"in c),M=!("offset"in e)&&!("offset"in c),k=F.def();F("if(",a,"){",k,"=",a,"._elements;",ba,
".push(",k,");",b?I.primitive+".push("+k+".primType);":"",d?I.count+".push("+k+".vertCount);":"",M?I.offset+".push("+k+".offset);":"","}else{",ba,".push(null);","}");K(ba,".pop();","if(",a,"){",b?I.primitive+".pop();":"",d?I.count+".pop();":"",M?I.offset+".pop();":"","}")}});Object.keys(k).forEach(function(b){var a=n(N.def(b));b=y(k[b]);F(a,".push(",b,");");K(a,".pop();")});Object.keys(f).forEach(function(b){var a=n(t.def(b)),c=y(f[b]);b=n(t.box(b));F(a,".records.push(",b,".alloc(",c,"));");K(b,".free(",
a,".records.pop());")});var X=J("scope"),Z=X.arg(),sa=X.arg();X(B);u&&X(ea,"=",Z,";",F);X(sa,"();",u?K:"",H);X=C();C=X.def();c.frag&&c.vert?(Z=c.frag,X(C,"=",n(E.program(h.id(c.vert),h.id(Z))),";")):X(C,"=",M,".program","(",M,".vert[",M,".vert.length-1]",",",M,".frag[",M,".frag.length-1]",");");Z=J("draw");Z(B,X);u&&Z(ea,"=",Z.arg(),";",F);Z(z,"();","if(",C,")",C,".draw(",u?ea:"",");",u?K:"",H);var na=J("batch");na(B,X);u=n(function(b,a,d){var M=b.batchCache[D];M||(M=b.batchCache[D]=fa(b,e,k,f,c));
return M(a,d)});na("if(",C,"){",z,"();",u,"(",C,",",na.arg(),",",na.arg(),");");Object.keys(e).forEach(function(b){(b=la[b])&&na(b,".setDirty();")});na("}",H);return A.compile()}}}},{"./constants/primitives.json":8,"./util/codegen":24}],6:[function(f,h,l){h.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,
"[object ArrayBuffer]":5121}},{}],7:[function(f,h,l){h.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126}},{}],8:[function(f,h,l){h.exports={points:0,lines:1,"line loop":2,"line strip":3,triangles:4,"triangle strip":5,"triangle fan":6}},{}],9:[function(f,h,l){function a(a,f){function g(){var e=window.innerWidth,k=window.innerHeight;a!==document.body&&(k=a.getBoundingClientRect(),e=k.right-k.left,k=k.top-k.bottom);r.width=h*e;r.height=h*k;c(r.style,{width:e+"px",
height:k+"px"})}var r=document.createElement("canvas"),m=e(r,f);c(r.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(r);a===document.body&&(r.style.position="absolute",c(a.style,{margin:0,padding:0}));var h=+m.options.pixelRatio;window.addEventListener("resize",g,!1);var l=m.options.onDestroy;m.options=c(c({},m.options),{onDestroy:function(){window.removeEventListener("resize",g);a.removeChild(r);l&&l()}});g();return m}function e(a,e){function g(c){try{return a.getContext(c,f)}catch(e){return null}}
var f=e.glOptions||{};return{gl:g("webgl")||g("experimental-webgl")||g("webgl-experimental"),options:c({pixelRatio:window.devicePixelRatio},e)}}var c=f("./util/extend");h.exports=function(d){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:d[0],options:d[1]||{}};var f=document.body,g=d[1]||{};if("string"===typeof d[0])f=document.querySelector(d[0])||document.body;else if("object"===typeof d[0])if(d[0]instanceof HTMLElement)f=d[0];else{if(d[0]instanceof WebGLRenderingContext)return{gl:d[0],
options:c({pixelRatio:1},g)};g=d[0]}return f.nodeName&&"CANVAS"===f.nodeName.toUpperCase()?e(f,g):a(f,g)}},{"./util/extend":25}],10:[function(f,h,l){h.exports=function(a){return{primitive:[4],count:[-1],offset:[0],instances:[0]}}},{}],11:[function(f,h,l){function a(a,e){this.id=c++;this.func=a;this.data=e}function e(c,f){switch(typeof c){case "boolean":case "number":case "string":return new a(!1,c);case "function":return new a(!0,c);default:return e}}var c=0;h.exports={define:e,isDynamic:function(c){return"function"===
typeof c&&!c._reglType||c instanceof a},unbox:function(c,f){return c instanceof a?c:"function"===typeof c&&c!==e?new a(!0,c):new a(!1,f)}}},{}],12:[function(f,h,l){var a=f("./util/is-typed-array"),e=f("./util/is-ndarray"),c=f("./constants/primitives.json");h.exports=function(d,f,g){function r(){this.buffer=null;this.primType=4;this.type=this.vertCount=0}r.prototype.bind=function(){this.buffer.bind()};return{create:function(d){function h(d){var m=f.oes_element_index_uint;if(d)if("number"===typeof d)x(d);
else{var b=null,g="static",q=0;Array.isArray(d)||a(d)||e(d)?b=d:("data"in d&&(b=d.data),"usage"in d&&(g=d.usage),"length"in d&&(q=d.length));Array.isArray(b)||e(b)&&"array"===b.dtype||"type"in d?x({type:d.type||(m?"uint32":"uint16"),usage:g,data:b,length:q}):x({usage:g,data:b,length:q});if(Array.isArray(b)||a(b))x.dimension=3}else x();m=l.buffer.byteLength;b=0;switch(l.buffer.dtype){case 5121:case 5120:b=5121;break;case 5123:case 5122:b=5123;m>>=1;break;case 5125:case 5124:b=5125,m>>=2}g=4;q=l.buffer.dimension;
1===q&&(g=0);2===q&&(g=1);3===q&&(g=4);"object"===typeof d&&("primitive"in d&&(g=c[d.primitive]),"count"in d&&(m=d.vertCount|0));l.primType=g;l.vertCount=m;l.type=b;return h}var l=new r,x=g.create(null,34963,!0);l.buffer=x._buffer;h(d);h._reglType="elements";h._elements=l;h.destroy=function(){x.destroy();l.buffer=null};return h},elements:[null],getElements:function(a){return a&&a._elements instanceof r?a._elements:null}}}},{"./constants/primitives.json":8,"./util/is-ndarray":26,"./util/is-typed-array":27}],
13:[function(f,h,l){h.exports=function(a){function e(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(d){try{c[d]=
a.getExtension(d)}catch(e){}})}var c={};e();return{extensions:c,refresh:e}}},{}],14:[function(f,h,l){var a=f("./util/values"),e=f("./util/extend"),c=[1029];h.exports=function(d,f,g,h,m){function l(b,a,c,d){this.target=b;this.level=a;this.texture=c;this.renderbuffer=d}function C(b){b&&(b.texture&&b.texture._texture.decRef(),b.renderbuffer&&b.renderbuffer._renderbuffer.decRef())}function x(b,a){var c=a.width,d=a.height;if(b.texture)var e=b.texture._texture,m=Math.max(1,e.params.width>>b.level),f=Math.max(1,
e.params.height>>b.level),c=c||m,d=d||f;else e=b.renderbuffer._renderbuffer,c=c||e.width,d=d||e.height;e.refCount+=1;a.width=c;a.height=d}function k(b,a){a?a.texture?d.framebufferTexture2D(36160,b,a.target,a.texture._texture.texture,a.level):d.framebufferRenderbuffer(36160,b,36161,a.renderbuffer._renderbuffer.renderbuffer):d.framebufferTexture2D(36160,b,3553,null,0)}function u(b){var a=3553,c=0,d=null,e=null;"object"===typeof b&&("level"in b&&(c=b.level|0),"target"in b&&(a=b.target|0));var m=b._reglType;
"texture"===m?d=b:"renderbuffer"===m&&(e=b,a=36161,c=0);return new l(a,c,d,e)}function b(b){return b&&(b.texture||b.renderbuffer)}function w(){this.id=W++;fa[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function q(b){d.isFramebuffer(b.framebuffer)||(b.framebuffer=d.createFramebuffer());G=!0;d.bindFramebuffer(36160,b.framebuffer);for(var a=b.colorAttachments,
c=0;c<a.length;++c)k(36064+c,a[c]);for(c=a.length;c<g.maxColorAttachments;++c)k(36064+c,null);k(36096,b.depthAttachment);k(36128,b.stencilAttachment);k(33306,b.depthStencilAttachment);f.webgl_draw_buffers&&f.webgl_draw_buffers.drawBuffersWEBGL(ja[a.length]);d.checkFramebufferStatus(36160)}function v(b){b=b.framebuffer;d.isFramebuffer(b)&&d.deleteFramebuffer(b)}function y(){return V[V.length-1]}var N={rgba:6408},t={rgba4:32854,rgb565:36194,"rgb5 a1":32855};f.ext_srgb&&(t.srgba=35907);f.ext_color_buffer_half_float&&
(t.rgba16f=34842,t.rgb16f=34843);f.webgl_color_buffer_float&&(t.rgba32f=34836);var E=[],Q=[];f.webgl_depth_texture&&(E.push(6402),Q.push(34041));e(e({},N),t);a(N);a(t);t=5121;E={uint8:5121};f.oes_texture_half_float&&(t=E["half float"]=36193);f.oes_texture_float&&(t=E["float"]=5126);E.best=t;var ja=function(){for(var b=Array(g.maxDrawbuffers),a=0;a<=g.maxDrawbuffers;++a)for(var c=b[a]=Array(a),d=0;d<a;++d)c[d]=36064+d;return b}(),W=0,fa={},V=[null],G=!0;return{top:y,dirty:function(){return G},push:function(b){b=
b||null;G=G||b!==y();V.push(b);return G},pop:function(){var b=y();V.pop();return G=G||b!==y()},getFramebuffer:function(b){return"function"===typeof b&&"framebuffer"===b._reglType&&(b=b._framebuffer,b instanceof w)?b:null},poll:function(){if(G){var b=V[V.length-1],a=f.webgl_draw_buffers;b?(d.bindFramebuffer(36160,b.framebuffer),a&&a.drawBuffersWEBGL(ja[b.colorAttachments.length])):(d.bindFramebuffer(36160,null),a&&a.drawBuffersWEBGL(c));G=!1}},create:function(a){function c(a){var f,k=a||{},g=a=0;if("shape"in
k){var v=k.shape;a=v[0];g=v[1]}else"radius"in k&&(a=g=k.radius),"width"in k&&(a=k.width),"height"in k&&(g=k.height);var w=null,v=!1;if("colorBuffers"in k||"colorBuffer"in k){w=k.colorBuffers||k.colorBuffer;Array.isArray(w)||(w=[w]);e.width=a;e.height=g;w=w.map(u);for(f=0;f<w.length;++f)x(w[f],e);a=e.width;g=e.height}else{var t=!0,p="rgba",L="uint8",n=1,v=!0;e.width=a=a||d.drawingBufferWidth;e.height=g=g||d.drawingBufferHeight;"format"in k&&(p=k.format,t=p in N);"type"in k&&(L=k.type);"colorCount"in
k&&(n=k.colorCount|0);if(e.ownsColor)for(w=e.colorAttachments;w.length>n;)C(w.pop());else w=[];for(f=0;f<w.length;++f){var y;a:{y=w[f];var E=t,D=p,z=a,M=g;if(y.texture){var P=y.texture;if(E){P({format:D,type:L,width:z,height:M});P._texture.refCount+=1;y=!0;break a}}else if(P=y.renderbuffer,!E){P({format:D,width:z,height:M});P._renderbuffer.refCount+=1;y=!0;break a}C(y);y=!1}y||(w[f--]=w[w.length-1],w.pop())}for(;w.length<n;)t?w.push(new l(3553,0,h.create({format:p,type:L,width:a,height:g},3553),null)):
w.push(new l(36161,0,null,m.create({format:p,width:a,height:g})))}e.width=a;e.height=g;p=t=f=null;L=!1;"depthBuffer"in k&&(f=u(k.depthBuffer));"stencilBuffer"in k&&(t=u(k.stencilBuffer));"depthStencilBuffer"in k&&(p=u(k.depthStencilBuffer));if(f||t||p)x(f||t||p,e);else if(n=!0,E=y=!1,"depth"in k&&(n=!!k.depth),"stencil"in k&&(y=!!k.stencil),"depthTexture"in k&&(E=!!k.depthTexture),k=e.depthAttachment||e.stencilAttachment||e.depthStencilAttachment,D=null,n||y)L=!0,E?(E=y?"depth stencil":"depth",e.ownsDepthStencil&&
k.texture?(k.texture({format:E,width:a,height:g}),k.texture._texture.refCount+=1,D=k):D=new l(3553,0,h.create({format:E,width:a,height:g},3553),null)):(E=n?y?"depth stencil":"depth":"stencil",e.ownsDepthStencil&&k.renderbuffer?(k.renderbuffer({format:E,width:a,height:g}),k.renderbuffer._renderbuffer.refCount+=1,D=k):D=new l(36161,0,null,m.create({format:E,width:a,height:g}))),n?y?p=D:f=D:t=D;a=e;a.colorAttachments.forEach(C);C(a.depthAttachment);C(a.stencilAttachment);C(a.depthStencilAttachment);
e.colorAttachments=w;e.depthAttachment=f;e.stencilAttachment=t;e.depthStencilAttachment=p;e.ownsColor=v;e.ownsDepthStencil=L;c.color=w.map(b);c.depth=b(f);c.stencil=b(t);c.depthStencil=b(p);q(e);c.width=e.width;c.height=e.height;return c}var e=new w;c(a);c._reglType="framebuffer";c._framebuffer=e;c._destroy=function(){v(e)};return c},clear:function(){a(fa).forEach(v)},refresh:function(){a(fa).forEach(q)}}}},{"./util/extend":25,"./util/values":33}],15:[function(f,h,l){h.exports=function(a,e){var c=
1;e.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,f=1;e.webgl_draw_buffers&&(d=a.getParameter(34852),f=a.getParameter(36063));return{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(e).filter(function(a){return!!e[a]}),maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:f,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),
maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),
version:a.getParameter(7938)}}},{}],16:[function(f,h,l){var a=f("./util/is-typed-array");h.exports=function(e,c,d){return function(f){var g=f||{};a(f)?g={data:g}:2===arguments.length?g={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof f&&(g={});c();var h=g.x||0,m=g.y||0,l=g.width||d.width,C=g.height||d.height,g=g.data||new Uint8Array(l*C*4);e.pixelStorei(3333,4);e.readPixels(h,m,l,C,6408,5121,g);return g}}},{"./util/is-typed-array":27}],17:[function(f,h,l){var a=f("./util/values");h.exports=
function(e,c,d){function f(){this.id=l++;this.refCount=1;this.renderbuffer=null;this.format=32854;this.height=this.width=0}function g(a){e.isRenderbuffer(a.renderbuffer)||(a.renderbuffer=e.createRenderbuffer());e.bindRenderbuffer(36161,a.renderbuffer);e.renderbufferStorage(36161,a.format,a.width,a.height)}function h(a){var c=a.renderbuffer;e.bindRenderbuffer(36161,null);e.isRenderbuffer(c)&&e.deleteRenderbuffer(c);a.renderbuffer=null;a.refCount=0;delete C[a.id]}var m={rgba4:32854,rgb565:36194,"rgb5 a1":32855,
depth:33189,stencil:36168,"depth stencil":34041};c.ext_srgb&&(m.srgba=35907);c.ext_color_buffer_half_float&&(m.rgba16f=34842,m.rgb16f=34843);c.webgl_color_buffer_float&&(m.rgba32f=34836);var l=0,C={};f.prototype.decRef=function(){0===--this.refCount&&h(this)};return{create:function(a){function c(b){b=b||{};var a=0,e=0;"shape"in b?(e=b.shape,a=e[0]|0,e=e[1]|0):("radius"in b&&(a=e=b.radius|0),"width"in b&&(a=b.width|0),"height"in b&&(e=b.height|0));c.width=d.width=Math.max(a,1);c.height=d.height=Math.max(e,
1);d.format=32854;"format"in b&&(d.format=m[b.format]);g(d);return c}var d=new f;C[d.id]=d;c(a);c._reglType="renderbuffer";c._renderbuffer=d;c.destroy=function(){d.decRef()};return c},refresh:function(){a(C).forEach(g)},clear:function(){a(C).forEach(h)}}}},{"./util/values":33}],18:[function(f,h,l){function a(a,d,e,f){this.name=a;this.id=d;this.location=e;this.info=f}var e=f("./util/values");h.exports=function(c,d,f,g,h){function m(b,a){var d=35632===b?x:k,e=d[a];if(!e){var f=h.str(a),e=c.createShader(b);
c.shaderSource(e,f);c.compileShader(e);d[a]=e}return e}function l(b,a){this.fragId=b;this.vertId=a;this.program=null;this.uniforms=[];this.attributes=[];this.draw=function(){};this.batchCache={}}function C(b){var e,k;e=m(35632,b.fragId);k=m(35633,b.vertId);var l=b.program=c.createProgram();c.attachShader(l,e);c.attachShader(l,k);c.linkProgram(l);var u=c.getProgramParameter(l,35718),t=b.uniforms=[];for(e=0;e<u;++e)if(k=c.getActiveUniform(l,e))if(1<k.size)for(var E=0;E<k.size;++E){var x=k.name.replace("[0]",
"["+E+"]");f.def(x);t.push(new a(x,h.id(x),c.getUniformLocation(l,x),k))}else f.def(k.name),t.push(new a(k.name,h.id(k.name),c.getUniformLocation(l,k.name),k));u=c.getProgramParameter(l,35721);t=b.attributes=[];for(e=0;e<u;++e)if(k=c.getActiveAttrib(l,e))d.def(k.name),t.push(new a(k.name,h.id(k.name),c.getAttribLocation(l,k.name),k));b.draw=g(b);b.batchCache={}}var x={},k={},u={},b=[];return{clear:function(){var a=c.deleteShader.bind(c);e(x).forEach(a);x={};e(k).forEach(a);k={};b.forEach(function(b){c.deleteProgram(b.program)});
b.length=0;u={}},refresh:function(){x={};k={};b.forEach(C)},program:function(a,c){var d=u[c];d||(d=u[c]={});var e=d[a];e||(e=new l(c,a),C(e),d[a]=e,b.push(e));return e},shader:m,frag:[-1],vert:[-1]}}},{"./util/values":33}],19:[function(f,h,l){var a=f("./util/stack"),e=f("./util/codegen");h.exports=function(c,d,f){function g(d,e){var b=a([!!e],function(b){b?c.enable(d):c.disable(d)});b.flag=d;return b}var h={dither:g(3024),"blend.enable":g(3042),"blend.color":a([0,0,0,0],function(a,d,b,e){c.blendColor(a,
d,b,e)}),"blend.equation":a([32774,32774],function(a,d){c.blendEquationSeparate(a,d)}),"blend.func":a([1,0,1,0],function(a,d,b,e){c.blendFuncSeparate(a,d,b,e)}),"depth.enable":g(2929,!0),"depth.func":a([513],function(a){c.depthFunc(a)}),"depth.range":a([0,1],function(a,d){c.depthRange(a,d)}),"depth.mask":a([!0],function(a){c.depthMask(a)}),"cull.enable":g(2884),"cull.face":a([1029],function(a){c.cullFace(a)}),frontFace:a([2305],function(a){c.frontFace(a)}),colorMask:a([!0,!0,!0,!0],function(a,d,b,
e){c.colorMask(a,d,b,e)}),lineWidth:a([1],function(a){c.lineWidth(a)}),"polygonOffset.enable":g(32823),"polygonOffset.offset":a([0,0],function(a,d){c.polygonOffset(a,d)}),"sample.alpha":g(32926),"sample.enable":g(32928),"sample.coverage":a([1,!1],function(a,d){c.sampleCoverage(a,d)}),"stencil.enable":g(2960),"stencil.mask":a([-1],function(a){c.stencilMask(a)}),"stencil.func":a([519,0,-1],function(a,d,b){c.stencilFunc(a,d,b)}),"stencil.opFront":a([7680,7680,7680],function(a,d,b){c.stencilOpSeparate(1028,
a,d,b)}),"stencil.opBack":a([7680,7680,7680],function(a,d,b){c.stencilOpSeparate(1029,a,d,b)}),"scissor.enable":g(3089),"scissor.box":a([0,0,-1,-1],function(a,e,b,f){var m=b,g=d.top();0>b&&(m=g?g.width-a:c.drawingBufferWidth-a);b=f;0>f&&(b=g?g.height-e:c.drawingBufferHeight-e);c.scissor(a,e,m,b)}),viewport:a([0,0,-1,-1],function(a,e,b,m){var g=b,h=d.top();0>b&&(g=h?h.width-a:c.drawingBufferWidth-a);b=m;0>m&&(b=h?h.height-e:c.drawingBufferHeight-e);c.viewport(a,e,g,b);f.width=g;f.height=b})},m=e(),
l=m.proc("poll"),C=m.proc("refresh");Object.keys(h).forEach(function(a){a=m.link(h[a]);l(a,".poll();");C(a,".setDirty();")});var x=m.compile();return{contextState:h,viewport:f,poll:x.poll,refresh:x.refresh,notifyViewportChanged:function(){h.viewport.setDirty();h["scissor.box"].setDirty()}}}},{"./util/codegen":24,"./util/stack":31}],20:[function(f,h,l){h.exports=function(){var a={"":0},e=[""];return{id:function(c){var d=a[c];if(d)return d;d=a[c]=e.length;e.push(c);return d},str:function(a){return e[a]}}}},
{}],21:[function(f,h,l){function a(b){return Array.isArray(b)&&(0===b.length||"number"===typeof b[0])}function e(b){if(!Array.isArray(b))return!1;var a=b.length;if(0===a||!Array.isArray(b[0]))return!1;for(var c=b[0].length,d=1;d<a;++d)if(!Array.isArray(b[d])||b[d].length!==c)return!1;return!0}function c(a){return Object.prototype.toString.call(a)}function d(a){return"[object HTMLCanvasElement]"===c(a)}function L(a){return"[object CanvasRenderingContext2D]"===c(a)}var g=f("./util/extend"),r=f("./util/values"),
m=f("./util/is-typed-array"),R=f("./util/is-ndarray"),C=f("./util/load-texture"),x=f("./util/to-half-float"),k=f("./util/parse-dds"),u=[9984,9986,9985,9987];h.exports=function(b,f,h,l,y){function N(a){this.target=a;this.premultiplyAlpha=this.flipY=!1;this.unpackAlignment=1;this.type=this.internalformat=this.format=this.channels=this.height=this.width=this.colorSpace=0;this.compressed=!1;this.y=this.x=this.offset=this.strideC=this.strideY=this.strideX=this.miplevel=0;this.copy=!1;this.crossOrigin=
this.xhr=this.canvas=this.video=this.image=this.data=null;this.needsListeners=this.needsPoll=!1}function t(a){this.target=a;this.type=this.internalformat=this.format=this.height=this.width=0;this.wrapT=this.wrapS=33071;this.minFilter=0;this.magFilter=9728;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function E(a,b){var c,d,e=0,f=0,m=0,g=0,k=0,h=0,l=!1,n=!1,r=!1;for(c=0;c<b.length;++c)d=b[c],g=g||d.width<<d.miplevel,k=k||d.height<<d.miplevel,e=e||d.type,f=f||d.format,m=m||d.internalformat,
h=h||d.channels,l=l||d.needsPoll,n=n||d.needsListeners,d=d.miplevel,r=r||0<d;a.needsPoll=l;a.needsListeners=n;a.width=g;a.height=k;a.format=f;a.internalformat=m;a.type=e;if(3553!==a.target)for(c=0;6>c;++c);c=0<=u.indexOf(a.minFilter);a.genMipmaps=!r&&(a.genMipmaps||c);r=r||a.genMipmaps;a.minFilter||(a.minFilter=r?9987:9728);a.wrapS=a.wrapS||33071;a.wrapT=a.wrapT||33071;for(c=0;c<b.length;++c)d=b[c],d.channels||(d.channels=h),d.format||(d.format=f),d.internalformat||(d.internalformat=m),d.type||(d.type=
e)}function Q(a){this.id=n++;this.refCount=1;this.target=a;this.texture=null;this.unit=this.pollId=-1;this.bindCount=0;this.cancelPending=null;this.params=new t(a);this.pixels=[]}function ja(a,b){function c(a,d){var e=d.mipmap,m;if(Array.isArray(e))for(var g=0;g<e.length;++g)m=new N(a),m.parseFlags(b),m.parseFlags(d),m.parse(e[g],g),f.push(m);else m=new N(a),m.parseFlags(b),m.parse(d,0),f.push(m)}var d;V(a);var e=a.params;t.call(e,a.target);var f=a.pixels;f.length=0;e.parse(b);if(3553===a.target)c(3553,
b);else{var m=b.faces||b;if(Array.isArray(m))for(d=0;6>d;++d)c(34069+d,m[d]);else if("string"!==typeof m)for(d=0;6>d;++d)c(34069+d,{})}E(e,f);e.needsListeners&&fa(a);e.needsPoll&&(a.pollId=J.length,J.push(a));W(a)}function W(a){b.isTexture(a.texture)||(a.texture=b.createTexture());var c=a.target,d=a.unit;0<=d?(b.activeTexture(33984+d),A=d):b.bindTexture(c,a.texture);for(var c=a.pixels,e=a.params,f=0;f<c.length;++f)c[f].upload(e);e.upload();0>d&&((d=z[A])?b.bindTexture(d.target,d.texture):(a.unit=
A,z[A]=a))}function fa(a){function b(a,c,d){var f=k(d);f.pixels.forEach(function(b){var d=new N(f.cube?b.target:a);d.channels=f.channels;d.compressed=f.compressed;d.type=f.type;d.internalformat=f.format;d.format=ma[f.format];d.width=b.width;d.height=b.height;d.miplevel=b.miplevel||c;d.data=b.data;e.push(d)})}function c(){for(var f=0;f<e.length;++f){var m=e[f],g=m.image,k=m.video,h=m.xhr;g&&g.complete?(m.width=g.naturalWidth,m.height=g.naturalHeight):k&&2<k.readyState?(m.width=k.width,m.height=k.height):
h&&4===h.readyState&&(e[f]=e[e.length-1],e.pop(),h.removeEventListener("readystatechange",W),b(m.target,m.miplevel,h.response))}E(d,e);W(a)}var d=a.params,e=a.pixels;e.forEach(function(a){a.image&&!a.image.complete?a.image.addEventListener("load",c):a.video&&1>a.readyState?a.video.addEventListener("progress",c):a.xhr&&a.xhr.addEventListener("readystatechange",c)});a.cancelPending=function(){e.forEach(function(a){a.image?a.image.removeEventListener("load",c):a.video?a.video.removeEventListener("progress",
c):a.xhr&&(a.xhr.removeEventListener("readystatechange",c),a.xhr.abort())})}}function V(a){var b=a.cancelPending;b&&(b(),a.cancelPending=null);b=a.pollId;0<=b&&((J[b]=J[J.length-1]).id=b,J.pop(),a.pollId=-1)}function G(a){var c=a.texture,d=a.unit,e=a.target;0<=d&&(b.activeTexture(33984+d),A=d,b.bindTexture(e,null),z[d]=null);V(a);b.isTexture(c)&&b.deleteTexture(c);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete ca[a.id]}var p={"don't care":4352,"dont care":4352,nice:4354,fast:4353},
S={repeat:10497,clamp:33071,mirror:33648},ha={nearest:9728,linear:9729},O=g({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ha),aa={none:0,browser:37444},T={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},U={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Y={};f.ext_srgb&&(U.srgb=35904,U.srgba=35906);f.oes_texture_float&&(T["float"]=5126);f.oes_texture_half_float&&
(T["half float"]=36193);f.webgl_depth_texture&&(g(U,{depth:6402,"depth stencil":34041}),g(T,{uint16:5123,uint32:5125,"depth stencil":34042}));f.webgl_compressed_texture_s3tc&&g(Y,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});f.webgl_compressed_texture_atc&&g(Y,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});f.webgl_compressed_texture_pvrtc&&g(Y,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,
"rgba pvrtc 2bppv1":35843});f.webgl_compressed_texture_etc1&&(Y["rgb etc1"]=36196);var ia=Array.prototype.slice.call(b.getParameter(34467));Object.keys(Y).forEach(function(a){var b=Y[a];0<=ia.indexOf(b)&&(U[a]=b)});var oa=Object.keys(U);h.textureFormats=oa;var ma=oa.reduce(function(a,b){var c=U[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{});g(N.prototype,{parseFlags:function(a){if("object"===typeof a&&a){"premultiplyAlpha"in
a&&(this.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(this.flipY=a.flipY);"alignment"in a&&(this.unpackAlignment=a.alignment);"colorSpace"in a&&(this.colorSpace=aa[a.colorSpace]);if("format"in a){var b=a.format;this.internalformat=U[b];b in T&&(this.type=T[b]);b in Y&&(this.compressed=!0)}"type"in a&&(this.type=T[a.type]);var b=this.width,c=this.height,d=this.channels;"shape"in a?(b=a.shape[0],c=a.shape[1],3===a.shape.length&&(d=a.shape[2])):("radius"in a&&(b=c=a.radius),"width"in a&&(b=a.width),
"height"in a&&(c=a.height),"channels"in a&&(d=a.channels));this.width=b|0;this.height=c|0;this.channels=d|0;"stride"in a?(b=a.stride,this.strideX=b[0],this.strideY=b[1],this.strideC=3===b.length?b[2]:1,this.needsTranspose=!0):(this.strideC=1,this.strideX=this.strideC*d,this.strideY=this.strideX*b);"offset"in a&&(this.offset=a.offset|0,this.needsTranspose=!0);"crossOrigin"in a&&(this.crossOrigin=a.crossOrigin)}},parse:function(b,f){this.miplevel=f;this.width>>=f;this.height>>=f;var g=b;switch(typeof b){case "object":if(!b)return;
this.parseFlags(b);var k=b.data;if("string"===typeof k||k&&(m(k)||a(k)||R(k)||d(k)||L(k)||"[object HTMLImageElement]"===c(k)||"[object HTMLVideoElement]"===c(k)||e(k)))g=b.data;break;case "undefined":return}"string"===typeof g&&(g=C(g,this.crossOrigin));var k=null,h=!1;if(null!==g)if(m(g))this.data=g;else if(a(g))k=g,h=!0;else if(R(g)){Array.isArray(g.data)?(k=g.data,h=!0):this.data=g.data;var l=g.shape;this.width=l[0];this.height=l[1];this.channels=3===l.length?l[2]:1;l=g.stride;this.strideX=g.stride[0];
this.strideY=g.stride[1];this.strideC=3===l.length?g.stride[2]:1;this.offset=g.offset;this.needsTranspose=!0}else if(d(g)||L(g))d(g)?this.canvas=g:this.canvas=g.canvas,this.width=this.canvas.width,this.height=this.canvas.height,this.setDefaultFormat();else if("[object HTMLImageElement]"===c(g))this.image=g,g.complete?(this.width=g.naturalWidth,this.height=g.naturalHeight):(this.width=this.width||g.naturalWidth,this.height=this.height||g.naturalHeight,this.needsListeners=!0),this.setDefaultFormat();
else if("[object HTMLVideoElement]"===c(g))this.video=g,1<g.readyState?(this.width=g.width,this.height=g.height):(this.width=this.width||g.width,this.height=this.height||g.height,this.needsListeners=!0),this.needsPoll=!0,this.setDefaultFormat();else if("[object XMLHttpRequest]"===c(g))this.xhr=g,this.needsListeners=!0;else if(e(g)){var h=g[0].length,l=g.length,n=1,r,t,p,q;if(Array.isArray(g[0][0]))for(n=g[0][0].length,k=Array(h*l*n),t=q=0;t<l;++t)for(r=0;r<h;++r)for(p=0;p<n;++p)k[q++]=g[t][r][p];
else for(k=Array(h*l),t=q=0;t<l;++t)for(r=0;r<h;++r)k[q++]=g[t][r];this.width=h;this.height=l;this.channels=n;h=!0}else b.copy&&(this.copy=!0,this.x|=0,this.y|=0,this.width=(this.width||y.width)|0,this.height=(this.height||y.height)|0,this.setDefaultFormat());!this.type&&this.data&&(6402===this.format?this.data instanceof Uint16Array?this.type=5123:this.data instanceof Uint32Array&&(this.type=5125):this.data instanceof Float32Array&&(this.type=5126));this.internalformat||(this.internalformat=[6409,
6410,6407,6408][(this.channels=this.channels||4)-1]);g=this.internalformat;l=this.format=ma[g];if(!this.channels)switch(l){case 6409:case 6406:case 6402:this.channels=1;break;case 34041:case 6410:this.channels=2;break;case 6407:this.channels=3;break;default:this.channels=4}l=this.type;5126!==l&&36193!==l&&(l||(l=6402===g?5125:5121));this.type=l;if(h)switch(l){case 5121:this.data=new Uint8Array(k);break;case 5123:this.data=new Uint16Array(k);break;case 5125:this.data=new Uint32Array(k);break;case 5126:this.data=
new Float32Array(k);break;case 36193:this.data=x(k)}if(this.data&&this.needsTranspose){k=this.data;g=this.width;h=this.height;l=this.channels;n=this.strideX;r=this.strideY;t=this.strideC;p=this.offset;q=new k.constructor(g*h*l);for(var u=0,E=0;E<h;++E)for(var v=0;v<g;++v)for(var w=0;w<l;++w)q[u++]=k[r*E+n*v+t*w+p];this.data=q}this.needsTranspose=!1},setDefaultFormat:function(){this.format=this.internalformat=6408;this.type=5121;this.channels=4;this.compressed=!1},upload:function(a){b.pixelStorei(37440,
this.flipY);b.pixelStorei(37441,this.premultiplyAlpha);b.pixelStorei(37443,this.colorSpace);b.pixelStorei(3317,this.unpackAlignment);var c=this.target,d=this.miplevel,e=this.image,f=this.canvas,g=this.video,m=this.data,k=this.internalformat,h=this.format,n=this.type,r=this.width||Math.max(1,a.width>>d);a=this.height||Math.max(1,a.height>>d);g&&2<g.readyState?b.texImage2D(c,d,h,h,n,g):e&&e.complete?b.texImage2D(c,d,h,h,n,e):f?b.texImage2D(c,d,h,h,n,f):this.compressed?b.compressedTexImage2D(c,d,k,r,
a,0,m):this.copy?(l(),b.copyTexImage2D(c,d,h,this.x,this.y,r,a,0)):m?b.texImage2D(c,d,h,r,a,0,h,n,m):b.texImage2D(c,d,h,r||1,a||1,0,h,n,null)}});g(t.prototype,{parse:function(a){if("object"===typeof a&&a){"min"in a&&(this.minFilter=O[a.min]);"mag"in a&&(this.magFilter=ha[a.mag]);var b=this.wrapS,c=this.wrapT;if("wrap"in a){var d=a.wrap;"string"===typeof d?b=c=S[d]:Array.isArray(d)&&(b=S[d[0]],c=S[d[1]])}else"wrapS"in a&&(b=S[a.wrapS]),"wrapT"in a&&(c=S[a.wrapT]);this.wrapS=b;this.wrapT=c;"anisotropic"in
a&&(this.anisotropic=a.anisotropic);if("mipmap"in a)switch(a=a.mipmap,typeof a){case "string":this.mipmapHint=p[a];this.genMipmaps=!0;break;case "boolean":this.genMipmaps=!!a}}},upload:function(){var a=this.target;b.texParameteri(a,10241,this.minFilter);b.texParameteri(a,10240,this.magFilter);b.texParameteri(a,10242,this.wrapS);b.texParameteri(a,10243,this.wrapT);f.ext_texture_filter_anisotropic&&b.texParameteri(a,34046,this.anisotropic);this.genMipmaps&&(b.hint(33170,this.mipmapHint),b.generateMipmap(a))}});
var A=0,n=0,ca={},J=[],D=h.maxTextureUnits,z=Array(D).map(function(){return null});g(Q.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var c=0;c<D;++c){var d=z[c];if(d){if(0<d.bindCount)continue;d.unit=-1}z[c]=this;a=c;break}this.unit=a;b.activeTexture(33984+a);b.bindTexture(this.target,this.texture);A=a}return a},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&G(this)}});return{create:function(a,b){function c(a,e,f,g,m,k){var h=a||{};34067===b&&
6===arguments.length&&(h=[a,e,f,g,m,k]);ja(d,h);c.width=d.params.width;c.height=d.params.height;return c}var d=new Q(b);ca[d.id]=d;c(a);c._reglType="texture";c._texture=d;c.destroy=function(){d.decRef()};return c},refresh:function(){r(ca).forEach(W);for(var a=0;a<D;++a)z[a]=null;A=0;b.activeTexture(33984)},clear:function(){for(var a=0;a<D;++a)b.activeTexture(33984+a),b.bindTexture(3553,null),z[a]=null;b.activeTexture(33984);A=0;r(ca).forEach(G)},poll:function(){J.forEach(W)},getTexture:function(a){return null}}}},
{"./util/extend":25,"./util/is-ndarray":26,"./util/is-typed-array":27,"./util/load-texture":28,"./util/parse-dds":29,"./util/to-half-float":32,"./util/values":33}],22:[function(f,h,l){h.exports=function(a){var e={};return{def:function(c){c=a.id(c);var d=e[c];d||(d=e[c]=[]);return d},uniforms:e}}},{}],23:[function(f,h,l){h.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],24:[function(f,h,l){var a=f("./extend");h.exports=
function(){function e(){var d=[],e=[];return a(function(){d.push.apply(d,Array.prototype.slice.call(arguments))},{def:function(){var a="v"+c++;e.push(a);0<arguments.length&&(d.push(a,"="),d.push.apply(d,Array.prototype.slice.call(arguments)),d.push(";"));return a},toString:function(){return[0<e.length?"var "+e+";":"",d.join("")].join("")}})}var c=0,d=[],f=[],g={};return{link:function(a){var e="g"+c++;d.push(e);f.push(a);return e},block:e,proc:function(d){var f=[],h=e(),l=h.toString;return g[d]=a(h,
{arg:function(){var a="a"+c++;f.push(a);return a},toString:function(){return["function(",f.join(),"){",l(),"}"].join("")}})},compile:function(){var a=['"use strict";return {'];Object.keys(g).forEach(function(c){a.push('"',c,'":',g[c].toString(),",")});a.push("}");return Function.apply(null,d.concat([a.join("")])).apply(null,f)}}}},{"./extend":25}],25:[function(f,h,l){h.exports=function(a,e){for(var c=Object.keys(e),d=0;d<c.length;++d)a[c[d]]=e[c[d]];return a}},{}],26:[function(f,h,l){var a=f("./is-typed-array");
h.exports=function(e){return"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||a(e.data))}},{"./is-typed-array":27}],27:[function(f,h,l){var a=f("../constants/arraytypes.json");h.exports=function(e){return Object.prototype.toString.call(e)in a}},{"../constants/arraytypes.json":6}],28:[function(f,h,l){h.exports=function(a,e){if("undefined"!==typeof document){var c;c=(c=/\.(\w+)(\?.*)?$/.exec(a))&&
c[1]?c[1].toLowerCase():void 0;if(0<="avi asf gifv mov qt yuv mpg mpeg m2v mp4 m4p m4v ogg ogv vob webm wmv".split(" ").indexOf(c))return c=document.createElement("video"),c.autoplay=!0,c.loop=!0,e&&(c.crossOrigin=e),c.src=a,c;if(0<=["dds"].indexOf(c))return c=new XMLHttpRequest,c.responseType="arraybuffer",c.open("GET",a,!0),c.send(),c;c=new Image;e&&(c.crossOrigin=e);c.src=a;return c}return null}},{}],29:[function(f,h,l){h.exports=function(f){function h(a){for(var b=p,c=S,d=0;d<U;++d){var e=Math.max(1,
b+3>>2)*Math.max(1,c+3>>2)*aa;ia.pixels.push({target:a,miplevel:d,width:b,height:c,data:new Uint8Array(f,Y,e)});Y+=e;b>>=1;c>>=1}}var l=new Int32Array(f),G=l[v],p=l[N],S=l[y],ha=m,O=0,aa=0,T=4;switch(l[Q]){case k:aa=8;G&x?(T=3,O=c):O=d;break;case u:aa=16;O=L;break;case b:aa=16;O=g;break;case w:aa=8,O=r}var U=1;l[E]&R&&(U=Math.max(1,l[t]));var Y=l[q]+4,ia={width:p,height:S,channels:T,format:O,type:ha,compressed:!0,cube:!1,pixels:[]};if(l[ja]&C)for(ia.cube=!0,l=0;6>l;++l)h(e+l);else h(a);return ia};
var a=3553,e=34069,c=33776,d=33777,L=33778,g=33779,r=36196,m=5121,R=131072,C=512,x=64,k=827611204,u=861165636,b=894720068,w=826496069,q=1,v=2,y=3,N=4,t=7,E=20,Q=21,ja=28},{}],30:[function(f,h,l){h.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(a){return requestAnimationFrame(a)},cancel:function(a){return cancelAnimationFrame(a)}}:{next:function(a){setTimeout(a,30)},cancel:clearTimeout}},{}],31:[function(f,h,l){h.exports=function(a,e){var c=
a.length,d=a.slice(),f=a.slice(),g=!1,h=!0;return{push:function(){g=!1;for(var a=0;a<c;++a){var e=arguments[a];g=g||e!==f[a];d.push(e)}},pop:function(){g=!1;d.length-=c;for(var a=0;a<c;++a)g=g||d[d.length-c+a]!==f[a]},poll:function(){var a=d.length-c;if(g||h){switch(c){case 1:e(d[a]);break;case 2:e(d[a],d[a+1]);break;case 3:e(d[a],d[a+1],d[a+2]);break;case 4:e(d[a],d[a+1],d[a+2],d[a+3]);break;case 5:e(d[a],d[a+1],d[a+2],d[a+3],d[a+4]);break;case 6:e(d[a],d[a+1],d[a+2],d[a+3],d[a+4],d[a+5]);break;
default:e.apply(null,d.slice(a,d.length))}for(var l=0;l<c;++l)f[l]=d[a+l];h=g=!1}},setDirty:function(){h=!0}}}},{}],32:[function(f,h,l){h.exports=function(a){for(var e=new Float32Array(a),e=new Uint32Array(e.buffer),c=new Uint16Array(a.length),d=0;d<a.length;++d)if(isNaN(a[d]))c[d]=65535;else if(Infinity===a[d])c[d]=31744;else if(-Infinity===a[d])c[d]=64512;else{var f=e[d],g=f>>>31<<15,h=(f<<1>>>24)-127,f=f>>13&1023;c[d]=-24>h?g:-14>h?g+(f+1024>>-14-h):15<h?g+31744:g+(h+15<<10)+f}return c}},{}],33:[function(f,
h,l){h.exports=function(a){return Object.keys(a).map(function(e){return a[e]})}},{}],34:[function(f,h,l){h.exports=function(e,c){function d(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==v.alt,v.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==v.shift,v.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==v.control,v.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==v.meta,v.meta=!!a.metaKey);return b}function f(e,g){var h=a.x(g),k=a.y(g);"buttons"in g&&(e=g.buttons|0);if(e!==b||h!==w||k!==q||d(g))b=
e|0,w=h||0,q=k||0,c&&c(b,w,q,v)}function g(a){f(0,a)}function h(){if(b||w||q||v.shift||v.alt||v.meta||v.control)b=w=q=0,v.shift=v.alt=v.control=v.meta=!1,c&&c(0,0,0,v)}function l(a){d(a)&&c&&c(b,w,q,v)}function R(c){0===a.buttons(c)?f(0,c):f(b,c)}function C(c){f(b|a.buttons(c),c)}function x(c){f(b&~a.buttons(c),c)}function k(){y||(y=!0,e.addEventListener("mousemove",R),e.addEventListener("mousedown",C),e.addEventListener("mouseup",x),e.addEventListener("mouseleave",g),e.addEventListener("mouseenter",
g),e.addEventListener("mouseout",g),e.addEventListener("mouseover",g),e.addEventListener("blur",h),e.addEventListener("keyup",l),e.addEventListener("keydown",l),e.addEventListener("keypress",l),e!==window&&(window.addEventListener("blur",h),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}function u(){y&&(y=!1,e.removeEventListener("mousemove",R),e.removeEventListener("mousedown",C),e.removeEventListener("mouseup",x),e.removeEventListener("mouseleave",
g),e.removeEventListener("mouseenter",g),e.removeEventListener("mouseout",g),e.removeEventListener("mouseover",g),e.removeEventListener("blur",h),e.removeEventListener("keyup",l),e.removeEventListener("keydown",l),e.removeEventListener("keypress",l),e!==window&&(window.removeEventListener("blur",h),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))}c||(c=e,e=window);var b=0,w=0,q=0,v={shift:!1,alt:!1,control:!1,meta:!1},y=!1;k();
var N={element:e};Object.defineProperties(N,{enabled:{get:function(){return y},set:function(a){a?k():u},enumerable:!0},buttons:{get:function(){return b},enumerable:!0},x:{get:function(){return w},enumerable:!0},y:{get:function(){return q},enumerable:!0},mods:{get:function(){return v},enumerable:!0}});return N};var a=f("mouse-event")},{"mouse-event":35}],35:[function(f,h,l){function a(a){return a.target||a.srcElement||window}l.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;
if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};l.element=a;l.x=function(e){if("object"===typeof e){if("offsetX"in e)return e.offsetX;var c=a(e).getBoundingClientRect();return e.clientX-c.left}return 0};l.y=function(e){if("object"===typeof e){if("offsetY"in e)return e.offsetY;var c=a(e).getBoundingClientRect();return e.clientY-c.top}return 0}},{}],36:[function(f,h,
l){var a=f("./lib/util/extend"),e=f("./lib/context"),c=f("./lib/strings"),d=f("./lib/extension"),L=f("./lib/limits"),g=f("./lib/buffer"),r=f("./lib/elements"),m=f("./lib/texture"),R=f("./lib/renderbuffer"),C=f("./lib/framebuffer"),x=f("./lib/uniform"),k=f("./lib/attribute"),u=f("./lib/shader"),b=f("./lib/draw"),w=f("./lib/state"),q=f("./lib/compile"),v=f("./lib/read"),y=f("./lib/dynamic"),N=f("./lib/util/raf"),t=f("./lib/util/clock");h.exports=function(){function f(){ba=N.next(f);D.count+=1;if(D.width!==
p.drawingBufferWidth||D.height!==p.drawingBufferHeight)D.width=p.drawingBufferWidth,D.height=p.drawingBufferHeight,z.notifyViewportChanged();var a=t();D.dt=a-D.t;D.t=a;n.poll();for(var b=0;b<I.length;++b)(0,I[b])(D.count,D.t,D.dt);D.renderTime=t()-a}function h(){ba&&(N.cancel(f),ba=0)}function l(a){h();a.preventDefault();if(S.onContextLost)S.onContextLost()}function W(a){p.getError();ha.refresh();U.refresh();n.refresh();ca.refresh();J.refresh();ma.refresh();z.refresh();if(S.onContextRestored)S.onContextRestored();
f()}function fa(b){function c(a){var b={},e={};Object.keys(a).forEach(function(c){var f=a[c];y.isDynamic(f)?(d=!0,e[c]=y.unbox(f,c)):b[c]=f});return{dynamic:e,"static":b}}var d=!1,e=c(b.uniforms||{}),f=c(b.attributes||{});b=c(function(b){function c(a){if(a in d){var b=d[a];delete d[a];Object.keys(b).forEach(function(c){d[a+"."+c]=b[c]})}}var d=a({},b);delete d.uniforms;delete d.attributes;c("blend");c("depth");c("cull");c("stencil");c("polygonOffset");c("scissor");c("sample");return d}(b));var e=
M.command(b["static"],e["static"],f["static"],b.dynamic,e.dynamic,f.dynamic,d),g=e.draw,h=e.batch,k=e.scope,l=[];return function(a,b){if("function"===typeof a)return k(null,a);if("function"===typeof b)return k(a,b);if("number"===typeof a){for(var c=a|0;l.length<c;)l.push(null);return h(a|0,l)}return Array.isArray(a)?h(a.length,a):g(a)}}function V(){J.poll();z.poll()}var G=e(Array.prototype.slice.call(arguments)),p=G.gl,S=G.options,G=c(),ha=d(p),O=ha.extensions,aa={width:p.drawingBufferWidth,height:p.drawingBufferHeight},
T=L(p,O),U=g(p),Y=r(p,O,U),ia=x(G),oa=k(p,O,T,U,G),ma=u(p,oa,ia,function(a){return M.draw(a)},G),A=b(p,O,U),n=m(p,O,T,V,aa),ca=R(p,O,T),J=C(p,O,T,n,ca),D={count:0,start:t(),dt:0,t:t(),renderTime:0,width:p.drawingBufferWidth,height:p.drawingBufferHeight,pixelRatio:S.pixelRatio},z=w(p,J,aa),aa=v(p,V,aa),M=q(p,G,O,T,U,Y,n,J,z,ia,oa,ma,A,D,V),P=p.canvas,I=[],ba=0;P&&(P.addEventListener("webglcontextlost",l,!1),P.addEventListener("webglcontextrestored",W,!1));return a(fa,{clear:function(a){var b=0;V();
var c=a.color;c&&(p.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(p.clearDepth(+a.depth),b|=256);"stencil"in a&&(p.clearStencil(a.stencil|0),b|=1024);p.clear(b)},prop:y.define,draw:fa({}),elements:function(a){return Y.create(a)},buffer:function(a){return U.create(a,34962)},texture:function(a){return n.create(a,3553)},cube:function(a){return 6===arguments.length?n.create(Array.prototype.slice.call(arguments),34067):n.create(a,34067)},renderbuffer:function(a){return ca.create(a)},
framebuffer:function(a){return J.create(a)},framebufferCube:function(a){},frame:function(a){I.push(a);!ba&&0<I.length&&f();return{cancel:function(){var b=I.find(function(b){return b===a});0>b||(I.splice(b,1),0>=I.length&&h())}}},stats:D,limits:T,read:aa,destroy:function(){h();P&&(P.removeEventListener("webglcontextlost",l),P.removeEventListener("webglcontextrestored",W));ma.clear();J.clear();ca.clear();n.clear();U.clear();if(S.onDestroy)S.onDestroy()}})}},{"./lib/attribute":3,"./lib/buffer":4,"./lib/compile":5,
"./lib/context":9,"./lib/draw":10,"./lib/dynamic":11,"./lib/elements":12,"./lib/extension":13,"./lib/framebuffer":14,"./lib/limits":15,"./lib/read":16,"./lib/renderbuffer":17,"./lib/shader":18,"./lib/state":19,"./lib/strings":20,"./lib/texture":21,"./lib/uniform":22,"./lib/util/clock":23,"./lib/util/extend":25,"./lib/util/raf":30}]},{},[2]);

        </script>
        </body>
      </html>