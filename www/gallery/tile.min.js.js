(function e$$0(m,r,k){function a(b,f){if(!r[b]){if(!m[b]){var h="function"==typeof require&&require;if(!f&&h)return h(b,!0);if(l)return l(b,!0);h=Error("Cannot find module '"+b+"'");throw h.code="MODULE_NOT_FOUND",h;}h=r[b]={exports:{}};m[b][0].call(h.exports,function(f){var h=m[b][1][f];return a(h?h:f)},h,h.exports,e$$0,m,r,k)}return r[b].exports}for(var l="function"==typeof require&&require,h=0;h<k.length;h++)a(k[h]);return a})({1:[function(c,m,r){var k=c("../regl")(),a=c("mouse-change")();c("resl")({manifest:{map:{type:"text",
src:"assets/map.json",parser:JSON.parse},tiles:{type:"image",src:"assets/tiles.png",parser:k.texture}},onDone:function(l){var h=l.map,b=k({frag:"\n      precision mediump float;\n      uniform sampler2D map, tiles;\n      uniform vec2 mapSize, tileSize;\n      varying vec2 uv;\n      void main() {\n        vec2 tileCoord = floor(255.0 * texture2D(map, floor(uv) / mapSize).ra);\n        gl_FragColor = texture2D(tiles, (tileCoord + fract(uv)) / tileSize);\n      }",vert:"\n      precision mediump float;\n      attribute vec2 position;\n      uniform vec4 view;\n      varying vec2 uv;\n      void main() {\n        uv = mix(view.xw, view.zy, 0.5 * (1.0 + position));\n        gl_Position = vec4(position, 1, 1);\n      }",
depth:{enable:!1},uniforms:{tiles:l.tiles,tileSize:[16,16],map:k.texture(h),mapSize:[h[0].length,h.length],view:k.prop("view")},attributes:{position:[-1,-1,1,-1,-1,1,1,1,-1,1,1,-1]},count:6});k.frame(function(f){var l=f.viewportWidth,c=f.viewportHeight;k.updateTimer();f=h[0].length*a.x/l;var m=h.length*a.y/c,l=l/c*10;b({view:[f-.5*l,m-5,f+.5*l,m+5]})})}})},{"../regl":36,"mouse-change":33,resl:35}],2:[function(c,m,r){function k(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=
0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}m.exports=function(a,l,h,b,f){a=h.maxAttributes;l=Array(a);for(h=0;h<a;++h)l[h]=new k;return{Record:k,scope:{},state:l}}},{}],3:[function(c,m,r){function k(a){return M[Object.prototype.toString.call(a)]|0}function a(a,b){for(var f=0;f<b.length;++f)a[f]=b[f]}function l(a,b,f,h,k,l,g){for(var c=0,x=0;x<f;++x)for(var e=0;e<h;++e)a[c++]=b[k*x+l*e+g]}function h(a,b,f){for(var h=0,k=0;k<b.length;++k)for(var l=b[k],g=0;g<f;++g)a[h++]=
l[g]}var b=c("./util/is-typed-array"),f=c("./util/is-ndarray"),q=c("./util/values"),z=c("./util/pool"),M=c("./constants/arraytypes.json"),y=c("./constants/dtypes.json"),C=c("./constants/usage.json");m.exports=function(c,m){function w(a){this.id=g++;this.buffer=c.createBuffer();this.type=a;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function u(a,b,f){a.byteLength=b.byteLength;c.bufferData(a.type,b,f)}function B(e,g,x,c,t){e.usage=x;if(Array.isArray(g))e.dtype=c||5126,0<g.length&&
(Array.isArray(g[0])?(e.dimension=g[0].length,c=z.allocType(e.dtype,g.length*e.dimension),h(c,g,e.dimension),u(e,c,x),z.freeType(c)):"number"===typeof g[0]?(e.dimension=t,c=z.allocType(e.dtype,g.length),a(c,g),u(e,c,x),z.freeType(c)):b(g[0])&&(e.dimension=g[0].length,e.dtype=c||k(g[0])||5126,c=z.allocType(e.dtype,g.length*e.dimension),h(c,g,e.dimension),u(e,c,x),z.freeType(c)));else if(b(g))e.dtype=c||k(g),e.dimension=t,u(e,g,x);else if(f(g)){var q=g.shape,v=g.stride;t=g.offset;var w=0,Q=0,C=0,I=
0;1===q.length?(w=q[0],Q=1,C=v[0],I=0):2===q.length&&(w=q[0],Q=q[1],C=v[0],I=v[1]);e.dtype=c||k(g.data)||5126;e.dimension=Q;c=z.allocType(e.dtype,w*Q);l(c,g.data,w,Q,C,I,t);u(e,c,x);z.freeType(c)}}function t(a){m.bufferCount--;c.deleteBuffer(a.buffer);a.buffer=null;delete O[a.id]}var g=0,O={};w.prototype.bind=function(){c.bindBuffer(this.type,this.buffer)};w.prototype.destroy=function(){t(this)};var x=[];return{create:function(e,g,x){function q(a){var e=35044,g=null,h=0,k=0,l=1;Array.isArray(a)||
b(a)||f(a)?g=a:"number"===typeof a?h=a|0:a&&("data"in a&&(g=a.data),"usage"in a&&(e=C[a.usage]),"type"in a&&(k=y[a.type]),"dimension"in a&&(l=a.dimension|0),"length"in a&&(h=a.length|0));u.bind();g?B(u,g,e,k,l):(c.bufferData(u.type,h,e),u.dtype=k||5121,u.usage=e,u.dimension=l,u.byteLength=h);return q}m.bufferCount++;var u=new w(g);O[u.id]=u;x||q(e);q._reglType="buffer";q._buffer=u;q.subdata=function(e,g){var x=(g||0)|0;u.bind();if(Array.isArray(e)){if(0<e.length)if("number"===typeof e[0]){var t=z.allocType(u.dtype,
e.length);a(t,e);c.bufferSubData(u.type,x,t);z.freeType(t)}else if(Array.isArray(e[0])||b(e[0])){var t=e[0].length,w=z.allocType(u.dtype,e.length*t);h(w,e,t);c.bufferSubData(u.type,x,w);z.freeType(w)}}else if(b(e))c.bufferSubData(u.type,x,e);else if(f(e)){var I=e.shape,C=e.stride,m=w=t=0,N=0;1===I.length?(t=I[0],w=1,m=C[0],N=0):2===I.length&&(t=I[0],w=I[1],m=C[0],N=C[1]);I=Array.isArray(e.data)?u.dtype:k(e.data);I=z.allocType(I,t*w);l(I,e.data,t,w,m,N,e.offset);c.bufferSubData(u.type,x,I);z.freeType(I)}return q};
q.destroy=function(){t(u)};return q},createStream:function(a,b){var g=x.pop();g||(g=new w(a),g.buffer=c.createBuffer());g.bind();B(g,b,35040,0,1);return g},destroyStream:function(a){x.push(a)},clear:function(){q(O).forEach(t)},getBuffer:function(a){return a&&a._buffer instanceof w?a._buffer:null},_initBuffer:B}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(c,
m,r){m.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(c,m,r){m.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(c,m,r){m.exports={points:0,point:0,lines:1,line:1,"line loop":2,
"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(c,m,r){m.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(c,m,r){function k(a){return Array.isArray(a)||M(a)||y(a)}function a(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function l(a,e,b,g){this.thisDep=a;this.contextDep=e;this.propDep=b;this.append=g}function h(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function b(a){return new l(!1,!1,!1,
a)}function f(a,e){var b=a.type;return 0===b?(b=a.data.length,new l(!0,1<=b,2<=b,e)):new l(3===b,2===b,1===b,e)}var q=c("./util/codegen"),z=c("./util/loop"),M=c("./util/is-typed-array"),y=c("./util/is-ndarray"),C=c("./util/is-array-like"),J=c("./constants/primitives.json"),K=c("./constants/dtypes.json"),w=["x","y","z","w"],u={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,
"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},B={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},t={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},g={cw:2304,ccw:2305},O=new l(!1,!1,!1,function(){});m.exports=function(c,
e,m,N,y,M,r,v,D,Q,Y,I,ea,ka){function S(a){return a.replace(".","_")}function L(a,d,b){var e=S(a);za.push(a);xa[e]=A[e]=!!b;na[e]=d}function F(a,d,e){var b=S(a);za.push(a);Array.isArray(e)?(A[b]=e.slice(),xa[b]=e.slice()):A[b]=xa[b]=e;oa[b]=d}function V(){var a=q(),d=a.link,b=a.global;a.id=Ja++;a.batchId="0";var g=d(Ha),H=a.shared={props:"a0"};Object.keys(Ha).forEach(function(a){H[a]=b.def(g,".",a)});var G=a.next={},f=a.current={};Object.keys(oa).forEach(function(a){Array.isArray(A[a])&&(G[a]=b.def(H.next,
".",a),f[a]=b.def(H.current,".",a))});var p=a.constants={};Object.keys(Aa).forEach(function(a){p[a]=b.def(JSON.stringify(Aa[a]))});a.invoke=function(p,b){switch(b.type){case 0:var e=["this",H.context,H.props,a.batchId];return p.def(d(b.data),".call(",e.slice(0,Math.max(b.data.length+1,4)),")");case 1:return p.def(H.props,b.data);case 2:return p.def(H.context,b.data);case 3:return p.def("this",b.data)}};a.attribCache={};var Fa={};a.scopeAttrib=function(a){a=e.id(a);if(a in Fa)return Fa[a];var p=Q.scope[a];
p||(p=Q.scope[a]=new la);return Fa[a]=d(p)};return a}function ha(a){var d=a["static"];a=a.dynamic;if("framebuffer"in d){var e=d.framebuffer;return e?(e=v.getFramebuffer(e),b(function(a,d){var n=a.link(e),p=a.shared;d.set(p.framebuffer,".next",n);p=p.context;d.set(p,".framebufferWidth",n+".width");d.set(p,".framebufferHeight",n+".height");return n})):b(function(a,d){var n=a.shared;d.set(n.framebuffer,".next","null");n=n.context;d.set(n,".framebufferWidth",n+".drawingBufferWidth");d.set(n,".framebufferHeight",
n+".drawingBufferHeight");return"null"})}if("framebuffer"in a){var g=a.framebuffer;return f(g,function(a,d){var n=a.invoke(d,g),p=a.shared,b=p.framebuffer,n=d.def(b,".getFramebuffer(",n,")");d.set(b,".next",n);p=p.context;d.set(p,".framebufferWidth",n+"?"+n+".width:"+p+".drawingBufferWidth");d.set(p,".framebufferHeight",n+"?"+n+".height:"+p+".drawingBufferHeight");return n})}return null}function pa(a,d){function b(a){if(a in e){var n=e[a];a=!0;var Ia=n.x|0,G=n.y|0,h,k;"width"in n?h=n.width|0:a=!1;
"height"in n?k=n.height|0:a=!1;return new l(!a&&d&&d.thisDep,!a&&d&&d.contextDep,!a&&d&&d.propDep,function(a,d){var p=a.shared.context,b=h;"width"in n||(b=d.def(p,".","framebufferWidth","-",Ia));var e=k;"height"in n||(e=d.def(p,".","framebufferHeight","-",G));return[Ia,G,b,e]})}if(a in g){var ra=g[a];a=f(ra,function(a,d){var p=a.invoke(d,ra),n=a.shared.context,b=d.def(p,".x|0"),e=d.def(p,".y|0"),g=d.def('"width" in ',p,"?",p,".width|0:","(",n,".","framebufferWidth","-",b,")"),p=d.def('"height" in ',
p,"?",p,".height|0:","(",n,".","framebufferHeight","-",e,")");return[b,e,g,p]});d&&(a.thisDep=a.thisDep||d.thisDep,a.contextDep=a.contextDep||d.contextDep,a.propDep=a.propDep||d.propDep);return a}return d?new l(d.thisDep,d.contextDep,d.propDep,function(a,d){var p=a.shared.context;return[0,0,d.def(p,".","framebufferWidth"),d.def(p,".","framebufferHeight")]}):null}var e=a["static"],g=a.dynamic,G=b("viewport");if(G)var h=G,G=new l(G.thisDep,G.contextDep,G.propDep,function(a,d){var n=h.append(a,d),b=
a.shared.context;d.set(b,".viewportWidth",n[2]);d.set(b,".viewportHeight",n[3]);return n});return{viewport:G,scissor_box:b("scissor.box")}}function sa(a){function d(a){if(a in g){var n=e.id(g[a]);a=b(function(){return n});a.id=n;return a}if(a in k){var Z=k[a];return f(Z,function(a,d){var p=a.invoke(d,Z);return d.def(a.shared.strings,".id(",p,")")})}return null}var g=a["static"],k=a.dynamic,H=d("frag"),G=d("vert"),c=null;h(H)&&h(G)?(c=Y.program(G.id,H.id),a=b(function(a,d){return a.link(c)})):a=new l(H&&
H.thisDep||G&&G.thisDep,H&&H.contextDep||G&&G.contextDep,H&&H.propDep||G&&G.propDep,function(a,d){var n=a.shared.shader,b;b=H?H.append(a,d):d.def(n,".","frag");var e;e=G?G.append(a,d):d.def(n,".","vert");return d.def(n+".program("+e+","+b+")")});return{frag:H,vert:G,progVar:a,program:c}}function ia(a){function d(a,p){if(a in e){var n=e[a]|0;return b(function(a,d){p&&(a.OFFSET=n);return n})}if(a in g){var Z=g[a];return f(Z,function(a,d){var n=a.invoke(d,Z);p&&(a.OFFSET=n);return n})}return p&&H?b(function(a,
d){a.OFFSET="0";return 0}):null}var e=a["static"],g=a.dynamic,H=function(){if("elements"in e){var a=e.elements;k(a)?a=M.getElements(M.create(a)):a&&(a=M.getElements(a));var d=b(function(d,p){if(a){var n=d.link(a);return d.ELEMENTS=n}return d.ELEMENTS=null});d.value=a;return d}if("elements"in g){var n=g.elements;return f(n,function(a,d){var p=a.shared,b=p.isBufferArgs,p=p.elements,e=a.invoke(d,n),g=d.def("null"),b=d.def(b,"(",e,")"),e=a.cond(b).then(g,"=",p,".createStream(",e,");")["else"](g,"=",p,
".getElements(",e,");");d.entry(e);d.exit(a.cond(b).then(p,".destroyStream(",g,");"));return a.ELEMENTS=g})}return null}(),G=d("offset",!0);return{elements:H,primitive:function(){if("primitive"in e){var a=e.primitive;return b(function(d,p){return J[a]})}if("primitive"in g){var d=g.primitive;return f(d,function(a,n){var b=a.constants.primTypes,e=a.invoke(n,d);return n.def(b,"[",e,"]")})}return H?h(H)?H.value?b(function(a,d){return d.def(a.ELEMENTS,".primType")}):b(function(){return 4}):new l(H.thisDep,
H.contextDep,H.propDep,function(a,d){var p=a.ELEMENTS;return d.def(p,"?",p,".primType:",4)}):null}(),count:function(){if("count"in e){var a=e.count|0;return b(function(){return a})}if("count"in g){var d=g.count;return f(d,function(a,n){return a.invoke(n,d)})}return H?h(H)?H?G?new l(G.thisDep,G.contextDep,G.propDep,function(a,d){return d.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):b(function(a,d){return d.def(a.ELEMENTS,".vertCount")}):b(function(){return-1}):new l(H.thisDep||G.thisDep,H.contextDep||
G.contextDep,H.propDep||G.propDep,function(a,d){var p=a.ELEMENTS;return a.OFFSET?d.def(p,"?",p,".vertCount-",a.OFFSET,":-1"):d.def(p,"?",p,".vertCount:-1")}):null}(),instances:d("instances",!1),offset:G}}function qa(a){var d=a["static"],e=a.dynamic,h={};za.forEach(function(a){function n(p,g){if(a in d){var G=p(d[a]);h[k]=b(function(){return G})}else if(a in e){var c=e[a];h[k]=f(c,function(a,d){return g(a,d,a.invoke(d,c))})}}var k=S(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return n(function(a){return a},
function(a,d,n){return n});case "depth.func":return n(function(a){return B[a]},function(a,d,n){return d.def(a.constants.compareFuncs,"[",n,"]")});case "depth.range":return n(function(a){return a},function(a,d,n){a=d.def("+",n,"[0]");d=d.def("+",n,"[1]");return[a,d]});case "blend.func":return n(function(a){return[u["srcRGB"in a?a.srcRGB:a.src],u["dstRGB"in a?a.dstRGB:a.dst],u["srcAlpha"in a?a.srcAlpha:a.src],u["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,d,n){function e(a,p){var g=d.def('"',a,p,'" in ',
n,"?",n,".",a,p,":",n,".",a);return d.def(b,"[",g,"]")}var b=a.constants.blendFuncs;a=e("src","RGB");var g=e("src","Alpha"),Z=e("dst","RGB"),f=e("dst","Alpha");return[a,Z,g,f]});case "blend.equation":return n(function(a){if("string"===typeof a)return[aa[a],aa[a]];if("object"===typeof a)return[aa[a.rgb],aa[a.alpha]]},function(a,d,n){var e=a.constants.blendEquations,b=d.def(),g=d.def();a=a.cond("typeof ",n,'==="string"');a.then(b,"=",g,"=",e,"[",n,"];");a["else"](b,"=",e,"[",n,".rgb];",g,"=",e,"[",
n,".alpha];");d(a);return[b,g]});case "blend.color":return n(function(a){return z(4,function(d){return+a[d]})},function(a,d,n){return z(4,function(a){return d.def("+",n,"[",a,"]")})});case "stencil.mask":return n(function(a){return a|0},function(a,d,n){return d.def(n,"|0")});case "stencil.func":return n(function(a){return[B[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,d,n){a=d.def('"cmp" in ',n,"?",a.constants.compareFuncs,"[",n,".cmp]",":",7680);var e=d.def(n,".ref|0");d=d.def('"mask" in ',
n,"?",n,".mask|0:-1");return[a,e,d]});case "stencil.opFront":case "stencil.opBack":return n(function(d){return["stencil.opBack"===a?1029:1028,t[d.fail||"keep"],t[d.zfail||"keep"],t[d.pass||"keep"]]},function(d,n,e){function b(a){return n.def('"',a,'" in ',e,"?",g,"[",e,".",a,"]:",7680)}var g=d.constants.stencilOps;return["stencil.opBack"===a?1029:1028,b("fail"),b("zfail"),b("pass")]});case "polygonOffset.offset":return n(function(a){return[a.factor|0,a.units|0]},function(a,d,n){a=d.def(n,".factor|0");
d=d.def(n,".units|0");return[a,d]});case "cull.face":return n(function(a){var d=0;"front"===a?d=1028:"back"===a&&(d=1029);return d},function(a,d,n){return d.def(n,'==="front"?',1028,":",1029)});case "lineWidth":return n(function(a){return a},function(a,d,n){return n});case "frontFace":return n(function(a){return g[a]},function(a,d,n){return d.def(n+'==="cw"?2304:2305')});case "colorMask":return n(function(a){return a.map(function(a){return!!a})},function(a,d,n){return z(4,function(a){return"!!"+n+
"["+a+"]"})});case "sample.coverage":return n(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,d,n){a=d.def('"value" in ',n,"?+",n,".value:1");d=d.def("!!",n,".invert");return[a,d]})}});return h}function ma(a){var d=a["static"],e=a.dynamic,g={};Object.keys(d).forEach(function(a){var n=d[a],e;"number"===typeof n||"boolean"===typeof n?e=b(function(){return n}):"function"!==typeof n||"texture2d"!==n._reglType&&"textureCube"!==n._reglType?C(n)&&(e=b(function(a){return a.global.def("[",
z(n.length,function(a){return n[a]}),"]")})):e=b(function(a){return a.link(n)});e.value=n;g[a]=e});Object.keys(e).forEach(function(a){var d=e[a];g[a]=f(d,function(a,n){return a.invoke(n,d)})});return g}function W(a){var d=a["static"],g=a.dynamic,h={};Object.keys(d).forEach(function(a){var n=d[a],g=e.id(a),p=new la;if(k(n))p.state=1,p.buffer=y.getBuffer(y.create(n,34962,!1)),p.type=p.buffer.dtype;else{var f=y.getBuffer(n);if(f)p.state=1,p.buffer=f,p.type=f.dtype;else if(n.constant){var c=n.constant;
p.state=2;"number"===typeof c?p.x=c:w.forEach(function(a,d){d<c.length&&(p[a]=c[d])})}else{var f=y.getBuffer(n.buffer),A=n.offset|0,ra=n.stride|0,l=n.size|0,E=!!n.normalized,v=0;"type"in n&&(v=K[n.type]);n=n.divisor|0;p.buffer=f;p.state=1;p.size=l;p.normalized=E;p.type=v||f.dtype;p.offset=A;p.stride=ra;p.divisor=n}}h[a]=b(function(a,d){var n=a.attribCache;if(g in n)return n[g];var e={isStream:!1};Object.keys(p).forEach(function(a){e[a]=p[a]});p.buffer&&(e.buffer=a.link(p.buffer));return n[g]=e})});
Object.keys(g).forEach(function(a){var d=g[a];h[a]=f(d,function(a,n){function e(a){n(h[a],"=",b,".",a,"|0;")}var b=a.invoke(n,d),g=a.shared,Z=g.isBufferArgs,f=g.buffer,h={isStream:n.def(!1)},k=new la;k.state=1;Object.keys(k).forEach(function(a){h[a]=n.def(""+k[a])});var c=h.buffer,A=h.type;n("if(",Z,"(",b,")){",h.isStream,"=true;",c,"=",f,".createStream(",34962,",",b,");",A,"=",c,".dtype;","}else{",c,"=",f,".getBuffer(",b,");","if(",c,"){",A,"=",c,".dtype;","}else if(",b,".constant){",h.state,"=",
2,";",w.map(function(a,d){return h[a]+"="+b+".length>="+d+"?"+b+"["+d+"]:0;"}).join(""),"}else{",c,"=",f,".getBuffer(",b,".buffer);",A,'="type" in ',b,"?",g.glTypes,"[",b,".type]:",c,".dtype;",h.normalized,"=!!",b,".normalized;");e("size");e("offset");e("stride");e("divisor");n("}}");return h})});return h}function fa(a){var d=a["static"],e=a.dynamic,g={};Object.keys(d).forEach(function(a){var n=d[a];g[a]=b(function(a,d){return"number"===typeof n||"boolean"===typeof n?""+n:a.link(n)})});Object.keys(e).forEach(function(a){var d=
e[a];g[a]=f(d,function(a,n){return a.invoke(n,d)})});return g}function X(a,d,e){var b=a.shared.context,g=a.scope();Object.keys(e).forEach(function(f){d.save(b,"."+f);g(b,".",f,"=",e[f].append(a,d),";")});d(g)}function T(a,d,e){var b=a.shared,g=b.gl,f=b.framebuffer,h;E&&(h=d.def(b.extensions,".webgl_draw_buffers"));var p=a.constants,b=p.drawBuffer,p=p.backBuffer;a=e?e.append(a,d):d.def(f,".next");d("if(",f,".dirty||",a,"!==",f,".cur){","if(",a,"){",g,".bindFramebuffer(",36160,",",a,".framebuffer);");
E&&d(h,".drawBuffersWEBGL(",b,"[",a,".colorAttachments.length]);");d("}else{",g,".bindFramebuffer(",36160,",null);");E&&d(h,".drawBuffersWEBGL(",p,");");d("}",f,".cur=",a,";",f,".dirty=false;","}")}function U(a,d,e){var b=a.shared,g=b.gl,f=a.current,h=a.next,p=b.current,k=b.next,c=a.cond(p,".dirty");za.forEach(function(d){d=S(d);if(!(d in e.state)){var b,Z;if(d in h){b=h[d];Z=f[d];var l=z(A[d].length,function(a){return c.def(b,"[",a,"]")});c(a.cond(l.map(function(a,d){return a+"!=="+Z+"["+d+"]"}).join("||")).then(g,
".",oa[d],"(",l,");",l.map(function(a,d){return Z+"["+d+"]="+a}).join(";"),";"))}else b=c.def(k,".",d),l=a.cond(b,"!==",p,".",d),c(l),d in na?l(a.cond(b).then(g,".enable(",na[d],");")["else"](g,".disable(",na[d],");"),p,".",d,"=",b,";"):l(g,".",oa[d],"(",b,");",p,".",d,"=",b,";")}});0===Object.keys(e.state).length&&c(p,".dirty=false;");d(c)}function ba(d,e,b,g){var f=d.shared,c=d.current,k=f.current,p=f.gl;a(Object.keys(b)).forEach(function(a){var f=b[a];if(!g||g(f)){var A=f.append(d,e);if(na[a]){var l=
na[a];h(f)?A?e(p,".enable(",l,");"):e(p,".disable(",l,");"):e(d.cond(A).then(p,".enable(",l,");")["else"](p,".disable(",l,");"));e(k,".",a,"=",A,";")}else if(C(A)){var E=c[a];e(p,".",oa[a],"(",A,");",A.map(function(a,d){return E+"["+d+"]="+a}).join(";"),";")}else e(p,".",oa[a],"(",A,");",k,".",a,"=",A,";")}})}function ta(a,e){d&&!a.instancing&&(a.instancing=e.def(a.shared.extensions,".angle_instanced_arrays"))}function Ba(a,d,e){e=a.stats;a=a.shared;ka&&d(a.timer,".beginQuery(",e,");")}function ja(a,
d,e){a=a.shared;ka&&d(a.timer,".endQuery();")}function ca(a,e,b,g,f){function h(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function c(b,g,f){function h(){e("if(!",v,".pointer){",l,".enableVertexAttribArray(",E,");",v,".pointer=true;}");var b=f.type,c;c=f.size?e.def(f.size,"||",g):g;e("if(",v,".type!==",b,"||",v,".size!==",c,"||",ra.map(function(a){return v+"."+a+"!=="+f[a]}).join("||"),
"){",l,".bindBuffer(",34962,",",t,".buffer);",l,".vertexAttribPointer(",[E,c,b,f.normalized,f.stride,f.offset],");",v,".type=",b,";",v,".size=",c,";",ra.map(function(a){return v+"."+a+"="+f[a]+";"}).join(""),"}");d&&(b=f.divisor,e("if(",v,".divisor!==",b,"){",a.instancing,".vertexAttribDivisorANGLE(",[E,b],");",v,".divisor=",b,";}"))}function A(){e("if(",v,".pointer){",l,".disableVertexAttribArray(",E,");",v,".pointer=false;","}if(",w.map(function(a,d){return v+"."+a+"!=="+u[d]}).join("||"),"){",
l,".vertexAttrib4f(",E,",",u,");",w.map(function(a,d){return v+"."+a+"="+u[d]+";"}).join(""),"}")}var l=k.gl,E=e.def(b,".location"),v=e.def(k.attributes,"[",E,"]");b=f.state;var t=f.buffer,u=[f.x,f.y,f.z,f.w],ra=["buffer","normalized","offset","stride"];1===b?h():2===b?A():(e("if(",b,"===",1,"){"),h(),e("}else{"),A(),e("}"))}var k=a.shared;g.forEach(function(d){var g=d.name,k=b.attributes[g],p;if(k){if(!f(k))return;p=k.append(a,e)}else{if(!f(O))return;var A=a.scopeAttrib(g);p={};Object.keys(new la).forEach(function(a){p[a]=
e.def(A,".",a)})}c(a.link(d),h(d.info.type),p)})}function da(a,d,b,g,f){for(var c=a.shared,k=c.gl,p,A=0;A<g.length;++A){var l=g[A],v=l.name,E=l.info.type,t=b.uniforms[v],l=a.link(l)+".location",u;if(t){if(!f(t))continue;if(h(t)){v=t.value;if(35678===E||35680===E)E=a.link(v._texture),d(k,".uniform1i(",l,",",E+".bind());"),d.exit(E,".unbind();");else if(35674===E||35675===E||35676===E)v=a.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),t=2,35675===E?t=3:35676===E&&(t=4),d(k,".uniformMatrix",
t,"fv(",l,",false,",v,");");else{switch(E){case 5126:p="1f";break;case 35664:p="2f";break;case 35665:p="3f";break;case 35666:p="4f";break;case 35670:p="1i";break;case 5124:p="1i";break;case 35671:p="2i";break;case 35667:p="2i";break;case 35672:p="3i";break;case 35668:p="3i";break;case 35673:p="4i";break;case 35669:p="4i"}d(k,".uniform",p,"(",l,",",C(v)?Array.prototype.slice.call(v):v,");")}continue}else u=t.append(a,d)}else{if(!f(O))continue;u=d.def(c.uniforms,"[",e.id(v),"]")}v=1;switch(E){case 35678:case 35680:E=
d.def(u,"._texture");d(k,".uniform1i(",l,",",E,".bind());");d.exit(E,".unbind();");continue;case 5124:case 35670:p="1i";break;case 35667:case 35671:p="2i";v=2;break;case 35668:case 35672:p="3i";v=3;break;case 35669:case 35673:p="4i";v=4;break;case 5126:p="1f";break;case 35664:p="2f";v=2;break;case 35665:p="3f";v=3;break;case 35666:p="4f";v=4;break;case 35674:p="Matrix2fv";break;case 35675:p="Matrix3fv";break;case 35676:p="Matrix4fv"}d(k,".uniform",p,"(",l,",");if("M"===p.charAt(0)){var l=Math.pow(E-
35674+2,2),q=a.global.def("new Float32Array(",l,")");d("false,(Array.isArray(",u,")||",u," instanceof Float32Array)?",u,":(",z(l,function(a){return q+"["+a+"]="+u+"["+a+"]"}),",",q,")")}else 1<v?d(z(v,function(a){return u+"["+a+"]"})):d(u);d(");")}}function ya(a,e,b,g){function f(d){var h=A[d];return h?h.contextDep&&g.contextDynamic||h.propDep?h.append(a,b):h.append(a,e):e.def(v,".",d)}function k(){function a(){b(w,".drawElementsInstancedANGLE(",[t,q,z,u+"<<(("+z+"-5121)>>1)",x],");")}function d(){b(w,
".drawArraysInstancedANGLE(",[t,u,q,x],");")}E?C?a():(b("if(",E,"){"),a(),b("}else{"),d(),b("}")):d()}function c(){function a(){b(l+".drawElements("+[t,q,z,u+"<<(("+z+"-5121)>>1)"]+");")}function d(){b(l+".drawArrays("+[t,u,q]+");")}E?C?a():(b("if(",E,"){"),a(),b("}else{"),d(),b("}")):d()}var p=a.shared,l=p.gl,v=p.draw,A=g.draw,E=function(){var d=A.elements,f=e;if(d){if(d.contextDep&&g.contextDynamic||d.propDep)f=b;d=d.append(a,f)}else d=f.def(v,".","elements");d&&f("if("+d+")"+l+".bindBuffer(34963,"+
d+".buffer.buffer);");return d}(),t=f("primitive"),u=f("offset"),q=function(){var d=A.count,f=e;if(d){if(d.contextDep&&g.contextDynamic||d.propDep)f=b;d=d.append(a,f)}else d=f.def(v,".","count");return d}();if("number"===typeof q){if(0===q)return}else b("if(",q,"){"),b.exit("}");var x,w;d&&(x=f("instances"),w=a.instancing);var z=E+".type",C=A.elements&&h(A.elements);d&&("number"!==typeof x||0<=x)?"string"===typeof x?(b("if(",x,">0){"),k(),b("}else if(",x,"<0){"),c(),b("}")):k():c()}function va(a,
b,e,g,f){b=V();f=b.proc("body",f);d&&(b.instancing=f.def(b.shared.extensions,".angle_instanced_arrays"));a(b,f,e,g);return b.compile().body}function Ca(a,d,b,e){ta(a,d);ca(a,d,b,e.attributes,function(){return!0});da(a,d,b,e.uniforms,function(){return!0});ya(a,d,d,b)}function Da(a,d){var b=a.proc("draw",1);ta(a,b);X(a,b,d.context);T(a,b,d.framebuffer);U(a,b,d);ba(a,b,d.state);Ba(a,b,d);var e=d.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",e,".program);");if(d.shader.program)Ca(a,b,d,d.shader.program);
else{var g=a.global.def("{}"),f=b.def(e,".id"),h=b.def(g,"[",f,"]");b(a.cond(h).then(h,".call(this,a0);")["else"](h,"=",g,"[",f,"]=",a.link(function(b){return va(Ca,a,d,b,1)}),"(",e,");",h,".call(this,a0);"))}0<Object.keys(d.state).length&&b(a.shared.current,".dirty=true;");ja(a,b,d)}function Ea(a,d,b,e){function g(){return!0}a.batchId="a1";ta(a,d);ca(a,d,b,e.attributes,g);da(a,d,b,e.uniforms,g);ya(a,d,d,b)}function ua(a,d,b,e){function g(a){return a.contextDep&&h||a.propDep}function f(a){return!g(a)}
ta(a,d);var h=b.contextDep,k=d.def(),c=d.def();a.shared.props=c;a.batchId=k;var l=a.scope(),A=a.scope();d(l.entry,"for(",k,"=0;",k,"<","a1",";++",k,"){",c,"=","a0","[",k,"];",A,"}",l.exit);b.needsContext&&X(a,A,b.context);b.needsFramebuffer&&T(a,A,b.framebuffer);ba(a,A,b.state,g);e?(ca(a,l,b,e.attributes,f),ca(a,A,b,e.attributes,g),da(a,l,b,e.uniforms,f),da(a,A,b,e.uniforms,g),ya(a,l,A,b)):(d=a.global.def("{}"),e=b.shader.progVar.append(a,A),c=A.def(e,".id"),l=A.def(d,"[",c,"]"),A(a.shared.gl,".useProgram(",
e,".program);","if(!",l,"){",l,"=",d,"[",c,"]=",a.link(function(d){return va(Ea,a,b,d,2)}),"(",e,");}",l,".call(this,a0[",k,"],",k,");"))}function Ga(a,d){var b=a.proc("batch",2);a.batchId="0";ta(a,b);var e=!1,g=!0;Object.keys(d.context).forEach(function(a){e=e||d.context[a].propDep});e||(X(a,b,d.context),g=!1);var f=d.framebuffer,h=!1;f?(f.propDep?e=h=!0:f.contextDep&&e&&(h=!0),h||T(a,b,f)):T(a,b,null);d.state.viewport&&d.state.viewport.propDep&&(e=!0);U(a,b,d);ba(a,b,d.state,function(a){return!(a.contextDep&&
e||a.propDep)});Ba(a,b,d);d.contextDep=e;d.needsContext=g;d.needsFramebuffer=h;g=d.shader.progVar;if(g.contextDep&&e||g.propDep)ua(a,b,d,null);else if(g=g.append(a,b),b(a.shared.gl,".useProgram(",g,".program);"),d.shader.program)ua(a,b,d,d.shader.program);else{var f=a.global.def("{}"),h=b.def(g,".id"),k=b.def(f,"[",h,"]");b(a.cond(k).then(k,".call(this,a0,a1);")["else"](k,"=",f,"[",h,"]=",a.link(function(b){return va(ua,a,d,b,2)}),"(",g,");",k,".call(this,a0,a1);"))}0<Object.keys(d.state).length&&
b(a.shared.current,".dirty=true;");ja(a,b,d)}function wa(d,b){function g(a){var e=b.shader[a];e&&f.set(h.shader,"."+a,e.append(d,f))}var f=d.proc("scope",3);d.batchId="a2";var h=d.shared,k=h.current,c=h.timer,l;ka&&(l=f.def(c,".getNumPendingQueries()"));X(d,f,b.context);b.framebuffer&&b.framebuffer.append(d,f);a(Object.keys(b.state)).forEach(function(a){var e=b.state[a].append(d,f);C(e)?e.forEach(function(b,e){f.set(d.next[a],"["+e+"]",b)}):f.set(h.next,"."+a,e)});["elements","offset","count","instances",
"primitive"].forEach(function(a){var e=b.draw[a];e&&f.set(h.draw,"."+a,""+e.append(d,f))});Object.keys(b.uniforms).forEach(function(a){f.set(h.uniforms,"["+e.id(a)+"]",b.uniforms[a].append(d,f))});Object.keys(b.attributes).forEach(function(a){var e=b.attributes[a].append(d,f),g=d.scopeAttrib(a);Object.keys(new la).forEach(function(a){f.set(g,"."+a,e[a])})});g("vert");g("frag");0<Object.keys(b.state).length&&(f(k,".dirty=true;"),f.exit(k,".dirty=true;"));f("a1(",d.shared.context,",a0,0);");if(ka){var A=
d.stats,k=f.def(c,".getNumPendingQueries()-1");f(c,".pushScopeStats(",l,",",k,",",A,");")}}var la=Q.Record,aa={add:32774,subtract:32778,"reverse subtract":32779};m.ext_blend_minmax&&(aa.min=32775,aa.max=32776);var d=m.angle_instanced_arrays,E=m.webgl_draw_buffers,A={dirty:!0},xa={},za=[],na={},oa={};L("dither",3024);L("blend.enable",3042);F("blend.color","blendColor",[0,0,0,0]);F("blend.equation","blendEquationSeparate",[32774,32774]);F("blend.func","blendFuncSeparate",[1,0,1,0]);L("depth.enable",
2929,!0);F("depth.func","depthFunc",513);F("depth.range","depthRange",[0,1]);F("depth.mask","depthMask",!0);F("colorMask","colorMask",[!0,!0,!0,!0]);L("cull.enable",2884);F("cull.face","cullFace",1029);F("frontFace","frontFace",2305);F("lineWidth","lineWidth",1);L("polygonOffset.enable",32823);F("polygonOffset.offset","polygonOffset",[0,0]);L("sample.alpha",32926);L("sample.enable",32928);F("sample.coverage","sampleCoverage",[1,!1]);L("stencil.enable",2960);F("stencil.mask","stencilMask",-1);F("stencil.func",
"stencilFunc",[519,0,-1]);F("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);F("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);L("scissor.enable",3089);F("scissor.box","scissor",[0,0,c.drawingBufferWidth,c.drawingBufferHeight]);F("viewport","viewport",[0,0,c.drawingBufferWidth,c.drawingBufferHeight]);var Ha={gl:c,context:ea,strings:e,next:xa,current:A,draw:I,elements:M,buffer:y,shader:Y,attributes:Q.state,uniforms:D,framebuffer:v,extensions:m,timer:ka,isBufferArgs:k},Aa={primTypes:J,
compareFuncs:B,blendFuncs:u,blendEquations:aa,stencilOps:t,glTypes:K,orientationType:g};E&&(Aa.backBuffer=[1029],Aa.drawBuffer=z(N.maxDrawbuffers,function(a){return 0===a?[0]:z(a,function(a){return 36064+a})}));var Ja=0;return{next:xa,current:A,procs:function(){var a=V(),d=a.proc("poll"),b=a.proc("refresh"),e=a.block();d(e);b(e);var g=a.shared,f=g.gl,h=g.next,k=g.current;e(k,".dirty=false;");T(a,d);b(g.framebuffer,".dirty=true;");T(a,b);Object.keys(na).forEach(function(g){var c=na[g],l=e.def(h,".",
g),A=a.block();A("if(",l,"){",f,".enable(",c,")}else{",f,".disable(",c,")}",k,".",g,"=",l,";");b(A);d("if(",l,"!==",k,".",g,"){",A,"}")});Object.keys(oa).forEach(function(g){var c=oa[g],l=A[g],v,E,t=a.block();t(f,".",c,"(");C(l)?(c=l.length,v=a.global.def(h,".",g),E=a.global.def(k,".",g),t(z(c,function(a){return v+"["+a+"]"}),");",z(c,function(a){return E+"["+a+"]="+v+"["+a+"];"}).join("")),d("if(",z(c,function(a){return v+"["+a+"]!=="+E+"["+a+"]"}).join("||"),"){",t,"}")):(v=e.def(h,".",g),E=e.def(k,
".",g),t(v,");",k,".",g,"=",v,";"),d("if(",v,"!==",E,"){",t,"}"));b(t)});return a.compile()}(),compile:function(a,d,b,e,g){var f=V();f.stats=f.link(g);g=ha(a);var h=pa(a,g),k=ia(a),c=qa(a);a=sa(a);var l=h.viewport;l&&(c.viewport=l);l=S("scissor.box");(h=h[l])&&(c[l]=h);h=0<Object.keys(c).length;g={framebuffer:g,draw:k,shader:a,state:c,dirty:h};g.uniforms=ma(b);g.attributes=W(d);g.context=fa(e);Da(f,g);wa(f,g);Ga(f,g);return f.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,
"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(c,m,r){function k(a,f){this.id=h++;this.type=a;this.data=f}function a(b){if(0===b.length)return[];var f=b.charAt(0),h=b.charAt(b.length-1);if(1<b.length&&f===h&&('"'===f||"'"===f))return['"'+b.substr(1,b.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(f=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(b))return a(b.substr(0,f.index)).concat(a(f[1])).concat(a(b.substr(f.index+
f[0].length)));f=b.split(".");if(1===f.length)return['"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];b=[];for(h=0;h<f.length;++h)b=b.concat(a(f[h]));return b}function l(b){return"["+a(b).join("][")+"]"}var h=0;m.exports={define:function(a,f){switch(typeof f){case "boolean":case "number":case "string":return new k(a,l(f+""));case "undefined":return new k(a|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof k},unbox:function(a,f){if(a instanceof k){if(a.type&
128)return new k(a.type&-129,l(f))}else if("function"===typeof a)return new k(0,a);return a},accessor:l}},{}],10:[function(c,m,r){var k=c("./util/is-typed-array"),a=c("./util/is-ndarray"),l=c("./util/values"),h=c("./constants/primitives.json"),b=c("./constants/usage.json");m.exports=function(f,c,z,m){function y(a){this.id=w++;K[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function C(b,g,f,h,e,l,u){(l=u)||k(g)&&(!a(g)||k(g.data))||(l=c.oes_element_index_uint?5125:5123);b.buffer.bind();
z._initBuffer(b.buffer,g,f,l,3);g=u;if(!u){switch(b.buffer.dtype){case 5121:case 5120:g=5121;break;case 5123:case 5122:g=5123;break;case 5125:case 5124:g=5125}b.buffer.dtype=g}b.type=g;0>e&&(e=b.buffer.byteLength,5123===g?e>>=1:5125===g&&(e>>=2));b.vertCount=e;e=h;0>h&&(e=4,h=b.buffer.dimension,1===h&&(e=0),2===h&&(e=1),3===h&&(e=4));b.primType=e}function J(a){m.elementsCount--;delete K[a.id];a.buffer.destroy();a.buffer=null}var K={},w=0,u={uint8:5121,uint16:5123};c.oes_element_index_uint&&(u.uint32=
5125);y.prototype.bind=function(){this.buffer.bind()};var B=[];return{create:function(c){function g(e){if(e)if("number"===typeof e)l(e),q.primType=4,q.vertCount=e|0,q.type=5121;else{var c=null,t=35044,w=-1,z=-1,m=0,v=0;Array.isArray(e)||k(e)||a(e)?c=e:("data"in e&&(c=e.data),"usage"in e&&(t=b[e.usage]),"primitive"in e&&(w=h[e.primitive]),"count"in e&&(z=e.count|0),"length"in e&&(m=e.length|0),"type"in e&&(v=u[e.type]));c?C(q,c,t,w,z,m,v):(e=q.buffer,e.bind(),f.bufferData(34963,m,t),e.dtype=v||5121,
e.usage=t,e.dimension=3,e.byteLength=m,q.primType=0>w?4:w,q.vertCount=0>z?0:z,q.type=e.dtype)}else l(),q.primType=4,q.vertCount=0,q.type=5121;return g}var l=z.create(null,34963,!0),q=new y(l._buffer);m.elementsCount++;g(c);g._reglType="elements";g._elements=q;g.subdata=function(a,b){l.subdata(a,b);return g};g.destroy=function(){J(q)};return g},createStream:function(a){var b=B.pop();b||(b=new y(z.create(null,34963,!0)._buffer));C(b,a,35040,-1,-1,0,0);return b},destroyStream:function(a){B.push(a)},
getElements:function(a){return"function"===typeof a&&a._elements instanceof y?a._elements:null},clear:function(){l(K).forEach(J)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(c,m,r){m.exports=function(c){function a(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb ext_disjoint_timer_query angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(a){try{l[a]=
c.getExtension(a)}catch(b){}})}var l={};a();return{extensions:l,refresh:a}}},{}],12:[function(c,m,r){var k=c("./util/values"),a=c("./util/extend");m.exports=function(c,h,b,f,q,z){function m(a,b,e){this.target=a;this.texture=b;this.renderbuffer=e;var g=a=0;b?(a=b.width,g=b.height):e&&(a=e.width,g=e.height);this.width=a;this.height=g}function y(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function C(a,b,e){a&&(a.texture?a.texture._texture.refCount+=
1:a.renderbuffer._renderbuffer.refCount+=1)}function J(a,b){b?b.texture?c.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,0):c.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):c.framebufferTexture2D(36160,a,3553,null,0)}function K(a){var b=3553,e=null,g=null,f=a;"object"===typeof a&&(f=a.data);a=f._reglType;"texture2d"===a?e=f:"textureCube"===a?e=f:"renderbuffer"===a&&(g=f,b=36161);return new m(b,e,g)}function w(a,b,e,g,h){if(e)return a=f.create2D({width:a,
height:b,format:g,type:h}),a._texture.refCount=0,new m(3553,a,null);a=q.create({width:a,height:b,format:g});a._renderbuffer.refCount=0;return new m(36161,null,a)}function u(a){return a&&(a.texture||a.renderbuffer)}function B(a,b,e){a&&(a.texture?a.texture.resize(b,e):a.renderbuffer&&a.renderbuffer.resize(b,e))}function t(){this.id=P++;ga[this.id]=this;this.framebuffer=c.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=
null}function g(a){a.colorAttachments.forEach(y);y(a.depthAttachment);y(a.stencilAttachment);y(a.depthStencilAttachment)}function O(a){c.deleteFramebuffer(a.framebuffer);a.framebuffer=null;z.framebufferCount--;delete ga[a.id]}function x(a){var g;c.bindFramebuffer(36160,a.framebuffer);var f=a.colorAttachments;for(g=0;g<f.length;++g)J(36064+g,f[g]);for(g=f.length;g<b.maxColorAttachments;++g)J(36064+g,null);J(36096,a.depthAttachment);J(36128,a.stencilAttachment);J(33306,a.depthStencilAttachment);c.checkFramebufferStatus(36160);
c.bindFramebuffer(36160,e.next);e.current=e.next}var e={current:null,next:null,dirty:!1},r=["rgba"],N=["rgba4","rgb565","rgb5 a1"];h.ext_srgb&&N.push("srgba");h.ext_color_buffer_half_float&&N.push("rgba16f","rgb16f");h.webgl_color_buffer_float&&N.push("rgba32f");var R=["uint8"];h.oes_texture_half_float&&R.push("half float");h.oes_texture_float&&R.push("float");var P=0,ga={};return a(e,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof
t)?a:null},create:function(a,b){function e(a,b){var c,k=0,l=0,t=!0,q=!0;c=null;var z=!0,m="rgba",v="uint8",J=1,B=null,y=null,M=null,O=!1;if("number"===typeof a)k=a|0,l=b|0||k;else if(a){"shape"in a?(l=a.shape,k=l[0],l=l[1]):("radius"in a&&(k=l=a.radius),"width"in a&&(k=a.width),"height"in a&&(l=a.height));if("color"in a||"colors"in a)c=a.color||a.colors,Array.isArray(c);c||("colorCount"in a&&(J=a.colorCount|0),"colorTexture"in a&&(z=!!a.colorTexture,m="rgba4"),"colorType"in a&&(v=a.colorType,z||("half float"===
v?h.ext_color_buffer_half_float&&(m="rgba16f"):"float"===v&&h.webgl_color_buffer_float&&(m="rgba32f"))),"colorFormat"in a&&(m=a.colorFormat,0<=r.indexOf(m)?z=!0:0<=N.indexOf(m)&&(z=!1)));if("depthTexture"in a||"depthStencilTexture"in a)O=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?t=a.depth:(B=a.depth,q=!1));"stencil"in a&&("boolean"===typeof a.stencil?q=a.stencil:(y=a.stencil,t=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?t=q=a.depthStencil:
(M=a.depthStencil,q=t=!1))}else k=l=1;var D=null,P=null,R=null,ba=null;if(Array.isArray(c))D=c.map(K);else if(c)D=[K(c)];else for(D=Array(J),c=0;c<J;++c)D[c]=w(k,l,z,m,v);k=k||D[0].width;l=l||D[0].height;B?P=K(B):t&&!q&&(P=w(k,l,O,"depth","uint32"));y?R=K(y):q&&!t&&(R=w(k,l,!1,"stencil","uint8"));M?ba=K(M):!B&&!y&&q&&t&&(ba=w(k,l,O,"depth stencil","depth stencil"));for(c=0;c<D.length;++c)C(D[c],k,l);C(P,k,l);C(R,k,l);C(ba,k,l);g(f);f.width=k;f.height=l;f.colorAttachments=D;f.depthAttachment=P;f.stencilAttachment=
R;f.depthStencilAttachment=ba;e.color=D.map(u);e.depth=u(P);e.stencil=u(R);e.depthStencil=u(ba);e.width=f.width;e.height=f.height;x(f);return e}var f=new t;z.framebufferCount++;e(a,b);e.resize=function(a,b){var g=a|0,c=b|0||g;if(g===f.width&&c===f.height)return e;for(var h=f.colorAttachments,k=0;k<h.length;++k)B(h[k],g,c);B(f.depthAttachment,g,c);B(f.stencilAttachment,g,c);B(f.depthStencilAttachment,g,c);f.width=e.width=g;f.height=e.height=c;x(f);return e};e._reglType="framebuffer";e._framebuffer=
f;e.destroy=function(){O(f);g(f)};return e},clear:function(){k(ga).forEach(O)}})}},{"./util/extend":23,"./util/values":31}],13:[function(c,m,r){m.exports=function(c,a){var l=1;a.ext_texture_filter_anisotropic&&(l=c.getParameter(34047));var h=1,b=1;a.webgl_draw_buffers&&(h=c.getParameter(34852),b=c.getParameter(36063));return{colorBits:[c.getParameter(3410),c.getParameter(3411),c.getParameter(3412),c.getParameter(3413)],depthBits:c.getParameter(3414),stencilBits:c.getParameter(3415),subpixelBits:c.getParameter(3408),
extensions:Object.keys(a).filter(function(b){return!!a[b]}),maxAnisotropic:l,maxDrawbuffers:h,maxColorAttachments:b,pointSizeDims:c.getParameter(33901),lineWidthDims:c.getParameter(33902),maxViewportDims:c.getParameter(3386),maxCombinedTextureUnits:c.getParameter(35661),maxCubeMapSize:c.getParameter(34076),maxRenderbufferSize:c.getParameter(34024),maxTextureUnits:c.getParameter(34930),maxTextureSize:c.getParameter(3379),maxAttributes:c.getParameter(34921),maxVertexUniforms:c.getParameter(36347),maxVertexTextureUnits:c.getParameter(35660),
maxVaryingVectors:c.getParameter(36348),maxFragmentUniforms:c.getParameter(36349),glsl:c.getParameter(35724),renderer:c.getParameter(7937),vendor:c.getParameter(7936),version:c.getParameter(7938)}}},{}],14:[function(c,m,r){var k=c("./util/is-typed-array");m.exports=function(a,c,h){return function(b){var f=0,q=0,z=h.framebufferWidth,m=h.framebufferHeight,y=null;k(b)?y=b:2===arguments.length?(z=arguments[0]|0,m=arguments[1]|0):b&&(f=b.x|0,q=b.y|0,z=b.width||h.framebufferWidth,m=b.height||h.framebufferHeight,
y=b.data||null);c();y=y||new Uint8Array(z*m*4);a.pixelStorei(3333,4);a.readPixels(f,q,z,m,6408,5121,y);return y}}},{"./util/is-typed-array":26}],15:[function(c,m,r){var k=c("./util/values");m.exports=function(a,c,h,b){function f(a){this.id=r++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0}function q(f){var c=f.renderbuffer;a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(c);f.renderbuffer=null;f.refCount=0;delete y[f.id];b.renderbufferCount--}var m={rgba4:32854,
rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};c.ext_srgb&&(m.srgba=35907);c.ext_color_buffer_half_float&&(m.rgba16f=34842,m.rgb16f=34843);c.webgl_color_buffer_float&&(m.rgba32f=34836);var r=0,y={};f.prototype.decRef=function(){0>=--this.refCount&&q(this)};return{create:function(c,h){function l(b,f){var c=0,g=0,h=32854;"object"===typeof b&&b?("shape"in b?(g=b.shape,c=g[0]|0,g=g[1]|0):("radius"in b&&(c=g=b.radius|0),"width"in b&&(c=b.width|0),"height"in b&&(g=b.height|
0)),"format"in b&&(h=m[b.format])):"number"===typeof b?(c=b|0,g="number"===typeof f?f|0:c):b||(c=g=1);if(c!==k.width||g!==k.height||h!==k.format)return l.width=k.width=c,l.height=k.height=g,k.format=h,a.bindRenderbuffer(36161,k.renderbuffer),a.renderbufferStorage(36161,h,c,g),l}var k=new f(a.createRenderbuffer());y[k.id]=k;b.renderbufferCount++;l(c,h);l.resize=function(b,f){var c=b|0,g=f|0||c;if(c===k.width&&g===k.height)return l;l.width=k.width=c;l.height=k.height=g;a.bindRenderbuffer(36161,k.renderbuffer);
a.renderbufferStorage(36161,k.format,c,g);return l};l._reglType="renderbuffer";l._renderbuffer=k;l.destroy=function(){k.decRef()};return l},clear:function(){k(y).forEach(q)}}}},{"./util/values":31}],16:[function(c,m,r){var k=c("./util/values");m.exports=function(a,c,h){function b(a,b,f,c){this.name=a;this.id=b;this.location=f;this.info=c}function f(a,b){for(var f=0;f<a.length;++f)if(a[f].id===b.id){a[f].location=b.location;return}a.push(b)}function q(b,f,h){h=35632===b?r:y;var k=h[f];if(!k){var g=
c.str(f),k=a.createShader(b);a.shaderSource(k,g);a.compileShader(k);h[f]=k}return k}function m(a,b){this.id=K++;this.fragId=a;this.vertId=b;this.program=null;this.uniforms=[];this.attributes=[]}var r={},y={},C={},J=[],K=0;return{clear:function(){var b=a.deleteShader.bind(a);k(r).forEach(b);r={};k(y).forEach(b);y={};J.forEach(function(b){a.deleteProgram(b.program)});J.length=0;C={};h.shaderCount=0},program:function(k,u,y){h.shaderCount++;(y=C[u])||(y=C[u]={});var t=y[k];if(!t){var g=t=new m(u,k),r,
x;r=q(35632,g.fragId);x=q(35633,g.vertId);u=g.program=a.createProgram();a.attachShader(u,r);a.attachShader(u,x);a.linkProgram(u);var e=a.getProgramParameter(u,35718),K=g.uniforms;for(r=0;r<e;++r)if(x=a.getActiveUniform(u,r))if(1<x.size)for(var N=0;N<x.size;++N){var M=x.name.replace("[0]","["+N+"]");f(K,new b(M,c.id(M),a.getUniformLocation(u,M),x))}else f(K,new b(x.name,c.id(x.name),a.getUniformLocation(u,x.name),x));e=a.getProgramParameter(u,35721);g=g.attributes;for(r=0;r<e;++r)(x=a.getActiveAttrib(u,
r))&&f(g,new b(x.name,c.id(x.name),a.getAttribLocation(u,x.name),x));y[k]=t;J.push(t)}return t},shader:q,frag:null,vert:null}}},{"./util/values":31}],17:[function(c,m,r){m.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(c,m,r){m.exports=function(){var c={"":0},a=[""];return{id:function(l){var h=c[l];if(h)return h;h=c[l]=a.length;a.push(l);return h},str:function(c){return a[c]}}}},{}],19:[function(c,
m,r){function k(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function a(a){return Array.isArray(a)&&0!==a.length&&J(a[0])?!0:!1}function l(a){return Object.prototype.toString.call(a)}function h(b){if(!b)return!1;var f=l(b);return 0<=t.indexOf(f)?!0:k(b)||a(b)||M(b)}function b(a,b){36193===a.type?(a.data=C(b),y.freeType(b)):a.data=b}var f=c("./util/extend"),q=c("./util/values"),z=c("./util/is-typed-array"),M=c("./util/is-ndarray"),y=c("./util/pool"),C=c("./util/to-half-float"),
J=c("./util/is-array-like");r=c("./constants/arraytypes.json");var K=c("./constants/arraytypes.json"),w=[9984,9986,9985,9987],u=[0,6409,6410,6407,6408],B={};B[6409]=B[6406]=B[6402]=1;B[34041]=B[6410]=2;B[6407]=3;B[6408]=4;var t=Object.keys(r).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);m.exports=function(g,c,m,e,t,r){function R(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=
this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function P(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function ga(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha);"flipY"in b&&(a.flipY=
b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=Ba[b.colorSpace]);"type"in b&&(a.type=ja[b.type]);var e=a.width,f=a.height,g=a.channels,c=!1;"shape"in b?(e=b.shape[0],f=b.shape[1],3===b.shape.length&&(g=b.shape[2],c=!0)):("radius"in b&&(e=f=b.radius),"width"in b&&(e=b.width),"height"in b&&(f=b.height),"channels"in b&&(g=b.channels,c=!0));a.width=e|0;a.height=f|0;a.channels=g|0;e=!1;"format"in b&&(e=b.format,f=a.internalformat=ca[e],a.format=Ca[f],e in ja&&
!("type"in b)&&(a.type=ja[e]),e in da&&(a.compressed=!0),e=!0);!c&&e?a.channels=B[a.format]:c&&!e&&a.channels!==u[a.format]&&(a.format=a.internalformat=u[a.channels])}}function v(a){g.pixelStorei(37440,a.flipY);g.pixelStorei(37441,a.premultiplyAlpha);g.pixelStorei(37443,a.colorSpace);g.pixelStorei(3317,a.unpackAlignment)}function D(){R.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function Q(d,e){var f=null;h(e)?f=e:e&&(ga(d,e),"x"in e&&
(d.xOffset=e.x|0),"y"in e&&(d.yOffset=e.y|0),h(e.data)&&(f=e.data));if(e.copy){var g=t.viewportWidth,c=t.viewportHeight;d.width=d.width||g-d.xOffset;d.height=d.height||c-d.yOffset;d.needsCopy=!0}else if(!f)d.width=d.width||1,d.height=d.height||1;else if(z(f))d.data=f,"type"in e||5121!==d.type||(d.type=K[Object.prototype.toString.call(f)]|0);else if(k(f)){g=f;c=d.width*d.height*d.channels;switch(d.type){case 5121:case 5123:case 5125:case 5126:c=y.allocType(d.type,c);c.set(g);d.data=c;break;case 36193:d.data=
C(g)}d.alignment=1;d.needsFree=!0}else if(M(f)){g=f.data;Array.isArray(g)||5121!==d.type||(d.type=K[Object.prototype.toString.call(g)]|0);var c=f.shape,q=f.stride,m,v,x,w;3===c.length?(x=c[2],w=q[2]):w=x=1;m=c[0];v=c[1];c=q[0];q=q[1];d.alignment=1;d.width=m;d.height=v;d.channels=x;d.format=d.internalformat=u[x];d.needsFree=!0;m=w;f=f.offset;x=d.width;w=d.height;v=d.channels;for(var n=y.allocType(36193===d.type?5126:d.type,x*w*v),r=0,B=0;B<w;++B)for(var N=0;N<x;++N)for(var D=0;D<v;++D)n[r++]=g[c*N+
q*B+m*D+f];b(d,n)}else if("[object HTMLCanvasElement]"===l(f)||"[object CanvasRenderingContext2D]"===l(f))"[object HTMLCanvasElement]"===l(f)?d.element=f:d.element=f.canvas,d.width=d.element.width,d.height=d.element.height;else if("[object HTMLImageElement]"===l(f))d.element=f,d.width=f.naturalWidth,d.height=f.naturalHeight;else if("[object HTMLVideoElement]"===l(f))d.element=f,d.width=f.videoWidth,d.height=f.videoHeight,d.needsPoll=!0;else if(a(f)){g=f[0].length;c=f.length;q=1;if(J(f[0][0])){m=q=
f[0][0].length;x=y.allocType(36193===d.type?5126:d.type,g*c*m);for(v=w=0;v<c;++v)for(n=f[v],r=0;r<g;++r)for(B=n[r],N=0;N<m;++N)x[w++]=B[N];b(d,x)}else{m=y.allocType(36193===d.type?5126:d.type,g*c);for(w=x=0;w<c;++w)for(v=f[w],n=0;n<g;++n)m[x++]=v[n];b(d,m)}d.alignment=1;d.width=g;d.height=c;d.channels=q;d.format=d.internalformat=u[q];d.needsFree=!0}}function Y(a,b,f,c,h){var k=a.element,l=a.data,q=a.internalformat,m=a.format,t=a.type,n=a.width,u=a.height;v(a);k?g.texSubImage2D(b,h,f,c,m,t,k):a.compressed?
g.compressedTexSubImage2D(b,h,f,c,q,n,u,l):a.needsCopy?(e(),g.copyTexSubImage2D(b,h,f,c,a.xOffset,a.yOffset,n,u)):g.texSubImage2D(b,h,f,c,n,u,m,t,l)}function I(){return Da.pop()||new D}function ea(a){a.needsFree&&y.freeType(a.data);D.call(a);Da.push(a)}function ka(){R.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function S(a,b,e){var f=a.images[0]=I();a.mipmask=1;f.width=a.width=b;f.height=a.height=e}function L(a,b){var e=null;if(h(b))e=a.images[0]=I(),P(e,
a),Q(e,b),a.mipmask=1;else if(ga(a,b),Array.isArray(b.mipmap))for(var f=b.mipmap,c=0;c<f.length;++c)e=a.images[c]=I(),P(e,a),e.width>>=c,e.height>>=c,Q(e,f[c]),a.mipmask|=1<<c;else e=a.images[0]=I(),P(e,a),Q(e,b),a.mipmask=1;P(a,a.images[0])}function F(a,b){for(var f=a.images,c=0;c<f.length&&f[c];++c){var h=f[c],k=b,l=c,q=h.element,m=h.data,t=h.internalformat,n=h.format,u=h.type,x=h.width,z=h.height;v(h);q?g.texImage2D(k,l,n,n,u,q):h.compressed?g.compressedTexImage2D(k,l,t,x,z,0,m):h.needsCopy?(e(),
g.copyTexImage2D(k,l,n,h.xOffset,h.yOffset,x,z,0)):g.texImage2D(k,l,n,x,z,0,n,u,m)}}function V(){var a=Ea.pop()||new ka;R.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function ha(a){for(var b=a.images,e=0;e<b.length;++e)b[e]&&ea(b[e]),b[e]=null;Ea.push(a)}function pa(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function sa(a,b){"min"in b&&(a.minFilter=ta[b.min],0<=w.indexOf(a.minFilter)&&(a.genMipmaps=
!0));"mag"in b&&(a.magFilter=ba[b.mag]);var e=a.wrapS,f=a.wrapT;if("wrap"in b){var c=b.wrap;"string"===typeof c?e=f=U[c]:Array.isArray(c)&&(e=U[c[0]],f=U[c[1]])}else"wrapS"in b&&(e=U[b.wrapS]),"wrapT"in b&&(f=U[b.wrapT]);a.wrapS=e;a.wrapT=f;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){e=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=T[b.mipmap];e=a.genMipmaps=!0;break;case "boolean":e=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,e=!0}!e||"min"in b||(a.minFilter=
9984)}}function ia(a,b){g.texParameteri(b,10241,a.minFilter);g.texParameteri(b,10240,a.magFilter);g.texParameteri(b,10242,a.wrapS);g.texParameteri(b,10243,a.wrapT);c.ext_texture_filter_anisotropic&&g.texParameteri(b,34046,a.anisotropic);a.genMipmaps&&(g.hint(33170,a.mipmapHint),g.generateMipmap(b))}function qa(){var a=ua.pop()||new pa;pa.call(a);return a}function ma(a){R.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ga++;this.refCount=1;this.target=a;this.texture=g.createTexture();this.unit=
-1;this.bindCount=0}function W(a){g.activeTexture(33984);g.bindTexture(a.target,a.texture)}function fa(){var a=aa[0];a?g.bindTexture(a.target,a.texture):g.bindTexture(3553,null)}function X(a){var b=a.texture,e=a.unit,f=a.target;0<=e&&(g.activeTexture(33984+e),g.bindTexture(f,null),aa[e]=null);g.deleteTexture(b);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete wa[a.id];r.textureCount--}var T={"don't care":4352,"dont care":4352,nice:4354,fast:4353},U={repeat:10497,clamp:33071,mirror:33648},
ba={nearest:9728,linear:9729},ta=f({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ba),Ba={none:0,browser:37444},ja={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ca={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},da={};c.ext_srgb&&(ca.srgb=35904,ca.srgba=35906);c.oes_texture_float&&(ja["float"]=5126);c.oes_texture_half_float&&(ja.float16=ja["half float"]=
36193);c.webgl_depth_texture&&(f(ca,{depth:6402,"depth stencil":34041}),f(ja,{uint16:5123,uint32:5125,"depth stencil":34042}));c.webgl_compressed_texture_s3tc&&f(da,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});c.webgl_compressed_texture_atc&&f(da,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});c.webgl_compressed_texture_pvrtc&&f(da,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
c.webgl_compressed_texture_etc1&&(da["rgb etc1"]=36196);var ya=Array.prototype.slice.call(g.getParameter(34467));Object.keys(da).forEach(function(a){var b=da[a];0<=ya.indexOf(b)&&(ca[a]=b)});var va=Object.keys(ca);m.textureFormats=va;var Ca=va.reduce(function(a,b){var e=ca[b];6409===e||6406===e||6409===e||6410===e||6402===e||34041===e?a[e]=e:32855===e||0<=b.indexOf("rgba")?a[e]=6408:a[e]=6407;return a},{}),Da=[],Ea=[],ua=[],Ga=0,wa={},la=m.maxTextureUnits,aa=Array(la).map(function(){return null});
f(ma.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<la;++b){var e=aa[b];if(e){if(0<e.bindCount)continue;e.unit=-1}aa[b]=this;a=b;break}this.unit=a;g.activeTexture(33984+a);g.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&X(this)}});return{create2D:function(a,b){function e(a,b){var d=qa(),c=V();"number"===typeof a?"number"===typeof b?S(c,a|0,b|0):S(c,a|0,a|0):a?(sa(d,a),L(c,a)):S(c,1,1);d.genMipmaps&&
(c.mipmask=(c.width<<1)-1);f.mipmask=c.mipmask;P(f,c);f.internalformat=c.internalformat;e.width=c.width;e.height=c.height;W(f);F(c,3553);ia(d,3553);fa();ua.push(d);ha(c);return e}var f=new ma(3553);wa[f.id]=f;r.textureCount++;e(a,b);e.subimage=function(a,b,d,c){b|=0;d|=0;c|=0;var g=I();P(g,f);g.width>>=c;g.height>>=c;g.width-=b;g.height-=d;Q(g,a);W(f);Y(g,3553,b,d,c);fa();ea(g);return e};e.resize=function(a,b){var d=a|0,c=b|0||d;if(d===f.width&&c===f.height)return e;e.width=f.width=d;e.height=f.height=
c;W(f);g.texImage2D(3553,0,f.format,d,c,0,f.format,f.type,null);fa();return e};e._reglType="texture2d";e._texture=f;e.destroy=function(){f.decRef()};return e},createCube:function(a,b,e,f,c,h){function k(a,b,e,d,f,c){var g,h=qa();for(g=0;6>g;++g)q[g]=V();if("number"===typeof a||!a)for(a=a|0||1,g=0;6>g;++g)S(q[g],a,a);else if("object"===typeof a)if(b)L(q[0],a),L(q[1],b),L(q[2],e),L(q[3],d),L(q[4],f),L(q[5],c);else if(sa(h,a),ga(l,a),"faces"in a)for(a=a.faces,g=0;6>g;++g)P(q[g],l),L(q[g],a[g]);else for(g=
0;6>g;++g)L(q[g],a);P(l,q[0]);l.mipmask=h.genMipmaps?(q[0].width<<1)-1:q[0].mipmask;l.internalformat=q[0].internalformat;k.width=q[0].width;k.height=q[0].height;W(l);for(g=0;6>g;++g)F(q[g],34069+g);ia(h,34067);fa();ua.push(h);for(g=0;6>g;++g)ha(q[g]);return k}var l=new ma(34067);wa[l.id]=l;r.cubeCount++;var q=Array(6);k(a,b,e,f,c,h);k.subimage=function(a,b,e,d,f){e|=0;d|=0;f|=0;var c=I();P(c,l);c.width>>=f;c.height>>=f;c.width-=e;c.height-=d;Q(c,b);W(l);Y(c,34069+a,e,d,f);fa();ea(c);return k};k.resize=
function(a,b){var e=a|0,d=b|0||e;if(e===l.width&&d===l.height)return k;k.width=l.width=e;k.height=l.height=d;W(l);for(var f=0;6>f;++f)g.texImage2D(34069+f,0,l.format,e,d,0,l.format,l.type,null);fa();return k};k._reglType="textureCube";k._texture=l;k.destroy=function(){l.decRef()};return k},clear:function(){for(var a=0;a<la;++a)g.activeTexture(33984+a),g.bindTexture(3553,null),aa[a]=null;q(wa).forEach(X);r.cubeCount=0;r.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,
"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(c,m,r){m.exports=function(c,a){function l(){this.endQueryIndex=this.startQueryIndex=-1;this.stats=null}var h=a.ext_disjoint_timer_query;if(!h)return null;var b=[],f=[],q,m,r=[],y=[];return{beginQuery:function(a){q=a;m=r.pop()||h.createQueryEXT();h.beginQueryEXT(h.TIME_ELAPSED_EXT,m)},endQuery:function(){h.endQueryEXT(h.TIME_ELAPSED_EXT);
var a=y.pop()||new l;a.startQueryIndex=b.length;a.endQueryIndex=a.startQueryIndex;a.stats=q;f.push(a);b.push(m)},update:function(){if(0!==b.length){var a=[],c,k;for(c=0;c<b.length;c++)a[c]=1E-6*h.getQueryObjectEXT(b[c],h.QUERY_RESULT_EXT),r.push(b[c]);b=[];for(c=0;c<f.length;c++){var l=f[c];for(k=l.startQueryIndex;k<=l.endQueryIndex;k++)l.stats.gpuTime+=a[k];y.push(l)}f=[]}},getNumPendingQueries:function(){return b.length},pushScopeStats:function(a,b,c){var h=y.pop()||new l;h.startQueryIndex=a;h.endQueryIndex=
b;h.stats=c;f.push(h)},clear:function(){for(var a=0;a<r.length;a++)h.deleteQueryEXT(r[a])}}}},{}],21:[function(c,m,r){m.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(c,m,r){function k(a){return Array.prototype.slice.call(a)}function a(a){return k(a).join("")}var l=c("./extend");m.exports=function(){function c(){var b=[],h=[];return l(function(){b.push.apply(b,k(arguments))},{def:function(){var a="v"+f++;
h.push(a);0<arguments.length&&(b.push(a,"="),b.push.apply(b,k(arguments)),b.push(";"));return a},toString:function(){return a([0<h.length?"var "+h+";":"",a(b)])}})}function b(){function a(c,h){f(c,h,"=",b.def(c,h),";")}var b=c(),f=c(),k=b.toString,q=f.toString;return l(b,{entry:b,exit:f,save:a,set:function(c,f,g){a(c,f);b(c,f,"=",g,";")},toString:function(){return k()+q()}})}var f=0,q=[],m=[],r=c(),y={};return{global:r,link:function(a){for(var b=0;b<m.length;++b)if(m[b]===a)return q[b];b="g"+f++;
q.push(b);m.push(a);return b},block:c,proc:function(c,f){function h(){var a="a"+k.length;k.push(a);return a}var k=[];f=f||0;for(var q=0;q<f;++q)h();var q=b(),m=q.toString;return y[c]=l(q,{arg:h,toString:function(){return a(["function(",k.join(),"){",m(),"}"])}})},scope:b,cond:function(){var f=a(arguments),c=b(),h=b(),q=c.toString,m=h.toString;return l(c,{then:function(){c.apply(c,k(arguments));return this},"else":function(){h.apply(h,k(arguments));return this},toString:function(){var b=m();b&&(b=
"else{"+b+"}");return a(["if(",f,"){",q(),"}",b])}})},compile:function(){var b=['"use strict";',r,"return {"];Object.keys(y).forEach(function(a){b.push('"',a,'":',y[a].toString(),",")});b.push("}");var c=a(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,q.concat(c)).apply(null,m)}}}},{"./extend":23}],23:[function(c,m,r){m.exports=function(c,a){for(var l=Object.keys(a),h=0;h<l.length;++h)c[l[h]]=a[l[h]];return c}},{}],24:[function(c,m,r){var k=c("./is-typed-array");
m.exports=function(a){return Array.isArray(a)||k(a)}},{"./is-typed-array":26}],25:[function(c,m,r){var k=c("./is-typed-array");m.exports=function(a){return!!a&&"object"===typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"===typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||k(a.data))}},{"./is-typed-array":26}],26:[function(c,m,r){var k=c("../constants/arraytypes.json");m.exports=function(a){return Object.prototype.toString.call(a)in k}},{"../constants/arraytypes.json":4}],
27:[function(c,m,r){m.exports=function(c,a){for(var l=Array(c),h=0;h<c;++h)l[h]=a(h);return l}},{}],28:[function(c,m,r){function k(a){var c,h;c=(65535<a)<<4;a>>>=c;h=(255<a)<<3;a>>>=h;c|=h;h=(15<a)<<2;a>>>=h;c|=h;h=(3<a)<<1;return c|h|a>>>h>>1}function a(a){a:{for(var c=16;268435456>=c;c*=16)if(a<=c){a=c;break a}a=0}c=h[k(a)>>2];return 0<c.length?c.pop():new ArrayBuffer(a)}function l(a){h[k(a.byteLength)>>2].push(a)}var h=c("./loop")(8,function(){return[]});m.exports={alloc:a,free:l,allocType:function(b,
c){var h=null;switch(b){case 5120:h=new Int8Array(a(c),0,c);break;case 5121:h=new Uint8Array(a(c),0,c);break;case 5122:h=new Int16Array(a(2*c),0,c);break;case 5123:h=new Uint16Array(a(2*c),0,c);break;case 5124:h=new Int32Array(a(4*c),0,c);break;case 5125:h=new Uint32Array(a(4*c),0,c);break;case 5126:h=new Float32Array(a(4*c),0,c);break;default:return null}return h.length!==c?h.subarray(0,c):h},freeType:function(a){l(a.buffer)}}},{"./loop":27}],29:[function(c,m,r){m.exports="function"===typeof requestAnimationFrame&&
"function"===typeof cancelAnimationFrame?{next:function(c){return requestAnimationFrame(c)},cancel:function(c){return cancelAnimationFrame(c)}}:{next:function(c){setTimeout(c,30)},cancel:clearTimeout}},{}],30:[function(c,m,r){var k=c("./pool"),a=new Float32Array(1),l=new Uint32Array(a.buffer);m.exports=function(c){for(var b=k.allocType(5123,c.length),f=0;f<c.length;++f)if(isNaN(c[f]))b[f]=65535;else if(Infinity===c[f])b[f]=31744;else if(-Infinity===c[f])b[f]=64512;else{a[0]=c[f];var m=l[0],z=m>>>
31<<15,r=(m<<1>>>24)-127,m=m>>13&1023;b[f]=-24>r?z:-14>r?z+(m+1024>>-14-r):15<r?z+31744:z+(r+15<<10)+m}return b}},{"./pool":28}],31:[function(c,m,r){m.exports=function(c){return Object.keys(c).map(function(a){return c[a]})}},{}],32:[function(c,m,r){function k(c,b){function f(){var a=window.innerWidth,b=window.innerHeight;c!==document.body&&(b=c.getBoundingClientRect(),a=b.right-b.left,b=b.top-b.bottom);k.width=r*a;k.height=r*b;l(k.style,{width:a+"px",height:b+"px"})}var k=document.createElement("canvas"),
m=a(k,b);l(k.style,{border:0,margin:0,padding:0,top:0,left:0});c.appendChild(k);c===document.body&&(k.style.position="absolute",l(c.style,{margin:0,padding:0}));var r=+m.options.pixelRatio;window.addEventListener("resize",f,!1);var y=m.options.onDestroy;m.options=l(l({},m.options),{onDestroy:function(){window.removeEventListener("resize",f);c.removeChild(k);y&&y()}});f();return m}function a(a,b){function c(b){try{return a.getContext(b,k)}catch(f){return null}}var k=b.glOptions||{};return{gl:c("webgl")||
c("experimental-webgl")||c("webgl-experimental"),options:l({pixelRatio:window.devicePixelRatio},b)}}var l=c("./util/extend");m.exports=function(c){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:c[0],options:c[1]||{}};var b=document.body,f=c[1]||{};if("string"===typeof c[0])b=document.querySelector(c[0])||document.body;else if("object"===typeof c[0])if(c[0]instanceof HTMLElement)b=c[0];else{if(c[0]instanceof WebGLRenderingContext)return{gl:c[0],options:l({pixelRatio:1},
f)};f=c[0]}return b.nodeName&&"CANVAS"===b.nodeName.toUpperCase()?a(b,f):k(b,f)}},{"./util/extend":23}],33:[function(c,m,r){m.exports=function(a,c){function h(a){var b=!1;"altKey"in a&&(b=b||a.altKey!==t.alt,t.alt=!!a.altKey);"shiftKey"in a&&(b=b||a.shiftKey!==t.shift,t.shift=!!a.shiftKey);"ctrlKey"in a&&(b=b||a.ctrlKey!==t.control,t.control=!!a.ctrlKey);"metaKey"in a&&(b=b||a.metaKey!==t.meta,t.meta=!!a.metaKey);return b}function b(a,b){var f=k.x(b),g=k.y(b);"buttons"in b&&(a=b.buttons|0);if(a!==
w||f!==u||g!==B||h(b))w=a|0,u=f||0,B=g||0,c&&c(w,u,B,t)}function f(a){b(0,a)}function m(){if(w||u||B||t.shift||t.alt||t.meta||t.control)w=u=B=0,t.shift=t.alt=t.control=t.meta=!1,c&&c(0,0,0,t)}function r(a){h(a)&&c&&c(w,u,B,t)}function M(a){0===k.buttons(a)?b(0,a):b(w,a)}function y(a){b(w|k.buttons(a),a)}function C(a){b(w&~k.buttons(a),a)}function J(){g||(g=!0,a.addEventListener("mousemove",M),a.addEventListener("mousedown",y),a.addEventListener("mouseup",C),a.addEventListener("mouseleave",f),a.addEventListener("mouseenter",
f),a.addEventListener("mouseout",f),a.addEventListener("mouseover",f),a.addEventListener("blur",m),a.addEventListener("keyup",r),a.addEventListener("keydown",r),a.addEventListener("keypress",r),a!==window&&(window.addEventListener("blur",m),window.addEventListener("keyup",r),window.addEventListener("keydown",r),window.addEventListener("keypress",r)))}function K(){g&&(g=!1,a.removeEventListener("mousemove",M),a.removeEventListener("mousedown",y),a.removeEventListener("mouseup",C),a.removeEventListener("mouseleave",
f),a.removeEventListener("mouseenter",f),a.removeEventListener("mouseout",f),a.removeEventListener("mouseover",f),a.removeEventListener("blur",m),a.removeEventListener("keyup",r),a.removeEventListener("keydown",r),a.removeEventListener("keypress",r),a!==window&&(window.removeEventListener("blur",m),window.removeEventListener("keyup",r),window.removeEventListener("keydown",r),window.removeEventListener("keypress",r)))}c||(c=a,a=window);var w=0,u=0,B=0,t={shift:!1,alt:!1,control:!1,meta:!1},g=!1;J();
var O={element:a};Object.defineProperties(O,{enabled:{get:function(){return g},set:function(a){a?J():K},enumerable:!0},buttons:{get:function(){return w},enumerable:!0},x:{get:function(){return u},enumerable:!0},y:{get:function(){return B},enumerable:!0},mods:{get:function(){return t},enumerable:!0}});return O};var k=c("mouse-event")},{"mouse-event":34}],34:[function(c,m,r){function k(a){return a.target||a.srcElement||window}r.buttons=function(a){if("object"===typeof a){if("buttons"in a)return a.buttons;
if("which"in a){a=a.which;if(2===a)return 4;if(3===a)return 2;if(0<a)return 1<<a-1}else if("button"in a){a=a.button;if(1===a)return 4;if(2===a)return 2;if(0<=a)return 1<<a}}return 0};r.element=k;r.x=function(a){if("object"===typeof a){if("offsetX"in a)return a.offsetX;var c=k(a).getBoundingClientRect();return a.clientX-c.left}return 0};r.y=function(a){if("object"===typeof a){if("offsetY"in a)return a.offsetY;var c=k(a).getBoundingClientRect();return a.clientY-c.top}return 0}},{}],35:[function(c,m,
r){function k(a){throw Error("resl: "+a);}function a(a,b,c){Object.keys(a).forEach(function(a){0>b.indexOf(a)&&k('invalid parameter "'+a+'" in '+c)})}function l(a,b){this.state=0;this.ready=!1;this.progress=0;this.name=a;this.cancel=b}var h=["manifest","onDone","onProgress","onError"],b=["type","src","stream","credentials","parser"],f=["onData","onDone"];m.exports=function(c){function m(a,b){if(a in c){var f=c[a];"function"!==typeof f&&k('invalid callback "'+a+'"');return f}return null}function r(a){function b(){if(!(2>
k.readyState||1===q.state||-1===q.state)){if(200!==k.status)return C('error loading resource "'+a.name+'"');if(2<k.readyState&&0===q.state){var f;f="binary"===a.type?k.response:k.responseText;if(h.data)try{m=h.data(f)}catch(g){return C(g)}else m=f}if(3<k.readyState&&0===q.state){if(h.done)try{m=h.done()}catch(g){return C(g)}q.state=1}t[c]=m;q.progress=.75*q.progress+.25;q.ready=a.stream&&!!m||1===q.state;J()}}var c=a.name,f=a.stream,g="binary"===a.type,h=a.parser,k=new XMLHttpRequest,m=null,q=new l(c,
function(){1!==q.state&&-1!==q.state&&(k.onreadystatechange=null,k.abort(),q.state=-1)});k.onreadystatechange=f?b:function(){4===k.readyState&&b()};g&&(k.responseType="arraybuffer");a.credentials&&(k.withCredentials=!0);k.open("GET",a.src,!0);k.send();return q}function y(a,b){function c(){if(0===r.state)if(q.data)try{u=q.data(b)}catch(a){return C(a)}else u=b}function f(b){c();t[m]=u;r.progress=b.lengthComputable?Math.max(r.progress,b.loaded/b.total):.75*r.progress+.25;r.ready=a.stream;J(m)}function g(){c();
if(0===r.state){if(q.done)try{u=q.done()}catch(a){return C(a)}r.state=1}r.progress=1;r.ready=!0;t[m]=u;k();J("finish "+m)}function h(){C('error loading asset "'+m+'"')}function k(){a.stream&&b.removeEventListener("progress",f);"image"===a.type?b.addEventListener("load",g):b.addEventListener("canplay",g);b.removeEventListener("error",h)}var m=a.name,q=a.parser,r=new l(m,function(){1!==r.state&&-1!==r.state&&(r.state=-1,k(),b.src="")}),u=b;a.stream&&b.addEventListener("progress",f);"image"===a.type?
b.addEventListener("load",g):b.addEventListener("canplay",g);b.addEventListener("error",h);b.crossOrigin=a.credentials?"use-credentials":"anonymous";b.src=a.src;return r}function C(a){-1!==g&&1!==g&&(g=-1,x.forEach(function(a){a.cancel()}),B?"string"===typeof a?B(Error("resl: "+a)):B(a):console.error("resl error:",a))}function J(a){if(-1!==g&&1!==g){var b=0,c=0;x.forEach(function(a){a.ready&&(c+=1);b+=a.progress});c===x.length?(g=1,w(t)):u&&u(b/x.length,a)}}"object"===typeof c&&c||k("invalid or missing configuration");
a(c,h,"config");var K=c.manifest;"object"===typeof K&&K||k("missing manifest");var w=m("onDone");w||k("missing onDone() callback");var u=m("onProgress"),B=m("onError"),t={},g=0,O={text:r,binary:function(a){return r(a)},image:function(a){return y(a,document.createElement("img"))},video:function(a){return y(a,document.createElement("video"))},audio:function(a){return y(a,document.createElement("audio"))}},x=Object.keys(K).map(function(c){function g(a,b){if(a in h.parser){var c=h.parser[a];"function"!==
typeof c&&k("invalid parser callback "+a+' for asset "'+a+'"');return c}return b}var h=K[c];"string"===typeof h?h={src:h}:"object"===typeof h&&h||k('invalid asset definition "'+c+'"');a(h,b,'asset "'+c+'"');var l={};"parser"in h&&("function"===typeof h.parser?l={data:h.parser}:"object"===typeof h.parser&&h.parser?(a(l,f,'parser for asset "'+c+'"'),"onData"in l||k('missing onData callback for parser in asset "'+c+'"'),l={data:g("onData"),done:g("onDone")}):k('invalid parser for asset "'+c+'"'));return{name:c,
type:function(a,b,f){a in h&&(f=h[a]);0>b.indexOf(f)&&k("invalid "+a+' "'+f+'" for asset "'+c+'", possible values: '+b);return f}("type",Object.keys(O),"text"),stream:!!h.stream,credentials:!!h.credentials,src:function(a,b,f){a in h?f=h[a]:b&&k("missing "+a+' for asset "'+c+'"');"string"!==typeof f&&k("invalid "+a+' for asset "'+c+'", must be a string');return f}("src",!0,""),parser:l}}).map(function(a){return O[a.type](a)})}},{}],36:[function(c,m,r){var k=c("./lib/util/extend"),a=c("./lib/dynamic"),
l=c("./lib/util/raf"),h=c("./lib/util/clock"),b=c("./lib/strings"),f=c("./lib/webgl"),q=c("./lib/extension"),z=c("./lib/limits"),M=c("./lib/buffer"),y=c("./lib/elements"),C=c("./lib/texture"),J=c("./lib/renderbuffer"),K=c("./lib/framebuffer"),w=c("./lib/attribute"),u=c("./lib/shader"),B=c("./lib/read"),t=c("./lib/core"),g=c("./lib/stats"),O=c("./lib/timer");m.exports=function(){function c(){U=l.next(c);F.tick+=1;F.time=(h()-ka)/1E3;P();for(var a=0;a<T.length;++a)(0,T[a])(F,null,0);D.flush()}function e(a){}
function m(a){}function r(b){function c(b){var e={},f={};Object.keys(b).forEach(function(c){var g=b[c];a.isDynamic(g)?f[c]=a.unbox(g,c):e[c]=g});return{dynamic:f,"static":e}}function e(a){for(;u.length<a;)u.push(null);return u}var f=c(b.context||{}),g=c(b.uniforms||{}),h=c(b.attributes||{}),l=c(function(a){function b(a){if(a in c){var e=c[a];delete c[a];Object.keys(e).forEach(function(b){c[a+"."+b]=e[b]})}}var c=k({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");
b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(b));b={gpuTime:0};var f=W.compile(l,h,g,f,b),m=f.draw,q=f.batch,t=f.scope,u=[];return k(function(a,b){var c;if("function"===typeof a)return t.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<a;++c)t.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)t.call(this,a[c],b,c);else return t.call(this,a,b,0);else if("number"===typeof a){if(0<a)return q.call(this,e(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return q.call(this,
a,a.length)}else return m.call(this,a)},{stats:b})}function R(){var a=fa.viewport,b=fa.scissor_box;a[0]=a[1]=b[0]=b[1]=0;F.viewportWidth=F.framebufferWidth=F.drawingBufferWidth=a[2]=b[2]=D.drawingBufferWidth;F.viewportHeight=F.framebufferHeight=F.drawingBufferHeight=a[3]=b[3]=D.drawingBufferHeight}function P(){R();W.procs.poll()}function ga(){R();W.procs.refresh()}var v=f(Array.prototype.slice.call(arguments)),D=v.gl,Q=v.options,v=b(),Y=g(),I=q(D).extensions,ea=O(D,I),ka=h(),S=D.drawingBufferWidth,
L=D.drawingBufferHeight,F={tick:0,time:0,viewportWidth:S,viewportHeight:L,framebufferWidth:S,framebufferHeight:L,drawingBufferWidth:S,drawingBufferHeight:L,pixelRatio:Q.pixelRatio},V=z(D,I),ha=M(D,Y),pa=y(D,I,ha,Y),S=w(D,I,V,ha,v),sa=u(D,v,Y),ia=C(D,I,V,P,F,Y),qa=J(D,I,V,Y),ma=K(D,I,V,ia,qa,Y),L=B(D,P,F),W=t(D,v,I,V,ha,pa,ia,ma,{},S,sa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},F,ea),fa=W.next,X=D.canvas,T=[],U=0;X&&(X.addEventListener("webglcontextlost",e,!1),X.addEventListener("webglcontextrestored",
m,!1));ga();return k(r,{clear:function(a){var b=0;W.procs.poll();var c=a.color;c&&(D.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in a&&(D.clearDepth(+a.depth),b|=256);"stencil"in a&&(D.clearStencil(a.stencil|0),b|=1024);D.clear(b)},prop:a.define.bind(null,1),context:a.define.bind(null,2),"this":a.define.bind(null,3),draw:r({}),buffer:function(a){return ha.create(a,34962)},elements:pa.create,texture:ia.create2D,cube:ia.createCube,renderbuffer:qa.create,framebuffer:ma.create,framebufferCube:function(a){},
attributes:D.getContextAttributes(),frame:function(a){T.push(a);!U&&0<T.length&&c();return{cancel:function(){var b=T.find(function(b){return b===a});0>b||(T.splice(b,1),0>=T.length&&U&&(l.cancel(c),U=0))}}},limits:V,hasExtension:function(a){return 0<=V.extensions.indexOf(a.toLowerCase())},read:L,destroy:function(){U&&(l.cancel(c),U=0);X&&(X.removeEventListener("webglcontextlost",e),X.removeEventListener("webglcontextrestored",m));sa.clear();ma.clear();qa.clear();ia.clear();pa.clear();ha.clear();ea&&
ea.clear();if(Q.onDestroy)Q.onDestroy()},_gl:D,_refresh:ga,stats:Y,updateTimer:function(){ea&&ea.update()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);
