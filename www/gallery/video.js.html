<!DOCTYPE html>
      <html>
        <head>
          <title>example/video.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(l,q,k){function h(c,b){if(!q[c]){if(!l[c]){var d="function"==typeof require&&require;if(!b&&d)return d(c,!0);if(t)return t(c,!0);d=Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d;}d=q[c]={exports:{}};l[c][0].call(d.exports,function(b){var d=l[c][1][b];return h(d?d:b)},d,d.exports,e$$0,l,q,k)}return q[c].exports}for(var t="function"==typeof require&&require,d=0;d<k.length;d++)h(k[d]);return h})({1:[function(e,l,q){var k=e("../regl")(),h=k({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 screenShape;\n  uniform float time;\n\n  varying vec2 uv;\n\n  vec4 background () {\n    vec2 pos = 0.5 - gl_FragCoord.xy / screenShape;\n    float r = length(pos);\n    float theta = atan(pos.y, pos.x);\n    return vec4(\n      cos(pos.x * time) + sin(pos.y * pos.x * time),\n      cos(100.0 * r * cos(0.3 * time) + theta),\n      sin(time / r + pos.x * cos(10.0 * time + 3.0)),\n      1);\n  }\n\n  void main () {\n    vec4 color = texture2D(texture, uv);\n    float chromakey = step(0.15 + max(color.r, color.b), color.g);\n    gl_FragColor = mix(color, background(), chromakey);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n  }",attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:k.prop("video"),screenShape:function(k){return[k.viewportWidth,k.viewportHeight]},time:k.context("time")},count:3});e("resl")({manifest:{video:{type:"video",src:"assets/doggie-chromakey.ogv",stream:!0}},onDone:function(t){var d=t.video;d.autoplay=!0;d.loop=!0;d.play();
var c=k.texture(d);k.frame(function(){h({video:c.subimage(d)})})}})},{"../regl":34,resl:33}],2:[function(e,l,q){function k(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}l.exports=function(h,t,d,c,b){h=d.maxAttributes;t=Array(h);for(d=0;d<h;++d)t[d]=new k;return{Record:k,scope:{},state:t}}},{}],3:[function(e,l,q){function k(c){return O[Object.prototype.toString.call(c)]|0}function h(c,b){for(var d=0;d<
b.length;++d)c[d]=b[d]}function t(c,b,d,k,h,t,a){for(var e=0,m=0;m<d;++m)for(var g=0;g<k;++g)c[e++]=b[h*m+t*g+a]}function d(c,b,d){for(var k=0,h=0;h<b.length;++h)for(var t=b[h],a=0;a<d;++a)c[k++]=t[a]}var c=e("./util/is-typed-array"),b=e("./util/is-ndarray"),m=e("./util/values"),F=e("./util/pool"),O=e("./constants/arraytypes.json"),w=e("./constants/dtypes.json"),u=e("./constants/usage.json");l.exports=function(e,l){function L(g){this.id=a++;this.buffer=e.createBuffer();this.type=g;this.usage=35044;
this.byteLength=0;this.dimension=1;this.dtype=5121}function B(g,c,b){g.byteLength=c.byteLength;e.bufferData(g.type,c,b)}function J(g,a,e,r,m){g.usage=e;if(Array.isArray(a))g.dtype=r||5126,0<a.length&&(Array.isArray(a[0])?(g.dimension=a[0].length,r=F.allocType(g.dtype,a.length*g.dimension),d(r,a,g.dimension),B(g,r,e),F.freeType(r)):"number"===typeof a[0]?(g.dimension=m,r=F.allocType(g.dtype,a.length),h(r,a),B(g,r,e),F.freeType(r)):c(a[0])&&(g.dimension=a[0].length,g.dtype=r||k(a[0])||5126,r=F.allocType(g.dtype,
a.length*g.dimension),d(r,a,g.dimension),B(g,r,e),F.freeType(r)));else if(c(a))g.dtype=r||k(a),g.dimension=m,B(g,a,e);else if(b(a)){var M=a.shape,C=a.stride;m=a.offset;var y=0,Q=0,u=0,D=0;1===M.length?(y=M[0],Q=1,u=C[0],D=0):2===M.length&&(y=M[0],Q=M[1],u=C[0],D=C[1]);g.dtype=r||k(a.data)||5126;g.dimension=Q;r=F.allocType(g.dtype,y*Q);t(r,a.data,y,Q,u,D,m);B(g,r,e);F.freeType(r)}}function r(a){l.bufferCount--;var c=a.buffer;e.isBuffer(c)&&e.deleteBuffer(c);a.buffer=null;delete V[a.id]}var a=0,V={};
L.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)};L.prototype.destroy=function(){r(this)};var R=[];return{create:function(a,m,B){function R(a){var g=35044,d=null,k=0,h=0,r=1;Array.isArray(a)||c(a)||b(a)?d=a:"number"===typeof a?k=a|0:a&&("data"in a&&(d=a.data),"usage"in a&&(g=u[a.usage]),"type"in a&&(h=w[a.type]),"dimension"in a&&(r=a.dimension|0),"length"in a&&(k=a.length|0));x.bind();d?J(x,d,g,h,r):(e.bufferData(x.type,k,g),x.dtype=h||5121,x.usage=g,x.dimension=r,x.byteLength=k);return R}
l.bufferCount++;var x=new L(m);V[x.id]=x;B||R(a);R._reglType="buffer";R._buffer=x;R.subdata=function(a,g){var r=(g||0)|0;x.bind();if(Array.isArray(a)){if(0<a.length)if("number"===typeof a[0]){var m=F.allocType(x.dtype,a.length);h(m,a);e.bufferSubData(x.type,r,m);F.freeType(m)}else if(Array.isArray(a[0])||c(a[0])){var m=a[0].length,u=F.allocType(x.dtype,a.length*m);d(u,a,m);e.bufferSubData(x.type,r,u);F.freeType(u)}}else if(c(a))e.bufferSubData(x.type,r,a);else if(b(a)){var D=a.shape,B=a.stride,l=
u=m=0,T=0;1===D.length?(m=D[0],u=1,l=B[0],T=0):2===D.length&&(m=D[0],u=D[1],l=B[0],T=B[1]);D=Array.isArray(a.data)?x.dtype:k(a.data);D=F.allocType(D,m*u);t(D,a.data,m,u,l,T,a.offset);e.bufferSubData(x.type,r,D);F.freeType(D)}return R};R.destroy=function(){r(x)};return R},createStream:function(a,c){var b=R.pop();b||(b=new L(a),b.buffer=e.createBuffer());b.bind();J(b,c,35040,0,1);return b},destroyStream:function(a){R.push(a)},clear:function(){m(V).forEach(r)},getBuffer:function(a){return a&&a._buffer instanceof
L?a._buffer:null},_initBuffer:J}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(e,l,q){l.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},
{}],5:[function(e,l,q){l.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(e,l,q){l.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(e,l,q){l.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(e,l,q){function k(a){return Array.isArray(a)||O(a)||w(a)}function h(a){return a.sort(function(a,c){return"viewport"===a?-1:
"viewport"===c?1:a<c?-1:1})}function t(a,c,b,d){this.thisDep=a;this.contextDep=c;this.propDep=b;this.append=d}function d(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function c(a){return new t(!1,!1,!1,a)}function b(a,c){var b=a.type;return 0===b?(b=a.data.length,new t(!0,1<=b,2<=b,c)):new t(3===b,2===b,1===b,c)}var m=e("./util/codegen"),F=e("./util/loop"),O=e("./util/is-typed-array"),w=e("./util/is-ndarray"),u=e("./util/is-array-like"),z=e("./constants/primitives.json"),K=e("./constants/dtypes.json"),
L=["x","y","z","w"],B={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},J={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,
always:519},r={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},a={cw:2304,ccw:2305},V=new t(!1,!1,!1,function(){});l.exports=function(e,g,l,P,w,x,M,C,y,Q,aa,D,O,q){function U(a){return a.replace(".","_")}function N(a,f,c){var b=U(a);za.push(a);wa[b]=v[b]=!!c;ma[b]=f}function H(a,f,c){var b=U(a);za.push(a);Array.isArray(c)?(v[b]=c.slice(),wa[b]=c.slice()):v[b]=wa[b]=c;na[b]=f}function Y(){var a=m(),f=a.link,c=a.global;a.id=
Ka++;a.batchId="0";var b=f(Ia),E=a.shared={props:"a0"};Object.keys(Ia).forEach(function(p){E[p]=c.def(b,".",p)});var I=a.next={},d=a.current={};Object.keys(na).forEach(function(p){Array.isArray(v[p])&&(I[p]=c.def(E.next,".",p),d[p]=c.def(E.current,".",p))});var p=a.constants={};Object.keys(Aa).forEach(function(a){p[a]=c.def(JSON.stringify(Aa[a]))});a.invoke=function(p,c){switch(c.type){case 0:var b=["this",E.context,E.props,a.batchId];return p.def(f(c.data),".call(",b.slice(0,Math.max(c.data.length+
1,4)),")");case 1:return p.def(E.props,c.data);case 2:return p.def(E.context,c.data);case 3:return p.def("this",c.data)}};a.attribCache={};var Ga={};a.scopeAttrib=function(p){p=g.id(p);if(p in Ga)return Ga[p];var a=Q.scope[p];a||(a=Q.scope[p]=new ia);return Ga[p]=f(a)};return a}function fa(a){var f=a["static"];a=a.dynamic;if("framebuffer"in f){var g=f.framebuffer;return g?(g=C.getFramebuffer(g),c(function(a,f){var n=a.link(g),p=a.shared;f.set(p.framebuffer,".next",n);p=p.context;f.set(p,".framebufferWidth",
n+".width");f.set(p,".framebufferHeight",n+".height");return n})):c(function(a,f){var n=a.shared;f.set(n.framebuffer,".next","null");n=n.context;f.set(n,".framebufferWidth",n+".drawingBufferWidth");f.set(n,".framebufferHeight",n+".drawingBufferHeight");return null})}if("framebuffer"in a){var d=a.framebuffer;return b(d,function(a,f){var n=a.invoke(f,d),p=a.shared,c=p.framebuffer,n=f.def(c,".getFramebuffer(",n,")");f.set(c,".next",n);p=p.context;f.set(p,".framebufferWidth",n+"?"+n+".width:"+p+".drawingBufferWidth");
f.set(p,".framebufferHeight",n+"?"+n+".height:"+p+".drawingBufferHeight");return n})}return null}function oa(a,f){function c(a){if(a in g){var n=g[a];a=!0;var Ja=n.x|0,I=n.y|0,k,ya;"w"in n?k=n.w|0:a=!1;"h"in n?ya=n.h|0:a=!1;return new t(a&&f&&f.thisDep,a&&f&&f.contextDep,a&&f&&f.propDep,function(a,p){var f=a.shared.context,c=k;"w"in n||(c=p.def(f,".","framebufferWidth","-",Ja));var b=ya;"h"in n||(b=p.def(f,".","framebufferHeight","-",I));return[Ja,I,c,b]})}if(a in d){var h=d[a];a=b(h,function(a,p){var f=
a.invoke(p,h),n=a.shared.context,c=p.def(f,".x|0"),b=p.def(f,".y|0"),G=p.def('"w" in ',f,"?",f,".w|0:","(",n,".","framebufferWidth","-",c,")"),f=p.def('"h" in ',f,"?",f,".h|0:","(",n,".","framebufferHeight","-",b,")");return[c,b,G,f]});f&&(a.thisDep=a.thisDep||f.thisDep,a.contextDep=a.contextDep||f.contextDep,a.propDep=a.propDep||f.prpoDep);return a}return f?new t(f.thisDep,f.contextDep,f.propDep,function(a,p){var f=a.shared.context;return[0,0,p.def(f,".","framebufferWidth"),p.def(f,".","framebufferHeight")]}):
null}var g=a["static"],d=a.dynamic,I=c("viewport");if(I)var k=I,I=new t(I.thisDep,I.contextDep,I.propDep,function(a,f){var n=k.append(a,f),c=a.shared.context;f.set(c,".viewportWidth",n[2]);f.set(c,".viewportHeight",n[3]);return n});return{viewport:I,scissor_box:c("scissor.box")}}function qa(a){function f(a){if(a in k){var n=g.id(k[a]);a=c(function(){return n});a.id=n;return a}if(a in h){var G=h[a];return b(G,function(a,f){var p=a.invoke(f,G);return f.def(a.shared.strings,".id(",p,")")})}return null}
var k=a["static"],h=a.dynamic,E=f("frag"),I=f("vert"),v=null;d(E)&&d(I)?(v=aa.program(I.id,E.id),a=c(function(a,f){return a.link(v)})):a=new t(E&&E.thisDep||I&&I.thisDep,E&&E.contextDep||I&&I.contextDep,E&&E.propDep||I&&I.propDep,function(a,f){var n=a.shared.shader,c;c=E?E.append(a,f):f.def(n,".","frag");var b;b=I?I.append(a,f):f.def(n,".","vert");return f.def(n+".program("+b+","+c+")")});return{frag:E,vert:I,progVar:a,program:v}}function ga(a){function f(a,p){if(a in g){var n=g[a]|0;return c(function(a,
f){p&&(a.OFFSET=n);return n})}if(a in h){var G=h[a];return b(G,function(a,f){var n=a.invoke(f,G);p&&(a.OFFSET=n);return n})}return p&&E?c(function(a,f){a.OFFSET="0";return 0}):null}var g=a["static"],h=a.dynamic,E=function(){if("elements"in g){var a=g.elements;k(a)?a=x.getElements(x.create(a)):a&&(a=x.getElements(a));var f=c(function(f,p){if(a){var n=f.link(a);return f.ELEMENTS=n}return f.ELEMENTS=null});f.value=a;return f}if("elements"in h){var n=h.elements;return b(n,function(a,f){var p=a.shared,
c=p.isBufferArgs,p=p.elements,b=a.invoke(f,n),G=f.def("null"),c=f.def(c,"(",b,")"),b=a.cond(c).then(G,"=",p,".createStream(",b,");")["else"](G,"=",p,".getElements(",b,");");f.entry(b);f.exit(a.cond(c).then(p,".destroyStream(",G,");"));return a.ELEMENTS=G})}return null}(),I=f("offset",!0);return{elements:E,primitive:function(){if("primitive"in g){var a=g.primitive;return c(function(f,p){return z[a]})}if("primitive"in h){var f=h.primitive;return b(f,function(a,n){var c=a.constants.primTypes,b=a.invoke(n,
f);return n.def(c,"[",b,"]")})}return E?d(E)?E.value?c(function(a,f){return f.def(a.ELEMENTS,".primType")}):c(function(){return 4}):new t(E.thisDep,E.contextDep,E.propDep,function(a,f){var p=a.ELEMENTS;return f.def(p,"?",p,".primType:",4)}):null}(),count:function(){if("count"in g){var a=g.count|0;return c(function(){return a})}if("count"in h){var f=h.count;return b(f,function(a,n){return a.invoke(n,f)})}return E?d(E)?E?I?new t(I.thisDep,I.contextDep,I.propDep,function(a,f){return f.def(a.ELEMENTS,
".vertCount-",a.OFFSET)}):c(function(a,f){return f.def(a.ELEMENTS,".vertCount")}):c(function(){return-1}):new t(E.thisDep||I.thisDep,E.contextDep||I.contextDep,E.propDep||I.propDep,function(a,f){var p=a.ELEMENTS;return a.OFFSET?f.def(p,"?",p,".vertCount-",a.OFFSET,":-1"):f.def(p,"?",p,".vertCount:-1")}):null}(),instances:f("instances",!1),offset:I}}function pa(f){var G=f["static"],g=f.dynamic,d={};za.forEach(function(f){function n(a,I){if(f in G){var k=a(G[f]);d[h]=c(function(){return k})}else if(f in
g){var v=g[f];d[h]=b(v,function(a,f){return I(a,f,a.invoke(f,v))})}}var h=U(f);switch(f){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return n(function(a){return a},function(a,f,n){return n});case "depth.func":return n(function(a){return J[a]},function(a,f,n){return f.def(a.constants.compareFuncs,"[",n,"]")});case "depth.range":return n(function(a){return a},
function(a,f,n){a=f.def("+",n,"[0]");f=f.def("+",n,"[1]");return[a,f]});case "blend.func":return n(function(a){return[B["srcRGB"in a?a.srcRGB:a.src],B["dstRGB"in a?a.dstRGB:a.dst],B["srcAlpha"in a?a.srcAlpha:a.src],B["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,f,n){function c(a,p){var G=f.def('"',a,p,'" in ',n,"?",n,".",a,p,":",n,".",a);return f.def(b,"[",G,"]")}var b=a.constants.blendFuncs;a=c("src","RGB");var G=c("src","Alpha"),g=c("dst","RGB"),d=c("dst","Alpha");return[a,g,G,d]});case "blend.equation":return n(function(a){if("string"===
typeof a)return[ba[a],ba[a]];if("object"===typeof a)return[ba[a.rgb],ba[a.alpha]]},function(a,f,n){var c=a.constants.blendEquations,b=f.def(),G=f.def();a=a.cond("typeof ",n,'==="string"');a.then(b,"=",G,"=",c,"[",n,"];");a["else"](b,"=",c,"[",n,".rgb];",G,"=",c,"[",n,".alpha];");f(a);return[b,G]});case "blend.color":return n(function(a){return F(4,function(f){return+a[f]})},function(a,f,n){return F(4,function(a){return f.def("+",n,"[",a,"]")})});case "stencil.mask":return n(function(a){return a|0},
function(a,f,n){return f.def(n,"|0")});case "stencil.func":return n(function(a){return[J[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,f,n){a=f.def('"cmp" in ',n,"?",a.constants.compareFuncs,"[",n,".cmp]",":",7680);var c=f.def(n,".ref|0");f=f.def('"mask" in ',n,"?",n,".mask|0:-1");return[a,c,f]});case "stencil.opFront":case "stencil.opBack":return n(function(a){return["stencil.opBack"===f?1029:1028,r[a.fail||"keep"],r[a.zfail||"keep"],r[a.pass||"keep"]]},function(a,n,c){function b(a){return n.def('"',
a,'" in ',c,"?",G,"[",c,".",a,"]:",7680)}var G=a.constants.stencilOps;return["stencil.opBack"===f?1029:1028,b("fail"),b("zfail"),b("pass")]});case "polygonOffset.offset":return n(function(a){return[a.factor|0,a.units|0]},function(a,f,n){a=f.def(n,".factor|0");f=f.def(n,".units|0");return[a,f]});case "cull.face":return n(function(a){var f=0;"front"===a?f=1028:"back"===a&&(f=1029);return f},function(a,f,n){return f.def(n,'==="front"?',1028,":",1029)});case "lineWidth":return n(function(a){return a},
function(a,f,n){return n});case "frontFace":return n(function(f){return a[f]},function(a,f,n){return f.def(n+'==="cw"?2304:2305')});case "colorMask":return n(function(a){return a.map(function(a){return!!a})},function(a,f,n){return F(4,function(a){return"!!"+n+"["+a+"]"})});case "sample.coverage":return n(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,f,n){a=f.def('"value" in ',n,"?+",n,".value:1");f=f.def("!!",n,".invert");return[a,f]})}});return d}function ja(a){var f=a["static"],
g=a.dynamic,d={};Object.keys(f).forEach(function(a){var n=f[a],b;"number"===typeof n||"boolean"===typeof n?b=c(function(){return n}):"function"!==typeof n||"texture2d"!==n._reglType&&"textureCube"!==n._reglType?u(n)&&(b=c(function(a){return a.global.def("[",F(n.length,function(a){return n[a]}),"]")})):b=c(function(a){return a.link(n)});b.value=n;d[a]=b});Object.keys(g).forEach(function(a){var f=g[a];d[a]=b(f,function(a,n){return a.invoke(n,f)})});return d}function ca(a){var f=a["static"],d=a.dynamic,
h={};Object.keys(f).forEach(function(a){var n=f[a],b=g.id(a),p=new ia;if(k(n))p.state=1,p.buffer=w.getBuffer(w.create(n,34962,!1)),p.type=p.buffer.dtype;else{var d=w.getBuffer(n);if(d)p.state=1,p.buffer=d,p.type=d.dtype;else if(n.constant){var v=n.constant;p.state=2;"number"===typeof v?p.x=v:L.forEach(function(a,f){f<v.length&&(p[a]=v[f])})}else{var d=w.getBuffer(n.buffer),ya=n.offset|0,A=n.stride|0,r=n.size|0,e=!!n.normalized,m=0;"type"in n&&(m=K[n.type]);n=n.divisor|0;p.buffer=d;p.state=1;p.size=
r;p.normalized=e;p.type=m||d.dtype;p.offset=ya;p.stride=A;p.divisor=n}}h[a]=c(function(a,f){var n=a.attribCache;if(b in n)return n[b];var c={isStream:!1};Object.keys(p).forEach(function(a){c[a]=p[a]});p.buffer&&(c.buffer=a.link(p.buffer));return n[b]=c})});Object.keys(d).forEach(function(a){var f=d[a];h[a]=b(f,function(a,n){function c(a){n(h[a],"=",b,".",a,"|0;")}var b=a.invoke(n,f),G=a.shared,g=G.isBufferArgs,d=G.buffer,h={isStream:n.def(!1)},k=new ia;k.state=1;Object.keys(k).forEach(function(a){h[a]=
n.def(""+k[a])});var v=h.buffer,E=h.type;n("if(",g,"(",b,")){",h.isStream,"=true;",v,"=",d,".createStream(",34962,",",b,");",E,"=",v,".dtype;","}else{",v,"=",d,".getBuffer(",b,");","if(",v,"){",E,"=",v,".dtype;","}else if(",b,".constant){",h.state,"=",2,";",L.map(function(a,f){return h[a]+"="+b+".length>="+f+"?"+b+"["+f+"]:0;"}).join(""),"}else{",v,"=",d,".getBuffer(",b,".buffer);",E,'="type" in ',b,"?",G.glTypes,"[",b,".type]:",v,".dtype;",h.normalized,"=!!",b,".normalized;");c("size");c("offset");
c("stride");c("divisor");n("}}");return h})});return h}function ka(a){var f=a["static"],d=a.dynamic,g={};Object.keys(f).forEach(function(a){var n=f[a];g[a]=c(function(a,f){return"number"===typeof n||"boolean"===typeof n?""+n:a.link(n)})});Object.keys(d).forEach(function(a){var f=d[a];g[a]=b(f,function(a,n){return a.invoke(n,f)})});return g}function Z(a,f,c){var b=a.shared.context,d=a.scope();Object.keys(c).forEach(function(g){f.save(b,"."+g);d(b,".",g,"=",c[g].append(a,f),";")});f(d)}function W(a,
f,c){var b=a.shared,g=b.gl,d=b.framebuffer,h;A&&(h=f.def(b.extensions,".webgl_draw_buffers"));var p=a.constants,b=p.drawBuffer,p=p.backBuffer;a=c?c.append(a,f):f.def(d,".next");f("if(",d,".dirty||",a,"!==",d,".cur){","if(",a,"){",g,".bindFramebuffer(",36160,",",a,".framebuffer);");A&&f(h,".drawBuffersWEBGL(",b,"[",a,".colorAttachments.length]);");f("}else{",g,".bindFramebuffer(",36160,",null);");A&&f(h,".drawBuffersWEBGL(",p,");");f("}",d,".cur=",a,";",d,".dirty=false;","}")}function X(a,f,c){var b=
a.shared,d=b.gl,g=a.current,h=a.next,p=b.current,k=b.next,A=a.cond(p,".dirty");za.forEach(function(f){f=U(f);if(!(f in c.state)){var b,G;if(f in h){b=h[f];G=g[f];var r=F(v[f].length,function(a){return A.def(b,"[",a,"]")});A(a.cond(r.map(function(a,f){return a+"==="+G+"["+f+"]"}).join("&&")).then(d,".",na[f],"(",r,");",r.map(function(a,f){return G+"["+f+"]="+a}).join(";"),";"))}else b=A.def(k,".",f),r=a.cond(b,"!==",p,".",f),A(r),f in ma?r(a.cond(b).then(d,".enable(",ma[f],");")["else"](d,".disable(",
ma[f],");"),p,".",f,"=",b,";"):r(d,".",na[f],"(",b,");",p,".",f,"=",b,";")}});0===Object.keys(c.state).length&&A(p,".dirty=false;");f(A)}function ta(a,f,c,b){var g=a.shared,k=a.current,v=g.current,p=g.gl;h(Object.keys(c)).forEach(function(g){var h=c[g];if(!b||b(h)){var A=h.append(a,f);if(ma[g]){var r=ma[g];d(h)?A?f(p,".enable(",r,");"):f(p,".disable(",r,");"):f(a.cond(A).then(p,".enable(",r,");")["else"](p,".disable(",r,");"));f(v,".",g,"=",A,";")}else if(u(A)){var e=k[g];f(p,".",na[g],"(",A,");",
A.map(function(a,f){return e+"["+f+"]="+a}).join(";"),";")}else f(p,".",na[g],"(",A,");",v,".",g,"=",A,";")}})}function ra(a,c){f&&!a.instancing&&(a.instancing=c.def(a.shared.extensions,".angle_instanced_arrays"))}function Ba(a,f,c){c=a.stats;a=a.shared;q&&f(a.timer,".beginQuery(",c,");")}function ha(a,f,c){a=a.shared;q&&f(a.timer,".endQuery();")}function da(a,c,b,g,d){function h(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;
default:return 1}}function k(b,g,d){function h(){c("if(!",e,".pointer){",A,".enableVertexAttribArray(",r,");",e,".pointer=true;}");var b=d.type,p;p=d.size?c.def(d.size,"||",g):g;c("if(",e,".type!==",b,"||",e,".size!==",p,"||",t.map(function(a){return e+"."+a+"!=="+d[a]}).join("||"),"){",A,".bindBuffer(",34962,",",E,".buffer);",A,".vertexAttribPointer(",[r,p,b,d.normalized,d.stride,d.offset],");",e,".type=",b,";",e,".size=",p,";",t.map(function(a){return e+"."+a+"="+d[a]+";"}).join(""),"}");f&&(b=
d.divisor,c("if(",e,".divisor!==",b,"){",a.instancing,".vertexAttribDivisorANGLE(",[r,b],");",e,".divisor=",b,";}"))}function v(){c("if(",e,".pointer){",A,".disableVertexAttribArray(",r,");",e,".pointer=false;","}if(",L.map(function(a,f){return e+"."+a+"!=="+m[f]}).join("||"),"){",A,".vertexAttrib4f(",r,",",m,");",L.map(function(a,f){return e+"."+a+"="+m[f]+";"}).join(""),"}")}var A=p.gl,r=c.def(b,".location"),e=c.def(p.attributes,"[",r,"]");b=d.state;var E=d.buffer,m=[d.x,d.y,d.z,d.w],t=["buffer",
"normalized","offset","stride"];1===b?h():2===b?v():(c("if(",b,"===",1,"){"),h(),c("}else{"),v(),c("}"))}var p=a.shared;g.forEach(function(f){var g=f.name,p=b.attributes[g],v;if(p){if(!d(p))return;v=p.append(a,c)}else{if(!d(V))return;var A=a.scopeAttrib(g);v={};Object.keys(new ia).forEach(function(a){v[a]=c.def(A,".",a)})}k(a.link(f),h(f.info.type),v)})}function ea(a,f,c,b,h){for(var k=a.shared,v=k.gl,p,A=0;A<b.length;++A){var r=b[A],e=r.name,m=r.info.type,t=c.uniforms[e],r=a.link(r)+".location",
y;if(t){if(!h(t))continue;if(d(t)){e=t.value;if(35678===m||35680===m)m=a.link(e._texture),f(v,".uniform1i(",r,",",m+".bind());"),f.exit(m,".unbind();");else if(35674===m||35675===m||35676===m)e=a.global.def("new Float32Array(["+Array.prototype.slice.call(e)+"])"),t=2,35675===m?t=3:35676===m&&(t=4),f(v,".uniformMatrix",t,"fv(",r,",false,",e,");");else{switch(m){case 5126:p="1f";break;case 35664:p="2f";break;case 35665:p="3f";break;case 35666:p="4f";break;case 35670:p="1i";break;case 5124:p="1i";break;
case 35671:p="2i";break;case 35667:p="2i";break;case 35672:p="3i";break;case 35668:p="3i";break;case 35673:p="4i";break;case 35669:p="4i"}f(v,".uniform",p,"(",r,",",u(e)?Array.prototype.slice.call(e):e,");")}continue}else y=t.append(a,f)}else{if(!h(V))continue;y=f.def(k.uniforms,"[",g.id(e),"]")}e=1;switch(m){case 35678:case 35680:m=f.def(y,"._texture");f(v,".uniform1i(",r,",",m,".bind());");f.exit(m,".unbind();");continue;case 5124:case 35670:p="1i";break;case 35667:case 35671:p="2i";e=2;break;case 35668:case 35672:p=
"3i";e=3;break;case 35669:case 35673:p="4i";e=4;break;case 5126:p="1f";break;case 35664:p="2f";e=2;break;case 35665:p="3f";e=3;break;case 35666:p="4f";e=4;break;case 35674:p="Matrix2fv";break;case 35675:p="Matrix3fv";break;case 35676:p="Matrix4fv"}f(v,".uniform",p,"(",r,",");if("M"===p.charAt(0)){var r=Math.pow(m-35674+2,2),C=a.global.def("new Float32Array(",r,")");f("false,(Array.isArray(",y,")||",y," instanceof Float32Array)?",y,":(",F(r,function(a){return C+"["+a+"]="+y+"["+a+"]"}),",",C,")")}else 1<
e?f(F(e,function(a){return y+"["+a+"]"})):f(y);f(");")}}function xa(a,c,b,g){function h(f){var d=A[f];return d?d.contextDep&&g.contextDynamic||d.propDep?d.append(a,b):d.append(a,c):c.def(r,".",f)}function v(){function a(){b(D,".drawElementsInstancedANGLE(",[t,u,M,y+"<<(("+M+"-5121)>>1)",C],");")}function f(){b(D,".drawArraysInstancedANGLE(",[t,y,u,C],");")}m?B?a():(b("if(",m,"){"),a(),b("}else{"),f(),b("}")):f()}function k(){function a(){b(e+".drawElements("+[t,u,M,y+"<<(("+M+"-5121)>>1)"]+");")}
function f(){b(e+".drawArrays("+[t,y,u]+");")}m?B?a():(b("if(",m,"){"),a(),b("}else{"),f(),b("}")):f()}var p=a.shared,e=p.gl,r=p.draw,A=g.draw,m=function(){var f=A.elements,d=c;if(f){if(f.contextDep&&g.contextDynamic||f.propDep)d=b;f=f.append(a,d)}else f=d.def(r,".","elements");f&&d("if("+f+")"+e+".bindBuffer(34963,"+f+".buffer.buffer);");return f}(),t=h("primitive"),y=h("offset"),u=function(){var f=A.count,d=c;if(f){if(f.contextDep&&g.contextDynamic||f.propDep)d=b;f=f.append(a,d)}else f=d.def(r,
".","count");return f}();if("number"===typeof u){if(0===u)return}else b("if(",u,"){"),b.exit("}");var C,D;f&&(C=h("instances"),D=a.instancing);var M=m+".type",B=A.elements&&d(A.elements);f&&("number"!==typeof C||0<=C)?"string"===typeof C?(b("if(",C,">0){"),v(),b("}else if(",C,"<0){"),k(),b("}")):v():k()}function ua(a,b,c,d,g){b=Y();g=b.proc("body",g);f&&(b.instancing=g.def(b.shared.extensions,".angle_instanced_arrays"));a(b,g,c,d);return b.compile().body}function Ca(a,f,b,c){ra(a,f);da(a,f,b,c.attributes,
function(){return!0});ea(a,f,b,c.uniforms,function(){return!0});xa(a,f,f,b)}function Da(a,f){var b=a.proc("draw",1);ra(a,b);Z(a,b,f.context);W(a,b,f.framebuffer);X(a,b,f);ta(a,b,f.state);Ba(a,b,f);var c=f.shader.progVar.append(a,b);b(a.shared.gl,".useProgram(",c,".program);");if(f.shader.program)Ca(a,b,f,f.shader.program);else{var d=a.global.def("{}"),g=b.def(c,".id"),h=b.def(d,"[",g,"]");b(a.cond(h).then(h,".call(this,a0);")["else"](h,"=",d,"[",g,"]=",a.link(function(b){return ua(Ca,a,f,b,1)}),"(",
c,");",h,".call(this,a0);"))}0<Object.keys(f.state).length&&b(a.shared.current,".dirty=true;");ha(a,b,f)}function Ea(a,f,b,c){function d(){return!0}a.batchId="a1";ra(a,f);da(a,f,b,c.attributes,d);ea(a,f,b,c.uniforms,d);xa(a,f,f,b)}function sa(a,f,b,c){function d(a){return a.contextDep&&h||a.propDep}function g(a){return!d(a)}ra(a,f);var h=b.contextDynamic,p=f.def(),v=f.def();a.shared.props=v;a.batchId=p;var k=a.scope(),e=a.scope();f(k.entry,"for(",p,"=0;",p,"<","a1",";++",p,"){",v,"=","a0","[",p,"];",
e,"}",k.exit);b.needsContext&&Z(a,e,b.context);b.needsFramebuffer&&W(a,e,b.framebuffer);ta(a,e,b.state,d);c?(da(a,k,b,c.attributes,g),da(a,e,b,c.attributes,d),ea(a,k,b,c.uniforms,g),ea(a,e,b,c.uniforms,d),xa(a,k,e,b)):(f=a.global.def("{}"),c=b.shader.progVar.append(a,e),v=e.def(c,".id"),k=e.def(f,"[",v,"]"),e(a.shared.gl,".useProgram(",c,".program);","if(!",k,"){",k,"=",f,"[",v,"]=",a.link(function(f){return ua(Ea,a,b,f,2)}),"(",c,");}",k,".call(this,a0[",p,"],",p,");"))}function Ha(a,f){var b=a.proc("batch",
2);a.batchId="0";ra(a,b);var c=!1,d=!0;Object.keys(f.context).forEach(function(a){c=c||f.context[a].propDep});c||(Z(a,b,f.context),d=!1);var g=f.framebuffer,h=!1;g&&(g.propDep?c=h=!0:g.contextDep&&c&&(h=!0),h||W(a,b,g));f.state.viewport&&f.state.viewport.propDynamic&&(c=!0);X(a,b,f);ta(a,b,f.state,function(a){return!(a.contextDep&&c||a.propDep)});Ba(a,b,f);f.contextDep=c;f.needsContext=d;f.needsFramebuffer=h;d=f.shader.progVar;if(d.contextDep&&c||d.propDep)sa(a,b,f,null);else if(d=d.append(a,b),b(a.shared.gl,
".useProgram(",d,".program);"),f.shader.program)sa(a,b,f,f.shader.program);else{var g=a.global.def("{}"),h=b.def(d,".id"),p=b.def(g,"[",h,"]");b(a.cond(p).then(p,".call(this,a0,a1);")["else"](p,"=",g,"[",h,"]=",a.link(function(b){return ua(sa,a,f,b,2)}),"(",d,");",p,".call(this,a0,a1);"))}0<Object.keys(f.state).length&&b(a.shared.current,".dirty=true;");ha(a,b,f)}function va(a,f){function b(g){var h=f.shader[g];h&&c.set(d.shader,"."+g,h.append(a,c))}var c=a.proc("scope",3);a.batchId="a2";var d=a.shared,
k=d.current,v=d.timer,p;q&&(p=c.def(v,".getNumPendingQueries()"));Z(a,c,f.context);f.framebuffer&&f.framebuffer.append(a,c);h(Object.keys(f.state)).forEach(function(b){var g=f.state[b].append(a,c);u(g)?g.forEach(function(f,d){c.set(a.next[b],"["+d+"]",f)}):c.set(d.next,"."+b,g)});["elements","offset","count","instances","primitive"].forEach(function(b){var g=f.draw[b];g&&c.set(d.draw,"."+b,""+g.append(a,c))});Object.keys(f.uniforms).forEach(function(b){c.set(d.uniforms,"["+g.id(b)+"]",f.uniforms[b].append(a,
c))});Object.keys(f.attributes).forEach(function(b){var d=f.attributes[b].append(a,c),g=a.scopeAttrib(b);Object.keys(new ia).forEach(function(a){c.set(g,"."+a,d[a])})});b("vert");b("frag");0<Object.keys(f.state).length&&(c(k,".dirty=true;"),c.exit(k,".dirty=true;"));c("a1(",a.shared.context,",a0,0);");if(q){var e=a.stats,k=c.def(v,".getNumPendingQueries()-1");c(v,".pushScopeStats(",p,",",k,",",e,");")}}var ia=Q.Record,ba={add:32774,subtract:32778,"reverse subtract":32779};l.ext_blend_minmax&&(ba.min=
32775,ba.max=32776);var f=l.angle_instanced_arrays,A=l.webgl_draw_buffers,v={dirty:!0},wa={},za=[],ma={},na={};N("dither",3024);N("blend.enable",3042);H("blend.color","blendColor",[0,0,0,0]);H("blend.equation","blendEquationSeparate",[32774,32774]);H("blend.func","blendFuncSeparate",[1,0,1,0]);N("depth.enable",2929,!0);H("depth.func","depthFunc",513);H("depth.range","depthRange",[0,1]);H("depth.mask","depthMask",!0);H("colorMask","colorMask",[!0,!0,!0,!0]);N("cull.enable",2884);H("cull.face","cullFace",
1029);H("frontFace","frontFace",2305);H("lineWidth","lineWidth",1);N("polygonOffset.enable",32823);H("polygonOffset.offset","polygonOffset",[0,0]);N("sample.alpha",32926);N("sample.enable",32928);H("sample.coverage","sampleCoverage",[1,!1]);N("stencil.enable",2960);H("stencil.mask","stencilMask",-1);H("stencil.func","stencilFunc",[519,0,-1]);H("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);H("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);N("scissor.enable",3089);H("scissor.box",
"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);H("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var Ia={gl:e,context:O,strings:g,next:wa,current:v,draw:D,elements:x,buffer:w,shader:aa,attributes:Q.state,uniforms:y,framebuffer:C,extensions:l,timer:q,isBufferArgs:k},Aa={primTypes:z,compareFuncs:J,blendFuncs:B,blendEquations:ba,stencilOps:r,glTypes:K,orientationType:a};A&&(Aa.backBuffer=[1029],Aa.drawBuffer=F(P.maxDrawbuffers,function(a){return 0===a?[0]:F(a,function(a){return 36064+
a})}));var Ka=0;return{next:wa,current:v,procs:function(){var a=Y(),f=a.proc("poll"),b=a.proc("refresh"),c=a.block();f(c);b(c);var d=a.shared,g=d.gl,h=d.next,k=d.current;c(k,".dirty=false;");W(a,f);b(d.framebuffer,".dirty=true;");W(a,b);Object.keys(ma).forEach(function(d){var v=ma[d],e=c.def(h,".",d),r=a.block();r("if(",e,"){",g,".enable(",v,")}else{",g,".disable(",v,")}",k,".",d,"=",e,";");b(r);f("if(",e,"!==",k,".",d,"){",r,"}")});Object.keys(na).forEach(function(d){var e=na[d],r=v[d],A,m,t=a.block();
t(g,".",e,"(");u(r)?(e=r.length,A=a.global.def(h,".",d),m=a.global.def(k,".",d),t(F(e,function(a){return A+"["+a+"]"}),");",F(e,function(a){return m+"["+a+"]="+A+"["+a+"];"}).join("")),f("if(",F(e,function(a){return A+"["+a+"]!=="+m+"["+a+"]"}).join("||"),"){",t,"}")):(A=c.def(h,".",d),m=c.def(k,".",d),t(A,");",k,".",d,"=",A,";"),f("if(",A,"!==",m,"){",t,"}"));b(t)});return a.compile()}(),compile:function(a,f,b,c,d){var g=Y();g.stats=g.link(d);d=fa(a);var h=oa(a,d),k=ga(a),e=pa(a);a=qa(a);var v=h.viewport;
v&&(e.viewport=v);v=U("scissor.box");(h=h[v])&&(e[v]=h);h=0<Object.keys(e).length;d={framebuffer:d,draw:k,shader:a,state:e,dirty:h};d.uniforms=ja(b);d.attributes=ca(f);d.context=ka(c);Da(g,d);va(g,d);Ha(g,d);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(e,l,q){function k(c,b){this.id=d++;this.type=c;this.data=b}function h(c){if(0===c.length)return[];
var b=c.charAt(0),d=c.charAt(c.length-1);if(1<c.length&&b===d&&('"'===b||"'"===b))return['"'+c.substr(1,c.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(c))return h(c.substr(0,b.index)).concat(h(b[1])).concat(h(c.substr(b.index+b[0].length)));b=c.split(".");if(1===b.length)return['"'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];c=[];for(d=0;d<b.length;++d)c=c.concat(h(b[d]));return c}function t(c){return"["+h(c).join("][")+"]"}var d=
0;l.exports={define:function(c,b){switch(typeof b){case "boolean":case "number":case "string":return new k(c,t(b+""));case "undefined":return new k(c|128,null)}},isDynamic:function(c){return"function"===typeof c&&!c._reglType||c instanceof k},unbox:function(c,b){if(c instanceof k){if(c.type&128)return new k(c.type&-129,t(b))}else if("function"===typeof c)return new k(0,c);return c},accessor:t}},{}],10:[function(e,l,q){var k=e("./util/is-typed-array"),h=e("./util/is-ndarray"),t=e("./util/values"),
d=e("./constants/primitives.json"),c=e("./constants/usage.json");l.exports=function(b,e,l,O){function w(b){this.id=L++;K[this.id]=this;this.buffer=b;this.primType=4;this.type=this.vertCount=0}function u(b,a,c,d,g,t,u){(t=u)||k(a)&&(!h(a)||k(a.data))||(t=e.oes_element_index_uint?5125:5123);b.buffer.bind();l._initBuffer(b.buffer,a,c,t,3);a=u;if(!u){switch(b.buffer.dtype){case 5121:case 5120:a=5121;break;case 5123:case 5122:a=5123;break;case 5125:case 5124:a=5125}b.buffer.dtype=a}b.type=a;0>g&&(g=b.buffer.byteLength,
5123===a?g>>=1:5125===a&&(g>>=2));b.vertCount=g;g=d;0>d&&(g=4,d=b.buffer.dimension,1===d&&(g=0),2===d&&(g=1),3===d&&(g=4));b.primType=g}function z(b){O.elementsCount--;delete K[b.id];b.buffer.destroy();b.buffer=null}var K={},L=0,B={uint8:5121,uint16:5123};e.oes_element_index_uint&&(B.uint32=5125);w.prototype.bind=function(){this.buffer.bind()};var J=[];return{create:function(e){function a(g){if(g)if("number"===typeof g)t(g),m.primType=4,m.vertCount=g|0,m.type=5121;else{var e=null,r=35044,l=-1,z=-1,
M=0,C=0;Array.isArray(g)||k(g)||h(g)?e=g:("data"in g&&(e=g.data),"usage"in g&&(r=c[g.usage]),"primitive"in g&&(l=d[g.primitive]),"count"in g&&(z=g.count|0),"length"in g&&(M=g.length|0),"type"in g&&(C=B[g.type]));e?u(m,e,r,l,z,M,C):(g=m.buffer,g.bind(),b.bufferData(34963,M,r),g.dtype=C||5121,g.usage=r,g.dimension=3,g.byteLength=M,m.primType=0>l?4:l,m.vertCount=0>z?0:z,m.type=g.dtype)}else t(),m.primType=4,m.vertCount=0,m.type=5121;return a}var t=l.create(null,34963,!0),m=new w(t._buffer);O.elementsCount++;
a(e);a._reglType="elements";a._elements=m;a.subdata=function(b,c){t.subdata(b,c);return a};a.destroy=function(){z(m)};return a},createStream:function(b){var a=J.pop();a||(a=new w(l.create(null,34963,!0)._buffer));u(a,b,35040,-1,-1,0,0);return a},destroyStream:function(b){J.push(b)},getElements:function(b){return"function"===typeof b&&b._elements instanceof w?b._elements:null},clear:function(){t(K).forEach(z)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,
"./util/values":31}],11:[function(e,l,q){l.exports=function(e){function h(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb ext_disjoint_timer_query angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(d){try{t[d]=
e.getExtension(d)}catch(c){}})}var t={};h();return{extensions:t,refresh:h}}},{}],12:[function(e,l,q){var k=e("./util/values"),h=e("./util/extend");l.exports=function(e,d,c,b,m,l){function O(a,b,c,d){this.target=a;this.level=b;this.texture=c;this.renderbuffer=d}function w(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function u(a,b){var c=b.width,d=b.height;if(a.texture)var g=a.texture._texture,h=Math.max(1,g.width>>a.level),e=Math.max(1,g.height>>
a.level),c=c||h,d=d||e;else g=a.renderbuffer._renderbuffer,c=c||g.width,d=d||g.height;g.refCount+=1;b.width=c;b.height=d}function z(a,b){b?b.texture?e.framebufferTexture2D(36160,a,b.target,b.texture._texture.texture,b.level):e.framebufferRenderbuffer(36160,a,36161,b.renderbuffer._renderbuffer.renderbuffer):e.framebufferTexture2D(36160,a,3553,null,0)}function K(a){var b=3553,c=0,d=null,g=null;"object"===typeof a&&("level"in a&&(c=a.level|0),"target"in a&&(b=a.target|0));var h=a._reglType;"texture2d"===
h?d=a:"textureCube"===h?d=a:"renderbuffer"===h&&(g=a,b=36161,c=0);return new O(b,c,d,g)}function L(a){return a&&(a.texture||a.renderbuffer)}function B(){this.id=S++;x[this.id]=this;this.framebuffer=null;this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null;this.ownsDepthStencil=this.ownsColor=!1}function J(b){e.isFramebuffer(b.framebuffer)||(b.framebuffer=e.createFramebuffer());a.dirty=!0;e.bindFramebuffer(36160,b.framebuffer);
for(var g=b.colorAttachments,h=0;h<g.length;++h)z(36064+h,g[h]);for(h=g.length;h<c.maxColorAttachments;++h)z(36064+h,null);z(36096,b.depthAttachment);z(36128,b.stencilAttachment);z(33306,b.depthStencilAttachment);d.webgl_draw_buffers&&d.webgl_draw_buffers.drawBuffersWEBGL(P[g.length]);e.checkFramebufferStatus(36160)}function r(a){e.deleteFramebuffer(a.framebuffer);l.framebufferCount--;delete x[a.id]}var a={current:null,next:null,dirty:!1},V={rgba:6408},q={rgba4:32854,rgb565:36194,"rgb5 a1":32855};
d.ext_srgb&&(q.srgba=35907);d.ext_color_buffer_half_float&&(q.rgba16f=34842,q.rgb16f=34843);d.webgl_color_buffer_float&&(q.rgba32f=34836);var g=[],T=[];d.webgl_depth_texture&&(g.push(6402),T.push(34041));h(h({},V),q);k(V);k(q);q=5121;g={uint8:5121};d.oes_texture_half_float&&(q=g["half float"]=36193);d.oes_texture_float&&(q=g["float"]=5126);g.best=q;var P=function(){for(var a=Array(c.maxDrawbuffers),b=0;b<=c.maxDrawbuffers;++b)for(var d=a[b]=Array(b),g=0;g<b;++g)d[g]=36064+g;return a}(),S=0,x={};return h(a,
{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof B)?a:null},create:function(a){function c(a){var g,h=a||{},k=a=0;if("shape"in h){var r=h.shape;a=r[0];k=r[1]}else"radius"in h&&(a=k=h.radius),"width"in h&&(a=h.width),"height"in h&&(k=h.height);var l=null,r=!1;if("colorBuffers"in h||"colorBuffer"in h){l=h.colorBuffers||h.colorBuffer;Array.isArray(l)||(l=[l]);d.width=a;d.height=k;l=l.map(K);for(g=0;g<l.length;++g)u(l[g],d);a=d.width;
k=d.height}else{var B=!0,z="rgba",F="uint8",x=1,r=!0;d.width=a=a||e.drawingBufferWidth;d.height=k=k||e.drawingBufferHeight;"format"in h&&(z=h.format,B=z in V);"type"in h&&(F=h.type);"colorCount"in h&&(x=h.colorCount|0);if(d.ownsColor)for(l=d.colorAttachments;l.length>x;)w(l.pop());else l=[];for(g=0;g<l.length;++g){var q;a:{q=l[g];var P=B,T=z,M=a,R=k;if(q.texture){var S=q.texture;if(P){S({format:T,type:F,width:M,height:R});S._texture.refCount+=1;q=!0;break a}}else if(S=q.renderbuffer,!P){S({format:T,
width:M,height:R});S._renderbuffer.refCount+=1;q=!0;break a}w(q);q=!1}q||(l[g--]=l[l.length-1],l.pop())}for(;l.length<x;)B?l.push(new O(3553,0,b.create2D({format:z,type:F,width:a,height:k},3553),null)):l.push(new O(36161,0,null,m.create({format:z,width:a,height:k})))}d.width=a;d.height=k;z=B=g=null;F=!1;"depthBuffer"in h&&(g=K(h.depthBuffer));"stencilBuffer"in h&&(B=K(h.stencilBuffer));"depthStencilBuffer"in h&&(z=K(h.depthStencilBuffer));if(g||B||z)u(g||B||z,d);else if(x=!0,P=q=!1,"depth"in h&&(x=
!!h.depth),"stencil"in h&&(q=!!h.stencil),"depthTexture"in h&&(P=!!h.depthTexture),h=d.depthAttachment||d.stencilAttachment||d.depthStencilAttachment,T=null,x||q)F=!0,P?(P=q?"depth stencil":"depth",d.ownsDepthStencil&&h.texture?(h.texture({format:P,width:a,height:k}),h.texture._texture.refCount+=1,T=h):T=new O(3553,0,b.create({format:P,width:a,height:k},3553),null)):(P=x?q?"depth stencil":"depth":"stencil",d.ownsDepthStencil&&h.renderbuffer?(h.renderbuffer({format:P,width:a,height:k}),h.renderbuffer._renderbuffer.refCount+=
1,T=h):T=new O(36161,0,null,m.create({format:P,width:a,height:k}))),x?q?z=T:g=T:B=T;a=d;a.colorAttachments.forEach(w);w(a.depthAttachment);w(a.stencilAttachment);w(a.depthStencilAttachment);d.colorAttachments=l;d.depthAttachment=g;d.stencilAttachment=B;d.depthStencilAttachment=z;d.ownsColor=r;d.ownsDepthStencil=F;c.color=l.map(L);c.depth=L(g);c.stencil=L(B);c.depthStencil=L(z);J(d);c.width=d.width;c.height=d.height;return c}var d=new B;l.framebufferCount++;c(a);c._reglType="framebuffer";c._framebuffer=
d;c._destroy=function(){r(d)};return c},clear:function(){k(x).forEach(r)},refresh:function(){k(x).forEach(J)}})}},{"./util/extend":23,"./util/values":31}],13:[function(e,l,q){l.exports=function(e,h){var t=1;h.ext_texture_filter_anisotropic&&(t=e.getParameter(34047));var d=1,c=1;h.webgl_draw_buffers&&(d=e.getParameter(34852),c=e.getParameter(36063));return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),
subpixelBits:e.getParameter(3408),extensions:Object.keys(h).filter(function(b){return!!h[b]}),maxAnisotropic:t,maxDrawbuffers:d,maxColorAttachments:c,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),
maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}}},{}],14:[function(e,l,q){var k=e("./util/is-typed-array");l.exports=function(h,e,d){return function(c){var b=c||{};k(c)?b={data:b}:2===arguments.length?b={width:arguments[0]|0,height:arguments[1]|0}:"object"!==typeof c&&(b={});e();var m=b.x||0,l=b.y||0,q=b.width||
d.viewportWidth,w=b.height||d.viewportHeight,b=b.data||new Uint8Array(q*w*4);h.pixelStorei(3333,4);h.readPixels(m,l,q,w,6408,5121,b);return b}}},{"./util/is-typed-array":26}],15:[function(e,l,q){var k=e("./util/values");l.exports=function(h,e,d,c){function b(b){this.id=q++;this.refCount=1;this.renderbuffer=b;this.format=32854;this.height=this.width=0}function m(b){var d=b.renderbuffer;h.bindRenderbuffer(36161,null);h.deleteRenderbuffer(d);b.renderbuffer=null;b.refCount=0;delete w[b.id];c.renderbufferCount--}
var l={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(l.srgba=35907);e.ext_color_buffer_half_float&&(l.rgba16f=34842,l.rgb16f=34843);e.webgl_color_buffer_float&&(l.rgba32f=34836);var q=0,w={};b.prototype.decRef=function(){0===--this.refCount&&m(this)};return{create:function(d,e){function k(b,c){var d=0,a=0,e=32854;"object"===typeof b&&b?("shape"in b?(a=b.shape,d=a[0]|0,a=a[1]|0):("radius"in b&&(d=a=b.radius|0),"width"in b&&(d=b.width|0),"height"in
b&&(a=b.height|0)),"format"in b&&(e=l[b.format])):"number"===typeof b?(d=b|0,"number"===typeof c?a=c|0:d=a):b||(d=a=1);if(d!==m.width||a!==m.height||e!==m.format)return k.width=m.width=d,k.height=m.height=a,m.format=e,h.bindRenderbuffer(36161,m.renderbuffer),h.renderbufferStorage(36161,e,d,a),k}var m=new b(h.createRenderbuffer());w[m.id]=m;c.renderbufferCount++;k(d,e);k.resize=function(b,c){var d=b|0,a=c|0||d;if(d!==m.width||a!==m.height)return k.width=m.width=d,k.height=m.height=a,h.bindRenderbuffer(36161,
m.renderbuffer),h.renderbufferStorage(36161,m.format,d,a),k};k._reglType="renderbuffer";k._renderbuffer=m;k.destroy=function(){m.decRef()};return k},clear:function(){k(w).forEach(m)}}}},{"./util/values":31}],16:[function(e,l,q){var k=e("./util/values");l.exports=function(h,e,d){function c(b,c,d,a){this.name=b;this.id=c;this.location=d;this.info=a}function b(b,c){for(var d=0;d<b.length;++d)if(b[d].id===c.id){b[d].location=c.location;return}b.push(c)}function m(b,c,d){d=35632===b?w:u;var a=d[c];if(!a){var k=
e.str(c),a=h.createShader(b);h.shaderSource(a,k);h.compileShader(a);d[c]=a}return a}function l(b,c){this.id=L++;this.fragId=b;this.vertId=c;this.program=null;this.uniforms=[];this.attributes=[]}function q(d,k){var l,a;l=m(35632,d.fragId);a=m(35633,d.vertId);var u=d.program=h.createProgram();h.attachShader(u,l);h.attachShader(u,a);h.linkProgram(u);var z=h.getProgramParameter(u,35718),g=d.uniforms;for(l=0;l<z;++l)if(a=h.getActiveUniform(u,l))if(1<a.size)for(var F=0;F<a.size;++F){var w=a.name.replace("[0]",
"["+F+"]");b(g,new c(w,e.id(w),h.getUniformLocation(u,w),a))}else b(g,new c(a.name,e.id(a.name),h.getUniformLocation(u,a.name),a));z=h.getProgramParameter(u,35721);g=d.attributes;for(l=0;l<z;++l)(a=h.getActiveAttrib(u,l))&&b(g,new c(a.name,e.id(a.name),h.getAttribLocation(u,a.name),a))}var w={},u={},z={},K=[],L=0;return{clear:function(){var b=h.deleteShader.bind(h);k(w).forEach(b);w={};k(u).forEach(b);u={};K.forEach(function(b){h.deleteProgram(b.program)});K.length=0;z={};d.shaderCount=0},refresh:function(){w=
{};u={};K.forEach(q)},program:function(b,c,h){d.shaderCount++;var a=z[c];a||(a=z[c]={});var e=a[b];e||(e=new l(c,b),q(e,h),a[b]=e,K.push(e));return e},shader:m,frag:null,vert:null}}},{"./util/values":31}],17:[function(e,l,q){l.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(e,l,q){l.exports=function(){var e={"":0},h=[""];return{id:function(l){var d=e[l];if(d)return d;d=e[l]=h.length;h.push(l);
return d},str:function(e){return h[e]}}}},{}],19:[function(e,l,q){function k(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function h(a){return Array.isArray(a)&&0!==a.length&&z(a[0])?!0:!1}function t(a){return Object.prototype.toString.call(a)}function d(a){if(!a)return!1;var b=t(a);return 0<=r.indexOf(b)?!0:k(a)||h(a)||O(a)}function c(a,b){36193===a.type?(a.data=u(b),w.freeType(b)):a.data=b}var b=e("./util/extend"),m=e("./util/values"),F=e("./util/is-typed-array"),O=e("./util/is-ndarray"),
w=e("./util/pool"),u=e("./util/to-half-float"),z=e("./util/is-array-like");q=e("./constants/arraytypes.json");var K=e("./constants/arraytypes.json"),L=[9984,9986,9985,9987],B=[0,6409,6410,6407,6408],J={};J[6409]=J[6406]=J[6402]=1;J[34041]=J[6410]=2;J[6407]=3;J[6408]=4;var r=Object.keys(q).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);l.exports=function(a,e,l,g,r,q){function S(){this.format=this.internalformat=6408;
this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function x(a,b){a.internalformat=b.internalformat;a.format=b.format;a.type=b.type;a.compressed=b.compressed;a.premultiplyAlpha=b.premultiplyAlpha;a.flipY=b.flipY;a.unpackAlignment=b.unpackAlignment;a.colorSpace=b.colorSpace;a.width=b.width;a.height=b.height;a.channels=b.channels}function M(a,b){if("object"===typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=
b.premultiplyAlpha);"flipY"in b&&(a.flipY=b.flipY);"alignment"in b&&(a.unpackAlignment=b.alignment);"colorSpace"in b&&(a.colorSpace=Ba[b.colorSpace]);"type"in b&&(a.type=ha[b.type]);var c=a.width,d=a.height,g=a.channels,e=!1;"shape"in b?(c=b.shape[0],d=b.shape[1],3===b.shape.length&&(g=b.shape[2],e=!0)):("radius"in b&&(c=d=b.radius),"width"in b&&(c=b.width),"height"in b&&(d=b.height),"channels"in b&&(g=b.channels,e=!0));a.width=c|0;a.height=d|0;a.channels=g|0;c=!1;"format"in b&&(c=b.format,d=a.internalformat=
da[c],a.format=Ca[d],c in ha&&!("type"in b)&&(a.type=ha[c]),c in ea&&(a.compressed=!0),c=!0);!e&&c?a.channels=J[a.format]:e&&!c&&a.channels!==B[a.format]&&(a.format=a.internalformat=B[a.channels])}}function C(f){a.pixelStorei(37440,f.flipY);a.pixelStorei(37441,f.premultiplyAlpha);a.pixelStorei(37443,f.colorSpace);a.pixelStorei(3317,f.unpackAlignment)}function y(){S.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function Q(a,b){var g=null;
d(b)?g=b:b&&(M(a,b),"x"in b&&(a.xOffset=b.x|0),"y"in b&&(a.yOffset=b.y|0),d(b.data)&&(g=b.data));if(b.copy){var e=r.viewportWidth,m=r.viewportHeight;a.width=a.width||e-a.xOffset;a.height=a.height||m-a.yOffset;a.needsCopy=!0}else if(!g)a.width=a.width||1,a.height=a.height||1;else if(F(g))a.data=g,"type"in b||5121!==a.type||(a.type=K[Object.prototype.toString.call(g)]|0);else if(k(g)){e=g;m=a.width*a.height*a.channels;switch(a.type){case 5121:case 5123:case 5125:case 5126:m=w.allocType(a.type,m);m.set(e);
a.data=m;break;case 36193:a.data=u(e)}a.alignment=1;a.needsFree=!0}else if(O(g)){e=g.data;Array.isArray(e)||5121!==a.type||(a.type=K[Object.prototype.toString.call(e)]|0);var m=g.shape,l=g.stride,q,x,C,y;3===m.length?(C=m[2],y=l[2]):y=C=1;q=m[0];x=m[1];m=l[0];l=l[1];a.alignment=1;a.width=q;a.height=x;a.channels=C;a.format=a.internalformat=B[C];a.needsFree=!0;q=y;g=g.offset;C=a.width;y=a.height;x=a.channels;for(var n=w.allocType(36193===a.type?5126:a.type,C*y*x),G=0,P=0;P<y;++P)for(var D=0;D<C;++D)for(var E=
0;E<x;++E)n[G++]=e[m*D+l*P+q*E+g];c(a,n)}else if("[object HTMLCanvasElement]"===t(g)||"[object CanvasRenderingContext2D]"===t(g))"[object HTMLCanvasElement]"===t(g)?a.element=g:a.element=g.canvas,a.width=a.element.width,a.height=a.element.height;else if("[object HTMLImageElement]"===t(g))a.element=g,a.width=g.naturalWidth,a.height=g.naturalHeight;else if("[object HTMLVideoElement]"===t(g))a.element=g,a.width=g.videoWidth,a.height=g.videoHeight,a.needsPoll=!0;else if(h(g)){e=g[0].length;m=g.length;
l=1;if(z(g[0][0])){q=l=g[0][0].length;C=w.allocType(36193===a.type?5126:a.type,e*m*q);for(x=y=0;x<m;++x)for(n=g[x],G=0;G<e;++G)for(P=n[G],D=0;D<q;++D)C[y++]=P[D];c(a,C)}else{q=w.allocType(36193===a.type?5126:a.type,e*m);for(y=C=0;y<m;++y)for(x=g[y],n=0;n<e;++n)q[C++]=x[n];c(a,q)}a.alignment=1;a.width=e;a.height=m;a.channels=l;a.format=a.internalformat=B[l];a.needsFree=!0}}function aa(b,c,d,e,h){var k=b.element,m=b.data,l=b.internalformat,r=b.format,t=b.type,n=b.width,u=b.height;C(b);k?a.texSubImage2D(c,
h,d,e,r,t,k):b.compressed?a.compressedTexSubImage2D(c,h,d,e,l,n,u,m):b.needsCopy?(g(),a.copyTexSubImage2D(c,h,d,e,b.xOffset,b.yOffset,n,u)):a.texSubImage2D(c,h,d,e,n,u,r,t,m)}function D(){return Da.pop()||new y}function la(a){a.needsFree&&w.freeType(a.data);y.call(a);Da.push(a)}function Fa(){S.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function U(a,b,c){var d=a.images[0]=D();a.mipmask=1;d.width=a.width=b;d.height=a.height=c}function N(a,b){var c=null;if(d(b))c=
a.images[0]=D(),x(c,a),Q(c,b),a.mipmask=1;else if(M(a,b),Array.isArray(b.mipmap))for(var g=b.mipmap,e=0;e<g.length;++e)c=a.images[e]=D(),x(c,a),c.width>>=e,c.height>>=e,Q(c,g[e]),a.mipmask|=1<<e;else c=a.images[0]=D(),x(c,a),Q(c,b),a.mipmask=1;x(a,a.images[0])}function H(b,c){for(var d=b.images,e=0;e<d.length&&d[e];++e){var h=d[e],k=c,m=e,l=h.element,r=h.data,t=h.internalformat,n=h.format,u=h.type,q=h.width,z=h.height;C(h);l?a.texImage2D(k,m,n,n,u,l):h.compressed?a.compressedTexImage2D(k,m,t,q,z,
0,r):h.needsCopy?(g(),a.copyTexImage2D(k,m,n,h.xOffset,h.yOffset,q,z,0)):a.texImage2D(k,m,n,q,z,0,n,u,r)}}function Y(){var a=Ea.pop()||new Fa;S.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function fa(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&la(b[c]),b[c]=null;Ea.push(a)}function oa(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function qa(a,b){"min"in b&&(a.minFilter=ra[b.min],0<=L.indexOf(a.minFilter)&&
(a.genMipmaps=!0));"mag"in b&&(a.magFilter=ta[b.mag]);var c=a.wrapS,d=a.wrapT;if("wrap"in b){var g=b.wrap;"string"===typeof g?c=d=X[g]:Array.isArray(g)&&(c=X[g[0]],d=X[g[1]])}else"wrapS"in b&&(c=X[b.wrapS]),"wrapT"in b&&(d=X[b.wrapT]);a.wrapS=c;a.wrapT=d;"anisotropic"in b&&(a.anisotropic=b.anisotropic);if("mipmap"in b){c=!1;switch(typeof b.mipmap){case "string":a.mipmapHint=W[b.mipmap];c=a.genMipmaps=!0;break;case "boolean":c=a.genMipmaps=b.mipmap;break;case "object":a.genMipmaps=!1,c=!0}!c||"min"in
b||(a.minFilter=9984)}}function ga(b,c){a.texParameteri(c,10241,b.minFilter);a.texParameteri(c,10240,b.magFilter);a.texParameteri(c,10242,b.wrapS);a.texParameteri(c,10243,b.wrapT);e.ext_texture_filter_anisotropic&&a.texParameteri(c,34046,b.anisotropic);b.genMipmaps&&(a.hint(33170,b.mipmapHint),a.generateMipmap(c))}function pa(){var a=sa.pop()||new oa;oa.call(a);return a}function ja(b){S.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ha++;this.refCount=1;this.target=b;this.texture=a.createTexture();
this.unit=-1;this.bindCount=0}function ca(b){a.activeTexture(33984);a.bindTexture(b.target,b.texture)}function ka(){var b=ba[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function Z(b){var c=b.texture,d=b.unit,g=b.target;0<=d&&(a.activeTexture(33984+d),a.bindTexture(g,null),ba[d]=null);a.deleteTexture(c);b.texture=null;b.params=null;b.pixels=null;b.refCount=0;delete va[b.id]}var W={"don't care":4352,"dont care":4352,nice:4354,fast:4353},X={repeat:10497,clamp:33071,mirror:33648},
ta={nearest:9728,linear:9729},ra=b({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ta),Ba={none:0,browser:37444},ha={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},da={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ea={};e.ext_srgb&&(da.srgb=35904,da.srgba=35906);e.oes_texture_float&&(ha["float"]=5126);e.oes_texture_half_float&&(ha.float16=ha["half float"]=
36193);e.webgl_depth_texture&&(b(da,{depth:6402,"depth stencil":34041}),b(ha,{uint16:5123,uint32:5125,"depth stencil":34042}));e.webgl_compressed_texture_s3tc&&b(ea,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});e.webgl_compressed_texture_atc&&b(ea,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});e.webgl_compressed_texture_pvrtc&&b(ea,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
e.webgl_compressed_texture_etc1&&(ea["rgb etc1"]=36196);var xa=Array.prototype.slice.call(a.getParameter(34467));Object.keys(ea).forEach(function(a){var b=ea[a];0<=xa.indexOf(b)&&(da[a]=b)});var ua=Object.keys(da);l.textureFormats=ua;var Ca=ua.reduce(function(a,b){var c=da[b];6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407;return a},{}),Da=[],Ea=[],sa=[],Ha=0,va={},ia=l.maxTextureUnits,ba=Array(ia).map(function(){return null});
b(ja.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<ia;++c){var d=ba[c];if(d){if(0<d.bindCount)continue;d.unit=-1}ba[c]=this;b=c;break}this.unit=b;a.activeTexture(33984+b);a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0===--this.refCount&&Z(this)}});return{create2D:function(a,b){function c(a,b){var f=pa(),g=Y();"number"===typeof a?"number"===typeof b?U(g,a|0,b|0):U(g,a|0,a|0):a?(qa(f,a),N(g,a)):U(g,1,1);
f.genMipmaps&&(g.mipmask=(g.width<<1)-1);d.mipmask=g.mipmask;x(d,g);d.internalformat=g.internalformat;c.width=g.width;c.height=g.height;ca(d);H(g,3553);ga(f,3553);ka();sa.push(f);fa(g);return c}var d=new ja(3553);va[d.id]=d;q.textureCount++;c(a,b);c.subimage=function(a,b,f,g){b|=0;f|=0;g|=0;var e=D();x(e,d);e.width>>=g;e.height>>=g;e.width-=b;e.height-=f;Q(e,a);ca(d);aa(e,3553,b,f,g);ka();la(e);return c};c._reglType="texture2d";c._texture=d;c.destroy=function(){d.decRef()};return c},createCube:function(a,
b,c,d,g,e){function h(a,b,c,d,f,g){var e,l=pa();for(e=0;6>e;++e)m[e]=Y();if("number"===typeof a||!a)for(a=a|0||1,e=0;6>e;++e)U(m[e],a,a);else if("object"===typeof a)if(b)N(m[0],a),N(m[1],b),N(m[2],c),N(m[3],d),N(m[4],f),N(m[5],g);else if(qa(l,a),M(k,a),"faces"in a)for(a=a.faces,e=0;6>e;++e)x(m[e],k),N(m[e],a[e]);else for(e=0;6>e;++e)N(m[e],a);x(k,m[0]);k.mipmask=l.genMipmaps?(m[0].width<<1)-1:m[0].mipmask;k.internalformat=m[0].internalformat;h.width=m[0].width;h.height=m[0].height;ca(k);for(e=0;6>
e;++e)H(m[e],34069+e);ga(l,34067);ka();sa.push(l);for(e=0;6>e;++e)fa(m[e]);return h}var k=new ja(34067);va[k.id]=k;q.cubeCount++;var m=Array(6);h(a,b,c,d,g,e);h.subimage=function(a,b,c,d,f){c|=0;d|=0;f|=0;var g=D();x(g,k);g.width>>=f;g.height>>=f;g.width-=c;g.height-=d;Q(g,b);ca(k);aa(g,34069+a,c,d,f);ka();la(g);return h};h._reglType="textureCube";h._texture=k;h.destroy=function(){k.decRef()};return h},clear:function(){for(var b=0;b<ia;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ba[b]=null;
m(va).forEach(Z);q.cubeCount=0;q.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(e,l,q){l.exports=function(e,h){function l(){this.endQueryIndex=this.startQueryIndex=-1;this.stats=null}var d=h.ext_disjoint_timer_query;if(!d)return null;var c=[],b=[],m,q,O=[],w=[];return{beginQuery:function(b){m=
b;q=O.pop()||d.createQueryEXT();d.beginQueryEXT(d.TIME_ELAPSED_EXT,q)},endQuery:function(){d.endQueryEXT(d.TIME_ELAPSED_EXT);var e=w.pop()||new l;e.startQueryIndex=c.length;e.endQueryIndex=e.startQueryIndex;e.stats=m;b.push(e);c.push(q)},update:function(){if(0!==c.length){var e=[],h,m;for(h=0;h<c.length;h++)e[h]=1E-6*d.getQueryObjectEXT(c[h],d.QUERY_RESULT_EXT),O.push(c[h]);c=[];for(h=0;h<b.length;h++){var k=b[h];for(m=k.startQueryIndex;m<=k.endQueryIndex;m++)k.stats.gpuTime+=e[m];w.push(k)}b=[]}},
getNumPendingQueries:function(){return c.length},pushScopeStats:function(c,d,e){var h=w.pop()||new l;h.startQueryIndex=c;h.endQueryIndex=d;h.stats=e;b.push(h)},clear:function(){for(var b=0;b<O.length;b++)d.deleteQueryEXT(O[b])}}}},{}],21:[function(e,l,q){l.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(e,l,q){function k(d){return Array.prototype.slice.call(d)}function h(d){return k(d).join("")}var t=e("./extend");
l.exports=function(){function d(){var c=[],d=[];return t(function(){c.push.apply(c,k(arguments))},{def:function(){var e="v"+b++;d.push(e);0<arguments.length&&(c.push(e,"="),c.push.apply(c,k(arguments)),c.push(";"));return e},toString:function(){return h([0<d.length?"var "+d+";":"",h(c)])}})}function c(){function b(d,h){e(d,h,"=",c.def(d,h),";")}var c=d(),e=d(),h=c.toString,k=e.toString;return t(c,{entry:c,exit:e,save:b,set:function(d,e,a){b(d,e);c(d,e,"=",a,";")},toString:function(){return h()+k()}})}
var b=0,e=[],l=[],q=d(),w={};return{global:q,link:function(c){for(var d=0;d<l.length;++d)if(l[d]===c)return e[d];d="g"+b++;e.push(d);l.push(c);return d},block:d,proc:function(b,d){function e(){var b="a"+k.length;k.push(b);return b}var k=[];d=d||0;for(var m=0;m<d;++m)e();var m=c(),l=m.toString;return w[b]=t(m,{arg:e,toString:function(){return h(["function(",k.join(),"){",l(),"}"])}})},scope:c,cond:function(){var b=h(arguments),d=c(),e=c(),m=d.toString,l=e.toString;return t(d,{then:function(){d.apply(d,
k(arguments));return this},"else":function(){e.apply(e,k(arguments));return this},toString:function(){var c=l();c&&(c="else{"+c+"}");return h(["if(",b,"){",m(),"}",c])}})},compile:function(){var b=['"use strict";',q,"return {"];Object.keys(w).forEach(function(c){b.push('"',c,'":',w[c].toString(),",")});b.push("}");var c=h(b).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,e.concat(c)).apply(null,l)}}}},{"./extend":23}],23:[function(e,l,q){l.exports=function(e,
h){for(var l=Object.keys(h),d=0;d<l.length;++d)e[l[d]]=h[l[d]];return e}},{}],24:[function(e,l,q){var k=e("./is-typed-array");l.exports=function(e){return Array.isArray(e)||k(e)}},{"./is-typed-array":26}],25:[function(e,l,q){var k=e("./is-typed-array");l.exports=function(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||k(e.data))}},{"./is-typed-array":26}],26:[function(e,l,q){var k=
e("../constants/arraytypes.json");l.exports=function(e){return Object.prototype.toString.call(e)in k}},{"../constants/arraytypes.json":4}],27:[function(e,l,q){l.exports=function(e,h){for(var l=Array(e),d=0;d<e;++d)l[d]=h(d);return l}},{}],28:[function(e,l,q){function k(c){var b,d;b=(65535<c)<<4;c>>>=b;d=(255<c)<<3;c>>>=d;b|=d;d=(15<c)<<2;c>>>=d;b|=d;d=(3<c)<<1;return b|d|c>>>d>>1}function h(c){a:{for(var b=16;268435456>=b;b*=16)if(c<=b){c=b;break a}c=0}b=d[k(c)>>2];return 0<b.length?b.pop():new ArrayBuffer(c)}
function t(c){d[k(c.byteLength)>>2].push(c)}var d=e("./loop")(8,function(){return[]});l.exports={alloc:h,free:t,allocType:function(c,b){var d=null;switch(c){case 5120:d=new Int8Array(h(b),0,b);break;case 5121:d=new Uint8Array(h(b),0,b);break;case 5122:d=new Int16Array(h(2*b),0,b);break;case 5123:d=new Uint16Array(h(2*b),0,b);break;case 5124:d=new Int32Array(h(4*b),0,b);break;case 5125:d=new Uint32Array(h(4*b),0,b);break;case 5126:d=new Float32Array(h(4*b),0,b);break;default:return null}return d.length!==
b?d.subarray(0,b):d},freeType:function(c){t(c.buffer)}}},{"./loop":27}],29:[function(e,l,q){l.exports="function"===typeof requestAnimationFrame&&"function"===typeof cancelAnimationFrame?{next:function(e){return requestAnimationFrame(e)},cancel:function(e){return cancelAnimationFrame(e)}}:{next:function(e){setTimeout(e,30)},cancel:clearTimeout}},{}],30:[function(e,l,q){var k=e("./pool"),h=new Float32Array(1),t=new Uint32Array(h.buffer);l.exports=function(d){for(var c=k.allocType(5123,d.length),b=0;b<
d.length;++b)if(isNaN(d[b]))c[b]=65535;else if(Infinity===d[b])c[b]=31744;else if(-Infinity===d[b])c[b]=64512;else{h[0]=d[b];var e=t[0],l=e>>>31<<15,q=(e<<1>>>24)-127,e=e>>13&1023;c[b]=-24>q?l:-14>q?l+(e+1024>>-14-q):15<q?l+31744:l+(q+15<<10)+e}return c}},{"./pool":28}],31:[function(e,l,q){l.exports=function(e){return Object.keys(e).map(function(h){return e[h]})}},{}],32:[function(e,l,q){function k(d,c){function b(){var b=window.innerWidth,c=window.innerHeight;d!==document.body&&(c=d.getBoundingClientRect(),
b=c.right-c.left,c=c.top-c.bottom);e.width=l*b;e.height=l*c;t(e.style,{width:b+"px",height:c+"px"})}var e=document.createElement("canvas"),k=h(e,c);t(e.style,{border:0,margin:0,padding:0,top:0,left:0});d.appendChild(e);d===document.body&&(e.style.position="absolute",t(d.style,{margin:0,padding:0}));var l=+k.options.pixelRatio;window.addEventListener("resize",b,!1);var q=k.options.onDestroy;k.options=t(t({},k.options),{onDestroy:function(){window.removeEventListener("resize",b);d.removeChild(e);q&&
q()}});b();return k}function h(d,c){function b(b){try{return d.getContext(b,e)}catch(c){return null}}var e=c.glOptions||{};return{gl:b("webgl")||b("experimental-webgl")||b("webgl-experimental"),options:t({pixelRatio:window.devicePixelRatio},c)}}var t=e("./util/extend");l.exports=function(d){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:d[0],options:d[1]||{}};var c=document.body,b=d[1]||{};if("string"===typeof d[0])c=document.querySelector(d[0])||document.body;else if("object"===
typeof d[0])if(d[0]instanceof HTMLElement)c=d[0];else{if(d[0]instanceof WebGLRenderingContext)return{gl:d[0],options:t({pixelRatio:1},b)};b=d[0]}return c.nodeName&&"CANVAS"===c.nodeName.toUpperCase()?h(c,b):k(c,b)}},{"./util/extend":23}],33:[function(e,l,q){function k(b){throw Error("resl: "+b);}function h(b,c,d){Object.keys(b).forEach(function(b){0>c.indexOf(b)&&k('invalid parameter "'+b+'" in '+d)})}function t(b,c){this.state=0;this.ready=!1;this.progress=0;this.name=b;this.cancel=c}var d=["manifest",
"onDone","onProgress","onError"],c=["type","src","stream","credentials","parser"],b=["onData","onDone"];l.exports=function(e){function l(a,b){if(a in e){var c=e[a];"function"!==typeof c&&k('invalid callback "'+a+'"');return c}return null}function q(a){function b(){if(!(2>k.readyState||1===m.state||-1===m.state)){if(200!==k.status)return u('error loading resource "'+a.name+'"');if(2<k.readyState&&0===m.state){var d;d="binary"===a.type?k.response:k.responseText;if(h.data)try{l=h.data(d)}catch(e){return u(e)}else l=
d}if(3<k.readyState&&0===m.state){if(h.done)try{l=h.done()}catch(e){return u(e)}m.state=1}r[c]=l;m.progress=.75*m.progress+.25;m.ready=a.stream&&!!l||1===m.state;z()}}var c=a.name,d=a.stream,e="binary"===a.type,h=a.parser,k=new XMLHttpRequest,l=null,m=new t(c,function(){1!==m.state&&-1!==m.state&&(k.onreadystatechange=null,k.abort(),m.state=-1)});k.onreadystatechange=d?b:function(){4===k.readyState&&b()};e&&(k.responseType="arraybuffer");a.credentials&&(k.withCredentials=!0);k.open("GET",a.src,!0);
k.send();return m}function w(a,b){function c(){if(0===q.state)if(m.data)try{w=m.data(b)}catch(a){return u(a)}else w=b}function d(b){c();r[l]=w;q.progress=b.lengthComputable?Math.max(q.progress,b.loaded/b.total):.75*q.progress+.25;q.ready=a.stream;z(l)}function e(){c();if(0===q.state){if(m.done)try{w=m.done()}catch(a){return u(a)}q.state=1}q.progress=1;q.ready=!0;r[l]=w;k();z("finish "+l)}function h(){u('error loading asset "'+l+'"')}function k(){a.stream&&b.removeEventListener("progress",d);"image"===
a.type?b.addEventListener("load",e):b.addEventListener("canplay",e);b.removeEventListener("error",h)}var l=a.name,m=a.parser,q=new t(l,function(){1!==q.state&&-1!==q.state&&(q.state=-1,k(),b.src="")}),w=b;a.stream&&b.addEventListener("progress",d);"image"===a.type?b.addEventListener("load",e):b.addEventListener("canplay",e);b.addEventListener("error",h);b.crossOrigin=a.credentials?"use-credentials":"anonymous";b.src=a.src;return q}function u(b){-1!==a&&1!==a&&(a=-1,R.forEach(function(a){a.cancel()}),
J?"string"===typeof b?J(Error("resl: "+b)):J(b):console.error("resl error:",b))}function z(b){if(-1!==a&&1!==a){var c=0,d=0;R.forEach(function(a){a.ready&&(d+=1);c+=a.progress});d===R.length?(a=1,L(r)):B&&B(c/R.length,b)}}"object"===typeof e&&e||k("invalid or missing configuration");h(e,d,"config");var K=e.manifest;"object"===typeof K&&K||k("missing manifest");var L=l("onDone");L||k("missing onDone() callback");var B=l("onProgress"),J=l("onError"),r={},a=0,V={text:q,binary:function(a){return q(a)},
image:function(a){return w(a,document.createElement("img"))},video:function(a){return w(a,document.createElement("video"))},audio:function(a){return w(a,document.createElement("audio"))}},R=Object.keys(K).map(function(a){function d(a,b){if(a in e.parser){var c=e.parser[a];"function"!==typeof c&&k("invalid parser callback "+a+' for asset "'+a+'"');return c}return b}var e=K[a];"string"===typeof e?e={src:e}:"object"===typeof e&&e||k('invalid asset definition "'+a+'"');h(e,c,'asset "'+a+'"');var l={};
"parser"in e&&("function"===typeof e.parser?l={data:e.parser}:"object"===typeof e.parser&&e.parser?(h(l,b,'parser for asset "'+a+'"'),"onData"in l||k('missing onData callback for parser in asset "'+a+'"'),l={data:d("onData"),done:d("onDone")}):k('invalid parser for asset "'+a+'"'));return{name:a,type:function(b,c,d){b in e&&(d=e[b]);0>c.indexOf(d)&&k("invalid "+b+' "'+d+'" for asset "'+a+'", possible values: '+c);return d}("type",Object.keys(V),"text"),stream:!!e.stream,credentials:!!e.credentials,
src:function(b,c,d){b in e?d=e[b]:c&&k("missing "+b+' for asset "'+a+'"');"string"!==typeof d&&k("invalid "+b+' for asset "'+a+'", must be a string');return d}("src",!0,""),parser:l}}).map(function(a){return V[a.type](a)})}},{}],34:[function(e,l,q){var k=e("./lib/util/extend"),h=e("./lib/dynamic"),t=e("./lib/util/raf"),d=e("./lib/util/clock"),c=e("./lib/strings"),b=e("./lib/webgl"),m=e("./lib/extension"),F=e("./lib/limits"),O=e("./lib/buffer"),w=e("./lib/elements"),u=e("./lib/texture"),z=e("./lib/renderbuffer"),
K=e("./lib/framebuffer"),L=e("./lib/attribute"),B=e("./lib/shader"),J=e("./lib/read"),r=e("./lib/core"),a=e("./lib/stats"),V=e("./lib/timer");l.exports=function(){function e(){X=t.next(e);H.tick+=1;H.time=(d()-Fa)/1E3;x();for(var a=0;a<W.length;++a)(0,W[a])(H,null,0);y.flush()}function g(a){}function l(a){}function q(a){function b(a){var c={},d={};Object.keys(a).forEach(function(b){var e=a[b];h.isDynamic(e)?d[b]=h.unbox(e,b):c[b]=e});return{dynamic:d,"static":c}}function c(a){for(;u.length<a;)u.push(null);
return u}var d=b(a.context||{}),e=b(a.uniforms||{}),g=b(a.attributes||{}),l=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=k({},a);delete c.uniforms;delete c.attributes;delete c.context;b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(a));a={gpuTime:0};var d=ca.compile(l,g,e,d,a),m=d.draw,r=d.batch,t=d.scope,u=[];return k(function(a,b){var d;if("function"===typeof a)return t.call(this,
null,a,0);if("function"===typeof b)if("number"===typeof a)for(d=0;d<a;++d)t.call(this,null,b,d);else if(Array.isArray(a))for(d=0;d<a.length;++d)t.call(this,a[d],b,d);else return t.call(this,a,b,0);else if("number"===typeof a){if(0<a)return r.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return r.call(this,a,a.length)}else return m.call(this,a)},{stats:a})}function S(){var a=ka.viewport,b=ka.scissor_box;a[0]=a[1]=b[0]=b[1]=0;H.viewportWidth=H.frameBufferWidth=H.drawingBufferWidth=a[2]=
b[2]=y.drawingBufferWidth;H.viewportHeight=H.frameBufferWidth=H.drawingBufferHeight=a[3]=b[3]=y.drawingBufferHeight}function x(){S();ca.procs.poll()}function M(){S();ca.procs.refresh()}var C=b(Array.prototype.slice.call(arguments)),y=C.gl,Q=C.options,C=c(),aa=a(),D=m(y).extensions,la=V(y,D),Fa=d(),U=y.drawingBufferWidth,N=y.drawingBufferHeight,H={tick:0,time:0,viewportWidth:U,viewportHeight:N,framebufferWidth:U,framebufferHeight:N,drawingBufferWidth:U,drawingBufferHeight:N,pixelRatio:Q.pixelRatio},
Y=F(y,D),fa=O(y,aa),oa=w(y,D,fa,aa),U=L(y,D,Y,fa,C),qa=B(y,C,aa),ga=u(y,D,Y,x,H,aa),pa=z(y,D,Y,aa),ja=K(y,D,Y,ga,pa,aa),N=J(y,x,H),ca=r(y,C,D,Y,fa,oa,ga,ja,{},U,qa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},H,la),ka=ca.next,Z=y.canvas,W=[],X=0;Z&&(Z.addEventListener("webglcontextlost",g,!1),Z.addEventListener("webglcontextrestored",l,!1));M();return k(q,{clear:function(a){var b=0;ca.procs.poll();var c=a.color;c&&(y.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),b|=16384);"depth"in
a&&(y.clearDepth(+a.depth),b|=256);"stencil"in a&&(y.clearStencil(a.stencil|0),b|=1024);y.clear(b)},prop:h.define.bind(null,1),context:h.define.bind(null,2),"this":h.define.bind(null,3),draw:q({}),buffer:function(a){return fa.create(a,34962)},elements:oa.create,texture:ga.create2D,cube:ga.createCube,renderbuffer:pa.create,framebuffer:ja.create,framebufferCube:function(a){},attributes:y.getContextAttributes(),frame:function(a){W.push(a);!X&&0<W.length&&e();return{cancel:function(){var b=W.find(function(b){return b===
a});0>b||(W.splice(b,1),0>=W.length&&X&&(t.cancel(e),X=0))}}},limits:Y,hasExtension:function(a){return 0<=Y.extensions.indexOf(a.toLowerCase())},read:N,destroy:function(){X&&(t.cancel(e),X=0);Z&&(Z.removeEventListener("webglcontextlost",g),Z.removeEventListener("webglcontextrestored",l));qa.clear();ja.clear();pa.clear();ga.clear();oa.clear();fa.clear();la&&la.clear();if(Q.onDestroy)Q.onDestroy()},_gl:y,_refresh:M,stats:aa,updateTimer:function(){la.update()}})}},{"./lib/attribute":2,"./lib/buffer":3,
"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}]},{},[1]);

        </script>
        </body>
      </html>