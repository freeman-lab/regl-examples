<!DOCTYPE html>
      <html>
        <head>
          <title>example/video.js</title>
          <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
          <meta charset=utf-8>
        </head>
        <body>
        <script type='text/javascript'>
        (function e$$0(p,w,h){function m(a,e){if(!w[a]){if(!p[a]){var g="function"==typeof require&&require;if(!e&&g)return g(a,!0);if(q)return q(a,!0);g=Error("Cannot find module '"+a+"'");throw g.code="MODULE_NOT_FOUND",g;}g=w[a]={exports:{}};p[a][0].call(g.exports,function(g){var e=p[a][1][g];return m(e?e:g)},g,g.exports,e$$0,p,w,h)}return w[a].exports}for(var q="function"==typeof require&&require,g=0;g<h.length;g++)m(h[g]);return m})({1:[function(f,p,w){var h=f("../regl")(),m=h({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform vec2 screenShape;\n  uniform float time;\n\n  varying vec2 uv;\n\n  vec4 background () {\n    vec2 pos = 0.5 - gl_FragCoord.xy / screenShape;\n    float r = length(pos);\n    float theta = atan(pos.y, pos.x);\n    return vec4(\n      cos(pos.x * time) + sin(pos.y * pos.x * time),\n      cos(100.0 * r * cos(0.3 * time) + theta),\n      sin(time / r + pos.x * cos(10.0 * time + 3.0)),\n      1);\n  }\n\n  void main () {\n    vec4 color = texture2D(texture, uv);\n    float chromakey = step(0.15 + max(color.r, color.b), color.g);\n    gl_FragColor = mix(color, background(), chromakey);\n  }",
vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(1.0 - 2.0 * position, 0, 1);\n  }",attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:h.prop("video"),screenShape:function(h){return[h.viewportWidth,h.viewportHeight]},time:h.context("time")},count:3});f("resl")({manifest:{video:{type:"video",src:"assets/doggie-chromakey.ogv",stream:!0}},onDone:function(q){var g=q.video;g.autoplay=!0;g.loop=!0;g.play();
var a=h.texture(g);h.frame(function(){h.updateTimer();m({video:a.subimage(g)})})}})},{"../regl":33,resl:34}],2:[function(f,p,w){function h(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}p.exports=function(m,q,g,a,e){m=g.maxAttributes;q=Array(m);for(g=0;g<m;++g)q[g]=new h;return{Record:h,scope:{},state:q}}},{}],3:[function(f,p,w){function h(a){return A[Object.prototype.toString.call(a)]|0}function m(a,
g){for(var e=0;e<g.length;++e)a[e]=g[e]}function q(a,g,e,h,m,q,c){for(var f=0,n=0;n<e;++n)for(var d=0;d<h;++d)a[f++]=g[m*n+q*d+c]}function g(a,g,e){for(var h=0,m=0;m<g.length;++m)for(var q=g[m],c=0;c<e;++c)a[h++]=q[c]}var a=f("./util/is-typed-array"),e=f("./util/is-ndarray"),n=f("./util/values"),F=f("./util/pool"),A=f("./constants/arraytypes.json"),u=f("./constants/dtypes.json"),x=f("./constants/usage.json");p.exports=function(f,p){function z(d){this.id=c++;this.buffer=f.createBuffer();this.type=
d;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121}function y(d,a,g){d.byteLength=a.byteLength;f.bufferData(d.type,a,g)}function K(d,c,f,n,t){d.usage=f;if(Array.isArray(c))d.dtype=n||5126,0<c.length&&(Array.isArray(c[0])?(d.dimension=c[0].length,n=F.allocType(d.dtype,c.length*d.dimension),g(n,c,d.dimension),y(d,n,f),F.freeType(n)):"number"===typeof c[0]?(d.dimension=t,n=F.allocType(d.dtype,c.length),m(n,c),y(d,n,f),F.freeType(n)):a(c[0])&&(d.dimension=c[0].length,d.dtype=n||h(c[0])||
5126,n=F.allocType(d.dtype,c.length*d.dimension),g(n,c,d.dimension),y(d,n,f),F.freeType(n)));else if(a(c))d.dtype=n||h(c),d.dimension=t,y(d,c,f);else if(e(c)){var x=c.shape,r=c.stride;t=c.offset;var C=0,R=0,S=0,H=0;1===x.length?(C=x[0],R=1,S=r[0],H=0):2===x.length&&(C=x[0],R=x[1],S=r[0],H=r[1]);d.dtype=n||h(c.data)||5126;d.dimension=R;n=F.allocType(d.dtype,C*R);q(n,c.data,C,R,S,H,t);y(d,n,f);F.freeType(n)}}function t(a){p.bufferCount--;f.deleteBuffer(a.buffer);a.buffer=null;delete O[a.id]}var c=0,
O={};z.prototype.bind=function(){f.bindBuffer(this.type,this.buffer)};z.prototype.destroy=function(){t(this)};var B=[];return{create:function(d,c,n){function y(d){var c=35044,g=null,h=0,m=0,n=1;Array.isArray(d)||a(d)||e(d)?g=d:"number"===typeof d?h=d|0:d&&("data"in d&&(g=d.data),"usage"in d&&(c=x[d.usage]),"type"in d&&(m=u[d.type]),"dimension"in d&&(n=d.dimension|0),"length"in d&&(h=d.length|0));B.bind();g?K(B,g,c,m,n):(f.bufferData(B.type,h,c),B.dtype=m||5121,B.usage=c,B.dimension=n,B.byteLength=
h);return y}p.bufferCount++;var B=new z(c);O[B.id]=B;n||y(d);y._reglType="buffer";y._buffer=B;y.subdata=function(d,c){var n=(c||0)|0;B.bind();if(Array.isArray(d)){if(0<d.length)if("number"===typeof d[0]){var t=F.allocType(B.dtype,d.length);m(t,d);f.bufferSubData(B.type,n,t);F.freeType(t)}else if(Array.isArray(d[0])||a(d[0])){var t=d[0].length,x=F.allocType(B.dtype,d.length*t);g(x,d,t);f.bufferSubData(B.type,n,x);F.freeType(x)}}else if(a(d))f.bufferSubData(B.type,n,d);else if(e(d)){var H=d.shape,z=
d.stride,p=x=t=0,J=0;1===H.length?(t=H[0],x=1,p=z[0],J=0):2===H.length&&(t=H[0],x=H[1],p=z[0],J=z[1]);H=Array.isArray(d.data)?B.dtype:h(d.data);H=F.allocType(H,t*x);q(H,d.data,t,x,p,J,d.offset);f.bufferSubData(B.type,n,H);F.freeType(H)}return y};y.destroy=function(){t(B)};return y},createStream:function(d,a){var c=B.pop();c||(c=new z(d),c.buffer=f.createBuffer());c.bind();K(c,a,35040,0,1);return c},destroyStream:function(d){B.push(d)},clear:function(){n(O).forEach(t)},getBuffer:function(d){return d&&
d._buffer instanceof z?d._buffer:null},_initBuffer:K}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/values":31}],4:[function(f,p,w){p.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,
"[object ArrayBuffer]":5121}},{}],5:[function(f,p,w){p.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(f,p,w){p.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(f,p,w){p.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(f,p,w){function h(a){return Array.isArray(a)||A(a)||u(a)}function m(a){return a.sort(function(d,
a){return"viewport"===d?-1:"viewport"===a?1:d<a?-1:1})}function q(a,d,c,g){this.thisDep=a;this.contextDep=d;this.propDep=c;this.append=g}function g(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function a(a){return new q(!1,!1,!1,a)}function e(a,d){var c=a.type;return 0===c?(c=a.data.length,new q(!0,1<=c,2<=c,d)):new q(3===c,2===c,1===c,d)}var n=f("./util/codegen"),F=f("./util/loop"),A=f("./util/is-typed-array"),u=f("./util/is-ndarray"),x=f("./util/is-array-like"),G=f("./constants/primitives.json"),
M=f("./constants/dtypes.json"),z=["x","y","z","w"],y={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},K={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,
"!=":517,"!==":517,gequal:518,">=":518,always:519},t={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},c={cw:2304,ccw:2305},O=new q(!1,!1,!1,function(){});p.exports=function(f,d,p,J,u,A,w,r,C,R,S,H,ea,ka){function T(l){return l.replace(".","_")}function P(l,b,d){var a=T(l);za.push(l);xa[a]=v[a]=!!d;oa[a]=b}function L(l,b,d){var a=T(l);za.push(l);Array.isArray(d)?(v[a]=d.slice(),xa[a]=d.slice()):v[a]=xa[a]=d;pa[a]=b}function X(){var l=
n(),b=l.link,a=l.global;l.id=Ja++;l.batchId="0";var c=b(Ha),E=l.shared={props:"a0"};Object.keys(Ha).forEach(function(k){E[k]=a.def(c,".",k)});var I=l.next={},g=l.current={};Object.keys(pa).forEach(function(k){Array.isArray(v[k])&&(I[k]=a.def(E.next,".",k),g[k]=a.def(E.current,".",k))});var k=l.constants={};Object.keys(Aa).forEach(function(l){k[l]=a.def(JSON.stringify(Aa[l]))});l.invoke=function(k,a){switch(a.type){case 0:var d=["this",E.context,E.props,l.batchId];return k.def(b(a.data),".call(",d.slice(0,
Math.max(a.data.length+1,4)),")");case 1:return k.def(E.props,a.data);case 2:return k.def(E.context,a.data);case 3:return k.def("this",a.data)}};l.attribCache={};var Fa={};l.scopeAttrib=function(k){k=d.id(k);if(k in Fa)return Fa[k];var l=R.scope[k];l||(l=R.scope[k]=new la);return Fa[k]=b(l)};return l}function ha(l){var b=l["static"];l=l.dynamic;if("framebuffer"in b){var d=b.framebuffer;return d?(d=r.getFramebuffer(d),a(function(l,b){var a=l.link(d),k=l.shared;b.set(k.framebuffer,".next",a);k=k.context;
b.set(k,".framebufferWidth",a+".width");b.set(k,".framebufferHeight",a+".height");return a})):a(function(l,b){var a=l.shared;b.set(a.framebuffer,".next","null");a=a.context;b.set(a,".framebufferWidth",a+".drawingBufferWidth");b.set(a,".framebufferHeight",a+".drawingBufferHeight");return"null"})}if("framebuffer"in l){var c=l.framebuffer;return e(c,function(l,b){var a=l.invoke(b,c),k=l.shared,d=k.framebuffer,a=b.def(d,".getFramebuffer(",a,")");b.set(d,".next",a);k=k.context;b.set(k,".framebufferWidth",
a+"?"+a+".width:"+k+".drawingBufferWidth");b.set(k,".framebufferHeight",a+"?"+a+".height:"+k+".drawingBufferHeight");return a})}return null}function qa(l,b){function a(k){if(k in d){var l=d[k];k=!0;var Ia=l.x|0,I=l.y|0,g,V;"width"in l?g=l.width|0:k=!1;"height"in l?V=l.height|0:k=!1;return new q(!k&&b&&b.thisDep,!k&&b&&b.contextDep,!k&&b&&b.propDep,function(k,b){var a=k.shared.context,d=g;"width"in l||(d=b.def(a,".","framebufferWidth","-",Ia));var c=V;"height"in l||(c=b.def(a,".","framebufferHeight",
"-",I));return[Ia,I,d,c]})}if(k in c){var h=c[k];k=e(h,function(k,b){var l=k.invoke(b,h),a=k.shared.context,d=b.def(l,".x|0"),c=b.def(l,".y|0"),N=b.def('"width" in ',l,"?",l,".width|0:","(",a,".","framebufferWidth","-",d,")"),l=b.def('"height" in ',l,"?",l,".height|0:","(",a,".","framebufferHeight","-",c,")");return[d,c,N,l]});b&&(k.thisDep=k.thisDep||b.thisDep,k.contextDep=k.contextDep||b.contextDep,k.propDep=k.propDep||b.propDep);return k}return b?new q(b.thisDep,b.contextDep,b.propDep,function(k,
b){var l=k.shared.context;return[0,0,b.def(l,".","framebufferWidth"),b.def(l,".","framebufferHeight")]}):null}var d=l["static"],c=l.dynamic,I=a("viewport");if(I)var g=I,I=new q(I.thisDep,I.contextDep,I.propDep,function(k,b){var l=g.append(k,b),a=k.shared.context;b.set(a,".viewportWidth",l[2]);b.set(a,".viewportHeight",l[3]);return l});return{viewport:I,scissor_box:a("scissor.box")}}function sa(b){function c(k){if(k in V){var b=d.id(V[k]);k=a(function(){return b});k.id=b;return k}if(k in h){var l=
h[k];return e(l,function(k,b){var a=k.invoke(b,l);return b.def(k.shared.strings,".id(",a,")")})}return null}var V=b["static"],h=b.dynamic,E=c("frag"),I=c("vert"),v=null;g(E)&&g(I)?(v=S.program(I.id,E.id),b=a(function(k,b){return k.link(v)})):b=new q(E&&E.thisDep||I&&I.thisDep,E&&E.contextDep||I&&I.contextDep,E&&E.propDep||I&&I.propDep,function(k,b){var l=k.shared.shader,a;a=E?E.append(k,b):b.def(l,".","frag");var d;d=I?I.append(k,b):b.def(l,".","vert");return b.def(l+".program("+d+","+a+")")});return{frag:E,
vert:I,progVar:b,program:v}}function ia(b){function d(b,k){if(b in c){var l=c[b]|0;return a(function(b,a){k&&(b.OFFSET=l);return l})}if(b in v){var N=v[b];return e(N,function(b,l){var a=b.invoke(l,N);k&&(b.OFFSET=a);return a})}return k&&E?a(function(b,k){b.OFFSET="0";return 0}):null}var c=b["static"],v=b.dynamic,E=function(){if("elements"in c){var b=c.elements;h(b)?b=A.getElements(A.create(b)):b&&(b=A.getElements(b));var k=a(function(k,l){if(b){var a=k.link(b);return k.ELEMENTS=a}return k.ELEMENTS=
null});k.value=b;return k}if("elements"in v){var l=v.elements;return e(l,function(b,k){var a=b.shared,d=a.isBufferArgs,a=a.elements,c=b.invoke(k,l),N=k.def("null"),d=k.def(d,"(",c,")"),c=b.cond(d).then(N,"=",a,".createStream(",c,");")["else"](N,"=",a,".getElements(",c,");");k.entry(c);k.exit(b.cond(d).then(a,".destroyStream(",N,");"));return b.ELEMENTS=N})}return null}(),I=d("offset",!0);return{elements:E,primitive:function(){if("primitive"in c){var b=c.primitive;return a(function(k,l){return G[b]})}if("primitive"in
v){var k=v.primitive;return e(k,function(b,l){var a=b.constants.primTypes,d=b.invoke(l,k);return l.def(a,"[",d,"]")})}return E?g(E)?E.value?a(function(b,k){return k.def(b.ELEMENTS,".primType")}):a(function(){return 4}):new q(E.thisDep,E.contextDep,E.propDep,function(b,k){var l=b.ELEMENTS;return k.def(l,"?",l,".primType:",4)}):null}(),count:function(){if("count"in c){var b=c.count|0;return a(function(){return b})}if("count"in v){var k=v.count;return e(k,function(b,l){return b.invoke(l,k)})}return E?
g(E)?E?I?new q(I.thisDep,I.contextDep,I.propDep,function(b,k){return k.def(b.ELEMENTS,".vertCount-",b.OFFSET)}):a(function(b,k){return k.def(b.ELEMENTS,".vertCount")}):a(function(){return-1}):new q(E.thisDep||I.thisDep,E.contextDep||I.contextDep,E.propDep||I.propDep,function(b,k){var l=b.ELEMENTS;return b.OFFSET?k.def(l,"?",l,".vertCount-",b.OFFSET,":-1"):k.def(l,"?",l,".vertCount:-1")}):null}(),instances:d("instances",!1),offset:I}}function ra(b){var d=b["static"],g=b.dynamic,v={};za.forEach(function(b){function l(k,
c){if(b in d){var I=k(d[b]);v[h]=a(function(){return I})}else if(b in g){var m=g[b];v[h]=e(m,function(b,k){return c(b,k,b.invoke(k,m))})}}var h=T(b);switch(b){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return l(function(b){return b},function(b,l,a){return a});case "depth.func":return l(function(b){return K[b]},function(b,l,a){return l.def(b.constants.compareFuncs,
"[",a,"]")});case "depth.range":return l(function(b){return b},function(b,l,a){b=l.def("+",a,"[0]");l=l.def("+",a,"[1]");return[b,l]});case "blend.func":return l(function(b){return[y["srcRGB"in b?b.srcRGB:b.src],y["dstRGB"in b?b.dstRGB:b.dst],y["srcAlpha"in b?b.srcAlpha:b.src],y["dstAlpha"in b?b.dstAlpha:b.dst]]},function(b,l,a){function d(b,k){var N=l.def('"',b,k,'" in ',a,"?",a,".",b,k,":",a,".",b);return l.def(c,"[",N,"]")}var c=b.constants.blendFuncs;b=d("src","RGB");var N=d("src","Alpha"),g=
d("dst","RGB"),I=d("dst","Alpha");return[b,g,N,I]});case "blend.equation":return l(function(b){if("string"===typeof b)return[aa[b],aa[b]];if("object"===typeof b)return[aa[b.rgb],aa[b.alpha]]},function(b,l,a){var d=b.constants.blendEquations,c=l.def(),N=l.def();b=b.cond("typeof ",a,'==="string"');b.then(c,"=",N,"=",d,"[",a,"];");b["else"](c,"=",d,"[",a,".rgb];",N,"=",d,"[",a,".alpha];");l(b);return[c,N]});case "blend.color":return l(function(b){return F(4,function(l){return+b[l]})},function(b,l,a){return F(4,
function(b){return l.def("+",a,"[",b,"]")})});case "stencil.mask":return l(function(b){return b|0},function(b,l,a){return l.def(a,"|0")});case "stencil.func":return l(function(b){return[K[b.cmp||"keep"],b.ref||0,"mask"in b?b.mask:-1]},function(b,l,a){b=l.def('"cmp" in ',a,"?",b.constants.compareFuncs,"[",a,".cmp]",":",7680);var d=l.def(a,".ref|0");l=l.def('"mask" in ',a,"?",a,".mask|0:-1");return[b,d,l]});case "stencil.opFront":case "stencil.opBack":return l(function(l){return["stencil.opBack"===
b?1029:1028,t[l.fail||"keep"],t[l.zfail||"keep"],t[l.pass||"keep"]]},function(l,a,d){function c(b){return a.def('"',b,'" in ',d,"?",N,"[",d,".",b,"]:",7680)}var N=l.constants.stencilOps;return["stencil.opBack"===b?1029:1028,c("fail"),c("zfail"),c("pass")]});case "polygonOffset.offset":return l(function(b){return[b.factor|0,b.units|0]},function(b,l,a){b=l.def(a,".factor|0");l=l.def(a,".units|0");return[b,l]});case "cull.face":return l(function(b){var l=0;"front"===b?l=1028:"back"===b&&(l=1029);return l},
function(b,l,a){return l.def(a,'==="front"?',1028,":",1029)});case "lineWidth":return l(function(b){return b},function(b,l,a){return a});case "frontFace":return l(function(b){return c[b]},function(b,l,a){return l.def(a+'==="cw"?2304:2305')});case "colorMask":return l(function(b){return b.map(function(b){return!!b})},function(b,l,a){return F(4,function(b){return"!!"+a+"["+b+"]"})});case "sample.coverage":return l(function(b){return["value"in b?b.value:1,!!b.invert]},function(b,l,a){b=l.def('"value" in ',
a,"?+",a,".value:1");l=l.def("!!",a,".invert");return[b,l]})}});return v}function ma(b){var d=b["static"],c=b.dynamic,g={};Object.keys(d).forEach(function(b){var l=d[b],c;"number"===typeof l||"boolean"===typeof l?c=a(function(){return l}):"function"!==typeof l||"texture2d"!==l._reglType&&"textureCube"!==l._reglType?x(l)&&(c=a(function(b){return b.global.def("[",F(l.length,function(b){return l[b]}),"]")})):c=a(function(b){return b.link(l)});c.value=l;g[b]=c});Object.keys(c).forEach(function(b){var l=
c[b];g[b]=e(l,function(b,a){return b.invoke(a,l)})});return g}function Y(b){var c=b["static"],g=b.dynamic,v={};Object.keys(c).forEach(function(b){var l=c[b],g=d.id(b),k=new la;if(h(l))k.state=1,k.buffer=u.getBuffer(u.create(l,34962,!1)),k.type=k.buffer.dtype;else{var e=u.getBuffer(l);if(e)k.state=1,k.buffer=e,k.type=e.dtype;else if(l.constant){var m=l.constant;k.state=2;"number"===typeof m?k.x=m:z.forEach(function(b,l){l<m.length&&(k[b]=m[l])})}else{var e=u.getBuffer(l.buffer),V=l.offset|0,D=l.stride|
0,r=l.size|0,n=!!l.normalized,f=0;"type"in l&&(f=M[l.type]);l=l.divisor|0;k.buffer=e;k.state=1;k.size=r;k.normalized=n;k.type=f||e.dtype;k.offset=V;k.stride=D;k.divisor=l}}v[b]=a(function(b,l){var a=b.attribCache;if(g in a)return a[g];var d={isStream:!1};Object.keys(k).forEach(function(b){d[b]=k[b]});k.buffer&&(d.buffer=b.link(k.buffer));return a[g]=d})});Object.keys(g).forEach(function(b){var l=g[b];v[b]=e(l,function(b,a){function d(b){a(e[b],"=",c,".",b,"|0;")}var c=b.invoke(a,l),N=b.shared,g=N.isBufferArgs,
v=N.buffer,e={isStream:a.def(!1)},h=new la;h.state=1;Object.keys(h).forEach(function(b){e[b]=a.def(""+h[b])});var m=e.buffer,V=e.type;a("if(",g,"(",c,")){",e.isStream,"=true;",m,"=",v,".createStream(",34962,",",c,");",V,"=",m,".dtype;","}else{",m,"=",v,".getBuffer(",c,");","if(",m,"){",V,"=",m,".dtype;","}else if(",c,".constant){",e.state,"=",2,";",z.map(function(b,l){return e[b]+"="+c+".length>="+l+"?"+c+"["+l+"]:0;"}).join(""),"}else{",m,"=",v,".getBuffer(",c,".buffer);",V,'="type" in ',c,"?",N.glTypes,
"[",c,".type]:",m,".dtype;",e.normalized,"=!!",c,".normalized;");d("size");d("offset");d("stride");d("divisor");a("}}");return e})});return v}function fa(b){var d=b["static"],c=b.dynamic,g={};Object.keys(d).forEach(function(b){var l=d[b];g[b]=a(function(b,a){return"number"===typeof l||"boolean"===typeof l?""+l:b.link(l)})});Object.keys(c).forEach(function(b){var l=c[b];g[b]=e(l,function(b,a){return b.invoke(a,l)})});return g}function Z(b,a,d){var c=b.shared.context,g=b.scope();Object.keys(d).forEach(function(e){a.save(c,
"."+e);g(c,".",e,"=",d[e].append(b,a),";")});a(g)}function U(b,a,d){var c=b.shared,g=c.gl,e=c.framebuffer,v;D&&(v=a.def(c.extensions,".webgl_draw_buffers"));var k=b.constants,c=k.drawBuffer,k=k.backBuffer;b=d?d.append(b,a):a.def(e,".next");a("if(",e,".dirty||",b,"!==",e,".cur){","if(",b,"){",g,".bindFramebuffer(",36160,",",b,".framebuffer);");D&&a(v,".drawBuffersWEBGL(",c,"[",b,".colorAttachments.length]);");a("}else{",g,".bindFramebuffer(",36160,",null);");D&&a(v,".drawBuffersWEBGL(",k,");");a("}",
e,".cur=",b,";",e,".dirty=false;","}")}function W(b,a,d){var c=b.shared,g=c.gl,e=b.current,h=b.next,k=c.current,m=c.next,D=b.cond(k,".dirty");za.forEach(function(a){a=T(a);if(!(a in d.state)){var c,N;if(a in h){c=h[a];N=e[a];var r=F(v[a].length,function(b){return D.def(c,"[",b,"]")});D(b.cond(r.map(function(b,l){return b+"!=="+N+"["+l+"]"}).join("||")).then(g,".",pa[a],"(",r,");",r.map(function(b,l){return N+"["+l+"]="+b}).join(";"),";"))}else c=D.def(m,".",a),r=b.cond(c,"!==",k,".",a),D(r),a in oa?
r(b.cond(c).then(g,".enable(",oa[a],");")["else"](g,".disable(",oa[a],");"),k,".",a,"=",c,";"):r(g,".",pa[a],"(",c,");",k,".",a,"=",c,";")}});0===Object.keys(d.state).length&&D(k,".dirty=false;");a(D)}function ba(b,a,d,c){var e=b.shared,v=b.current,h=e.current,k=e.gl;m(Object.keys(d)).forEach(function(e){var m=d[e];if(!c||c(m)){var D=m.append(b,a);if(oa[e]){var r=oa[e];g(m)?D?a(k,".enable(",r,");"):a(k,".disable(",r,");"):a(b.cond(D).then(k,".enable(",r,");")["else"](k,".disable(",r,");"));a(h,".",
e,"=",D,";")}else if(x(D)){var n=v[e];a(k,".",pa[e],"(",D,");",D.map(function(b,l){return n+"["+l+"]="+b}).join(";"),";")}else a(k,".",pa[e],"(",D,");",h,".",e,"=",D,";")}})}function ta(l,a){b&&!l.instancing&&(l.instancing=a.def(l.shared.extensions,".angle_instanced_arrays"))}function Ba(b,a,d){d=b.stats;b=b.shared;ka&&a(b.timer,".beginQuery(",d,");")}function ja(b,a,d){b=b.shared;ka&&a(b.timer,".endQuery();")}function ca(a,d,c,g,e){function v(b){switch(b){case 35664:case 35667:case 35671:return 2;
case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function h(c,g,e){function v(){d("if(!",n,".pointer){",D,".enableVertexAttribArray(",r,");",n,".pointer=true;}");var c=e.type,k;k=e.size?d.def(e.size,"||",g):g;d("if(",n,".type!==",c,"||",n,".size!==",k,"||",E.map(function(b){return n+"."+b+"!=="+e[b]}).join("||"),"){",D,".bindBuffer(",34962,",",f,".buffer);",D,".vertexAttribPointer(",[r,k,c,e.normalized,e.stride,e.offset],");",n,".type=",c,";",n,
".size=",k,";",E.map(function(b){return n+"."+b+"="+e[b]+";"}).join(""),"}");b&&(c=e.divisor,d("if(",n,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[r,c],");",n,".divisor=",c,";}"))}function m(){d("if(",n,".pointer){",D,".disableVertexAttribArray(",r,");",n,".pointer=false;","}if(",z.map(function(b,a){return n+"."+b+"!=="+V[a]}).join("||"),"){",D,".vertexAttrib4f(",r,",",V,");",z.map(function(b,a){return n+"."+b+"="+V[a]+";"}).join(""),"}")}var D=k.gl,r=d.def(c,".location"),n=d.def(k.attributes,
"[",r,"]");c=e.state;var f=e.buffer,V=[e.x,e.y,e.z,e.w],E=["buffer","normalized","offset","stride"];1===c?v():2===c?m():(d("if(",c,"===",1,"){"),v(),d("}else{"),m(),d("}"))}var k=a.shared;g.forEach(function(b){var k=b.name,g=c.attributes[k],m;if(g){if(!e(g))return;m=g.append(a,d)}else{if(!e(O))return;var D=a.scopeAttrib(k);m={};Object.keys(new la).forEach(function(b){m[b]=d.def(D,".",b)})}h(a.link(b),v(b.info.type),m)})}function da(b,a,c,e,v){for(var m=b.shared,h=m.gl,k,D=0;D<e.length;++D){var r=
e[D],n=r.name,f=r.info.type,q=c.uniforms[n],r=b.link(r)+".location",t;if(q){if(!v(q))continue;if(g(q)){n=q.value;if(35678===f||35680===f)f=b.link(n._texture),a(h,".uniform1i(",r,",",f+".bind());"),a.exit(f,".unbind();");else if(35674===f||35675===f||35676===f)n=b.global.def("new Float32Array(["+Array.prototype.slice.call(n)+"])"),q=2,35675===f?q=3:35676===f&&(q=4),a(h,".uniformMatrix",q,"fv(",r,",false,",n,");");else{switch(f){case 5126:k="1f";break;case 35664:k="2f";break;case 35665:k="3f";break;
case 35666:k="4f";break;case 35670:k="1i";break;case 5124:k="1i";break;case 35671:k="2i";break;case 35667:k="2i";break;case 35672:k="3i";break;case 35668:k="3i";break;case 35673:k="4i";break;case 35669:k="4i"}a(h,".uniform",k,"(",r,",",x(n)?Array.prototype.slice.call(n):n,");")}continue}else t=q.append(b,a)}else{if(!v(O))continue;t=a.def(m.uniforms,"[",d.id(n),"]")}n=1;switch(f){case 35678:case 35680:f=a.def(t,"._texture");a(h,".uniform1i(",r,",",f,".bind());");a.exit(f,".unbind();");continue;case 5124:case 35670:k=
"1i";break;case 35667:case 35671:k="2i";n=2;break;case 35668:case 35672:k="3i";n=3;break;case 35669:case 35673:k="4i";n=4;break;case 5126:k="1f";break;case 35664:k="2f";n=2;break;case 35665:k="3f";n=3;break;case 35666:k="4f";n=4;break;case 35674:k="Matrix2fv";break;case 35675:k="Matrix3fv";break;case 35676:k="Matrix4fv"}a(h,".uniform",k,"(",r,",");if("M"===k.charAt(0)){var r=Math.pow(f-35674+2,2),y=b.global.def("new Float32Array(",r,")");a("false,(Array.isArray(",t,")||",t," instanceof Float32Array)?",
t,":(",F(r,function(b){return y+"["+b+"]="+t+"["+b+"]"}),",",y,")")}else 1<n?a(F(n,function(b){return t+"["+b+"]"})):a(t);a(");")}}function ya(a,d,c,e){function v(b){var k=D[b];return k?k.contextDep&&e.contextDynamic||k.propDep?k.append(a,c):k.append(a,d):d.def(r,".",b)}function h(){function b(){c(H,".drawElementsInstancedANGLE(",[q,y,z,t+"<<(("+z+"-5121)>>1)",x],");")}function a(){c(H,".drawArraysInstancedANGLE(",[q,t,y,x],");")}f?p?b():(c("if(",f,"){"),b(),c("}else{"),a(),c("}")):a()}function m(){function b(){c(n+
".drawElements("+[q,y,z,t+"<<(("+z+"-5121)>>1)"]+");")}function a(){c(n+".drawArrays("+[q,t,y]+");")}f?p?b():(c("if(",f,"){"),b(),c("}else{"),a(),c("}")):a()}var k=a.shared,n=k.gl,r=k.draw,D=e.draw,f=function(){var b=D.elements,k=d;if(b){if(b.contextDep&&e.contextDynamic||b.propDep)k=c;b=b.append(a,k)}else b=k.def(r,".","elements");b&&k("if("+b+")"+n+".bindBuffer(34963,"+b+".buffer.buffer);");return b}(),q=v("primitive"),t=v("offset"),y=function(){var b=D.count,k=d;if(b){if(b.contextDep&&e.contextDynamic||
b.propDep)k=c;b=b.append(a,k)}else b=k.def(r,".","count");return b}();if("number"===typeof y){if(0===y)return}else c("if(",y,"){"),c.exit("}");var x,H;b&&(x=v("instances"),H=a.instancing);var z=f+".type",p=D.elements&&g(D.elements);b&&("number"!==typeof x||0<=x)?"string"===typeof x?(c("if(",x,">0){"),h(),c("}else if(",x,"<0){"),m(),c("}")):h():m()}function va(a,c,d,e,g){c=X();g=c.proc("body",g);b&&(c.instancing=g.def(c.shared.extensions,".angle_instanced_arrays"));a(c,g,d,e);return c.compile().body}
function Ca(b,a,c,d){ta(b,a);ca(b,a,c,d.attributes,function(){return!0});da(b,a,c,d.uniforms,function(){return!0});ya(b,a,a,c)}function Da(b,a){var c=b.proc("draw",1);ta(b,c);Z(b,c,a.context);U(b,c,a.framebuffer);W(b,c,a);ba(b,c,a.state);Ba(b,c,a);var d=a.shader.progVar.append(b,c);c(b.shared.gl,".useProgram(",d,".program);");if(a.shader.program)Ca(b,c,a,a.shader.program);else{var e=b.global.def("{}"),g=c.def(d,".id"),v=c.def(e,"[",g,"]");c(b.cond(v).then(v,".call(this,a0);")["else"](v,"=",e,"[",
g,"]=",b.link(function(c){return va(Ca,b,a,c,1)}),"(",d,");",v,".call(this,a0);"))}0<Object.keys(a.state).length&&c(b.shared.current,".dirty=true;");ja(b,c,a)}function Ea(b,a,c,d){function e(){return!0}b.batchId="a1";ta(b,a);ca(b,a,c,d.attributes,e);da(b,a,c,d.uniforms,e);ya(b,a,a,c)}function ua(b,a,c,d){function e(b){return b.contextDep&&v||b.propDep}function g(b){return!e(b)}ta(b,a);var v=c.contextDep,k=a.def(),h=a.def();b.shared.props=h;b.batchId=k;var m=b.scope(),n=b.scope();a(m.entry,"for(",
k,"=0;",k,"<","a1",";++",k,"){",h,"=","a0","[",k,"];",n,"}",m.exit);c.needsContext&&Z(b,n,c.context);c.needsFramebuffer&&U(b,n,c.framebuffer);ba(b,n,c.state,e);d?(ca(b,m,c,d.attributes,g),ca(b,n,c,d.attributes,e),da(b,m,c,d.uniforms,g),da(b,n,c,d.uniforms,e),ya(b,m,n,c)):(a=b.global.def("{}"),d=c.shader.progVar.append(b,n),h=n.def(d,".id"),m=n.def(a,"[",h,"]"),n(b.shared.gl,".useProgram(",d,".program);","if(!",m,"){",m,"=",a,"[",h,"]=",b.link(function(a){return va(Ea,b,c,a,2)}),"(",d,");}",m,".call(this,a0[",
k,"],",k,");"))}function Ga(b,a){var c=b.proc("batch",2);b.batchId="0";ta(b,c);var d=!1,e=!0;Object.keys(a.context).forEach(function(b){d=d||a.context[b].propDep});d||(Z(b,c,a.context),e=!1);var g=a.framebuffer,v=!1;g?(g.propDep?d=v=!0:g.contextDep&&d&&(v=!0),v||U(b,c,g)):U(b,c,null);a.state.viewport&&a.state.viewport.propDep&&(d=!0);W(b,c,a);ba(b,c,a.state,function(b){return!(b.contextDep&&d||b.propDep)});Ba(b,c,a);a.contextDep=d;a.needsContext=e;a.needsFramebuffer=v;e=a.shader.progVar;if(e.contextDep&&
d||e.propDep)ua(b,c,a,null);else if(e=e.append(b,c),c(b.shared.gl,".useProgram(",e,".program);"),a.shader.program)ua(b,c,a,a.shader.program);else{var g=b.global.def("{}"),v=c.def(e,".id"),k=c.def(g,"[",v,"]");c(b.cond(k).then(k,".call(this,a0,a1);")["else"](k,"=",g,"[",v,"]=",b.link(function(c){return va(ua,b,a,c,2)}),"(",e,");",k,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&c(b.shared.current,".dirty=true;");ja(b,c,a)}function wa(b,a){function c(d){var k=a.shader[d];k&&e.set(g.shader,"."+
d,k.append(b,e))}var e=b.proc("scope",3);b.batchId="a2";var g=b.shared,v=g.current,h=g.timer,k;ka&&(k=e.def(h,".getNumPendingQueries()"));Z(b,e,a.context);a.framebuffer&&a.framebuffer.append(b,e);m(Object.keys(a.state)).forEach(function(c){var d=a.state[c].append(b,e);x(d)?d.forEach(function(a,d){e.set(b.next[c],"["+d+"]",a)}):e.set(g.next,"."+c,d)});["elements","offset","count","instances","primitive"].forEach(function(c){var d=a.draw[c];d&&e.set(g.draw,"."+c,""+d.append(b,e))});Object.keys(a.uniforms).forEach(function(c){e.set(g.uniforms,
"["+d.id(c)+"]",a.uniforms[c].append(b,e))});Object.keys(a.attributes).forEach(function(c){var d=a.attributes[c].append(b,e),k=b.scopeAttrib(c);Object.keys(new la).forEach(function(b){e.set(k,"."+b,d[b])})});c("vert");c("frag");0<Object.keys(a.state).length&&(e(v,".dirty=true;"),e.exit(v,".dirty=true;"));e("a1(",b.shared.context,",a0,0);");if(ka){var n=b.stats,v=e.def(h,".getNumPendingQueries()-1");e(h,".pushScopeStats(",k,",",v,",",n,");")}}var la=R.Record,aa={add:32774,subtract:32778,"reverse subtract":32779};
p.ext_blend_minmax&&(aa.min=32775,aa.max=32776);var b=p.angle_instanced_arrays,D=p.webgl_draw_buffers,v={dirty:!0},xa={},za=[],oa={},pa={};P("dither",3024);P("blend.enable",3042);L("blend.color","blendColor",[0,0,0,0]);L("blend.equation","blendEquationSeparate",[32774,32774]);L("blend.func","blendFuncSeparate",[1,0,1,0]);P("depth.enable",2929,!0);L("depth.func","depthFunc",513);L("depth.range","depthRange",[0,1]);L("depth.mask","depthMask",!0);L("colorMask","colorMask",[!0,!0,!0,!0]);P("cull.enable",
2884);L("cull.face","cullFace",1029);L("frontFace","frontFace",2305);L("lineWidth","lineWidth",1);P("polygonOffset.enable",32823);L("polygonOffset.offset","polygonOffset",[0,0]);P("sample.alpha",32926);P("sample.enable",32928);L("sample.coverage","sampleCoverage",[1,!1]);P("stencil.enable",2960);L("stencil.mask","stencilMask",-1);L("stencil.func","stencilFunc",[519,0,-1]);L("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);L("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);P("scissor.enable",
3089);L("scissor.box","scissor",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);L("viewport","viewport",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);var Ha={gl:f,context:ea,strings:d,next:xa,current:v,draw:H,elements:A,buffer:u,shader:S,attributes:R.state,uniforms:C,framebuffer:r,extensions:p,timer:ka,isBufferArgs:h},Aa={primTypes:G,compareFuncs:K,blendFuncs:y,blendEquations:aa,stencilOps:t,glTypes:M,orientationType:c};D&&(Aa.backBuffer=[1029],Aa.drawBuffer=F(J.maxDrawbuffers,function(b){return 0===
b?[0]:F(b,function(b){return 36064+b})}));var Ja=0;return{next:xa,current:v,procs:function(){var b=X(),a=b.proc("poll"),c=b.proc("refresh"),d=b.block();a(d);c(d);var e=b.shared,g=e.gl,h=e.next,k=e.current;d(k,".dirty=false;");U(b,a);c(e.framebuffer,".dirty=true;");U(b,c);Object.keys(oa).forEach(function(e){var v=oa[e],m=d.def(h,".",e),n=b.block();n("if(",m,"){",g,".enable(",v,")}else{",g,".disable(",v,")}",k,".",e,"=",m,";");c(n);a("if(",m,"!==",k,".",e,"){",n,"}")});Object.keys(pa).forEach(function(e){var m=
pa[e],n=v[e],r,D,f=b.block();f(g,".",m,"(");x(n)?(m=n.length,r=b.global.def(h,".",e),D=b.global.def(k,".",e),f(F(m,function(b){return r+"["+b+"]"}),");",F(m,function(b){return D+"["+b+"]="+r+"["+b+"];"}).join("")),a("if(",F(m,function(b){return r+"["+b+"]!=="+D+"["+b+"]"}).join("||"),"){",f,"}")):(r=d.def(h,".",e),D=d.def(k,".",e),f(r,");",k,".",e,"=",r,";"),a("if(",r,"!==",D,"){",f,"}"));c(f)});return b.compile()}(),compile:function(b,a,c,d,e){var g=X();g.stats=g.link(e);e=ha(b);var v=qa(b,e),k=
ia(b),m=ra(b);b=sa(b);var n=v.viewport;n&&(m.viewport=n);n=T("scissor.box");(v=v[n])&&(m[n]=v);v=0<Object.keys(m).length;e={framebuffer:e,draw:k,shader:b,state:m,dirty:v};e.uniforms=ma(c);e.attributes=Y(a);e.context=fa(d);Da(g,e);wa(g,e);Ga(g,e);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./util/codegen":22,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/loop":27}],9:[function(f,p,w){function h(a,e){this.id=g++;this.type=
a;this.data=e}function m(a){if(0===a.length)return[];var e=a.charAt(0),g=a.charAt(a.length-1);if(1<a.length&&e===g&&('"'===e||"'"===e))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return m(a.substr(0,e.index)).concat(m(e[1])).concat(m(a.substr(e.index+e[0].length)));e=a.split(".");if(1===e.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(g=0;g<e.length;++g)a=a.concat(m(e[g]));return a}
function q(a){return"["+m(a).join("][")+"]"}var g=0;p.exports={define:function(a,e){switch(typeof e){case "boolean":case "number":case "string":return new h(a,q(e+""));case "undefined":return new h(a|128,null)}},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof h},unbox:function(a,e){if(a instanceof h){if(a.type&128)return new h(a.type&-129,q(e))}else if("function"===typeof a)return new h(0,a);return a},accessor:q}},{}],10:[function(f,p,w){var h=f("./util/is-typed-array"),
m=f("./util/is-ndarray"),q=f("./util/values"),g=f("./constants/primitives.json"),a=f("./constants/usage.json");p.exports=function(e,n,f,p){function u(a){this.id=z++;M[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function x(a,c,e,g,d,q,x){(q=x)||h(c)&&(!m(c)||h(c.data))||(q=n.oes_element_index_uint?5125:5123);a.buffer.bind();f._initBuffer(a.buffer,c,e,q,3);c=x;if(!x){switch(a.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=
5125}a.buffer.dtype=c}a.type=c;0>d&&(d=a.buffer.byteLength,5123===c?d>>=1:5125===c&&(d>>=2));a.vertCount=d;d=g;0>g&&(d=4,g=a.buffer.dimension,1===g&&(d=0),2===g&&(d=1),3===g&&(d=4));a.primType=d}function G(a){p.elementsCount--;delete M[a.id];a.buffer.destroy();a.buffer=null}var M={},z=0,y={uint8:5121,uint16:5123};n.oes_element_index_uint&&(y.uint32=5125);u.prototype.bind=function(){this.buffer.bind()};var K=[];return{create:function(n){function c(d){if(d)if("number"===typeof d)q(d),z.primType=4,z.vertCount=
d|0,z.type=5121;else{var n=null,f=35044,t=-1,p=-1,G=0,r=0;Array.isArray(d)||h(d)||m(d)?n=d:("data"in d&&(n=d.data),"usage"in d&&(f=a[d.usage]),"primitive"in d&&(t=g[d.primitive]),"count"in d&&(p=d.count|0),"length"in d&&(G=d.length|0),"type"in d&&(r=y[d.type]));n?x(z,n,f,t,p,G,r):(d=z.buffer,d.bind(),e.bufferData(34963,G,f),d.dtype=r||5121,d.usage=f,d.dimension=3,d.byteLength=G,z.primType=0>t?4:t,z.vertCount=0>p?0:p,z.type=d.dtype)}else q(),z.primType=4,z.vertCount=0,z.type=5121;return c}var q=f.create(null,
34963,!0),z=new u(q._buffer);p.elementsCount++;c(n);c._reglType="elements";c._elements=z;c.subdata=function(a,e){q.subdata(a,e);return c};c.destroy=function(){G(z)};return c},createStream:function(a){var c=K.pop();c||(c=new u(f.create(null,34963,!0)._buffer));x(c,a,35040,-1,-1,0,0);return c},destroyStream:function(a){K.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof u?a._elements:null},clear:function(){q(M).forEach(G)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,
"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/values":31}],11:[function(f,p,w){p.exports=function(h){function m(){"oes_texture_float oes_texture_float_linear oes_texture_half_float oes_texture_half_float_linear oes_standard_derivatives oes_element_index_uint oes_fbo_render_mipmap webgl_depth_texture webgl_draw_buffers webgl_color_buffer_float ext_texture_filter_anisotropic ext_frag_depth ext_blend_minmax ext_shader_texture_lod ext_color_buffer_half_float ext_srgb ext_disjoint_timer_query angle_instanced_arrays webgl_compressed_texture_s3tc webgl_compressed_texture_atc webgl_compressed_texture_pvrtc webgl_compressed_texture_etc1".split(" ").forEach(function(g){try{f[g]=
h.getExtension(g)}catch(a){}})}var f={};m();return{extensions:f,refresh:m}}},{}],12:[function(f,p,w){var h=f("./util/values"),m=f("./util/extend");p.exports=function(f,g,a,e,n,p){function A(a,c,d){this.target=a;this.texture=c;this.renderbuffer=d;var e=a=0;c?(a=c.width,e=c.height):d&&(a=d.width,e=d.height);this.width=a;this.height=e}function u(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function x(a,c,d){a&&(a.texture?a.texture._texture.refCount+=
1:a.renderbuffer._renderbuffer.refCount+=1)}function G(a,c){c?c.texture?f.framebufferTexture2D(36160,a,c.target,c.texture._texture.texture,0):f.framebufferRenderbuffer(36160,a,36161,c.renderbuffer._renderbuffer.renderbuffer):f.framebufferTexture2D(36160,a,3553,null,0)}function M(a){var c=3553,d=null,e=null,g=a;"object"===typeof a&&(g=a.data);a=g._reglType;"texture2d"===a?d=g:"textureCube"===a?d=g:"renderbuffer"===a&&(e=g,c=36161);return new A(c,d,e)}function z(a,c,d,g,m){if(d)return a=e.create2D({width:a,
height:c,format:g,type:m}),a._texture.refCount=0,new A(3553,a,null);a=n.create({width:a,height:c,format:g});a._renderbuffer.refCount=0;return new A(36161,null,a)}function y(a){return a&&(a.texture||a.renderbuffer)}function K(a,c,d){a&&(a.texture?a.texture.resize(c,d):a.renderbuffer&&a.renderbuffer.resize(c,d))}function t(){this.id=Q++;ga[this.id]=this;this.framebuffer=f.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=
null}function c(a){a.colorAttachments.forEach(u);u(a.depthAttachment);u(a.stencilAttachment);u(a.depthStencilAttachment)}function O(a){f.deleteFramebuffer(a.framebuffer);a.framebuffer=null;p.framebufferCount--;delete ga[a.id]}function B(c){var e;f.bindFramebuffer(36160,c.framebuffer);var g=c.colorAttachments;for(e=0;e<g.length;++e)G(36064+e,g[e]);for(e=g.length;e<a.maxColorAttachments;++e)G(36064+e,null);G(36096,c.depthAttachment);G(36128,c.stencilAttachment);G(33306,c.depthStencilAttachment);f.checkFramebufferStatus(36160);
f.bindFramebuffer(36160,d.next);d.current=d.next}var d={current:null,next:null,dirty:!1},w=["rgba"],J=["rgba4","rgb565","rgb5 a1"];g.ext_srgb&&J.push("srgba");g.ext_color_buffer_half_float&&J.push("rgba16f","rgb16f");g.webgl_color_buffer_float&&J.push("rgba32f");var na=["uint8"];g.oes_texture_half_float&&na.push("half float");g.oes_texture_float&&na.push("float");var Q=0,ga={};return m(d,{getFramebuffer:function(a){return"function"===typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer,a instanceof
t)?a:null},create:function(a,d){function e(a,d){var n,h=0,f=0,q=!0,r=!0;n=null;var p=!0,t="rgba",G="uint8",F=1,K=null,u=null,A=null,C=!1;if("number"===typeof a)h=a|0,f=d|0||h;else if(a){"shape"in a?(f=a.shape,h=f[0],f=f[1]):("radius"in a&&(h=f=a.radius),"width"in a&&(h=a.width),"height"in a&&(f=a.height));if("color"in a||"colors"in a)n=a.color||a.colors,Array.isArray(n);n||("colorCount"in a&&(F=a.colorCount|0),"colorTexture"in a&&(p=!!a.colorTexture,t="rgba4"),"colorType"in a&&(G=a.colorType,p||("half float"===
G?g.ext_color_buffer_half_float&&(t="rgba16f"):"float"===G&&g.webgl_color_buffer_float&&(t="rgba32f"))),"colorFormat"in a&&(t=a.colorFormat,0<=w.indexOf(t)?p=!0:0<=J.indexOf(t)&&(p=!1)));if("depthTexture"in a||"depthStencilTexture"in a)C=!(!a.depthTexture&&!a.depthStencilTexture);"depth"in a&&("boolean"===typeof a.depth?q=a.depth:(K=a.depth,r=!1));"stencil"in a&&("boolean"===typeof a.stencil?r=a.stencil:(u=a.stencil,q=!1));"depthStencil"in a&&("boolean"===typeof a.depthStencil?q=r=a.depthStencil:
(A=a.depthStencil,r=q=!1))}else h=f=1;var O=null,Q=null,na=null,ba=null;if(Array.isArray(n))O=n.map(M);else if(n)O=[M(n)];else for(O=Array(F),n=0;n<F;++n)O[n]=z(h,f,p,t,G);h=h||O[0].width;f=f||O[0].height;K?Q=M(K):q&&!r&&(Q=z(h,f,C,"depth","uint32"));u?na=M(u):r&&!q&&(na=z(h,f,!1,"stencil","uint8"));A?ba=M(A):!K&&!u&&r&&q&&(ba=z(h,f,C,"depth stencil","depth stencil"));for(n=0;n<O.length;++n)x(O[n],h,f);x(Q,h,f);x(na,h,f);x(ba,h,f);c(m);m.width=h;m.height=f;m.colorAttachments=O;m.depthAttachment=Q;
m.stencilAttachment=na;m.depthStencilAttachment=ba;e.color=O.map(y);e.depth=y(Q);e.stencil=y(na);e.depthStencil=y(ba);e.width=m.width;e.height=m.height;B(m);return e}var m=new t;p.framebufferCount++;e(a,d);e.resize=function(a,c){var d=a|0,g=c|0||d;if(d===m.width&&g===m.height)return e;for(var n=m.colorAttachments,h=0;h<n.length;++h)K(n[h],d,g);K(m.depthAttachment,d,g);K(m.stencilAttachment,d,g);K(m.depthStencilAttachment,d,g);m.width=e.width=d;m.height=e.height=g;B(m);return e};e._reglType="framebuffer";
e._framebuffer=m;e.destroy=function(){O(m);c(m)};return e},clear:function(){h(ga).forEach(O)}})}},{"./util/extend":23,"./util/values":31}],13:[function(f,p,w){p.exports=function(h,m){var f=1;m.ext_texture_filter_anisotropic&&(f=h.getParameter(34047));var g=1,a=1;m.webgl_draw_buffers&&(g=h.getParameter(34852),a=h.getParameter(36063));return{colorBits:[h.getParameter(3410),h.getParameter(3411),h.getParameter(3412),h.getParameter(3413)],depthBits:h.getParameter(3414),stencilBits:h.getParameter(3415),
subpixelBits:h.getParameter(3408),extensions:Object.keys(m).filter(function(a){return!!m[a]}),maxAnisotropic:f,maxDrawbuffers:g,maxColorAttachments:a,pointSizeDims:h.getParameter(33901),lineWidthDims:h.getParameter(33902),maxViewportDims:h.getParameter(3386),maxCombinedTextureUnits:h.getParameter(35661),maxCubeMapSize:h.getParameter(34076),maxRenderbufferSize:h.getParameter(34024),maxTextureUnits:h.getParameter(34930),maxTextureSize:h.getParameter(3379),maxAttributes:h.getParameter(34921),maxVertexUniforms:h.getParameter(36347),
maxVertexTextureUnits:h.getParameter(35660),maxVaryingVectors:h.getParameter(36348),maxFragmentUniforms:h.getParameter(36349),glsl:h.getParameter(35724),renderer:h.getParameter(7937),vendor:h.getParameter(7936),version:h.getParameter(7938)}}},{}],14:[function(f,p,w){var h=f("./util/is-typed-array");p.exports=function(m,f,g){return function(a){var e=0,n=0,p=g.framebufferWidth,A=g.framebufferHeight,u=null;h(a)?u=a:2===arguments.length?(p=arguments[0]|0,A=arguments[1]|0):a&&(e=a.x|0,n=a.y|0,p=a.width||
g.framebufferWidth,A=a.height||g.framebufferHeight,u=a.data||null);f();u=u||new Uint8Array(p*A*4);m.pixelStorei(3333,4);m.readPixels(e,n,p,A,6408,5121,u);return u}}},{"./util/is-typed-array":26}],15:[function(f,p,w){var h=f("./util/values");p.exports=function(m,f,g,a){function e(a){this.id=A++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0}function n(e){var g=e.renderbuffer;m.bindRenderbuffer(36161,null);m.deleteRenderbuffer(g);e.renderbuffer=null;e.refCount=0;delete u[e.id];
a.renderbufferCount--}var p={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};f.ext_srgb&&(p.srgba=35907);f.ext_color_buffer_half_float&&(p.rgba16f=34842,p.rgb16f=34843);f.webgl_color_buffer_float&&(p.rgba32f=34836);var A=0,u={};e.prototype.decRef=function(){0>=--this.refCount&&n(this)};return{create:function(g,n){function h(a,e){var g=0,c=0,n=32854;"object"===typeof a&&a?("shape"in a?(c=a.shape,g=c[0]|0,c=c[1]|0):("radius"in a&&(g=c=a.radius|0),"width"in a&&
(g=a.width|0),"height"in a&&(c=a.height|0)),"format"in a&&(n=p[a.format])):"number"===typeof a?(g=a|0,c="number"===typeof e?e|0:g):a||(g=c=1);if(g!==f.width||c!==f.height||n!==f.format)return h.width=f.width=g,h.height=f.height=c,f.format=n,m.bindRenderbuffer(36161,f.renderbuffer),m.renderbufferStorage(36161,n,g,c),h}var f=new e(m.createRenderbuffer());u[f.id]=f;a.renderbufferCount++;h(g,n);h.resize=function(a,e){var g=a|0,c=e|0||g;if(g===f.width&&c===f.height)return h;h.width=f.width=g;h.height=
f.height=c;m.bindRenderbuffer(36161,f.renderbuffer);m.renderbufferStorage(36161,f.format,g,c);return h};h._reglType="renderbuffer";h._renderbuffer=f;h.destroy=function(){f.decRef()};return h},clear:function(){h(u).forEach(n)}}}},{"./util/values":31}],16:[function(f,p,w){var h=f("./util/values");p.exports=function(f,q,g){function a(a,e,g,f){this.name=a;this.id=e;this.location=g;this.info=f}function e(a,e){for(var g=0;g<a.length;++g)if(a[g].id===e.id){a[g].location=e.location;return}a.push(e)}function n(a,
e,g){g=35632===a?A:u;var h=g[e];if(!h){var c=q.str(e),h=f.createShader(a);f.shaderSource(h,c);f.compileShader(h);g[e]=h}return h}function p(a,e){this.id=M++;this.fragId=a;this.vertId=e;this.program=null;this.uniforms=[];this.attributes=[]}var A={},u={},x={},G=[],M=0;return{clear:function(){var a=f.deleteShader.bind(f);h(A).forEach(a);A={};h(u).forEach(a);u={};G.forEach(function(a){f.deleteProgram(a.program)});G.length=0;x={};g.shaderCount=0},program:function(h,y,u){g.shaderCount++;(u=x[y])||(u=x[y]=
{});var t=u[h];if(!t){var c=t=new p(y,h),A,B;A=n(35632,c.fragId);B=n(35633,c.vertId);y=c.program=f.createProgram();f.attachShader(y,A);f.attachShader(y,B);f.linkProgram(y);var d=f.getProgramParameter(y,35718),M=c.uniforms;for(A=0;A<d;++A)if(B=f.getActiveUniform(y,A))if(1<B.size)for(var J=0;J<B.size;++J){var w=B.name.replace("[0]","["+J+"]");e(M,new a(w,q.id(w),f.getUniformLocation(y,w),B))}else e(M,new a(B.name,q.id(B.name),f.getUniformLocation(y,B.name),B));d=f.getProgramParameter(y,35721);c=c.attributes;
for(A=0;A<d;++A)(B=f.getActiveAttrib(y,A))&&e(c,new a(B.name,q.id(B.name),f.getAttribLocation(y,B.name),B));u[h]=t;G.push(t)}return t},shader:n,frag:null,vert:null}}},{"./util/values":31}],17:[function(f,p,w){p.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0}}},{}],18:[function(f,p,w){p.exports=function(){var f={"":0},m=[""];return{id:function(q){var g=f[q];if(g)return g;g=f[q]=m.length;m.push(q);return g},str:function(f){return m[f]}}}},
{}],19:[function(f,p,w){function h(a){return Array.isArray(a)&&(0===a.length||"number"===typeof a[0])}function m(a){return Array.isArray(a)&&0!==a.length&&G(a[0])?!0:!1}function q(a){return Object.prototype.toString.call(a)}function g(a){if(!a)return!1;var e=q(a);return 0<=t.indexOf(e)?!0:h(a)||m(a)||A(a)}function a(a,e){36193===a.type?(a.data=x(e),u.freeType(e)):a.data=e}var e=f("./util/extend"),n=f("./util/values"),F=f("./util/is-typed-array"),A=f("./util/is-ndarray"),u=f("./util/pool"),x=f("./util/to-half-float"),
G=f("./util/is-array-like");w=f("./constants/arraytypes.json");var M=f("./constants/arraytypes.json"),z=[9984,9986,9985,9987],y=[0,6409,6410,6407,6408],K={};K[6409]=K[6406]=K[6402]=1;K[34041]=K[6410]=2;K[6407]=3;K[6408]=4;var t=Object.keys(w).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]);p.exports=function(c,f,p,d,t,J){function w(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=
this.compressed=!1;this.unpackAlignment=1;this.height=this.width=this.colorSpace=0;this.channels=4}function Q(b,a){b.internalformat=a.internalformat;b.format=a.format;b.type=a.type;b.compressed=a.compressed;b.premultiplyAlpha=a.premultiplyAlpha;b.flipY=a.flipY;b.unpackAlignment=a.unpackAlignment;b.colorSpace=a.colorSpace;b.width=a.width;b.height=a.height;b.channels=a.channels}function ga(b,a){if("object"===typeof a&&a){"premultiplyAlpha"in a&&(b.premultiplyAlpha=a.premultiplyAlpha);"flipY"in a&&(b.flipY=
a.flipY);"alignment"in a&&(b.unpackAlignment=a.alignment);"colorSpace"in a&&(b.colorSpace=Ba[a.colorSpace]);"type"in a&&(b.type=ja[a.type]);var c=b.width,d=b.height,e=b.channels,g=!1;"shape"in a?(c=a.shape[0],d=a.shape[1],3===a.shape.length&&(e=a.shape[2],g=!0)):("radius"in a&&(c=d=a.radius),"width"in a&&(c=a.width),"height"in a&&(d=a.height),"channels"in a&&(e=a.channels,g=!0));b.width=c|0;b.height=d|0;b.channels=e|0;c=!1;"format"in a&&(c=a.format,d=b.internalformat=ca[c],b.format=Ca[d],c in ja&&
!("type"in a)&&(b.type=ja[c]),c in da&&(b.compressed=!0),c=!0);!g&&c?b.channels=K[b.format]:g&&!c&&b.channels!==y[b.format]&&(b.format=b.internalformat=y[b.channels])}}function r(b){c.pixelStorei(37440,b.flipY);c.pixelStorei(37441,b.premultiplyAlpha);c.pixelStorei(37443,b.colorSpace);c.pixelStorei(3317,b.unpackAlignment)}function C(){w.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function R(b,c){var d=null;g(c)?d=c:c&&(ga(b,c),"x"in c&&
(b.xOffset=c.x|0),"y"in c&&(b.yOffset=c.y|0),g(c.data)&&(d=c.data));if(c.copy){var e=t.viewportWidth,f=t.viewportHeight;b.width=b.width||e-b.xOffset;b.height=b.height||f-b.yOffset;b.needsCopy=!0}else if(!d)b.width=b.width||1,b.height=b.height||1;else if(F(d))b.data=d,"type"in c||5121!==b.type||(b.type=M[Object.prototype.toString.call(d)]|0);else if(h(d)){e=d;f=b.width*b.height*b.channels;switch(b.type){case 5121:case 5123:case 5125:case 5126:f=u.allocType(b.type,f);f.set(e);b.data=f;break;case 36193:b.data=
x(e)}b.alignment=1;b.needsFree=!0}else if(A(d)){e=d.data;Array.isArray(e)||5121!==b.type||(b.type=M[Object.prototype.toString.call(e)]|0);var f=d.shape,n=d.stride,p,r,z,J;3===f.length?(z=f[2],J=n[2]):J=z=1;p=f[0];r=f[1];f=n[0];n=n[1];b.alignment=1;b.width=p;b.height=r;b.channels=z;b.format=b.internalformat=y[z];b.needsFree=!0;p=J;d=d.offset;z=b.width;J=b.height;r=b.channels;for(var l=u.allocType(36193===b.type?5126:b.type,z*J*r),w=0,B=0;B<J;++B)for(var C=0;C<z;++C)for(var E=0;E<r;++E)l[w++]=e[f*C+
n*B+p*E+d];a(b,l)}else if("[object HTMLCanvasElement]"===q(d)||"[object CanvasRenderingContext2D]"===q(d))"[object HTMLCanvasElement]"===q(d)?b.element=d:b.element=d.canvas,b.width=b.element.width,b.height=b.element.height;else if("[object HTMLImageElement]"===q(d))b.element=d,b.width=d.naturalWidth,b.height=d.naturalHeight;else if("[object HTMLVideoElement]"===q(d))b.element=d,b.width=d.videoWidth,b.height=d.videoHeight,b.needsPoll=!0;else if(m(d)){e=d[0].length;f=d.length;n=1;if(G(d[0][0])){p=n=
d[0][0].length;z=u.allocType(36193===b.type?5126:b.type,e*f*p);for(r=J=0;r<f;++r)for(l=d[r],w=0;w<e;++w)for(B=l[w],C=0;C<p;++C)z[J++]=B[C];a(b,z)}else{p=u.allocType(36193===b.type?5126:b.type,e*f);for(J=z=0;J<f;++J)for(r=d[J],l=0;l<e;++l)p[z++]=r[l];a(b,p)}b.alignment=1;b.width=e;b.height=f;b.channels=n;b.format=b.internalformat=y[n];b.needsFree=!0}}function S(b,a,e,g,f){var n=b.element,h=b.data,m=b.internalformat,p=b.format,q=b.type,l=b.width,x=b.height;r(b);n?c.texSubImage2D(a,f,e,g,p,q,n):b.compressed?
c.compressedTexSubImage2D(a,f,e,g,m,l,x,h):b.needsCopy?(d(),c.copyTexSubImage2D(a,f,e,g,b.xOffset,b.yOffset,l,x)):c.texSubImage2D(a,f,e,g,l,x,p,q,h)}function H(){return Da.pop()||new C}function ea(b){b.needsFree&&u.freeType(b.data);C.call(b);Da.push(b)}function ka(){w.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function T(b,a,c){var d=b.images[0]=H();b.mipmask=1;d.width=b.width=a;d.height=b.height=c}function P(b,a){var c=null;if(g(a))c=b.images[0]=H(),Q(c,
b),R(c,a),b.mipmask=1;else if(ga(b,a),Array.isArray(a.mipmap))for(var d=a.mipmap,e=0;e<d.length;++e)c=b.images[e]=H(),Q(c,b),c.width>>=e,c.height>>=e,R(c,d[e]),b.mipmask|=1<<e;else c=b.images[0]=H(),Q(c,b),R(c,a),b.mipmask=1;Q(b,b.images[0])}function L(b,a){for(var e=b.images,g=0;g<e.length&&e[g];++g){var f=e[g],n=a,h=g,m=f.element,p=f.data,q=f.internalformat,l=f.format,x=f.type,G=f.width,t=f.height;r(f);m?c.texImage2D(n,h,l,l,x,m):f.compressed?c.compressedTexImage2D(n,h,q,G,t,0,p):f.needsCopy?(d(),
c.copyTexImage2D(n,h,l,f.xOffset,f.yOffset,G,t,0)):c.texImage2D(n,h,l,G,t,0,l,x,p)}}function X(){var b=Ea.pop()||new ka;w.call(b);for(var a=b.mipmask=0;16>a;++a)b.images[a]=null;return b}function ha(b){for(var a=b.images,c=0;c<a.length;++c)a[c]&&ea(a[c]),a[c]=null;Ea.push(b)}function qa(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function sa(a,c){"min"in c&&(a.minFilter=ta[c.min],0<=z.indexOf(a.minFilter)&&(a.genMipmaps=
!0));"mag"in c&&(a.magFilter=ba[c.mag]);var d=a.wrapS,e=a.wrapT;if("wrap"in c){var g=c.wrap;"string"===typeof g?d=e=W[g]:Array.isArray(g)&&(d=W[g[0]],e=W[g[1]])}else"wrapS"in c&&(d=W[c.wrapS]),"wrapT"in c&&(e=W[c.wrapT]);a.wrapS=d;a.wrapT=e;"anisotropic"in c&&(a.anisotropic=c.anisotropic);if("mipmap"in c){d=!1;switch(typeof c.mipmap){case "string":a.mipmapHint=U[c.mipmap];d=a.genMipmaps=!0;break;case "boolean":d=a.genMipmaps=c.mipmap;break;case "object":a.genMipmaps=!1,d=!0}!d||"min"in c||(a.minFilter=
9984)}}function ia(a,d){c.texParameteri(d,10241,a.minFilter);c.texParameteri(d,10240,a.magFilter);c.texParameteri(d,10242,a.wrapS);c.texParameteri(d,10243,a.wrapT);f.ext_texture_filter_anisotropic&&c.texParameteri(d,34046,a.anisotropic);a.genMipmaps&&(c.hint(33170,a.mipmapHint),c.generateMipmap(d))}function ra(){var a=ua.pop()||new qa;qa.call(a);return a}function ma(a){w.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ga++;this.refCount=1;this.target=a;this.texture=c.createTexture();this.unit=
-1;this.bindCount=0}function Y(a){c.activeTexture(33984);c.bindTexture(a.target,a.texture)}function fa(){var a=aa[0];a?c.bindTexture(a.target,a.texture):c.bindTexture(3553,null)}function Z(a){var d=a.texture,e=a.unit,g=a.target;0<=e&&(c.activeTexture(33984+e),c.bindTexture(g,null),aa[e]=null);c.deleteTexture(d);a.texture=null;a.params=null;a.pixels=null;a.refCount=0;delete wa[a.id];J.textureCount--}var U={"don't care":4352,"dont care":4352,nice:4354,fast:4353},W={repeat:10497,clamp:33071,mirror:33648},
ba={nearest:9728,linear:9729},ta=e({"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987,mipmap:9987},ba),Ba={none:0,browser:37444},ja={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ca={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},da={};f.ext_srgb&&(ca.srgb=35904,ca.srgba=35906);f.oes_texture_float&&(ja["float"]=5126);f.oes_texture_half_float&&(ja.float16=ja["half float"]=
36193);f.webgl_depth_texture&&(e(ca,{depth:6402,"depth stencil":34041}),e(ja,{uint16:5123,uint32:5125,"depth stencil":34042}));f.webgl_compressed_texture_s3tc&&e(da,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});f.webgl_compressed_texture_atc&&e(da,{"rgb arc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});f.webgl_compressed_texture_pvrtc&&e(da,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});
f.webgl_compressed_texture_etc1&&(da["rgb etc1"]=36196);var ya=Array.prototype.slice.call(c.getParameter(34467));Object.keys(da).forEach(function(a){var c=da[a];0<=ya.indexOf(c)&&(ca[a]=c)});var va=Object.keys(ca);p.textureFormats=va;var Ca=va.reduce(function(a,c){var d=ca[c];6409===d||6406===d||6409===d||6410===d||6402===d||34041===d?a[d]=d:32855===d||0<=c.indexOf("rgba")?a[d]=6408:a[d]=6407;return a},{}),Da=[],Ea=[],ua=[],Ga=0,wa={},la=p.maxTextureUnits,aa=Array(la).map(function(){return null});
e(ma.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var d=0;d<la;++d){var e=aa[d];if(e){if(0<e.bindCount)continue;e.unit=-1}aa[d]=this;a=d;break}this.unit=a;c.activeTexture(33984+a);c.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Z(this)}});return{create2D:function(a,d){function e(a,b){var c=ra(),d=X();"number"===typeof a?"number"===typeof b?T(d,a|0,b|0):T(d,a|0,a|0):a?(sa(c,a),P(d,a)):T(d,1,1);c.genMipmaps&&
(d.mipmask=(d.width<<1)-1);g.mipmask=d.mipmask;Q(g,d);g.internalformat=d.internalformat;e.width=d.width;e.height=d.height;Y(g);L(d,3553);ia(c,3553);fa();ua.push(c);ha(d);return e}var g=new ma(3553);wa[g.id]=g;J.textureCount++;e(a,d);e.subimage=function(a,b,d,c){b|=0;d|=0;c|=0;var f=H();Q(f,g);f.width>>=c;f.height>>=c;f.width-=b;f.height-=d;R(f,a);Y(g);S(f,3553,b,d,c);fa();ea(f);return e};e.resize=function(a,b){var d=a|0,f=b|0||d;if(d===g.width&&f===g.height)return e;e.width=g.width=d;e.height=g.height=
f;Y(g);c.texImage2D(3553,0,g.format,d,f,0,g.format,g.type,null);fa();return e};e._reglType="texture2d";e._texture=g;e.destroy=function(){g.decRef()};return e},createCube:function(a,d,e,g,f,n){function h(a,b,d,c,e,g){var f,n=ra();for(f=0;6>f;++f)p[f]=X();if("number"===typeof a||!a)for(a=a|0||1,f=0;6>f;++f)T(p[f],a,a);else if("object"===typeof a)if(b)P(p[0],a),P(p[1],b),P(p[2],d),P(p[3],c),P(p[4],e),P(p[5],g);else if(sa(n,a),ga(m,a),"faces"in a)for(a=a.faces,f=0;6>f;++f)Q(p[f],m),P(p[f],a[f]);else for(f=
0;6>f;++f)P(p[f],a);Q(m,p[0]);m.mipmask=n.genMipmaps?(p[0].width<<1)-1:p[0].mipmask;m.internalformat=p[0].internalformat;h.width=p[0].width;h.height=p[0].height;Y(m);for(f=0;6>f;++f)L(p[f],34069+f);ia(n,34067);fa();ua.push(n);for(f=0;6>f;++f)ha(p[f]);return h}var m=new ma(34067);wa[m.id]=m;J.cubeCount++;var p=Array(6);h(a,d,e,g,f,n);h.subimage=function(a,b,d,c,e){d|=0;c|=0;e|=0;var g=H();Q(g,m);g.width>>=e;g.height>>=e;g.width-=d;g.height-=c;R(g,b);Y(m);S(g,34069+a,d,c,e);fa();ea(g);return h};h.resize=
function(a,b){var d=a|0,e=b|0||d;if(d===m.width&&e===m.height)return h;h.width=m.width=d;h.height=m.height=e;Y(m);for(var g=0;6>g;++g)c.texImage2D(34069+g,0,m.format,d,e,0,m.format,m.type,null);fa();return h};h._reglType="textureCube";h._texture=m;h.destroy=function(){m.decRef()};return h},clear:function(){for(var a=0;a<la;++a)c.activeTexture(33984+a),c.bindTexture(3553,null),aa[a]=null;n(wa).forEach(Z);J.cubeCount=0;J.textureCount=0},getTexture:function(a){return null}}}},{"./constants/arraytypes.json":4,
"./util/extend":23,"./util/is-array-like":24,"./util/is-ndarray":25,"./util/is-typed-array":26,"./util/pool":28,"./util/to-half-float":30,"./util/values":31}],20:[function(f,p,w){p.exports=function(f,m){function p(){this.endQueryIndex=this.startQueryIndex=-1;this.stats=null}var g=m.ext_disjoint_timer_query;if(!g)return null;var a=[],e=[],n,F,A=[],u=[];return{beginQuery:function(a){n=a;F=A.pop()||g.createQueryEXT();g.beginQueryEXT(g.TIME_ELAPSED_EXT,F)},endQuery:function(){g.endQueryEXT(g.TIME_ELAPSED_EXT);
var f=u.pop()||new p;f.startQueryIndex=a.length;f.endQueryIndex=f.startQueryIndex;f.stats=n;e.push(f);a.push(F)},update:function(){if(0!==a.length){var f=[],h,n;for(h=0;h<a.length;h++)f[h]=1E-6*g.getQueryObjectEXT(a[h],g.QUERY_RESULT_EXT),A.push(a[h]);a=[];for(h=0;h<e.length;h++){var m=e[h];for(n=m.startQueryIndex;n<=m.endQueryIndex;n++)m.stats.gpuTime+=f[n];u.push(m)}e=[]}},getNumPendingQueries:function(){return a.length},pushScopeStats:function(a,g,f){var h=u.pop()||new p;h.startQueryIndex=a;h.endQueryIndex=
g;h.stats=f;e.push(h)},clear:function(){for(var a=0;a<A.length;a++)g.deleteQueryEXT(A[a])}}}},{}],21:[function(f,p,w){p.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],22:[function(f,p,w){function h(g){return Array.prototype.slice.call(g)}function m(g){return h(g).join("")}var q=f("./extend");p.exports=function(){function g(){var a=[],g=[];return q(function(){a.push.apply(a,h(arguments))},{def:function(){var f="v"+e++;
g.push(f);0<arguments.length&&(a.push(f,"="),a.push.apply(a,h(arguments)),a.push(";"));return f},toString:function(){return m([0<g.length?"var "+g+";":"",m(a)])}})}function a(){function a(g,h){f(g,h,"=",e.def(g,h),";")}var e=g(),f=g(),h=e.toString,n=f.toString;return q(e,{entry:e,exit:f,save:a,set:function(g,f,c){a(g,f);e(g,f,"=",c,";")},toString:function(){return h()+n()}})}var e=0,f=[],p=[],A=g(),u={};return{global:A,link:function(a){for(var g=0;g<p.length;++g)if(p[g]===a)return f[g];g="g"+e++;
f.push(g);p.push(a);return g},block:g,proc:function(e,g){function f(){var a="a"+h.length;h.push(a);return a}var h=[];g=g||0;for(var n=0;n<g;++n)f();var n=a(),p=n.toString;return u[e]=q(n,{arg:f,toString:function(){return m(["function(",h.join(),"){",p(),"}"])}})},scope:a,cond:function(){var e=m(arguments),g=a(),f=a(),n=g.toString,p=f.toString;return q(g,{then:function(){g.apply(g,h(arguments));return this},"else":function(){f.apply(f,h(arguments));return this},toString:function(){var a=p();a&&(a=
"else{"+a+"}");return m(["if(",e,"){",n(),"}",a])}})},compile:function(){var a=['"use strict";',A,"return {"];Object.keys(u).forEach(function(e){a.push('"',e,'":',u[e].toString(),",")});a.push("}");var e=m(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,f.concat(e)).apply(null,p)}}}},{"./extend":23}],23:[function(f,p,w){p.exports=function(f,m){for(var p=Object.keys(m),g=0;g<p.length;++g)f[p[g]]=m[p[g]];return f}},{}],24:[function(f,p,w){var h=f("./is-typed-array");
p.exports=function(f){return Array.isArray(f)||h(f)}},{"./is-typed-array":26}],25:[function(f,p,w){var h=f("./is-typed-array");p.exports=function(f){return!!f&&"object"===typeof f&&Array.isArray(f.shape)&&Array.isArray(f.stride)&&"number"===typeof f.offset&&f.shape.length===f.stride.length&&(Array.isArray(f.data)||h(f.data))}},{"./is-typed-array":26}],26:[function(f,p,w){var h=f("../constants/arraytypes.json");p.exports=function(f){return Object.prototype.toString.call(f)in h}},{"../constants/arraytypes.json":4}],
27:[function(f,p,w){p.exports=function(f,m){for(var p=Array(f),g=0;g<f;++g)p[g]=m(g);return p}},{}],28:[function(f,p,w){function h(a){var e,g;e=(65535<a)<<4;a>>>=e;g=(255<a)<<3;a>>>=g;e|=g;g=(15<a)<<2;a>>>=g;e|=g;g=(3<a)<<1;return e|g|a>>>g>>1}function m(a){a:{for(var e=16;268435456>=e;e*=16)if(a<=e){a=e;break a}a=0}e=g[h(a)>>2];return 0<e.length?e.pop():new ArrayBuffer(a)}function q(a){g[h(a.byteLength)>>2].push(a)}var g=f("./loop")(8,function(){return[]});p.exports={alloc:m,free:q,allocType:function(a,
e){var g=null;switch(a){case 5120:g=new Int8Array(m(e),0,e);break;case 5121:g=new Uint8Array(m(e),0,e);break;case 5122:g=new Int16Array(m(2*e),0,e);break;case 5123:g=new Uint16Array(m(2*e),0,e);break;case 5124:g=new Int32Array(m(4*e),0,e);break;case 5125:g=new Uint32Array(m(4*e),0,e);break;case 5126:g=new Float32Array(m(4*e),0,e);break;default:return null}return g.length!==e?g.subarray(0,e):g},freeType:function(a){q(a.buffer)}}},{"./loop":27}],29:[function(f,p,w){p.exports="function"===typeof requestAnimationFrame&&
"function"===typeof cancelAnimationFrame?{next:function(f){return requestAnimationFrame(f)},cancel:function(f){return cancelAnimationFrame(f)}}:{next:function(f){setTimeout(f,30)},cancel:clearTimeout}},{}],30:[function(f,p,w){var h=f("./pool"),m=new Float32Array(1),q=new Uint32Array(m.buffer);p.exports=function(g){for(var a=h.allocType(5123,g.length),e=0;e<g.length;++e)if(isNaN(g[e]))a[e]=65535;else if(Infinity===g[e])a[e]=31744;else if(-Infinity===g[e])a[e]=64512;else{m[0]=g[e];var f=q[0],p=f>>>
31<<15,A=(f<<1>>>24)-127,f=f>>13&1023;a[e]=-24>A?p:-14>A?p+(f+1024>>-14-A):15<A?p+31744:p+(A+15<<10)+f}return a}},{"./pool":28}],31:[function(f,p,w){p.exports=function(f){return Object.keys(f).map(function(m){return f[m]})}},{}],32:[function(f,p,w){function h(g,a){function e(){var a=window.innerWidth,e=window.innerHeight;g!==document.body&&(e=g.getBoundingClientRect(),a=e.right-e.left,e=e.top-e.bottom);f.width=p*a;f.height=p*e;q(f.style,{width:a+"px",height:e+"px"})}var f=document.createElement("canvas"),
h=m(f,a);q(f.style,{border:0,margin:0,padding:0,top:0,left:0});g.appendChild(f);g===document.body&&(f.style.position="absolute",q(g.style,{margin:0,padding:0}));var p=+h.options.pixelRatio;window.addEventListener("resize",e,!1);var u=h.options.onDestroy;h.options=q(q({},h.options),{onDestroy:function(){window.removeEventListener("resize",e);g.removeChild(f);u&&u()}});e();return h}function m(f,a){function e(a){try{return f.getContext(a,h)}catch(e){return null}}var h=a.glOptions||{};return{gl:e("webgl")||
e("experimental-webgl")||e("webgl-experimental"),options:q({pixelRatio:window.devicePixelRatio},a)}}var q=f("./util/extend");p.exports=function(f){if("undefined"===typeof document||"undefined"===typeof HTMLElement)return{gl:f[0],options:f[1]||{}};var a=document.body,e=f[1]||{};if("string"===typeof f[0])a=document.querySelector(f[0])||document.body;else if("object"===typeof f[0])if(f[0]instanceof HTMLElement)a=f[0];else{if(f[0]instanceof WebGLRenderingContext)return{gl:f[0],options:q({pixelRatio:1},
e)};e=f[0]}return a.nodeName&&"CANVAS"===a.nodeName.toUpperCase()?m(a,e):h(a,e)}},{"./util/extend":23}],33:[function(f,p,w){var h=f("./lib/util/extend"),m=f("./lib/dynamic"),q=f("./lib/util/raf"),g=f("./lib/util/clock"),a=f("./lib/strings"),e=f("./lib/webgl"),n=f("./lib/extension"),F=f("./lib/limits"),A=f("./lib/buffer"),u=f("./lib/elements"),x=f("./lib/texture"),G=f("./lib/renderbuffer"),M=f("./lib/framebuffer"),z=f("./lib/attribute"),y=f("./lib/shader"),K=f("./lib/read"),t=f("./lib/core"),c=f("./lib/stats"),
O=f("./lib/timer");p.exports=function(){function f(){W=q.next(f);L.tick+=1;L.time=(g()-ka)/1E3;Q();for(var a=0;a<U.length;++a)(0,U[a])(L,null,0);C.flush()}function d(a){}function p(a){}function J(a){function d(a){var c={},e={};Object.keys(a).forEach(function(d){var f=a[d];m.isDynamic(f)?e[d]=m.unbox(f,d):c[d]=f});return{dynamic:e,"static":c}}function c(a){for(;t.length<a;)t.push(null);return t}var e=d(a.context||{}),f=d(a.uniforms||{}),g=d(a.attributes||{}),n=d(function(a){function d(a){if(a in c){var e=
c[a];delete c[a];Object.keys(e).forEach(function(b){c[a+"."+b]=e[b]})}}var c=h({},a);delete c.uniforms;delete c.attributes;delete c.context;d("blend");d("depth");d("cull");d("stencil");d("polygonOffset");d("scissor");d("sample");return c}(a));a={gpuTime:0};var e=Y.compile(n,g,f,e,a),p=e.draw,r=e.batch,q=e.scope,t=[];return h(function(a,d){var e;if("function"===typeof a)return q.call(this,null,a,0);if("function"===typeof d)if("number"===typeof a)for(e=0;e<a;++e)q.call(this,null,d,e);else if(Array.isArray(a))for(e=
0;e<a.length;++e)q.call(this,a[e],d,e);else return q.call(this,a,d,0);else if("number"===typeof a){if(0<a)return r.call(this,c(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return r.call(this,a,a.length)}else return p.call(this,a)},{stats:a})}function w(){var a=fa.viewport,d=fa.scissor_box;a[0]=a[1]=d[0]=d[1]=0;L.viewportWidth=L.framebufferWidth=L.drawingBufferWidth=a[2]=d[2]=C.drawingBufferWidth;L.viewportHeight=L.framebufferHeight=L.drawingBufferHeight=a[3]=d[3]=C.drawingBufferHeight}function Q(){w();
Y.procs.poll()}function ga(){w();Y.procs.refresh()}var r=e(Array.prototype.slice.call(arguments)),C=r.gl,R=r.options,r=a(),S=c(),H=n(C).extensions,ea=O(C,H),ka=g(),T=C.drawingBufferWidth,P=C.drawingBufferHeight,L={tick:0,time:0,viewportWidth:T,viewportHeight:P,framebufferWidth:T,framebufferHeight:P,drawingBufferWidth:T,drawingBufferHeight:P,pixelRatio:R.pixelRatio},X=F(C,H),ha=A(C,S),qa=u(C,H,ha,S),T=z(C,H,X,ha,r),sa=y(C,r,S),ia=x(C,H,X,Q,L,S),ra=G(C,H,X,S),ma=M(C,H,X,ia,ra,S),P=K(C,Q,L),Y=t(C,r,
H,X,ha,qa,ia,ma,{},T,sa,{elements:null,primitive:4,count:-1,offset:0,instances:-1},L,ea),fa=Y.next,Z=C.canvas,U=[],W=0;Z&&(Z.addEventListener("webglcontextlost",d,!1),Z.addEventListener("webglcontextrestored",p,!1));ga();return h(J,{clear:function(a){var d=0;Y.procs.poll();var c=a.color;c&&(C.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),d|=16384);"depth"in a&&(C.clearDepth(+a.depth),d|=256);"stencil"in a&&(C.clearStencil(a.stencil|0),d|=1024);C.clear(d)},prop:m.define.bind(null,1),context:m.define.bind(null,
2),"this":m.define.bind(null,3),draw:J({}),buffer:function(a){return ha.create(a,34962)},elements:qa.create,texture:ia.create2D,cube:ia.createCube,renderbuffer:ra.create,framebuffer:ma.create,framebufferCube:function(a){},attributes:C.getContextAttributes(),frame:function(a){U.push(a);!W&&0<U.length&&f();return{cancel:function(){var d=U.find(function(d){return d===a});0>d||(U.splice(d,1),0>=U.length&&W&&(q.cancel(f),W=0))}}},limits:X,hasExtension:function(a){return 0<=X.extensions.indexOf(a.toLowerCase())},
read:P,destroy:function(){W&&(q.cancel(f),W=0);Z&&(Z.removeEventListener("webglcontextlost",d),Z.removeEventListener("webglcontextrestored",p));sa.clear();ma.clear();ra.clear();ia.clear();qa.clear();ha.clear();ea&&ea.clear();if(R.onDestroy)R.onDestroy()},_gl:C,_refresh:ga,stats:S,updateTimer:function(){ea&&ea.update()}})}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,
"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/clock":21,"./lib/util/extend":23,"./lib/util/raf":29,"./lib/webgl":32}],34:[function(f,p,w){function h(a){throw Error("resl: "+a);}function m(a,e,f){Object.keys(a).forEach(function(a){0>e.indexOf(a)&&h('invalid parameter "'+a+'" in '+f)})}function q(a,e){this.state=0;this.ready=!1;this.progress=0;this.name=a;this.cancel=e}var g=["manifest","onDone","onProgress","onError"],a=["type","src","stream",
"credentials","parser"],e=["onData","onDone"];p.exports=function(f){function p(a,c){if(a in f){var e=f[a];"function"!==typeof e&&h('invalid callback "'+a+'"');return e}return null}function w(a){function c(){if(!(2>m.readyState||1===p.state||-1===p.state)){if(200!==m.status)return x('error loading resource "'+a.name+'"');if(2<m.readyState&&0===p.state){var f;f="binary"===a.type?m.response:m.responseText;if(h.data)try{n=h.data(f)}catch(g){return x(g)}else n=f}if(3<m.readyState&&0===p.state){if(h.done)try{n=
h.done()}catch(g){return x(g)}p.state=1}t[e]=n;p.progress=.75*p.progress+.25;p.ready=a.stream&&!!n||1===p.state;G()}}var e=a.name,f=a.stream,g="binary"===a.type,h=a.parser,m=new XMLHttpRequest,n=null,p=new q(e,function(){1!==p.state&&-1!==p.state&&(m.onreadystatechange=null,m.abort(),p.state=-1)});m.onreadystatechange=f?c:function(){4===m.readyState&&c()};g&&(m.responseType="arraybuffer");a.credentials&&(m.withCredentials=!0);m.open("GET",a.src,!0);m.send();return p}function u(a,c){function e(){if(0===
u.state)if(p.data)try{w=p.data(c)}catch(a){return x(a)}else w=c}function f(c){e();t[n]=w;u.progress=c.lengthComputable?Math.max(u.progress,c.loaded/c.total):.75*u.progress+.25;u.ready=a.stream;G(n)}function g(){e();if(0===u.state){if(p.done)try{w=p.done()}catch(a){return x(a)}u.state=1}u.progress=1;u.ready=!0;t[n]=w;m();G("finish "+n)}function h(){x('error loading asset "'+n+'"')}function m(){a.stream&&c.removeEventListener("progress",f);"image"===a.type?c.addEventListener("load",g):c.addEventListener("canplay",
g);c.removeEventListener("error",h)}var n=a.name,p=a.parser,u=new q(n,function(){1!==u.state&&-1!==u.state&&(u.state=-1,m(),c.src="")}),w=c;a.stream&&c.addEventListener("progress",f);"image"===a.type?c.addEventListener("load",g):c.addEventListener("canplay",g);c.addEventListener("error",h);c.crossOrigin=a.credentials?"use-credentials":"anonymous";c.src=a.src;return u}function x(a){-1!==c&&1!==c&&(c=-1,B.forEach(function(a){a.cancel()}),K?"string"===typeof a?K(Error("resl: "+a)):K(a):console.error("resl error:",
a))}function G(a){if(-1!==c&&1!==c){var e=0,f=0;B.forEach(function(a){a.ready&&(f+=1);e+=a.progress});f===B.length?(c=1,z(t)):y&&y(e/B.length,a)}}"object"===typeof f&&f||h("invalid or missing configuration");m(f,g,"config");var M=f.manifest;"object"===typeof M&&M||h("missing manifest");var z=p("onDone");z||h("missing onDone() callback");var y=p("onProgress"),K=p("onError"),t={},c=0,O={text:w,binary:function(a){return w(a)},image:function(a){return u(a,document.createElement("img"))},video:function(a){return u(a,
document.createElement("video"))},audio:function(a){return u(a,document.createElement("audio"))}},B=Object.keys(M).map(function(c){function f(a,c){if(a in g.parser){var d=g.parser[a];"function"!==typeof d&&h("invalid parser callback "+a+' for asset "'+a+'"');return d}return c}var g=M[c];"string"===typeof g?g={src:g}:"object"===typeof g&&g||h('invalid asset definition "'+c+'"');m(g,a,'asset "'+c+'"');var n={};"parser"in g&&("function"===typeof g.parser?n={data:g.parser}:"object"===typeof g.parser&&
g.parser?(m(n,e,'parser for asset "'+c+'"'),"onData"in n||h('missing onData callback for parser in asset "'+c+'"'),n={data:f("onData"),done:f("onDone")}):h('invalid parser for asset "'+c+'"'));return{name:c,type:function(a,e,f){a in g&&(f=g[a]);0>e.indexOf(f)&&h("invalid "+a+' "'+f+'" for asset "'+c+'", possible values: '+e);return f}("type",Object.keys(O),"text"),stream:!!g.stream,credentials:!!g.credentials,src:function(a,e,f){a in g?f=g[a]:e&&h("missing "+a+' for asset "'+c+'"');"string"!==typeof f&&
h("invalid "+a+' for asset "'+c+'", must be a string');return f}("src",!0,""),parser:n}}).map(function(a){return O[a.type](a)})}},{}]},{},[1]);

        </script>
        </body>
      </html>